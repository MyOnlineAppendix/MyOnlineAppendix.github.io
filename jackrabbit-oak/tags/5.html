<h3><span class=" glyphicon glyphicon-tag"/>&nbspUtilityVerifier</h3><kbd>Verifies (un)successful execution of the test case by reporting explicitly a failure</kbd><br><br><br><h4 style="margin:0px">Class: org.apache.jackrabbit.oak.OakTest </h4><pre class="type-5 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWithDefaultWorkspaceName() throws Exception {
  ContentRepository repo=new Oak().with("test").with(new OpenSecurityProvider()).createContentRepository();
  String[] valid=new String[]{null,"test"};
  for (  String wspName : valid) {
    ContentSession cs=null;
    try {
      cs=repo.login(null,wspName);
      assertEquals("test",cs.getWorkspaceName());
    }
  finally {
      if (cs != null) {
        cs.close();
      }
    }
  }
  String[] invalid=new String[]{"","another",Oak.DEFAULT_WORKSPACE_NAME};
  for (  String wspName : invalid) {
    ContentSession cs=null;
    try {
      cs=repo.login(null,wspName);
      fail("invalid workspace nam");
    }
 catch (    NoSuchWorkspaceException e) {
    }
 finally {
      if (cs != null) {
        cs.close();
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void checkExecutorShutdown() throws Exception {
  Runnable runnable=new Runnable(){
    @Override public void run(){
    }
  }
;
  Oak oak=new Oak().with(new OpenSecurityProvider());
  ContentRepository repo=oak.createContentRepository();
  WhiteboardUtils.scheduleWithFixedDelay(oak.getWhiteboard(),runnable,1);
  ((Closeable)repo).close();
  try {
    WhiteboardUtils.scheduleWithFixedDelay(oak.getWhiteboard(),runnable,1);
    fail("Executor should have rejected the task");
  }
 catch (  RejectedExecutionException ignore) {
  }
  ScheduledExecutorService externalExecutor=Executors.newSingleThreadScheduledExecutor();
  Oak oak2=new Oak().with(new OpenSecurityProvider()).with(externalExecutor);
  ContentRepository repo2=oak2.createContentRepository();
  WhiteboardUtils.scheduleWithFixedDelay(oak2.getWhiteboard(),runnable,1);
  ((Closeable)repo2).close();
  WhiteboardUtils.scheduleWithFixedDelay(oak2.getWhiteboard(),runnable,1);
  externalExecutor.shutdown();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.api.UniquePropertyTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testUniqueness() throws Exception {
  Root root=new Oak().with(new OpenSecurityProvider()).with(new PropertyIndexEditorProvider()).with(new InitialContent()).createRoot();
  NodeUtil node=new NodeUtil(root.getTree("/"));
  String uuid=UUID.randomUUID().toString();
  node.setString(JcrConstants.JCR_UUID,uuid);
  root.commit();
  NodeUtil child=new NodeUtil(root.getTree("/")).addChild("another","rep:User");
  child.setString(JcrConstants.JCR_UUID,uuid);
  try {
    root.commit();
    fail("Duplicate jcr:uuid should be detected.");
  }
 catch (  CommitFailedException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.cache.CacheTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testBadLoader(){
  CacheLIRS<Integer,String> cache=createCache(10,1);
  try {
    cache.get(1,new Callable<String>(){
      @Override public String call() throws Exception {
        return null;
      }
    }
);
    fail();
  }
 catch (  Exception e) {
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRefresh() throws ExecutionException {
  CacheLIRS<Integer,String> cache=new CacheLIRS.Builder<Integer,String>().maximumWeight(100).weigher(new Weigher<Integer,String>(){
    @Override public int weigh(    Integer key,    String value){
      return key + value.length();
    }
  }
).build(new CacheLoader<Integer,String>(){
    @Override public String load(    Integer key) throws Exception {
      if (key < 0 || key >= 100) {
        throw new Exception("Out of range");
      }
      return "n" + key;
    }
    @Override public ListenableFuture<String> reload(    Integer key,    String oldValue){
      assertTrue(oldValue != null);
      SettableFuture<String> f=SettableFuture.create();
      f.set(oldValue);
      return f;
    }
  }
);
  assertEquals("n1",cache.get(1));
  cache.refresh(1);
  cache.refresh(2);
  try {
    cache.get(-1);
    fail();
  }
 catch (  Exception e) {
  }
  cache.refresh(-1);
}

</code></pre>

<br>
<pre class="type-5 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEdgeCases(){
  CacheLIRS<Integer,Integer> test=createCache(1);
  test.put(1,10,100);
  assertEquals(10,test.getUnchecked(1).intValue());
  try {
    test.put(null,10,100);
    fail();
  }
 catch (  NullPointerException e) {
  }
  try {
    test.put(1,null,100);
    fail();
  }
 catch (  NullPointerException e) {
  }
  try {
    test.setMaxMemory(-1);
    fail();
  }
 catch (  IllegalArgumentException e) {
  }
  try {
    test.setAverageMemory(0);
    fail();
  }
 catch (  IllegalArgumentException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.commons.PathUtilsTest </h4><pre class="type-12 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void test(){
  try {
    PathUtils.getParentPath("invalid/path/");
    if (assertsEnabled) {
      fail();
    }
  }
 catch (  AssertionFailedError e) {
    throw e;
  }
catch (  AssertionError e) {
  }
  try {
    PathUtils.getName("invalid/path/");
    if (assertsEnabled) {
      fail();
    }
  }
 catch (  AssertionFailedError e) {
    throw e;
  }
catch (  AssertionError e) {
  }
  test("parent","child");
  test("x","y");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.commons.io.LazyInputStreamTest </h4><pre class="type-9 type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test() throws IOException {
  createFile();
  LazyInputStream in=new LazyInputStream(asByteSource(file));
  in.close();
  in=new LazyInputStream(asByteSource(file));
  assertEquals(0,in.read());
  assertEquals(-1,in.read());
  assertEquals(-1,in.read());
  assertEquals(-1,in.read());
  in.close();
  in.close();
  in.close();
  in=new LazyInputStream(asByteSource(file));
  assertFalse(in.markSupported());
  in.mark(1);
  assertEquals(0,in.read());
  try {
    in.reset();
    fail();
  }
 catch (  IOException e) {
  }
  assertEquals(-1,in.read());
  in.close();
  in=new LazyInputStream(asByteSource(file));
  byte[] test=new byte[2];
  assertEquals(1,in.read(test));
  in.close();
  in=new LazyInputStream(asByteSource(file));
  assertEquals(1,in.read(test,0,2));
  in.close();
  in=new LazyInputStream(asByteSource(file));
  assertEquals(2,in.skip(2));
  assertEquals(-1,in.read(test));
  in.close();
  createFile();
  in=new LazyInputStream(asByteSource(file));
  assertEquals(0,in.read());
  assertEquals(-1,in.read());
  in.close();
  file.delete();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.core.ImmutableRootTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testImmutable(){
  try {
    root.commit();
    fail();
  }
 catch (  UnsupportedOperationException e) {
  }
  try {
    root.rebase();
    fail();
  }
 catch (  UnsupportedOperationException e) {
  }
  try {
    root.refresh();
    fail();
  }
 catch (  UnsupportedOperationException e) {
  }
  try {
    root.createBlob(new ByteArrayInputStream(new byte[0]));
    fail();
  }
 catch (  UnsupportedOperationException e) {
  }
  try {
    root.move("/x","/b");
    fail();
  }
 catch (  UnsupportedOperationException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.CRUDTest </h4><pre class="type-5 type-6 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRemoveMissingMVProperty() throws RepositoryException {
  Session session=getAdminSession();
  Node root=session.getRootNode();
  Property p=root.setProperty("missing",(String[])null);
  assertNotNull(p);
  try {
    p.getValues();
    fail("must throw InvalidItemStateException");
  }
 catch (  InvalidItemStateException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 type-6 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRemoveMissingProperty() throws RepositoryException {
  Session session=getAdminSession();
  Node root=session.getRootNode();
  Property p=root.setProperty("missing",(String)null);
  assertNotNull(p);
  try {
    p.getValue();
    fail("must throw InvalidItemStateException");
  }
 catch (  InvalidItemStateException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void getNodeWithRelativePath() throws RepositoryException {
  Session s=getAdminSession();
  try {
    s.getNode("some-relative-path");
    fail("Session.getNode() with relative path must throw a RepositoryException");
  }
 catch (  RepositoryException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void getItemWithRelativePath() throws RepositoryException {
  Session s=getAdminSession();
  try {
    s.getItem("some-relative-path");
    fail("Session.getItem() with relative path must throw a RepositoryException");
  }
 catch (  RepositoryException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void getPropertyWithRelativePath() throws RepositoryException {
  Session s=getAdminSession();
  try {
    s.getProperty("some-relative-path");
    fail("Session.getProperty() with relative path must throw a RepositoryException");
  }
 catch (  RepositoryException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.CompatibilityIssuesTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * Trans-session isolation differs from Jackrabbit 2. Snapshot isolation can
 * result in write skew as this test demonstrates: the check method enforces
 * an application logic constraint which says that the sum of the properties
 * p1 and p2 must not be negative. While session1 and session2 each enforce
 * this constraint before saving, the constraint might not hold globally as
 * can be seen in session3.
 * @see <a href="http://wiki.apache.org/jackrabbit/Transactional%20model%20of%20the%20Microkernel%20based%20Jackrabbit%20prototype">
     *     Transactional model of the Microkernel based Jackrabbit prototype</a>
 */
@Test public void sessionIsolation() throws RepositoryException, ExecutionException, InterruptedException {
  final Session session0=createAdminSession();
  try {
    run(new Callable<Void>(){
      @Override public Void call() throws Exception {
        Node testNode=session0.getNode("/").addNode("testNode");
        testNode.setProperty("p1",1);
        testNode.setProperty("p2",1);
        session0.save();
        check(getAdminSession());
        return null;
      }
    }
);
  }
  finally {
    session0.logout();
  }
  final Session session1=createAdminSession();
  final Session session2=createAdminSession();
  try {
    run(new Callable<Void>(){
      @Override public Void call() throws Exception {
        session1.getNode("/testNode").setProperty("p1",-1);
        check(session1);
        session1.save();
        return null;
      }
    }
);
    run(new Callable<Void>(){
      @Override public Void call() throws Exception {
        session2.getNode("/testNode").setProperty("p2",-1);
        check(session2);
        session2.save();
        return null;
      }
    }
);
  }
  finally {
    session1.logout();
    session2.logout();
  }
  Session session3=createAnonymousSession();
  try {
    check(session3);
    fail();
  }
 catch (  AssertionError e) {
  }
 finally {
    session3.logout();
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void addNodeTest() throws RepositoryException {
  Session session=getAdminSession();
  String ntName="test";
  NodeTypeManager ntm=session.getWorkspace().getNodeTypeManager();
  NodeTypeTemplate ntt=ntm.createNodeTypeTemplate();
  ntt.setName(ntName);
  NodeDefinitionTemplate child=ntm.createNodeDefinitionTemplate();
  child.setName("*");
  child.setDefaultPrimaryTypeName("nt:base");
  child.setRequiredPrimaryTypeNames(new String[]{"nt:base"});
  List<NodeDefinition> children=ntt.getNodeDefinitionTemplates();
  children.add(child);
  ntm.registerNodeType(ntt,true);
  Node node=session.getRootNode().addNode("defaultNtBase",ntName);
  node.addNode("nothrow");
  try {
    node.addNode("throw","nt:hierarchyNode");
    fail("Abstract primary type should cause ConstraintViolationException");
  }
 catch (  ConstraintViolationException expected) {
  }
  session.save();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void noSNSSupport() throws RepositoryException {
  Session session=getAdminSession();
  Node testNode=session.getRootNode().addNode("test","nt:unstructured");
  session.save();
  testNode.addNode("foo");
  try {
    testNode.addNode("foo");
    fail("Expected ItemExistsException");
  }
 catch (  ItemExistsException e) {
  }
  session.save();
  try {
    testNode.addNode("foo");
    fail("Expected ItemExistsException");
  }
 catch (  ItemExistsException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.ConcurrentAddIT </h4><pre class="type-5 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings("unchecked") public void addNodesSameParent() throws Exception {
  List<Exception> exceptions=Collections.synchronizedList(new ArrayList<Exception>());
  Node test=getAdminSession().getRootNode().addNode("test","nt:unstructured");
  List<Thread> worker=new ArrayList<Thread>();
  for (int i=0; i < NUM_WORKERS; i++) {
    worker.add(new Thread(new Worker(createAdminSession(),test.getPath(),exceptions)));
  }
  getAdminSession().save();
  for (  Thread t : worker) {
    t.start();
  }
  for (  Thread t : worker) {
    t.join();
  }
  for (  Exception e : exceptions) {
    fail(e.toString());
  }
  getAdminSession().refresh(false);
  assertEquals(NODES_PER_WORKER * NUM_WORKERS,Iterators.size(test.getNodes()));
}

</code></pre>

<br>
<pre class="type-5 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @SuppressWarnings("unchecked") public void addNodes() throws Exception {
  List<Exception> exceptions=Collections.synchronizedList(new ArrayList<Exception>());
  Node test=getAdminSession().getRootNode().addNode("test");
  List<Thread> worker=new ArrayList<Thread>();
  for (int i=0; i < NUM_WORKERS; i++) {
    String path=test.addNode("node" + i).getPath();
    worker.add(new Thread(new Worker(createAdminSession(),path,exceptions)));
  }
  getAdminSession().save();
  for (  Thread t : worker) {
    t.start();
  }
  for (  Thread t : worker) {
    t.join();
  }
  for (  Exception e : exceptions) {
    fail(e.toString());
  }
  getAdminSession().refresh(false);
  for (  Node n : in((Iterator<Node>)test.getNodes())) {
    assertEquals(NODES_PER_WORKER,Iterators.size(n.getNodes()));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.ConcurrentAddReferenceTest </h4><pre class="type-5 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("unchecked") @Test public void addReferences() throws Exception {
  List<Exception> exceptions=Collections.synchronizedList(new ArrayList<Exception>());
  List<Thread> worker=new ArrayList<Thread>();
  for (int i=0; i < NUM_WORKERS; i++) {
    String path=testRoot.addNode("node" + i).getPath();
    worker.add(new Thread(new Worker(createAdminSession(),path,exceptions)));
  }
  getAdminSession().save();
  for (  Thread t : worker) {
    t.start();
  }
  for (  Thread t : worker) {
    t.join();
  }
  for (  Exception e : exceptions) {
    fail(e.toString());
  }
  getAdminSession().refresh(false);
  for (  Node n : in((Iterator<Node>)testRoot.getNodes())) {
    assertEquals(NODES_PER_WORKER,Iterators.size(n.getNodes()));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.ConcurrentAddRemoveIT </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void concurrent() throws Exception {
  List<Exception> exceptions=Collections.synchronizedList(new ArrayList<Exception>());
  Node test=getAdminSession().getRootNode().addNode("test");
  List<Thread> worker=new ArrayList<Thread>();
  for (int i=0; i < NUM_WORKERS; i++) {
    worker.add(new Thread(new Worker(createAdminSession(),test.getPath(),exceptions)));
  }
  getAdminSession().save();
  for (  Thread t : worker) {
    t.start();
  }
  for (  Thread t : worker) {
    t.join();
  }
  for (  Exception e : exceptions) {
    fail(e.toString());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.CopyTest </h4><pre class="type-13 type-12 type-5 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCopyVersionableNodeClearsVersions() throws Exception {
  Session session=getAdminSession();
  Node toCopy=session.getNode(TEST_PATH + "/source/node");
  toCopy.addMixin(JcrConstants.MIX_VERSIONABLE);
  session.save();
  Version v1=toCopy.checkin();
  toCopy.checkout();
  Version v2=toCopy.checkin();
  toCopy.checkout();
  session.getWorkspace().copy(TEST_PATH + "/source/node",TEST_PATH + "/target/copied");
  Node copy=testNode.getNode("target/copied");
  VersionHistory vh=copy.getVersionHistory();
  Version rootV=vh.getRootVersion();
  assertEquals(0,rootV.getSuccessors().length);
  VersionIterator vItr=vh.getAllVersions();
  while (vItr.hasNext()) {
    if (!rootV.isSame(vItr.nextVersion())) {
      fail("Unexpected version in version history of copied node.");
    }
  }
  try {
    vh.getVersion(v1.getName());
    fail("Unexpected version in version history of copied node.");
  }
 catch (  VersionException e) {
  }
  try {
    vh.getVersion(v2.getName());
    fail("Unexpected version in version history of copied node.");
  }
 catch (  VersionException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.ItemSaveTest </h4><pre class="type-5 type-7 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Sets implicit assumptions 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void saveMissesProperty() throws RepositoryException {
  assumeTrue(!NodeImpl.SAVE_SESSION);
  try {
    prop1.setValue("changed");
    prop2.setValue("changed");
    prop1.save();
    fail("Expected UnsupportedRepositoryOperationException");
  }
 catch (  UnsupportedRepositoryOperationException e) {
    assertTrue(e.getCause() instanceof CommitFailedException);
  }
 finally {
    session.refresh(false);
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Sets implicit assumptions 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void saveOnNewNode() throws RepositoryException {
  assumeTrue(!NodeImpl.SAVE_SESSION);
  try {
    foo.addNode("child").save();
    fail("Expected UnsupportedRepositoryOperationException");
  }
 catch (  UnsupportedRepositoryOperationException e) {
    assertTrue(e.getCause() instanceof CommitFailedException);
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Sets implicit assumptions 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void saveOnNewProperty() throws RepositoryException {
  assumeTrue(!NodeImpl.SAVE_SESSION);
  try {
    foo.setProperty("p3","v3").save();
    fail("Expected UnsupportedRepositoryOperationException");
  }
 catch (  UnsupportedRepositoryOperationException e) {
    assertTrue(e.getCause() instanceof CommitFailedException);
  }
 finally {
    session.refresh(false);
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-16 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Sets implicit assumptions 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void saveMissesNode() throws RepositoryException {
  assumeTrue(!NodeImpl.SAVE_SESSION);
  try {
    root.addNode("child1");
    foo.addNode("child2");
    foo.save();
    fail("Expected UnsupportedRepositoryOperationException");
  }
 catch (  UnsupportedRepositoryOperationException e) {
    assertTrue(e.getCause() instanceof CommitFailedException);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.MoveRemoveTest </h4><pre class="type-5 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void moveExistingNodeRefresh() throws RepositoryException {
  Session session=getAdminSession();
  session.getRootNode().addNode("new");
  session.save();
  Session session2=createAdminSession();
  Node n2=session2.getNode("/new");
  Node n=session.getNode("/new");
  session.move("/new","/moved");
  session.save();
  session2.refresh(false);
  try {
    n2.getPath();
    fail();
  }
 catch (  InvalidItemStateException e) {
  }
  session.getRootNode().addNode("new");
  session.save();
  session2.refresh(false);
  assertEquals("/new",n2.getPath());
  session2.logout();
}

</code></pre>

<br>
<pre class="type-5 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void moveExistingNodeRefreshParent() throws RepositoryException {
  Session session=getAdminSession();
  session.getRootNode().addNode("parent").addNode("new");
  session.save();
  Session session2=createAdminSession();
  Node n2=session2.getNode("/parent/new");
  Node n=session.getNode("/parent/new");
  session.move("/parent","/moved");
  session.save();
  session2.refresh(false);
  try {
    n2.getPath();
    fail();
  }
 catch (  InvalidItemStateException e) {
  }
  session.getRootNode().addNode("parent").addNode("new");
  session.save();
  session2.refresh(false);
  assertEquals("/parent/new",n2.getPath());
  session2.logout();
}

</code></pre>

<br>
<pre class="type-5 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void removeExistingNodeParent() throws RepositoryException {
  Session session=getAdminSession();
  session.getRootNode().addNode("parent").addNode("new");
  session.save();
  Node n=session.getNode("/parent/new");
  n.getParent().remove();
  try {
    n.getPath();
    fail();
  }
 catch (  InvalidItemStateException e) {
  }
  session.getRootNode().addNode("parent").addNode("new");
  assertEquals("/parent/new",n.getPath());
}

</code></pre>

<br>
<pre class="type-5 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void removeExistingNodeRefreshParent() throws RepositoryException {
  Session session=getAdminSession();
  session.getRootNode().addNode("parent").addNode("new");
  session.save();
  Session session2=createAdminSession();
  Node n2=session2.getNode("/parent/new");
  Node n=session.getNode("/parent/new");
  n.getParent().remove();
  session.save();
  session2.refresh(false);
  try {
    n2.getPath();
    fail();
  }
 catch (  InvalidItemStateException e) {
  }
  session.getRootNode().addNode("parent").addNode("new");
  session.save();
  session2.refresh(false);
  assertEquals("/parent/new",n2.getPath());
  session2.logout();
}

</code></pre>

<br>
<pre class="type-5 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void removeNewNodeParent() throws RepositoryException {
  Session session=getAdminSession();
  session.getRootNode().addNode("parent").addNode("new");
  Node n=session.getNode("/parent/new");
  n.getParent().remove();
  try {
    n.getPath();
    fail();
  }
 catch (  InvalidItemStateException e) {
  }
  session.getRootNode().addNode("parent").addNode("new");
  assertEquals("/parent/new",n.getPath());
}

</code></pre>

<br>
<pre class="type-5 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void removeExistingNode() throws RepositoryException {
  Session session=getAdminSession();
  session.getRootNode().addNode("new");
  session.save();
  Node n=session.getNode("/new");
  n.remove();
  try {
    n.getPath();
    fail();
  }
 catch (  InvalidItemStateException e) {
  }
  session.getRootNode().addNode("new");
  assertEquals("/new",n.getPath());
}

</code></pre>

<br>
<pre class="type-5 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void removeNewNode() throws RepositoryException {
  Session session=getAdminSession();
  session.getRootNode().addNode("new");
  Node n=session.getNode("/new");
  n.remove();
  try {
    n.getPath();
    fail();
  }
 catch (  InvalidItemStateException e) {
  }
  session.getRootNode().addNode("new");
  assertEquals("/new",n.getPath());
}

</code></pre>

<br>
<pre class="type-5 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void removeExistingNodeRefresh() throws RepositoryException {
  Session session=getAdminSession();
  session.getRootNode().addNode("new");
  session.save();
  Session session2=createAdminSession();
  Node n2=session2.getNode("/new");
  Node n=session.getNode("/new");
  n.remove();
  session.save();
  session2.refresh(false);
  try {
    n2.getPath();
    fail();
  }
 catch (  InvalidItemStateException e) {
  }
  session.getRootNode().addNode("new");
  session.save();
  session2.refresh(false);
  assertEquals("/new",n2.getPath());
  session2.logout();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.NameAndPathPropertyTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testInvalidMVPathProperty() throws Exception {
  Session session=getAdminSession();
  Node testRootNode=session.getRootNode().addNode("testRoot");
  try {
    testRootNode.setProperty("testPathProperty",new String[]{"/*/dfsdf"},PropertyType.PATH);
    session.save();
    fail("adding a  path property without registered namespace must fail.");
  }
 catch (  RepositoryException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMVPathProperty() throws Exception {
  Session session=getAdminSession();
  Node testRootNode=session.getRootNode().addNode("testRoot");
  try {
    testRootNode.setProperty("testPathProperty",new String[]{"/foobar:test","/foobar:test/a","/a/foobar:test"},PropertyType.PATH);
    session.save();
    fail("adding a MV path property without registered namespace must fail.");
  }
 catch (  RepositoryException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testPathProperty() throws Exception {
  Session session=getAdminSession();
  Node testRootNode=session.getRootNode().addNode("testRoot");
  try {
    testRootNode.setProperty("testPathProperty","/foobar:test",PropertyType.PATH);
    session.save();
    fail("adding a  path property without registered namespace must fail.");
  }
 catch (  RepositoryException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMVNameProperty() throws Exception {
  Session session=getAdminSession();
  Node testRootNode=session.getRootNode().addNode("testRoot");
  try {
    testRootNode.setProperty("testNameProperty",new String[]{"foobar:test"},PropertyType.NAME);
    session.save();
    fail("adding a MV name property without registered namespace must fail.");
  }
 catch (  RepositoryException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testInvalidPathProperty() throws Exception {
  Session session=getAdminSession();
  Node testRootNode=session.getRootNode().addNode("testRoot");
  try {
    testRootNode.setProperty("testPathProperty","/*/dfsdf",PropertyType.PATH);
    session.save();
    fail("adding a  path property without registered namespace must fail.");
  }
 catch (  RepositoryException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.RepositoryTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void removeNode2() throws RepositoryException {
  Node foo=getNode("/foo");
  getAdminSession().removeItem(foo.getPath());
  try {
    foo.getParent();
    fail("Cannot retrieve the parent from a transiently removed item.");
  }
 catch (  InvalidItemStateException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void saveRefreshConflict() throws RepositoryException {
  Session session1=createAdminSession();
  Session session2=createAdminSession();
  try {
    session1.getRootNode().addNode("node").setProperty("p","v1");
    session2.getRootNode().addNode("node").setProperty("p","v2");
    assertTrue(session1.getRootNode().hasNode("node"));
    assertTrue(session2.getRootNode().hasNode("node"));
    session1.save();
    assertTrue(session1.getRootNode().hasNode("node"));
    assertTrue(session2.getRootNode().hasNode("node"));
    session2.refresh(true);
    assertTrue(session1.getRootNode().hasNode("node"));
    assertTrue(session2.getRootNode().hasNode("node"));
    try {
      session2.save();
      fail("Expected InvalidItemStateException");
    }
 catch (    InvalidItemStateException expected) {
    }
  }
  finally {
    session1.logout();
    session2.logout();
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void removeNode() throws RepositoryException {
  Node parentNode=getNode(TEST_PATH);
  parentNode.addNode("newNode");
  parentNode.getSession().save();
  Session session2=createAdminSession();
  try {
    Node removeNode=session2.getNode(TEST_PATH + "/newNode");
    removeNode.remove();
    try {
      removeNode.getParent();
      fail("Cannot retrieve the parent from a transiently removed item.");
    }
 catch (    InvalidItemStateException expected) {
    }
    assertTrue(session2.getNode(TEST_PATH).isModified());
    session2.save();
  }
  finally {
    session2.logout();
  }
  Session session3=createAnonymousSession();
  try {
    assertFalse(session3.nodeExists(TEST_PATH + "/newNode"));
    assertFalse(session3.getNode(TEST_PATH).isModified());
  }
  finally {
    session3.logout();
  }
}

</code></pre>

<br>
<pre class="type-5 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void invalidItemStateExceptionOnRemovedNode() throws Exception {
  Session session=getAdminSession();
  for (  String parentPath : new String[]{"/",TEST_PATH}) {
    Node parent=session.getNode(parentPath);
    Node child=parent.addNode("child");
    String childPath=child.getPath();
    child.remove();
    try {
      child.getPath();
      fail();
    }
 catch (    InvalidItemStateException expected) {
    }
    session.save();
    try {
      child.getPath();
      fail();
    }
 catch (    InvalidItemStateException expected) {
    }
    parent.addNode("child");
    assertEquals(childPath,child.getPath());
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void accessRemovedItem() throws RepositoryException {
  Node foo=getNode("/foo");
  Node bar=foo.addNode("bar");
  Property p=bar.setProperty("name","value");
  foo.remove();
  try {
    bar.getPath();
    fail("Expected InvalidItemStateException");
  }
 catch (  InvalidItemStateException expected) {
  }
  try {
    p.getPath();
    fail("Expected InvalidItemStateException");
  }
 catch (  InvalidItemStateException expected) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void registryRemappedNamespace() throws RepositoryException {
  NamespaceRegistry nsReg=getAdminSession().getWorkspace().getNamespaceRegistry();
  nsReg.registerNamespace("foo","file:///foo");
  getAdminSession().getRootNode().addNode("foo:test");
  getAdminSession().save();
  try {
    nsReg.registerNamespace("bar","file:///foo");
    fail("Remapping namespace through NamespaceRegistry must not be allowed");
  }
 catch (  NamespaceException e) {
  }
 finally {
    getAdminSession().getRootNode().getNode("foo:test").remove();
    getAdminSession().save();
    nsReg.unregisterNamespace("foo");
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void saveConflict() throws RepositoryException {
  getAdminSession().getRootNode().addNode("node");
  getAdminSession().save();
  Session session1=createAdminSession();
  Session session2=createAdminSession();
  try {
    session1.getNode("/node").remove();
    session2.getNode("/node").addNode("2");
    assertFalse(session1.getRootNode().hasNode("node"));
    assertTrue(session2.getRootNode().hasNode("node"));
    assertTrue(session2.getRootNode().getNode("node").hasNode("2"));
    session1.save();
    assertFalse(session1.getRootNode().hasNode("node"));
    assertFalse(session2.getRootNode().hasNode("node"));
    try {
      session2.save();
      fail("Expected InvalidItemStateException");
    }
 catch (    InvalidItemStateException expected) {
    }
  }
  finally {
    session1.logout();
    session2.logout();
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-6 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test SNS 1-based indexed path.
 * JCR 2.0, Chapter 22.2:
 * <em>
 * A name in a content repository path that does not explicitly specify an index implies an index of 1.
 * For example, /a/b/c is equivalent to /a[1]/b[1]/c[1].
 * </em>
 * @throws RepositoryException
 */
@Test public void getNodeSNS() throws RepositoryException {
  Node node=getNode("/foo[1]");
  assertNotNull(node);
  assertEquals("foo",node.getName());
  assertEquals("/foo",node.getPath());
  node.addNode("bar");
  Node bar=getNode("/foo[1]/bar[1]");
  assertEquals("/foo/bar",bar.getPath());
  try {
    getNode("/foo[1]/bar[2]");
    fail("retrieving wrong SNS index should throw PathNotFoundException");
  }
 catch (  PathNotFoundException e) {
  }
  try {
    getProperty("/foo[1]/bar[2]/jcr:primaryType");
    fail("retrieving wrong SNS index should throw PathNotFoundException");
  }
 catch (  PathNotFoundException e) {
  }
  assertTrue(getAdminSession().nodeExists("/foo[1]/bar[1]"));
  assertTrue(node.hasNode("bar[1]"));
  assertTrue(node.hasProperty("bar[1]/jcr:primaryType"));
  assertTrue(getAdminSession().propertyExists("/foo[1]/bar[1]/jcr:primaryType"));
  assertFalse(getAdminSession().nodeExists("/foo[1]/bar[2]"));
  assertFalse(node.hasNode("bar[2]"));
  assertFalse(node.hasProperty("bar[2]/jcr:primaryType"));
  assertFalse(getAdminSession().propertyExists("/foo[1]/bar[2]/jcr:primaryType"));
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void accessRemovedProperty() throws RepositoryException {
  Node foo=getNode("/foo");
  Property p=foo.setProperty("name","value");
  p.remove();
  try {
    p.getPath();
    fail("Expected InvalidItemStateException");
  }
 catch (  InvalidItemStateException expected) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.ValueFactoryTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testWeakReferenceValue(){
  try {
    valueFactory.createValue("invalidIdentifier",PropertyType.WEAKREFERENCE);
    fail("Conversion to WEAK_REFERENCE value must validate identifier string ");
  }
 catch (  ValueFormatException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testReferenceValue(){
  try {
    valueFactory.createValue("invalidIdentifier",PropertyType.REFERENCE);
    fail("Conversion to REFERENCE value must validate identifier string ");
  }
 catch (  ValueFormatException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.nodetype.NodeTypeTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void removeNodeType() throws Exception {
  Session session=getAdminSession();
  Node root=session.getRootNode();
  ValueFactory vf=session.getValueFactory();
  NodeTypeManager manager=session.getWorkspace().getNodeTypeManager();
  Node n=root.addNode("q1","nt:query");
  n.setProperty("jcr:statement",vf.createValue("statement"));
  n.setProperty("jcr:language",vf.createValue("language"));
  session.save();
  try {
    manager.unregisterNodeType("nt:query");
    fail();
  }
 catch (  ConstraintViolationException expected) {
  }
  n.remove();
  session.save();
  try {
    manager.unregisterNodeType("nt:query");
  }
 catch (  ConstraintViolationException unexpected) {
    fail();
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void mixReferenceable() throws Exception {
  Session session=getAdminSession();
  Node a=session.getNode("/").addNode("a" + System.currentTimeMillis());
  a.setProperty("jcr:uuid",UUID.randomUUID().toString());
  session.save();
  try {
    Node b=session.getNode("/").addNode("b" + System.currentTimeMillis());
    b.addMixin(JcrConstants.MIX_REFERENCEABLE);
    b.setProperty("jcr:uuid",UUID.randomUUID().toString());
    session.save();
    fail();
  }
 catch (  ConstraintViolationException expected) {
  }
  Node c=session.getNode("/").addNode("c" + System.currentTimeMillis());
  c.setProperty("jcr:uuid",UUID.randomUUID().toString());
  c.addMixin(JcrConstants.MIX_REFERENCEABLE);
  session.save();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void updateNodeType() throws Exception {
  Session session=getAdminSession();
  Node root=session.getRootNode();
  ValueFactory vf=session.getValueFactory();
  NodeTypeManager manager=session.getWorkspace().getNodeTypeManager();
  Node n=root.addNode("q1","nt:query");
  n.setProperty("jcr:statement",vf.createValue("statement"));
  session.save();
  NodeTypeDefinition ntd=manager.getNodeType("nt:query");
  NodeTypeTemplate ntt=manager.createNodeTypeTemplate(ntd);
  try {
    manager.registerNodeType(ntt,true);
  }
 catch (  ConstraintViolationException unexpected) {
    fail();
  }
  @SuppressWarnings("unchecked") List<PropertyDefinitionTemplate> pdts=ntt.getPropertyDefinitionTemplates();
  for (  PropertyDefinitionTemplate pdt : pdts) {
    if ("jcr:language".equals(pdt.getName())) {
      pdt.setMandatory(true);
    }
  }
  try {
    manager.registerNodeType(ntt,true);
    fail();
  }
 catch (  ConstraintViolationException expected) {
  }
  n.setProperty("jcr:language",vf.createValue("language"));
  session.save();
  try {
    manager.registerNodeType(ntt,true);
  }
 catch (  ConstraintViolationException unexpected) {
    fail();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.query.PrefetchIteratorTest </h4><pre class="type-12 type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test(){
  for (  int size : seq(0,100)) {
    for (    int readBefore : seq(0,30)) {
      final long testTimeout=size % 3 == 0 ? 100 : 0;
      Iterable<Integer> s=seq(0,size);
      PrefetchIterator<Integer> it=new PrefetchIterator<Integer>(s.iterator(),new PrefetchOptions(){
{
          min=20;
          timeout=testTimeout;
          max=30;
          size=-1;
        }
      }
);
      for (      int x : seq(0,readBefore)) {
        boolean hasNext=it.hasNext();
        if (!hasNext) {
          assertEquals(x,size);
          break;
        }
        String m="s:" + size + " b:"+ readBefore+ " x:"+ x;
        assertTrue(m,hasNext);
        assertEquals(m,x,it.next().intValue());
      }
      String m="s:" + size + " b:"+ readBefore;
      int max=testTimeout <= 0 ? 20 : 30;
      if (size > max && readBefore <= size) {
        assertEquals(m,-1,it.size());
        assertEquals(m,-1,it.size());
      }
 else {
        assertEquals(m,size,it.size());
        assertEquals(m,size,it.size());
      }
      for (      int x : seq(readBefore,size)) {
        m="s:" + size + " b:"+ readBefore+ " x:"+ x;
        assertTrue(m,it.hasNext());
        assertEquals(m,x,it.next().intValue());
      }
      assertFalse(it.hasNext());
      try {
        it.next();
        fail();
      }
 catch (      NoSuchElementException e) {
      }
      try {
        it.remove();
        fail();
      }
 catch (      UnsupportedOperationException e) {
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.query.QueryTest </h4><pre class="type-5 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void noLiterals() throws RepositoryException {
  Session session=getAdminSession();
  ValueFactory vf=session.getValueFactory();
  QueryManager qm=session.getWorkspace().getQueryManager();
  try {
    Query q=qm.createQuery("select text from [nt:base] where password = 'x'",Query.JCR_SQL2 + "-noLiterals");
    q.execute();
    fail();
  }
 catch (  InvalidQueryException e) {
    assertTrue(e.toString(),e.toString().indexOf("literals of this type not allowed") > 0);
  }
  Query q=qm.createQuery("select text from [nt:base] where password = $p",Query.JCR_SQL2 + "-noLiterals");
  q.bindValue("p",vf.createValue("x"));
  q.execute();
}

</code></pre>

<br>
<pre class="type-5 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void doubleQuote() throws RepositoryException {
  Session session=getAdminSession();
  Node hello=session.getRootNode().addNode("hello");
  hello.setProperty("x",1);
  Node world=hello.addNode("world");
  world.setProperty("x",2);
  session.save();
  QueryManager qm=session.getWorkspace().getQueryManager();
  Query q;
  q=qm.createQuery("SELECT * FROM [nt:base] AS s WHERE ISDESCENDANTNODE(s,[/hello])",Query.JCR_SQL2);
  assertEquals("/hello/world",getPaths(q));
  q=qm.createQuery("SELECT * FROM [nt:base] AS s WHERE ISDESCENDANTNODE(s,\"/hello\")",Query.JCR_SQL2);
  assertEquals("/hello/world",getPaths(q));
  try {
    q=qm.createQuery("SELECT * FROM [nt:base] AS s WHERE ISDESCENDANTNODE(s,[\"/hello\"])",Query.JCR_SQL2);
    getPaths(q);
    fail();
  }
 catch (  InvalidQueryException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.authorization.AbstractAutoCreatedPropertyTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testReplaceNode() throws Exception {
  allow(path,privilegesFromNames(new String[]{Privilege.JCR_MODIFY_PROPERTIES,Privilege.JCR_NODE_TYPE_MANAGEMENT}));
  testSession.removeItem(targetNode.getPath());
  Node newNode=testSession.getNode(childNPath).addNode(targetNode.getName(),targetNode.getPrimaryNodeType().getName());
  newNode.addMixin(getMixinName());
  try {
    testSession.save();
    fail();
  }
 catch (  AccessDeniedException e) {
    testSession.refresh(false);
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testRemoveReAddMixin() throws Exception {
  allow(path,privilegesFromNames(new String[]{Privilege.JCR_ADD_CHILD_NODES,Privilege.JCR_REMOVE_NODE,Privilege.JCR_REMOVE_CHILD_NODES}));
  try {
    Node refNode=testSession.getNode(targetNode.getPath());
    refNode.removeMixin(getMixinName());
    refNode.addMixin(getMixinName());
    testSession.save();
    fail();
  }
 catch (  AccessDeniedException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testReplaceNode3() throws Exception {
  allow(path,privilegesFromNames(new String[]{Privilege.JCR_REMOVE_CHILD_NODES,Privilege.JCR_NODE_TYPE_MANAGEMENT}));
  testSession.removeItem(targetNode.getPath());
  Node newNode=testSession.getNode(childNPath).addNode(targetNode.getName(),targetNode.getPrimaryNodeType().getName());
  newNode.addMixin(getMixinName());
  try {
    testSession.save();
    fail();
  }
 catch (  AccessDeniedException e) {
    testSession.refresh(false);
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testReplaceNode2() throws Exception {
  allow(path,privilegesFromNames(new String[]{Privilege.JCR_ADD_CHILD_NODES,Privilege.JCR_NODE_TYPE_MANAGEMENT}));
  testSession.removeItem(targetNode.getPath());
  Node newNode=testSession.getNode(childNPath).addNode(targetNode.getName(),targetNode.getPrimaryNodeType().getName());
  newNode.addMixin(getMixinName());
  try {
    testSession.save();
    fail();
  }
 catch (  AccessDeniedException e) {
    testSession.refresh(false);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.authorization.AbstractMoveTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMove4() throws Exception {
  allow(path,privilegesFromName(PrivilegeConstants.REP_WRITE));
  move(childNPath,destPath);
  deny(path,privilegesFromName(Privilege.JCR_ADD_CHILD_NODES));
  try {
    move(destPath,childNPath);
    fail("Move requires addChildNodes and removeChildNodes privilege.");
  }
 catch (  AccessDeniedException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMove() throws Exception {
  allow(path,privilegesFromNames(new String[]{Privilege.JCR_ADD_CHILD_NODES,Privilege.JCR_NODE_TYPE_MANAGEMENT}));
  try {
    move(childNPath,destPath);
    fail("Move requires addChildNodes and removeChildNodes privilege.");
  }
 catch (  AccessDeniedException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMissingJcrAddChildNodesAtDestParent() throws Exception {
  allow(path,privilegesFromNames(new String[]{Privilege.JCR_ADD_CHILD_NODES,Privilege.JCR_REMOVE_CHILD_NODES}));
  try {
    move(childNPath,siblingDestPath);
    fail("Move requires addChildNodes privilege at dest parent");
  }
 catch (  AccessDeniedException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMove2() throws Exception {
  allow(path,modifyChildCollection);
  try {
    move(childNPath,destPath);
    fail("Move requires addChildNodes and removeChildNodes privilege.");
  }
 catch (  AccessDeniedException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMove2b() throws Exception {
  allow(path,privilegesFromNames(new String[]{Privilege.JCR_ADD_CHILD_NODES,Privilege.JCR_REMOVE_CHILD_NODES,Privilege.JCR_NODE_TYPE_MANAGEMENT}));
  try {
    move(childNPath,destPath);
    fail("Move requires addChildNodes and removeChildNodes privilege.");
  }
 catch (  AccessDeniedException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.authorization.AccessControlManagementTest </h4><pre class="type-9 type-5 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAccessControlModificationWithoutPrivilege() throws Exception {
  Privilege[] privileges=privilegesFromNames(new String[]{Privilege.JCR_ADD_CHILD_NODES,Privilege.JCR_REMOVE_CHILD_NODES,Privilege.JCR_MODIFY_PROPERTIES});
  JackrabbitAccessControlList tmpl=allow(path,privileges);
  String policyPath=tmpl.getPath() + "/rep:policy";
  assertTrue(superuser.itemExists(policyPath));
  try {
    testAcMgr.setPolicy(tmpl.getPath(),tmpl);
    fail("test user must not have MODIFY_AC privilege.");
  }
 catch (  AccessDeniedException e) {
  }
  try {
    testAcMgr.removePolicy(tmpl.getPath(),tmpl);
    fail("test user must not have MODIFY_AC privilege.");
  }
 catch (  AccessDeniedException e) {
  }
}

</code></pre>

<br>
<pre class="type-9 type-5 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAccessControlModification() throws Exception {
  Privilege[] privileges=privilegesFromNames(new String[]{Privilege.JCR_READ_ACCESS_CONTROL,Privilege.JCR_MODIFY_ACCESS_CONTROL});
  JackrabbitAccessControlList tmpl=allow(path,privileges);
  assertTrue(superuser.itemExists(tmpl.getPath() + "/rep:policy"));
  assertTrue(testAcMgr.hasPrivileges(path,privilegesFromName(Privilege.JCR_MODIFY_ACCESS_CONTROL)));
  AccessControlPolicy[] policies=testAcMgr.getPolicies(path);
  testAcMgr.getPolicies(childNPath);
  try {
    testAcMgr.getPolicies(siblingPath);
    fail("READ_AC privilege must not apply outside of the tree it has applied to.");
  }
 catch (  AccessDeniedException e) {
  }
  assertFalse(testAcMgr.hasPrivileges(siblingPath,privilegesFromName(Privilege.JCR_MODIFY_ACCESS_CONTROL)));
  AccessControlList acl=(AccessControlList)policies[0];
  acl.addAccessControlEntry(testUser.getPrincipal(),repWritePrivileges);
  testAcMgr.setPolicy(path,acl);
  testSession.save();
  assertTrue(testAcMgr.hasPrivileges(path,privilegesFromName(Privilege.JCR_REMOVE_CHILD_NODES)));
  testAcMgr.removePolicy(path,policies[0]);
  testSession.save();
  try {
    testAcMgr.getEffectivePolicies(childNPath);
    fail("READ_AC privilege has been revoked -> must throw again.");
  }
 catch (  AccessDeniedException e) {
  }
  assertReadOnly(path);
}

</code></pre>

<br>
<pre class="type-5 type-7 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadAccessControlWithRestriction() throws Exception {
  Privilege[] privileges=privilegesFromName(Privilege.JCR_READ_ACCESS_CONTROL);
  allow(path,privileges,createGlobRestriction('/' + nodeName2));
  assertFalse(testAcMgr.hasPrivileges(path,privileges));
  assertFalse(testSession.nodeExists(path + "/rep:policy"));
  try {
    testAcMgr.getPolicies(path);
    fail("AccessDeniedException expected");
  }
 catch (  AccessDeniedException e) {
  }
  assertTrue(testAcMgr.hasPrivileges(childNPath,privileges));
  assertEquals(0,testAcMgr.getPolicies(childNPath).length);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testReorderPolicyNode() throws Exception {
  Node n=testSession.getNode(path);
  try {
    if (!n.getPrimaryNodeType().hasOrderableChildNodes()) {
      throw new NotExecutableException("Reordering child nodes is not supported..");
    }
    n.orderBefore(Text.getName(childNPath2),Text.getName(childNPath));
    testSession.save();
    fail("test session must not be allowed to reorder nodes.");
  }
 catch (  AccessDeniedException e) {
  }
  allow(path,privilegesFromNames(new String[]{Privilege.JCR_ALL}));
  n.orderBefore(Text.getName(childNPath2),Text.getName(childNPath));
  testSession.save();
  n.orderBefore("rep:policy",Text.getName(childNPath2));
  testSession.save();
}

</code></pre>

<br>
<pre class="type-13 type-12 type-5 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAcContentIsProtected() throws Exception {
  Node policyNode=findPolicyNode(superuser.getRootNode());
  if (policyNode == null) {
    throw new NotExecutableException("no policy node found.");
  }
  assertTrue("The rep:Policy node must be protected",policyNode.getDefinition().isProtected());
  try {
    policyNode.remove();
    fail("rep:Policy node must be protected.");
  }
 catch (  ConstraintViolationException e) {
  }
  for (NodeIterator it=policyNode.getNodes(); it.hasNext(); ) {
    Node n=it.nextNode();
    if (n.isNodeType("rep:ACE")) {
      try {
        n.remove();
        fail("ACE node must be protected.");
      }
 catch (      ConstraintViolationException e) {
      }
      break;
    }
  }
  try {
    policyNode.setProperty("test","anyvalue");
    fail("rep:policy node must be protected.");
  }
 catch (  ConstraintViolationException e) {
  }
  try {
    policyNode.addNode("test","rep:ACE");
    fail("rep:policy node must be protected.");
  }
 catch (  ConstraintViolationException e) {
  }
}

</code></pre>

<br>
<pre class="type-13 type-9 type-12 type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRetrievePrivilegesOnAcNodes() throws Exception {
  Privilege[] privileges=privilegesFromName(Privilege.JCR_READ_ACCESS_CONTROL);
  allow(path,privileges);
  assertTrue(testAcMgr.hasPrivileges(path,privileges));
  AccessControlPolicy[] policies=testAcMgr.getPolicies(path);
  assertEquals(1,policies.length);
  assertTrue(policies[0] instanceof JackrabbitAccessControlList);
  String aclNodePath=null;
  Node n=superuser.getNode(path);
  for (NodeIterator itr=n.getNodes(); itr.hasNext(); ) {
    Node child=itr.nextNode();
    if (child.isNodeType("rep:Policy")) {
      aclNodePath=child.getPath();
    }
  }
  if (aclNodePath == null) {
    fail("Expected node at " + path + " to have an ACL child node.");
  }
  assertTrue(testAcMgr.hasPrivileges(aclNodePath,privileges));
  assertTrue(testSession.hasPermission(aclNodePath,Session.ACTION_READ));
  for (NodeIterator aceNodes=superuser.getNode(aclNodePath).getNodes(); aceNodes.hasNext(); ) {
    String aceNodePath=aceNodes.nextNode().getPath();
    assertTrue(testAcMgr.hasPrivileges(aceNodePath,privileges));
    assertTrue(testSession.hasPermission(aceNodePath,Session.ACTION_READ));
  }
}

</code></pre>

<br>
<pre class="type-13 type-9 type-5 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadAccessControlWithoutPrivilege() throws Exception {
  Privilege[] privileges=privilegesFromName(Privilege.JCR_READ);
  JackrabbitAccessControlList tmpl=allow(path,privileges);
  String policyPath=tmpl.getPath() + "/rep:policy";
  assertTrue(superuser.itemExists(policyPath));
  assertFalse(testAcMgr.hasPrivileges(path,privilegesFromName(Privilege.JCR_READ_ACCESS_CONTROL)));
  assertFalse(testSession.itemExists(policyPath));
  assertFalse(testSession.nodeExists(policyPath));
  try {
    testSession.getNode(policyPath);
    fail("Accessing the rep:policy node must throw PathNotFoundException.");
  }
 catch (  PathNotFoundException e) {
  }
  try {
    testAcMgr.getPolicies(tmpl.getPath());
    fail("test user must not have READ_AC privilege.");
  }
 catch (  AccessDeniedException e) {
  }
  try {
    testAcMgr.getEffectivePolicies(tmpl.getPath());
    fail("test user must not have READ_AC privilege.");
  }
 catch (  AccessDeniedException e) {
  }
  for (NodeIterator aceNodes=superuser.getNode(policyPath).getNodes(); aceNodes.hasNext(); ) {
    Node aceNode=aceNodes.nextNode();
    String aceNodePath=aceNode.getPath();
    assertFalse(testSession.nodeExists(aceNodePath));
    for (PropertyIterator it=aceNode.getProperties(); it.hasNext(); ) {
      assertFalse(testSession.propertyExists(it.nextProperty().getPath()));
    }
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRemovePolicyWithoutPrivilege() throws Exception {
  Privilege[] privileges=privilegesFromName(Privilege.JCR_READ);
  AccessControlPolicy policy=allow(path,privileges);
  assertFalse(testAcMgr.hasPrivileges(path,privilegesFromName(Privilege.JCR_MODIFY_ACCESS_CONTROL)));
  try {
    testAcMgr.removePolicy(path,policy);
    fail("Test user must not be allowed to remove the access control policy.");
  }
 catch (  AccessDeniedException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.authorization.CopyTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCopyNoWritePermissionAtTarget() throws Exception {
  try {
    testSession.getWorkspace().copy(path,destPath);
    fail("no write permission at copy target");
  }
 catch (  AccessDeniedException e) {
  }
}

</code></pre>

<br>
<pre class="type-9 type-5 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @see <a href="https://issues.apache.org/jira/browse/OAK-2810">OAK-2810</a>
 */
@Test public void testCopyToProtectedParentDestination() throws Exception {
  allow(targetPath,privilegesFromName(Privilege.JCR_ALL));
  Node destParent=null;
  NodeIterator nodeIterator=superuser.getNode(targetPath).getNode(AccessControlConstants.REP_POLICY).getNodes();
  while (nodeIterator.hasNext()) {
    Node n=nodeIterator.nextNode();
    if (n.getDefinition().isProtected()) {
      destParent=n;
      break;
    }
  }
  if (destParent == null) {
    throw new NotExecutableException("No protected parent found");
  }
  try {
    superuser.getWorkspace().copy(childNPath,destParent.getPath() + "/copy");
    fail("Copy must fail with constraint-violation if the destination parent is a protected node.");
  }
 catch (  ConstraintViolationException e) {
    assertEquals("Node " + destParent.getPath() + " is protected.",e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCopyWithInsufficientPermissions() throws Exception {
  allow(targetPath,privilegesFromName(Privilege.JCR_ADD_CHILD_NODES));
  try {
    testSession.getWorkspace().copy(path,destPath);
    fail("insufficient write permission at copy target");
  }
 catch (  AccessDeniedException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.authorization.ImportAbortTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testImportUnknownPrincipal() throws Exception {
  try {
    runImport();
    fail("Import with unknown principal must fail.");
  }
 catch (  AccessControlException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.authorization.MultipleMoveTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMoveSubTreeBack() throws Exception {
  setupMovePermissions(path,siblingPath);
  try {
    move(childNPath,siblingDestPath);
    move(siblingDestPath + '/' + nodeName3,path + "/subtreeBack");
    testSession.save();
    fail();
  }
 catch (  AccessDeniedException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMoveDestParent3() throws Exception {
  setupMovePermissions(path,siblingPath);
  try {
    move(childNPath,siblingDestPath);
    move(siblingPath,childNPath);
    testSession.save();
    fail();
  }
 catch (  AccessDeniedException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMoveSubTreeBack3() throws Exception {
  setupMovePermissions(path,siblingPath);
  try {
    move(childNPath,siblingDestPath);
    move(siblingDestPath + '/' + nodeName3,childNPath);
    testSession.save();
    fail();
  }
 catch (  AccessDeniedException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMoveDestParent() throws Exception {
  setupMovePermissions(path,siblingPath);
  try {
    move(childNPath,siblingDestPath);
    move(siblingPath,path + "/parentMove");
    testSession.save();
    fail();
  }
 catch (  AccessDeniedException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.authorization.NamespaceManagementTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testUnregisterNamespace() throws Exception {
  Workspace wsp=superuser.getWorkspace();
  String pfx=getNewNamespacePrefix(wsp);
  wsp.getNamespaceRegistry().registerNamespace(pfx,getNewNamespaceURI(wsp));
  try {
    Workspace testWsp=testSession.getWorkspace();
    testWsp.getNamespaceRegistry().unregisterNamespace(pfx);
    fail("Namespace unregistration should be denied.");
  }
 catch (  AccessDeniedException e) {
  }
 finally {
    try {
      superuser.getWorkspace().getNamespaceRegistry().unregisterNamespace(pfx);
    }
 catch (    Exception e) {
    }
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testRegisterNamespace() throws Exception {
  try {
    Workspace testWsp=testSession.getWorkspace();
    testWsp.getNamespaceRegistry().registerNamespace(getNewNamespacePrefix(testWsp),getNewNamespaceURI(testWsp));
    fail("Namespace registration should be denied.");
  }
 catch (  AccessDeniedException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.authorization.NodeTypeDefinitionManagementTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testUnRegisterNodeType() throws Exception {
  NodeTypeManager ntm=superuser.getWorkspace().getNodeTypeManager();
  NodeTypeTemplate ntd=ntm.createNodeTypeTemplate();
  ntd.setName("testUnregisterNodeType");
  ntd.setMixin(true);
  ntm.registerNodeType(ntd,true);
  Workspace testWsp=testSession.getWorkspace();
  try {
    try {
      NodeTypeManager testNtm=testWsp.getNodeTypeManager();
      testNtm.unregisterNodeType(ntd.getName());
      fail("Node type unregistration should be denied.");
    }
 catch (    AccessDeniedException e) {
    }
    try {
      NodeTypeManager testNtm=testWsp.getNodeTypeManager();
      testNtm.unregisterNodeTypes(new String[]{ntd.getName()});
      fail("Node type unregistration should be denied.");
    }
 catch (    AccessDeniedException e) {
    }
  }
  finally {
    ntm.unregisterNodeType(ntd.getName());
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testRegisterNodeType() throws Exception {
  Workspace testWsp=testSession.getWorkspace();
  NodeTypeManager ntm=testWsp.getNodeTypeManager();
  NodeTypeTemplate ntd=ntm.createNodeTypeTemplate();
  ntd.setName("testRegisterNodeType");
  ntd.setMixin(true);
  try {
    ntm.registerNodeType(ntd,true);
    fail("Node type registration should be denied.");
  }
 catch (  AccessDeniedException e) {
  }
  try {
    ntm.registerNodeType(ntd,false);
    fail("Node type registration should be denied.");
  }
 catch (  AccessDeniedException e) {
  }
  NodeTypeTemplate[] ntds=new NodeTypeTemplate[2];
  ntds[0]=ntd;
  ntds[1]=ntm.createNodeTypeTemplate();
  ntds[1].setName("anotherRegisterNodeType");
  ntds[1].setDeclaredSuperTypeNames(new String[]{"nt:file"});
  try {
    ntm.registerNodeTypes(ntds,true);
    fail("Node type registration should be denied.");
  }
 catch (  AccessDeniedException e) {
  }
  try {
    ntm.registerNodeTypes(ntds,false);
    fail("Node type registration should be denied.");
  }
 catch (  AccessDeniedException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.authorization.NodeTypeManagementTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testWorkspaceMove() throws Exception {
  Workspace wsp=testSession.getWorkspace();
  String parentPath=childNode.getParent().getPath();
  String srcPath=childNode.getPath();
  String destPath=parentPath + "/destination";
  try {
    wsp.move(srcPath,destPath);
    fail("Missing write privilege.");
  }
 catch (  AccessDeniedException e) {
  }
  modify(parentPath,Privilege.JCR_WRITE,true);
  try {
    wsp.move(srcPath,destPath);
    fail("Missing privilege jcr:nodeTypeManagement.");
  }
 catch (  AccessDeniedException e) {
  }
  modify(parentPath,REP_WRITE,true);
  wsp.move(srcPath,destPath);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testSessionImportXML() throws Exception {
  String parentPath=childNode.getPath();
  try {
    testSession.importXML(parentPath,getXmlForImport(),ImportUUIDBehavior.IMPORT_UUID_CREATE_NEW);
    testSession.save();
    fail("Missing write privilege.");
  }
 catch (  AccessDeniedException e) {
  }
 finally {
    testSession.refresh(false);
  }
  modify(parentPath,Privilege.JCR_WRITE,true);
  try {
    testSession.importXML(parentPath,getXmlForImport(),ImportUUIDBehavior.IMPORT_UUID_CREATE_NEW);
    testSession.save();
    fail("Missing privilege jcr:nodeTypeManagement.");
  }
 catch (  AccessDeniedException e) {
  }
 finally {
    testSession.refresh(false);
  }
  modify(parentPath,REP_WRITE,true);
  testSession.importXML(parentPath,getXmlForImport(),ImportUUIDBehavior.IMPORT_UUID_CREATE_NEW);
  testSession.save();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * Test difference between common jcr:write privilege an rep:write privilege
 * that includes the ability to set the primary node type upon child node
 * creation.
 */
@Test public void testAddNode() throws Exception {
  modify(childNode.getPath(),Privilege.JCR_WRITE,true);
  addChildNode(false);
  try {
    addChildNode(true);
    fail("Missing privilege jcr:nodeTypeManagement.");
  }
 catch (  AccessDeniedException e) {
  }
  modify(childNode.getPath(),Privilege.JCR_NODE_TYPE_MANAGEMENT,true);
  addChildNode(false);
  addChildNode(true);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testRemoveMixinWithoutPermission() throws Exception {
  ((Node)superuser.getItem(childNode.getPath())).addMixin(mixinName);
  superuser.save();
  testSession.refresh(false);
  try {
    childNode.removeMixin(mixinName);
    testSession.save();
    fail("TestSession does not have sufficient privileges to remove a mixin type.");
  }
 catch (  AccessDeniedException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCopy() throws Exception {
  Workspace wsp=testSession.getWorkspace();
  String parentPath=childNode.getParent().getPath();
  String srcPath=childNode.getPath();
  String destPath=parentPath + "/destination";
  try {
    wsp.copy(srcPath,destPath);
    fail("Missing write privilege.");
  }
 catch (  AccessDeniedException e) {
  }
  modify(parentPath,Privilege.JCR_WRITE,true);
  try {
    wsp.copy(srcPath,destPath);
    fail("Missing privilege jcr:nodeTypeManagement.");
  }
 catch (  AccessDeniedException e) {
  }
  modify(parentPath,REP_WRITE,true);
  wsp.copy(srcPath,destPath);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testAddMixinWithoutPermission() throws Exception {
  try {
    childNode.addMixin(mixinName);
    testSession.save();
    fail("TestSession does not have sufficient privileges to add a mixin type.");
  }
 catch (  AccessDeniedException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testSessionMove() throws Exception {
  String parentPath=childNode.getParent().getPath();
  String srcPath=childNode.getPath();
  String destPath=parentPath + "/destination";
  try {
    testSession.move(srcPath,destPath);
    testSession.save();
    fail("Missing write privilege.");
  }
 catch (  AccessDeniedException e) {
  }
  modify(parentPath,Privilege.JCR_WRITE,true);
  try {
    testSession.move(srcPath,destPath);
    testSession.save();
    fail("Missing privilege jcr:nodeTypeManagement.");
  }
 catch (  AccessDeniedException e) {
  }
  modify(parentPath,REP_WRITE,true);
  testSession.move(srcPath,destPath);
  testSession.save();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testSetPrimaryTypeWithoutPrivilege() throws Exception {
  Node child=(Node)superuser.getItem(childNode.getPath());
  String ntName=child.getPrimaryNodeType().getName();
  try {
    childNode.setPrimaryType("nt:folder");
    testSession.save();
    fail("TestSession does not have sufficient privileges to change the primary type.");
  }
 catch (  AccessDeniedException e) {
  }
 finally {
    testSession.refresh(false);
    if (!ntName.equals(child.getPrimaryNodeType().getName())) {
      child.setPrimaryType(ntName);
      superuser.save();
    }
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testWorkspaceImportXML() throws Exception {
  Workspace wsp=testSession.getWorkspace();
  String parentPath=childNode.getPath();
  try {
    wsp.importXML(parentPath,getXmlForImport(),ImportUUIDBehavior.IMPORT_UUID_CREATE_NEW);
    fail("Missing write privilege.");
  }
 catch (  AccessDeniedException e) {
  }
  modify(parentPath,Privilege.JCR_WRITE,true);
  try {
    wsp.importXML(parentPath,getXmlForImport(),ImportUUIDBehavior.IMPORT_UUID_CREATE_NEW);
    fail("Missing privilege jcr:nodeTypeManagement.");
  }
 catch (  AccessDeniedException e) {
  }
  modify(parentPath,REP_WRITE,true);
  wsp.importXML(parentPath,getXmlForImport(),ImportUUIDBehavior.IMPORT_UUID_CREATE_NEW);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.authorization.ObservationTest </h4><pre class="type-12 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testEventGeneration() throws Exception {
  deny(path,readPrivileges);
  ObservationManager obsMgr=testSession.getWorkspace().getObservationManager();
  EventResult listener=new EventResult(this.log);
  try {
    obsMgr.addEventListener(listener,Event.NODE_REMOVED,path,true,new String[0],new String[0],true);
    superuser.getItem(childNPath).remove();
    superuser.save();
    obsMgr.removeEventListener(listener);
    Event[] evts=listener.getEvents(DEFAULT_WAIT_TIMEOUT);
    for (    Event evt : evts) {
      if (evt.getType() == Event.NODE_REMOVED && evt.getPath().equals(childNPath)) {
        fail("TestUser does not have READ permission below " + path + " -> events below must not show up.");
      }
    }
  }
  finally {
    obsMgr.removeEventListener(listener);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.authorization.PrivilegeManagementTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testRegisterPrivilege() throws Exception {
  try {
    Workspace testWsp=testSession.getWorkspace();
    ((JackrabbitWorkspace)testWsp).getPrivilegeManager().registerPrivilege(getNewPrivilegeName(testWsp),false,new String[0]);
    fail("Privilege registration should be denied.");
  }
 catch (  AccessDeniedException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.authorization.ReadPropertyTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testGetParent() throws Exception {
  deny(path,privilegesFromName(PrivilegeConstants.REP_READ_NODES));
  List<String> propertyPaths=new ArrayList<String>();
  propertyPaths.add(childPPath);
  propertyPaths.add(childchildPPath);
  propertyPaths.add(path + "/jcr:primaryType");
  for (  String pPath : propertyPaths) {
    Property p=testSession.getProperty(pPath);
    try {
      Node n=p.getParent();
      fail();
    }
 catch (    AccessDeniedException e) {
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.authorization.ReadTest </h4><pre class="type-5 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeniedReadOnSubTree() throws Exception {
  deny(childNPath,readPrivileges);
  assertTrue(testSession.hasPermission(path,Session.ACTION_READ));
  Node n=testSession.getNode(path);
  testSession.getNode(childNPath2);
  assertTrue(n.getProperties().hasNext());
  assertFalse(testSession.itemExists(childNPath));
  try {
    testSession.getNode(childNPath);
    fail("Read access has been denied -> cannot retrieve child node.");
  }
 catch (  PathNotFoundException e) {
  }
  assertFalse(testSession.itemExists(childchildPPath));
  try {
    testSession.getItem(childchildPPath);
    fail("Read access has been denied -> cannot retrieve prop below child node.");
  }
 catch (  PathNotFoundException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testDenyPath() throws Exception {
  try {
    deny(path,readPrivileges);
    testSession.getNode(path);
    fail("nodet should not be accessible");
  }
 catch (  Exception e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testDenyRoot() throws Exception {
  try {
    deny("/",readPrivileges);
    testSession.getRootNode();
    fail("root should not be accessible");
  }
 catch (  Exception e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.authorization.ReadVersionContentTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * @since oak
 */
@Test public void testVersionHistoryParent() throws Exception {
  Node testNode=testSession.getNode(versionablePath);
  VersionHistory testVh=testNode.getVersionHistory();
  try {
    testVh.getParent();
    fail("version storage intermediate node must not be accessible");
  }
 catch (  AccessDeniedException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @since oak
 */
@Test public void testAccessVersionHistoryVersionableNodeNotAccessible() throws Exception {
  modify(versionablePath,Privilege.JCR_READ,false);
  assertFalse(testSession.nodeExists(versionablePath));
  try {
    VersionHistory history=(VersionHistory)testSession.getNode(vh.getPath());
    fail("Access to version history should be denied if versionable node is not accessible");
  }
 catch (  PathNotFoundException e) {
  }
  try {
    VersionHistory history=(VersionHistory)testSession.getNodeByIdentifier(vh.getIdentifier());
    fail("Access to version history should be denied if versionable node is not accessible");
  }
 catch (  ItemNotFoundException e) {
  }
  try {
    VersionHistory history=(VersionHistory)testSession.getNodeByUUID(vh.getUUID());
    fail("Access to version history should be denied if versionable node is not accessible");
  }
 catch (  ItemNotFoundException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @since oak
 */
@Test public void testGetVersionHistoryParentNode() throws Exception {
  String vhParentPath=Text.getRelativeParent(vh.getPath(),1);
  assertFalse(testSession.nodeExists(vhParentPath));
  try {
    testSession.getNode(vhParentPath);
    fail("version storage intermediate node must not be accessible");
  }
 catch (  PathNotFoundException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.authorization.RenameTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testRename() throws Exception {
  Node child=testSession.getNode(childNPath);
  try {
    ((JackrabbitNode)child).rename("rename");
    testSession.save();
    fail("test session must not be allowed to rename nodes.");
  }
 catch (  AccessDeniedException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testRename2() throws Exception {
  allow(path,privilegesFromNames(new String[]{Privilege.JCR_ADD_CHILD_NODES,Privilege.JCR_NODE_TYPE_MANAGEMENT}));
  Node child=testSession.getNode(childNPath);
  try {
    ((JackrabbitNode)child).rename("rename");
    testSession.save();
    fail("test session must not be allowed to rename nodes.");
  }
 catch (  AccessDeniedException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.authorization.SessionMoveTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMoveAndAddReplacementAtSource2() throws Exception {
  allow(siblingPath,privilegesFromNames(new String[]{PrivilegeConstants.JCR_ADD_CHILD_NODES,PrivilegeConstants.JCR_NODE_TYPE_MANAGEMENT}));
  testSession.move(nodePath3,siblingDestPath);
  Node sourceParent=testSession.getNode(childNPath);
  Node replacement=sourceParent.addNode(Text.getName(nodePath3));
  replacement.setProperty("movedProp","val");
  try {
    testSession.save();
    fail("Missing REMOVE_NODE permission for move source.");
  }
 catch (  AccessDeniedException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMoveAndAddReplacementAtSource() throws Exception {
  allow(path,privilegesFromNames(new String[]{Privilege.JCR_REMOVE_CHILD_NODES,Privilege.JCR_ADD_CHILD_NODES}));
  allow(siblingPath,privilegesFromNames(new String[]{PrivilegeConstants.JCR_ADD_CHILD_NODES,PrivilegeConstants.JCR_NODE_TYPE_MANAGEMENT}));
  testSession.move(nodePath3,siblingDestPath);
  Node sourceParent=testSession.getNode(childNPath);
  Node replacement=sourceParent.addNode(Text.getName(nodePath3));
  replacement.setProperty("movedProp","val");
  try {
    testSession.save();
    fail("Missing ADD_NODE and ADD_PROPERTY permission on source parent.");
  }
 catch (  AccessDeniedException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMoveAndAddProperty() throws Exception {
  setupMovePermissions();
  testSession.move(nodePath3,siblingDestPath);
  Node destNode=testSession.getNode(siblingDestPath);
  Property p=destNode.setProperty("newProp","val");
  try {
    testSession.save();
    fail("Missing ADD_PROPERTY permission.");
  }
 catch (  AccessDeniedException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMoveAddSubTreeWithRestriction() throws Exception {
  allow(path,testUser.getPrincipal(),readWritePrivileges);
  deny(path,privilegesFromName(PrivilegeConstants.JCR_ADD_CHILD_NODES),createGlobRestriction("*/" + nodeName3));
  testSession.move(childNPath,childNPath2 + "/dest");
  Node dest=testSession.getNode(childNPath2 + "/dest");
  dest.getNode(nodeName3).addNode(nodeName4);
  try {
    testSession.save();
    fail("Adding child node must be denied.");
  }
 catch (  AccessDeniedException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMoveAndRemoveSubTree2() throws Exception {
  allow(path,privilegesFromNames(new String[]{Privilege.JCR_REMOVE_CHILD_NODES,Privilege.JCR_REMOVE_NODE}));
  allow(siblingPath,privilegesFromNames(new String[]{Privilege.JCR_ADD_CHILD_NODES,Privilege.JCR_NODE_TYPE_MANAGEMENT}));
  deny(testSession.getNode(nodePath3).getPath(),privilegesFromName(Privilege.JCR_REMOVE_NODE));
  try {
    testSession.move(childNPath,siblingDestPath);
    Node moved=testSession.getNode(siblingDestPath);
    Node child=moved.getNode(nodeName3);
    child.remove();
    testSession.save();
    fail("Removing subtree after move requires 'jcr:removeNode' on the removed child.");
  }
 catch (  AccessDeniedException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMoveRemoveSubTreeWithRestriction2() throws Exception {
  allow(path,testUser.getPrincipal(),readWritePrivileges);
  deny(path,privilegesFromName(PrivilegeConstants.JCR_REMOVE_CHILD_NODES),createGlobRestriction("*/" + Text.getName(childNPath)));
  assertTrue(testSession.nodeExists(childNPath));
  assertTrue(testSession.hasPermission(childNPath,Session.ACTION_REMOVE));
  assertTrue(testSession.hasPermission(childNPath2,Session.ACTION_ADD_NODE));
  testSession.move(childNPath,childNPath2 + "/dest");
  Node dest=testSession.getNode(childNPath2 + "/dest");
  dest.getNode(nodeName3).remove();
  try {
    testSession.save();
    fail("Removing child node must be denied.");
  }
 catch (  AccessDeniedException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMoveAndAddSubTree() throws Exception {
  allow(path,privilegesFromName(Privilege.JCR_REMOVE_CHILD_NODES));
  allow(childNPath,privilegesFromName(Privilege.JCR_REMOVE_NODE));
  allow(siblingPath,privilegesFromNames(new String[]{PrivilegeConstants.JCR_ADD_CHILD_NODES,PrivilegeConstants.JCR_NODE_TYPE_MANAGEMENT}));
  testSession.move(childNPath,siblingDestPath);
  Node moved=testSession.getNode(siblingDestPath);
  Node child=moved.getNode(nodeName3);
  child.addNode(nodeName4);
  try {
    testSession.save();
    fail("Adding child node at moved node must be denied: no add_child_node privilege at original location.");
  }
 catch (  AccessDeniedException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMoveAndAddPropertyAtSource() throws Exception {
  setupMovePermissions();
  testSession.move(nodePath3,siblingDestPath);
  Node n=testSession.getNode(childNPath);
  Property p=n.setProperty("newProp","val");
  try {
    testSession.save();
    fail("Missing ADD_PROPERTY permission.");
  }
 catch (  AccessDeniedException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMoveRemoveSubTreeWithRestriction() throws Exception {
  allow(path,testUser.getPrincipal(),readWritePrivileges);
  deny(path,privilegesFromName(PrivilegeConstants.JCR_REMOVE_NODE),createGlobRestriction("*/" + nodeName3));
  assertTrue(testSession.nodeExists(childNPath));
  assertTrue(testSession.hasPermission(childNPath,Session.ACTION_REMOVE));
  assertTrue(testSession.hasPermission(childNPath2,Session.ACTION_ADD_NODE));
  testSession.move(childNPath,childNPath2 + "/dest");
  Node dest=testSession.getNode(childNPath2 + "/dest");
  dest.getNode(nodeName3).remove();
  try {
    testSession.save();
    fail("Removing child node must be denied.");
  }
 catch (  AccessDeniedException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMoveAndRemoveSubTree() throws Exception {
  allow(path,privilegesFromName(Privilege.JCR_REMOVE_CHILD_NODES));
  allow(siblingPath,privilegesFromNames(new String[]{Privilege.JCR_ADD_CHILD_NODES,Privilege.JCR_NODE_TYPE_MANAGEMENT}));
  testSession.move(childNPath,siblingDestPath);
  Node moved=testSession.getNode(siblingDestPath);
  Node child=moved.getNode(nodeName3);
  try {
    child.remove();
    testSession.save();
    fail("Removing subtree after move requires 'jcr:removeNode' privilege on the target");
  }
 catch (  AccessDeniedException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMoveAndAddAtSourceParent() throws Exception {
  allow(path,privilegesFromName(Privilege.JCR_REMOVE_CHILD_NODES));
  allow(childNPath,privilegesFromName(Privilege.JCR_REMOVE_NODE));
  allow(siblingPath,privilegesFromNames(new String[]{PrivilegeConstants.JCR_ADD_CHILD_NODES,PrivilegeConstants.JCR_NODE_TYPE_MANAGEMENT}));
  testSession.move(childNPath,siblingDestPath);
  Node sourceParent=testSession.getNode(path);
  sourceParent.addNode(nodeName4);
  try {
    testSession.save();
    fail("Adding child node at source parent be denied: missing add_child_node privilege.");
  }
 catch (  AccessDeniedException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMoveAndAddAtSourceParent2() throws Exception {
  allow(path,privilegesFromName(Privilege.JCR_REMOVE_CHILD_NODES));
  allow(childNPath,privilegesFromName(Privilege.JCR_REMOVE_NODE));
  allow(siblingPath,privilegesFromNames(new String[]{PrivilegeConstants.JCR_ADD_CHILD_NODES,PrivilegeConstants.JCR_NODE_TYPE_MANAGEMENT}));
  allow(nodePath3,privilegesFromName(Privilege.JCR_ADD_CHILD_NODES));
  testSession.move(childNPath,siblingDestPath);
  Node sourceParent=testSession.getNode(path);
  sourceParent.addNode(nodeName4);
  try {
    testSession.save();
    fail("Adding child node at source parent be denied: missing add_child_node privilege.");
  }
 catch (  AccessDeniedException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMoveAndModifyProperty2() throws Exception {
  setupMovePermissions();
  allow(siblingPath,privilegesFromName(PrivilegeConstants.REP_ALTER_PROPERTIES));
  testSession.move(nodePath3,siblingDestPath);
  Node destNode=testSession.getNode(siblingDestPath);
  destNode.setProperty("movedProp","modified");
  try {
    testSession.save();
    fail("Missing MODIFY_PROPERTY permission.");
  }
 catch (  AccessDeniedException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMoveAndRemoveProperty() throws Exception {
  setupMovePermissions();
  testSession.move(nodePath3,siblingDestPath);
  Node destNode=testSession.getNode(siblingDestPath);
  destNode.getProperty("movedProp").remove();
  try {
    testSession.save();
    fail("Missing REMOVE_PROPERTY permission.");
  }
 catch (  AccessDeniedException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMoveAndRemovePropertyAtSource() throws Exception {
  setupMovePermissions();
  testSession.move(nodePath3,siblingDestPath);
  Node n=testSession.getNode(childNPath);
  assertTrue(n.hasProperty(propertyName1));
  n.getProperty(propertyName1).remove();
  try {
    testSession.save();
    fail("Missing REMOVE_PROPERTY permission.");
  }
 catch (  AccessDeniedException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMoveAndModifyProperty() throws Exception {
  setupMovePermissions();
  testSession.move(nodePath3,siblingDestPath);
  Node destNode=testSession.getNode(siblingDestPath);
  destNode.setProperty("movedProp","modified");
  try {
    testSession.save();
    fail("Missing MODIFY_PROPERTY permission.");
  }
 catch (  AccessDeniedException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMoveAndModifyPropertyAtSource() throws Exception {
  setupMovePermissions();
  testSession.move(nodePath3,siblingDestPath);
  Node n=testSession.getNode(childNPath);
  assertTrue(n.hasProperty(propertyName1));
  n.setProperty(propertyName1,"modified");
  try {
    testSession.save();
    fail("Missing MODIFY_PROPERTY permission.");
  }
 catch (  AccessDeniedException e) {
  }
  allow(childNPath,privilegesFromName(PrivilegeConstants.REP_ALTER_PROPERTIES));
  testSession.save();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.authorization.UserManagementTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testChangeUserPropertiesWithoutPermission2() throws Exception {
  createUser(userId);
  modify("/",PrivilegeConstants.REP_USER_MANAGEMENT,true);
  UserManager testUserMgr=getUserManager(testSession);
  try {
    Authorizable a=testUserMgr.getAuthorizable(userId);
    a.setProperty("someProp",testSession.getValueFactory().createValue("value"));
    testSession.save();
    fail("Test session doesn't have sufficient permission to alter user properties.");
  }
 catch (  AccessDeniedException e) {
  }
}

</code></pre>

<br>
<pre class="type-13 type-12 type-5 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @see <a href="https://issues.apache.org/jira/browse/JCR-3412">JCR-3412 :
     *      UserManager.findAuthorizables() does not work, if session does not have
     *      read access to common root of all user and groups. </a>
 */
@Test public void testFindAuthorizables() throws Exception {
  String home=Text.getRelativeParent(UserConstants.DEFAULT_USER_PATH,1);
  deny(home,privilegesFromName(PrivilegeConstants.JCR_READ));
  allow(getUserManager(superuser).getAuthorizable(testSession.getUserID()).getPath(),privilegesFromName(PrivilegeConstants.JCR_ALL));
  UserManager testUserMgr=getUserManager(testSession);
  Iterator<Authorizable> result=testUserMgr.findAuthorizables(UserConstants.REP_PRINCIPAL_NAME,null,UserManager.SEARCH_TYPE_USER);
  Set<String> ids=new HashSet<String>();
  while (result.hasNext()) {
    ids.add(result.next().getID());
  }
  assertFalse(ids.isEmpty());
  NodeIterator nodeIterator=testSession.getWorkspace().getQueryManager().createQuery("/jcr:root//element(*,rep:User)",Query.XPATH).execute().getNodes();
  assertTrue(nodeIterator.hasNext());
  while (nodeIterator.hasNext()) {
    String userId=nodeIterator.nextNode().getProperty(UserConstants.REP_AUTHORIZABLE_ID).getString();
    if (!ids.remove(userId)) {
      fail("UserId " + userId + " missing in result set.");
    }
  }
  assertTrue("Result mismatch",ids.isEmpty());
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testRemoveUserWithoutPermission() throws Exception {
  createUser(userId);
  UserManager testUserMgr=getUserManager(testSession);
  try {
    Authorizable a=testUserMgr.getAuthorizable(userId);
    a.remove();
    testSession.save();
    fail("Test session doesn't have sufficient permission to remove a user.");
  }
 catch (  AccessDeniedException e) {
  }
  modify("/",PrivilegeConstants.REP_WRITE,true);
  try {
    Authorizable a=testUserMgr.getAuthorizable(userId);
    a.remove();
    testSession.save();
    fail("Test session doesn't have sufficient permission to remove a user.");
  }
 catch (  AccessDeniedException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testGlobRestriction() throws Exception {
  String groupHome=Text.getRelativeParent(UserConstants.DEFAULT_GROUP_PATH,1);
  Privilege[] privs=privilegesFromName(PrivilegeConstants.REP_USER_MANAGEMENT);
  allow(groupHome,privs);
  deny(groupHome,privs,createGlobRestriction("*/" + UserConstants.REP_MEMBERS));
  UserManager testUserMgr=getUserManager(testSession);
  Group gr=testUserMgr.createGroup(groupId);
  testSession.save();
  try {
    gr.addMember(testUserMgr.getAuthorizable(testSession.getUserID()));
    testSession.save();
    fail();
  }
 catch (  AccessDeniedException e) {
  }
 finally {
    testSession.refresh(false);
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testChangePasswordWithoutPermission() throws Exception {
  createUser(userId);
  UserManager testUserMgr=getUserManager(testSession);
  User user=(User)testUserMgr.getAuthorizable(userId);
  try {
    user.changePassword("pw2");
    testSession.save();
    fail();
  }
 catch (  AccessDeniedException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testChangeUserPropertiesWithoutPermission() throws Exception {
  createUser(userId);
  UserManager testUserMgr=getUserManager(testSession);
  try {
    Authorizable a=testUserMgr.getAuthorizable(userId);
    a.setProperty("someProp",testSession.getValueFactory().createValue("value"));
    testSession.save();
    fail("Test session doesn't have sufficient permission to alter user properties.");
  }
 catch (  AccessDeniedException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testChangePasswordWithoutPermission2() throws Exception {
  createUser(userId);
  modify("/",PrivilegeConstants.REP_WRITE,true);
  UserManager testUserMgr=getUserManager(testSession);
  User user=(User)testUserMgr.getAuthorizable(userId);
  try {
    user.changePassword("pw2");
    testSession.save();
    fail();
  }
 catch (  AccessDeniedException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCreateUserWithoutPermission() throws Exception {
  UserManager testUserMgr=getUserManager(testSession);
  try {
    testUserMgr.createUser(userId,"pw");
    testSession.save();
    fail("Test session doesn't have sufficient permission -> creating user should fail.");
  }
 catch (  AccessDeniedException e) {
  }
  modify("/",PrivilegeConstants.REP_WRITE,true);
  try {
    testUserMgr.createUser(userId,"pw");
    testSession.save();
    fail("Test session doesn't have sufficient permission -> creating user should fail.");
  }
 catch (  AccessDeniedException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testDisableUserWithoutPermission2() throws Exception {
  createUser(userId);
  modify("/",PrivilegeConstants.REP_WRITE,true);
  UserManager testUserMgr=getUserManager(testSession);
  User user=(User)testUserMgr.getAuthorizable(userId);
  try {
    user.disable("disabled!");
    testSession.save();
    fail();
  }
 catch (  AccessDeniedException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testDisableUserWithoutPermission() throws Exception {
  createUser(userId);
  UserManager testUserMgr=getUserManager(testSession);
  User user=(User)testUserMgr.getAuthorizable(userId);
  try {
    user.disable("disabled!");
    testSession.save();
    fail();
  }
 catch (  AccessDeniedException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCreateWithoutReadAccess() throws Exception {
  UserManager testUserMgr=getUserManager(testSession);
  deny("/",privilegesFromName(PrivilegeConstants.JCR_READ));
  allow("/",privilegesFromName(PrivilegeConstants.REP_USER_MANAGEMENT));
  try {
    Group gr=testUserMgr.createGroup(groupId);
    testSession.save();
    fail("Creating group without read-access on the folder node should fail");
  }
 catch (  AccessDeniedException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.authorization.VersionManagementTest </h4><pre class="type-5 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @since oak (DIFF: jr required jcr:versionManagement privilege on the version store)
 */
@Test public void testRemoveVersion3() throws Exception {
  Node n=createVersionableNode(superuser.getNode(path));
  Version v=n.checkin();
  n.checkout();
  n.checkin();
  testSession.refresh(false);
  assertFalse(testAcMgr.hasPrivileges(n.getPath(),versionPrivileges));
  AccessControlList acl=allow(SYSTEM,versionPrivileges);
  try {
    Node testNode=testSession.getNode(n.getPath());
    testNode.getVersionHistory().removeVersion(v.getName());
    fail("Missing jcr:versionManagement privilege -> remove a version must fail.");
  }
 catch (  AccessDeniedException e) {
  }
 finally {
    for (    AccessControlEntry entry : acl.getAccessControlEntries()) {
      if (entry.getPrincipal().equals(testUser.getPrincipal())) {
        acl.removeAccessControlEntry(entry);
      }
    }
    acMgr.setPolicy(SYSTEM,acl);
    superuser.save();
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * @since oak (DIFF: jr required jcr:versionManagement privilege on the version store)
 */
@Test public void testRemoveVersion2() throws Exception {
  Node n=createVersionableNode(superuser.getNode(path));
  Node trn=testSession.getNode(path);
  modify(trn.getPath(),Privilege.JCR_VERSION_MANAGEMENT,true);
  Node testNode=trn.getNode(n.getName());
  Version v=testNode.checkin();
  testNode.checkout();
  testNode.checkin();
  modify(trn.getPath(),Privilege.JCR_VERSION_MANAGEMENT,false);
  try {
    testNode.getVersionHistory().removeVersion(v.getName());
    fail("Missing jcr:versionManagement privilege -> remove a version must fail.");
  }
 catch (  AccessDeniedException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddMixVersionable() throws Exception {
  modify(path,REP_WRITE,true);
  modify(path,Privilege.JCR_VERSION_MANAGEMENT,false);
  Node testNode=testSession.getNode(path);
  try {
    createVersionableNode(testNode);
    fail("Test session does not have permission to add mixins -> no version content should be created.");
  }
 catch (  AccessDeniedException e) {
    assertFalse(testNode.isNodeType(mixVersionable));
    assertFalse(testNode.hasProperty("jcr:isCheckedOut"));
    assertFalse(testNode.hasProperty(jcrVersionHistory));
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @since oak (DIFF: jr required jcr:versionManagement privilege on the version store)
 */
@Test public void testAccessVersionHistoryVersionableNodeNotAccessible() throws Exception {
  Node n=createVersionableNode(superuser.getNode(path));
  allow(n.getPath(),versionPrivileges);
  Node testNode=testSession.getNode(n.getPath());
  testNode.checkin();
  testNode.checkout();
  VersionHistory vh=testNode.getVersionHistory();
  String vhPath=vh.getPath();
  String vhUUID=vh.getIdentifier();
  modify(n.getPath(),Privilege.JCR_READ,false);
  assertFalse(testSession.nodeExists(n.getPath()));
  try {
    VersionHistory history=(VersionHistory)testSession.getNode(vhPath);
    fail("Access to version history should be denied if versionable node is not accessible");
  }
 catch (  PathNotFoundException e) {
  }
  try {
    VersionHistory history=(VersionHistory)testSession.getNodeByIdentifier(vhUUID);
    fail("Access to version history should be denied if versionable node is not accessible");
  }
 catch (  ItemNotFoundException e) {
  }
  try {
    VersionHistory history=(VersionHistory)testSession.getNodeByUUID(vhUUID);
    fail("Access to version history should be denied if versionable node is not accessible");
  }
 catch (  ItemNotFoundException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCheckInCheckout() throws Exception {
  modify(path,REP_WRITE,true);
  modify(path,Privilege.JCR_VERSION_MANAGEMENT,false);
  Node n=createVersionableNode(superuser.getNode(path));
  try {
    testSession.refresh(false);
    Node testNode=testSession.getNode(n.getPath());
    testNode.checkin();
    fail("Missing jcr:versionManagement privilege -> checkin/checkout must fail.");
  }
 catch (  AccessDeniedException e) {
    Property p=n.getProperty("jcr:isCheckedOut");
    assertFalse(p.isModified());
    assertTrue(n.getProperty("jcr:isCheckedOut").getValue().getBoolean());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.authorization.WritePropertyTest </h4><pre class="type-5 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRemoveProperty() throws Exception {
  Privilege[] privileges=privilegesFromNames(new String[]{"rep:removeProperties"});
  allow(path,privileges);
  assertHasPrivilege(path,Privilege.JCR_MODIFY_PROPERTIES,false);
  assertHasPrivilege(path,"rep:addProperties",false);
  assertHasPrivilege(path,"rep:removeProperties",true);
  assertHasPrivilege(path,"rep:alterProperties",false);
  String propertyPath=path + "/newProperty";
  assertFalse(testSession.hasPermission(propertyPath,Session.ACTION_SET_PROPERTY));
  Node testN=testSession.getNode(path);
  try {
    testN.setProperty("newProperty","value");
    testSession.save();
    fail();
  }
 catch (  AccessDeniedException e) {
    testSession.refresh(false);
  }
  superuser.getNode(path).setProperty("newProperty","value");
  superuser.save();
  testSession.refresh(false);
  assertFalse(testSession.hasPermission(propertyPath,Session.ACTION_SET_PROPERTY));
  assertTrue(testSession.hasPermission(propertyPath,Session.ACTION_REMOVE));
  try {
    testN.setProperty("newProperty","modified");
    testSession.save();
    fail();
  }
 catch (  AccessDeniedException e) {
  }
  try {
    testN.getProperty("newProperty").setValue("modified");
    testSession.save();
    fail();
  }
 catch (  AccessDeniedException e) {
  }
  testN.getProperty("newProperty").remove();
  testSession.save();
}

</code></pre>

<br>
<pre class="type-5 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testModifyProperty() throws Exception {
  Privilege[] privileges=privilegesFromNames(new String[]{"rep:alterProperties"});
  allow(path,privileges);
  assertHasPrivilege(path,Privilege.JCR_MODIFY_PROPERTIES,false);
  assertHasPrivilege(path,"rep:addProperties",false);
  assertHasPrivilege(path,"rep:removeProperties",false);
  assertHasPrivilege(path,"rep:alterProperties",true);
  String propertyPath=path + "/newProperty";
  assertFalse(testSession.hasPermission(propertyPath,Session.ACTION_SET_PROPERTY));
  Node testN=testSession.getNode(path);
  try {
    testN.setProperty("newProperty","value");
    testSession.save();
    fail();
  }
 catch (  AccessDeniedException e) {
    testSession.refresh(false);
  }
  superuser.getNode(path).setProperty("newProperty","value");
  superuser.save();
  testSession.refresh(false);
  assertTrue(testSession.hasPermission(propertyPath,Session.ACTION_SET_PROPERTY));
  assertFalse(testSession.hasPermission(propertyPath,Session.ACTION_REMOVE));
  testN.setProperty("newProperty","modified");
  testSession.save();
  testN.getProperty("newProperty").setValue("modified2");
  testSession.save();
  try {
    testN.setProperty("newProperty",(String)null);
    testSession.save();
    fail();
  }
 catch (  AccessDeniedException e) {
    testSession.refresh(false);
  }
  try {
    testN.getProperty("newProperty").remove();
    testSession.save();
    fail();
  }
 catch (  AccessDeniedException e) {
    testSession.refresh(false);
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddProperty() throws Exception {
  Privilege[] privileges=privilegesFromNames(new String[]{"rep:addProperties"});
  allow(path,privileges);
  assertHasPrivilege(path,Privilege.JCR_MODIFY_PROPERTIES,false);
  assertHasPrivilege(path,"rep:addProperties",true);
  assertHasPrivilege(path,"rep:removeProperties",false);
  assertHasPrivilege(path,"rep:alterProperties",false);
  String propertyPath=path + "/newProperty";
  assertTrue(testSession.hasPermission(propertyPath,Session.ACTION_SET_PROPERTY));
  Node testN=testSession.getNode(path);
  testN.setProperty("newProperty","value");
  testSession.save();
  assertFalse(testSession.hasPermission(propertyPath,Session.ACTION_SET_PROPERTY));
  assertFalse(testSession.hasPermission(propertyPath,Session.ACTION_REMOVE));
  try {
    testN.setProperty("newProperty","modified");
    testSession.save();
    fail();
  }
 catch (  AccessDeniedException e) {
  }
  try {
    testN.getProperty("newProperty").setValue("modified");
    testSession.save();
    fail();
  }
 catch (  AccessDeniedException e) {
  }
  try {
    testN.setProperty("newProperty",(String)null);
    testSession.save();
    fail();
  }
 catch (  AccessDeniedException e) {
    testSession.refresh(false);
  }
  try {
    testN.getProperty("newProperty").remove();
    testSession.save();
    fail();
  }
 catch (  AccessDeniedException e) {
    testSession.refresh(false);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.authorization.WriteRestrictionTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testRemoveSubTreeWithRestriction2() throws Exception {
  allow(path,testUser.getPrincipal(),readWritePrivileges);
  deny(path,privilegesFromName(PrivilegeConstants.JCR_REMOVE_CHILD_NODES),createGlobRestriction("*/" + Text.getName(childNPath)));
  testSession.getNode(childNPath).getNode(nodeName3).remove();
  try {
    testSession.save();
    fail("Removing child node must be denied.");
  }
 catch (  AccessDeniedException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testRemoveSubTreeWithRestriction() throws Exception {
  allow(path,testUser.getPrincipal(),readWritePrivileges);
  deny(path,privilegesFromName(PrivilegeConstants.JCR_REMOVE_NODE),createGlobRestriction("*/" + nodeName3));
  testSession.getNode(childNPath).getNode(nodeName3).remove();
  try {
    testSession.save();
    fail("Removing child node must be denied.");
  }
 catch (  AccessDeniedException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testAddSubTreeWithRestriction() throws Exception {
  allow(path,testUser.getPrincipal(),readWritePrivileges);
  deny(path,privilegesFromName(PrivilegeConstants.JCR_ADD_CHILD_NODES),createGlobRestriction("*/" + nodeName3));
  Node node4=testSession.getNode(nodePath3).addNode(nodeName4);
  try {
    testSession.save();
    fail("Adding child node must be denied.");
  }
 catch (  AccessDeniedException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.authorization.WriteTest </h4><pre class="type-5 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRemove5() throws Exception {
  Privilege[] rmNode=privilegesFromName(Privilege.JCR_REMOVE_NODE);
  allow(childNPath,rmNode);
  assertFalse(testSession.hasPermission(childNPath,Session.ACTION_REMOVE));
  try {
    testSession.getNode(childNPath).remove();
    testSession.save();
    fail("Removal must fail");
  }
 catch (  AccessDeniedException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testReorder2() throws Exception {
  Node n=testSession.getNode(path);
  allow(path,privilegesFromNames(new String[]{Privilege.JCR_ADD_CHILD_NODES,Privilege.JCR_NODE_TYPE_MANAGEMENT}));
  try {
    n.orderBefore(Text.getName(childNPath2),Text.getName(childNPath));
    testSession.save();
    fail("test session must not be allowed to reorder nodes.");
  }
 catch (  AccessDeniedException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRemove6() throws Exception {
  Privilege[] privs=privilegesFromNames(new String[]{Privilege.JCR_REMOVE_CHILD_NODES,Privilege.JCR_REMOVE_NODE});
  allow(path,privs);
  Privilege[] rmNode=privilegesFromName(Privilege.JCR_REMOVE_NODE);
  deny(childNPath,rmNode);
  assertFalse(testSession.hasPermission(path,Session.ACTION_REMOVE));
  assertFalse(testSession.hasPermission(childNPath,Session.ACTION_REMOVE));
  assertTrue(testAcMgr.hasPrivileges(childNPath,privilegesFromNames(new String[]{Privilege.JCR_READ,Privilege.JCR_REMOVE_CHILD_NODES})));
  assertFalse(testAcMgr.hasPrivileges(childNPath,privilegesFromName(Privilege.JCR_REMOVE_NODE)));
  try {
    testSession.getNode(childNPath).remove();
    testSession.save();
    fail("Removal must fail");
  }
 catch (  AccessDeniedException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRemove51() throws Exception {
  Node subtree=superuser.getNode(childNPath).addNode(nodeName3);
  superuser.save();
  Privilege[] rmNode=privilegesFromName(Privilege.JCR_REMOVE_NODE);
  allow(childNPath,rmNode);
  String subtreePath=subtree.getPath();
  assertFalse(testSession.hasPermission(subtreePath,Session.ACTION_REMOVE));
  try {
    testSession.getNode(subtreePath).remove();
    testSession.save();
    fail("Removal must fail");
  }
 catch (  AccessDeniedException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testReorder() throws Exception {
  Node n=testSession.getNode(path);
  if (!n.getPrimaryNodeType().hasOrderableChildNodes()) {
    throw new NotExecutableException("Reordering child nodes is not supported..");
  }
  try {
    n.orderBefore(Text.getName(childNPath2),Text.getName(childNPath));
    testSession.save();
    fail("test session must not be allowed to reorder nodes.");
  }
 catch (  AccessDeniedException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRemove61() throws Exception {
  Node subtree=superuser.getNode(childNPath).addNode(nodeName3);
  superuser.save();
  Privilege[] privs=privilegesFromNames(new String[]{Privilege.JCR_REMOVE_CHILD_NODES,Privilege.JCR_REMOVE_NODE});
  allow(path,privs);
  Privilege[] rmNode=privilegesFromName(Privilege.JCR_REMOVE_NODE);
  deny(childNPath,rmNode);
  String subtreePath=subtree.getPath();
  assertFalse(testSession.hasPermission(subtreePath,Session.ACTION_REMOVE));
  assertTrue(testAcMgr.hasPrivileges(subtreePath,privilegesFromNames(new String[]{Privilege.JCR_READ,Privilege.JCR_REMOVE_CHILD_NODES})));
  assertFalse(testAcMgr.hasPrivileges(subtreePath,privilegesFromName(Privilege.JCR_REMOVE_NODE)));
  try {
    testSession.getNode(subtreePath).remove();
    testSession.save();
    fail("Removal must fail");
  }
 catch (  AccessDeniedException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddChildNodeAndSetProperty() throws Exception {
  Privilege[] privileges=privilegesFromNames(new String[]{Privilege.JCR_ADD_CHILD_NODES,Privilege.JCR_MODIFY_PROPERTIES});
  allow(path,privileges);
  String nonExChildPath=path + "/anyItem";
  String actions=getActions(Session.ACTION_READ,Session.ACTION_ADD_NODE,Session.ACTION_SET_PROPERTY);
  assertTrue(testSession.hasPermission(nonExChildPath,actions));
  assertFalse(testSession.hasPermission(nonExChildPath,Session.ACTION_REMOVE));
  Node testN=testSession.getNode(path);
  testN.addNode(nodeName4);
  testSession.save();
  testSession.getProperty(childPPath).remove();
  testSession.save();
  testN.setProperty(Text.getName(childPPath),"othervalue");
  testSession.save();
  try {
    testSession.getNode(childNPath).remove();
    testSession.save();
    fail("test-user is not allowed to remove a node below " + path);
  }
 catch (  AccessDeniedException e) {
  }
  assertTrue(testSession.hasPermission(path,Session.ACTION_READ));
  assertFalse(testSession.hasPermission(path,getActions(Session.ACTION_ADD_NODE,Session.ACTION_SET_PROPERTY,Session.ACTION_REMOVE)));
  assertReadOnly(siblingPath);
}

</code></pre>

<br>
<pre class="type-5 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRemove7() throws Exception {
  Privilege[] rmChildNodes=privilegesFromName(Privilege.JCR_REMOVE_CHILD_NODES);
  Privilege[] rmNode=privilegesFromName(Privilege.JCR_REMOVE_NODE);
  deny(path,privilegesFromName(Privilege.JCR_REMOVE_CHILD_NODES));
  allow(childNPath,rmNode);
  assertFalse(testSession.hasPermission(childNPath,Session.ACTION_REMOVE));
  allow(childNPath,rmChildNodes);
  assertFalse(testSession.hasPermission(childNPath,javax.jcr.Session.ACTION_REMOVE));
  assertTrue(testAcMgr.hasPrivileges(childNPath,new Privilege[]{rmChildNodes[0],rmNode[0]}));
  try {
    testSession.getNode(childNPath).remove();
    testSession.save();
    fail("Removal must fail");
  }
 catch (  AccessDeniedException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.principal.PrincipalManagerTest </h4><pre class="type-13 type-12 type-5 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEveryoneGroupMembership(){
  Principal everyone=EveryonePrincipal.getInstance();
  for (PrincipalIterator membership=principalMgr.getGroupMembership(everyone); membership.hasNext(); ) {
    Principal gr=membership.nextPrincipal();
    assertTrue(isGroup(gr));
    if (gr.equals(everyone)) {
      fail("Everyone must never be a member of the EveryOne group.");
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.privilege.PrivilegeManagerTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testGetPrivilegesFromNullNames(){
  try {
    privilegeManager.getPrivilege(null);
    fail("invalid privilege name (null)");
  }
 catch (  Exception e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testGetPrivilegesFromEmptyNames(){
  try {
    privilegeManager.getPrivilege("");
    fail("invalid privilege name array");
  }
 catch (  AccessControlException e) {
  }
catch (  RepositoryException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testGetPrivilegesFromInvalidName() throws RepositoryException {
  try {
    privilegeManager.getPrivilege("unknown");
    fail("invalid privilege name");
  }
 catch (  AccessControlException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.privilege.PrivilegeRegistrationTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testRegisterInvalidNewAggregate() throws RepositoryException {
  Map<String,String[]> newAggregates=new LinkedHashMap<String,String[]>();
  newAggregates.put("jcrReadAggregate",getAggregateNames(PrivilegeConstants.JCR_READ));
  newAggregates.put("newAggregate2",getAggregateNames(PrivilegeConstants.JCR_READ,"unknownPrivilege"));
  newAggregates.put("newAggregate3",getAggregateNames("unknownPrivilege"));
  newAggregates.put("newAggregate4",getAggregateNames("newAggregate"));
  newAggregates.put("repWriteAggregate",getAggregateNames(PrivilegeConstants.JCR_MODIFY_PROPERTIES,PrivilegeConstants.JCR_ADD_CHILD_NODES,PrivilegeConstants.JCR_NODE_TYPE_MANAGEMENT,PrivilegeConstants.JCR_REMOVE_CHILD_NODES,PrivilegeConstants.JCR_REMOVE_NODE));
  newAggregates.put("newAggregate5",getAggregateNames(PrivilegeConstants.JCR_READ,"unknownPrivilege"));
  for (  String name : newAggregates.keySet()) {
    try {
      privilegeManager.registerPrivilege(name,true,newAggregates.get(name));
      fail("New aggregate " + name + " referring to unknown Privilege  -> Exception expected");
    }
 catch (    RepositoryException e) {
    }
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @since oak
 */
@Test public void testRegisterPrivilegeWithPendingChanges() throws RepositoryException {
  try {
    session.getRootNode().addNode("test");
    assertTrue(session.hasPendingChanges());
    privilegeManager.registerPrivilege("new",true,new String[0]);
    fail("Privileges may not be registered while there are pending changes.");
  }
 catch (  InvalidItemStateException e) {
  }
 finally {
    superuser.refresh(false);
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCustomEquivalentDefinitions() throws RepositoryException {
  privilegeManager.registerPrivilege("custom4",false,new String[0]);
  privilegeManager.registerPrivilege("custom5",false,new String[0]);
  privilegeManager.registerPrivilege("custom2",false,new String[]{"custom4","custom5"});
  List<String[]> equivalent=new ArrayList<String[]>();
  equivalent.add(new String[]{"custom4","custom5"});
  equivalent.add(new String[]{"custom2","custom4"});
  equivalent.add(new String[]{"custom2","custom5"});
  int cnt=6;
  for (  String[] aggrNames : equivalent) {
    try {
      String name="custom" + (cnt++);
      privilegeManager.registerPrivilege(name,false,aggrNames);
      fail("Equivalent '" + name + "' definitions must be detected.");
    }
 catch (    RepositoryException e) {
    }
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testRegisterInvalidNewAggregate2() throws RepositoryException {
  Map<String,String[]> newCustomPrivs=new LinkedHashMap<String,String[]>();
  newCustomPrivs.put("new",new String[0]);
  newCustomPrivs.put("new2",new String[0]);
  newCustomPrivs.put("new3",getAggregateNames("new","new2"));
  for (  String name : newCustomPrivs.keySet()) {
    boolean isAbstract=true;
    String[] aggrNames=newCustomPrivs.get(name);
    privilegeManager.registerPrivilege(name,isAbstract,aggrNames);
  }
  Map<String,String[]> newAggregates=new LinkedHashMap<String,String[]>();
  newAggregates.put("newA2",getAggregateNames("new"));
  newAggregates.put("newA3",getAggregateNames("new2"));
  for (  String name : newAggregates.keySet()) {
    boolean isAbstract=false;
    String[] aggrNames=newAggregates.get(name);
    try {
      privilegeManager.registerPrivilege(name,isAbstract,aggrNames);
      fail("Invalid aggregation in definition '" + name.toString() + "' : Exception expected");
    }
 catch (    RepositoryException e) {
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @since oak
 */
@Test public void testCustomPrivilegeVisibleAfterRefresh() throws RepositoryException {
  Session s2=getAdminSession();
  PrivilegeManager pm=getPrivilegeManager(s2);
  try {
    boolean isAbstract=false;
    String privName="testCustomPrivilegeVisibleAfterRefresh";
    privilegeManager.registerPrivilege(privName,isAbstract,new String[0]);
    try {
      Privilege priv=pm.getPrivilege(privName);
      fail("Custom privilege will show up after Session#refresh()");
    }
 catch (    AccessControlException e) {
    }
    s2.refresh(true);
    Privilege priv=pm.getPrivilege(privName);
    assertEquals(privName,priv.getName());
    assertEquals(isAbstract,priv.isAbstract());
    assertFalse(priv.isAggregate());
  }
  finally {
    s2.logout();
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testRegisterPrivilegeWithIllegalName(){
  Map<String,String[]> illegal=new HashMap<String,String[]>();
  illegal.put(null,new String[0]);
  illegal.put("",new String[0]);
  illegal.put("invalid:privilegeName",new String[0]);
  illegal.put(".e:privilegeName",new String[0]);
  illegal.put("newPrivilege",new String[]{"invalid:privilegeName"});
  illegal.put("newPrivilege",new String[]{".e:privilegeName"});
  illegal.put("newPrivilege",new String[]{null});
  illegal.put("newPrivilege",new String[]{""});
  for (  String illegalName : illegal.keySet()) {
    try {
      privilegeManager.registerPrivilege(illegalName,true,illegal.get(illegalName));
      fail("Illegal name -> Exception expected");
    }
 catch (    NamespaceException e) {
    }
catch (    RepositoryException e) {
    }
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCustomDefinitionsWithCyclicReferences() throws RepositoryException {
  try {
    privilegeManager.registerPrivilege("cycl-1",false,new String[]{"cycl-1"});
    fail("Cyclic definitions must be detected upon registration.");
  }
 catch (  RepositoryException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRegisterPrivilegeAggregatingJcrAll() throws Exception {
  privilegeManager.registerPrivilege("customPriv",false,null);
  try {
    privilegeManager.registerPrivilege("customPriv2",false,new String[]{"customPriv",Privilege.JCR_ALL});
    fail("Aggregation containing jcr:all is invalid.");
  }
 catch (  RepositoryException e) {
    Throwable cause=e.getCause();
    assertTrue(cause instanceof CommitFailedException);
    assertEquals(53,((CommitFailedException)cause).getCode());
  }
 finally {
    superuser.refresh(false);
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testRegisterReservedName(){
  Map<String,String[]> illegal=new HashMap<String,String[]>();
  illegal.put(null,new String[0]);
  illegal.put("jcr:privilegeName",new String[0]);
  illegal.put("rep:privilegeName",new String[0]);
  illegal.put("nt:privilegeName",new String[0]);
  illegal.put("mix:privilegeName",new String[0]);
  illegal.put("sv:privilegeName",new String[0]);
  illegal.put("xml:privilegeName",new String[0]);
  illegal.put("xmlns:privilegeName",new String[0]);
  illegal.put("newPrivilege",new String[]{"jcr:privilegeName"});
  for (  String illegalName : illegal.keySet()) {
    try {
      privilegeManager.registerPrivilege(illegalName,true,illegal.get(illegalName));
      fail("Illegal name -> Exception expected");
    }
 catch (    RepositoryException e) {
    }
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testRegisterPrivilegeWithReadOnly() throws RepositoryException {
  Session readOnly=getReadOnlySession();
  try {
    getPrivilegeManager(readOnly).registerPrivilege("test",true,new String[0]);
    fail("Only admin is allowed to register privileges.");
  }
 catch (  AccessDeniedException e) {
  }
 finally {
    readOnly.logout();
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testRegisterBuiltInPrivilege() throws RepositoryException {
  Map<String,String[]> builtIns=new HashMap<String,String[]>();
  builtIns.put(PrivilegeConstants.JCR_READ,new String[0]);
  builtIns.put(PrivilegeConstants.JCR_LIFECYCLE_MANAGEMENT,new String[]{PrivilegeConstants.JCR_ADD_CHILD_NODES});
  builtIns.put(PrivilegeConstants.REP_WRITE,new String[0]);
  builtIns.put(PrivilegeConstants.JCR_ALL,new String[0]);
  for (  String builtInName : builtIns.keySet()) {
    try {
      privilegeManager.registerPrivilege(builtInName,false,builtIns.get(builtInName));
      fail("Privilege name " + builtInName + " already in use -> Exception expected");
    }
 catch (    RepositoryException e) {
    }
  }
  for (  String builtInName : builtIns.keySet()) {
    try {
      privilegeManager.registerPrivilege(builtInName,true,builtIns.get(builtInName));
      fail("Privilege name " + builtInName + " already in use -> Exception expected");
    }
 catch (    RepositoryException e) {
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.user.AdministratorTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testDisable() throws NotExecutableException, RepositoryException {
  try {
    admin.disable("-> out");
    superuser.save();
    fail("The admin cannot be disabled");
  }
 catch (  RepositoryException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testRemoveAdmin() throws NotExecutableException {
  try {
    admin.remove();
    superuser.save();
    fail("The admin user cannot be removed.");
  }
 catch (  RepositoryException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testRemoveAdminNode() throws RepositoryException, NotExecutableException {
  String adminId=admin.getID();
  Node adminNode=superuser.getNode(admin.getPath());
  try {
    adminNode.remove();
    superuser.save();
    fail("Admin user node cannot be removed.");
  }
 catch (  Exception e) {
    superuser.refresh(false);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.user.AuthorizablePropertyTest </h4><pre class="type-12 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testRemoveSpecialGroupPropertiesDirectly() throws RepositoryException, NotExecutableException {
  Node n=getNode(group,superuser);
  try {
    if (n.hasProperty(UserConstants.REP_PRINCIPAL_NAME)) {
      n.getProperty(UserConstants.REP_PRINCIPAL_NAME).remove();
      fail("Attempt to remove protected property rep:principalName should fail.");
    }
  }
 catch (  ConstraintViolationException e) {
  }
  try {
    if (n.hasProperty(UserConstants.REP_MEMBERS)) {
      n.getProperty(UserConstants.REP_MEMBERS).remove();
      fail("Attempt to remove protected property rep:members should fail.");
    }
  }
 catch (  ConstraintViolationException e) {
  }
}

</code></pre>

<br>
<pre class="type-12 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testRemoveSpecialUserPropertiesDirectly() throws RepositoryException, NotExecutableException {
  Node n=getNode(user,superuser);
  try {
    n.getProperty(UserConstants.REP_PASSWORD).remove();
    fail("Attempt to remove protected property rep:password should fail.");
  }
 catch (  ConstraintViolationException e) {
  }
  try {
    if (n.hasProperty(UserConstants.REP_PRINCIPAL_NAME)) {
      n.getProperty(UserConstants.REP_PRINCIPAL_NAME).remove();
      fail("Attempt to remove protected property rep:principalName should fail.");
    }
  }
 catch (  ConstraintViolationException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testSetSpecialPropertiesDirectly() throws NotExecutableException, RepositoryException {
  Node n=getNode(user,superuser);
  try {
    String pName=user.getPrincipal().getName();
    n.setProperty(UserConstants.REP_PRINCIPAL_NAME,new StringValue("any-value"));
    n.setProperty(UserConstants.REP_PRINCIPAL_NAME,new StringValue(pName));
    fail("Attempt to change protected property rep:principalName should fail.");
  }
 catch (  ConstraintViolationException e) {
  }
  try {
    String imperson="anyimpersonator";
    n.setProperty(UserConstants.REP_IMPERSONATORS,new Value[]{new StringValue(imperson)},PropertyType.STRING);
    fail("Attempt to change protected property rep:impersonators should fail.");
  }
 catch (  ConstraintViolationException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testGetPropertyNamesByInvalidRelPath() throws NotExecutableException, RepositoryException {
  List<String> invalidPaths=new ArrayList<String>();
  invalidPaths.add("");
  invalidPaths.add("/");
  invalidPaths.add("../");
  invalidPaths.add("../../");
  invalidPaths.add("../testing");
  invalidPaths.add("/testing");
  invalidPaths.add(null);
  for (  String invalidRelPath : invalidPaths) {
    try {
      user.getPropertyNames(invalidRelPath);
      fail("Calling Authorizable#getPropertyNames with " + invalidRelPath + " must fail.");
    }
 catch (    RepositoryException e) {
    }
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testSetPropertyInvalidRelativePath() throws NotExecutableException, RepositoryException {
  Value[] v=new Value[]{superuser.getValueFactory().createValue("Super User")};
  List<String> invalidPaths=new ArrayList<String>();
  invalidPaths.add("../testing/Fullname");
  invalidPaths.add("../../testing/Fullname");
  invalidPaths.add("testing/testing/../../../Fullname");
  invalidPaths.add("/testing/Fullname");
  for (  String invalidRelPath : invalidPaths) {
    try {
      user.setProperty(invalidRelPath,v);
      fail("Modifications outside of the scope of the authorizable must fail. Path was: " + invalidRelPath);
    }
 catch (    RepositoryException e) {
    }
 finally {
      superuser.refresh(false);
    }
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testSetSpecialProperties() throws NotExecutableException, RepositoryException {
  Value v=superuser.getValueFactory().createValue("any_value");
  for (  String pName : protectedUserProps.keySet()) {
    try {
      boolean isMultiValued=protectedUserProps.get(pName);
      if (isMultiValued) {
        user.setProperty(pName,new Value[]{v});
      }
 else {
        user.setProperty(pName,v);
      }
      superuser.save();
      fail("changing the '" + pName + "' property on a User should fail.");
    }
 catch (    RepositoryException e) {
    }
 finally {
      superuser.refresh(false);
    }
  }
  for (  String pName : protectedGroupProps.keySet()) {
    try {
      boolean isMultiValued=protectedGroupProps.get(pName);
      if (isMultiValued) {
        group.setProperty(pName,new Value[]{v});
      }
 else {
        group.setProperty(pName,v);
      }
      superuser.save();
      fail("changing the '" + pName + "' property on a Group should fail.");
    }
 catch (    RepositoryException e) {
    }
 finally {
      superuser.refresh(false);
    }
  }
}

</code></pre>

<br>
<pre class="type-12 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testRemoveSpecialProperties() throws NotExecutableException, RepositoryException {
  for (  String pName : protectedUserProps.keySet()) {
    try {
      if (user.removeProperty(pName)) {
        superuser.save();
        fail("removing the '" + pName + "' property on a User should fail.");
      }
    }
 catch (    RepositoryException e) {
    }
 finally {
      superuser.refresh(false);
    }
  }
  for (  String pName : protectedGroupProps.keySet()) {
    try {
      if (group.removeProperty(pName)) {
        superuser.save();
        fail("removing the '" + pName + "' property on a Group should fail.");
      }
    }
 catch (    RepositoryException e) {
    }
 finally {
      superuser.refresh(false);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.user.CreateGroupTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCreateDuplicateGroup() throws RepositoryException, NotExecutableException {
  Principal p=getTestPrincipal();
  Group gr=createGroup(p);
  createdGroups.add(gr);
  try {
    Group gr2=createGroup(p);
    createdGroups.add(gr2);
    fail("Creating 2 groups with the same Principal should throw AuthorizableExistsException.");
  }
 catch (  AuthorizableExistsException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * @since OAK 1.0 In contrast to Jackrabbit core the intermediate path may
 * not be an absolute path in OAK.
 */
@Test public void testCreateGroupWithAbsolutePath() throws RepositoryException, NotExecutableException {
  Principal p=getTestPrincipal();
  try {
    Group gr=createGroup(p,"/any/path/to/the/new/group");
    createdGroups.add(gr);
    fail("ConstraintViolationException expected.");
  }
 catch (  ConstraintViolationException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCreateGroupWithNullPrincipal() throws RepositoryException {
  try {
    Group gr=createGroup(null);
    createdGroups.add(gr);
    fail("A Group cannot be built from 'null' Principal");
  }
 catch (  Exception e) {
  }
  try {
    Group gr=createGroup(null,"/any/path/to/the/new/group");
    createdGroups.add(gr);
    fail("A Group cannot be built from 'null' Principal");
  }
 catch (  Exception e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.user.CreateUserTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCreateUserWithNullPrincipal() throws RepositoryException {
  try {
    Principal p=getTestPrincipal();
    String uid=p.getName();
    User user=createUser(uid,"pw",null,"/a/b/c");
    createdUsers.add(user);
    fail("A User cannot be built with 'null' Principal");
  }
 catch (  Exception e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * @since OAK 1.0 In contrast to Jackrabbit core the intermediate path may
 * not be an absolute path in OAK.
 */
@Test public void testCreateUserWithAbsolutePath() throws RepositoryException, NotExecutableException {
  Principal p=getTestPrincipal();
  String uid=p.getName();
  try {
    User user=createUser(uid,"pw",p,"/any/path/to/the/new/user");
    createdUsers.add(user);
    fail("ConstraintViolationException expected");
  }
 catch (  ConstraintViolationException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCreateUserWithNullParamerters() throws RepositoryException {
  try {
    User user=createUser(null,null);
    createdUsers.add(user);
    fail("A User cannot be built from 'null' parameters");
  }
 catch (  Exception e) {
  }
  try {
    User user=createUser(null,null,null,null);
    createdUsers.add(user);
    fail("A User cannot be built from 'null' parameters");
  }
 catch (  Exception e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCreateUserWithNullUserID() throws RepositoryException {
  try {
    User user=createUser(null,"anyPW");
    createdUsers.add(user);
    fail("A User cannot be built with 'null' userID");
  }
 catch (  Exception e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCreateUserWithEmptyUserID() throws RepositoryException {
  try {
    User user=createUser("","anyPW");
    createdUsers.add(user);
    fail("A User cannot be built with \"\" userID");
  }
 catch (  Exception e) {
  }
  try {
    User user=createUser("","anyPW",getTestPrincipal(),null);
    createdUsers.add(user);
    fail("A User cannot be built with \"\" userID");
  }
 catch (  Exception e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.user.FindAuthorizablesTest </h4><pre class="type-13 type-12 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testFindUserInAllGroups() throws RepositoryException, NotExecutableException {
  User u=null;
  try {
    Principal p=getTestPrincipal();
    String uid=createUserId();
    u=userMgr.createUser(uid,"pw",p,null);
    superuser.save();
    Iterator<Authorizable> it=userMgr.findAuthorizables(UserConstants.REP_PRINCIPAL_NAME,null,UserManager.SEARCH_TYPE_GROUP);
    while (it.hasNext()) {
      if (it.next().getPrincipal().getName().equals(p.getName())) {
        fail("Searching for Groups should never find a user");
      }
    }
  }
  finally {
    if (u != null) {
      u.remove();
      superuser.save();
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-12 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testFindGroupInAllUsers() throws RepositoryException, NotExecutableException {
  Group gr=null;
  try {
    Principal p=getTestPrincipal();
    gr=userMgr.createGroup(p);
    superuser.save();
    boolean found=false;
    Iterator<Authorizable> it=userMgr.findAuthorizables(UserConstants.REP_PRINCIPAL_NAME,null,UserManager.SEARCH_TYPE_USER);
    while (it.hasNext()) {
      if (it.next().getPrincipal().getName().equals(p.getName())) {
        fail("Searching for Users should never find a group");
      }
    }
  }
  finally {
    if (gr != null) {
      gr.remove();
      superuser.save();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.user.GroupImportAbortTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testImportSelfAsGroupAbort() throws Exception {
  String invalidId="0120a4f9-196a-3f9e-b9f5-23f31f914da7";
  String xml="<?xml version=\"1.0\" encoding=\"UTF-8\"?>" + "<sv:node sv:name=\"gFolder\" xmlns:mix=\"http://www.jcp.org/jcr/mix/1.0\" xmlns:nt=\"http://www.jcp.org/jcr/nt/1.0\" xmlns:fn_old=\"http://www.w3.org/2004/10/xpath-functions\" xmlns:fn=\"http://www.w3.org/2005/xpath-functions\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:sv=\"http://www.jcp.org/jcr/sv/1.0\" xmlns:rep=\"internal\" xmlns:jcr=\"http://www.jcp.org/jcr/1.0\">" + "   <sv:property sv:name=\"jcr:primaryType\" sv:type=\"Name\"><sv:value>rep:AuthorizableFolder</sv:value></sv:property>"+ "<sv:node sv:name=\"g1\"><sv:property sv:name=\"jcr:primaryType\" sv:type=\"Name\"><sv:value>rep:Group</sv:value></sv:property>"+ "   <sv:property sv:name=\"jcr:uuid\" sv:type=\"String\"><sv:value>" + invalidId + "</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:principalName\" sv:type=\"String\"><sv:value>g1</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:members\" sv:type=\"WeakReference\"><sv:value>"+ invalidId+ "</sv:value></sv:property>"+ "</sv:node>"+ "</sv:node>";
  try {
    doImport(getTargetPath(),xml);
    fail("Importing self as group with ImportBehavior.ABORT must fail.");
  }
 catch (  RepositoryException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testImportNonExistingMemberAbort() throws Exception {
  List<String> invalid=new ArrayList<String>();
  invalid.add(UUID.randomUUID().toString());
  invalid.add(getExistingUUID());
  for (  String id : invalid) {
    String xml="<?xml version=\"1.0\" encoding=\"UTF-8\"?>" + "<sv:node sv:name=\"gFolder\" xmlns:mix=\"http://www.jcp.org/jcr/mix/1.0\" xmlns:nt=\"http://www.jcp.org/jcr/nt/1.0\" xmlns:fn_old=\"http://www.w3.org/2004/10/xpath-functions\" xmlns:fn=\"http://www.w3.org/2005/xpath-functions\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:sv=\"http://www.jcp.org/jcr/sv/1.0\" xmlns:rep=\"internal\" xmlns:jcr=\"http://www.jcp.org/jcr/1.0\">" + "   <sv:property sv:name=\"jcr:primaryType\" sv:type=\"Name\"><sv:value>rep:AuthorizableFolder</sv:value></sv:property>"+ "<sv:node sv:name=\"g1\"><sv:property sv:name=\"jcr:primaryType\" sv:type=\"Name\"><sv:value>rep:Group</sv:value></sv:property>"+ "   <sv:property sv:name=\"jcr:uuid\" sv:type=\"String\"><sv:value>0120a4f9-196a-3f9e-b9f5-23f31f914da7</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:principalName\" sv:type=\"String\"><sv:value>g1</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:members\" sv:type=\"WeakReference\"><sv:value>" + id + "</sv:value></sv:property>"+ "</sv:node>"+ "</sv:node>";
    try {
      doImport(getTargetPath(),xml);
      fail("importing invalid members -> must throw.");
    }
 catch (    RepositoryException e) {
    }
 finally {
      getImportSession().refresh(false);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.user.GroupImportBestEffortTest </h4><pre class="type-12 type-5 type-7 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testImportNonExistingMemberBestEffort() throws Exception {
  List<String> invalid=new ArrayList<String>();
  invalid.add(UUID.randomUUID().toString());
  invalid.add(getExistingUUID());
  Session s=getImportSession();
  for (  String id : invalid) {
    String xml="<?xml version=\"1.0\" encoding=\"UTF-8\"?>" + "<sv:node sv:name=\"gFolder\" xmlns:mix=\"http://www.jcp.org/jcr/mix/1.0\" xmlns:nt=\"http://www.jcp.org/jcr/nt/1.0\" xmlns:fn_old=\"http://www.w3.org/2004/10/xpath-functions\" xmlns:fn=\"http://www.w3.org/2005/xpath-functions\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:sv=\"http://www.jcp.org/jcr/sv/1.0\" xmlns:rep=\"internal\" xmlns:jcr=\"http://www.jcp.org/jcr/1.0\">" + "   <sv:property sv:name=\"jcr:primaryType\" sv:type=\"Name\"><sv:value>rep:AuthorizableFolder</sv:value></sv:property>"+ "<sv:node sv:name=\"g1\"><sv:property sv:name=\"jcr:primaryType\" sv:type=\"Name\"><sv:value>rep:Group</sv:value></sv:property>"+ "   <sv:property sv:name=\"jcr:uuid\" sv:type=\"String\"><sv:value>0120a4f9-196a-3f9e-b9f5-23f31f914da7</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:principalName\" sv:type=\"String\"><sv:value>g1</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:members\" sv:type=\"WeakReference\"><sv:value>" + id + "</sv:value></sv:property>"+ "</sv:node>"+ "</sv:node>";
    try {
      doImport(getTargetPath(),xml);
      Authorizable a=getUserManager().getAuthorizable("g1");
      if (a.isGroup()) {
        boolean found=false;
        Node grNode=s.getNode(a.getPath());
        for (        Value memberValue : grNode.getProperty(UserConstants.REP_MEMBERS).getValues()) {
          assertEquals(PropertyType.WEAKREFERENCE,memberValue.getType());
          if (id.equals(memberValue.getString())) {
            found=true;
            break;
          }
        }
        assertTrue("ImportBehavior.BESTEFFORT must import non-existing members.",found);
        assertNotDeclaredMember((Group)a,id,s);
      }
 else {
        fail("'g1' was not imported as Group.");
      }
    }
  finally {
      s.refresh(false);
    }
  }
}

</code></pre>

<br>
<pre class="type-12 type-5 type-7 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testImportNonExistingMemberBestEffort2() throws Exception {
  String g1Id="0120a4f9-196a-3f9e-b9f5-23f31f914da7";
  String nonExistingId="b2f5ff47-4366-31b6-a533-d8dc3614845d";
  if (getUserManager().getAuthorizable("g") != null) {
    throw new NotExecutableException();
  }
  String xml="<?xml version=\"1.0\" encoding=\"UTF-8\"?>" + "<sv:node sv:name=\"gFolder\" xmlns:mix=\"http://www.jcp.org/jcr/mix/1.0\" xmlns:nt=\"http://www.jcp.org/jcr/nt/1.0\" xmlns:fn_old=\"http://www.w3.org/2004/10/xpath-functions\" xmlns:fn=\"http://www.w3.org/2005/xpath-functions\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:sv=\"http://www.jcp.org/jcr/sv/1.0\" xmlns:rep=\"internal\" xmlns:jcr=\"http://www.jcp.org/jcr/1.0\">" + "   <sv:property sv:name=\"jcr:primaryType\" sv:type=\"Name\"><sv:value>rep:AuthorizableFolder</sv:value></sv:property>"+ "<sv:node sv:name=\"g1\"><sv:property sv:name=\"jcr:primaryType\" sv:type=\"Name\"><sv:value>rep:Group</sv:value></sv:property>"+ "   <sv:property sv:name=\"jcr:uuid\" sv:type=\"String\"><sv:value>" + g1Id + "</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:principalName\" sv:type=\"String\"><sv:value>g1</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:members\" sv:type=\"WeakReference\"><sv:value>"+ nonExistingId+ "</sv:value></sv:property>"+ "</sv:node>"+ "</sv:node>";
  doImport(getTargetPath(),xml);
  Authorizable g1=getUserManager().getAuthorizable("g1");
  if (g1.isGroup()) {
    boolean found=false;
    Node grNode=getImportSession().getNode(g1.getPath());
    for (    Value memberValue : grNode.getProperty(UserConstants.REP_MEMBERS).getValues()) {
      assertEquals(PropertyType.WEAKREFERENCE,memberValue.getType());
      if (nonExistingId.equals(memberValue.getString())) {
        found=true;
        break;
      }
    }
    assertTrue("ImportBehavior.BESTEFFORT must import non-existing members.",found);
  }
 else {
    fail("'g1' was not imported as Group.");
  }
}

</code></pre>

<br>
<pre class="type-12 type-5 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testImportCircularMembership() throws Exception {
  String g1Id="0120a4f9-196a-3f9e-b9f5-23f31f914da7";
  String nonExistingId="b2f5ff47-4366-31b6-a533-d8dc3614845d";
  if (getUserManager().getAuthorizable("g") != null) {
    throw new NotExecutableException();
  }
  String xml="<?xml version=\"1.0\" encoding=\"UTF-8\"?>" + "<sv:node sv:name=\"gFolder\" xmlns:mix=\"http://www.jcp.org/jcr/mix/1.0\" xmlns:nt=\"http://www.jcp.org/jcr/nt/1.0\" xmlns:fn_old=\"http://www.w3.org/2004/10/xpath-functions\" xmlns:fn=\"http://www.w3.org/2005/xpath-functions\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:sv=\"http://www.jcp.org/jcr/sv/1.0\" xmlns:rep=\"internal\" xmlns:jcr=\"http://www.jcp.org/jcr/1.0\">" + "   <sv:property sv:name=\"jcr:primaryType\" sv:type=\"Name\"><sv:value>rep:AuthorizableFolder</sv:value></sv:property>"+ "<sv:node sv:name=\"g1\"><sv:property sv:name=\"jcr:primaryType\" sv:type=\"Name\"><sv:value>rep:Group</sv:value></sv:property>"+ "   <sv:property sv:name=\"jcr:uuid\" sv:type=\"String\"><sv:value>" + g1Id + "</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:principalName\" sv:type=\"String\"><sv:value>g1</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:members\" sv:type=\"WeakReference\"><sv:value>"+ nonExistingId+ "</sv:value></sv:property>"+ "</sv:node>"+ "</sv:node>";
  String xml2="<?xml version=\"1.0\" encoding=\"UTF-8\"?>" + "   <sv:node sv:name=\"g\" xmlns:mix=\"http://www.jcp.org/jcr/mix/1.0\" xmlns:nt=\"http://www.jcp.org/jcr/nt/1.0\" xmlns:fn_old=\"http://www.w3.org/2004/10/xpath-functions\" xmlns:fn=\"http://www.w3.org/2005/xpath-functions\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:sv=\"http://www.jcp.org/jcr/sv/1.0\" xmlns:rep=\"internal\" xmlns:jcr=\"http://www.jcp.org/jcr/1.0\">" + "       <sv:property sv:name=\"jcr:primaryType\" sv:type=\"Name\"><sv:value>rep:Group</sv:value></sv:property>"+ "       <sv:property sv:name=\"jcr:uuid\" sv:type=\"String\"><sv:value>" + nonExistingId + "</sv:value></sv:property>"+ "       <sv:property sv:name=\"rep:principalName\" sv:type=\"String\"><sv:value>g</sv:value></sv:property>"+ "       <sv:property sv:name=\"rep:members\" sv:type=\"WeakReference\"><sv:value>"+ g1Id+ "</sv:value></sv:property>"+ "   </sv:node>";
  doImport(getTargetPath(),xml);
  doImport(getTargetPath() + "/gFolder",xml2);
  Authorizable g=getUserManager().getAuthorizable("g");
  assertNotNull(g);
  if (g.isGroup()) {
    assertNotDeclaredMember((Group)g,g1Id,getImportSession());
  }
 else {
    fail("'g' was not imported as Group.");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.user.GroupImportIgnoreTest </h4><pre class="type-12 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testImportNonExistingMemberIgnore() throws Exception {
  List<String> invalid=new ArrayList<String>();
  invalid.add(UUID.randomUUID().toString());
  invalid.add(getExistingUUID());
  for (  String id : invalid) {
    String xml="<?xml version=\"1.0\" encoding=\"UTF-8\"?>" + "<sv:node sv:name=\"gFolder\" xmlns:mix=\"http://www.jcp.org/jcr/mix/1.0\" xmlns:nt=\"http://www.jcp.org/jcr/nt/1.0\" xmlns:fn_old=\"http://www.w3.org/2004/10/xpath-functions\" xmlns:fn=\"http://www.w3.org/2005/xpath-functions\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:sv=\"http://www.jcp.org/jcr/sv/1.0\" xmlns:rep=\"internal\" xmlns:jcr=\"http://www.jcp.org/jcr/1.0\">" + "   <sv:property sv:name=\"jcr:primaryType\" sv:type=\"Name\"><sv:value>rep:AuthorizableFolder</sv:value></sv:property>"+ "<sv:node sv:name=\"g1\"><sv:property sv:name=\"jcr:primaryType\" sv:type=\"Name\"><sv:value>rep:Group</sv:value></sv:property>"+ "   <sv:property sv:name=\"jcr:uuid\" sv:type=\"String\"><sv:value>0120a4f9-196a-3f9e-b9f5-23f31f914da7</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:principalName\" sv:type=\"String\"><sv:value>g1</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:members\" sv:type=\"WeakReference\"><sv:value>" + id + "</sv:value></sv:property>"+ "</sv:node>"+ "</sv:node>";
    try {
      doImport(getTargetPath(),xml);
      Authorizable a=getUserManager().getAuthorizable("g1");
      if (a.isGroup()) {
        assertNotDeclaredMember((Group)a,id,getImportSession());
      }
 else {
        fail("'g1' was not imported as Group.");
      }
    }
  finally {
      getImportSession().refresh(false);
    }
  }
}

</code></pre>

<br>
<pre class="type-12 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testImportSelfAsGroupIgnore() throws Exception {
  String invalidId="0120a4f9-196a-3f9e-b9f5-23f31f914da7";
  String xml="<?xml version=\"1.0\" encoding=\"UTF-8\"?>" + "<sv:node sv:name=\"gFolder\" xmlns:mix=\"http://www.jcp.org/jcr/mix/1.0\" xmlns:nt=\"http://www.jcp.org/jcr/nt/1.0\" xmlns:fn_old=\"http://www.w3.org/2004/10/xpath-functions\" xmlns:fn=\"http://www.w3.org/2005/xpath-functions\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:sv=\"http://www.jcp.org/jcr/sv/1.0\" xmlns:rep=\"internal\" xmlns:jcr=\"http://www.jcp.org/jcr/1.0\">" + "   <sv:property sv:name=\"jcr:primaryType\" sv:type=\"Name\"><sv:value>rep:AuthorizableFolder</sv:value></sv:property>"+ "<sv:node sv:name=\"g1\"><sv:property sv:name=\"jcr:primaryType\" sv:type=\"Name\"><sv:value>rep:Group</sv:value></sv:property>"+ "   <sv:property sv:name=\"jcr:uuid\" sv:type=\"String\"><sv:value>" + invalidId + "</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:principalName\" sv:type=\"String\"><sv:value>g1</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:members\" sv:type=\"WeakReference\"><sv:value>"+ invalidId+ "</sv:value></sv:property>"+ "</sv:node>"+ "</sv:node>";
  doImport(getTargetPath(),xml);
  Authorizable a=getUserManager().getAuthorizable("g1");
  if (a.isGroup()) {
    assertNotDeclaredMember((Group)a,invalidId,getImportSession());
  }
 else {
    fail("'g1' was not imported as Group.");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.user.GroupImportTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testConflictingPrincipalsWithinImport() throws Exception {
  String xml="<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n" + "<sv:node sv:name=\"gFolder\" xmlns:mix=\"http://www.jcp.org/jcr/mix/1.0\" xmlns:nt=\"http://www.jcp.org/jcr/nt/1.0\" xmlns:fn_old=\"http://www.w3.org/2004/10/xpath-functions\" xmlns:fn=\"http://www.w3.org/2005/xpath-functions\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:sv=\"http://www.jcp.org/jcr/sv/1.0\" xmlns:rep=\"internal\" xmlns:jcr=\"http://www.jcp.org/jcr/1.0\">" + "<sv:property sv:name=\"jcr:primaryType\" sv:type=\"Name\">"+ "   <sv:value>rep:AuthorizableFolder</sv:value>"+ "</sv:property>"+ "<sv:node sv:name=\"g\" xmlns:mix=\"http://www.jcp.org/jcr/mix/1.0\" xmlns:nt=\"http://www.jcp.org/jcr/nt/1.0\" xmlns:fn_old=\"http://www.w3.org/2004/10/xpath-functions\" xmlns:fn=\"http://www.w3.org/2005/xpath-functions\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:sv=\"http://www.jcp.org/jcr/sv/1.0\" xmlns:rep=\"internal\" xmlns:jcr=\"http://www.jcp.org/jcr/1.0\">"+ "   <sv:property sv:name=\"jcr:primaryType\" sv:type=\"Name\"><sv:value>rep:Group</sv:value></sv:property>"+ "   <sv:property sv:name=\"jcr:uuid\" sv:type=\"String\"><sv:value>b2f5ff47-4366-31b6-a533-d8dc3614845d</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:principalName\" sv:type=\"String\"><sv:value>g</sv:value></sv:property>"+ "</sv:node>"+ "<sv:node sv:name=\"g1\" xmlns:mix=\"http://www.jcp.org/jcr/mix/1.0\" xmlns:nt=\"http://www.jcp.org/jcr/nt/1.0\" xmlns:fn_old=\"http://www.w3.org/2004/10/xpath-functions\" xmlns:fn=\"http://www.w3.org/2005/xpath-functions\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:sv=\"http://www.jcp.org/jcr/sv/1.0\" xmlns:rep=\"internal\" xmlns:jcr=\"http://www.jcp.org/jcr/1.0\">"+ "   <sv:property sv:name=\"jcr:primaryType\" sv:type=\"Name\"><sv:value>rep:Group</sv:value></sv:property>"+ "   <sv:property sv:name=\"jcr:uuid\" sv:type=\"String\"><sv:value>0120a4f9-196a-3f9e-b9f5-23f31f914da7</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:principalName\" sv:type=\"String\"><sv:value>g</sv:value></sv:property>"+ "</sv:node>"+ "</sv:node>";
  try {
    doImport(getTargetPath(),xml);
    getImportSession().save();
    fail("Import must detect conflicting principals.");
  }
 catch (  RepositoryException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testIncompleteGroup() throws Exception {
  String xml="<?xml version=\"1.0\" encoding=\"UTF-8\"?>" + "<sv:node sv:name=\"g\" xmlns:mix=\"http://www.jcp.org/jcr/mix/1.0\" xmlns:nt=\"http://www.jcp.org/jcr/nt/1.0\" xmlns:fn_old=\"http://www.w3.org/2004/10/xpath-functions\" xmlns:fn=\"http://www.w3.org/2005/xpath-functions\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:sv=\"http://www.jcp.org/jcr/sv/1.0\" xmlns:rep=\"internal\" xmlns:jcr=\"http://www.jcp.org/jcr/1.0\">" + "   <sv:property sv:name=\"jcr:primaryType\" sv:type=\"Name\"><sv:value>rep:Group</sv:value></sv:property>"+ "   <sv:property sv:name=\"jcr:uuid\" sv:type=\"String\"><sv:value>b2f5ff47-4366-31b6-a533-d8dc3614845d</sv:value></sv:property>"+ "</sv:node>";
  doImport(getTargetPath(),xml);
  try {
    getImportSession().save();
    fail("Import must be incomplete. Saving changes must fail.");
  }
 catch (  ConstraintViolationException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-6 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultiValuedPrincipalName() throws Exception {
  String xml="<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n" + "<sv:node sv:name=\"g\" xmlns:mix=\"http://www.jcp.org/jcr/mix/1.0\" xmlns:nt=\"http://www.jcp.org/jcr/nt/1.0\" xmlns:fn_old=\"http://www.w3.org/2004/10/xpath-functions\" xmlns:fn=\"http://www.w3.org/2005/xpath-functions\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:sv=\"http://www.jcp.org/jcr/sv/1.0\" xmlns:rep=\"internal\" xmlns:jcr=\"http://www.jcp.org/jcr/1.0\">" + "   <sv:property sv:name=\"jcr:primaryType\" sv:type=\"Name\"><sv:value>rep:Group</sv:value></sv:property>"+ "   <sv:property sv:name=\"jcr:uuid\" sv:type=\"String\"><sv:value>b2f5ff47-4366-31b6-a533-d8dc3614845d</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:principalName\" sv:type=\"String\"><sv:value>g</sv:value><sv:value>g2</sv:value><sv:value>g</sv:value></sv:property></sv:node>";
  Session s=getImportSession();
  Node target=getTargetNode();
  doImport(getTargetPath(),xml);
  assertTrue(target.isModified());
  assertTrue(s.hasPendingChanges());
  Authorizable newGroup=getUserManager().getAuthorizable("g");
  assertNotNull(newGroup);
  assertTrue(target.hasNode("g"));
  assertTrue(target.hasProperty("g/rep:principalName"));
  assertFalse(target.getProperty("g/rep:principalName").getDefinition().isProtected());
  try {
    s.save();
    fail("Import must be incomplete. Saving changes must fail.");
  }
 catch (  ConstraintViolationException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.user.RemappingTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testGetProperty2() throws Exception {
  for (  String relPath : unmappedPaths) {
    try {
      authorizable.getProperty(relPath);
      fail();
    }
 catch (    RepositoryException e) {
    }
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testRemoveProperty2() throws Exception {
  for (  String relPath : unmappedPaths) {
    try {
      authorizable.removeProperty(relPath);
      fail();
    }
 catch (    RepositoryException e) {
    }
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testHasProperty2() throws Exception {
  for (  String relPath : unmappedPaths) {
    try {
      authorizable.hasProperty(relPath);
      fail();
    }
 catch (    RepositoryException e) {
    }
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testGetPropertyNames3() throws Exception {
  try {
    Iterator it=authorizable.getPropertyNames("uTest:node");
    fail();
  }
 catch (  RepositoryException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testSetProperty2() throws Exception {
  for (  String relPath : unmappedPaths) {
    try {
      authorizable.setProperty(relPath,nameValue);
      fail();
    }
 catch (    RepositoryException e) {
    }
    try {
      authorizable.setProperty(relPath,new Value[]{nameValue});
      fail();
    }
 catch (    RepositoryException e) {
    }
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testGetAuthorizableByPath2() throws Exception {
  try {
    getUserManager(session).getAuthorizableByPath(user.getPath());
    fail("invalid path must be detected");
  }
 catch (  RepositoryException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.user.SystemUserImportTest </h4><pre class="type-5 type-7 type-6 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @since OAK 1.0 : constraintviolation is no longer detected during import
 * but only upon save.
 */
@Test public void testImportIntoNonSystemPath() throws Exception {
  String xml="<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n" + "<sv:node sv:name=\"t\" xmlns:mix=\"http://www.jcp.org/jcr/mix/1.0\" xmlns:nt=\"http://www.jcp.org/jcr/nt/1.0\" xmlns:fn_old=\"http://www.w3.org/2004/10/xpath-functions\" xmlns:fn=\"http://www.w3.org/2005/xpath-functions\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:sv=\"http://www.jcp.org/jcr/sv/1.0\" xmlns:rep=\"internal\" xmlns:jcr=\"http://www.jcp.org/jcr/1.0\">" + "   <sv:property sv:name=\"jcr:primaryType\" sv:type=\"Name\"><sv:value>rep:SystemUser</sv:value></sv:property>"+ "   <sv:property sv:name=\"jcr:uuid\" sv:type=\"String\"><sv:value>e358efa4-89f5-3062-b10d-d7316b65649e</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:principalName\" sv:type=\"String\"><sv:value>t</sv:value></sv:property>"+ "</sv:node>";
  Session s=getImportSession();
  Node target=s.getNode(USERPATH);
  doImport(USERPATH,xml);
  assertTrue(target.isModified());
  assertTrue(s.hasPendingChanges());
  Authorizable user=getUserManager().getAuthorizable("t");
  assertNotNull(user);
  assertTrue(target.hasNode("t"));
  assertTrue(target.hasProperty("t/rep:principalName"));
  try {
    s.save();
    fail("Import must be incomplete. Saving changes must fail.");
  }
 catch (  ConstraintViolationException e) {
  }
 finally {
    s.refresh(false);
    if (target.hasNode("t")) {
      target.getNode("t").remove();
      target.save();
    }
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * @since OAK 1.0 : Importing rep:authorizableId
 */
@Test public void testImportUserWithExistingId() throws Exception {
  String existingId="admin";
  String xml="<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n" + "<sv:node sv:name=\"t_diff\" xmlns:mix=\"http://www.jcp.org/jcr/mix/1.0\" xmlns:nt=\"http://www.jcp.org/jcr/nt/1.0\" xmlns:fn_old=\"http://www.w3.org/2004/10/xpath-functions\" xmlns:fn=\"http://www.w3.org/2005/xpath-functions\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:sv=\"http://www.jcp.org/jcr/sv/1.0\" xmlns:rep=\"internal\" xmlns:jcr=\"http://www.jcp.org/jcr/1.0\">" + "   <sv:property sv:name=\"jcr:primaryType\" sv:type=\"Name\"><sv:value>rep:SystemUser</sv:value></sv:property>"+ "   <sv:property sv:name=\"jcr:uuid\" sv:type=\"String\"><sv:value>e358efa4-89f5-3062-b10d-d7316b65649e</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:principalName\" sv:type=\"String\"><sv:value>t</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:authorizableId\" sv:type=\"String\"><sv:value>" + existingId + "</sv:value></sv:property>"+ "</sv:node>";
  try {
    doImport(getTargetPath(),xml);
    fail("Reuse of existing ID must be detected.");
  }
 catch (  AuthorizableExistsException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * @since OAK 1.0 : Importing rep:authorizableId
 */
@Test public void testImportUserWithIdCollision() throws Exception {
  String collidingId="t";
  String xml="<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n" + "<sv:node sv:name=\"uFolder\" xmlns:mix=\"http://www.jcp.org/jcr/mix/1.0\" xmlns:nt=\"http://www.jcp.org/jcr/nt/1.0\" xmlns:fn_old=\"http://www.w3.org/2004/10/xpath-functions\" xmlns:fn=\"http://www.w3.org/2005/xpath-functions\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:sv=\"http://www.jcp.org/jcr/sv/1.0\" xmlns:rep=\"internal\" xmlns:jcr=\"http://www.jcp.org/jcr/1.0\">" + "   <sv:property sv:name=\"jcr:primaryType\" sv:type=\"Name\"><sv:value>rep:AuthorizableFolder</sv:value></sv:property>"+ "<sv:node sv:name=\"t1\" xmlns:mix=\"http://www.jcp.org/jcr/mix/1.0\" xmlns:nt=\"http://www.jcp.org/jcr/nt/1.0\" xmlns:fn_old=\"http://www.w3.org/2004/10/xpath-functions\" xmlns:fn=\"http://www.w3.org/2005/xpath-functions\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:sv=\"http://www.jcp.org/jcr/sv/1.0\" xmlns:rep=\"internal\" xmlns:jcr=\"http://www.jcp.org/jcr/1.0\">"+ "   <sv:property sv:name=\"jcr:primaryType\" sv:type=\"Name\"><sv:value>rep:SystemUser</sv:value></sv:property>"+ "   <sv:property sv:name=\"jcr:uuid\" sv:type=\"String\"><sv:value>e358efa4-89f5-3062-b10d-d7316b65649e</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:principalName\" sv:type=\"String\"><sv:value>t</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:authorizableId\" sv:type=\"String\"><sv:value>" + collidingId + "</sv:value></sv:property>"+ "</sv:node>"+ "<sv:node sv:name=\"t2\" xmlns:mix=\"http://www.jcp.org/jcr/mix/1.0\" xmlns:nt=\"http://www.jcp.org/jcr/nt/1.0\" xmlns:fn_old=\"http://www.w3.org/2004/10/xpath-functions\" xmlns:fn=\"http://www.w3.org/2005/xpath-functions\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:sv=\"http://www.jcp.org/jcr/sv/1.0\" xmlns:rep=\"internal\" xmlns:jcr=\"http://www.jcp.org/jcr/1.0\">"+ "   <sv:property sv:name=\"jcr:primaryType\" sv:type=\"Name\"><sv:value>rep:SystemUser</sv:value></sv:property>"+ "   <sv:property sv:name=\"jcr:uuid\" sv:type=\"String\"><sv:value>0f826a89-cf68-3399-85f4-cf320c1a5842</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:principalName\" sv:type=\"String\"><sv:value>t</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:authorizableId\" sv:type=\"String\"><sv:value>"+ collidingId+ "</sv:value></sv:property>"+ "</sv:node>"+ "</sv:node>";
  try {
    doImport(getTargetPath(),xml);
    fail("Reuse of existing ID must be detected.");
  }
 catch (  AuthorizableExistsException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testIncompleteUser() throws Exception {
  List<String> incompleteXml=new ArrayList<String>();
  incompleteXml.add("<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n" + "<sv:node sv:name=\"t\" xmlns:mix=\"http://www.jcp.org/jcr/mix/1.0\" xmlns:nt=\"http://www.jcp.org/jcr/nt/1.0\" xmlns:fn_old=\"http://www.w3.org/2004/10/xpath-functions\" xmlns:fn=\"http://www.w3.org/2005/xpath-functions\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:sv=\"http://www.jcp.org/jcr/sv/1.0\" xmlns:rep=\"internal\" xmlns:jcr=\"http://www.jcp.org/jcr/1.0\">" + "   <sv:property sv:name=\"jcr:primaryType\" sv:type=\"Name\"><sv:value>rep:SystemUser</sv:value></sv:property>"+ "   <sv:property sv:name=\"jcr:uuid\" sv:type=\"String\"><sv:value>e358efa4-89f5-3062-b10d-d7316b65649e</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:password\" sv:type=\"String\"><sv:value>{sha1}8efd86fb78a56a5145ed7739dcb00c78581c5375</sv:value></sv:property>"+ "</sv:node>");
  incompleteXml.add("<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n" + "<sv:node sv:name=\"t\" xmlns:mix=\"http://www.jcp.org/jcr/mix/1.0\" xmlns:nt=\"http://www.jcp.org/jcr/nt/1.0\" xmlns:fn_old=\"http://www.w3.org/2004/10/xpath-functions\" xmlns:fn=\"http://www.w3.org/2005/xpath-functions\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:sv=\"http://www.jcp.org/jcr/sv/1.0\" xmlns:rep=\"internal\" xmlns:jcr=\"http://www.jcp.org/jcr/1.0\">" + "   <sv:property sv:name=\"jcr:primaryType\" sv:type=\"Name\"><sv:value>rep:SystemUser</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:principalName\" sv:type=\"String\"><sv:value>t</sv:value></sv:property>"+ "</sv:node>");
  Session s=getImportSession();
  for (  String xml : incompleteXml) {
    Node target=s.getNode(getTargetPath());
    try {
      doImport(getTargetPath(),xml);
      try {
        s.save();
        fail("Import must be incomplete. Saving changes must fail.");
      }
 catch (      ConstraintViolationException e) {
      }
    }
  finally {
      s.refresh(false);
      if (target.hasNode("t")) {
        target.getNode("t").remove();
        s.save();
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testExistingPrincipal() throws Exception {
  Principal existing=null;
  Session s=getImportSession();
  PrincipalIterator principalIterator=((JackrabbitSession)s).getPrincipalManager().getPrincipals(PrincipalManager.SEARCH_TYPE_ALL);
  while (principalIterator.hasNext()) {
    Principal p=principalIterator.nextPrincipal();
    if (getUserManager().getAuthorizable(p) != null) {
      existing=p;
      break;
    }
  }
  if (existing == null) {
    throw new NotExecutableException();
  }
  String xml="<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n" + "<sv:node sv:name=\"t\" xmlns:mix=\"http://www.jcp.org/jcr/mix/1.0\" xmlns:nt=\"http://www.jcp.org/jcr/nt/1.0\" xmlns:fn_old=\"http://www.w3.org/2004/10/xpath-functions\" xmlns:fn=\"http://www.w3.org/2005/xpath-functions\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:sv=\"http://www.jcp.org/jcr/sv/1.0\" xmlns:rep=\"internal\" xmlns:jcr=\"http://www.jcp.org/jcr/1.0\">" + "   <sv:property sv:name=\"jcr:primaryType\" sv:type=\"Name\"><sv:value>rep:SystemUser</sv:value></sv:property>"+ "   <sv:property sv:name=\"jcr:uuid\" sv:type=\"String\"><sv:value>e358efa4-89f5-3062-b10d-d7316b65649e</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:principalName\" sv:type=\"String\"><sv:value>" + existing.getName() + "</sv:value></sv:property>"+ "</sv:node>";
  try {
    doImport(getTargetPath(),xml);
    s.save();
    fail("Import must detect conflicting principals.");
  }
 catch (  RepositoryException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testImportUuidCollisionThrow() throws Exception {
  String xml="<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n" + "<sv:node sv:name=\"t\" xmlns:mix=\"http://www.jcp.org/jcr/mix/1.0\" xmlns:nt=\"http://www.jcp.org/jcr/nt/1.0\" xmlns:fn_old=\"http://www.w3.org/2004/10/xpath-functions\" xmlns:fn=\"http://www.w3.org/2005/xpath-functions\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:sv=\"http://www.jcp.org/jcr/sv/1.0\" xmlns:rep=\"internal\" xmlns:jcr=\"http://www.jcp.org/jcr/1.0\">" + "   <sv:property sv:name=\"jcr:primaryType\" sv:type=\"Name\"><sv:value>rep:SystemUser</sv:value></sv:property>"+ "   <sv:property sv:name=\"jcr:uuid\" sv:type=\"String\"><sv:value>e358efa4-89f5-3062-b10d-d7316b65649e</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:principalName\" sv:type=\"String\"><sv:value>t</sv:value></sv:property>"+ "</sv:node>";
  try {
    doImport(getTargetPath(),xml);
    doImport(getTargetPath(),xml,ImportUUIDBehavior.IMPORT_UUID_COLLISION_THROW);
    fail("UUID collision must be handled according to the uuid behavior.");
  }
 catch (  ItemExistsException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.user.SystemUserTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCreateUserWithEmptyUserID() throws RepositoryException {
  try {
    user=createUser("");
    fail("A User cannot be built with \"\" userID");
  }
 catch (  Exception e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCreateUserWithNullUserID() throws RepositoryException {
  try {
    user=createUser(null);
    fail("A User cannot be built with 'null' userID");
  }
 catch (  Exception e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testChangePassword2() throws Exception {
  user=createUser(uid);
  try {
    user.changePassword("old","pw");
    superuser.save();
    fail();
  }
 catch (  UnsupportedRepositoryOperationException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCreateTwiceWithSameUserID() throws RepositoryException, NotExecutableException {
  user=createUser(uid);
  try {
    User user2=createUser(uid);
    fail("Creating 2 users with the same UserID should throw AuthorizableExistsException.");
  }
 catch (  AuthorizableExistsException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testChangePassword() throws Exception {
  user=createUser(uid);
  try {
    user.changePassword("pw");
    superuser.save();
    fail();
  }
 catch (  UnsupportedRepositoryOperationException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.user.UserImportAbortTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testImportNonExistingImpersonationAbort() throws Exception {
  String nonExistingPrincipalName="anybody";
  String xml="<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n" + "<sv:node sv:name=\"t\" xmlns:mix=\"http://www.jcp.org/jcr/mix/1.0\" xmlns:nt=\"http://www.jcp.org/jcr/nt/1.0\" xmlns:fn_old=\"http://www.w3.org/2004/10/xpath-functions\" xmlns:fn=\"http://www.w3.org/2005/xpath-functions\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:sv=\"http://www.jcp.org/jcr/sv/1.0\" xmlns:rep=\"internal\" xmlns:jcr=\"http://www.jcp.org/jcr/1.0\">" + "   <sv:property sv:name=\"jcr:primaryType\" sv:type=\"Name\"><sv:value>rep:User</sv:value></sv:property>"+ "   <sv:property sv:name=\"jcr:uuid\" sv:type=\"String\"><sv:value>e358efa4-89f5-3062-b10d-d7316b65649e</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:password\" sv:type=\"String\"><sv:value>{sha1}8efd86fb78a56a5145ed7739dcb00c78581c5375</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:principalName\" sv:type=\"String\"><sv:value>t</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:impersonators\" sv:type=\"String\"><sv:value>" + nonExistingPrincipalName + "</sv:value></sv:property>"+ "</sv:node>";
  try {
    doImport(getTargetPath(),xml);
    fail("UserImporter.ImportBehavior.ABORT -> importing invalid impersonators must throw.");
  }
 catch (  RepositoryException e) {
  }
 finally {
    getImportSession().refresh(false);
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testImportInvalidImpersonationAbort() throws Exception {
  List<String> invalid=new ArrayList<String>();
  invalid.add("administrators");
  invalid.add("t");
  for (  String principalName : invalid) {
    String xml="<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n" + "<sv:node sv:name=\"t\" xmlns:mix=\"http://www.jcp.org/jcr/mix/1.0\" xmlns:nt=\"http://www.jcp.org/jcr/nt/1.0\" xmlns:fn_old=\"http://www.w3.org/2004/10/xpath-functions\" xmlns:fn=\"http://www.w3.org/2005/xpath-functions\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:sv=\"http://www.jcp.org/jcr/sv/1.0\" xmlns:rep=\"internal\" xmlns:jcr=\"http://www.jcp.org/jcr/1.0\">" + "   <sv:property sv:name=\"jcr:primaryType\" sv:type=\"Name\"><sv:value>rep:User</sv:value></sv:property>"+ "   <sv:property sv:name=\"jcr:uuid\" sv:type=\"String\"><sv:value>e358efa4-89f5-3062-b10d-d7316b65649e</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:password\" sv:type=\"String\"><sv:value>{sha1}8efd86fb78a56a5145ed7739dcb00c78581c5375</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:principalName\" sv:type=\"String\"><sv:value>t</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:impersonators\" sv:type=\"String\"><sv:value>" + principalName + "</sv:value></sv:property>"+ "</sv:node>";
    try {
      doImport(getTargetPath(),xml);
      fail("UserImporter.ImportBehavior.ABORT -> importing invalid impersonators must throw.");
    }
 catch (    RepositoryException e) {
    }
 finally {
      getImportSession().refresh(false);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.user.UserImportBestEffortTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testImportUuidCollisionThrow() throws Exception {
  String xml="<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n" + "<sv:node sv:name=\"t\" xmlns:mix=\"http://www.jcp.org/jcr/mix/1.0\" xmlns:nt=\"http://www.jcp.org/jcr/nt/1.0\" xmlns:fn_old=\"http://www.w3.org/2004/10/xpath-functions\" xmlns:fn=\"http://www.w3.org/2005/xpath-functions\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:sv=\"http://www.jcp.org/jcr/sv/1.0\" xmlns:rep=\"internal\" xmlns:jcr=\"http://www.jcp.org/jcr/1.0\">" + "   <sv:property sv:name=\"jcr:primaryType\" sv:type=\"Name\"><sv:value>rep:User</sv:value></sv:property>"+ "   <sv:property sv:name=\"jcr:uuid\" sv:type=\"String\"><sv:value>e358efa4-89f5-3062-b10d-d7316b65649e</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:password\" sv:type=\"String\"><sv:value>{sha1}8efd86fb78a56a5145ed7739dcb00c78581c5375</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:principalName\" sv:type=\"String\"><sv:value>t</sv:value></sv:property>"+ "</sv:node>";
  try {
    doImport(getTargetPath(),xml);
    doImport(getTargetPath(),xml,ImportUUIDBehavior.IMPORT_UUID_COLLISION_THROW);
    fail("UUID collision must be handled according to the uuid behavior.");
  }
 catch (  ItemExistsException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.user.UserImportFromJackrabbit </h4><pre class="type-9 type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @since Oak 1.2
 */
@Test public void testUUIDBehaviorReplaceFromRenamed2() throws Exception {
  User u=getUserManager().createUser(uid,null,new PrincipalImpl(uid),intermediatePath);
  String initialPath=u.getPath();
  String movedPath=Text.getRelativeParent(initialPath,1) + '/' + randomNodeName;
  importSession.move(initialPath,movedPath);
  importSession.save();
  String xml="<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n" + "<sv:node sv:name=\"" + randomNodeName + "\" xmlns:mix=\"http://www.jcp.org/jcr/mix/1.0\" xmlns:nt=\"http://www.jcp.org/jcr/nt/1.0\" xmlns:fn_old=\"http://www.w3.org/2004/10/xpath-functions\" xmlns:fn=\"http://www.w3.org/2005/xpath-functions\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:sv=\"http://www.jcp.org/jcr/sv/1.0\" xmlns:rep=\"internal\" xmlns:jcr=\"http://www.jcp.org/jcr/1.0\">"+ "   <sv:property sv:name=\"jcr:primaryType\" sv:type=\"Name\"><sv:value>rep:User</sv:value></sv:property>"+ "   <sv:property sv:name=\"jcr:uuid\" sv:type=\"String\"><sv:value>e358efa4-89f5-3062-b10d-d7316b65649e</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:password\" sv:type=\"String\"><sv:value>{sha1}8efd86fb78a56a5145ed7739dcb00c78581c5375</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:principalName\" sv:type=\"String\"><sv:value>t</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:disabled\" sv:type=\"String\"><sv:value>disabledUser</sv:value></sv:property>"+ "</sv:node>";
  doImport(getTargetPath(),xml,ImportUUIDBehavior.IMPORT_UUID_COLLISION_REPLACE_EXISTING);
  Authorizable newUser=getUserManager().getAuthorizable(uid);
  assertEquals("user path",movedPath,newUser.getPath());
  Node n=importSession.getNode(newUser.getPath());
  assertTrue(n.hasProperty(UserConstants.REP_AUTHORIZABLE_ID));
  assertEquals(UserConstants.REP_AUTHORIZABLE_ID,randomNodeName,n.getProperty(UserConstants.REP_AUTHORIZABLE_ID).getString());
  try {
    importSession.save();
    fail("Importing an authorizable with mismatch between authorizableId and uuid must fail.");
  }
 catch (  ConstraintViolationException e) {
    assertTrue(e.getMessage().contains("OakConstraint0022"));
  }
}

</code></pre>

<br>
<pre class="type-9 type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @since Oak 1.2
 */
@Test public void testUUIDBehaviorReplaceFromRenamed3() throws Exception {
  User u=getUserManager().createUser(uid,null,new PrincipalImpl(uid),intermediatePath);
  String originalPath=u.getPath();
  importSession.save();
  String xml="<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n" + "<sv:node sv:name=\"" + randomNodeName + "\" xmlns:mix=\"http://www.jcp.org/jcr/mix/1.0\" xmlns:nt=\"http://www.jcp.org/jcr/nt/1.0\" xmlns:fn_old=\"http://www.w3.org/2004/10/xpath-functions\" xmlns:fn=\"http://www.w3.org/2005/xpath-functions\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:sv=\"http://www.jcp.org/jcr/sv/1.0\" xmlns:rep=\"internal\" xmlns:jcr=\"http://www.jcp.org/jcr/1.0\">"+ "   <sv:property sv:name=\"jcr:primaryType\" sv:type=\"Name\"><sv:value>rep:User</sv:value></sv:property>"+ "   <sv:property sv:name=\"jcr:uuid\" sv:type=\"String\"><sv:value>e358efa4-89f5-3062-b10d-d7316b65649e</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:password\" sv:type=\"String\"><sv:value>{sha1}8efd86fb78a56a5145ed7739dcb00c78581c5375</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:principalName\" sv:type=\"String\"><sv:value>t</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:disabled\" sv:type=\"String\"><sv:value>disabledUser</sv:value></sv:property>"+ "</sv:node>";
  doImport(getTargetPath(),xml,ImportUUIDBehavior.IMPORT_UUID_COLLISION_REPLACE_EXISTING);
  Authorizable newUser=getUserManager().getAuthorizable(uid);
  String expectedPath=Text.getRelativeParent(originalPath,1) + '/' + randomNodeName;
  assertEquals("user path",expectedPath,newUser.getPath());
  Node n=importSession.getNode(newUser.getPath());
  assertTrue(n.hasProperty(UserConstants.REP_AUTHORIZABLE_ID));
  assertEquals(UserConstants.REP_AUTHORIZABLE_ID,randomNodeName,n.getProperty(UserConstants.REP_AUTHORIZABLE_ID).getString());
  try {
    importSession.save();
    fail("Importing an authorizable with mismatch between authorizableId and uuid must fail.");
  }
 catch (  ConstraintViolationException e) {
    assertTrue(e.getMessage().contains("OakConstraint0021"));
  }
}

</code></pre>

<br>
<pre class="type-9 type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @since Oak 1.2
 */
@Test public void testUUIDBehaviorRemoveFromRenamed3() throws Exception {
  User u=getUserManager().createUser(uid,null,new PrincipalImpl(uid),intermediatePath);
  String originalPath=u.getPath();
  importSession.save();
  String xml="<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n" + "<sv:node sv:name=\"" + randomNodeName + "\" xmlns:mix=\"http://www.jcp.org/jcr/mix/1.0\" xmlns:nt=\"http://www.jcp.org/jcr/nt/1.0\" xmlns:fn_old=\"http://www.w3.org/2004/10/xpath-functions\" xmlns:fn=\"http://www.w3.org/2005/xpath-functions\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:sv=\"http://www.jcp.org/jcr/sv/1.0\" xmlns:rep=\"internal\" xmlns:jcr=\"http://www.jcp.org/jcr/1.0\">"+ "   <sv:property sv:name=\"jcr:primaryType\" sv:type=\"Name\"><sv:value>rep:User</sv:value></sv:property>"+ "   <sv:property sv:name=\"jcr:uuid\" sv:type=\"String\"><sv:value>e358efa4-89f5-3062-b10d-d7316b65649e</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:password\" sv:type=\"String\"><sv:value>{sha1}8efd86fb78a56a5145ed7739dcb00c78581c5375</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:principalName\" sv:type=\"String\"><sv:value>t</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:disabled\" sv:type=\"String\"><sv:value>disabledUser</sv:value></sv:property>"+ "</sv:node>";
  doImport(getTargetPath(),xml,ImportUUIDBehavior.IMPORT_UUID_COLLISION_REMOVE_EXISTING);
  Authorizable newUser=getUserManager().getAuthorizable(uid);
  String expectedPath=getTargetPath() + '/' + randomNodeName;
  assertEquals("user path",expectedPath,newUser.getPath());
  assertFalse((Text.getRelativeParent(originalPath,1) + '/' + randomNodeName).equals(newUser.getPath()));
  Node n=importSession.getNode(newUser.getPath());
  assertTrue(n.hasProperty(UserConstants.REP_AUTHORIZABLE_ID));
  assertEquals(UserConstants.REP_AUTHORIZABLE_ID,randomNodeName,n.getProperty(UserConstants.REP_AUTHORIZABLE_ID).getString());
  try {
    importSession.save();
    fail("Importing an authorizable with mismatch between authorizableId and uuid must fail.");
  }
 catch (  ConstraintViolationException e) {
    assertTrue(e.getMessage().contains("OakConstraint0021"));
  }
}

</code></pre>

<br>
<pre class="type-9 type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @since Oak 1.2
 */
@Test public void testUUIDBehaviorRemoveFromRenamed2() throws Exception {
  User u=getUserManager().createUser(uid,null,new PrincipalImpl(uid),intermediatePath);
  String initialPath=u.getPath();
  String movedPath=Text.getRelativeParent(initialPath,1) + '/' + randomNodeName;
  importSession.move(initialPath,movedPath);
  importSession.save();
  String xml="<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n" + "<sv:node sv:name=\"" + randomNodeName + "\" xmlns:mix=\"http://www.jcp.org/jcr/mix/1.0\" xmlns:nt=\"http://www.jcp.org/jcr/nt/1.0\" xmlns:fn_old=\"http://www.w3.org/2004/10/xpath-functions\" xmlns:fn=\"http://www.w3.org/2005/xpath-functions\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:sv=\"http://www.jcp.org/jcr/sv/1.0\" xmlns:rep=\"internal\" xmlns:jcr=\"http://www.jcp.org/jcr/1.0\">"+ "   <sv:property sv:name=\"jcr:primaryType\" sv:type=\"Name\"><sv:value>rep:User</sv:value></sv:property>"+ "   <sv:property sv:name=\"jcr:uuid\" sv:type=\"String\"><sv:value>e358efa4-89f5-3062-b10d-d7316b65649e</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:password\" sv:type=\"String\"><sv:value>{sha1}8efd86fb78a56a5145ed7739dcb00c78581c5375</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:principalName\" sv:type=\"String\"><sv:value>t</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:disabled\" sv:type=\"String\"><sv:value>disabledUser</sv:value></sv:property>"+ "</sv:node>";
  doImport(getTargetPath(),xml,ImportUUIDBehavior.IMPORT_UUID_COLLISION_REMOVE_EXISTING);
  Authorizable newUser=getUserManager().getAuthorizable(uid);
  assertEquals("user path",getTargetPath() + '/' + randomNodeName,newUser.getPath());
  Node n=importSession.getNode(newUser.getPath());
  assertTrue(n.hasProperty(UserConstants.REP_AUTHORIZABLE_ID));
  assertEquals(UserConstants.REP_AUTHORIZABLE_ID,randomNodeName,n.getProperty(UserConstants.REP_AUTHORIZABLE_ID).getString());
  try {
    importSession.save();
    fail("Importing an authorizable with mismatch between authorizableId and uuid must fail.");
  }
 catch (  ConstraintViolationException e) {
    assertTrue(e.getMessage().contains("OakConstraint0021"));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.user.UserImportIgnoreTest </h4><pre class="type-13 type-12 type-5 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testImportInvalidImpersonationIgnore() throws Exception {
  List<String> invalid=new ArrayList<String>();
  invalid.add("anybody");
  invalid.add("administrators");
  invalid.add("t");
  for (  String principalName : invalid) {
    String xml="<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n" + "<sv:node sv:name=\"t\" xmlns:mix=\"http://www.jcp.org/jcr/mix/1.0\" xmlns:nt=\"http://www.jcp.org/jcr/nt/1.0\" xmlns:fn_old=\"http://www.w3.org/2004/10/xpath-functions\" xmlns:fn=\"http://www.w3.org/2005/xpath-functions\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:sv=\"http://www.jcp.org/jcr/sv/1.0\" xmlns:rep=\"internal\" xmlns:jcr=\"http://www.jcp.org/jcr/1.0\">" + "   <sv:property sv:name=\"jcr:primaryType\" sv:type=\"Name\"><sv:value>rep:User</sv:value></sv:property>"+ "   <sv:property sv:name=\"jcr:uuid\" sv:type=\"String\"><sv:value>e358efa4-89f5-3062-b10d-d7316b65649e</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:password\" sv:type=\"String\"><sv:value>{sha1}8efd86fb78a56a5145ed7739dcb00c78581c5375</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:principalName\" sv:type=\"String\"><sv:value>t</sv:value></sv:property><sv:property sv:name=\"rep:impersonators\" sv:type=\"String\"><sv:value>" + principalName + "</sv:value></sv:property>"+ "</sv:node>";
    Subject subj=new Subject();
    subj.getPrincipals().add(new PrincipalImpl(principalName));
    try {
      doImport(getTargetPath(),xml);
      Authorizable a=getUserManager().getAuthorizable("t");
      if (!a.isGroup()) {
        Impersonation imp=((User)a).getImpersonation();
        Subject s=new Subject();
        s.getPrincipals().add(new PrincipalImpl(principalName));
        assertFalse(imp.allows(s));
        for (PrincipalIterator it=imp.getImpersonators(); it.hasNext(); ) {
          assertFalse(principalName.equals(it.nextPrincipal().getName()));
        }
      }
 else {
        fail("Importing 't' didn't create a User.");
      }
    }
  finally {
      getImportSession().refresh(false);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.user.UserImportTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * @since OAK 1.0 : Importing rep:authorizableId
 */
@Test public void testImportUserWithExistingId() throws Exception {
  String existingId="admin";
  String xml="<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n" + "<sv:node sv:name=\"t_diff\" xmlns:mix=\"http://www.jcp.org/jcr/mix/1.0\" xmlns:nt=\"http://www.jcp.org/jcr/nt/1.0\" xmlns:fn_old=\"http://www.w3.org/2004/10/xpath-functions\" xmlns:fn=\"http://www.w3.org/2005/xpath-functions\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:sv=\"http://www.jcp.org/jcr/sv/1.0\" xmlns:rep=\"internal\" xmlns:jcr=\"http://www.jcp.org/jcr/1.0\">" + "   <sv:property sv:name=\"jcr:primaryType\" sv:type=\"Name\"><sv:value>rep:User</sv:value></sv:property>"+ "   <sv:property sv:name=\"jcr:uuid\" sv:type=\"String\"><sv:value>e358efa4-89f5-3062-b10d-d7316b65649e</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:password\" sv:type=\"String\"><sv:value>{sha1}8efd86fb78a56a5145ed7739dcb00c78581c5375</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:principalName\" sv:type=\"String\"><sv:value>t</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:authorizableId\" sv:type=\"String\"><sv:value>" + existingId + "</sv:value></sv:property>"+ "</sv:node>";
  try {
    doImport(getTargetPath(),xml);
    fail("Reuse of existing ID must be detected.");
  }
 catch (  AuthorizableExistsException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-6 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @since OAK 1.0 : constraintviolation is no longer detected during import
 * but only upon save.
 */
@Test public void testImportGroupIntoUsersTree() throws Exception {
  String xml="<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n" + "<sv:node sv:name=\"g\" xmlns:mix=\"http://www.jcp.org/jcr/mix/1.0\" xmlns:nt=\"http://www.jcp.org/jcr/nt/1.0\" xmlns:fn_old=\"http://www.w3.org/2004/10/xpath-functions\" xmlns:fn=\"http://www.w3.org/2005/xpath-functions\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:sv=\"http://www.jcp.org/jcr/sv/1.0\" xmlns:rep=\"internal\" xmlns:jcr=\"http://www.jcp.org/jcr/1.0\">" + "   <sv:property sv:name=\"jcr:primaryType\" sv:type=\"Name\"><sv:value>rep:Group</sv:value></sv:property>"+ "   <sv:property sv:name=\"jcr:uuid\" sv:type=\"String\"><sv:value>b2f5ff47-4366-31b6-a533-d8dc3614845d</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:principalName\" sv:type=\"String\"><sv:value>g</sv:value></sv:property>"+ "</sv:node>";
  Node target=getTargetNode();
  doImport(getTargetPath(),xml);
  assertTrue(target.isModified());
  assertTrue(getImportSession().hasPendingChanges());
  Authorizable newGroup=getUserManager().getAuthorizable("g");
  assertNotNull(newGroup);
  assertTrue(target.hasNode("g"));
  assertTrue(target.hasProperty("g/rep:principalName"));
  try {
    getImportSession().save();
    fail("Import must be incomplete. Saving changes must fail.");
  }
 catch (  ConstraintViolationException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testExistingPrincipal() throws Exception {
  Principal existing=null;
  PrincipalIterator principalIterator=((JackrabbitSession)getImportSession()).getPrincipalManager().getPrincipals(PrincipalManager.SEARCH_TYPE_ALL);
  while (principalIterator.hasNext()) {
    Principal p=principalIterator.nextPrincipal();
    if (getUserManager().getAuthorizable(p) != null) {
      existing=p;
      break;
    }
  }
  if (existing == null) {
    throw new NotExecutableException();
  }
  String xml="<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n" + "<sv:node sv:name=\"t\" xmlns:mix=\"http://www.jcp.org/jcr/mix/1.0\" xmlns:nt=\"http://www.jcp.org/jcr/nt/1.0\" xmlns:fn_old=\"http://www.w3.org/2004/10/xpath-functions\" xmlns:fn=\"http://www.w3.org/2005/xpath-functions\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:sv=\"http://www.jcp.org/jcr/sv/1.0\" xmlns:rep=\"internal\" xmlns:jcr=\"http://www.jcp.org/jcr/1.0\">" + "   <sv:property sv:name=\"jcr:primaryType\" sv:type=\"Name\"><sv:value>rep:User</sv:value></sv:property>"+ "   <sv:property sv:name=\"jcr:uuid\" sv:type=\"String\"><sv:value>e358efa4-89f5-3062-b10d-d7316b65649e</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:password\" sv:type=\"String\"><sv:value>{sha1}8efd86fb78a56a5145ed7739dcb00c78581c5375</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:principalName\" sv:type=\"String\"><sv:value>" + existing.getName() + "</sv:value></sv:property>"+ "</sv:node>";
  try {
    doImport(getTargetPath(),xml);
    getImportSession().save();
    fail("Import must detect conflicting principals.");
  }
 catch (  RepositoryException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testIncompleteUser() throws Exception {
  List<String> incompleteXml=new ArrayList<String>();
  incompleteXml.add("<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n" + "<sv:node sv:name=\"t\" xmlns:mix=\"http://www.jcp.org/jcr/mix/1.0\" xmlns:nt=\"http://www.jcp.org/jcr/nt/1.0\" xmlns:fn_old=\"http://www.w3.org/2004/10/xpath-functions\" xmlns:fn=\"http://www.w3.org/2005/xpath-functions\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:sv=\"http://www.jcp.org/jcr/sv/1.0\" xmlns:rep=\"internal\" xmlns:jcr=\"http://www.jcp.org/jcr/1.0\">" + "   <sv:property sv:name=\"jcr:primaryType\" sv:type=\"Name\"><sv:value>rep:User</sv:value></sv:property>"+ "   <sv:property sv:name=\"jcr:uuid\" sv:type=\"String\"><sv:value>e358efa4-89f5-3062-b10d-d7316b65649e</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:password\" sv:type=\"String\"><sv:value>{sha1}8efd86fb78a56a5145ed7739dcb00c78581c5375</sv:value></sv:property>"+ "</sv:node>");
  incompleteXml.add("<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n" + "<sv:node sv:name=\"t\" xmlns:mix=\"http://www.jcp.org/jcr/mix/1.0\" xmlns:nt=\"http://www.jcp.org/jcr/nt/1.0\" xmlns:fn_old=\"http://www.w3.org/2004/10/xpath-functions\" xmlns:fn=\"http://www.w3.org/2005/xpath-functions\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:sv=\"http://www.jcp.org/jcr/sv/1.0\" xmlns:rep=\"internal\" xmlns:jcr=\"http://www.jcp.org/jcr/1.0\">" + "   <sv:property sv:name=\"jcr:primaryType\" sv:type=\"Name\"><sv:value>rep:User</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:principalName\" sv:type=\"String\"><sv:value>t</sv:value></sv:property>"+ "</sv:node>");
  Session s=getImportSession();
  for (  String xml : incompleteXml) {
    Node target=s.getNode(getTargetPath());
    try {
      doImport(getTargetPath(),xml);
      try {
        s.save();
        fail("Import must be incomplete. Saving changes must fail.");
      }
 catch (      ConstraintViolationException e) {
      }
    }
  finally {
      s.refresh(false);
      if (target.hasNode("t")) {
        target.getNode("t").remove();
        s.save();
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * @since OAK 1.0 : Importing rep:authorizableId
 */
@Test public void testImportUserWithIdCollision() throws Exception {
  String collidingId="t";
  String xml="<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n" + "<sv:node sv:name=\"uFolder\" xmlns:mix=\"http://www.jcp.org/jcr/mix/1.0\" xmlns:nt=\"http://www.jcp.org/jcr/nt/1.0\" xmlns:fn_old=\"http://www.w3.org/2004/10/xpath-functions\" xmlns:fn=\"http://www.w3.org/2005/xpath-functions\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:sv=\"http://www.jcp.org/jcr/sv/1.0\" xmlns:rep=\"internal\" xmlns:jcr=\"http://www.jcp.org/jcr/1.0\">" + "   <sv:property sv:name=\"jcr:primaryType\" sv:type=\"Name\"><sv:value>rep:AuthorizableFolder</sv:value></sv:property>"+ "<sv:node sv:name=\"t1\" xmlns:mix=\"http://www.jcp.org/jcr/mix/1.0\" xmlns:nt=\"http://www.jcp.org/jcr/nt/1.0\" xmlns:fn_old=\"http://www.w3.org/2004/10/xpath-functions\" xmlns:fn=\"http://www.w3.org/2005/xpath-functions\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:sv=\"http://www.jcp.org/jcr/sv/1.0\" xmlns:rep=\"internal\" xmlns:jcr=\"http://www.jcp.org/jcr/1.0\">"+ "   <sv:property sv:name=\"jcr:primaryType\" sv:type=\"Name\"><sv:value>rep:User</sv:value></sv:property>"+ "   <sv:property sv:name=\"jcr:uuid\" sv:type=\"String\"><sv:value>e358efa4-89f5-3062-b10d-d7316b65649e</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:password\" sv:type=\"String\"><sv:value>{sha1}8efd86fb78a56a5145ed7739dcb00c78581c5375</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:principalName\" sv:type=\"String\"><sv:value>t</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:authorizableId\" sv:type=\"String\"><sv:value>" + collidingId + "</sv:value></sv:property>"+ "</sv:node>"+ "<sv:node sv:name=\"t2\" xmlns:mix=\"http://www.jcp.org/jcr/mix/1.0\" xmlns:nt=\"http://www.jcp.org/jcr/nt/1.0\" xmlns:fn_old=\"http://www.w3.org/2004/10/xpath-functions\" xmlns:fn=\"http://www.w3.org/2005/xpath-functions\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:sv=\"http://www.jcp.org/jcr/sv/1.0\" xmlns:rep=\"internal\" xmlns:jcr=\"http://www.jcp.org/jcr/1.0\">"+ "   <sv:property sv:name=\"jcr:primaryType\" sv:type=\"Name\"><sv:value>rep:User</sv:value></sv:property>"+ "   <sv:property sv:name=\"jcr:uuid\" sv:type=\"String\"><sv:value>0f826a89-cf68-3399-85f4-cf320c1a5842</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:password\" sv:type=\"String\"><sv:value>{sha1}8efd86fb78a56a5145ed7739dcb00c78581c5375</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:principalName\" sv:type=\"String\"><sv:value>t</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:authorizableId\" sv:type=\"String\"><sv:value>"+ collidingId+ "</sv:value></sv:property>"+ "</sv:node>"+ "</sv:node>";
  try {
    doImport(getTargetPath(),xml);
    fail("Reuse of existing ID must be detected.");
  }
 catch (  AuthorizableExistsException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testImportUuidCollisionRemoveExistingWithInvalidUUID() throws Exception {
  String xml="<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n" + "<sv:node sv:name=\"r\" xmlns:mix=\"http://www.jcp.org/jcr/mix/1.0\" xmlns:nt=\"http://www.jcp.org/jcr/nt/1.0\" xmlns:fn_old=\"http://www.w3.org/2004/10/xpath-functions\" xmlns:fn=\"http://www.w3.org/2005/xpath-functions\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:sv=\"http://www.jcp.org/jcr/sv/1.0\" xmlns:rep=\"internal\" xmlns:jcr=\"http://www.jcp.org/jcr/1.0\">" + "   <sv:property sv:name=\"jcr:primaryType\" sv:type=\"Name\"><sv:value>rep:User</sv:value></sv:property>"+ "   <sv:property sv:name=\"jcr:uuid\" sv:type=\"String\"><sv:value>4b43b0ae-e356-34cd-95b9-10189b3dc231</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:password\" sv:type=\"String\"><sv:value>{sha1}8efd86fb78a56a5145ed7739dcb00c78581c5375</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:authorizableId\" sv:type=\"String\"><sv:value>r</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:principalName\" sv:type=\"String\"><sv:value>t</sv:value></sv:property>"+ "</sv:node>";
  doImport(getTargetPath(),xml);
  xml="<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n" + "<sv:node sv:name=\"r\" xmlns:mix=\"http://www.jcp.org/jcr/mix/1.0\" xmlns:nt=\"http://www.jcp.org/jcr/nt/1.0\" xmlns:fn_old=\"http://www.w3.org/2004/10/xpath-functions\" xmlns:fn=\"http://www.w3.org/2005/xpath-functions\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:sv=\"http://www.jcp.org/jcr/sv/1.0\" xmlns:rep=\"internal\" xmlns:jcr=\"http://www.jcp.org/jcr/1.0\">" + "   <sv:property sv:name=\"jcr:primaryType\" sv:type=\"Name\"><sv:value>rep:User</sv:value></sv:property>"+ "   <sv:property sv:name=\"jcr:uuid\" sv:type=\"String\"><sv:value>4b43b0ae-e356-34cd-95b9-10189b3dc231</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:password\" sv:type=\"String\"><sv:value>{sha1}8efd86fb78a56a5145ed7739dcb00c78581c5375</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:authorizableId\" sv:type=\"String\"><sv:value>ANOTHER_ID</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:principalName\" sv:type=\"String\"><sv:value>t</sv:value></sv:property>"+ "</sv:node>";
  try {
    doImport(getTargetPath(),xml,ImportUUIDBehavior.IMPORT_UUID_COLLISION_REMOVE_EXISTING);
    fail("Xml with illegal authorizable id must fail.");
  }
 catch (  ConstraintViolationException e) {
  }
 finally {
    getImportSession().refresh(false);
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testImportUuidCollisionThrow() throws Exception {
  String xml="<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n" + "<sv:node sv:name=\"t\" xmlns:mix=\"http://www.jcp.org/jcr/mix/1.0\" xmlns:nt=\"http://www.jcp.org/jcr/nt/1.0\" xmlns:fn_old=\"http://www.w3.org/2004/10/xpath-functions\" xmlns:fn=\"http://www.w3.org/2005/xpath-functions\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:sv=\"http://www.jcp.org/jcr/sv/1.0\" xmlns:rep=\"internal\" xmlns:jcr=\"http://www.jcp.org/jcr/1.0\">" + "   <sv:property sv:name=\"jcr:primaryType\" sv:type=\"Name\"><sv:value>rep:User</sv:value></sv:property>"+ "   <sv:property sv:name=\"jcr:uuid\" sv:type=\"String\"><sv:value>e358efa4-89f5-3062-b10d-d7316b65649e</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:password\" sv:type=\"String\"><sv:value>{sha1}8efd86fb78a56a5145ed7739dcb00c78581c5375</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:principalName\" sv:type=\"String\"><sv:value>t</sv:value></sv:property>"+ "</sv:node>";
  try {
    doImport(getTargetPath(),xml);
    doImport(getTargetPath(),xml,ImportUUIDBehavior.IMPORT_UUID_COLLISION_THROW);
    fail("UUID collision must be handled according to the uuid behavior.");
  }
 catch (  ItemExistsException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.user.UserManagerTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCreateEveryoneUser() throws Exception {
  User u=null;
  try {
    u=userMgr.createUser(EveryonePrincipal.NAME,"pw");
    fail("everyone is a reserved group name");
  }
 catch (  IllegalArgumentException e) {
  }
 finally {
    if (u != null) {
      u.remove();
    }
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCreateGroupWithExistingGroupID() throws RepositoryException, NotExecutableException {
  Group g=null;
  try {
    String id=createGroupId();
    g=userMgr.createGroup(id);
    superuser.save();
    Group gr=null;
    try {
      gr=userMgr.createGroup(id);
      fail("ID " + id + " is already in use -> must throw AuthorizableExistsException.");
    }
 catch (    AuthorizableExistsException aee) {
    }
 finally {
      if (gr != null) {
        gr.remove();
        superuser.save();
      }
    }
  }
  finally {
    if (g != null) {
      g.remove();
      superuser.save();
    }
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateGroupWithExistingPrincipal3() throws RepositoryException, NotExecutableException {
  Principal p=getTestPrincipal();
  String uid=createUserId();
  assertFalse(uid.equals(p.getName()));
  User u=null;
  try {
    u=userMgr.createUser(uid,"pw",p,null);
    superuser.save();
    Group gr=null;
    try {
      gr=userMgr.createGroup(createGroupId(),p,null);
      fail("Principal " + p.getName() + " is already in use -> must throw AuthorizableExistsException.");
    }
 catch (    AuthorizableExistsException e) {
    }
 finally {
      if (gr != null) {
        gr.remove();
        superuser.save();
      }
    }
  }
  finally {
    if (u != null) {
      u.remove();
      superuser.save();
    }
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateGroupWithExistingPrincipal2() throws RepositoryException, NotExecutableException {
  Principal p=getTestPrincipal();
  String uid=createUserId();
  assertFalse(uid.equals(p.getName()));
  User u=null;
  try {
    u=userMgr.createUser(uid,"pw",p,null);
    superuser.save();
    Group gr=null;
    try {
      gr=userMgr.createGroup(p);
      fail("Principal " + p.getName() + " is already in use -> must throw AuthorizableExistsException.");
    }
 catch (    AuthorizableExistsException e) {
    }
 finally {
      if (gr != null) {
        gr.remove();
        superuser.save();
      }
    }
  }
  finally {
    if (u != null) {
      u.remove();
      superuser.save();
    }
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCleanup() throws RepositoryException, NotExecutableException {
  Session s=getHelper().getSuperuserSession();
  try {
    UserManager umgr=getUserManager(s);
    s.logout();
    try {
      umgr.getAuthorizable("any userid");
      fail("After having logged out the original session, the user manager must not be live any more.");
    }
 catch (    RepositoryException e) {
    }
  }
  finally {
    if (s.isLive()) {
      s.logout();
    }
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCleanupForAllWorkspaces() throws RepositoryException, NotExecutableException {
  String[] workspaceNames=superuser.getWorkspace().getAccessibleWorkspaceNames();
  for (  String workspaceName1 : workspaceNames) {
    Session s=getHelper().getSuperuserSession(workspaceName1);
    try {
      UserManager umgr=getUserManager(s);
      s.logout();
      try {
        umgr.getAuthorizable("any userid");
        fail("After having logged out the original session, the user manager must not be live any more.");
      }
 catch (      RepositoryException e) {
      }
    }
  finally {
      if (s.isLive()) {
        s.logout();
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-5 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUnknownUserLogin() throws RepositoryException {
  String uid=createUserId();
  assertNull(userMgr.getAuthorizable(uid));
  try {
    Session s=superuser.getRepository().login(new SimpleCredentials(uid,uid.toCharArray()));
    s.logout();
    fail("An unknown user should not be allowed to execute the login.");
  }
 catch (  Exception e) {
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @since oak 1.0 : if collision is added within the same set of transient
 * modifications it will only be detected upon save. in this case RepositoryException
 * is thrown instead of AuthorizableExistsException as the violation is
 * detected by the uniqueness constraint on the corresponding property index.
 */
@Test public void testCreateGroupWithExistingPrincipal4() throws RepositoryException, NotExecutableException {
  Principal p=getTestPrincipal();
  String uid=createUserId();
  assertFalse(uid.equals(p.getName()));
  User u=null;
  Group gr=null;
  try {
    u=userMgr.createUser(uid,"pw",p,null);
    gr=userMgr.createGroup(createGroupId(),p,null);
    superuser.save();
    fail("Principal " + p.getName() + " is already in use -> must throw AuthorizableExistsException.");
  }
 catch (  RepositoryException e) {
  }
 finally {
    if (gr != null) {
      gr.remove();
    }
    if (u != null) {
      u.remove();
    }
    if (superuser.hasPendingChanges()) {
      superuser.save();
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCreateGroupWithInvalidIdOrPrincipal() throws RepositoryException, NotExecutableException {
  Principal p=getTestPrincipal();
  String uid=p.getName();
  Principal emptyNamePrincipal=new PrincipalImpl("");
  Map<String,Principal> fail=new HashMap<String,Principal>();
  fail.put(uid,null);
  fail.put(uid,emptyNamePrincipal);
  fail.put(null,p);
  fail.put("",p);
  for (  String id : fail.keySet()) {
    Group g=null;
    try {
      Principal princ=fail.get(id);
      g=userMgr.createGroup(id,princ,null);
      fail("Creating group with id '" + id + "' and principal '"+ princ.getName()+ "' should fail");
    }
 catch (    IllegalArgumentException e) {
    }
 finally {
      if (g != null) {
        g.remove();
        superuser.save();
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCreateWithRelativePath() throws Exception {
  Principal p=getTestPrincipal();
  String uid=p.getName();
  List<String> invalid=new ArrayList<String>();
  invalid.add("../../path");
  invalid.add(UserConstants.DEFAULT_USER_PATH + "/../test");
  invalid.add("../../../home/users/test");
  for (  String path : invalid) {
    try {
      User user=userMgr.createUser(uid,"pw",p,path);
      superuser.save();
      fail("intermediate path '" + path + "' outside of the user tree.");
    }
 catch (    Exception e) {
    }
 finally {
      superuser.refresh(false);
      Authorizable testUser=userMgr.getAuthorizable(uid);
      if (testUser != null) {
        testUser.remove();
        superuser.save();
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCreateGroupWithExistingUserID() throws RepositoryException, NotExecutableException {
  User u=null;
  try {
    String uid=createUserId();
    u=userMgr.createUser(uid,"pw");
    superuser.save();
    Group gr=null;
    try {
      gr=userMgr.createGroup(uid);
      fail("ID " + uid + " is already in use -> must throw AuthorizableExistsException.");
    }
 catch (    AuthorizableExistsException aee) {
    }
 finally {
      if (gr != null) {
        gr.remove();
        superuser.save();
      }
    }
  }
  finally {
    if (u != null) {
      u.remove();
      superuser.save();
    }
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCreateGroupWithExistingPrincipal() throws RepositoryException, NotExecutableException {
  User u=null;
  try {
    Principal p=getTestPrincipal();
    String uid=p.getName();
    u=userMgr.createUser(uid,"pw",p,null);
    superuser.save();
    Group gr=null;
    try {
      gr=userMgr.createGroup(p);
      fail("Principal " + p.getName() + " is already in use -> must throw AuthorizableExistsException.");
    }
 catch (    AuthorizableExistsException e) {
    }
 finally {
      if (gr != null) {
        gr.remove();
        superuser.save();
      }
    }
  }
  finally {
    if (u != null) {
      u.remove();
      superuser.save();
    }
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCreateGroupWithExistingGroupID2() throws RepositoryException, NotExecutableException {
  Group g=null;
  try {
    String id=createGroupId();
    g=userMgr.createGroup(id);
    superuser.save();
    Group gr=null;
    try {
      gr=userMgr.createGroup(id,getTestPrincipal(),null);
      fail("ID " + id + " is already in use -> must throw AuthorizableExistsException.");
    }
 catch (    AuthorizableExistsException aee) {
    }
 finally {
      if (gr != null) {
        gr.remove();
        superuser.save();
      }
    }
  }
  finally {
    if (g != null) {
      g.remove();
      superuser.save();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.user.UserQueryTest </h4><pre class="type-5 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPropertyLike() throws RepositoryException {
  Iterator<Authorizable> result=userMgr.findAuthorizables(new Query(){
    public <T>void build(    QueryBuilder<T> builder){
      builder.setCondition(builder.like("profile/@food","m%"));
    }
  }
);
  Iterator<User> expected=Iterators.filter(users.iterator(),new Predicate<User>(){
    public boolean apply(    User user){
      try {
        Value[] food=user.getProperty("profile/food");
        if (food == null || food.length != 1) {
          return false;
        }
 else {
          String value=food[0].getString();
          return value.startsWith("m");
        }
      }
 catch (      RepositoryException e) {
        fail(e.getMessage());
      }
      return false;
    }
  }
);
  assertTrue(result.hasNext());
  assertSameElements(result,expected);
}

</code></pre>

<br>
<pre class="type-5 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNameMatch() throws RepositoryException {
  Iterator<Authorizable> result=userMgr.findAuthorizables(new Query(){
    public <T>void build(    QueryBuilder<T> builder){
      builder.setCondition(builder.nameMatches("a%"));
    }
  }
);
  Iterator<Authorizable> expected=Iterators.filter(authorizables.iterator(),new Predicate<Authorizable>(){
    public boolean apply(    Authorizable authorizable){
      try {
        String name=authorizable.getID();
        Principal principal=authorizable.getPrincipal();
        return name.startsWith("a") || principal != null && principal.getName().startsWith("a");
      }
 catch (      RepositoryException e) {
        fail(e.getMessage());
      }
      return false;
    }
  }
);
  assertTrue(result.hasNext());
  assertSameElements(result,expected);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testIndirectScope() throws RepositoryException {
  Group[] groups=new Group[]{mammals,vertebrates,apes};
  for (  final Group g : groups) {
    Iterator<Authorizable> result=userMgr.findAuthorizables(new Query(){
      public <T>void build(      QueryBuilder<T> builder){
        try {
          builder.setScope(g.getID(),false);
        }
 catch (        RepositoryException e) {
          fail(e.getMessage());
        }
      }
    }
);
    Iterator<Authorizable> members=g.getMembers();
    assertSameElements(result,members);
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testFindUsersInGroup() throws RepositoryException {
  Group[] groups=new Group[]{mammals,vertebrates,apes};
  for (  final Group g : groups) {
    Iterator<Authorizable> result=userMgr.findAuthorizables(new Query(){
      public <T>void build(      QueryBuilder<T> builder){
        try {
          builder.setSelector(User.class);
          builder.setScope(g.getID(),false);
        }
 catch (        RepositoryException e) {
          fail(e.getMessage());
        }
      }
    }
);
    Iterator<Authorizable> members=g.getMembers();
    Iterator<Authorizable> users=Iterators.filter(members,new Predicate<Authorizable>(){
      public boolean apply(      Authorizable authorizable){
        return !authorizable.isGroup();
      }
    }
);
    assertSameElements(result,users);
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testFindGroupsInGroup() throws RepositoryException {
  Group[] groups=new Group[]{mammals,vertebrates,apes};
  for (  final Group g : groups) {
    Iterator<Authorizable> result=userMgr.findAuthorizables(new Query(){
      public <T>void build(      QueryBuilder<T> builder){
        try {
          builder.setSelector(Group.class);
          builder.setScope(g.getID(),true);
        }
 catch (        RepositoryException e) {
          fail(e.getMessage());
        }
      }
    }
);
    Iterator<Authorizable> members=g.getDeclaredMembers();
    Iterator<Authorizable> users=Iterators.filter(members,new Predicate<Authorizable>(){
      public boolean apply(      Authorizable authorizable){
        return authorizable.isGroup();
      }
    }
);
    assertSameElements(result,users);
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPropertyExistence() throws RepositoryException {
  Iterator<Authorizable> result=userMgr.findAuthorizables(new Query(){
    public <T>void build(    QueryBuilder<T> builder){
      builder.setCondition(builder.exists("@poisonous"));
    }
  }
);
  Iterator<User> expected=Iterators.filter(users.iterator(),new Predicate<User>(){
    public boolean apply(    User user){
      try {
        Value[] poisonous=user.getProperty("poisonous");
        return poisonous != null && poisonous.length == 1;
      }
 catch (      RepositoryException e) {
        fail(e.getMessage());
      }
      return false;
    }
  }
);
  assertTrue(result.hasNext());
  assertSameElements(result,expected);
}

</code></pre>

<br>
<pre class="type-5 type-7 type-6 type-19 type-4 type-8 type-18 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSetBound() throws RepositoryException {
  List<User> sortedUsers=new ArrayList<User>(users);
  sortedUsers.removeAll(systemDefined);
  Comparator<? super User> comp=new Comparator<User>(){
    public int compare(    User user1,    User user2){
      try {
        Value[] weight1=user1.getProperty("profile/weight");
        assertNotNull(weight1);
        assertEquals(1,weight1.length);
        Value[] weight2=user2.getProperty("profile/weight");
        assertNotNull(weight2);
        assertEquals(1,weight2.length);
        return weight1[0].getDouble() < weight2[0].getDouble() ? -1 : 1;
      }
 catch (      RepositoryException e) {
        fail(e.getMessage());
        return 0;
      }
    }
  }
;
  Collections.sort(sortedUsers,comp);
  long[] counts={4,0,100000};
  for (  final long count : counts) {
    Iterator<Authorizable> result=userMgr.findAuthorizables(new Query(){
      public <T>void build(      QueryBuilder<T> builder){
        builder.setCondition(builder.eq("profile/@cute",vf.createValue(true)));
        builder.setSortOrder("profile/@weight",QueryBuilder.Direction.ASCENDING,false);
        builder.setLimit(vf.createValue(1000.0),count);
      }
    }
);
    Iterator<User> expected=Iterators.filter(sortedUsers.iterator(),new Predicate<User>(){
      public boolean apply(      User user){
        try {
          Value[] cute=user.getProperty("profile/cute");
          Value[] weight=user.getProperty("profile/weight");
          return cute != null && cute.length == 1 && cute[0].getBoolean() && weight != null && weight.length == 1 && weight[0].getDouble() > 1000.0;
        }
 catch (        RepositoryException e) {
          fail(e.getMessage());
        }
        return false;
      }
    }
);
    assertSame(expected,result,count);
    assertFalse(result.hasNext());
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCondition1() throws RepositoryException {
  Iterator<Authorizable> result=userMgr.findAuthorizables(new Query(){
    public <T>void build(    QueryBuilder<T> builder){
      builder.setCondition(builder.and(builder.eq("profile/@cute",vf.createValue(true)),builder.not(builder.eq("@color",vf.createValue("black")))));
    }
  }
);
  Iterator<User> expected=Iterators.filter(users.iterator(),new Predicate<User>(){
    public boolean apply(    User user){
      try {
        Value[] cute=user.getProperty("profile/cute");
        Value[] black=user.getProperty("color");
        return cute != null && cute.length == 1 && cute[0].getBoolean() && !(black != null && black.length == 1 && black[0].getString().equals("black"));
      }
 catch (      RepositoryException e) {
        fail(e.getMessage());
      }
      return false;
    }
  }
);
  assertTrue(result.hasNext());
  assertSameElements(result,expected);
}

</code></pre>

<br>
<pre class="type-5 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFindProperty3() throws RepositoryException {
  Iterator<Authorizable> result=userMgr.findAuthorizables(new Query(){
    public <T>void build(    QueryBuilder<T> builder){
      builder.setCondition(builder.eq("@numberOfLegs",vf.createValue(8)));
    }
  }
);
  Iterator<User> expected=Iterators.filter(users.iterator(),new Predicate<User>(){
    public boolean apply(    User user){
      try {
        Value[] numberOfLegs=user.getProperty("numberOfLegs");
        return numberOfLegs != null && numberOfLegs.length == 1 && numberOfLegs[0].getLong() == 8;
      }
 catch (      RepositoryException e) {
        fail(e.getMessage());
      }
      return false;
    }
  }
);
  assertTrue(result.hasNext());
  assertSameElements(result,expected);
}

</code></pre>

<br>
<pre class="type-5 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFindProperty2() throws RepositoryException {
  Iterator<Authorizable> result=userMgr.findAuthorizables(new Query(){
    public <T>void build(    QueryBuilder<T> builder){
      builder.setCondition(builder.gt("profile/@weight",vf.createValue(2000.0)));
    }
  }
);
  Iterator<User> expected=Iterators.filter(users.iterator(),new Predicate<User>(){
    public boolean apply(    User user){
      try {
        Value[] weight=user.getProperty("profile/weight");
        return weight != null && weight.length == 1 && weight[0].getDouble() > 2000.0;
      }
 catch (      RepositoryException e) {
        fail(e.getMessage());
      }
      return false;
    }
  }
);
  assertTrue(result.hasNext());
  assertSameElements(result,expected);
}

</code></pre>

<br>
<pre class="type-5 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCondition2() throws RepositoryException {
  Iterator<Authorizable> result=userMgr.findAuthorizables(new Query(){
    public <T>void build(    QueryBuilder<T> builder){
      builder.setCondition(builder.or(builder.eq("profile/@food",vf.createValue("mice")),builder.eq("profile/@food",vf.createValue("nectar"))));
    }
  }
);
  Iterator<User> expected=Iterators.filter(users.iterator(),new Predicate<User>(){
    public boolean apply(    User user){
      try {
        Value[] food=user.getProperty("profile/food");
        return food != null && food.length == 1 && (food[0].getString().equals("mice") || food[0].getString().equals("nectar"));
      }
 catch (      RepositoryException e) {
        fail(e.getMessage());
      }
      return false;
    }
  }
);
  assertTrue(result.hasNext());
  assertSameElements(result,expected);
}

</code></pre>

<br>
<pre class="type-5 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFindProperty1() throws RepositoryException {
  Iterator<Authorizable> result=userMgr.findAuthorizables(new Query(){
    public <T>void build(    QueryBuilder<T> builder){
      builder.setCondition(builder.eq("@canFly",vf.createValue(true)));
    }
  }
);
  Iterator<User> expected=Iterators.filter(users.iterator(),new Predicate<User>(){
    public boolean apply(    User user){
      try {
        Value[] canFly=user.getProperty("canFly");
        return canFly != null && canFly.length == 1 && canFly[0].getBoolean();
      }
 catch (      RepositoryException e) {
        fail(e.getMessage());
      }
      return false;
    }
  }
);
  assertTrue(result.hasNext());
  assertSameElements(result,expected);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testDirectScope() throws RepositoryException {
  Group[] groups=new Group[]{mammals,vertebrates,apes};
  for (  final Group g : groups) {
    Iterator<Authorizable> result=userMgr.findAuthorizables(new Query(){
      public <T>void build(      QueryBuilder<T> builder){
        try {
          builder.setScope(g.getID(),true);
        }
 catch (        RepositoryException e) {
          fail(e.getMessage());
        }
      }
    }
);
    Iterator<Authorizable> members=g.getDeclaredMembers();
    assertSameElements(result,members);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.user.UserTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testImpersonateDisabledUser() throws Exception {
  user.disable("readonly user is disabled!");
  superuser.save();
  try {
    Session ss=superuser.impersonate(new SimpleCredentials(user.getID(),new char[0]));
    ss.logout();
    fail("A disabled user cannot be impersonated any more.");
  }
 catch (  LoginException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testChangePasswordWithInvalidOldPassword() throws RepositoryException, NotExecutableException {
  try {
    user.changePassword("changed","wrongOldPw");
    superuser.save();
    fail("old password didn't match -> changePassword(String,String) should fail.");
  }
 catch (  RepositoryException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testLoginDisabledUser() throws Exception {
  user.disable("readonly user is disabled!");
  superuser.save();
  try {
    Session ss=getHelper().getRepository().login(new SimpleCredentials(user.getID(),"pw".toCharArray()));
    ss.logout();
    fail("A disabled user must not be allowed to login any more");
  }
 catch (  LoginException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testLoginWithGetCredentials() throws RepositoryException, NotExecutableException {
  try {
    Credentials creds=user.getCredentials();
    Session s=getHelper().getRepository().login(creds);
    s.logout();
    fail("Login using credentials exposed on user must fail.");
  }
 catch (  UnsupportedRepositoryOperationException e) {
    throw new NotExecutableException(e.getMessage());
  }
catch (  LoginException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testLoginWithOldPassword2() throws RepositoryException, NotExecutableException {
  try {
    user.changePassword("changed",testPw);
    superuser.save();
    Session s=getHelper().getRepository().login(new SimpleCredentials(user.getID(),testPw.toCharArray()));
    s.logout();
    fail("superuser pw has changed. login must fail.");
  }
 catch (  LoginException e) {
  }
 finally {
    user.changePassword(testPw);
    superuser.save();
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testLoginWithOldPassword() throws RepositoryException, NotExecutableException {
  try {
    user.changePassword("changed");
    superuser.save();
    Session s=getHelper().getRepository().login(new SimpleCredentials(user.getID(),testPw.toCharArray()));
    s.logout();
    fail("user pw has changed. login must fail.");
  }
 catch (  LoginException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testChangePasswordNull() throws RepositoryException, NotExecutableException {
  try {
    user.changePassword(null);
    superuser.save();
    fail("invalid pw null");
  }
 catch (  Exception e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.management.ManagementOperationTest </h4><pre class="type-9 type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void running() throws InterruptedException {
  final LinkedBlockingDeque<Thread> thread=new LinkedBlockingDeque<Thread>(1);
  ManagementOperation<Void> op=newManagementOperation("test",new Callable<Void>(){
    @Override public Void call() throws Exception {
      thread.add(currentThread());
      sleep(100000);
      return null;
    }
  }
);
  executor.execute(op);
  Status status=op.getStatus();
  assertEquals(op.getId(),status.getId());
  assertEquals(RUNNING,status.getCode());
  thread.poll(5,SECONDS).interrupt();
  try {
    op.get();
    fail("Expected InterruptedException");
  }
 catch (  ExecutionException e) {
    assertTrue(e.getCause() instanceof InterruptedException);
  }
  assertTrue(op.isDone());
  status=op.getStatus();
  assertEquals(op.getId(),status.getId());
  assertEquals(FAILED,status.getCode());
  assertTrue(status.getMessage().contains("test failed: "));
}

</code></pre>

<br>
<pre class="type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void failed() throws InterruptedException, TimeoutException {
  final Exception failure=new Exception("fail");
  ManagementOperation<Void> op=newManagementOperation("test",new Callable<Void>(){
    @Override public Void call() throws Exception {
      throw failure;
    }
  }
);
  executor.execute(op);
  try {
    assertEquals(null,op.get(5,SECONDS));
    fail("Expected " + failure);
  }
 catch (  ExecutionException e) {
    assertEquals(failure,e.getCause());
  }
  assertTrue(op.isDone());
  Status status=op.getStatus();
  assertEquals(op.getId(),status.getId());
  assertEquals(FAILED,status.getCode());
  assertEquals("test failed: " + failure.getMessage(),status.getMessage());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.namepath.GlobalNameMapperTest </h4><pre class="type-5 type-6 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExpandedNames() throws RepositoryException {
  Map<String,String> jcrToOak=new HashMap<String,String>();
  jcrToOak.put("{}foo","foo");
  jcrToOak.put("{foo","{foo");
  jcrToOak.put("{foo}","{foo}");
  jcrToOak.put("{0} foo","{0} foo");
  jcrToOak.put("{","{");
  jcrToOak.put("{http://www.jcp.org/jcr/nt/1.0}base","nt:base");
  jcrToOak.put("{http://www.example.com/foo}bar","foo:bar");
  jcrToOak.put("{http://www.example.com/quu}bar","quu:bar");
  for (  String jcrName : jcrToOak.keySet()) {
    assertEquals(jcrToOak.get(jcrName),mapper.getOakNameOrNull(jcrName));
    assertEquals(jcrToOak.get(jcrName),mapper.getOakName(jcrName));
  }
  assertNull(mapper.getOakNameOrNull("{http://www.example.com/bar}bar"));
  try {
    mapper.getOakName("{http://www.example.com/bar}bar");
    fail("RepositoryException expected");
  }
 catch (  RepositoryException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.namepath.NamePathMapperImplTest </h4><pre class="type-5 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOakToJcr(){
  assertEquals("/foo:bar",npMapper.getJcrPath("/oak-foo:bar"));
  assertEquals("/foo:bar/quu:qux",npMapper.getJcrPath("/oak-foo:bar/oak-quu:qux"));
  assertEquals("foo:bar",npMapper.getJcrPath("oak-foo:bar"));
  assertEquals(".",npMapper.getJcrPath(""));
  try {
    npMapper.getJcrPath("{http://www.jcp.org/jcr/nt/1.0}unstructured");
    fail("expanded name should not be accepted");
  }
 catch (  IllegalArgumentException expected) {
  }
  try {
    npMapper.getJcrPath("foobar/{http://www.jcp.org/jcr/1.0}content");
    fail("expanded name should not be accepted");
  }
 catch (  IllegalArgumentException expected) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.BasicDocumentStoreTest </h4><pre class="type-13 type-12 type-5 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreatePartialFailure(){
  String bid=this.getClass().getName() + ".testCreatePartialFailure-";
  int cnt=10;
  assertTrue(cnt > 8);
  for (int i=0; i < cnt; i++) {
    super.ds.remove(Collection.NODES,bid + i);
    removeMe.add(bid + i);
  }
  int pre=cnt / 2;
  UpdateOp up=new UpdateOp(bid + pre,true);
  up.set("_id",bid + pre);
  up.set("foo","bar");
  assertTrue(super.ds.create(Collection.NODES,Collections.singletonList(up)));
  Set<String> toCreate=new HashSet<String>();
  Set<String> toCreateFailEarly=new HashSet<String>();
  List<UpdateOp> ups=new ArrayList<UpdateOp>();
  for (int i=0; i < cnt; i++) {
    UpdateOp op=new UpdateOp(bid + i,true);
    op.set("_id",bid + i);
    op.set("foo","qux");
    ups.add(op);
    if (i != pre) {
      toCreate.add(bid + i);
    }
    if (i < pre) {
      toCreateFailEarly.add(bid + i);
    }
  }
  assertFalse(super.ds.create(Collection.NODES,ups));
  Set<String> created=new HashSet<String>();
  for (int i=0; i < cnt; i++) {
    boolean present=null != super.ds.find(Collection.NODES,bid + i,0);
    if (i == pre && !present) {
      fail(super.dsname + ": batch update removed previously existing node " + (bid + i));
    }
 else     if (present && i != pre) {
      created.add(bid + i);
    }
  }
  toCreate.removeAll(created);
  if (created.isEmpty()) {
    LOG.info(super.dsname + ": create() apparently is atomic");
  }
 else   if (created.size() == toCreate.size()) {
    LOG.info(super.dsname + ": create() apparently is best-effort");
  }
 else   if (created.equals(toCreateFailEarly)) {
    LOG.info(super.dsname + ": create() stops at first failure");
  }
 else {
    LOG.info(super.dsname + ": create() created: " + created+ ", missing: "+ toCreate);
  }
}

</code></pre>

<br>
<pre class="type-9 type-12 type-5 type-6 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void removeWithCondition() throws Exception {
  Set<String> existingDocs=new HashSet<String>();
  for (  NodeDocument doc : Utils.getAllDocuments(ds)) {
    existingDocs.add(doc.getPath());
  }
  List<UpdateOp> docs=Lists.newArrayList();
  docs.add(newDocument("/foo",100));
  removeMe.add(Utils.getIdFromPath("/foo"));
  docs.add(newDocument("/bar",200));
  removeMe.add(Utils.getIdFromPath("/bar"));
  docs.add(newDocument("/baz",300));
  removeMe.add(Utils.getIdFromPath("/baz"));
  ds.create(Collection.NODES,docs);
  for (  UpdateOp op : docs) {
    assertNotNull(ds.find(Collection.NODES,op.getId()));
  }
  Map<String,Map<Key,Condition>> toRemove=Maps.newHashMap();
  removeDocument(toRemove,"/foo",100);
  removeDocument(toRemove,"/bar",300);
  removeDocument(toRemove,"/qux",100);
  removeDocument(toRemove,"/baz",300);
  int removed=ds.remove(Collection.NODES,toRemove);
  assertEquals(2,removed);
  assertNotNull(ds.find(Collection.NODES,Utils.getIdFromPath("/bar")));
  for (  NodeDocument doc : Utils.getAllDocuments(ds)) {
    if (!doc.getPath().equals("/bar") && !existingDocs.contains(doc.getPath())) {
      fail("document must not exist: " + doc.getId());
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-12 type-5 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInterestingPropLengths() throws UnsupportedEncodingException {
  int lengths[]={1,10,100,1000,2000,3000,4000,5000,6000,7000,8000,9000,10000,11000,12000,13000,14000,15000,16000,20000};
  for (  int test : lengths) {
    String id=this.getClass().getName() + ".testInterestingPropLengths-" + test;
    String pval=generateString(test,true);
    UpdateOp up=new UpdateOp(id,true);
    up.set("_id",id);
    up.set("foo",pval);
    super.ds.remove(Collection.NODES,id);
    boolean success=super.ds.create(Collection.NODES,Collections.singletonList(up));
    assertTrue("failed to insert a document with property of length " + test + "(ASCII) in "+ super.dsname,success);
    super.ds.remove(Collection.NODES,id);
  }
  for (  int test : lengths) {
    String id=this.getClass().getName() + ".testInterestingPropLengths-" + test;
    String pval=generateString(test,false);
    UpdateOp up=new UpdateOp(id,true);
    up.set("_id",id);
    up.set("foo",pval);
    super.ds.remove(Collection.NODES,id);
    boolean success=super.ds.create(Collection.NODES,Collections.singletonList(up));
    assertTrue("failed to insert a document with property of length " + test + " (potentially non-ASCII, actual octet length with UTF-8 encoding: "+ pval.getBytes("UTF-8").length+ ") in "+ super.dsname,success);
    if (success) {
      try {
        super.ds.findAndUpdate(Collection.NODES,up);
      }
 catch (      Exception ex) {
        ex.printStackTrace(System.err);
        fail("failed to update a document with property of length " + test + " (potentially non-ASCII, actual octet length with UTF-8 encoding: "+ pval.getBytes("UTF-8").length+ ") in "+ super.dsname);
      }
    }
    super.ds.remove(Collection.NODES,id);
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConditionalUpdateForbidden(){
  String id=this.getClass().getName() + ".testConditionalupdateForbidden";
  NodeDocument nd=super.ds.find(Collection.NODES,id);
  if (nd != null) {
    super.ds.remove(Collection.NODES,id);
  }
  try {
    UpdateOp up=new UpdateOp(id,true);
    up.set("_id",id);
    up.equals("foo","bar");
    super.ds.create(Collection.NODES,Collections.singletonList(up));
    fail("conditional create should fail");
  }
 catch (  IllegalStateException expected) {
  }
  UpdateOp cup=new UpdateOp(id,true);
  cup.set("_id",id);
  assertTrue(super.ds.create(Collection.NODES,Collections.singletonList(cup)));
  removeMe.add(id);
  try {
    UpdateOp up=new UpdateOp(id,false);
    up.set("_id",id);
    up.equals("foo","bar");
    super.ds.createOrUpdate(Collection.NODES,up);
    fail("conditional createOrUpdate should fail");
  }
 catch (  IllegalArgumentException expected) {
  }
  try {
    UpdateOp up=new UpdateOp(id,false);
    up.set("_id",id);
    up.equals("foo","bar");
    super.ds.createOrUpdate(Collection.NODES,Collections.singletonList(up));
    fail("conditional createOrUpdate should fail");
  }
 catch (  IllegalArgumentException expected) {
  }
  try {
    UpdateOp up=new UpdateOp(id,false);
    up.set("_id",id);
    up.equals("foo","bar");
    super.ds.update(Collection.NODES,Collections.singletonList(id),up);
    fail("conditional update should fail");
  }
 catch (  IllegalArgumentException expected) {
  }
}

</code></pre>

<br>
<pre class="type-9 type-12 type-5 type-7 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testQueryCollation(){
  String base="2:/" + this.getClass().getName() + ".testQueryCollation";
  List<UpdateOp> creates=new ArrayList<UpdateOp>();
  List<String> expected=new ArrayList<String>();
  for (  char c : "!\"#$%&'()*+,-./0123456789:;<=>?@AZ[\\]^_`az{|}~".toCharArray()) {
    String id=base + c;
    UpdateOp up=new UpdateOp(id,true);
    up.set("_id",id);
    creates.add(up);
    removeMe.add(id);
    id=base + "/" + c;
    up=new UpdateOp(id,true);
    up.set("_id",id);
    creates.add(up);
    expected.add(id);
    removeMe.add(id);
  }
  boolean success=super.ds.create(Collection.NODES,creates);
  assertTrue("documents not created",success);
  List<String> result=getKeys(ds.query(Collection.NODES,base + "/",base + "0",1000));
  List<String> diff=new ArrayList<String>();
  diff.addAll(result);
  diff.removeAll(expected);
  if (!diff.isEmpty()) {
    fail("unexpected query results (broken collation handling in persistence?): " + diff);
  }
  diff=new ArrayList<String>();
  diff.addAll(expected);
  diff.removeAll(result);
  if (!diff.isEmpty()) {
    fail("missing query results (broken collation handling in persistence?): " + diff);
  }
  assertEquals("incorrect result ordering in query result (broken collation handling in persistence?)",expected,result);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.BranchTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void getModifiedPathsUntil(){
  UnmergedBranches branches=new UnmergedBranches();
  RevisionVector base=new RevisionVector(Revision.newRevision(1));
  Revision c1=Revision.newRevision(1).asBranchRevision();
  Branch b=branches.create(base,c1,null);
  BranchCommit bc1=b.getCommit(c1);
  bc1.track("/foo");
  Revision c2=Revision.newRevision(1).asBranchRevision();
  b.addCommit(c2);
  BranchCommit bc2=b.getCommit(c2);
  bc2.track("/bar");
  Revision c3=Revision.newRevision(1).asBranchRevision();
  b.rebase(c3,new RevisionVector(Revision.newRevision(1)));
  Revision c4=Revision.newRevision(1).asBranchRevision();
  b.addCommit(c4);
  BranchCommit bc4=b.getCommit(c4);
  bc4.track("/baz");
  Revision c5=Revision.newRevision(1).asBranchRevision();
  try {
    b.getModifiedPathsUntil(Revision.newRevision(1));
    fail("Must fail with IllegalArgumentException");
  }
 catch (  IllegalArgumentException e) {
  }
  assertModifiedPaths(b.getModifiedPathsUntil(c1),"/foo");
  assertModifiedPaths(b.getModifiedPathsUntil(c2),"/foo","/bar");
  assertModifiedPaths(b.getModifiedPathsUntil(c3),"/foo","/bar");
  assertModifiedPaths(b.getModifiedPathsUntil(c4),"/foo","/bar","/baz");
  assertModifiedPaths(b.getModifiedPathsUntil(c5));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.BulkCreateOrUpdateClusterTest </h4><pre class="type-13 type-9 type-12 type-5 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Run multiple batch updates concurrently. Each thread modifies only its own documents.
 */
@Test public void testConcurrentNoConflict() throws InterruptedException {
  int amountPerThread=100;
  int threadCount=10;
  int amount=amountPerThread * threadCount;
  List<UpdateOp> updates=new ArrayList<UpdateOp>(amount);
  for (int i=0; i < amount; i+=2) {
    String id=this.getClass().getName() + ".testConcurrentNoConflict" + i;
    UpdateOp up=new UpdateOp(id,true);
    up.set("_id",id);
    up.set("prop",100);
    updates.add(up);
  }
  ds1.create(Collection.NODES,updates);
  final Set<Exception> exceptions=new HashSet<Exception>();
  List<Thread> threads=new ArrayList<Thread>();
  final Map<String,NodeDocument> oldDocs=new ConcurrentHashMap<String,NodeDocument>();
  for (int i=0; i < threadCount; i++) {
    final DocumentStore selectedDs=i % 2 == 0 ? this.ds1 : this.ds2;
    final List<UpdateOp> threadUpdates=new ArrayList<UpdateOp>(amountPerThread);
    for (int j=0; j < amountPerThread; j++) {
      String id=this.getClass().getName() + ".testConcurrentNoConflict" + (j + i * amountPerThread);
      UpdateOp up=new UpdateOp(id,true);
      up.set("_id",id);
      up.set("prop",200 + i + j);
      threadUpdates.add(up);
      removeMe.add(id);
    }
    shuffle(threadUpdates);
    threads.add(new Thread(){
      public void run(){
        try {
          for (          NodeDocument d : selectedDs.createOrUpdate(Collection.NODES,threadUpdates)) {
            if (d == null) {
              continue;
            }
            oldDocs.put(d.getId(),d);
          }
        }
 catch (        Exception ex) {
          exceptions.add(ex);
        }
      }
    }
);
  }
  for (  Thread t : threads) {
    t.start();
  }
  for (  Thread t : threads) {
    t.join();
    if (t.isAlive()) {
      fail("Thread hasn't finished in 10s");
    }
  }
  if (!exceptions.isEmpty()) {
    String msg=exceptions.size() + " out of " + threadCount+ " failed with exceptions, the first being: "+ exceptions.iterator().next();
    fail(msg);
  }
  for (int i=0; i < amount; i++) {
    String id=this.getClass().getName() + ".testConcurrentNoConflict" + i;
    NodeDocument oldDoc=oldDocs.get(id);
    NodeDocument newDoc;
    if (i % 2 == 1) {
      assertNull("The returned value should be null for created doc",oldDoc);
      newDoc=ds1.find(Collection.NODES,id);
    }
 else {
      assertNotNull("The returned doc shouldn't be null for updated doc",oldDoc);
      assertEquals("The old value is not correct",100l,oldDoc.get("prop"));
      newDoc=ds2.find(Collection.NODES,id);
    }
    assertNotEquals("The document hasn't been updated",100l,newDoc.get("prop"));
  }
}

</code></pre>

<br>
<pre class="type-13 type-9 type-12 type-5 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Run multiple batch updates concurrently. Each thread modifies the same set of documents.
 */
@Test public void testConcurrentWithConflict() throws InterruptedException {
  int threadCount=10;
  int amount=500;
  List<UpdateOp> updates=new ArrayList<UpdateOp>(amount);
  for (int i=0; i < amount; i+=2) {
    String id=this.getClass().getName() + ".testConcurrentNoConflict" + i;
    UpdateOp up=new UpdateOp(id,true);
    up.set("_id",id);
    up.set("prop",100);
    updates.add(up);
    removeMe.add(id);
  }
  ds1.create(Collection.NODES,updates);
  final Set<Exception> exceptions=new HashSet<Exception>();
  List<Thread> threads=new ArrayList<Thread>();
  for (int i=0; i < threadCount; i++) {
    final DocumentStore selectedDs=i % 2 == 0 ? this.ds1 : this.ds2;
    final List<UpdateOp> threadUpdates=new ArrayList<UpdateOp>(amount);
    for (int j=0; j < amount; j++) {
      String id=this.getClass().getName() + ".testConcurrentWithConflict" + j;
      UpdateOp up=new UpdateOp(id,true);
      up.set("_id",id);
      up.set("prop",200 + i * amount + j);
      threadUpdates.add(up);
      removeMe.add(id);
    }
    shuffle(threadUpdates);
    threads.add(new Thread(){
      public void run(){
        try {
          selectedDs.createOrUpdate(Collection.NODES,threadUpdates);
        }
 catch (        Exception ex) {
          exceptions.add(ex);
        }
      }
    }
);
  }
  for (  Thread t : threads) {
    t.start();
  }
  for (  Thread t : threads) {
    t.join(10000);
    if (t.isAlive()) {
      fail("Thread hasn't finished in 10s");
    }
  }
  if (!exceptions.isEmpty()) {
    String msg=exceptions.size() + " out of " + threadCount+ " failed with exceptions, the first being: "+ exceptions.iterator().next();
    fail(msg);
  }
  for (int i=0; i < amount; i++) {
    String id=this.getClass().getName() + ".testConcurrentWithConflict" + i;
    NodeDocument newDoc=ds1.find(Collection.NODES,id);
    assertNotNull("The document hasn't been inserted",newDoc);
    assertNotEquals("The document hasn't been updated",100l,newDoc.get("prop"));
    newDoc=ds2.find(Collection.NODES,id);
    assertNotNull("The document hasn't been inserted",newDoc);
    assertNotEquals("The document hasn't been updated",100l,newDoc.get("prop"));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.BulkCreateOrUpdateTest </h4><pre class="type-13 type-9 type-12 type-5 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Run multiple batch updates concurrently. Each thread modifies only its own documents.
 */
@Test public void testConcurrentNoConflict() throws InterruptedException {
  int amountPerThread=100;
  int threadCount=10;
  int amount=amountPerThread * threadCount;
  List<UpdateOp> updates=new ArrayList<UpdateOp>(amount);
  for (int i=0; i < amount; i+=2) {
    String id=this.getClass().getName() + ".testConcurrentNoConflict" + i;
    UpdateOp up=new UpdateOp(id,true);
    up.set("_id",id);
    up.set("prop",100);
    updates.add(up);
  }
  ds.create(Collection.NODES,updates);
  List<Thread> threads=new ArrayList<Thread>();
  final Map<String,NodeDocument> oldDocs=new ConcurrentHashMap<String,NodeDocument>();
  for (int i=0; i < threadCount; i++) {
    final List<UpdateOp> threadUpdates=new ArrayList<UpdateOp>(amountPerThread);
    for (int j=0; j < amountPerThread; j++) {
      String id=this.getClass().getName() + ".testConcurrentNoConflict" + (j + i * amountPerThread);
      UpdateOp up=new UpdateOp(id,true);
      up.set("_id",id);
      up.set("prop",200 + i + j);
      threadUpdates.add(up);
      removeMe.add(id);
    }
    shuffle(threadUpdates);
    threads.add(new Thread(){
      public void run(){
        for (        NodeDocument d : ds.createOrUpdate(Collection.NODES,threadUpdates)) {
          if (d == null) {
            continue;
          }
          oldDocs.put(d.getId(),d);
        }
      }
    }
);
  }
  for (  Thread t : threads) {
    t.start();
  }
  for (  Thread t : threads) {
    t.join();
    if (t.isAlive()) {
      fail("Thread hasn't finished in 10s");
    }
  }
  for (int i=0; i < amount; i++) {
    String id=this.getClass().getName() + ".testConcurrentNoConflict" + i;
    NodeDocument oldDoc=oldDocs.get(id);
    NodeDocument newDoc=ds.find(Collection.NODES,id);
    if (i % 2 == 1) {
      assertNull("The returned value should be null for created doc",oldDoc);
    }
 else {
      assertNotNull("The returned doc shouldn't be null for updated doc",oldDoc);
      assertEquals("The old value is not correct",100l,oldDoc.get("prop"));
    }
    assertNotEquals("The document hasn't been updated",100l,newDoc.get("prop"));
  }
}

</code></pre>

<br>
<pre class="type-13 type-9 type-12 type-5 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Run multiple batch updates concurrently. Each thread modifies the same set of documents.
 */
@Test public void testConcurrentWithConflict() throws InterruptedException {
  int threadCount=10;
  int amount=500;
  List<UpdateOp> updates=new ArrayList<UpdateOp>(amount);
  for (int i=0; i < amount; i+=2) {
    String id=this.getClass().getName() + ".testConcurrentNoConflict" + i;
    UpdateOp up=new UpdateOp(id,true);
    up.set("_id",id);
    up.set("prop",100);
    updates.add(up);
    removeMe.add(id);
  }
  ds.create(Collection.NODES,updates);
  final Set<Exception> exceptions=new HashSet<Exception>();
  List<Thread> threads=new ArrayList<Thread>();
  for (int i=0; i < threadCount; i++) {
    final List<UpdateOp> threadUpdates=new ArrayList<UpdateOp>(amount);
    for (int j=0; j < amount; j++) {
      String id=this.getClass().getName() + ".testConcurrentWithConflict" + j;
      UpdateOp up=new UpdateOp(id,true);
      up.set("_id",id);
      up.set("prop",200 + i * amount + j);
      threadUpdates.add(up);
      removeMe.add(id);
    }
    shuffle(threadUpdates);
    threads.add(new Thread(){
      public void run(){
        try {
          ds.createOrUpdate(Collection.NODES,threadUpdates);
        }
 catch (        Exception ex) {
          exceptions.add(ex);
        }
      }
    }
);
  }
  for (  Thread t : threads) {
    t.start();
  }
  for (  Thread t : threads) {
    t.join(10000);
    if (t.isAlive()) {
      fail("Thread hasn't finished in 10s");
    }
  }
  if (!exceptions.isEmpty()) {
    String msg=exceptions.size() + " out of " + threadCount+ " failed with exceptions, the first being: "+ exceptions.iterator().next();
    fail(msg);
  }
  for (int i=0; i < amount; i++) {
    String id=this.getClass().getName() + ".testConcurrentWithConflict" + i;
    NodeDocument newDoc=ds.find(Collection.NODES,id);
    assertNotNull("The document hasn't been inserted",newDoc);
    assertNotEquals("The document hasn't been updated",100l,newDoc.get("prop"));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.ClusterTest </h4><pre class="type-5 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void conflict(){
  DocumentMK mk1=createMK(1,0);
  DocumentMK mk2=createMK(2,0);
  String m1r0=mk1.getHeadRevision();
  String m2r0=mk2.getHeadRevision();
  mk1.commit("/","+\"test\":{}",m1r0,null);
  try {
    mk2.commit("/","+\"test\":{}",m2r0,null);
    fail();
  }
 catch (  DocumentStoreException e) {
  }
  mk1.runBackgroundOperations();
  mk2.runBackgroundOperations();
  String n1=mk1.getNodes("/",mk1.getHeadRevision(),0,0,10,null);
  String n2=mk2.getNodes("/",mk2.getHeadRevision(),0,0,10,null);
  assertEquals(n1,n2);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void rollbackAfterConflict(){
  DocumentMK mk1=createMK(1);
  DocumentMK mk2=createMK(2);
  String m1r0=mk1.getHeadRevision();
  String m2r0=mk2.getHeadRevision();
  mk1.commit("/","+\"test\":{}",m1r0,null);
  try {
    mk2.commit("/","+\"a\": {} +\"test\":{}",m2r0,null);
    fail();
  }
 catch (  DocumentStoreException e) {
  }
  mk2.commit("/","+\"a\": {}",null,null);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.ClusterViewDocumentTest </h4><pre class="type-9 type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadUpdate() throws Exception {
  final int localClusterId=11;
  final DocumentNodeStore ns=createMK(localClusterId).nodeStore;
  try {
    ClusterViewDocument.readOrUpdate(ns,null,null,null);
    fail("should complain");
  }
 catch (  Exception ok) {
  }
  try {
    ClusterViewDocument.readOrUpdate(ns,new HashSet<Integer>(),null,null);
    fail("should complain");
  }
 catch (  Exception ok) {
  }
  Set<Integer> activeIds=new HashSet<Integer>();
  activeIds.add(2);
  Set<Integer> recoveringIds=null;
  Set<Integer> inactiveIds=null;
  ClusterViewDocument doc=ClusterViewDocument.readOrUpdate(ns,activeIds,recoveringIds,inactiveIds);
  final String id=doc.getClusterViewId();
  assertTrue(id != null && id.length() > 0);
  String createdAt=doc.getCreatedAt();
  assertTrue(createdAt != null && createdAt.length() > 0);
  long createdBy=doc.getCreatedBy();
  assertEquals(localClusterId,createdBy);
  assertEquals(1,doc.getViewSeqNum());
  assertEquals(1,doc.getActiveIds().size());
  assertTrue(doc.getActiveIds().contains(2));
  assertEquals(0,doc.getRecoveringIds().size());
  assertEquals(0,doc.getInactiveIds().size());
  doc=ClusterViewDocument.readOrUpdate(ns,activeIds,recoveringIds,inactiveIds);
  assertEquals(1,doc.getViewSeqNum());
  activeIds.add(3);
  doc=ClusterViewDocument.readOrUpdate(ns,activeIds,recoveringIds,inactiveIds);
  assertEquals(id,doc.getClusterViewId());
  createdAt=doc.getCreatedAt();
  assertTrue(createdAt != null && createdAt.length() > 0);
  createdBy=doc.getCreatedBy();
  assertEquals(localClusterId,createdBy);
  assertEquals(2,doc.getViewSeqNum());
  assertEquals(2,doc.getActiveIds().size());
  assertTrue(doc.getActiveIds().contains(2));
  assertTrue(doc.getActiveIds().contains(3));
  assertEquals(0,doc.getRecoveringIds().size());
  assertEquals(0,doc.getInactiveIds().size());
  doc=ClusterViewDocument.readOrUpdate(ns,activeIds,recoveringIds,inactiveIds);
  assertEquals(2,doc.getViewSeqNum());
  recoveringIds=new HashSet<Integer>();
  recoveringIds.add(4);
  doc=ClusterViewDocument.readOrUpdate(ns,activeIds,recoveringIds,inactiveIds);
  assertEquals(id,doc.getClusterViewId());
  createdAt=doc.getCreatedAt();
  assertTrue(createdAt != null && createdAt.length() > 0);
  createdBy=doc.getCreatedBy();
  assertEquals(localClusterId,createdBy);
  assertEquals(3,doc.getViewSeqNum());
  assertEquals(2,doc.getActiveIds().size());
  assertTrue(doc.getActiveIds().contains(2));
  assertTrue(doc.getActiveIds().contains(3));
  assertEquals(1,doc.getRecoveringIds().size());
  assertTrue(doc.getRecoveringIds().contains(4));
  assertEquals(0,doc.getInactiveIds().size());
  doc=ClusterViewDocument.readOrUpdate(ns,activeIds,recoveringIds,inactiveIds);
  assertEquals(3,doc.getViewSeqNum());
  recoveringIds=new HashSet<Integer>();
  inactiveIds=new HashSet<Integer>();
  inactiveIds.add(4);
  doc=ClusterViewDocument.readOrUpdate(ns,activeIds,recoveringIds,inactiveIds);
  assertEquals(id,doc.getClusterViewId());
  createdAt=doc.getCreatedAt();
  assertTrue(createdAt != null && createdAt.length() > 0);
  createdBy=doc.getCreatedBy();
  assertEquals(localClusterId,createdBy);
  assertEquals(4,doc.getViewSeqNum());
  assertEquals(2,doc.getActiveIds().size());
  assertTrue(doc.getActiveIds().contains(2));
  assertTrue(doc.getActiveIds().contains(3));
  assertEquals(0,doc.getRecoveringIds().size());
  assertEquals(1,doc.getInactiveIds().size());
  assertTrue(doc.getInactiveIds().contains(4));
  doc=ClusterViewDocument.readOrUpdate(ns,activeIds,recoveringIds,inactiveIds);
  assertEquals(4,doc.getViewSeqNum());
  doc=ClusterViewDocument.readOrUpdate(ns,activeIds,recoveringIds,inactiveIds);
  assertEquals(4,doc.getViewSeqNum());
  doc=ClusterViewDocument.readOrUpdate(ns,activeIds,recoveringIds,inactiveIds);
  assertEquals(4,doc.getViewSeqNum());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.ClusterViewTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testConstructor() throws Exception {
  final Integer viewId=3;
  final String clusterViewId=UUID.randomUUID().toString();
  final Integer instanceId=2;
  final Set<Integer> emptyInstanceIds=new HashSet<Integer>();
  final Set<Integer> instanceIds=new HashSet<Integer>();
  instanceIds.add(1);
  final Set<Integer> deactivating=new HashSet<Integer>();
  final Set<Integer> inactive=new HashSet<Integer>();
  try {
    new ClusterView(-1,true,clusterViewId,instanceId,instanceIds,deactivating,inactive);
    fail("should complain");
  }
 catch (  IllegalStateException e) {
  }
  try {
    new ClusterView(viewId,true,null,instanceId,instanceIds,deactivating,inactive);
    fail("should complain");
  }
 catch (  IllegalStateException e) {
  }
  try {
    new ClusterView(viewId,true,clusterViewId,-1,instanceIds,deactivating,inactive);
    fail("should complain");
  }
 catch (  IllegalStateException e) {
  }
  try {
    new ClusterView(viewId,true,clusterViewId,instanceId,emptyInstanceIds,deactivating,inactive);
    fail("should complain");
  }
 catch (  IllegalStateException e) {
  }
  try {
    new ClusterView(viewId,true,clusterViewId,instanceId,null,deactivating,inactive);
    fail("should complain");
  }
 catch (  IllegalStateException e) {
  }
  try {
    new ClusterView(viewId,true,clusterViewId,instanceId,instanceIds,null,inactive);
    fail("should complain");
  }
 catch (  Exception e) {
  }
  try {
    new ClusterView(viewId,true,clusterViewId,instanceId,instanceIds,deactivating,null);
    fail("should complain");
  }
 catch (  Exception e) {
  }
  final Set<Integer> nonEmptyDeactivating=new HashSet<Integer>();
  nonEmptyDeactivating.add(3);
  new ClusterView(viewId,false,clusterViewId,instanceId,instanceIds,nonEmptyDeactivating,inactive);
  new ClusterView(viewId,true,clusterViewId,instanceId,instanceIds,nonEmptyDeactivating,inactive);
  new ClusterView(viewId,true,clusterViewId,instanceId,instanceIds,deactivating,inactive);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testBacklogButNotInactive() throws Exception {
  String clusterViewId=UUID.randomUUID().toString();
  ClusterViewBuilder builder=new ClusterViewBuilder(10,clusterViewId,2);
  try {
    ClusterView view=builder.active(2,3).backlogs(5).asView();
    fail("should complain");
  }
 catch (  Exception ok) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.ConcurrentDocumentStoreTest </h4><pre class="type-9 type-5 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConcurrentCreateOrUpdate() throws Exception {
  int workers=8;
  String id=this.getClass().getName() + ".testConcurrentCreateOrUpdate";
  super.removeMe.add(id);
  List<Exception> exceptions=Collections.synchronizedList(new ArrayList<Exception>());
  List<Thread> worker=new ArrayList<Thread>();
  for (int i=0; i < workers; i++) {
    worker.add(new Thread(new Worker(id,true,exceptions)));
  }
  for (  Thread t : worker) {
    t.start();
  }
  for (  Thread t : worker) {
    t.join();
  }
  for (  Exception e : exceptions) {
    fail(e.toString());
  }
  Document d=ds.find(Collection.NODES,id);
  String val=d.get("counter").toString();
  org.junit.Assert.assertEquals("counter property not updated as expected",Integer.toString(workers),val);
}

</code></pre>

<br>
<pre class="type-9 type-5 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConcurrentUpdate() throws Exception {
  int workers=20;
  String id=this.getClass().getName() + ".testConcurrentUpdate";
  UpdateOp up=new UpdateOp(id,true);
  up.set("_id",id);
  up.set("thread",Thread.currentThread().getName());
  up.set("counter",0L);
  ds.create(Collection.NODES,Collections.singletonList(up));
  super.removeMe.add(id);
  List<Exception> exceptions=Collections.synchronizedList(new ArrayList<Exception>());
  List<Thread> worker=new ArrayList<Thread>();
  for (int i=0; i < workers; i++) {
    worker.add(new Thread(new Worker(id,false,exceptions)));
  }
  for (  Thread t : worker) {
    t.start();
  }
  for (  Thread t : worker) {
    t.join();
  }
  for (  Exception e : exceptions) {
    fail(e.toString());
  }
  Document d=ds.find(Collection.NODES,id);
  String val=d.get("counter").toString();
  org.junit.Assert.assertEquals("counter property not updated as expected",Integer.toString(workers),val);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.ConflictTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void changeRemovedPropertyBranchWins(){
  String rev=mk.commit("/","+\"foo\":{\"prop\":\"value\"}",null,null);
  String branchRev=mk.branch(rev);
  branchRev=mk.commit("/foo","^\"prop\":null",branchRev,null);
  mk.merge(branchRev,null);
  try {
    mk.commit("/foo","^\"prop\":\"bar\"",rev,null);
    fail("Must fail with conflict for changeRemovedProperty");
  }
 catch (  DocumentStoreException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void changeChangedPropertyTwoBranches(){
  String rev=mk.commit("/","+\"foo\":{\"prop\":\"value\"}",null,null);
  String b1=mk.branch(rev);
  String b2=mk.branch(rev);
  b1=mk.commit("/foo","^\"prop\":\"bar\"",b1,null);
  mk.merge(b1,null);
  b2=mk.commit("/foo","^\"prop\":\"baz\"",b2,null);
  try {
    mk.merge(b2,null);
    fail("Must fail with conflict for changeChangedProperty");
  }
 catch (  DocumentStoreException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void removeRemovedPropertyTwoBranches(){
  String rev=mk.commit("/","+\"foo\":{\"prop\":\"value\"}",null,null);
  String branchRev1=mk.branch(rev);
  branchRev1=mk.commit("/foo","^\"prop\":null",branchRev1,null);
  String branchRev2=mk.branch(rev);
  branchRev2=mk.commit("/foo","^\"prop\":null",branchRev2,null);
  mk.merge(branchRev2,null);
  try {
    mk.merge(branchRev1,null);
    fail("Must fail with conflict for removeRemovedProperty");
  }
 catch (  DocumentStoreException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void changeRemovedPropertyTwoBranches(){
  String rev=mk.commit("/","+\"foo\":{\"prop\":\"value\"}",null,null);
  String branchRev1=mk.branch(rev);
  branchRev1=mk.commit("/foo","^\"prop\":\"bar\"",branchRev1,null);
  String branchRev2=mk.branch(rev);
  branchRev2=mk.commit("/foo","^\"prop\":null",branchRev2,null);
  mk.merge(branchRev2,null);
  try {
    mk.merge(branchRev1,null);
    fail("Must fail with conflict for changeRemovedProperty");
  }
 catch (  DocumentStoreException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void changeRemovedNodeTwoBranches(){
  String rev=mk.commit("/","+\"foo\":{}",null,null);
  String branchRev1=mk.branch(rev);
  branchRev1=mk.commit("/foo","^\"prop\":\"value\"",branchRev1,null);
  String branchRev2=mk.branch(rev);
  branchRev2=mk.commit("/","-\"foo\"",branchRev2,null);
  mk.merge(branchRev2,null);
  try {
    mk.merge(branchRev1,null);
    fail("Must fail with conflict for changeRemovedNode");
  }
 catch (  DocumentStoreException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void removeRemovedProperty(){
  String rev=mk.commit("/","+\"foo\":{\"prop\":\"value\"}",null,null);
  mk.commit("/foo","^\"prop\":null",rev,null);
  try {
    mk.commit("/foo","^\"prop\":null",rev,null);
    fail("Must fail with conflict for removeRemovedProperty");
  }
 catch (  DocumentStoreException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void addExistingPropertyBranchWins(){
  String rev=mk.commit("/","+\"foo\":{}",null,null);
  String branchRev=mk.branch(rev);
  branchRev=mk.commit("/foo","^\"prop\":\"value\"",branchRev,null);
  mk.merge(branchRev,null);
  try {
    mk.commit("/foo","^\"prop\":\"value\"",rev,null);
    fail("Must fail with conflict for addExistingProperty");
  }
 catch (  DocumentStoreException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void removeChangedPropertyTwoBranches(){
  String rev=mk.commit("/","+\"foo\":{\"prop\":\"value\"}",null,null);
  String branchRev1=mk.branch(rev);
  branchRev1=mk.commit("/foo","^\"prop\":null",branchRev1,null);
  String branchRev2=mk.branch(rev);
  branchRev2=mk.commit("/foo","^\"prop\":\"bar\"",branchRev2,null);
  mk.merge(branchRev2,null);
  try {
    mk.merge(branchRev1,null);
    fail("Must fail with conflict for removeChangedProperty");
  }
 catch (  DocumentStoreException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void removeChangedPropertyBranchWins(){
  String rev=mk.commit("/","+\"foo\":{\"prop\":\"value\"}",null,null);
  String branchRev=mk.branch(rev);
  branchRev=mk.commit("/foo","^\"prop\":\"bar\"",branchRev,null);
  mk.merge(branchRev,null);
  try {
    mk.commit("/foo","^\"prop\":null",rev,null);
    fail("Must fail with conflict for removeChangedProperty");
  }
 catch (  DocumentStoreException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void removeRemovedNodeBranchLoses1(){
  String rev=mk.commit("/","+\"foo\":{}",null,null);
  String branchRev=mk.branch(rev);
  branchRev=mk.commit("/","-\"foo\"",branchRev,null);
  mk.commit("/","-\"foo\"",rev,null);
  try {
    mk.merge(branchRev,null);
    fail("Must fail with conflict for removeRemovedNode");
  }
 catch (  DocumentStoreException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void removeRemovedNode(){
  String rev=mk.commit("/","+\"foo\":{}",null,null);
  mk.commit("/","-\"foo\"",rev,null);
  try {
    mk.commit("/","-\"foo\"",rev,null);
    fail("Must fail with conflict for removeRemovedNode");
  }
 catch (  DocumentStoreException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void changeRemovedNodeBranchLoses1(){
  String rev=mk.commit("/","+\"foo\":{}",null,null);
  String branchRev=mk.branch(rev);
  branchRev=mk.commit("/","-\"foo\"",branchRev,null);
  mk.commit("/foo","^\"prop\":\"value\"",rev,null);
  try {
    mk.merge(branchRev,null);
    fail("Must fail with conflict for changeRemovedNode");
  }
 catch (  DocumentStoreException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void addExistingPropertyBranchLoses2(){
  String rev=mk.commit("/","+\"foo\":{}",null,null);
  String branchRev=mk.branch(rev);
  mk.commit("/foo","^\"prop\":\"value\"",rev,null);
  branchRev=mk.commit("/foo","^\"prop\":\"value\"",branchRev,null);
  try {
    mk.merge(branchRev,null);
    fail("Must fail with conflict for addExistingProperty");
  }
 catch (  DocumentStoreException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void addExistingProperty(){
  String rev=mk.commit("/","+\"foo\":{}",null,null);
  mk.commit("/foo","^\"prop\":\"value\"",rev,null);
  try {
    mk.commit("/foo","^\"prop\":\"value\"",rev,null);
    fail("Must fail with conflict for addExistingProperty");
  }
 catch (  DocumentStoreException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void changeChangedPropertyBranchLoses1(){
  String rev=mk.commit("/","+\"foo\":{\"prop\":\"value\"}",null,null);
  String branchRev=mk.branch(rev);
  branchRev=mk.commit("/foo","^\"prop\":\"bar\"",branchRev,null);
  mk.commit("/foo","^\"prop\":\"baz\"",rev,null);
  try {
    mk.merge(branchRev,null);
    fail("Must fail with conflict for changeChangedProperty");
  }
 catch (  DocumentStoreException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void addExistingPropertyTwoBranches(){
  String rev=mk.commit("/","+\"foo\":{}",null,null);
  String branchRev1=mk.branch(rev);
  branchRev1=mk.commit("/foo","^\"prop\":\"value\"",branchRev1,null);
  String branchRev2=mk.branch(rev);
  branchRev2=mk.commit("/foo","^\"prop\":\"other\"",branchRev2,null);
  mk.merge(branchRev2,null);
  try {
    mk.merge(branchRev1,null);
    fail("Must fail with conflict for addExistingProperty");
  }
 catch (  DocumentStoreException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void addExistingNodeBranchLoses1(){
  String rev=mk.commit("/","+\"foo\":{}",null,null);
  String branchRev=mk.branch(rev);
  branchRev=mk.commit("/foo","+\"bar\":{}",branchRev,null);
  mk.commit("/foo","+\"bar\":{}",rev,null);
  try {
    mk.merge(branchRev,null);
    fail("Must fail with conflict for addExistingNode");
  }
 catch (  DocumentStoreException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void changeChangedPropertyBranchWins(){
  String rev=mk.commit("/","+\"foo\":{\"prop\":\"value\"}",null,null);
  String branchRev=mk.branch(rev);
  branchRev=mk.commit("/foo","^\"prop\":\"bar\"",branchRev,null);
  mk.merge(branchRev,null);
  try {
    mk.commit("/foo","^\"prop\":\"baz\"",rev,null);
    fail("Must fail with conflict for changeChangedProperty");
  }
 catch (  DocumentStoreException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void addExistingNode(){
  String rev=mk.commit("/","+\"foo\":{}",null,null);
  mk.commit("/foo","+\"bar\":{}",rev,null);
  try {
    mk.commit("/foo","+\"bar\":{}",rev,null);
    fail("Must fail with conflict for addExistingNode");
  }
 catch (  DocumentStoreException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void changeRemovedPropertyBranchLoses2(){
  String rev=mk.commit("/","+\"foo\":{\"prop\":\"value\"}",null,null);
  String branchRev=mk.branch(rev);
  mk.commit("/foo","^\"prop\":\"bar\"",rev,null);
  branchRev=mk.commit("/foo","^\"prop\":null",branchRev,null);
  try {
    mk.merge(branchRev,null);
    fail("Must fail with conflict for changeRemovedProperty");
  }
 catch (  DocumentStoreException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void removeChangedNodeTwoBranches(){
  String rev=mk.commit("/","+\"foo\":{}",null,null);
  String branchRev1=mk.branch(rev);
  branchRev1=mk.commit("/","-\"foo\"",branchRev1,null);
  String branchRev2=mk.branch(rev);
  branchRev2=mk.commit("/foo","^\"prop\":\"value\"",branchRev2,null);
  mk.merge(branchRev2,null);
  try {
    mk.merge(branchRev1,null);
    fail("Must fail with conflict for removeChangedNode");
  }
 catch (  DocumentStoreException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void removeChangedNodeBranchLoses2(){
  String rev=mk.commit("/","+\"foo\":{}",null,null);
  String branchRev=mk.branch(rev);
  mk.commit("/","-\"foo\"",rev,null);
  branchRev=mk.commit("/foo","^\"prop\":\"value\"",branchRev,null);
  try {
    mk.merge(branchRev,null);
    fail("Must fail with conflict for removeChangedNode");
  }
 catch (  DocumentStoreException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void removeChangedNode(){
  String rev=mk.commit("/","+\"foo\":{}",null,null);
  mk.commit("/foo","^\"prop\":\"value\"",rev,null);
  try {
    mk.commit("/","-\"foo\"",rev,null);
    fail("Must fail with conflict for removeChangedNode");
  }
 catch (  DocumentStoreException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void addExistingNodeTwoBranches(){
  String rev=mk.commit("/","+\"foo\":{}",null,null);
  String branchRev1=mk.branch(rev);
  branchRev1=mk.commit("/foo","+\"bar\":{}",branchRev1,null);
  String branchRev2=mk.branch(rev);
  branchRev2=mk.commit("/foo","+\"bar\":{}",branchRev2,null);
  mk.merge(branchRev2,null);
  try {
    mk.merge(branchRev1,null);
    fail("Must fail with conflict for addExistingNode");
  }
 catch (  DocumentStoreException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void addExistingNodeBranchLoses2(){
  String rev=mk.commit("/","+\"foo\":{}",null,null);
  String branchRev=mk.branch(rev);
  mk.commit("/foo","+\"bar\":{}",rev,null);
  branchRev=mk.commit("/foo","+\"bar\":{}",branchRev,null);
  try {
    mk.merge(branchRev,null);
    fail("Must fail with conflict for addExistingNode");
  }
 catch (  DocumentStoreException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void changeRemovedNodeBranchWins(){
  String rev=mk.commit("/","+\"foo\":{}",null,null);
  String branchRev=mk.branch(rev);
  branchRev=mk.commit("/","-\"foo\"",branchRev,null);
  mk.merge(branchRev,null);
  try {
    mk.commit("/foo","^\"prop\":\"value\"",rev,null);
    fail("Must fail with conflict for changeRemovedNode");
  }
 catch (  DocumentStoreException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void changeRemovedProperty(){
  String rev=mk.commit("/","+\"foo\":{\"prop\":\"value\"}",null,null);
  mk.commit("/foo","^\"prop\":null",rev,null);
  try {
    mk.commit("/foo","^\"prop\":\"bar\"",rev,null);
    fail("Must fail with conflict for changeRemovedProperty");
  }
 catch (  DocumentStoreException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void changeRemovedNode(){
  String rev=mk.commit("/","+\"foo\":{}",null,null);
  mk.commit("/","-\"foo\"",rev,null);
  try {
    mk.commit("/foo","^\"prop\":\"value\"",rev,null);
    fail("Must fail with conflict for changeRemovedNode");
  }
 catch (  DocumentStoreException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void changeRemovedPropertyBranchLoses1(){
  String rev=mk.commit("/","+\"foo\":{\"prop\":\"value\"}",null,null);
  String branchRev=mk.branch(rev);
  branchRev=mk.commit("/foo","^\"prop\":null",branchRev,null);
  mk.commit("/foo","^\"prop\":\"bar\"",rev,null);
  try {
    mk.merge(branchRev,null);
    fail("Must fail with conflict for changeRemovedProperty");
  }
 catch (  DocumentStoreException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void removeRemovedNodeBranchWins(){
  String rev=mk.commit("/","+\"foo\":{}",null,null);
  String branchRev=mk.branch(rev);
  branchRev=mk.commit("/","-\"foo\"",branchRev,null);
  mk.merge(branchRev,null);
  try {
    mk.commit("/","-\"foo\"",rev,null);
    fail("Must fail with conflict for removeRemovedNode");
  }
 catch (  DocumentStoreException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void removeChangedPropertyBranchLoses2(){
  String rev=mk.commit("/","+\"foo\":{\"prop\":\"value\"}",null,null);
  String branchRev=mk.branch(rev);
  mk.commit("/foo","^\"prop\":null",rev,null);
  branchRev=mk.commit("/foo","^\"prop\":\"bar\"",branchRev,null);
  try {
    mk.merge(branchRev,null);
    fail("Must fail with conflict for removeChangedProperty");
  }
 catch (  DocumentStoreException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void removeChangedNodeBranchLoses1(){
  String rev=mk.commit("/","+\"foo\":{}",null,null);
  String branchRev=mk.branch(rev);
  branchRev=mk.commit("/foo","^\"prop\":\"value\"",branchRev,null);
  mk.commit("/","-\"foo\"",rev,null);
  try {
    mk.merge(branchRev,null);
    fail("Must fail with conflict for removeChangedNode");
  }
 catch (  DocumentStoreException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void changeRemovedNodeBranchLoses2(){
  String rev=mk.commit("/","+\"foo\":{}",null,null);
  String branchRev=mk.branch(rev);
  mk.commit("/foo","^\"prop\":\"value\"",rev,null);
  branchRev=mk.commit("/","-\"foo\"",branchRev,null);
  try {
    mk.merge(branchRev,null);
    fail("Must fail with conflict for changeRemovedNode");
  }
 catch (  DocumentStoreException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void addExistingPropertyBranchLoses1(){
  String rev=mk.commit("/","+\"foo\":{}",null,null);
  String branchRev=mk.branch(rev);
  branchRev=mk.commit("/foo","^\"prop\":\"value\"",branchRev,null);
  mk.commit("/foo","^\"prop\":\"value\"",rev,null);
  try {
    mk.merge(branchRev,null);
    fail("Must fail with conflict for addExistingProperty");
  }
 catch (  DocumentStoreException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void addExistingNodeBranchWins(){
  String rev=mk.commit("/","+\"foo\":{}",null,null);
  String branchRev=mk.branch(rev);
  branchRev=mk.commit("/foo","+\"bar\":{}",branchRev,null);
  mk.merge(branchRev,null);
  try {
    mk.commit("/foo","+\"bar\":{}",rev,null);
    fail("Must fail with conflict for addExistingNode");
  }
 catch (  DocumentStoreException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void changeChangedPropertyBranchLoses2(){
  String rev=mk.commit("/","+\"foo\":{\"prop\":\"value\"}",null,null);
  String branchRev=mk.branch(rev);
  mk.commit("/foo","^\"prop\":\"baz\"",rev,null);
  branchRev=mk.commit("/foo","^\"prop\":\"bar\"",branchRev,null);
  try {
    mk.merge(branchRev,null);
    fail("Must fail with conflict for changeChangedProperty");
  }
 catch (  DocumentStoreException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void removeChangedProperty(){
  String rev=mk.commit("/","+\"foo\":{\"prop\":\"value\"}",null,null);
  mk.commit("/foo","^\"prop\":\"bar\"",rev,null);
  try {
    mk.commit("/foo","^\"prop\":null",rev,null);
    fail("Must fail with conflict for removeChangedProperty");
  }
 catch (  DocumentStoreException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void changeChangedProperty(){
  String rev=mk.commit("/","+\"foo\":{\"prop\":\"value\"}",null,null);
  mk.commit("/foo","^\"prop\":\"bar\"",rev,null);
  try {
    mk.commit("/foo","^\"prop\":\"baz\"",rev,null);
    fail("Must fail with conflict for changeChangedProperty");
  }
 catch (  DocumentStoreException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void removeChangedPropertyBranchLoses1(){
  String rev=mk.commit("/","+\"foo\":{\"prop\":\"value\"}",null,null);
  String branchRev=mk.branch(rev);
  branchRev=mk.commit("/foo","^\"prop\":\"bar\"",branchRev,null);
  mk.commit("/foo","^\"prop\":null",rev,null);
  try {
    mk.merge(branchRev,null);
    fail("Must fail with conflict for removeChangedProperty");
  }
 catch (  DocumentStoreException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void removeRemovedNodeBranchLoses2(){
  String rev=mk.commit("/","+\"foo\":{}",null,null);
  String branchRev=mk.branch(rev);
  mk.commit("/","-\"foo\"",rev,null);
  branchRev=mk.commit("/","-\"foo\"",branchRev,null);
  try {
    mk.merge(branchRev,null);
    fail("Must fail with conflict for removeRemovedNode");
  }
 catch (  DocumentStoreException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void removeRemovedNodeTwoBranches(){
  String rev=mk.commit("/","+\"foo\":{}",null,null);
  String branchRev1=mk.branch(rev);
  branchRev1=mk.commit("/","-\"foo\"",branchRev1,null);
  String branchRev2=mk.branch(rev);
  branchRev2=mk.commit("/","-\"foo\"",branchRev2,null);
  mk.merge(branchRev2,null);
  try {
    mk.merge(branchRev1,null);
    fail("Must fail with conflict for removeRemovedNode");
  }
 catch (  DocumentStoreException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void removeRemovedPropertyBranchWins(){
  String rev=mk.commit("/","+\"foo\":{\"prop\":\"value\"}",null,null);
  String branchRev=mk.branch(rev);
  branchRev=mk.commit("/foo","^\"prop\":null",branchRev,null);
  mk.merge(branchRev,null);
  try {
    mk.commit("/foo","^\"prop\":null",rev,null);
    fail("Must fail with conflict for removeRemovedProperty");
  }
 catch (  DocumentStoreException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void removeRemovedPropertyBranchLoses2(){
  String rev=mk.commit("/","+\"foo\":{\"prop\":\"value\"}",null,null);
  String branchRev=mk.branch(rev);
  mk.commit("/foo","^\"prop\":null",rev,null);
  branchRev=mk.commit("/foo","^\"prop\":null",branchRev,null);
  try {
    mk.merge(branchRev,null);
    fail("Must fail with conflict for removeRemovedProperty");
  }
 catch (  DocumentStoreException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void removeRemovedPropertyBranchLoses1(){
  String rev=mk.commit("/","+\"foo\":{\"prop\":\"value\"}",null,null);
  String branchRev=mk.branch(rev);
  branchRev=mk.commit("/foo","^\"prop\":null",branchRev,null);
  mk.commit("/foo","^\"prop\":null",rev,null);
  try {
    mk.merge(branchRev,null);
    fail("Must fail with conflict for removeRemovedProperty");
  }
 catch (  DocumentStoreException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void removeChangedNodeBranchWins(){
  String rev=mk.commit("/","+\"foo\":{}",null,null);
  String branchRev=mk.branch(rev);
  branchRev=mk.commit("/foo","^\"prop\":\"value\"",branchRev,null);
  mk.merge(branchRev,null);
  try {
    mk.commit("/","-\"foo\"",rev,null);
    fail("Must fail with conflict for removeChangedNode");
  }
 catch (  DocumentStoreException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.DocumentDiscoveryLiteServiceTest </h4><pre class="type-13 type-9 type-12 type-5 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This test creates a large number of documentnodestores which it starts,
 * runs, stops in a random fashion, always testing to make sure the
 * clusterView is correct
 */
@Test public void testLargeStartStopFiesta() throws Throwable {
  logger.info("testLargeStartStopFiesta: start, seed=" + SEED);
  final List<SimplifiedInstance> instances=new LinkedList<SimplifiedInstance>();
  final Map<Integer,String> inactiveIds=new HashMap<Integer,String>();
  final Random random=new Random(SEED);
  final int LOOP_CNT=50;
  final int CHECK_EVERY=3;
  final int MAX_NUM_INSTANCES=8;
  for (int i=0; i < LOOP_CNT; i++) {
    if (i % CHECK_EVERY == 0) {
      checkFiestaState(instances,inactiveIds.keySet());
    }
    final int nextInt=random.nextInt(5);
    String workingDir=UUID.randomUUID().toString();
switch (nextInt) {
case 0:
{
        if (inactiveIds.size() > 0) {
          logger.info("Case 0 - reactivating an instance...");
          final int n=random.nextInt(inactiveIds.size());
          final Integer cid=new LinkedList<Integer>(inactiveIds.keySet()).get(n);
          final String reactivatedWorkingDir=inactiveIds.remove(cid);
          if (reactivatedWorkingDir == null) {
            fail("reactivatedWorkingDir null for n=" + n + ", cid="+ cid+ ", other inactives: "+ inactiveIds);
          }
          assertNotNull(reactivatedWorkingDir);
          logger.info("Case 0 - reactivated instance " + cid + ", workingDir="+ reactivatedWorkingDir);
          workingDir=reactivatedWorkingDir;
          logger.info("Case 0: creating instance");
          final SimplifiedInstance newInstance=createInstance(workingDir);
          if (newInstance.hasRandomMachineId()) {
            return;
          }
          newInstance.setLeastTimeout(5000,1000);
          newInstance.startSimulatingWrites(500);
          logger.info("Case 0: created instance: " + newInstance.ns.getClusterId());
          if (newInstance.ns.getClusterId() != cid) {
            logger.info("Case 0: reactivated instance did not take over cid - probably a testing artifact. expected cid: {}, actual cid: {}",cid,newInstance.ns.getClusterId());
            inactiveIds.put(cid,reactivatedWorkingDir);
            inactiveIds.remove(newInstance.ns.getClusterId());
          }
          instances.add(newInstance);
        }
        break;
      }
case 1:
{
      if (instances.size() < MAX_NUM_INSTANCES) {
        logger.info("Case 1: creating instance");
        final SimplifiedInstance newInstance=createInstance(workingDir);
        if (newInstance.hasRandomMachineId()) {
          return;
        }
        newInstance.setLeastTimeout(5000,1000);
        newInstance.startSimulatingWrites(500);
        logger.info("Case 1: created instance: " + newInstance.ns.getClusterId());
        instances.add(newInstance);
        inactiveIds.remove(newInstance.ns.getClusterId());
      }
      break;
    }
case 2:
{
    break;
  }
case 3:
{
  if (instances.size() > 1) {
    checkFiestaState(instances,inactiveIds.keySet());
    final SimplifiedInstance instance=instances.remove(random.nextInt(instances.size()));
    assertNotNull(instance.workingDir);
    logger.info("Case 3: Shutdown instance: " + instance.ns.getClusterId());
    inactiveIds.put(instance.ns.getClusterId(),instance.workingDir);
    instance.shutdown();
  }
  break;
}
case 4:
{
if (instances.size() > 1) {
  checkFiestaState(instances,inactiveIds.keySet());
  final SimplifiedInstance instance=instances.remove(random.nextInt(instances.size()));
  assertNotNull(instance.workingDir);
  logger.info("Case 4: Crashing instance: " + instance.ns.getClusterId());
  inactiveIds.put(instance.ns.getClusterId(),instance.workingDir);
  instance.addNode("/" + instance.ns.getClusterId() + "/stuffForRecovery/"+ random.nextInt(10000));
  instance.crash();
}
break;
}
}
}
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.DocumentMKBranchMergeTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void twoBranchChangedPropertiesWithConflict(){
  addNodes(null,"/trunk");
  setProp(null,"/trunk/prop1","value1");
  setProp(null,"/trunk/prop2","value1");
  assertPropExists(null,"/trunk","prop1");
  assertPropExists(null,"/trunk","prop2");
  String branchRev1=mk.branch(null);
  branchRev1=setProp(branchRev1,"/trunk/prop1","value1-b1");
  assertPropValue(branchRev1,"/trunk","prop1","value1-b1");
  String branchRev2=mk.branch(null);
  branchRev2=setProp(branchRev2,"/trunk/prop2","value1-b2");
  assertPropValue(branchRev2,"/trunk","prop2","value1-b2");
  mk.commit("/","^\"trunk/prop1\":\"value1-modified\"" + "^\"trunk/prop2\":\"value1-modified\"",null,null);
  try {
    mk.merge(branchRev1,"");
    fail("Expected: Concurrent modification exception");
  }
 catch (  Exception expected) {
  }
  try {
    mk.merge(branchRev2,"");
    fail("Expected: Concurrent modification exception");
  }
 catch (  Exception expected) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void addExistingChildInBranch(){
  addNodes(null,"/root","/root/child1");
  assertNodesExist(null,"/root","/root/child1");
  String branchRev=mk.branch(null);
  branchRev=addNodes(branchRev,"/root/child2");
  assertNodesExist(branchRev,"/root/child1","/root/child2");
  try {
    addNodes(branchRev,"/root/child1");
    fail("Should not be able to add the same root node twice");
  }
 catch (  Exception expected) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void addExistingRootInBranch(){
  addNodes(null,"/root");
  assertNodesExist(null,"/root");
  String branchRev=mk.branch(null);
  try {
    addNodes(branchRev,"/root");
    fail("Should not be able to add the same root node twice");
  }
 catch (  Exception expected) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void oneBranchChangedPropertiesWithConflict(){
  addNodes(null,"/trunk");
  setProp(null,"/trunk/prop1","value1");
  assertPropExists(null,"/trunk","prop1");
  String branchRev=mk.branch(null);
  branchRev=setProp(branchRev,"/trunk/prop1","value1a");
  assertPropValue(branchRev,"/trunk","prop1","value1a");
  setProp(null,"/trunk/prop1","value1b");
  try {
    mk.merge(branchRev,"");
    fail("Expected: Concurrent modification exception");
  }
 catch (  Exception expected) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void trunkMergeNotAllowed(){
  String rev=mk.commit("","+\"/child1\":{}",null,"");
  try {
    mk.merge(rev,"");
    fail("Exception expected");
  }
 catch (  Exception expected) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void propertyConflictWithMergedBranch(){
  addNodes(null,"/trunk");
  String rev=setProp(null,"/trunk/prop1","value1");
  assertPropExists(null,"/trunk","prop1");
  String branchRev=mk.branch(null);
  branchRev=setProp(branchRev,"/trunk/prop1","value1a");
  assertPropValue(branchRev,"/trunk","prop1","value1a");
  mk.merge(branchRev,"");
  assertPropValue(null,"/trunk","prop1","value1a");
  try {
    setProp(rev,"/trunk/prop1","value1b");
    fail("Expected: Concurrent modification exception");
  }
 catch (  Exception expected) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.DocumentMKCommitAddTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void setOverwritingProperty() throws Exception {
  String rev1=mk.commit("/","+\"a\" : {} ^\"a/key1\" : \"value1\"",null,null);
  String rev2=mk.commit("/","^\"a/key1\" : \"value2\"",rev1,null);
  try {
    mk.commit("/","^\"a/key1\" : \"value3\"",rev1,null);
    fail("commit must fail with conflicting change");
  }
 catch (  DocumentStoreException e) {
  }
  mk.commit("/","^\"a/key1\" : \"value3\"",rev2,null);
  String nodes=mk.getNodes("/a",null,0,0,-1,null);
  JSONObject obj=parseJSONObject(nodes);
  assertPropertyValue(obj,"key1","value3");
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void setPropertyWithoutAddingNode() throws Exception {
  try {
    mk.commit("/","^\"a/key1\" : \"value1\"",null,null);
    fail("Exception expected");
  }
 catch (  Exception expected) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void addDuplicateNode() throws Exception {
  mk.commit("/","+\"a\" : {}",null,null);
  try {
    mk.commit("/","+\"a\" : {}",null,null);
    fail("Exception expected");
  }
 catch (  Exception expected) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.DocumentMKCommitCopyTest </h4><pre class="type-5 type-3 type-14 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
@Test @Ignore public void removeNodeAndCopy(){
  mk.commit("/","+\"a\":{ \"b\" : {} }",null,null);
  try {
    mk.commit("/","-\"a/b\"\n" + "*\"a/b\":\"c\"",null,null);
    fail("Expected expected");
  }
 catch (  Exception expected) {
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void copyFromNonExistentNode() throws Exception {
  mk.commit("/","+\"a\" : {}",null,null);
  assertTrue(mk.nodeExists("/a",null));
  try {
    mk.commit("/","*\"b\" : \"c\"",null,null);
    fail("Exception expected");
  }
 catch (  Exception expected) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void copyToAnExistentNode() throws Exception {
  mk.commit("/","+\"a\" : { \"b\" : {} }",null,null);
  mk.commit("/","+\"c\" : {}",null,null);
  try {
    mk.commit("/","*\"c\" : \"a/b\"",null,null);
    fail("Exception expected");
  }
 catch (  Exception expected) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.DocumentMKCommitMoveTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void moveFromNonExistentNode() throws Exception {
  try {
    mk.commit("/",">\"b\" : \"c\"",null,null);
    fail("Exception expected");
  }
 catch (  Exception expected) {
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void moveUnderSourcePath() throws Exception {
  mk.commit("/","+\"a\" : { \"b\" : {} }",null,null);
  assertTrue(mk.nodeExists("/a",null));
  assertTrue(mk.nodeExists("/a/b",null));
  try {
    mk.commit("/",">\"b\" : \"a\"",null,null);
    fail("Exception expected");
  }
 catch (  Exception expected) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void moveToAnExistentNode() throws Exception {
  mk.commit("/","+\"a\" : { \"b\" : {} }",null,null);
  mk.commit("/","+\"c\" : {}",null,null);
  try {
    mk.commit("/",">\"c\" : \"a/b\"",null,null);
    fail("Exception expected");
  }
 catch (  Exception expected) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void removeNodeAndMove(){
  mk.commit("/","+\"a\":{ \"b\" : {} }",null,null);
  try {
    mk.commit("/","-\"a/b\"\n" + ">\"a/b\":\"c\"",null,null);
    fail("Expected expected");
  }
 catch (  Exception expected) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.DocumentMKCommitRemoveTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void removeNonExistentNode() throws Exception {
  try {
    mk.commit("/","-\"a\"",null,null);
    fail("Exception expected");
  }
 catch (  Exception expected) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.DocumentMKGetNodesTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void nonExistingRevision() throws Exception {
  try {
    mk.getNodes("/","123",1,0,-1,null);
    fail("Exception expected");
  }
 catch (  Exception expected) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void invalidRevision() throws Exception {
  try {
    mk.getNodes("/","invalid",1,0,-1,null);
    fail("Exception expected");
  }
 catch (  Exception expected) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.DocumentMKNodeExistsTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void withInvalidRevisionId() throws Exception {
  SimpleNodeScenario scenario=new SimpleNodeScenario(mk);
  scenario.create();
  try {
    mk.nodeExists("/a","123456789");
    fail("Expected: Invalid revision id exception");
  }
 catch (  Exception expected) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.DocumentMKResetTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void resetConflictAddExistingNode(){
  String b0=mk.branch(null);
  addNodes(null,"/foo");
  String b1=addNodes(b0,"/bar");
  String b2=addNodes(b1,"/foo");
  try {
    mk.merge(b2,null);
    fail("merge with conflict must fail");
  }
 catch (  DocumentStoreException e) {
  }
  String b3=mk.reset(b2,b1);
  String rev=mk.merge(b3,null);
  assertNodesExist(rev,"/foo","/bar");
}

</code></pre>

<br>
<pre class="type-9 type-5 type-7 type-6 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void resetMultipleCommits(){
  DocumentStore store=mk.getDocumentStore();
  addNodes(null,"/foo");
  String b0=mk.branch(null);
  String b1=mk.commit("","^\"/foo/p1\":1",b0,null);
  String b2=mk.commit("","^\"/foo/p2\":1",b1,null);
  String b3=mk.commit("","^\"/foo/p3\":1",b2,null);
  mk.commit("","^\"/foo/p2\":1^\"/foo/p3\":1",null,null);
  NodeDocument rootDoc=store.find(NODES,getIdFromPath("/"));
  assertNotNull(rootDoc);
  Map<Revision,String> collisions=rootDoc.getValueMap(COLLISIONS);
  assertEquals(2,collisions.size());
  assertTrue(collisions.containsKey(Revision.fromString(b2).asTrunkRevision()));
  assertTrue(collisions.containsKey(Revision.fromString(b3).asTrunkRevision()));
  try {
    mk.merge(b3,null);
    fail("merge with conflict must fail");
  }
 catch (  DocumentStoreException e) {
  }
  String b4=mk.reset(b3,b1);
  String b5=mk.commit("","^\"/foo/p4\":1",b4,null);
  rootDoc=store.find(NODES,getIdFromPath("/"));
  assertNotNull(rootDoc);
  collisions=rootDoc.getValueMap(COLLISIONS);
  assertEquals(0,collisions.size());
  String rev=mk.merge(b5,null);
  assertPropExists(rev,"/foo","p1");
  assertPropExists(rev,"/foo","p2");
  assertPropExists(rev,"/foo","p3");
  assertPropExists(rev,"/foo","p4");
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void resetNonAncestor(){
  String rev=mk.getHeadRevision();
  addNodes(null,"/foo");
  String branch=mk.branch(null);
  branch=addNodes(branch,"/bar");
  try {
    mk.reset(branch,rev);
    fail("DocumentStoreException expected");
  }
 catch (  DocumentStoreException expected) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void resetTrunk(){
  String rev=addNodes(null,"/foo");
  try {
    mk.reset(rev,rev);
    fail("DocumentStoreException expected");
  }
 catch (  DocumentStoreException expected) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void resetConflictRemoveRemovedNode(){
  String rev=addNodes(null,"/foo","/bar");
  String b0=mk.branch(rev);
  removeNodes(null,"/foo");
  String b1=removeNodes(b0,"/bar");
  String b2=removeNodes(b1,"/foo");
  try {
    mk.merge(b2,null);
    fail("merge with conflict must fail");
  }
 catch (  DocumentStoreException e) {
  }
  String b3=mk.reset(b2,b1);
  rev=mk.merge(b3,null);
  assertNodesNotExist(rev,"/foo","/bar");
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void resetConflictAddExistingProperty(){
  addNodes(null,"/foo");
  String b0=mk.branch(null);
  mk.commit("","^\"/foo/p1\":1",null,null);
  String b1=mk.commit("","^\"/foo/p2\":1",b0,null);
  String b2=mk.commit("","^\"/foo/p1\":1",b1,null);
  try {
    mk.merge(b2,null);
    fail("merge with conflict must fail");
  }
 catch (  DocumentStoreException e) {
  }
  String b3=mk.reset(b2,b1);
  String rev=mk.merge(b3,null);
  assertPropExists(rev,"/foo","p1");
  assertPropExists(rev,"/foo","p2");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.DocumentNodeStoreTest </h4><pre class="type-5 type-7 type-6 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void notYetVisibleExceptionMessage() throws Exception {
  MemoryDocumentStore store=new MemoryDocumentStore();
  DocumentNodeStore ns1=builderProvider.newBuilder().setDocumentStore(store).setAsyncDelay(0).setClusterId(1).getNodeStore();
  DocumentNodeStore ns2=builderProvider.newBuilder().setDocumentStore(store).setAsyncDelay(0).setClusterId(2).getNodeStore();
  ns2.setMaxBackOffMillis(0);
  NodeBuilder b1=ns1.getRoot().builder();
  b1.child("test").setProperty("p","v");
  merge(ns1,b1);
  NodeBuilder b2=ns2.getRoot().builder();
  b2.child("test").setProperty("q","v");
  try {
    merge(ns2,b2);
    fail("Must throw CommitFailedException");
  }
 catch (  CommitFailedException e) {
    assertNotNull(e.getCause());
    assertTrue(e.getCause().getMessage().contains("not yet visible"));
  }
}

</code></pre>

<br>
<pre class="type-13 type-5 type-7 type-6 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void commitHookChangesOnBranch() throws Exception {
  final int NUM_NODES=DocumentRootBuilder.UPDATE_LIMIT / 2;
  final int NUM_PROPS=10;
  DocumentNodeStore ns=builderProvider.newBuilder().getNodeStore();
  NodeBuilder builder=ns.getRoot().builder();
  for (int i=0; i < NUM_NODES; i++) {
    NodeBuilder c=builder.child("n" + i);
    for (int j=0; j < NUM_PROPS; j++) {
      c.setProperty("q" + j,"value");
      c.setProperty("p" + j,"value");
    }
  }
  try {
    ns.merge(builder,CompositeHook.compose(Arrays.asList(new TestHook("p"),new TestHook("q"),FAILING_HOOK)),CommitInfo.EMPTY);
    fail("merge must fail and reset changes done by commit hooks");
  }
 catch (  CommitFailedException e) {
  }
  for (int i=0; i < NUM_NODES; i++) {
    NodeBuilder c=builder.getChildNode("n" + i);
    assertTrue(c.exists());
    for (int j=0; j < NUM_PROPS; j++) {
      PropertyState p=c.getProperty("p" + j);
      assertNotNull(p);
      assertEquals("value",p.getValue(Type.STRING));
      p=c.getProperty("q" + j);
      assertNotNull(p);
      assertEquals("value",p.getValue(Type.STRING));
    }
  }
  ns.merge(builder,CompositeHook.compose(Arrays.<CommitHook>asList(new TestHook("p"),new TestHook("q"))),CommitInfo.EMPTY);
  builder=ns.getRoot().builder();
  for (int i=0; i < NUM_NODES; i++) {
    NodeBuilder c=builder.getChildNode("n" + i);
    assertTrue(c.exists());
    for (int j=0; j < NUM_PROPS; j++) {
      PropertyState p=c.getProperty("p" + j);
      assertNotNull(p);
      assertEquals("test",p.getValue(Type.STRING));
      p=c.getProperty("q" + j);
      assertNotNull(p);
      assertEquals("test",p.getValue(Type.STRING));
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void dispose() throws CommitFailedException, InterruptedException {
  final BlockingQueue<String> updates=new ArrayBlockingQueue<String>(1);
  final AtomicBoolean throttleUpdates=new AtomicBoolean(true);
  MemoryDocumentStore docStore=new MemoryDocumentStore(){
    @Override public <T extends Document>void update(    Collection<T> collection,    List<String> keys,    UpdateOp updateOp){
      if (throttleUpdates.get()) {
        for (        String k : keys) {
          try {
            updates.put(k);
          }
 catch (          InterruptedException e) {
            throw new RuntimeException(e);
          }
        }
      }
      super.update(collection,keys,updateOp);
    }
  }
;
  final DocumentNodeStore store=builderProvider.newBuilder().setClusterId(1).setAsyncDelay(0).setDocumentStore(docStore).getNodeStore();
  updates.clear();
  NodeBuilder builder=store.getRoot().builder();
  builder.child("test").child("node");
  merge(store,builder);
  builder=store.getRoot().builder();
  builder.child("test").child("node").child("child-1");
  merge(store,builder);
  Thread t=new Thread(new Runnable(){
    @Override public void run(){
      store.dispose();
    }
  }
);
  t.start();
  String p=updates.take();
  assertEquals("2:/test/node",p);
  assertTrue(t.isAlive());
  for (; ; ) {
    if (updates.peek() != null) {
      break;
    }
  }
  try {
    builder=store.getRoot().builder();
    builder.child("test").child("node").child("child-2");
    merge(store,builder);
    fail("Merge must fail with CommitFailedException");
  }
 catch (  CommitFailedException e) {
  }
  while (t.isAlive()) {
    updates.poll(10,TimeUnit.MILLISECONDS);
  }
  updates.clear();
  throttleUpdates.set(false);
  DocumentNodeStore store2=builderProvider.newBuilder().setClusterId(2).setAsyncDelay(0).setDocumentStore(docStore).getNodeStore();
  LastRevRecoveryAgent agent=new LastRevRecoveryAgent(store2);
  if (agent.isRecoveryNeeded()) {
    agent.recover(1);
  }
  builder=store2.getRoot().builder();
  NodeBuilder test=builder.getChildNode("test");
  assertTrue(test.exists());
  NodeBuilder node=test.getChildNode("node");
  assertTrue(node.exists());
  if (!node.hasChildNode("child-2")) {
    node.child("child-2");
    merge(store2,builder);
  }
}

</code></pre>

<br>
<pre class="type-9 type-5 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void parentWithUnseenChildrenMustNotBeDeleted() throws Exception {
  final MemoryDocumentStore docStore=new MemoryDocumentStore();
  final DocumentNodeStore store1=builderProvider.newBuilder().setDocumentStore(docStore).setAsyncDelay(0).setClusterId(1).getNodeStore();
  store1.setEnableConcurrentAddRemove(true);
  final DocumentNodeStore store2=builderProvider.newBuilder().setDocumentStore(docStore).setAsyncDelay(0).setClusterId(2).getNodeStore();
  store2.setEnableConcurrentAddRemove(true);
  NodeBuilder builder=store1.getRoot().builder();
  builder.child(":hidden");
  merge(store1,builder);
  store1.runBackgroundOperations();
  store2.runBackgroundOperations();
  builder=store1.getRoot().builder();
  builder.child(":hidden").child("parent").child("node1");
  merge(store1,builder);
  builder=store2.getRoot().builder();
  builder.child(":hidden").child("parent").child("node2");
  merge(store2,builder);
  builder=store1.getRoot().builder();
  builder.child(":hidden").child("parent").remove();
  try {
    merge(store1,builder);
    fail("parent node of unseen children must not get deleted");
  }
 catch (  CommitFailedException cfe) {
  }
  String parentPath="/:hidden/parent";
  NodeDocument parentDoc=docStore.find(Collection.NODES,Utils.getIdFromPath(parentPath));
  assertFalse("parent node of unseen children must not get deleted",isDocDeleted(parentDoc));
  builder=store2.getRoot().builder();
  builder.child(":hidden").child("parent").remove();
  try {
    merge(store2,builder);
    fail("parent node of unseen children must not get deleted");
  }
 catch (  CommitFailedException cfe) {
  }
  parentDoc=docStore.find(Collection.NODES,Utils.getIdFromPath(parentPath));
  assertFalse("parent node of unseen children must not get deleted",isDocDeleted(parentDoc));
  store1.runBackgroundOperations();
  store2.runBackgroundOperations();
  builder=store1.getRoot().builder();
  builder.child(":hidden").child("parent").remove();
  builder.child(":hidden").child("parent1");
  store1.runBackgroundOperations();
  store2.runBackgroundOperations();
  builder=store1.getRoot().builder();
  builder.child(":hidden").child("parent1").child("node1");
  merge(store1,builder);
  builder=store2.getRoot().builder();
  builder.child(":hidden").child("parent1").child("node2");
  merge(store2,builder);
  builder=store1.getRoot().builder();
  builder.child(":hidden").child("parent1").remove();
  try {
    merge(store1,builder);
  }
 catch (  CommitFailedException cfe) {
  }
  parentPath="/:hidden/parent1";
  parentDoc=docStore.find(Collection.NODES,Utils.getIdFromPath(parentPath));
  assertFalse("parent node of unseen children must not get deleted",isDocDeleted(parentDoc));
  builder=store2.getRoot().builder();
  builder.child(":hidden").child("parent1").remove();
  try {
    merge(store2,builder);
  }
 catch (  CommitFailedException cfe) {
  }
  parentDoc=docStore.find(Collection.NODES,Utils.getIdFromPath(parentPath));
  assertFalse("parent node of unseen children must not get deleted",isDocDeleted(parentDoc));
}

</code></pre>

<br>
<pre class="type-9 type-12 type-5 type-6 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void readBranchCommit() throws Exception {
  final Set<String> readSet=Sets.newHashSet();
  DocumentStore store=new MemoryDocumentStore(){
    @Override public <T extends Document>T find(    Collection<T> collection,    String key){
      readSet.add(key);
      return super.find(collection,key);
    }
  }
;
  DocumentNodeStore ns=builderProvider.newBuilder().setDocumentStore(store).setAsyncDelay(0).getNodeStore();
  NodeBuilder builder=ns.getRoot().builder();
  String testId=Utils.getIdFromPath("/test");
  NodeBuilder test=builder.child("test");
  test.setProperty("p","value");
  int q=0;
  while (store.find(NODES,testId) == null) {
    test.setProperty("q",q++);
  }
  merge(ns,builder);
  for (int i=0; i < NUM_REVS_THRESHOLD; i++) {
    builder=ns.getRoot().builder();
    builder.child("test").setProperty("q",i);
    merge(ns,builder);
  }
  ns.runBackgroundOperations();
  NodeDocument doc=store.find(NODES,Utils.getIdFromPath("/test"));
  assertNotNull(doc);
  readSet.clear();
  doc.getNodeAtRevision(ns,ns.getHeadRevision(),null);
  for (  String id : Sets.newHashSet(readSet)) {
    doc=store.find(NODES,id);
    assertNotNull(doc);
    if (doc.isSplitDocument() && !doc.getMainPath().equals("/")) {
      fail("must not access previous document: " + id);
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-5 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void nonBlockingReset() throws Exception {
  final List<String> failure=Lists.newArrayList();
  final AtomicReference<ReentrantReadWriteLock> mergeLock=new AtomicReference<ReentrantReadWriteLock>();
  MemoryDocumentStore store=new MemoryDocumentStore(){
    @Override public <T extends Document>T findAndUpdate(    Collection<T> collection,    UpdateOp update){
      for (      Map.Entry<Key,Operation> entry : update.getChanges().entrySet()) {
        if (entry.getKey().getName().equals(NodeDocument.COLLISIONS)) {
          ReentrantReadWriteLock rwLock=mergeLock.get();
          if (rwLock.getReadHoldCount() > 0 || rwLock.getWriteHoldCount() > 0) {
            failure.add("Branch reset still holds merge lock");
            break;
          }
        }
      }
      return super.findAndUpdate(collection,update);
    }
  }
;
  DocumentNodeStore ds=builderProvider.newBuilder().setDocumentStore(store).setAsyncDelay(0).getNodeStore();
  ds.setMaxBackOffMillis(0);
  DocumentNodeState root=ds.getRoot();
  final DocumentNodeStoreBranch b=ds.createBranch(root);
  assertTrue(b.getMergeLock() instanceof ReentrantReadWriteLock);
  mergeLock.set((ReentrantReadWriteLock)b.getMergeLock());
  NodeBuilder builder=root.builder();
  builder.child("foo");
  b.setRoot(builder.getNodeState());
  builder.child("bar");
  b.setRoot(builder.getNodeState());
  try {
    b.merge(new CommitHook(){
      @Nonnull @Override public NodeState processCommit(      NodeState before,      NodeState after,      CommitInfo info) throws CommitFailedException {
        NodeBuilder foo=after.builder().child("foo");
        for (int i=0; i <= DocumentRootBuilder.UPDATE_LIMIT; i++) {
          foo.setProperty("prop",i);
        }
        throw new CommitFailedException("Fail",0,"");
      }
    }
,CommitInfo.EMPTY);
  }
 catch (  CommitFailedException e) {
  }
  for (  String s : failure) {
    fail(s);
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void failFastOnBranchConflict() throws Exception {
  final AtomicInteger mergeAttempts=new AtomicInteger();
  MemoryDocumentStore store=new MemoryDocumentStore(){
    @Override public <T extends Document>T findAndUpdate(    Collection<T> collection,    UpdateOp update){
      for (      Key k : update.getConditions().keySet()) {
        if (k.getName().equals(NodeDocument.COLLISIONS)) {
          mergeAttempts.incrementAndGet();
          break;
        }
      }
      return super.findAndUpdate(collection,update);
    }
  }
;
  DocumentNodeStore ds=builderProvider.newBuilder().setDocumentStore(store).setAsyncDelay(0).getNodeStore();
  DocumentNodeState root=ds.getRoot();
  DocumentNodeStoreBranch b=ds.createBranch(root);
  NodeBuilder builder=root.builder();
  builder.child("foo");
  b.setRoot(builder.getNodeState());
  builder.child("bar").setProperty("p","foo");
  b.setRoot(builder.getNodeState());
  NodeBuilder nb=ds.getRoot().builder();
  nb.child("bar").setProperty("p","bar");
  merge(ds,nb);
  mergeAttempts.set(0);
  try {
    b.merge(EmptyHook.INSTANCE,CommitInfo.EMPTY);
    fail("must fail with CommitFailedException");
  }
 catch (  CommitFailedException e) {
  }
  assertTrue("too many merge attempts: " + mergeAttempts.get(),mergeAttempts.get() <= 1);
}

</code></pre>

<br>
<pre class="type-9 type-5 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void conflictDetectionWithClockDifference() throws Exception {
  MemoryDocumentStore store=new MemoryDocumentStore();
  long now=System.currentTimeMillis();
  Clock c1=new Clock.Virtual();
  c1.waitUntil(now);
  Revision.setClock(c1);
  DocumentNodeStore ns1=builderProvider.newBuilder().clock(c1).setDocumentStore(store).setAsyncDelay(0).setClusterId(1).getNodeStore();
  NodeBuilder b1=ns1.getRoot().builder();
  b1.child("node");
  merge(ns1,b1);
  ns1.runBackgroundOperations();
  Revision.resetClockToDefault();
  Clock c2=new Clock.Virtual();
  c2.waitUntil(now + 5000);
  Revision.setClock(c2);
  DocumentNodeStore ns2=builderProvider.newBuilder().clock(c2).setDocumentStore(store).setAsyncDelay(0).setClusterId(2).getNodeStore();
  assertTrue(ns2.getRoot().hasChildNode("node"));
  NodeBuilder b2=ns2.getRoot().builder();
  b2.child("node").child("foo");
  merge(ns2,b2);
  ns2.runBackgroundOperations();
  Revision.resetClockToDefault();
  Revision.setClock(c1);
  ns1.runBackgroundOperations();
  b1=ns1.getRoot().builder();
  assertTrue(b1.getChildNode("node").hasChildNode("foo"));
  b1.child("node").remove();
  merge(ns1,b1);
  Revision.resetClockToDefault();
  Revision.setClock(c2);
  b2=ns2.getRoot().builder();
  b2.child("node").child("bar");
  try {
    merge(ns2,b2);
    fail("must fail with CommitFailedException");
  }
 catch (  CommitFailedException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.DocumentSplitTest </h4><pre class="type-9 type-12 type-5 type-7 type-6 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void cascadingWithSplitRatio(){
  String id=Utils.getIdFromPath("/test");
  mk.commit("/","+\"test\":{}",null,null);
  DocumentStore store=mk.getDocumentStore();
  int clusterId=mk.getNodeStore().getClusterId();
  UpdateOp op=new UpdateOp(id,false);
  for (int i=0; i < 1000; i++) {
    Revision r=Revision.newRevision(2);
    op.setMapEntry("prop",r,"some long test value with many characters");
    NodeDocument.setRevision(op,r,"c");
  }
  store.findAndUpdate(NODES,op);
  NodeDocument doc=store.find(NODES,id);
  assertNotNull(doc);
  assertTrue(doc.getMemory() > NodeDocument.DOC_SIZE_THRESHOLD);
  for (int i=0; i < NUM_REVS_THRESHOLD / 2; i++) {
    Revision r=Revision.newRevision(clusterId);
    op.setMapEntry("prop",r,"value");
    NodeDocument.setRevision(op,r,"c");
  }
  TreeSet<Revision> prev=Sets.newTreeSet(StableRevisionComparator.INSTANCE);
  for (int i=0; i < PREV_SPLIT_FACTOR; i++) {
    Revision low=Revision.newRevision(clusterId);
    Revision high=Revision.newRevision(clusterId);
    prev.add(high);
    NodeDocument.setPrevious(op,new Range(high,low,0));
  }
  store.findAndUpdate(NODES,op);
  doc=store.find(NODES,id);
  assertNotNull(doc);
  List<UpdateOp> splitOps=Lists.newArrayList(doc.split(mk.getNodeStore(),mk.getNodeStore().getHeadRevision()));
  assertEquals(2,splitOps.size());
  op=splitOps.get(0);
  String newPrevId=Utils.getPreviousIdFor("/test",prev.last(),1);
  assertEquals(newPrevId,op.getId());
  op=splitOps.get(1);
  assertEquals(id,op.getId());
  for (  Map.Entry<Key,Operation> entry : op.getChanges().entrySet()) {
    Revision r=entry.getKey().getRevision();
    assertNotNull(r);
    assertEquals(clusterId,r.getClusterId());
    if (entry.getKey().getName().equals("_prev")) {
      if (entry.getValue().type == REMOVE_MAP_ENTRY) {
        assertTrue(prev.contains(r));
      }
 else       if (entry.getValue().type == SET_MAP_ENTRY) {
        assertEquals(newPrevId,Utils.getPreviousIdFor("/test",r,1));
      }
 else {
        fail("unexpected update operation " + entry);
      }
    }
 else {
      fail("unexpected update operation " + entry);
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-12 type-5 type-6 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void readLocalCommitInfo() throws Exception {
  final Set<String> readSet=Sets.newHashSet();
  DocumentStore store=new MemoryDocumentStore(){
    @Override public <T extends Document>T find(    Collection<T> collection,    String key,    int maxCacheAge){
      readSet.add(key);
      return super.find(collection,key,maxCacheAge);
    }
  }
;
  DocumentNodeStore ns=new DocumentMK.Builder().setDocumentStore(store).setAsyncDelay(0).getNodeStore();
  NodeBuilder builder=ns.getRoot().builder();
  builder.child("test");
  ns.merge(builder,EmptyHook.INSTANCE,CommitInfo.EMPTY);
  for (int i=0; i < NUM_REVS_THRESHOLD; i++) {
    builder=ns.getRoot().builder();
    builder.setProperty("p",i);
    builder.child("test").setProperty("p",i);
    builder.child("test").setProperty("q",i);
    ns.merge(builder,EmptyHook.INSTANCE,CommitInfo.EMPTY);
  }
  builder=ns.getRoot().builder();
  builder.child("test").removeProperty("q");
  ns.merge(builder,EmptyHook.INSTANCE,CommitInfo.EMPTY);
  ns.runBackgroundOperations();
  NodeDocument doc=store.find(NODES,Utils.getIdFromPath("/test"));
  assertNotNull(doc);
  readSet.clear();
  doc.getNodeAtRevision(ns,ns.getHeadRevision(),null);
  for (  String id : Sets.newHashSet(readSet)) {
    doc=store.find(NODES,id);
    assertNotNull(doc);
    if (doc.isSplitDocument() && !doc.getMainPath().equals("/")) {
      fail("must not access previous document: " + id);
    }
  }
  ns.dispose();
}

</code></pre>

<br>
<pre class="type-5 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void purgeAllButMostRecentCommitRoot() throws Exception {
  DocumentStore store=mk.getDocumentStore();
  DocumentNodeStore ns1=mk.getNodeStore();
  NodeBuilder builder1=ns1.getRoot().builder();
  builder1.child("test");
  merge(ns1,builder1);
  ns1.runBackgroundOperations();
  DocumentNodeStore ns2=new DocumentMK.Builder().setDocumentStore(store).setAsyncDelay(0).setClusterId(ns1.getClusterId() + 1).getNodeStore();
  ns2.setMaxBackOffMillis(0);
  assertTrue(ns2.getRoot().hasChildNode("test"));
  NodeBuilder builder2=ns2.getRoot().builder();
  builder2.child("test").remove();
  for (int i=0; i < NUM_REVS_THRESHOLD * 2; i++) {
    builder1=ns1.getRoot().builder();
    builder1.child("test").child("child-" + i);
    merge(ns1,builder1);
  }
  ns1.runBackgroundOperations();
  try {
    merge(ns2,builder2);
    fail("merge must fail with CommitFailedException");
  }
 catch (  CommitFailedException e) {
  }
  ns2.dispose();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.HierarchyConflictTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void conflict2() throws Throwable {
  NodeBuilder root=store.getRoot().builder();
  root.child("foo").child("bar").child("baz");
  merge(store,root,null);
  final NodeBuilder r1=store.getRoot().builder();
  r1.child("addNode");
  NodeBuilder r2=store.getRoot().builder();
  r2.child("removeNode");
  final Thread t=new Thread(new Runnable(){
    @Override public void run(){
      try {
        merge(store,r1,new EditorCallback(){
          @Override public void edit(          NodeBuilder builder){
            builder.getChildNode("foo").getChildNode("bar").child("qux");
            nodeAdded.countDown();
            awaitUninterruptibly(nodeRemoved);
          }
        }
);
      }
 catch (      CommitFailedException e) {
        exceptions.add(e);
      }
    }
  }
);
  t.start();
  awaitUninterruptibly(nodeAdded);
  try {
    merge(store,r2,new EditorCallback(){
      @Override public void edit(      NodeBuilder builder){
        builder.getChildNode("foo").getChildNode("bar").remove();
        nodeRemoved.countDown();
        joinUninterruptibly(t);
      }
    }
);
    for (    Throwable ex : exceptions) {
      fail(ex.toString());
    }
    fail("Must fail with CommitFailedException. Cannot remove tree" + " when child is added concurrently");
  }
 catch (  CommitFailedException e) {
    LOG.info("expected: {}",e.toString());
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void conflict() throws Throwable {
  NodeBuilder root=store.getRoot().builder();
  root.child("foo").child("bar").child("baz");
  merge(store,root,null);
  NodeBuilder r1=store.getRoot().builder();
  r1.child("addNode");
  final NodeBuilder r2=store.getRoot().builder();
  r2.child("removeNode");
  final Thread t=new Thread(new Runnable(){
    @Override public void run(){
      try {
        merge(store,r2,new EditorCallback(){
          @Override public void edit(          NodeBuilder builder){
            builder.getChildNode("foo").getChildNode("bar").remove();
            nodeRemoved.countDown();
            awaitUninterruptibly(nodeAdded);
          }
        }
);
      }
 catch (      CommitFailedException e) {
        exceptions.add(e);
      }
    }
  }
);
  t.start();
  awaitUninterruptibly(nodeRemoved);
  try {
    merge(store,r1,new EditorCallback(){
      @Override public void edit(      NodeBuilder builder){
        builder.getChildNode("foo").getChildNode("bar").child("qux");
        nodeAdded.countDown();
        joinUninterruptibly(t);
      }
    }
);
    for (    Throwable ex : exceptions) {
      fail(ex.toString());
    }
    fail("Must fail with CommitFailedException. Cannot add child node" + " to a removed parent");
  }
 catch (  CommitFailedException e) {
    LOG.info("expected: {}",e.toString());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.LastRevRecoveryAgentTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void recoveryOfModifiedDocument() throws Exception {
  ds1.setMaxBackOffMillis(0);
  ds2.setMaxBackOffMillis(0);
  NodeBuilder b1=ds1.getRoot().builder();
  b1.child("x").child("y").setProperty("p","v1");
  merge(ds1,b1);
  ds1.runBackgroundOperations();
  ds2.runBackgroundOperations();
  NodeBuilder b2=ds2.getRoot().builder();
  b2.child("x").child("y").setProperty("p","v2");
  merge(ds2,b2);
  long leaseTime=ds2.getClusterInfo().getLeaseTime();
  clock.waitUntil(clock.getTime() + leaseTime * 2);
  b1=ds1.getRoot().builder();
  b1.child("x").child("y").setProperty("p","v11");
  try {
    merge(ds1,b1);
    fail("CommitFailedException expected");
  }
 catch (  CommitFailedException e) {
  }
  ds1.getLastRevRecoveryAgent().recover(2);
  ds1.runBackgroundOperations();
  b1=ds1.getRoot().builder();
  b1.child("x").child("y").setProperty("p","v11");
  merge(ds1,b1);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.MongoDocumentStoreIT </h4><pre class="type-5 type-7 type-6 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void modCount() throws Exception {
  DocumentStore docStore=mk.getDocumentStore();
  String head=mk.commit("/","+\"test\":{}",null,null);
  mk.commit("/test","^\"prop\":\"v1\"",head,null);
  mk.runBackgroundOperations();
  NodeDocument doc=docStore.find(NODES,Utils.getIdFromPath("/test"));
  assertNotNull(doc);
  Long mc1=doc.getModCount();
  assertNotNull(mc1);
  try {
    mk.commit("/test","^\"prop\":\"v2\"",head,null);
    fail();
  }
 catch (  DocumentStoreException e) {
  }
  doc=docStore.find(NODES,Utils.getIdFromPath("/test"));
  assertNotNull(doc);
  Long mc2=doc.getModCount();
  assertNotNull(mc2);
  assertTrue(mc2 > mc1);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.MultiDocumentStoreTest </h4><pre class="type-9 type-12 type-5 type-6 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void concurrentBatchUpdate() throws Exception {
  final CountDownLatch ready=new CountDownLatch(2);
  final CountDownLatch go=new CountDownLatch(1);
  final List<String> ids=Lists.newArrayList();
  for (int i=0; i < 100; i++) {
    ids.add(Utils.getIdFromPath("/node-" + i));
  }
  removeMe.addAll(ids);
  ds1.remove(Collection.NODES,ids);
  final List<Exception> exceptions=synchronizedList(new ArrayList<Exception>());
  final Map<String,NodeDocument> result1=Maps.newHashMap();
  Thread t1=new Thread(new Runnable(){
    @Override public void run(){
      try {
        List<UpdateOp> ops=Lists.newArrayList();
        for (        String id : ids) {
          UpdateOp op=new UpdateOp(id,true);
          op.set(Document.ID,id);
          op.set("_t1","value");
          ops.add(op);
        }
        Collections.shuffle(ops);
        ready.countDown();
        go.await();
        List<NodeDocument> docs=ds1.createOrUpdate(Collection.NODES,ops);
        for (int i=0; i < ops.size(); i++) {
          UpdateOp op=ops.get(i);
          result1.put(op.getId(),docs.get(i));
        }
      }
 catch (      Exception e) {
        exceptions.add(e);
      }
    }
  }
,"t1");
  final Map<String,NodeDocument> result2=Maps.newHashMap();
  Thread t2=new Thread(new Runnable(){
    @Override public void run(){
      try {
        List<UpdateOp> ops=Lists.newArrayList();
        for (        String id : ids) {
          UpdateOp op=new UpdateOp(id,true);
          op.set(Document.ID,id);
          op.set("_t2","value");
          ops.add(op);
        }
        Collections.shuffle(ops);
        ready.countDown();
        go.await();
        List<NodeDocument> docs=ds2.createOrUpdate(Collection.NODES,ops);
        for (int i=0; i < ops.size(); i++) {
          UpdateOp op=ops.get(i);
          result2.put(op.getId(),docs.get(i));
        }
      }
 catch (      Exception e) {
        exceptions.add(e);
      }
    }
  }
,"t2");
  t1.start();
  t2.start();
  ready.await();
  go.countDown();
  t1.join();
  t2.join();
  for (  Exception e : exceptions) {
    fail(e.toString());
  }
  for (  String id : ids) {
    NodeDocument d1=result1.get(id);
    NodeDocument d2=result2.get(id);
    if (d1 != null) {
      if (d2 != null) {
        fail("found " + id + " in both result sets, modcounts are: "+ d1.getModCount()+ "/"+ d2.getModCount());
      }
    }
 else {
      assertNotNull("id " + id + " is in neither result set",d2);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.NodeDocumentTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void getNewestRevisionCheckArgument() throws Exception {
  MemoryDocumentStore store=new MemoryDocumentStore();
  DocumentNodeStore ns=createTestStore(store,0,0);
  NodeBuilder builder=ns.getRoot().builder();
  builder.child("test");
  merge(ns,builder);
  Set<Revision> collisions=newHashSet();
  NodeDocument doc=store.find(NODES,Utils.getIdFromPath("/test"));
  RevisionVector branchBase=ns.getHeadRevision().asBranchRevision(ns.getClusterId());
  try {
    doc.getNewestRevision(ns,branchBase,ns.newRevision(),null,collisions);
    fail("Must fail with IllegalArgumentException");
  }
 catch (  IllegalArgumentException e) {
  }
  try {
    RevisionVector head=ns.getHeadRevision();
    Branch b=ns.getBranches().create(head,ns.newRevision(),null);
    doc.getNewestRevision(ns,head,ns.newRevision(),b,collisions);
    fail("Must fail with IllegalArgumentException");
  }
 catch (  IllegalArgumentException e) {
  }
  ns.dispose();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.RandomizedClusterTest </h4><pre class="type-13 type-12 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void addRemoveSet() throws Exception {
  for (int i=0; i < MK_COUNT; i++) {
    unseenChanges[i]=new HashSet<Integer>();
    mkList[i]=createMK(i);
    revList[i]=mkList[i].getHeadRevision();
  }
  HashMap<Integer,ClusterRev> revs=new HashMap<Integer,ClusterRev>();
  Random r=new Random(1);
  int operations=1000, nodeCount=10;
  int valueCount=10;
  int maxBackRev=20;
  log=new StringBuilder();
  try {
    int maskOk=0, maskFail=0;
    int opCount=6;
    nodeChange.clear();
    for (int i=0; i < operations; i++) {
      opId=i;
      mkId=r.nextInt(mkList.length);
      String node="t" + r.nextInt(nodeCount);
      String node2="t" + r.nextInt(nodeCount);
      String property="x";
      String value="" + r.nextInt(valueCount);
      String diff;
      int op=r.nextInt(opCount);
      if (i < 20) {
        op=0;
      }
      String result;
      boolean conflictExpected;
switch (op) {
case 0:
        diff="+ \"" + node + "\": { \""+ property+ "\": "+ value+ "}";
      log(diff);
    if (exists(node)) {
      log("already exists");
      result=null;
    }
 else {
      conflictExpected=isConflict(node);
      result=commit(diff,conflictExpected);
      if (result != null) {
        changes.put(i,Arrays.asList(new Op(mkId,node,value)));
        nodeChange.put(node,i);
      }
    }
  break;
case 1:
diff="- \"" + node + "\"";
log(diff);
if (exists(node)) {
conflictExpected=isConflict(node);
result=commit(diff,conflictExpected);
if (result != null) {
changes.put(i,Arrays.asList(new Op(mkId,node,null)));
nodeChange.put(node,i);
}
}
 else {
log("doesn't exist");
result=null;
}
break;
case 2:
diff="^ \"" + node + "/"+ property+ "\": "+ value;
log(diff);
if (exists(node)) {
conflictExpected=isConflict(node);
result=commit(diff,conflictExpected);
if (result != null) {
changes.put(i,Arrays.asList(new Op(mkId,node,value)));
nodeChange.put(node,i);
}
}
 else {
log("doesn't exist");
result=null;
}
break;
case 3:
diff="> \"" + node + "\": \""+ node2+ "\"";
log(diff);
if (exists(node) && !exists(node2)) {
conflictExpected=isConflict(node) | isConflict(node2);
result=commit(diff,conflictExpected);
if (result != null) {
value=getValue(mkId,i,node);
changes.put(i,Arrays.asList(new Op(mkId,node,null),new Op(mkId,node2,value)));
nodeChange.put(node,i);
nodeChange.put(node2,i);
}
}
 else {
log("source doesn't exist or target exists");
result=null;
}
break;
case 4:
if (isConflict(node)) {
result=null;
}
 else {
diff="* \"" + node + "\": \""+ node2+ "\"";
log(diff);
if (exists(node) && !exists(node2)) {
conflictExpected=isConflict(node2);
result=commit(diff,conflictExpected);
if (result != null) {
value=getValue(mkId,i,node);
changes.put(i,Arrays.asList(new Op(mkId,node2,value)));
nodeChange.put(node2,i);
}
}
 else {
log("source doesn't exist or target exists");
result=null;
}
}
break;
case 5:
log("sync/refresh");
syncAndRefreshAllClusterNodes();
result=revList[mkId]=mkList[mkId].getHeadRevision();
maskFail|=1 << op;
break;
default :
fail();
result=null;
}
if (result == null) {
maskFail|=1 << op;
log(" -> fail " + Integer.toBinaryString(maskFail));
}
 else {
maskOk|=1 << op;
log(" -> " + result);
for (int j=0; j < unseenChanges.length; j++) {
if (j != mkId) {
unseenChanges[j].add(i);
}
}
}
log("get " + node);
boolean x=get(i,node);
log("get " + node + " returns "+ x);
log("get " + node2);
x=get(i,node2);
log("get " + node2 + " returns "+ x);
DocumentMK mk=mkList[mkId];
ClusterRev cr=new ClusterRev();
cr.mkId=mkId;
cr.rev=mk.getHeadRevision();
revs.put(i,cr);
revs.remove(i - maxBackRev);
log.append('\n');
}
if (Integer.bitCount(maskOk) != opCount) {
fail("Not all operations were at least once successful: " + Integer.toBinaryString(maskOk));
}
if (Integer.bitCount(maskFail) != opCount) {
fail("Not all operations failed at least once: " + Integer.toBinaryString(maskFail));
}
}
 catch (AssertionError e) {
throw new Exception("log: " + log,e);
}
catch (Exception e) {
throw new Exception("log: " + log,e);
}
for (int i=0; i < MK_COUNT; i++) {
mkList[i].dispose();
}
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.RevisionTest </h4><pre class="type-13 type-5 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void compare() throws InterruptedException {
  Revision last=Revision.newRevision(0);
  try {
    last.compareRevisionTime(null);
    fail();
  }
 catch (  NullPointerException e) {
  }
  for (int i=0; i < 1000; i++) {
    Revision r=Revision.newRevision(0);
    assertTrue(r.compareRevisionTime(r) == 0);
    assertTrue(r.compareRevisionTime(last) > 0);
    assertTrue(last.compareRevisionTime(r) < 0);
    last=r;
    if (i % 100 == 0) {
      Thread.sleep(1);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.SimpleTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void conflict(){
  DocumentMK mk=createMK();
  mk.commit("/","+\"a\": {}",null,null);
  try {
    mk.commit("/","+\"b\": {}  +\"a\": {}",null,null);
    fail();
  }
 catch (  DocumentStoreException e) {
  }
  mk.commit("/","+\"b\": {}",null,null);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.UpdateOpTest </h4><pre class="type-9 type-5 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void notEqualsTest(){
  Revision r=Revision.newRevision(1);
  UpdateOp op=new UpdateOp("id",true);
  try {
    op.notEquals("p",r,"v");
    fail("expected " + IllegalStateException.class.getName());
  }
 catch (  IllegalStateException e) {
  }
  op=new UpdateOp("id",false);
  op.notEquals("p",r,"v");
  assertEquals(1,op.getConditions().size());
  UpdateOp.Key key=op.getConditions().keySet().iterator().next();
  assertEquals(r,key.getRevision());
  assertEquals("p",key.getName());
  UpdateOp.Condition c=op.getConditions().get(key);
  assertEquals(UpdateOp.Condition.Type.NOTEQUALS,c.type);
  assertEquals("v",c.value);
  op=new UpdateOp("id",false);
  op.notEquals("p",r,null);
  assertEquals(1,op.getConditions().size());
  key=op.getConditions().keySet().iterator().next();
  assertEquals(r,key.getRevision());
  assertEquals("p",key.getName());
  c=op.getConditions().get(key);
  assertEquals(UpdateOp.Condition.Type.NOTEQUALS,c.type);
  assertEquals(null,c.value);
}

</code></pre>

<br>
<pre class="type-9 type-5 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void equalsTest(){
  Revision r=Revision.newRevision(1);
  UpdateOp op=new UpdateOp("id",true);
  try {
    op.equals("p",r,"v");
    fail("expected " + IllegalStateException.class.getName());
  }
 catch (  IllegalStateException e) {
  }
  op=new UpdateOp("id",false);
  op.equals("p",r,"v");
  assertEquals(1,op.getConditions().size());
  UpdateOp.Key key=op.getConditions().keySet().iterator().next();
  assertEquals(r,key.getRevision());
  assertEquals("p",key.getName());
  UpdateOp.Condition c=op.getConditions().get(key);
  assertEquals(UpdateOp.Condition.Type.EQUALS,c.type);
  assertEquals("v",c.value);
}

</code></pre>

<br>
<pre class="type-9 type-5 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void containsMapEntry(){
  Revision r=Revision.newRevision(1);
  UpdateOp op=new UpdateOp("id",true);
  try {
    op.containsMapEntry("p",r,true);
    fail("expected " + IllegalStateException.class.getName());
  }
 catch (  IllegalStateException e) {
  }
  op=new UpdateOp("id",false);
  op.containsMapEntry("p",r,true);
  assertEquals(1,op.getConditions().size());
  UpdateOp.Key key=op.getConditions().keySet().iterator().next();
  assertEquals(r,key.getRevision());
  assertEquals("p",key.getName());
  UpdateOp.Condition c=op.getConditions().get(key);
  assertEquals(UpdateOp.Condition.EXISTS,c);
  op=new UpdateOp("id",false);
  op.containsMapEntry("p",r,false);
  assertEquals(1,op.getConditions().size());
  key=op.getConditions().keySet().iterator().next();
  assertEquals(r,key.getRevision());
  assertEquals("p",key.getName());
  c=op.getConditions().get(key);
  assertEquals(UpdateOp.Condition.MISSING,c);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.VersionGCDeletionTest </h4><pre class="type-5 type-6 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void deleteParentLast() throws Exception {
  TestDocumentStore ts=new TestDocumentStore();
  store=new DocumentMK.Builder().clock(clock).setDocumentStore(ts).setAsyncDelay(0).getNodeStore();
  clock.waitUntil(Revision.getCurrentTimestamp());
  NodeBuilder b1=store.getRoot().builder();
  b1.child("x").child("y");
  store.merge(b1,EmptyHook.INSTANCE,CommitInfo.EMPTY);
  long maxAge=1;
  long delta=TimeUnit.MINUTES.toMillis(10);
  NodeBuilder b2=store.getRoot().builder();
  b2.child("x").remove();
  store.merge(b2,EmptyHook.INSTANCE,CommitInfo.EMPTY);
  store.runBackgroundOperations();
  clock.waitUntil(clock.getTime() + HOURS.toMillis(maxAge * 2) + delta);
  VersionGarbageCollector gc=store.getVersionGarbageCollector();
  try {
    ts.throwException=true;
    gc.gc(maxAge * 2,HOURS);
    fail("Exception should be thrown");
  }
 catch (  AssertionError ignore) {
  }
  ts.throwException=false;
  gc.gc(maxAge * 2,HOURS);
  assertNull(ts.find(Collection.NODES,"2:/x/y"));
  assertNull(ts.find(Collection.NODES,"1:/x"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.blob.DocumentMKGetLengthGridFSTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void nonExistent() throws Exception {
  try {
    mk.getLength("nonExistentBlob");
    fail("Exception expected");
  }
 catch (  Exception expected) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.blob.DocumentMKGetLengthTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void nonExistent() throws Exception {
  try {
    mk.getLength("nonExistentBlob");
    fail("Exception expected");
  }
 catch (  Exception expected) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.locks.TreeNodeDocumentsLocksTest </h4><pre class="type-12 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * Test for the OAK-3949. It uses multiple threads to acquire a shared lock
 * collection. There's also another set of threads that acquires parent
 * locks exclusively. Such combination can't lead to a deadlock.
 */
@Test public void testBulkAcquire() throws InterruptedException {
  int threadCount=10;
  int locksCount=100;
  final TreeNodeDocumentLocks locks=new TreeNodeDocumentLocks();
  List<Thread> threads=new ArrayList<Thread>();
  for (int i=0; i < threadCount; i++) {
    final List<String> keys=new ArrayList<String>(locksCount);
    for (int j=0; j < locksCount; j++) {
      keys.add(String.format("2:/parent_%d/lock_%d",j,j));
    }
    threads.add(new Thread(new Runnable(){
      @Override public void run(){
        Lock lock=locks.acquire(keys);
        try {
          Thread.sleep(100);
        }
 catch (        InterruptedException e) {
        }
 finally {
          lock.unlock();
        }
      }
    }
));
  }
  for (int j=0; j < threadCount; j++) {
    final int from=j * 10;
    final int to=(j + 1) * 10;
    threads.add(new Thread(new Runnable(){
      @Override public void run(){
        try {
          for (int i=from; i < to; i++) {
            Lock parentLock=locks.acquireExclusive(String.format("1:/parent_%d",i));
            Thread.sleep(100);
            Lock childLock=locks.acquire(String.format("2:/parent_%d/lock_%d",i,i));
            Thread.sleep(100);
            childLock.unlock();
            Thread.sleep(100);
            parentLock.unlock();
          }
        }
 catch (        InterruptedException e) {
        }
      }
    }
));
  }
  Collections.shuffle(threads);
  for (  Thread t : threads) {
    t.start();
  }
  for (  Thread t : threads) {
    t.join(10000);
    if (t.isAlive()) {
      fail("Thread hasn't stopped in 10s");
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.mongo.ClusterConflictTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void mergeRetryWhileBackgroundRead() throws Exception {
  DocumentNodeStore ns1=mk.getNodeStore();
  NodeBuilder b1=ns1.getRoot().builder();
  b1.child("a").child("b").child("c").child("foo");
  merge(ns1,b1);
  ns1.runBackgroundOperations();
  ns2.runBackgroundOperations();
  NodeBuilder b2=ns2.getRoot().builder();
  assertNodeExists(b2,"/a/b/c/foo");
  b1=ns1.getRoot().builder();
  b1.child("a").child("b").child("c").remove();
  merge(ns1,b1);
  b2.child("z");
  merge(ns2,b2);
  runBackgroundUpdate(ns2);
  runBackgroundRead(ns1);
  runBackgroundUpdate(ns1);
  b2=ns2.getRoot().builder();
  b2.child("z").setProperty("q","v");
  try {
    ns2.merge(b2,new CommitHook(){
      @Nonnull @Override public NodeState processCommit(      NodeState before,      NodeState after,      CommitInfo info) throws CommitFailedException {
        runBackgroundRead(ns2);
        NodeBuilder builder=after.builder();
        if (builder.getChildNode("a").getChildNode("b").hasChildNode("c")) {
          builder.child("a").child("b").child("c").child("bar");
        }
 else {
          throw new CommitFailedException(CommitFailedException.OAK,0,"/a/b/c does not exist anymore");
        }
        return builder.getNodeState();
      }
    }
,CommitInfo.EMPTY);
    fail("Merge must fail with CommitFailedException");
  }
 catch (  CommitFailedException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.mongo.CollisionMarkerTest </h4><pre class="type-9 type-5 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void conditionalCollisionUpdate() throws Exception {
  NodeBuilder b1=ns1.getRoot().builder();
  b1.child("test");
  b1.child("node");
  merge(ns1,b1);
  ns1.runBackgroundOperations();
  ns2=newDocumentMK(connectionFactory.getConnection().getDB(),3).getNodeStore();
  b1=ns1.getRoot().builder();
  b1.child("node").child("foo");
  b1.child("test").setProperty("p",1);
  merge(ns1,b1);
  Revision head=ns1.getHeadRevision().getRevision(ns1.getClusterId());
  NodeBuilder b2=ns2.getRoot().builder();
  b2.child("node").child("bar");
  b2.child("test").setProperty("p",2);
  try {
    merge(ns2,b2);
    fail("must fail with CommitFailedException");
  }
 catch (  CommitFailedException e) {
  }
  String rootId=Utils.getIdFromPath("/");
  NodeDocument root=ns2.getDocumentStore().find(NODES,rootId);
  assertFalse("root document must not have a collision marker for a" + " committed revision",root.getValueMap(COLLISIONS).containsKey(head));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.mongo.MongoDocumentStoreTest </h4><pre class="type-13 type-12 type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void timeoutQuery(){
  String fromId=Utils.getKeyLowerLimit("/");
  String toId=Utils.getKeyUpperLimit("/");
  store.setMaxLockedQueryTimeMS(1);
  long index=0;
  for (int i=0; i < 100; i++) {
    StringBuilder sb=new StringBuilder();
    for (int j=0; j < 1000; j++) {
      sb.append("+\"node-").append(index++).append("\":{}");
    }
    mk.commit("/",sb.toString(),null,null);
    store.queriesWithoutLock.set(0);
    store.resetLockAcquisitionCount();
    List<NodeDocument> docs=store.query(Collection.NODES,fromId,toId,"foo",System.currentTimeMillis(),Integer.MAX_VALUE);
    assertTrue(docs.isEmpty());
    if (store.queriesWithoutLock.get() > 0) {
      assertEquals(1,store.getLockAcquisitionCount());
      return;
    }
  }
  fail("No query timeout triggered even after adding " + index + " nodes");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.mongo.RetryReadIT </h4><pre class="type-5 type-6 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void retry(){
  store.failRead=2;
  NodeDocument doc=store.find(NODES,Utils.getIdFromPath("/foo"));
  assertNull(doc);
  store.failRead=3;
  doc=store.find(NODES,Utils.getIdFromPath("/foo"));
  assertNull(doc);
  try {
    store.find(NODES,Utils.getIdFromPath("/bar"));
    fail("must fail with DocumentStoreException");
  }
 catch (  DocumentStoreException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.rdb.RDBDocumentSerializerTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testBrokenJSONUnquotedIdentifier() throws UnsupportedEncodingException {
  try {
    RDBRow row=new RDBRow("_foo",true,false,1,2,3,"{ x : 1, }",null);
    this.ser.fromRow(Collection.NODES,row);
    fail("should fail");
  }
 catch (  DocumentStoreException expected) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testBrokenJSONTrailingComma() throws UnsupportedEncodingException {
  try {
    RDBRow row=new RDBRow("_foo",true,false,1,2,3,"{ \"x\" : 1, }",null);
    this.ser.fromRow(Collection.NODES,row);
    fail("should fail");
  }
 catch (  DocumentStoreException expected) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testBlobAndDiffBorked() throws UnsupportedEncodingException {
  try {
    RDBRow row=new RDBRow("_foo",true,false,1,2,3,"[[\"\", \"\", \"\"]]","{}".getBytes("UTF-8"));
    this.ser.fromRow(Collection.NODES,row);
    fail("should fail");
  }
 catch (  DocumentStoreException expected) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testSimpleBoth() throws UnsupportedEncodingException {
  try {
    RDBRow row=new RDBRow("_foo",true,false,1,2,3,"{}","{}".getBytes("UTF-8"));
    this.ser.fromRow(Collection.NODES,row);
    fail("should fail");
  }
 catch (  DocumentStoreException expected) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.rdb.RDBDocumentStoreJDBCTest </h4><pre class="type-9 type-12 type-5 type-7 type-16 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void batchFailingInsertResult() throws SQLException {
  assumeTrue(super.dsf != DocumentStoreFixture.RDB_PG);
  String table=((RDBDocumentStore)super.ds).getTable(Collection.NODES).getName();
  Connection con=super.rdbDataSource.getConnection();
  con.setReadOnly(false);
  try {
    PreparedStatement st=con.prepareStatement("DELETE FROM " + table + " WHERE ID in (?, ?, ?)");
    setIdInStatement(st,1,"key-1");
    setIdInStatement(st,2,"key-2");
    setIdInStatement(st,3,"key-3");
    st.executeUpdate();
    st.close();
    con.commit();
    removeMe.add("key-3");
    st=con.prepareStatement("INSERT INTO " + table + " (id) VALUES (?)");
    setIdInStatement(st,1,"key-3");
    st.executeUpdate();
    st.close();
    con.commit();
    removeMe.add("key-1");
    removeMe.add("key-2");
    PreparedStatement batchSt=con.prepareStatement("INSERT INTO " + table + " (id) VALUES (?)");
    setIdInStatement(batchSt,1,"key-1");
    batchSt.addBatch();
    setIdInStatement(batchSt,1,"key-2");
    batchSt.addBatch();
    setIdInStatement(batchSt,1,"key-3");
    batchSt.addBatch();
    int[] batchResult=null;
    try {
      batchSt.executeBatch();
      fail("Batch operation should fail");
    }
 catch (    BatchUpdateException e) {
      batchResult=e.getUpdateCounts();
    }
    batchSt.close();
    con.commit();
    assertTrue(batchResult.length >= 2);
    assertTrue("Row should be inserted correctly.",isSuccess(batchResult[0]));
    assertTrue("Row should be inserted correctly.",isSuccess(batchResult[1]));
    if (batchResult.length == 3) {
      assertTrue("Row already exists, shouldn't be inserted.",!isSuccess(batchResult[2]));
    }
    PreparedStatement rst=con.prepareStatement("SELECT id FROM " + table + " WHERE id in (?, ?, ?)");
    setIdInStatement(rst,1,"key-1");
    setIdInStatement(rst,2,"key-2");
    setIdInStatement(rst,3,"key-3");
    ResultSet results=rst.executeQuery();
    Set<String> ids=new HashSet<String>();
    while (results.next()) {
      ids.add(getIdFromRS(results,1));
    }
    results.close();
    rst.close();
    assertEquals("Some of the rows weren't inserted.",of("key-1","key-2","key-3"),ids);
  }
  finally {
    con.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.identifier.IdentifierManagerTest </h4><pre class="type-5 type-6 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void getTreeTest(){
  assertEquals("/",identifierManager.getTree(ID_ROOT).getPath());
  assertEquals(PATH_X1,identifierManager.getTree(ID_X1).getPath());
  assertEquals(PATH_Y1,identifierManager.getTree(ID_Y1).getPath());
  assertEquals(PATH_Z1,identifierManager.getTree(ID_Z1).getPath());
  assertNull(identifierManager.getTree(ID_NON_EXISTING));
  try {
    identifierManager.getTree(ID_INVALID);
    fail("Expected IllegalArgumentException");
  }
 catch (  IllegalArgumentException expected) {
  }
}

</code></pre>

<br>
<pre class="type-5 type-6 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void getPathTest(){
  assertEquals("/",identifierManager.getPath(ID_ROOT));
  assertEquals(PATH_X1,identifierManager.getPath(ID_X1));
  assertEquals(PATH_Y1,identifierManager.getPath(ID_Y1));
  assertEquals(PATH_Z1,identifierManager.getPath(ID_Z1));
  assertNull(identifierManager.getPath(ID_NON_EXISTING));
  try {
    identifierManager.getPath(ID_INVALID);
    fail("Expected IllegalArgumentException");
  }
 catch (  IllegalArgumentException expected) {
  }
}

</code></pre>

<br>
<pre class="type-5 type-6 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void getPathFromPropertyTest(){
  assertEquals("/y",identifierManager.getPath(createReferenceProperty(UUID_Y)));
  assertEquals(PATH_Z1,identifierManager.getPath(createReferenceProperty(UUID_Z1)));
  assertNull(identifierManager.getPath(createReferenceProperty(ID_NON_EXISTING)));
  assertNull(identifierManager.getPath(createReferenceProperty(ID_INVALID)));
  try {
    identifierManager.getPath(PropertyStates.createProperty("any","any"));
    fail("Expected IllegalArgumentException");
  }
 catch (  IllegalArgumentException expected) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.index.IndexUpdateTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * OAK-3505 Provide an optionally stricter policy for missing synchronous
 * index editor providers
 */
@Test public void testMissingProviderFailsCommit() throws Exception {
  final IndexUpdateCallback noop=new IndexUpdateCallback(){
    @Override public void indexUpdate(){
    }
  }
;
  final MissingIndexProviderStrategy mips=new MissingIndexProviderStrategy();
  mips.setFailOnMissingIndexProvider(true);
  EditorHook hook=new EditorHook(new EditorProvider(){
    @Override public Editor getRootEditor(    NodeState before,    NodeState after,    NodeBuilder builder,    CommitInfo info) throws CommitFailedException {
      return new IndexUpdate(emptyProvider(),null,after,builder,noop).withMissingProviderStrategy(mips);
    }
  }
);
  NodeState before=builder.getNodeState();
  createIndexDefinition(builder.child(INDEX_DEFINITIONS_NAME),"rootIndex",true,false,ImmutableSet.of("foo"),null);
  builder.child(INDEX_DEFINITIONS_NAME).child("azerty");
  builder.child("testRoot").setProperty("foo","abc");
  NodeState after=builder.getNodeState();
  try {
    hook.processCommit(before,after,CommitInfo.EMPTY);
    fail("commit should fail on missing index provider");
  }
 catch (  CommitFailedException ex) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.index.PathFilterTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void invalid() throws Exception {
  try {
    new PathFilter(Collections.<String>emptyList(),of("/etc"));
    fail();
  }
 catch (  IllegalStateException ignore) {
  }
  try {
    new PathFilter(of("/etc/workflow"),of("/etc"));
    fail();
  }
 catch (  IllegalStateException ignore) {
  }
  try {
    new PathFilter(Collections.<String>emptyList(),Collections.<String>emptyList());
    fail();
  }
 catch (  IllegalStateException ignore) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.index.lucene.IndexCopierTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void cowFailureInCopy() throws Exception {
  ExecutorService executorService=Executors.newFixedThreadPool(2);
  Directory baseDir=new CloseSafeDir();
  IndexDefinition defn=new IndexDefinition(root,builder.getNodeState());
  IndexCopier copier=new RAMIndexCopier(baseDir,executorService,getWorkDir());
  final Set<String> toFail=Sets.newHashSet();
  Directory remote=new CloseSafeDir(){
    @Override public IndexOutput createOutput(    String name,    IOContext context) throws IOException {
      if (toFail.contains(name)) {
        throw new RuntimeException("Failing copy for " + name);
      }
      return super.createOutput(name,context);
    }
  }
;
  final Directory local=copier.wrapForWrite(defn,remote,false);
  toFail.add("t2");
  byte[] t1=writeFile(local,"t1");
  byte[] t2=writeFile(local,"t2");
  try {
    local.close();
    fail();
  }
 catch (  IOException ignore) {
  }
  executorService.shutdown();
}

</code></pre>

<br>
<pre class="type-5 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void nonExistentFile() throws Exception {
  Directory baseDir=new RAMDirectory();
  IndexDefinition defn=new IndexDefinition(root,builder.getNodeState());
  CollectingExecutor executor=new CollectingExecutor();
  IndexCopier c1=new RAMIndexCopier(baseDir,executor,getWorkDir(),true);
  Directory remote=new RAMDirectory();
  Directory wrapped=c1.wrapForRead("/foo",defn,remote);
  try {
    wrapped.openInput("foo.txt",IOContext.DEFAULT);
    fail();
  }
 catch (  FileNotFoundException ignore) {
  }
  assertEquals(0,executor.commands.size());
}

</code></pre>

<br>
<pre class="type-5 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void deleteCorruptedFile() throws Exception {
  Directory baseDir=new RAMDirectory();
  IndexDefinition defn=new IndexDefinition(root,builder.getNodeState());
  RAMIndexCopier c1=new RAMIndexCopier(baseDir,sameThreadExecutor(),getWorkDir());
  Directory remote=new RAMDirectory(){
    @Override public IndexInput openInput(    String name,    IOContext context) throws IOException {
      throw new IllegalStateException("boom");
    }
  }
;
  String fileName="failed.txt";
  Directory wrapped=c1.wrapForRead("/foo",defn,remote);
  byte[] t1=writeFile(remote,fileName);
  try {
    readAndAssert(wrapped,fileName,t1);
    fail("Read of file should have failed");
  }
 catch (  IllegalStateException ignore) {
  }
  assertFalse(c1.baseDir.fileExists(fileName));
}

</code></pre>

<br>
<pre class="type-9 type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void copyOnWriteBasics() throws Exception {
  Directory baseDir=new CloseSafeDir();
  IndexDefinition defn=new IndexDefinition(root,builder.getNodeState());
  IndexCopier copier=new RAMIndexCopier(baseDir,sameThreadExecutor(),getWorkDir());
  Directory remote=new RAMDirectory();
  byte[] t1=writeFile(remote,"t1");
  Directory local=copier.wrapForWrite(defn,remote,false);
  assertEquals(newHashSet("t1"),newHashSet(local.listAll()));
  assertEquals(t1.length,local.fileLength("t1"));
  byte[] t2=writeFile(local,"t2");
  assertEquals(newHashSet("t1","t2"),newHashSet(local.listAll()));
  assertEquals(t2.length,local.fileLength("t2"));
  assertTrue(local.fileExists("t1"));
  assertTrue(local.fileExists("t2"));
  assertTrue("t2 should be copied to remote",remote.fileExists("t2"));
  readAndAssert(local,"t1",t1);
  readAndAssert(local,"t2",t2);
  local.deleteFile("t1");
  assertEquals(newHashSet("t2"),newHashSet(local.listAll()));
  local.deleteFile("t2");
  assertEquals(newHashSet(),newHashSet(local.listAll()));
  try {
    local.fileLength("nonExistentFile");
    fail();
  }
 catch (  FileNotFoundException ignore) {
  }
  try {
    local.openInput("nonExistentFile",IOContext.DEFAULT);
    fail();
  }
 catch (  FileNotFoundException ignore) {
  }
  local.close();
  assertFalse(baseDir.fileExists("t2"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.index.lucene.LuceneIndexEditorTest </h4><pre class="type-5 type-3 type-14 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
@Test @Ignore("OAK-3072") public void copyOnWriteAndLocks() throws Exception {
  ExecutorService executorService=Executors.newFixedThreadPool(2);
  IndexCopier copier=new IndexCopier(executorService,temporaryFolder.getRoot());
  FailOnDemandEditorProvider failingProvider=new FailOnDemandEditorProvider();
  EditorHook hook=new EditorHook(new IndexUpdateProvider(new CompositeIndexEditorProvider(failingProvider,new LuceneIndexEditorProvider(copier))));
  NodeBuilder index=builder.child(INDEX_DEFINITIONS_NAME);
  NodeBuilder nb=newLuceneIndexDefinitionV2(index,"lucene",of(TYPENAME_STRING));
  nb.setProperty(LuceneIndexConstants.INDEX_PATH,"foo");
  IndexUtils.createIndexDefinition(index,"failingIndex",false,false,of("foo"),null);
  NodeState indexed=hook.processCommit(EMPTY_NODE,builder.getNodeState(),CommitInfo.EMPTY);
  builder=indexed.builder();
  NodeState before=indexed;
  builder.child("test").setProperty("a","fox is jumping");
  NodeState after=builder.getNodeState();
  failingProvider.setShouldFail(true);
  try {
    hook.processCommit(before,after,CommitInfo.EMPTY);
    fail();
  }
 catch (  CommitFailedException ignore) {
  }
  failingProvider.setShouldFail(false);
  hook.processCommit(before,after,CommitInfo.EMPTY);
  executorService.shutdown();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.index.lucene.LuceneIndexTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void multiValuesForOrderedIndexShouldNotThrow(){
  NodeBuilder index=newLuceneIndexDefinition(builder.child(INDEX_DEFINITIONS_NAME),"lucene",null);
  NodeBuilder singleProp=TestUtil.child(index,"indexRules/nt:base/properties/single");
  singleProp.setProperty(LuceneIndexConstants.PROP_PROPERTY_INDEX,true);
  singleProp.setProperty(LuceneIndexConstants.PROP_ORDERED,true);
  singleProp.setProperty(LuceneIndexConstants.PROP_INCLUDED_TYPE,PropertyType.TYPENAME_STRING);
  NodeState before=builder.getNodeState();
  builder.setProperty("single",asList("baz","bar"),Type.STRINGS);
  NodeState after=builder.getNodeState();
  try {
    HOOK.processCommit(before,after,CommitInfo.EMPTY);
  }
 catch (  CommitFailedException e) {
    fail("Exception thrown when indexing invalid content");
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void indexNodeLockHandling() throws Exception {
  IndexTracker tracker=new IndexTracker();
  NodeBuilder index=builder.child(INDEX_DEFINITIONS_NAME);
  NodeBuilder nb=newLuceneIndexDefinitionV2(index,"lucene",of(TYPENAME_STRING));
  nb.setProperty(LuceneIndexConstants.FULL_TEXT_ENABLED,false);
  nb.setProperty(createProperty(INCLUDE_PROPERTY_NAMES,of("foo"),STRINGS));
  index=builder.child("test").child(INDEX_DEFINITIONS_NAME);
  NodeBuilder nb2=newLuceneIndexDefinitionV2(index,"lucene",of(TYPENAME_STRING));
  nb2.setProperty(LuceneIndexConstants.FULL_TEXT_ENABLED,false);
  nb2.setProperty(createProperty(INCLUDE_PROPERTY_NAMES,of("foo"),STRINGS));
  NodeState before=builder.getNodeState();
  builder.child("test").setProperty("foo","fox is jumping");
  NodeState after=builder.getNodeState();
  NodeState indexed=HOOK.processCommit(before,after,CommitInfo.EMPTY);
  tracker.update(indexed);
  QueryIndex.AdvancedQueryIndex queryIndex=new LucenePropertyIndex(tracker);
  FilterImpl filter=createFilter(NT_BASE);
  filter.restrictPath("/test",Filter.PathRestriction.EXACT);
  filter.restrictProperty("foo",Operator.EQUAL,PropertyValues.newString("bar"));
  builder=indexed.builder();
  NodeBuilder dir=builder.child("oak:index").child("lucene").child(":data");
  List<Blob> blobs=new ArrayList<Blob>();
  Blob b=dir.child("segments_1").getProperty(JCR_DATA).getValue(Type.BINARY,0);
  FailingBlob fb=new FailingBlob(IOUtils.toByteArray(b.getNewStream()));
  blobs.add(fb);
  dir.child("segments_1").setProperty(JCR_DATA,blobs,BINARIES);
  indexed=builder.getNodeState();
  tracker.update(indexed);
  try {
    queryIndex.getPlans(filter,null,indexed);
    fail("Expecting UnsupportedOperationException exception");
  }
 catch (  UnsupportedOperationException ignore) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.index.lucene.OakDirectoryTest </h4><pre class="type-5 type-15 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void dirNameInException_Writes() throws Exception {
  FailOnDemandBlobStore blobStore=new FailOnDemandBlobStore();
  FileStore store=FileStore.newFileStore(tempFolder.getRoot()).withMemoryMapping(false).withBlobStore(blobStore).create();
  SegmentNodeStore nodeStore=SegmentNodeStore.newSegmentNodeStore(store).create();
  String indexPath="/foo/bar";
  int minFileSize=Segment.MEDIUM_LIMIT;
  int blobSize=minFileSize + 1000;
  builder=nodeStore.getRoot().builder();
  builder.setProperty(LuceneIndexConstants.INDEX_PATH,indexPath);
  builder.setProperty(LuceneIndexConstants.BLOB_SIZE,blobSize);
  Directory dir=createDir(builder,false);
  blobStore.startFailing();
  IndexOutput o=dir.createOutput("test1.txt",IOContext.DEFAULT);
  try {
    o.writeBytes(randomBytes(blobSize + 10),blobSize + 10);
    fail();
  }
 catch (  IOException e) {
    assertThat(e.getMessage(),containsString(indexPath));
    assertThat(e.getMessage(),containsString("test1.txt"));
  }
  blobStore.reset();
  IndexOutput o3=dir.createOutput("test3.txt",IOContext.DEFAULT);
  o3.writeBytes(randomBytes(minFileSize),minFileSize);
  blobStore.startFailing();
  try {
    o3.flush();
    fail();
  }
 catch (  IOException e) {
    assertThat(e.getMessage(),containsString(indexPath));
    assertThat(e.getMessage(),containsString("test3.txt"));
  }
}

</code></pre>

<br>
<pre class="type-5 type-15 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void dirNameInExceptionMessage() throws Exception {
  String indexPath="/foo/bar";
  builder.setProperty(LuceneIndexConstants.INDEX_PATH,indexPath);
  Directory dir=createDir(builder,false);
  try {
    dir.openInput("foo.txt",IOContext.DEFAULT);
    fail();
  }
 catch (  IOException e) {
    assertThat(e.getMessage(),containsString(indexPath));
  }
  int fileSize=createFile(dir,"test.txt");
  IndexInput in=dir.openInput("test.txt",IOContext.DEFAULT);
  try {
    in.seek(fileSize + 1);
    fail();
  }
 catch (  IOException e) {
    assertThat(e.getMessage(),containsString(indexPath));
  }
  IndexInput in2=dir.openInput("test.txt",IOContext.DEFAULT);
  try {
    byte[] data=new byte[fileSize + 1];
    in2.readBytes(data,0,fileSize + 1);
    fail();
  }
 catch (  IOException e) {
    assertThat(e.getMessage(),containsString(indexPath));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.index.property.AsyncPropertyIndexTest </h4><pre class="type-9 type-5 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAsyncPropertyLookup() throws Exception {
  NodeStore store=new MemoryNodeStore();
  NodeBuilder builder=store.getRoot().builder();
  NodeBuilder def=createIndexDefinition(builder.child(INDEX_DEFINITIONS_NAME),"foo",true,false,of("foo"),null);
  def.setProperty(REINDEX_ASYNC_PROPERTY_NAME,true);
  builder.child("a").setProperty("foo","abc");
  builder.child("b").setProperty("foo",Arrays.asList("abc","def"),STRINGS);
  NodeState head=store.merge(builder,hook,EMPTY);
  FilterImpl f=createFilter(head,NT_BASE);
  PropertyIndexLookup lookup=new PropertyIndexLookup(head);
  try {
    assertEquals(of(),find(lookup,"foo","abc",f));
    fail();
  }
 catch (  IllegalArgumentException e) {
  }
  AsyncIndexUpdate async=new AsyncIndexUpdate(ASYNC_REINDEX_VALUE,store,provider,true);
  async.run();
  assertEquals(ASYNC_REINDEX_VALUE,store.getRoot().getChildNode(INDEX_DEFINITIONS_NAME).getChildNode("foo").getString(ASYNC_PROPERTY_NAME));
  async.run();
  assertEquals(null,store.getRoot().getChildNode(INDEX_DEFINITIONS_NAME).getChildNode("foo").getString(ASYNC_PROPERTY_NAME));
  builder=store.getRoot().builder();
  builder.child("c").setProperty("foo","def");
  head=store.merge(builder,hook,EMPTY);
  f=createFilter(head,NT_BASE);
  lookup=new PropertyIndexLookup(head);
  assertEquals(ImmutableSet.of("b","c"),find(lookup,"foo","def",f));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.index.property.PropertyIndexQueryTest </h4><pre class="type-5 type-3 type-14 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
@Ignore("OAK-1517") @Test public void testInvalidNamespace() throws Exception {
  new Oak().with(new InitialContent()).with(new OpenSecurityProvider()).with(new PropertyIndexEditorProvider()).with(new RepositoryInitializer(){
    @Override public void initialize(    @Nonnull NodeBuilder builder){
      createIndexDefinition(builder.child(INDEX_DEFINITIONS_NAME),"foo",true,false,ImmutableSet.of("illegal:namespaceProperty"),null);
    }
  }
).createContentRepository();
  fail("creating an index definition with an illegal namespace should fail.");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.index.property.PropertyIndexTest </h4><pre class="type-9 type-5 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCustomConfigPropertyLookup() throws Exception {
  NodeState root=INITIAL_CONTENT;
  NodeBuilder builder=root.builder();
  createIndexDefinition(builder.child(INDEX_DEFINITIONS_NAME),"fooIndex",true,false,ImmutableSet.of("foo","extrafoo"),null);
  NodeState before=builder.getNodeState();
  builder.child("a").setProperty("foo","abc").setProperty("extrafoo","pqr");
  builder.child("b").setProperty("foo",Arrays.asList("abc","def"),Type.STRINGS);
  for (int i=0; i < MANY; i++) {
    builder.child("n" + i).setProperty("foo","xyz");
  }
  NodeState after=builder.getNodeState();
  NodeState indexed=HOOK.processCommit(before,after,CommitInfo.EMPTY);
  FilterImpl f=createFilter(indexed,NT_BASE);
  PropertyIndexLookup lookup=new PropertyIndexLookup(indexed);
  assertEquals(ImmutableSet.of("a","b"),find(lookup,"foo","abc",f));
  assertEquals(ImmutableSet.of("b"),find(lookup,"foo","def",f));
  assertEquals(ImmutableSet.of(),find(lookup,"foo","ghi",f));
  assertEquals(MANY,find(lookup,"foo","xyz",f).size());
  assertEquals(ImmutableSet.of("a"),find(lookup,"extrafoo","pqr",f));
  try {
    assertEquals(ImmutableSet.of(),find(lookup,"pqr","foo",f));
    fail();
  }
 catch (  IllegalArgumentException e) {
  }
}

</code></pre>

<br>
<pre class="type-9 type-5 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @see <a href="https://issues.apache.org/jira/browse/OAK-666">OAK-666:
     *      Property2Index: node type is used when indexing, but ignored when
     *      querying</a>
 */
@Test public void testCustomConfigNodeType() throws Exception {
  NodeState root=INITIAL_CONTENT;
  NodeBuilder builder=root.builder();
  NodeBuilder index=builder.child(INDEX_DEFINITIONS_NAME);
  createIndexDefinition(index,"fooIndex",true,false,ImmutableSet.of("foo","extrafoo"),ImmutableSet.of(NT_UNSTRUCTURED));
  createIndexDefinition(index,"fooIndexFile",true,false,ImmutableSet.of("foo"),ImmutableSet.of(NT_FILE));
  NodeState before=builder.getNodeState();
  builder.child("a").setProperty(JCR_PRIMARYTYPE,NT_UNSTRUCTURED,Type.NAME).setProperty("foo","abc");
  builder.child("b").setProperty(JCR_PRIMARYTYPE,NT_UNSTRUCTURED,Type.NAME).setProperty("foo",Arrays.asList("abc","def"),Type.STRINGS);
  NodeState after=builder.getNodeState();
  NodeState indexed=HOOK.processCommit(before,after,CommitInfo.EMPTY);
  FilterImpl f=createFilter(indexed,NT_UNSTRUCTURED);
  PropertyIndexLookup lookup=new PropertyIndexLookup(indexed);
  assertEquals(ImmutableSet.of("a","b"),find(lookup,"foo","abc",f));
  assertEquals(ImmutableSet.of("b"),find(lookup,"foo","def",f));
  assertEquals(ImmutableSet.of(),find(lookup,"foo","ghi",f));
  try {
    assertEquals(ImmutableSet.of(),find(lookup,"pqr","foo",f));
    fail();
  }
 catch (  IllegalArgumentException e) {
  }
}

</code></pre>

<br>
<pre class="type-9 type-5 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @see <a href="https://issues.apache.org/jira/browse/OAK-666">OAK-666:
     *      Property2Index: node type is used when indexing, but ignored when
     *      querying</a>
 */
@Test public void testCustomConfigNodeTypeFallback() throws Exception {
  NodeState root=EMPTY_NODE;
  NodeBuilder builder=root.builder();
  NodeBuilder index=builder.child(INDEX_DEFINITIONS_NAME);
  createIndexDefinition(index,"fooIndex",true,false,ImmutableSet.of("foo","extrafoo"),null);
  createIndexDefinition(index,"fooIndexFile",true,false,ImmutableSet.of("foo"),ImmutableSet.of(NT_FILE));
  NodeState before=builder.getNodeState();
  builder.child("a").setProperty(JCR_PRIMARYTYPE,NT_UNSTRUCTURED,Type.NAME).setProperty("foo","abc");
  builder.child("b").setProperty(JCR_PRIMARYTYPE,NT_UNSTRUCTURED,Type.NAME).setProperty("foo",Arrays.asList("abc","def"),Type.STRINGS);
  NodeState after=builder.getNodeState();
  NodeState indexed=HOOK.processCommit(before,after,CommitInfo.EMPTY);
  FilterImpl f=createFilter(after,NT_UNSTRUCTURED);
  PropertyIndexLookup lookup=new PropertyIndexLookup(indexed);
  assertEquals(ImmutableSet.of("a","b"),find(lookup,"foo","abc",f));
  assertEquals(ImmutableSet.of("b"),find(lookup,"foo","def",f));
  assertEquals(ImmutableSet.of(),find(lookup,"foo","ghi",f));
  try {
    assertEquals(ImmutableSet.of(),find(lookup,"pqr","foo",f));
    fail();
  }
 catch (  IllegalArgumentException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.index.property.ValuePathTupleTest </h4><pre class="type-5 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * testing for asserting the right comparison behaviour of the custom class
 */
@Test public void valuePathTupleComparison(){
  try {
    new ValuePathTuple("value","path").compareTo(null);
    fail("It should have raised a NPE");
  }
 catch (  NullPointerException e) {
  }
  assertEquals(0,(new ValuePathTuple("value","path")).compareTo(new ValuePathTuple("value","path")));
  assertEquals(-1,(new ValuePathTuple("value","path")).compareTo(new ValuePathTuple("value1","path")));
  assertEquals(-1,(new ValuePathTuple("value1","path")).compareTo(new ValuePathTuple("value1","path1")));
  assertEquals(1,(new ValuePathTuple("value1","path")).compareTo(new ValuePathTuple("value","path")));
  assertEquals(1,(new ValuePathTuple("value1","path1")).compareTo(new ValuePathTuple("value1","path")));
  assertEquals(-1,(new ValuePathTuple("value000","/test/n1")).compareTo(new ValuePathTuple("value001","/test/n0")));
  assertEquals(1,(new ValuePathTuple("value001","/test/n0")).compareTo(new ValuePathTuple("value000","/test/n1")));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.index.solr.configuration.nodestate.OakSolrNodeStateConfigurationTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testWrongNodeState() throws Exception {
  NodeState idxDef=store.getRoot().getChildNode("x");
  try {
    new OakSolrNodeStateConfiguration(idxDef);
    fail();
  }
 catch (  IllegalArgumentException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.memory.MemoryNodeBuilderTest </h4><pre class="type-5 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWriteOnRemoveNode(){
  for (  String name : new String[]{"x","new"}) {
    NodeBuilder root=base.builder();
    NodeBuilder child=root.child(name);
    root.getChildNode(name).remove();
    try {
      child.setProperty("q","w");
      fail();
    }
 catch (    IllegalStateException e) {
    }
    root.child(name);
    assertEquals(0,child.getChildNodeCount(1));
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void getNonExistingChildTest(){
  NodeBuilder rootBuilder=base.builder();
  NodeBuilder any=rootBuilder.getChildNode("any");
  assertFalse(any.getChildNode("other").exists());
  assertFalse(any.exists());
  try {
    any.setChildNode("any");
    fail();
  }
 catch (  IllegalStateException expected) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.nodetype.TypeEditorTest </h4><pre class="type-5 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void changeNamedPropertyToBadRequiredType(){
  EditorHook hook=new EditorHook(new TypeEditorProvider());
  NodeState root=INITIAL_CONTENT;
  NodeBuilder builder=root.builder();
  NodeBuilder testNode=builder.child("testNode");
  testNode.setProperty(JCR_PRIMARYTYPE,NT_FOLDER,Type.NAME);
  testNode.setProperty(JCR_MIXINTYPES,ImmutableList.of("mix:title"),Type.NAMES);
  testNode.setProperty("jcr:title","title");
  NodeState before=builder.getNodeState();
  testNode.setProperty("jcr:title",true);
  try {
    hook.processCommit(before,builder.getNodeState(),CommitInfo.EMPTY);
    fail();
  }
 catch (  CommitFailedException e) {
    assertTrue(e.isConstraintViolation());
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void addNamedPropertyWithBadRequiredType(){
  EditorHook hook=new EditorHook(new TypeEditorProvider());
  NodeState root=INITIAL_CONTENT;
  NodeBuilder builder=root.builder();
  NodeState before=builder.getNodeState();
  NodeBuilder testNode=builder.child("testNode");
  testNode.setProperty(JCR_PRIMARYTYPE,NT_FOLDER,Type.NAME);
  testNode.setProperty(JCR_MIXINTYPES,ImmutableList.of("mix:title"),Type.NAMES);
  testNode.setProperty("jcr:title",true);
  try {
    hook.processCommit(before,builder.getNodeState(),CommitInfo.EMPTY);
    fail();
  }
 catch (  CommitFailedException e) {
    assertTrue(e.isConstraintViolation());
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void addMandatoryPropertyWithBadRequiredType(){
  EditorHook hook=new EditorHook(new TypeEditorProvider());
  NodeState root=INITIAL_CONTENT;
  NodeBuilder builder=root.builder();
  NodeState before=builder.getNodeState();
  NodeBuilder acl=builder.child(AccessControlConstants.REP_POLICY);
  acl.setProperty(JCR_PRIMARYTYPE,AccessControlConstants.NT_REP_ACL,Type.NAME);
  NodeBuilder ace=acl.child("first");
  ace.setProperty(JCR_PRIMARYTYPE,AccessControlConstants.NT_REP_GRANT_ACE,Type.NAME);
  ace.setProperty(AccessControlConstants.REP_PRINCIPAL_NAME,EveryonePrincipal.NAME);
  ace.setProperty(AccessControlConstants.REP_PRIVILEGES,ImmutableList.of(PrivilegeConstants.JCR_READ),Type.STRINGS);
  try {
    hook.processCommit(before,builder.getNodeState(),CommitInfo.EMPTY);
    fail();
  }
 catch (  CommitFailedException e) {
    assertTrue(e.isConstraintViolation());
    assertEquals(55,e.getCode());
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void changeMandatoryPropertyToBadRequiredType(){
  EditorHook hook=new EditorHook(new TypeEditorProvider());
  NodeState root=INITIAL_CONTENT;
  NodeBuilder builder=root.builder();
  NodeBuilder acl=builder.child(AccessControlConstants.REP_POLICY);
  acl.setProperty(JCR_PRIMARYTYPE,AccessControlConstants.NT_REP_ACL,Type.NAME);
  NodeBuilder ace=acl.child("first");
  ace.setProperty(JCR_PRIMARYTYPE,AccessControlConstants.NT_REP_GRANT_ACE,Type.NAME);
  ace.setProperty(AccessControlConstants.REP_PRINCIPAL_NAME,EveryonePrincipal.NAME);
  ace.setProperty(AccessControlConstants.REP_PRIVILEGES,ImmutableList.of(PrivilegeConstants.JCR_READ),Type.NAMES);
  NodeState before=builder.getNodeState();
  ace.setProperty(AccessControlConstants.REP_PRIVILEGES,ImmutableList.of(PrivilegeConstants.JCR_READ),Type.STRINGS);
  try {
    hook.processCommit(before,builder.getNodeState(),CommitInfo.EMPTY);
    fail();
  }
 catch (  CommitFailedException e) {
    assertTrue(e.isConstraintViolation());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.segment.CompactionAndCleanupIT </h4><pre class="type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void propertyRetention() throws IOException, CommitFailedException {
  FileStore fileStore=new NonCachingFileStore(directory,1);
  try {
    final SegmentNodeStore nodeStore=new SegmentNodeStore(fileStore);
    CompactionStrategy strategy=new CompactionStrategy(false,false,CLEAN_ALL,0,(byte)0){
      @Override public boolean compacted(      @Nonnull Callable<Boolean> setHead) throws Exception {
        return nodeStore.locked(setHead);
      }
    }
;
    strategy.setPersistCompactionMap(false);
    fileStore.setCompactionStrategy(strategy);
    NodeBuilder builder=nodeStore.getRoot().builder();
    builder.setChildNode("test").setProperty("property","value");
    nodeStore.merge(builder,EmptyHook.INSTANCE,CommitInfo.EMPTY);
    NodeState test=nodeStore.getRoot().getChildNode("test");
    SegmentId id=((SegmentNodeState)test).getRecordId().getSegmentId();
    assertTrue(fileStore.containsSegment(id));
    builder=nodeStore.getRoot().builder();
    addContent(builder.setChildNode("dump"));
    nodeStore.merge(builder,EmptyHook.INSTANCE,CommitInfo.EMPTY);
    assertTrue(fileStore.containsSegment(id));
    PropertyState property=test.getProperty("property");
    assertEquals("value",property.getValue(STRING));
    fileStore.flush();
    fileStore.compact();
    fileStore.cleanup();
    try {
      fileStore.readSegment(id);
      fail("Segment " + id + "should be gc'ed");
    }
 catch (    SegmentNotFoundException ignore) {
    }
  }
  finally {
    fileStore.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.segment.MergeTest </h4><pre class="type-13 type-5 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPessimisticMerge() throws Exception {
  final SegmentNodeStore store=new SegmentNodeStore(new MemoryStore());
  final Semaphore semaphore=new Semaphore(0);
  final AtomicBoolean running=new AtomicBoolean(true);
  Thread background=new Thread(){
    @Override public void run(){
      for (int i=0; running.get(); i++) {
        try {
          NodeBuilder a=store.getRoot().builder();
          a.setProperty("foo","abc" + i);
          store.merge(a,EmptyHook.INSTANCE,CommitInfo.EMPTY);
          semaphore.release();
        }
 catch (        CommitFailedException e) {
          fail();
        }
      }
    }
  }
;
  background.start();
  semaphore.acquire();
  assertTrue(store.getRoot().hasProperty("foo"));
  assertFalse(store.getRoot().hasProperty("bar"));
  NodeBuilder b=store.getRoot().builder();
  b.setProperty("bar","xyz");
  store.setMaximumBackoff(100);
  store.merge(b,new CommitHook(){
    @Override @Nonnull public NodeState processCommit(    NodeState before,    NodeState after,    CommitInfo info){
      try {
        Thread.sleep(100);
      }
 catch (      InterruptedException e) {
        fail();
      }
      return after;
    }
  }
,CommitInfo.EMPTY);
  assertTrue(store.getRoot().hasProperty("foo"));
  assertTrue(store.getRoot().hasProperty("bar"));
  running.set(false);
  background.join();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.segment.RecordIdMapTest </h4><pre class="type-5 type-7 type-6 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEmpty(){
  RecordIdMap map=new RecordIdMap();
  assertFalse(map.containsKey((short)0));
  assertNull(map.get((short)0));
  assertEquals(0,map.size());
  try {
    map.getKey(0);
    fail("Expected AIOBE");
  }
 catch (  ArrayIndexOutOfBoundsException ignored) {
  }
  try {
    map.getRecordId(0);
    fail("Expected AIOBE");
  }
 catch (  ArrayIndexOutOfBoundsException ignored) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.segment.RecordTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMultiValuedBinaryPropertyAcrossSegments() throws IOException {
  byte[] data=new byte[Segment.MEDIUM_LIMIT - 1];
  random.nextBytes(data);
  List<Blob> blobs=newArrayList();
  while (blobs.size() * data.length < Segment.MAX_SEGMENT_SIZE) {
    blobs.add(writer.writeStream(new ByteArrayInputStream(data)));
  }
  NodeBuilder builder=EMPTY_NODE.builder();
  builder.setProperty("test",blobs,BINARIES);
  NodeState state=writer.writeNode(builder.getNodeState());
  for (  Blob blob : state.getProperty("test").getValue(BINARIES)) {
    try {
      blob.getNewStream().close();
    }
 catch (    IllegalStateException e) {
      fail("OAK-1374");
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.segment.SegmentIdTableTest </h4><pre class="type-9 type-5 type-6 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * OAK-2752
 */
@Test public void endlessSearchLoop() throws IOException {
  SegmentTracker tracker=new MemoryStore().getTracker();
  final SegmentIdTable tbl=new SegmentIdTable(tracker);
  List<SegmentId> refs=new ArrayList<SegmentId>();
  for (int i=0; i < 1024; i++) {
    refs.add(tbl.getSegmentId(i,i % 64));
  }
  Callable<SegmentId> c=new Callable<SegmentId>(){
    @Override public SegmentId call() throws Exception {
      return tbl.getSegmentId(2,1);
    }
  }
;
  Future<SegmentId> f=Executors.newSingleThreadExecutor().submit(c);
  SegmentId s=null;
  try {
    s=f.get(5,TimeUnit.SECONDS);
  }
 catch (  Exception e) {
    Assert.fail(e.getMessage());
  }
  Assert.assertNotNull(s);
  Assert.assertEquals(2,s.getMostSignificantBits());
  Assert.assertEquals(1,s.getLeastSignificantBits());
}

</code></pre>

<br>
<pre class="type-13 type-12 type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void gc() throws IOException {
  SegmentTracker tracker=new MemoryStore().getTracker();
  final SegmentIdTable tbl=new SegmentIdTable(tracker);
  List<SegmentId> refs=new ArrayList<SegmentId>();
  int originalCount=1024;
  for (int i=0; i < originalCount; i++) {
    refs.add(tbl.getSegmentId(i,i % 128));
  }
  Assert.assertEquals(originalCount,tbl.getEntryCount());
  Assert.assertEquals(1,tbl.getMapRebuildCount());
  for (int i=0; i < refs.size() / 2; i++) {
    refs.remove(0);
  }
  for (int gcCalls=0; ; gcCalls++) {
    System.gc();
    for (    SegmentId id : refs) {
      SegmentId id2=tbl.getSegmentId(id.getMostSignificantBits(),id.getLeastSignificantBits());
      Assert.assertTrue(id2 == id);
    }
    Assert.assertEquals(1,tbl.getMapRebuildCount());
    for (int i=0; i < 10; i++) {
      tbl.getSegmentId(i,i);
    }
    if (tbl.getEntryCount() < originalCount) {
      break;
    }
 else     if (gcCalls > 10) {
      fail("No entries were garbage collected after 10 times System.gc()");
    }
  }
  Assert.assertEquals(2,tbl.getMapRebuildCount());
}

</code></pre>

<br>
<pre class="type-12 type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void clearTable() throws IOException {
  SegmentTracker tracker=new MemoryStore().getTracker();
  final SegmentIdTable tbl=new SegmentIdTable(tracker);
  List<SegmentId> refs=new ArrayList<SegmentId>();
  int originalCount=8;
  for (int i=0; i < originalCount; i++) {
    refs.add(tbl.getSegmentId(i,i % 2));
  }
  Assert.assertEquals(originalCount,tbl.getEntryCount());
  Assert.assertEquals(0,tbl.getMapRebuildCount());
  tbl.clearSegmentIdTables(new CompactionStrategy(false,false,CleanupType.CLEAN_NONE,originalCount,(byte)0){
    @Override public boolean compacted(    @Nonnull Callable<Boolean> setHead) throws Exception {
      return true;
    }
    @Override public boolean canRemove(    SegmentId id){
      return id.getMostSignificantBits() < 4;
    }
  }
);
  Assert.assertEquals(4,tbl.getEntryCount());
  for (  SegmentId id : refs) {
    if (id.getMostSignificantBits() >= 4) {
      SegmentId id2=tbl.getSegmentId(id.getMostSignificantBits(),id.getLeastSignificantBits());
      List<SegmentId> list=tbl.getRawSegmentIdList();
      if (list.size() != new HashSet<SegmentId>(list).size()) {
        Collections.sort(list);
        fail("duplicate entry " + list.toString());
      }
      Assert.assertTrue(id == id2);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.segment.SegmentVersionTest </h4><pre class="type-5 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void compareOldRevision() throws Exception {
  FileStore fileStoreV10=new FileStore(directory,1){
    @SuppressWarnings("deprecation") @Override public SegmentVersion getVersion(){
      return SegmentVersion.V_10;
    }
  }
;
  try {
    NodeState content=addTestContent(fileStoreV10,"content").getChildNode("content");
    assertVersion(content,SegmentVersion.V_10);
    NodeBuilder builder=content.builder();
    builder.setChildNode("foo");
    content.compareAgainstBaseState(builder.getNodeState(),new NodeStateDiff(){
      @Override public boolean propertyAdded(      PropertyState after){
        fail();
        return false;
      }
      @Override public boolean propertyChanged(      PropertyState before,      PropertyState after){
        fail();
        return false;
      }
      @Override public boolean propertyDeleted(      PropertyState before){
        fail();
        return false;
      }
      @Override public boolean childNodeAdded(      String name,      NodeState after){
        fail();
        return false;
      }
      @Override public boolean childNodeChanged(      String name,      NodeState before,      NodeState after){
        fail();
        return false;
      }
      @Override public boolean childNodeDeleted(      String name,      NodeState before){
        assertEquals("foo",name);
        return false;
      }
    }
);
  }
  finally {
    fileStoreV10.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.segment.standby.MBeanTest </h4><pre class="type-9 type-12 type-5 type-7 type-6 type-4 type-8 type-3 type-14 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
@Test @Ignore("OAK-2086") public void testClientAndServerEmptyConfig() throws Exception {
  final StandbyServer server=new StandbyServer(port,this.storeS);
  server.start();
  System.setProperty(StandbyClient.CLIENT_ID_PROPERTY_NAME,"Bar");
  final StandbyClient client=newStandbyClient(storeC);
  client.start();
  final MBeanServer jmxServer=ManagementFactory.getPlatformMBeanServer();
  ObjectName status=new ObjectName(StandbyStatusMBean.JMX_NAME + ",id=*");
  ObjectName clientStatus=new ObjectName(client.getMBeanName());
  ObjectName serverStatus=new ObjectName(server.getMBeanName());
  try {
    Set<ObjectName> instances=jmxServer.queryNames(status,null);
    assertEquals(3,instances.size());
    ObjectName connectionStatus=null;
    for (    ObjectName s : instances) {
      if (!s.equals(clientStatus) && !s.equals(serverStatus))       connectionStatus=s;
    }
    assertNotNull(connectionStatus);
    assertTrue(jmxServer.isRegistered(clientStatus));
    assertTrue(jmxServer.isRegistered(serverStatus));
    assertTrue(jmxServer.isRegistered(connectionStatus));
    String m=jmxServer.getAttribute(clientStatus,"Mode").toString();
    if (!m.startsWith("client: "))     fail("unexpected mode " + m);
    assertEquals("master",jmxServer.getAttribute(serverStatus,"Mode"));
    assertEquals(true,jmxServer.getAttribute(serverStatus,"Running"));
    assertEquals(true,jmxServer.getAttribute(clientStatus,"Running"));
    assertEquals("0",jmxServer.getAttribute(clientStatus,"FailedRequests").toString());
    assertEquals("0",jmxServer.getAttribute(clientStatus,"SecondsSinceLastSuccess").toString());
    assertEquals("0",jmxServer.invoke(clientStatus,"calcFailedRequests",null,null).toString());
    assertEquals("0",jmxServer.invoke(clientStatus,"calcSecondsSinceLastSuccess",null,null).toString());
    Thread.sleep(1000);
    assertEquals("0",jmxServer.getAttribute(clientStatus,"FailedRequests").toString());
    assertEquals("1",jmxServer.getAttribute(clientStatus,"SecondsSinceLastSuccess").toString());
    assertEquals("0",jmxServer.invoke(clientStatus,"calcFailedRequests",null,null).toString());
    assertEquals("1",jmxServer.invoke(clientStatus,"calcSecondsSinceLastSuccess",null,null).toString());
    assertEquals(new Long(2),jmxServer.getAttribute(connectionStatus,"TransferredSegments"));
    assertEquals(new Long(128),jmxServer.getAttribute(connectionStatus,"TransferredSegmentBytes"));
    jmxServer.invoke(serverStatus,"stop",null,null);
    assertEquals(false,jmxServer.getAttribute(serverStatus,"Running"));
    m=jmxServer.getAttribute(serverStatus,"Status").toString();
    if (!m.equals(StandbyStatusMBean.STATUS_STOPPED) && !m.equals("channel unregistered"))     fail("unexpected Status" + m);
    jmxServer.invoke(serverStatus,"start",null,null);
    assertEquals(true,jmxServer.getAttribute(serverStatus,"Running"));
    assertEquals(true,jmxServer.getAttribute(clientStatus,"Running"));
    m=jmxServer.getAttribute(serverStatus,"Status").toString();
    if (!m.equals(StandbyStatusMBean.STATUS_STARTING) && !m.equals("channel unregistered"))     fail("unexpected Status" + m);
    jmxServer.invoke(clientStatus,"stop",null,null);
    assertEquals(true,jmxServer.getAttribute(serverStatus,"Running"));
    assertEquals(false,jmxServer.getAttribute(clientStatus,"Running"));
    assertEquals(StandbyStatusMBean.STATUS_STOPPED,jmxServer.getAttribute(clientStatus,"Status"));
    jmxServer.invoke(clientStatus,"start",null,null);
    assertEquals(true,jmxServer.getAttribute(clientStatus,"Running"));
    assertEquals(StandbyStatusMBean.STATUS_RUNNING,jmxServer.getAttribute(clientStatus,"Status"));
  }
  finally {
    client.close();
    server.close();
  }
  assertTrue(!jmxServer.isRegistered(clientStatus));
  assertTrue(!jmxServer.isRegistered(serverStatus));
}

</code></pre>

<br>
<pre class="type-9 type-12 type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testServerEmptyConfig() throws Exception {
  final StandbyServer server=new StandbyServer(this.port,this.storeS);
  server.start();
  final MBeanServer jmxServer=ManagementFactory.getPlatformMBeanServer();
  ObjectName status=new ObjectName(StandbyStatusMBean.JMX_NAME + ",id=*");
  try {
    Set<ObjectName> instances=jmxServer.queryNames(status,null);
    assertEquals(1,instances.size());
    status=instances.toArray(new ObjectName[0])[0];
    assertEquals(new ObjectName(server.getMBeanName()),status);
    assertTrue(jmxServer.isRegistered(status));
    assertEquals("primary",jmxServer.getAttribute(status,"Mode"));
    String m=jmxServer.getAttribute(status,"Status").toString();
    if (!m.equals(StandbyStatusMBean.STATUS_STARTING) && !m.equals("channel unregistered"))     fail("unexpected Status " + m);
    assertEquals(StandbyStatusMBean.STATUS_STARTING,jmxServer.getAttribute(status,"Status"));
    assertEquals(true,jmxServer.getAttribute(status,"Running"));
    jmxServer.invoke(status,"stop",null,null);
    assertEquals(false,jmxServer.getAttribute(status,"Running"));
    assertEquals(StandbyStatusMBean.STATUS_STOPPED,jmxServer.getAttribute(status,"Status"));
    jmxServer.invoke(status,"start",null,null);
    assertEquals(true,jmxServer.getAttribute(status,"Running"));
    assertEquals(StandbyStatusMBean.STATUS_RUNNING,jmxServer.getAttribute(status,"Status"));
  }
  finally {
    server.close();
  }
  assertTrue(!jmxServer.isRegistered(status));
}

</code></pre>

<br>
<pre class="type-9 type-12 type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testClientEmptyConfigNoServer() throws Exception {
  final StandbyClient client=newStandbyClient(storeC);
  client.start();
  final MBeanServer jmxServer=ManagementFactory.getPlatformMBeanServer();
  ObjectName status=new ObjectName(StandbyStatusMBean.JMX_NAME + ",id=*");
  try {
    Set<ObjectName> instances=jmxServer.queryNames(status,null);
    assertEquals(1,instances.size());
    status=instances.toArray(new ObjectName[0])[0];
    assertEquals(new ObjectName(client.getMBeanName()),status);
    assertTrue(jmxServer.isRegistered(status));
    String m=jmxServer.getAttribute(status,"Mode").toString();
    if (!m.startsWith("client: "))     fail("unexpected mode " + m);
    assertEquals("0",jmxServer.getAttribute(status,"FailedRequests").toString());
    assertEquals("-1",jmxServer.getAttribute(status,"SecondsSinceLastSuccess").toString());
    assertEquals(StandbyStatusMBean.STATUS_INITIALIZING,jmxServer.getAttribute(status,"Status"));
    assertEquals(false,jmxServer.getAttribute(status,"Running"));
    jmxServer.invoke(status,"stop",null,null);
    assertEquals(false,jmxServer.getAttribute(status,"Running"));
    assertEquals(StandbyStatusMBean.STATUS_STOPPED,jmxServer.getAttribute(status,"Status"));
    jmxServer.invoke(status,"start",null,null);
    assertEquals(false,jmxServer.getAttribute(status,"Running"));
    assertEquals(StandbyStatusMBean.STATUS_STOPPED,jmxServer.getAttribute(status,"Status"));
  }
  finally {
    client.close();
  }
  assertTrue(!jmxServer.isRegistered(status));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.value.BinaryBasedBlobTest </h4><pre class="type-5 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void getStreamWithError() throws IOException {
  Blob blob=new BinaryBasedBlob(new FailingBinary());
  assertEquals(-1,blob.length());
  InputStream ins=blob.getNewStream();
  try {
    ins.read();
    fail();
  }
 catch (  IOException ignored) {
  }
 finally {
    ins.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.query.index.FilterTest </h4><pre class="type-13 type-9 type-12 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void pathRestrictionsRandomized() throws Exception {
  ArrayList<String> paths=new ArrayList<String>();
  paths.add("/");
  for (int i='a'; i <= 'c'; i++) {
    String p1="/" + (char)i;
    paths.add(p1);
    for (int j='a'; j <= 'c'; j++) {
      String p2="/" + (char)j;
      paths.add(p1 + p2);
      for (int k='a'; k <= 'c'; k++) {
        String p3="/" + (char)k;
        paths.add(p1 + p2 + p3);
      }
    }
  }
  Random r=new Random(1);
  for (int i=0; i < 10000; i++) {
    String p1=paths.get(r.nextInt(paths.size()));
    String p2=paths.get(r.nextInt(paths.size()));
    Filter.PathRestriction r1=Filter.PathRestriction.values()[r.nextInt(Filter.PathRestriction.values().length)];
    Filter.PathRestriction r2=Filter.PathRestriction.values()[r.nextInt(Filter.PathRestriction.values().length)];
    FilterImpl f1=new FilterImpl();
    f1.restrictPath(p1,r1);
    FilterImpl f2=new FilterImpl();
    f2.restrictPath(p2,r2);
    FilterImpl fc=new FilterImpl();
    fc.restrictPath(p1,r1);
    fc.restrictPath(p2,r2);
    int tooMany=0;
    for (    String p : paths) {
      boolean expected=f1.testPath(p) && f2.testPath(p);
      boolean got=fc.testPath(p);
      if (expected == got) {
      }
 else       if (expected && !got) {
        fc=new FilterImpl();
        fc.restrictPath(p1,r1);
        fc.restrictPath(p2,r2);
        fail("not matched: " + p1 + "/"+ r1.name()+ " && "+ p2+ "/"+ r2.name());
      }
 else {
        tooMany++;
      }
    }
    if (tooMany > 3) {
      fail("too many matches: " + p1 + "/"+ r1.name()+ " && "+ p2+ "/"+ r2.name()+ " superfluous: "+ tooMany);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.authentication.TokenDefaultLoginModuleTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testInvalidSimpleCredentials() throws Exception {
  ContentSession cs=null;
  try {
    SimpleCredentials sc=new SimpleCredentials("test",new char[0]);
    cs=login(sc);
    fail("Invalid simple credentials login should fail");
  }
 catch (  LoginException e) {
  }
 finally {
    if (cs != null) {
      cs.close();
    }
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testInvalidTokenCredentials() throws Exception {
  ContentSession cs=null;
  try {
    cs=login(new TokenCredentials("invalid"));
    fail("Invalid token credentials login should fail");
  }
 catch (  LoginException e) {
  }
 finally {
    if (cs != null) {
      cs.close();
    }
  }
}

</code></pre>

<br>
<pre class="type-5 type-6 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTokenLoginForDisabledUser() throws Exception {
  ContentSession cs=null;
  try {
    User user=getTestUser();
    SimpleCredentials sc=new SimpleCredentials(user.getID(),user.getID().toCharArray());
    sc.setAttribute(".token","");
    cs=login(sc);
    user.disable("disabled");
    root.commit();
    Object token=sc.getAttribute(".token").toString();
    assertNotNull(token);
    TokenCredentials tc=new TokenCredentials(token.toString());
    cs.close();
    cs=login(tc);
    fail("token login for a disabled user must fail.");
  }
 catch (  LoginException e) {
  }
 finally {
    if (cs != null) {
      cs.close();
    }
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testInvalidSimpleCredentialsWithAttribute() throws Exception {
  ContentSession cs=null;
  try {
    SimpleCredentials sc=new SimpleCredentials("test",new char[0]);
    sc.setAttribute(".token","");
    cs=login(sc);
    fail("Invalid simple credentials login should fail");
  }
 catch (  LoginException e) {
  }
 finally {
    if (cs != null) {
      cs.close();
    }
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testNullLogin() throws Exception {
  ContentSession cs=null;
  try {
    cs=login(null);
    fail("Null login should fail");
  }
 catch (  LoginException e) {
  }
 finally {
    if (cs != null) {
      cs.close();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.authentication.ldap.LdapLoginStandaloneTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testGuestLogin() throws Exception {
  try {
    ContentSession sc=login(new GuestCredentials());
    sc.close();
    fail("Guest login must fail.");
  }
 catch (  LoginException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.authentication.ldap.LdapLoginTestBase </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * Null login must fail.
 * @throws Exception
 * @see org.apache.jackrabbit.oak.security.authentication.ldap.GuestTokenDefaultLdapLoginModuleTest
 */
@Test public void testNullLogin() throws Exception {
  ContentSession cs=null;
  try {
    cs=login(null);
    fail("Expected null login to fail.");
  }
 catch (  LoginException e) {
  }
 finally {
    if (cs != null) {
      cs.close();
    }
  }
}

</code></pre>

<br>
<pre class="type-5 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLoginFailed() throws Exception {
  try {
    ContentSession cs=login(new SimpleCredentials(USER_ID,new char[0]));
    cs.close();
    fail("login failure expected");
  }
 catch (  LoginException e) {
  }
 finally {
    assertNull(userManager.getAuthorizable(USER_ID));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.authentication.ldap.LdapProviderTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testAuthenticateFail() throws Exception {
  SimpleCredentials creds=new SimpleCredentials(TEST_USER1_UID,"foobar".toCharArray());
  try {
    idp.authenticate(creds);
    fail("Authenticate must fail with LoginException for wrong password");
  }
 catch (  LoginException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.authentication.token.TokenAuthenticationTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testAuthenticateWithInvalidTokenCredentials() throws Exception {
  try {
    authentication.authenticate(new TokenCredentials(UUID.randomUUID().toString()));
    fail("LoginException expected");
  }
 catch (  LoginException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testGetTokenInfoBeforeAuthenticate(){
  try {
    authentication.getTokenInfo();
    fail("IllegalStateException expected");
  }
 catch (  IllegalStateException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.authentication.token.TokenLoginModuleTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testGuestLogin() throws Exception {
  ContentSession cs=null;
  try {
    cs=login(new GuestCredentials());
    fail("GuestCredentials login should fail");
  }
 catch (  LoginException e) {
  }
 finally {
    if (cs != null) {
      cs.close();
    }
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testInvalidTokenCredentials() throws Exception {
  ContentSession cs=null;
  try {
    cs=login(new TokenCredentials("invalid"));
    fail("Invalid token credentials login should fail");
  }
 catch (  LoginException e) {
  }
 finally {
    if (cs != null) {
      cs.close();
    }
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testSimpleCredentialsWithAttribute() throws Exception {
  ContentSession cs=null;
  try {
    SimpleCredentials sc=new SimpleCredentials("test",new char[0]);
    sc.setAttribute(".token","");
    cs=login(sc);
    fail("Unsupported credentials login should fail");
  }
 catch (  LoginException e) {
  }
 finally {
    if (cs != null) {
      cs.close();
    }
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testSimpleCredentials() throws Exception {
  ContentSession cs=null;
  try {
    SimpleCredentials sc=new SimpleCredentials("admin","admin".toCharArray());
    cs=login(sc);
    fail("Unsupported credentials login should fail");
  }
 catch (  LoginException e) {
  }
 finally {
    if (cs != null) {
      cs.close();
    }
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testNullLogin() throws Exception {
  ContentSession cs=null;
  try {
    cs=login(null);
    fail("Null login should fail");
  }
 catch (  LoginException e) {
  }
 finally {
    if (cs != null) {
      cs.close();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.authentication.token.TokenProviderImplTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testTokenNodeName() throws Exception {
  TokenInfo info=tokenProvider.createToken(userId,Collections.<String,Object>emptyMap());
  Tree tokenTree=getTokenTree(info);
  try {
    UUID.fromString(tokenTree.getName());
    fail("UUID-name should only be used in case of conflict");
  }
 catch (  IllegalArgumentException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCreateTokenWithInvalidExpirationParam() throws Exception {
  SimpleCredentials sc=new SimpleCredentials(userId,new char[0]);
  sc.setAttribute(TokenProvider.PARAM_TOKEN_EXPIRATION,"invalid");
  try {
    tokenProvider.createToken(sc);
    fail();
  }
 catch (  NumberFormatException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.authentication.token.TokenValidatorTest </h4><pre class="type-9 type-5 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testManuallyCreateToken() throws Exception {
  TokenInfo info=tokenProvider.createToken(userId,Collections.<String,Object>emptyMap());
  Tree tokenTree=getTokenTree(info);
  assertNotNull(tokenProvider.getTokenInfo(info.getToken()));
  NodeUtil tokensNode=new NodeUtil(tokenTree.getParent());
  try {
    createTokenTree(info,tokensNode,TOKEN_NT_NAME);
    tokenTree.remove();
    root.commit();
    fail("Manually creating a token node must fail.");
  }
 catch (  CommitFailedException e) {
    assertEquals(63,e.getCode());
  }
 finally {
    root.refresh();
    root.commit();
  }
}

</code></pre>

<br>
<pre class="type-5 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateReservedKeyProperty2() throws Exception {
  NodeUtil node=new NodeUtil(root.getTree("/")).addChild("testNode",JcrConstants.NT_UNSTRUCTURED);
  try {
    node.setString(TOKEN_ATTRIBUTE_KEY,"anyValue");
    root.commit();
    fail("The reserved token key property must only be created by the TokenProvider.");
  }
 catch (  CommitFailedException e) {
    assertEquals(63,e.getCode());
  }
 finally {
    node.getTree().remove();
    root.commit();
  }
}

</code></pre>

<br>
<pre class="type-5 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testChangingTokenKey() throws Exception {
  TokenInfo info=tokenProvider.createToken(userId,Collections.<String,Object>emptyMap());
  NodeUtil tokenTree=new NodeUtil(getTokenTree(info));
  try {
    tokenTree.setString(TOKEN_ATTRIBUTE_KEY,PasswordUtil.buildPasswordHash("anotherValue"));
    root.commit(CommitMarker.asCommitAttributes());
    fail("The token key must never be modified.");
  }
 catch (  CommitFailedException e) {
    assertEquals(61,e.getCode());
  }
}

</code></pre>

<br>
<pre class="type-9 type-5 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateTokenWithInvalidNodeType() throws Exception {
  TokenInfo info=tokenProvider.createToken(userId,Collections.<String,Object>emptyMap());
  Tree tokenTree=getTokenTree(info);
  assertNotNull(tokenProvider.getTokenInfo(info.getToken()));
  Tree userTree=root.getTree(getUserManager(root).getAuthorizable(userId).getPath());
  NodeUtil node=new NodeUtil(userTree.getChild(TOKENS_NODE_NAME));
  Tree t=null;
  try {
    t=createTokenTree(info,node,JcrConstants.NT_UNSTRUCTURED);
    tokenTree.remove();
    root.commit(CommitMarker.asCommitAttributes());
    fail("The token node must be of type rep:Token.");
  }
 catch (  CommitFailedException e) {
    assertEquals(60,e.getCode());
  }
 finally {
    if (t != null) {
      t.remove();
      root.commit(CommitMarker.asCommitAttributes());
    }
  }
}

</code></pre>

<br>
<pre class="type-5 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTokensNodeAtInvalidPathBelowUser() throws Exception {
  Tree userTree=root.getTree(getUserManager(root).getAuthorizable(userId).getPath());
  NodeUtil userNode=new NodeUtil(userTree);
  NodeUtil n=null;
  try {
    n=userNode.addChild("test",JcrConstants.NT_UNSTRUCTURED);
    n.addChild(TOKENS_NODE_NAME,TOKENS_NT_NAME);
    root.commit();
    fail("The token parent node must be located below the user home node.");
  }
 catch (  CommitFailedException e) {
    assertEquals(68,e.getCode());
  }
 finally {
    if (n != null) {
      n.getTree().remove();
      root.commit(CommitMarker.asCommitAttributes());
    }
  }
}

</code></pre>

<br>
<pre class="type-5 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTokensNodeBelowRoot() throws Exception {
  NodeUtil rootNode=new NodeUtil(root.getTree("/"));
  NodeUtil n=null;
  try {
    n=rootNode.addChild(TOKENS_NODE_NAME,TOKENS_NT_NAME);
    root.commit();
    fail("The token parent node must be located below the configured user root.");
  }
 catch (  CommitFailedException e) {
    assertEquals(64,e.getCode());
  }
 finally {
    if (n != null) {
      n.getTree().remove();
      root.commit(CommitMarker.asCommitAttributes());
    }
  }
}

</code></pre>

<br>
<pre class="type-5 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testChangeTokenParentPrimaryType() throws Exception {
  TokenInfo info=tokenProvider.createToken(userId,Collections.<String,Object>emptyMap());
  try {
    Tree tokensTree=getTokenTree(info).getParent();
    tokensTree.setProperty(JcrConstants.JCR_PRIMARYTYPE,JcrConstants.NT_UNSTRUCTURED,Type.NAME);
    root.commit();
    fail("The primary type of the token parent must not be changed from rep:Unstructured to another type.");
  }
 catch (  CommitFailedException e) {
    assertEquals(69,e.getCode());
  }
 finally {
    root.refresh();
  }
}

</code></pre>

<br>
<pre class="type-9 type-5 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateTokenAtInvalidLocationBelowTestNode() throws Exception {
  TokenInfo info=tokenProvider.createToken(userId,Collections.<String,Object>emptyMap());
  Tree tokenTree=getTokenTree(info);
  assertNotNull(tokenProvider.getTokenInfo(info.getToken()));
  NodeUtil node=new NodeUtil(root.getTree("/")).addChild("testNode",JcrConstants.NT_UNSTRUCTURED);
  try {
    createTokenTree(info,node,TOKEN_NT_NAME);
    tokenTree.remove();
    root.commit(CommitMarker.asCommitAttributes());
    fail("Creating a new token not  at '/testNode' must fail.");
  }
 catch (  CommitFailedException e) {
    assertEquals(64,e.getCode());
  }
 finally {
    node.getTree().remove();
    root.commit(CommitMarker.asCommitAttributes());
  }
}

</code></pre>

<br>
<pre class="type-9 type-5 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInvalidTokenParentNode() throws Exception {
  Tree userTree=root.getTree(getUserManager(root).getAuthorizable(userId).getPath());
  NodeUtil node=new NodeUtil(userTree).addChild("testNode",JcrConstants.NT_UNSTRUCTURED);
  try {
    node.addChild(TOKENS_NODE_NAME,JcrConstants.NT_UNSTRUCTURED);
    root.commit(CommitMarker.asCommitAttributes());
    fail("Creating a new token '" + node.getTree().getPath() + "' must fail.");
  }
 catch (  CommitFailedException e) {
    assertEquals(68,e.getCode());
  }
 finally {
    node.getTree().remove();
    root.commit(CommitMarker.asCommitAttributes());
  }
}

</code></pre>

<br>
<pre class="type-9 type-5 type-6 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateTokenAtInvalidLocationInsideUser2() throws Exception {
  TokenInfo info=tokenProvider.createToken(userId,Collections.<String,Object>emptyMap());
  Tree tokenTree=getTokenTree(info);
  assertNotNull(tokenProvider.getTokenInfo(info.getToken()));
  Tree userTree=root.getTree(getUserManager(root).getAuthorizable(userId).getPath());
  NodeUtil node=new NodeUtil(userTree).getOrAddChild(TOKENS_NODE_NAME,TOKENS_NT_NAME);
  try {
    node=node.addChild("invalid",JcrConstants.NT_UNSTRUCTURED);
    createTokenTree(info,node,TOKEN_NT_NAME);
    tokenTree.remove();
    root.commit(CommitMarker.asCommitAttributes());
    fail("Creating a new token '" + node.getTree().getPath() + "' must fail.");
  }
 catch (  CommitFailedException e) {
    assertEquals(65,e.getCode());
  }
 finally {
    node.getTree().remove();
    root.commit(CommitMarker.asCommitAttributes());
  }
}

</code></pre>

<br>
<pre class="type-5 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateReservedKeyProperty() throws Exception {
  NodeUtil node=new NodeUtil(root.getTree("/")).addChild("testNode",JcrConstants.NT_UNSTRUCTURED);
  try {
    node.setString(TOKEN_ATTRIBUTE_KEY,"anyValue");
    root.commit(CommitMarker.asCommitAttributes());
    fail("The reserved token key property must not used with other node types.");
  }
 catch (  CommitFailedException e) {
    assertEquals(60,e.getCode());
  }
 finally {
    node.getTree().remove();
    root.commit();
  }
}

</code></pre>

<br>
<pre class="type-5 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPlaintextTokenKey() throws Exception {
  TokenInfo info=tokenProvider.createToken(userId,Collections.<String,Object>emptyMap());
  NodeUtil tokenTree=new NodeUtil(getTokenTree(info));
  try {
    tokenTree.setString(TOKEN_ATTRIBUTE_KEY,"anotherValue");
    root.commit(CommitMarker.asCommitAttributes());
    fail("The token key must not be plaintext.");
  }
 catch (  CommitFailedException e) {
    assertEquals(66,e.getCode());
  }
}

</code></pre>

<br>
<pre class="type-5 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testManuallyModifyExpirationDate() throws Exception {
  TokenInfo info=tokenProvider.createToken(userId,Collections.<String,Object>emptyMap());
  NodeUtil tokenTree=new NodeUtil(getTokenTree(info));
  try {
    tokenTree.setDate(TOKEN_ATTRIBUTE_EXPIRY,new Date().getTime());
    root.commit();
    fail("The token expiry must not manually be changed");
  }
 catch (  CommitFailedException e) {
    assertEquals(63,e.getCode());
  }
}

</code></pre>

<br>
<pre class="type-9 type-5 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateTokenAtInvalidLocationInsideUser() throws Exception {
  TokenInfo info=tokenProvider.createToken(userId,Collections.<String,Object>emptyMap());
  Tree tokenTree=getTokenTree(info);
  assertNotNull(tokenProvider.getTokenInfo(info.getToken()));
  Tree userTree=root.getTree(getUserManager(root).getAuthorizable(userId).getPath());
  NodeUtil node=new NodeUtil(userTree).addChild("testNode",JcrConstants.NT_UNSTRUCTURED);
  try {
    createTokenTree(info,node,TOKEN_NT_NAME);
    tokenTree.remove();
    root.commit(CommitMarker.asCommitAttributes());
    fail("Creating a new token '" + node.getTree().getPath() + "' must fail.");
  }
 catch (  CommitFailedException e) {
    assertEquals(65,e.getCode());
  }
 finally {
    node.getTree().remove();
    root.commit(CommitMarker.asCommitAttributes());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.authentication.user.LoginModuleImplTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testNullLogin() throws Exception {
  ContentSession cs=null;
  try {
    cs=login(null);
    fail("Null login should fail");
  }
 catch (  LoginException e) {
  }
 finally {
    if (cs != null) {
      cs.close();
    }
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testUnknownUserLogin() throws Exception {
  ContentSession cs=null;
  try {
    cs=login(new SimpleCredentials("unknown","".toCharArray()));
    fail("Unknown user must not be able to login");
  }
 catch (  LoginException e) {
  }
 finally {
    if (cs != null) {
      cs.close();
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-5 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInvalidImpersonation() throws Exception {
  ContentSession cs=null;
  try {
    createTestUser();
    SimpleCredentials sc=new SimpleCredentials(USER_ID,USER_PW.toCharArray());
    cs=login(sc);
    AuthInfo authInfo=cs.getAuthInfo();
    assertEquals(USER_ID,authInfo.getUserID());
    cs.close();
    cs=null;
    ConfigurationParameters config=securityProvider.getConfiguration(UserConfiguration.class).getParameters();
    String adminId=UserUtil.getAdminId(config);
    sc=new SimpleCredentials(adminId,new char[0]);
    ImpersonationCredentials ic=new ImpersonationCredentials(sc,authInfo);
    try {
      cs=login(ic);
      fail("User 'test' should not be allowed to impersonate " + adminId);
    }
 catch (    LoginException e) {
    }
  }
  finally {
    if (cs != null) {
      cs.close();
    }
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-6 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAnonymousLogin() throws Exception {
  String anonymousID=UserUtil.getAnonymousId(getUserConfiguration().getParameters());
  UserManager userMgr=getUserManager(root);
  Authorizable anonymous=userMgr.getAuthorizable(anonymousID);
  assertNotNull(anonymous);
  assertFalse(root.getTree(anonymous.getPath()).hasProperty(UserConstants.REP_PASSWORD));
  ContentSession cs=null;
  try {
    cs=login(new SimpleCredentials(anonymousID,new char[0]));
    fail("Login with anonymousID should fail since the initial setup doesn't provide a password.");
  }
 catch (  LoginException e) {
  }
 finally {
    if (cs != null) {
      cs.close();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.authorization.accesscontrol.ACLTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testInvalidRestrictionType() throws Exception {
  RestrictionProvider rp=new TestRestrictionProvider("restr",Type.NAME,false);
  JackrabbitAccessControlList acl=createACL(getTestPath(),new ArrayList(),namePathMapper,rp);
  try {
    acl.addEntry(testPrincipal,testPrivileges,false,Collections.<String,Value>singletonMap("restr",getValueFactory().createValue(true)));
    fail("Invalid restriction type.");
  }
 catch (  AccessControlException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testUnsupportedRestrictions2() throws Exception {
  RestrictionProvider rp=new TestRestrictionProvider("restr",Type.NAME,false);
  JackrabbitAccessControlList acl=createACL(getTestPath(),new ArrayList(),namePathMapper,rp);
  try {
    acl.addEntry(testPrincipal,testPrivileges,false,Collections.<String,Value>singletonMap("unsupported",getValueFactory().createValue("value")));
    fail("Unsupported restriction must be detected.");
  }
 catch (  AccessControlException e) {
  }
}

</code></pre>

<br>
<pre class="type-9 type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMvRestrictions() throws Exception {
  ValueFactory vf=getValueFactory();
  Value[] vs=new Value[]{vf.createValue(JcrConstants.NT_FILE,PropertyType.NAME),vf.createValue(JcrConstants.NT_FOLDER,PropertyType.NAME)};
  Map<String,Value[]> mvRestrictions=Collections.singletonMap(REP_NT_NAMES,vs);
  Map<String,Value> restrictions=Collections.singletonMap(REP_GLOB,vf.createValue("/.*"));
  assertTrue(acl.addEntry(testPrincipal,testPrivileges,false,restrictions,mvRestrictions));
  assertFalse(acl.addEntry(testPrincipal,testPrivileges,false,restrictions,mvRestrictions));
  assertEquals(1,acl.getAccessControlEntries().length);
  JackrabbitAccessControlEntry ace=(JackrabbitAccessControlEntry)acl.getAccessControlEntries()[0];
  try {
    ace.getRestriction(REP_NT_NAMES);
    fail();
  }
 catch (  ValueFormatException e) {
  }
  Value[] vvs=ace.getRestrictions(REP_NT_NAMES);
  assertArrayEquals(vs,vvs);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testUnknownPrincipal() throws Exception {
  Principal unknownPrincipal=new InvalidTestPrincipal("unknown");
  try {
    acl.addAccessControlEntry(unknownPrincipal,privilegesFromNames(JCR_READ));
    fail("Adding an ACE with an unknown principal should fail");
  }
 catch (  AccessControlException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testRemoveNonExisting() throws Exception {
  try {
    acl.removeAccessControlEntry(createEntry(testPrincipal,testPrivileges,true));
    fail("Removing a non-existing ACE should fail.");
  }
 catch (  AccessControlException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testAddEntryWithInvalidPrivilege() throws Exception {
  try {
    acl.addAccessControlEntry(testPrincipal,new Privilege[]{new InvalidPrivilege()});
    fail("Adding an ACE with invalid privileges should fail.");
  }
 catch (  AccessControlException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMandatoryRestrictions() throws Exception {
  RestrictionProvider rp=new TestRestrictionProvider("mandatory",Type.NAME,true);
  JackrabbitAccessControlList acl=createACL(getTestPath(),new ArrayList(),namePathMapper,rp);
  try {
    acl.addEntry(testPrincipal,testPrivileges,false,Collections.<String,Value>emptyMap());
    fail("Mandatory restriction must be enforced.");
  }
 catch (  AccessControlException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testRemoveInvalidEntry() throws Exception {
  try {
    acl.removeAccessControlEntry(new JackrabbitAccessControlEntry(){
      public boolean isAllow(){
        return false;
      }
      public String[] getRestrictionNames(){
        return new String[0];
      }
      public Value getRestriction(      String restrictionName){
        return null;
      }
      public Value[] getRestrictions(      String restrictionName){
        return null;
      }
      public Principal getPrincipal(){
        return testPrincipal;
      }
      public Privilege[] getPrivileges(){
        return testPrivileges;
      }
    }
);
    fail("Passing an unknown ACE should fail");
  }
 catch (  AccessControlException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testAddEntryWithoutPrivilege() throws Exception {
  try {
    acl.addAccessControlEntry(testPrincipal,new Privilege[0]);
    fail("Adding an ACE with empty privilege array should fail.");
  }
 catch (  AccessControlException e) {
  }
  try {
    acl.addAccessControlEntry(testPrincipal,null);
    fail("Adding an ACE with null privileges should fail.");
  }
 catch (  AccessControlException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testNullPrincipal() throws Exception {
  try {
    acl.addAccessControlEntry(null,privilegesFromNames(JCR_READ));
    fail("Adding an ACE with null principal should fail");
  }
 catch (  AccessControlException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testEmptyPrincipal() throws Exception {
  try {
    acl.addAccessControlEntry(new PrincipalImpl(""),privilegesFromNames(JCR_READ));
    fail("Adding an ACE with empty-named principal should fail");
  }
 catch (  AccessControlException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testUnsupportedRestrictions() throws Exception {
  Map<String,Value> restrictions=Collections.singletonMap("unknownRestriction",getValueFactory().createValue("value"));
  try {
    acl.addEntry(testPrincipal,testPrivileges,false,restrictions);
    fail("Invalid restrictions -> AccessControlException expected");
  }
 catch (  AccessControlException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testReorderInvalidEntries() throws Exception {
  Privilege[] read=privilegesFromNames(JCR_READ,JCR_READ_ACCESS_CONTROL);
  Privilege[] write=privilegesFromNames(JCR_WRITE);
  acl.addAccessControlEntry(testPrincipal,read);
  acl.addAccessControlEntry(EveryonePrincipal.getInstance(),write);
  AccessControlEntry invalid=createEntry(testPrincipal,false,null,JCR_WRITE);
  try {
    acl.orderBefore(invalid,acl.getEntries().get(0));
    fail("src entry not contained in list -> reorder should fail.");
  }
 catch (  AccessControlException e) {
  }
  try {
    acl.orderBefore(acl.getEntries().get(0),invalid);
    fail("dest entry not contained in list -> reorder should fail.");
  }
 catch (  AccessControlException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.authorization.accesscontrol.AccessControlManagerImplTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testGetApplicablePoliciesInvalidPrincipal() throws Exception {
  Principal unknown=getPrincipalManager(root).getPrincipal("unknown");
  int i=0;
  while (unknown != null) {
    unknown=getPrincipalManager(root).getPrincipal("unknown" + i);
  }
  unknown=new InvalidTestPrincipal("unknown" + i);
  try {
    acMgr.getApplicablePolicies(unknown);
    fail("Unknown principal should be detected.");
  }
 catch (  AccessControlException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testPrivilegeFromInvalidName() throws Exception {
  List<String> invalid=new ArrayList<String>();
  invalid.add(null);
  invalid.add("");
  invalid.add("test:read");
  for (  String privilegeName : invalid) {
    try {
      acMgr.privilegeFromName(privilegeName);
      fail("Invalid privilege name " + privilegeName);
    }
 catch (    RepositoryException e) {
    }
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testGetEffectivePoliciesInvalidPrincipals() throws Exception {
  Principal unknown=getPrincipalManager(root).getPrincipal("unknown");
  int i=0;
  while (unknown != null) {
    unknown=getPrincipalManager(root).getPrincipal("unknown" + i);
  }
  unknown=new InvalidTestPrincipal("unknown" + i);
  try {
    acMgr.getEffectivePolicies(Collections.singleton(unknown));
    fail("Unknown principal should be detected.");
  }
 catch (  AccessControlException e) {
  }
  try {
    acMgr.getEffectivePolicies(ImmutableSet.of(unknown,EveryonePrincipal.getInstance(),testPrincipal));
    fail("Unknown principal should be detected.");
  }
 catch (  AccessControlException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testSetPolicyAtDifferentPath() throws Exception {
  try {
    ACL acl=getApplicablePolicy(testPath);
    acMgr.setPolicy("/",acl);
    fail("Setting access control policy at a different node path must fail");
  }
 catch (  AccessControlException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testHasPrivilegesNonExistingNodePath() throws Exception {
  String nonExistingPath="/not/existing";
  Privilege[] privs=privilegesFromNames(PrivilegeConstants.JCR_ALL);
  try {
    acMgr.hasPrivileges(nonExistingPath,privs);
    fail("AccessControlManager#hasPrivileges  for node that doesn't exist should fail.");
  }
 catch (  PathNotFoundException e) {
  }
  try {
    acMgr.hasPrivileges(nonExistingPath,getPrincipals(adminSession),privs);
    fail("AccessControlManager#hasPrivileges  for node that doesn't exist should fail.");
  }
 catch (  PathNotFoundException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testGetPoliciesPropertyPath() throws Exception {
  String propertyPath="/jcr:primaryType";
  try {
    acMgr.getPolicies(propertyPath);
    fail("Getting policies for property should fail.");
  }
 catch (  PathNotFoundException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testPrivilegeFromUnknownName() throws Exception {
  List<String> invalid=new ArrayList<String>();
  invalid.add("unknownPrivilege");
  invalid.add('{' + NamespaceRegistry.NAMESPACE_JCR + "}unknown");
  for (  String privilegeName : invalid) {
    try {
      acMgr.privilegeFromName(privilegeName);
      fail("Invalid privilege name " + privilegeName);
    }
 catch (    AccessControlException e) {
    }
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testGetEffectivePoliciesNonExistingNodePath() throws Exception {
  String nonExistingPath="/not/existing";
  try {
    acMgr.getEffectivePolicies(nonExistingPath);
    fail("Getting policies for node that doesn't exist should fail.");
  }
 catch (  PathNotFoundException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testGetApplicablePoliciesNullPrincipal() throws Exception {
  try {
    acMgr.getApplicablePolicies((Principal)null);
    fail("Null is not a valid principal");
  }
 catch (  AccessControlException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testRemovePolicyInvalidPath() throws Exception {
  for (  String invalid : getInvalidPaths()) {
    try {
      AccessControlPolicy acl=createPolicy(invalid);
      acMgr.removePolicy(invalid,acl);
      fail("Removing access control policy with invalid path should fail");
    }
 catch (    RepositoryException e) {
    }
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testRemoveInvalidPolicy() throws Exception {
  ACL acl=setupPolicy(testPath);
  try {
    acMgr.removePolicy(testPath,new TestACL(testPath,getRestrictionProvider()));
    fail("Invalid policy -> removal must fail");
  }
 catch (  AccessControlException e) {
  }
  ACL repoAcl=setupPolicy(null);
  try {
    acMgr.removePolicy(testPath,repoAcl);
    fail("Setting invalid policy must fail");
  }
 catch (  AccessControlException e) {
  }
  try {
    acMgr.removePolicy(null,acl);
    fail("Setting invalid policy must fail");
  }
 catch (  AccessControlException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testHasPrivilegesInvalidPaths() throws Exception {
  Privilege[] privs=privilegesFromNames(PrivilegeConstants.JCR_ALL);
  for (  String path : getInvalidPaths()) {
    try {
      acMgr.hasPrivileges(path,privs);
      fail("AccessControlManager#hasPrivileges  for node that doesn't exist should fail.");
    }
 catch (    RepositoryException e) {
    }
  }
  for (  String path : getInvalidPaths()) {
    try {
      acMgr.hasPrivileges(path,getPrincipals(adminSession),privs);
      fail("AccessControlManager#hasPrivileges  for node that doesn't exist should fail.");
    }
 catch (    RepositoryException e) {
    }
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testSetPolicyInvalidPath() throws Exception {
  for (  String invalid : getInvalidPaths()) {
    try {
      AccessControlPolicy acl=createPolicy(invalid);
      acMgr.setPolicy(invalid,acl);
      fail("Setting access control policy with invalid path should fail");
    }
 catch (    RepositoryException e) {
    }
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testGetEffectivePoliciesForAcContentPaths() throws Exception {
  for (  String path : getAcContentPaths()) {
    try {
      acMgr.getEffectivePolicies(path);
      fail("Getting effective policies for access control content should fail.");
    }
 catch (    AccessControlException e) {
    }
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * @since OAK 1.0 As of OAK AccessControlManager#hasPrivilege will throw
 * PathNotFoundException in case the node associated with a given path is
 * not readable to the editing session.
 */
@Test public void testGetPrivilegesNotAccessiblePath() throws Exception {
  List<String> notAccessible=new ArrayList();
  notAccessible.add("/");
  notAccessible.addAll(getAcContentPaths());
  for (  String path : notAccessible) {
    try {
      getTestAccessControlManager().getPrivileges(path);
      fail("AccessControlManager#getPrivileges for node that is not accessible should fail.");
    }
 catch (    PathNotFoundException e) {
    }
  }
  for (  String path : notAccessible) {
    try {
      getTestAccessControlManager().getPrivileges(path,Collections.singleton(testPrincipal));
      fail("AccessControlManager#getPrivileges for node that is not accessible should fail.");
    }
 catch (    PathNotFoundException e) {
    }
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testGetSupportedPrivilegesPropertyPath() throws Exception {
  try {
    acMgr.getSupportedPrivileges("/jcr:primaryType");
    fail("Property path -> PathNotFoundException expected.");
  }
 catch (  PathNotFoundException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testSetInvalidPolicy() throws Exception {
  try {
    acMgr.setPolicy(testPath,new TestACL(testPath,getRestrictionProvider()));
    fail("Setting invalid policy must fail");
  }
 catch (  AccessControlException e) {
  }
  ACL acl=setupPolicy(testPath);
  try {
    acMgr.setPolicy(testPath,new TestACL(testPath,getRestrictionProvider()));
    fail("Setting invalid policy must fail");
  }
 catch (  AccessControlException e) {
  }
  ACL repoAcl=setupPolicy(null);
  try {
    acMgr.setPolicy(testPath,repoAcl);
    fail("Setting invalid policy must fail");
  }
 catch (  AccessControlException e) {
  }
  try {
    acMgr.setPolicy(null,acl);
    fail("Setting invalid policy must fail");
  }
 catch (  AccessControlException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testGetPoliciesInvalidPrincipal() throws Exception {
  Principal unknown=getPrincipalManager(root).getPrincipal("unknown");
  int i=0;
  while (unknown != null) {
    unknown=getPrincipalManager(root).getPrincipal("unknown" + i);
  }
  unknown=new InvalidTestPrincipal("unknown" + i);
  try {
    acMgr.getPolicies(unknown);
    fail("Unknown principal should be detected.");
  }
 catch (  AccessControlException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testGetEffectivePoliciesForPropertyPath() throws Exception {
  String propertyPath="/jcr:primaryType";
  try {
    acMgr.getEffectivePolicies(propertyPath);
    fail("Getting policies for property should fail.");
  }
 catch (  PathNotFoundException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testGetSupportedPrivilegesNonExistingPath() throws Exception {
  try {
    acMgr.getSupportedPrivileges("/non/existing/node");
    fail("Nonexisting node -> PathNotFoundException expected.");
  }
 catch (  PathNotFoundException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testRemovePolicyNonExistingNodePath() throws Exception {
  try {
    String path="/non/existing";
    AccessControlPolicy acl=createPolicy(path);
    acMgr.removePolicy(path,acl);
    fail("Removing access control policy for non-existing node path should fail");
  }
 catch (  PathNotFoundException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testRemovePolicyAtDifferentPath() throws Exception {
  try {
    setupPolicy(testPath);
    ACL acl=getApplicablePolicy("/");
    acMgr.removePolicy(testPath,acl);
    fail("Removing access control policy at a different node path must fail");
  }
 catch (  AccessControlException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testRemovePolicyPropertyPath() throws Exception {
  try {
    String path="/jcr:primaryType";
    AccessControlPolicy acl=createPolicy(path);
    acMgr.removePolicy(path,acl);
    fail("Removing access control policy at property path should fail");
  }
 catch (  PathNotFoundException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testGetApplicablePoliciesInvalidPath() throws Exception {
  for (  String invalid : getInvalidPaths()) {
    try {
      acMgr.getPolicies(invalid);
      fail("Getting applicable policies for an invalid path should fail");
    }
 catch (    RepositoryException e) {
    }
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testGetApplicablePoliciesForAcContentPaths() throws Exception {
  for (  String path : getAcContentPaths()) {
    try {
      acMgr.getApplicablePolicies(path);
      fail("Getting applicable policies for access control content should fail.");
    }
 catch (    AccessControlException e) {
    }
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testGetPrivilegesInvalidPaths() throws Exception {
  for (  String path : getInvalidPaths()) {
    try {
      acMgr.getPrivileges(path);
      fail("AccessControlManager#getPrivileges  for node that doesn't exist should fail.");
    }
 catch (    RepositoryException e) {
    }
  }
  for (  String path : getInvalidPaths()) {
    try {
      acMgr.getPrivileges(path,Collections.singleton(testPrincipal));
      fail("AccessControlManager#getPrivileges  for node that doesn't exist should fail.");
    }
 catch (    RepositoryException e) {
    }
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testGetEffectivePoliciesNullPrincipal() throws Exception {
  try {
    acMgr.getEffectivePolicies((Set)null);
    fail("Null principal set not allowed");
  }
 catch (  AccessControlException e) {
  }
  try {
    acMgr.getEffectivePolicies(new HashSet<Principal>(Arrays.asList(EveryonePrincipal.getInstance(),null,testPrincipal)));
    fail("Null principal set not allowed");
  }
 catch (  AccessControlException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testSetPolicyAcContent() throws Exception {
  for (  String acPath : getAcContentPaths()) {
    try {
      AccessControlPolicy acl=createPolicy(acPath);
      acMgr.setPolicy(acPath,acl);
      fail("Setting access control policy to access control content should fail");
    }
 catch (    AccessControlException e) {
    }
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testSetPolicyPropertyPath() throws Exception {
  try {
    String path="/jcr:primaryType";
    AccessControlPolicy acl=createPolicy(path);
    acMgr.setPolicy(path,acl);
    fail("Setting access control policy at property path should fail");
  }
 catch (  PathNotFoundException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testSetPolicyNonExistingNodePath() throws Exception {
  try {
    String path="/non/existing";
    AccessControlPolicy acl=createPolicy(path);
    acMgr.setPolicy(path,acl);
    fail("Setting access control policy for non-existing node path should fail");
  }
 catch (  PathNotFoundException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testRemovePolicyAcContent() throws Exception {
  for (  String acPath : getAcContentPaths()) {
    try {
      AccessControlPolicy acl=createPolicy(acPath);
      acMgr.removePolicy(acPath,acl);
      fail("Removing access control policy to access control content should fail");
    }
 catch (    AccessControlException e) {
    }
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * @since OAK 1.0 As of OAK AccessControlManager#hasPrivilege will throw
 * PathNotFoundException in case the node associated with a given path is
 * not readable to the editing session (compatibility with the specification
 * which was missing in jackrabbit).
 */
@Test public void testHasPrivilegesNotAccessiblePath() throws Exception {
  List<String> notAccessible=new ArrayList();
  notAccessible.add("/");
  notAccessible.addAll(getAcContentPaths());
  Privilege[] privs=privilegesFromNames(PrivilegeConstants.JCR_ALL);
  AccessControlManagerImpl testAcMgr=getTestAccessControlManager();
  for (  String path : notAccessible) {
    try {
      testAcMgr.hasPrivileges(path,privs);
      fail("AccessControlManager#hasPrivileges for node that is not accessible should fail.");
    }
 catch (    PathNotFoundException e) {
    }
  }
  for (  String path : notAccessible) {
    try {
      testAcMgr.hasPrivileges(path,getPrincipals(getTestRoot().getContentSession()),privs);
      fail("AccessControlManager#hasPrivileges for node that is not accessible should fail.");
    }
 catch (    PathNotFoundException e) {
    }
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testGetPoliciesNullPrincipal() throws Exception {
  try {
    acMgr.getPolicies((Principal)null);
    fail("Null is not a valid principal");
  }
 catch (  AccessControlException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testGetPrivilegesNonExistingNodePath() throws Exception {
  String nonExistingPath="/not/existing";
  try {
    acMgr.getPrivileges(nonExistingPath);
    fail("AccessControlManager#getPrivileges  for node that doesn't exist should fail.");
  }
 catch (  PathNotFoundException e) {
  }
  try {
    acMgr.getPrivileges(nonExistingPath,Collections.singleton(testPrincipal));
    fail("AccessControlManager#getPrivileges  for node that doesn't exist should fail.");
  }
 catch (  PathNotFoundException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testGetEffectivePoliciesInvalidPath() throws Exception {
  for (  String invalid : getInvalidPaths()) {
    try {
      acMgr.getEffectivePolicies(invalid);
      fail("Getting policies for an invalid path should fail");
    }
 catch (    RepositoryException e) {
    }
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testGetPoliciesInvalidPath() throws Exception {
  for (  String invalid : getInvalidPaths()) {
    try {
      acMgr.getPolicies(invalid);
      fail("Getting policies for an invalid path should fail");
    }
 catch (    RepositoryException e) {
    }
  }
}

</code></pre>

<br>
<pre class="type-5 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTestSessionGetPrivileges() throws Exception {
  setupPolicy(testPath);
  root.commit();
  AccessControlManagerImpl testAcMgr=getTestAccessControlManager();
  Set<Principal> testPrincipals=getPrincipals(getTestRoot().getContentSession());
  assertArrayEquals(new Privilege[0],testAcMgr.getPrivileges(null));
  assertArrayEquals(new Privilege[0],testAcMgr.getPrivileges(null,testPrincipals));
  Privilege[] privs=testAcMgr.getPrivileges(testPath);
  assertEquals(ImmutableSet.copyOf(testPrivileges),ImmutableSet.copyOf(privs));
  privs=testAcMgr.getPrivileges(testPath,testPrincipals);
  assertEquals(ImmutableSet.copyOf(testPrivileges),ImmutableSet.copyOf(privs));
  try {
    testAcMgr.getPrivileges(testPath,getPrincipals(adminSession));
    fail("testSession doesn't have sufficient permission to read access control information at testPath");
  }
 catch (  AccessDeniedException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTestSessionHasRepoPrivileges() throws Exception {
  AccessControlManagerImpl testAcMgr=getTestAccessControlManager();
  assertFalse(testAcMgr.hasPrivileges(null,testPrivileges));
  assertFalse(testAcMgr.hasPrivileges(null,getPrincipals(getTestRoot().getContentSession()),testPrivileges));
  try {
    testAcMgr.getPrivileges(null,getPrincipals(adminSession));
    fail("testSession doesn't have sufficient permission to read access control information");
  }
 catch (  AccessDeniedException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testGetApplicablePoliciesNonExistingNodePath() throws Exception {
  String nonExistingPath="/not/existing";
  try {
    acMgr.getApplicablePolicies(nonExistingPath);
    fail("Getting applicable policies for node that doesn't exist should fail.");
  }
 catch (  PathNotFoundException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testGetPoliciesNonExistingNodePath() throws Exception {
  String nonExistingPath="/not/existing";
  try {
    acMgr.getPolicies(nonExistingPath);
    fail("Getting policies for node that doesn't exist should fail.");
  }
 catch (  PathNotFoundException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testHasPrivilegesForPropertyPath() throws Exception {
  String propertyPath="/jcr:primaryType";
  Privilege[] privs=privilegesFromNames(PrivilegeConstants.JCR_ALL);
  try {
    acMgr.hasPrivileges(propertyPath,privs);
    fail("AccessControlManager#hasPrivileges for property should fail.");
  }
 catch (  PathNotFoundException e) {
  }
  try {
    acMgr.hasPrivileges(propertyPath,getPrincipals(adminSession),privs);
    fail("AccessControlManager#hasPrivileges for property should fail.");
  }
 catch (  PathNotFoundException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testApplicablePoliciesForPropertyPath() throws Exception {
  String propertyPath="/jcr:primaryType";
  try {
    acMgr.getApplicablePolicies(propertyPath);
    fail("Getting applicable policies for property should fail.");
  }
 catch (  PathNotFoundException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTestSessionGetEffectivePoliciesWithoutPrivilege() throws Exception {
  Privilege[] privileges=privilegesFromNames(PrivilegeConstants.JCR_READ);
  setupPolicy(testPath,privileges);
  root.commit();
  Root testRoot=getTestRoot();
  testRoot.refresh();
  AccessControlManager testAcMgr=getTestAccessControlManager();
  List<String> paths=ImmutableList.of(testPath,NodeTypeConstants.NODE_TYPES_PATH);
  for (  String path : paths) {
    assertFalse(testAcMgr.hasPrivileges(path,privilegesFromNames(PrivilegeConstants.JCR_READ_ACCESS_CONTROL)));
    try {
      testAcMgr.getEffectivePolicies(path);
      fail("READ_ACCESS_CONTROL is not granted at " + path);
    }
 catch (    AccessDeniedException e) {
    }
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testGetSupportedPrivilegesInvalidPath() throws Exception {
  for (  String path : getInvalidPaths()) {
    try {
      acMgr.getSupportedPrivileges(path);
      fail("Expects valid node path, found: " + path);
    }
 catch (    RepositoryException e) {
    }
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testGetPrivilegesForPropertyPath() throws Exception {
  String propertyPath="/jcr:primaryType";
  try {
    acMgr.getPrivileges(propertyPath);
    fail("AccessControlManager#getPrivileges for property should fail.");
  }
 catch (  PathNotFoundException e) {
  }
  try {
    acMgr.getPrivileges(propertyPath,Collections.singleton(testPrincipal));
    fail("AccessControlManager#getPrivileges for property should fail.");
  }
 catch (  PathNotFoundException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testTestSessionHasPrivilegesForPrincipals() throws Exception {
  setupPolicy(testPath);
  root.commit();
  AccessControlManagerImpl testAcMgr=getTestAccessControlManager();
  try {
    testAcMgr.getPrivileges(testPath,getPrincipals(adminSession));
    fail("testSession doesn't have sufficient permission to read access control information at testPath");
  }
 catch (  AccessDeniedException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testGetPoliciesAcContentPaths() throws Exception {
  for (  String path : getAcContentPaths()) {
    try {
      acMgr.getPolicies(path);
      fail("Getting policies for access control content should fail.");
    }
 catch (    AccessControlException e) {
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.authorization.accesscontrol.AccessControlValidatorTest </h4><pre class="type-5 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInvalidRestriction() throws Exception {
  NodeUtil restriction=createAcl().getChild(aceName).getChild(REP_RESTRICTIONS);
  restriction.setString("invalid","value");
  try {
    root.commit();
    fail("Creating an unsupported restriction should fail.");
  }
 catch (  CommitFailedException e) {
    assertTrue(e.isAccessControlViolation());
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInvalidPrivilege() throws Exception {
  NodeUtil acl=createAcl();
  String privName="invalidPrivilegeName";
  createACE(acl,"invalid",NT_REP_GRANT_ACE,testPrincipal.getName(),privName);
  try {
    root.commit();
    fail("Creating an ACE with invalid privilege should fail.");
  }
 catch (  CommitFailedException e) {
    assertTrue(e.isAccessControlViolation());
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddIsolatedPolicy() throws Exception {
  String[] policyNames=new String[]{"isolatedACL",REP_POLICY,REP_REPO_POLICY};
  NodeUtil node=getTestRoot();
  for (  String policyName : policyNames) {
    NodeUtil policy=node.addChild(policyName,NT_REP_ACL);
    try {
      root.commit();
      fail("Writing an isolated ACL without the parent being rep:AccessControllable should fail.");
    }
 catch (    CommitFailedException e) {
      assertTrue(e.isAccessControlViolation());
    }
 finally {
      policy.getTree().remove();
    }
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAbstractPrivilege() throws Exception {
  PrivilegeManager pMgr=getPrivilegeManager(root);
  pMgr.registerPrivilege("abstractPrivilege",true,new String[0]);
  NodeUtil acl=createAcl();
  createACE(acl,"invalid",NT_REP_GRANT_ACE,testPrincipal.getName(),"abstractPrivilege");
  try {
    root.commit();
    fail("Creating an ACE with an abstract privilege should fail.");
  }
 catch (  CommitFailedException e) {
    assertTrue(e.isAccessControlViolation());
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddRestrictionWithAcContent() throws Exception {
  NodeUtil acl=createAcl();
  NodeUtil ace=acl.getChild(aceName);
  NodeUtil[] acContent=new NodeUtil[]{acl,ace.getChild(REP_RESTRICTIONS)};
  for (  NodeUtil node : acContent) {
    NodeUtil entry=node.addChild("invalidRestriction",NT_REP_RESTRICTIONS);
    try {
      root.commit();
      fail("Adding an ACE below an ACE or restriction should fail");
    }
 catch (    CommitFailedException e) {
      assertTrue(e.isConstraintViolation());
    }
 finally {
      entry.getTree().remove();
    }
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddPolicyWithAcContent() throws Exception {
  NodeUtil acl=createAcl();
  NodeUtil ace=acl.getChild(aceName);
  NodeUtil[] acContent=new NodeUtil[]{acl,ace,ace.getChild(REP_RESTRICTIONS)};
  for (  NodeUtil node : acContent) {
    NodeUtil policy=node.addChild(REP_POLICY,NT_REP_ACL);
    try {
      root.commit();
      fail("Adding an ACL below access control content should fail");
    }
 catch (    CommitFailedException e) {
      assertTrue(e.isConstraintViolation());
    }
 finally {
      policy.getTree().remove();
    }
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPolicyWithOutChildOrder() throws AccessDeniedException {
  NodeUtil testRoot=getTestRoot();
  testRoot.setNames(JcrConstants.JCR_MIXINTYPES,MIX_REP_ACCESS_CONTROLLABLE);
  testRoot.addChild(REP_POLICY,NT_REP_ACL);
  try {
    root.commit();
    fail("Policy node with child node ordering");
  }
 catch (  CommitFailedException e) {
    assertTrue(e.isAccessControlViolation());
    assertEquals("OakAccessControl0004: Invalid policy node: Order of children is not stable.",e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddIsolatedRestriction() throws Exception {
  NodeUtil node=getTestRoot();
  NodeUtil restriction=node.addChild("isolatedRestriction",NT_REP_RESTRICTIONS);
  try {
    root.commit();
    fail("Writing an isolated Restriction should fail.");
  }
 catch (  CommitFailedException e) {
    assertTrue(e.isAccessControlViolation());
  }
 finally {
    restriction.getTree().remove();
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddRepoPolicyWithAcContent() throws Exception {
  NodeUtil acl=createAcl();
  NodeUtil ace=acl.getChild(aceName);
  NodeUtil[] acContent=new NodeUtil[]{acl,ace,ace.getChild(REP_RESTRICTIONS)};
  for (  NodeUtil node : acContent) {
    NodeUtil policy=node.addChild(REP_REPO_POLICY,NT_REP_ACL);
    try {
      root.commit();
      fail("Adding an ACL below access control content should fail");
    }
 catch (    CommitFailedException e) {
      assertTrue(e.isConstraintViolation());
    }
 finally {
      policy.getTree().remove();
    }
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddInvalidRepoPolicy() throws Exception {
  NodeUtil testRoot=getTestRoot();
  testRoot.setNames(JcrConstants.JCR_MIXINTYPES,MIX_REP_ACCESS_CONTROLLABLE);
  NodeUtil policy=getTestRoot().addChild(REP_REPO_POLICY,NT_REP_ACL);
  try {
    root.commit();
    fail("Attempt to add repo-policy with rep:AccessControllable node.");
  }
 catch (  CommitFailedException e) {
    assertTrue(e.isAccessControlViolation());
  }
 finally {
    policy.getTree().remove();
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDuplicateAce() throws Exception {
  AccessControlManager acMgr=getAccessControlManager(root);
  JackrabbitAccessControlList acl=org.apache.jackrabbit.commons.jackrabbit.authorization.AccessControlUtils.getAccessControlList(acMgr,testPath);
  acl.addAccessControlEntry(testPrincipal,privilegesFromNames(PrivilegeConstants.JCR_ADD_CHILD_NODES));
  acMgr.setPolicy(testPath,acl);
  NodeUtil policy=new NodeUtil(root.getTree(testPath + "/rep:policy"));
  NodeUtil ace=policy.addChild("duplicateAce",NT_REP_GRANT_ACE);
  ace.setString(REP_PRINCIPAL_NAME,testPrincipal.getName());
  ace.setNames(AccessControlConstants.REP_PRIVILEGES,PrivilegeConstants.JCR_ADD_CHILD_NODES);
  try {
    root.commit();
    fail("Creating duplicate ACE must be detected");
  }
 catch (  CommitFailedException e) {
    assertTrue(e.isAccessControlViolation());
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddAceWithAcContent() throws Exception {
  NodeUtil acl=createAcl();
  NodeUtil ace=acl.getChild(aceName);
  NodeUtil[] acContent=new NodeUtil[]{ace,ace.getChild(REP_RESTRICTIONS)};
  for (  NodeUtil node : acContent) {
    NodeUtil entry=node.addChild("invalidACE",NT_REP_DENY_ACE);
    try {
      root.commit();
      fail("Adding an ACE below an ACE or restriction should fail");
    }
 catch (    CommitFailedException e) {
      assertTrue(e.isConstraintViolation());
    }
 finally {
      entry.getTree().remove();
    }
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOnlyRootIsRepoAccessControllable(){
  NodeUtil testRoot=getTestRoot();
  testRoot.setNames(JcrConstants.JCR_MIXINTYPES,MIX_REP_REPO_ACCESS_CONTROLLABLE);
  try {
    root.commit();
    fail("Only the root node can be made RepoAccessControllable.");
  }
 catch (  CommitFailedException e) {
    assertTrue(e.isAccessControlViolation());
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddIsolatedAce() throws Exception {
  String[] ntNames=new String[]{NT_REP_DENY_ACE,NT_REP_GRANT_ACE};
  NodeUtil node=getTestRoot();
  for (  String aceNtName : ntNames) {
    NodeUtil ace=createACE(node,"isolatedACE",aceNtName,testPrincipal.getName(),PrivilegeConstants.JCR_READ);
    try {
      root.commit();
      fail("Writing an isolated ACE should fail.");
    }
 catch (    CommitFailedException e) {
      assertTrue(e.isAccessControlViolation());
    }
 finally {
      ace.getTree().remove();
    }
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRestrictionWithInvalidType() throws Exception {
  NodeUtil restriction=createAcl().getChild(aceName).getChild(REP_RESTRICTIONS);
  restriction.setName(REP_GLOB,"rep:glob");
  try {
    root.commit();
    fail("Creating restriction with invalid type should fail.");
  }
 catch (  CommitFailedException e) {
    assertTrue(e.isAccessControlViolation());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.authorization.composite.CompositeAccessControlManagerTest </h4><pre class="type-13 type-12 type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetApplicablePolicies() throws Exception {
  AccessControlPolicyIterator it=acMgr.getApplicablePolicies("/");
  while (it.hasNext()) {
    if (it.nextAccessControlPolicy() == TestPolicy.INSTANCE) {
      fail("TestPolicy should only be applicable at /test.");
    }
  }
  Set<AccessControlPolicy> applicable=ImmutableSet.copyOf(acMgr.getApplicablePolicies(TEST_PATH));
  assertEquals(2,applicable.size());
  assertTrue(applicable.contains(TestPolicy.INSTANCE));
}

</code></pre>

<br>
<pre class="type-13 type-12 type-5 type-7 type-6 type-19 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetPolicies() throws Exception {
  int len=0;
  AccessControlPolicy[] policies=acMgr.getPolicies(TEST_PATH);
  assertEquals(len,policies.length);
  acMgr.setPolicy(TEST_PATH,TestPolicy.INSTANCE);
  len++;
  policies=acMgr.getPolicies(TEST_PATH);
  assertEquals(len,policies.length);
  assertSame(TestPolicy.INSTANCE,policies[0]);
  AccessControlPolicyIterator it=acMgr.getApplicablePolicies(TEST_PATH);
  while (it.hasNext()) {
    AccessControlPolicy plc=it.nextAccessControlPolicy();
    if (plc == TestPolicy.INSTANCE) {
      fail("TestPolicy should only be applicable at /test.");
    }
 else {
      acMgr.setPolicy(TEST_PATH,plc);
      len++;
      Set<AccessControlPolicy> policySet=ImmutableSet.copyOf(acMgr.getPolicies(TEST_PATH));
      assertEquals(len,policySet.size());
      assertTrue(policySet.contains(TestPolicy.INSTANCE));
      assertTrue(policySet.contains(plc));
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.authorization.evaluation.HiddenPropertyTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCreateHiddenProperty(){
  Tree a=root.getTree("/a");
  try {
    a.setProperty(":hiddenProperty","val");
    root.commit();
    fail();
  }
 catch (  Exception e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCreateHiddenProperty2(){
  Tree a=root.getTree("/a");
  try {
    a.setProperty(":hiddenProperty","val",NAME);
    root.commit();
    fail();
  }
 catch (  Exception e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCreateHiddenProperty3(){
  Tree a=root.getTree("/a");
  try {
    PropertyState propertyState=PropertyBuilder.scalar(STRING).setName(":hiddenProperty").setValue("val").getPropertyState();
    a.setProperty(propertyState);
    root.commit();
    fail();
  }
 catch (  Exception e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.authorization.evaluation.HiddenTreeTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCreateHiddenChild(){
  try {
    Tree hidden=parent.addChild(":hiddenChild");
    root.commit();
    fail();
  }
 catch (  Exception e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testSetOrderableChildNodesOnHiddenTree(){
  try {
    Tree hidden=parent.getChild(HIDDEN_NAME);
    hidden.setOrderableChildren(true);
    fail("IllegalStateException expected");
  }
 catch (  IllegalStateException e) {
  }
  try {
    Tree hidden=parent.getChild(HIDDEN_NAME);
    hidden.setOrderableChildren(false);
    fail("IllegalStateException expected");
  }
 catch (  IllegalStateException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testOrderBeforeOnHiddenTree(){
  try {
    Tree hidden=parent.getChild(HIDDEN_NAME);
    hidden.orderBefore("someother");
    fail("IllegalStateException expected");
  }
 catch (  IllegalStateException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.authorization.evaluation.JcrUUIDTest </h4><pre class="type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Removing the jcr:uuid property must fail due to constraint violations.
 */
@Test public void testRemoveJcrUuid() throws Exception {
  setupPermission("/a",testPrincipal,true,PrivilegeConstants.JCR_READ);
  try {
    Root testRoot=getTestRoot();
    Tree test=testRoot.getTree(referenceablePath);
    test.removeProperty(JCR_UUID);
    testRoot.commit();
    fail("Removing the jcr:uuid property of a referenceable node must fail.");
  }
 catch (  CommitFailedException e) {
    assertTrue(e.isConstraintViolation());
    assertEquals(22,e.getCode());
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Creating a non-referenceable tree with an jcr:uuid must fail
 * with AccessDeniedException unless the REP_ADD_PROPERTY privilege
 * is granted
 */
@Test public void testCreateNonReferenceableJcrUuid() throws Exception {
  setupPermission("/a",testPrincipal,true,PrivilegeConstants.JCR_READ,PrivilegeConstants.JCR_ADD_CHILD_NODES);
  try {
    Root testRoot=getTestRoot();
    NodeUtil a=new NodeUtil(testRoot.getTree("/a"));
    a.setString(JCR_UUID,IdentifierManager.generateUUID());
    testRoot.commit();
    fail("Creating a jcr:uuid property for an unstructured node without ADD_PROPERTY permission must fail.");
  }
 catch (  CommitFailedException e) {
    assertTrue(e.isAccessViolation());
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Creating a referenceable tree with an invalid jcr:uuid must fail.
 */
@Test public void testCreateBooleanJcrUuid() throws Exception {
  setupPermission("/a",testPrincipal,true,PrivilegeConstants.JCR_READ,PrivilegeConstants.JCR_ADD_CHILD_NODES);
  try {
    Root testRoot=getTestRoot();
    testRoot.refresh();
    NodeUtil a=new NodeUtil(testRoot.getTree("/a"));
    NodeUtil test=a.addChild("referenceable2",NT_NAME);
    test.setBoolean(JcrConstants.JCR_UUID,false);
    testRoot.commit();
    fail("Creating a referenceable node with an boolean uuid must fail.");
  }
 catch (  CommitFailedException e) {
    assertTrue(e.isConstraintViolation());
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Creating a referenceable tree with an invalid jcr:uuid must fail.
 */
@Test public void testCreateInvalidJcrUuid() throws Exception {
  setupPermission("/a",testPrincipal,true,PrivilegeConstants.JCR_READ,PrivilegeConstants.JCR_ADD_CHILD_NODES);
  try {
    Root testRoot=getTestRoot();
    testRoot.refresh();
    NodeUtil a=new NodeUtil(testRoot.getTree("/a"));
    NodeUtil test=a.addChild("referenceable2",NT_NAME);
    test.setString(JcrConstants.JCR_UUID,"not a uuid");
    testRoot.commit();
    fail("Creating a referenceable node with an invalid uuid must fail.");
  }
 catch (  CommitFailedException e) {
    assertTrue(e.isConstraintViolation());
    assertEquals(12,e.getCode());
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-6 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Creating a non-referenceable tree with a jcr:uuid must fail
 * with AccessDeniedException unless the REP_ADD_PROPERTY privilege
 * is granted
 */
@Test public void testModifyNonReferenceableJcrUuid() throws Exception {
  NodeUtil a=new NodeUtil(root.getTree("/a"));
  a.setString(JCR_UUID,"some-value");
  setupPermission("/a",testPrincipal,true,PrivilegeConstants.JCR_READ,PrivilegeConstants.JCR_ADD_CHILD_NODES);
  try {
    Root testRoot=getTestRoot();
    a=new NodeUtil(testRoot.getTree("/a"));
    assertNotNull(a.getString(JCR_UUID,null));
    a.setString(JCR_UUID,IdentifierManager.generateUUID());
    testRoot.commit();
    fail("Modifying a jcr:uuid property for an unstructured node without MODIFY_PROPERTY permission must fail.");
  }
 catch (  CommitFailedException e) {
    assertTrue(e.isAccessViolation());
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Modifying the jcr:uuid property must fail due to constraint violations.
 */
@Test public void testModifyJcrUuid() throws Exception {
  setupPermission("/a",testPrincipal,true,PrivilegeConstants.JCR_READ,PrivilegeConstants.REP_WRITE);
  try {
    Root testRoot=getTestRoot();
    Tree test=testRoot.getTree(referenceablePath);
    test.setProperty(JCR_UUID,"anothervalue");
    testRoot.commit();
    fail("An attempt to change the jcr:uuid property must fail");
  }
 catch (  CommitFailedException e) {
    assertTrue(e.isConstraintViolation());
    assertEquals(12,e.getCode());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.authorization.evaluation.Jr2CompatibilityTest </h4><pre class="type-9 type-5 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRemoveNodeWithJr2Flag() throws Exception {
  setupPermission("/a",testPrincipal,true,PrivilegeConstants.JCR_READ,PrivilegeConstants.REP_WRITE);
  setupPermission("/a/b",testPrincipal,false,PrivilegeConstants.JCR_REMOVE_NODE);
  Root testRoot=getTestRoot();
  AccessControlManager acMgr=getAccessControlManager(testRoot);
  assertTrue(acMgr.hasPrivileges("/a",privilegesFromNames(PrivilegeConstants.REP_WRITE)));
  assertFalse(acMgr.hasPrivileges("/a/b",privilegesFromNames(PrivilegeConstants.JCR_REMOVE_NODE)));
  try {
    testRoot.getTree("/a").remove();
    testRoot.commit();
    fail();
  }
 catch (  CommitFailedException e) {
    assertTrue(e.isAccessViolation());
  }
}

</code></pre>

<br>
<pre class="type-9 type-5 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRemoveNodeWithJr2Flag2() throws Exception {
  setupPermission("/a",testPrincipal,true,PrivilegeConstants.JCR_READ,PrivilegeConstants.REP_WRITE);
  setupPermission("/a/b",testPrincipal,false,PrivilegeConstants.REP_REMOVE_PROPERTIES);
  Root testRoot=getTestRoot();
  AccessControlManager acMgr=getAccessControlManager(testRoot);
  assertTrue(acMgr.hasPrivileges("/a",privilegesFromNames(PrivilegeConstants.REP_WRITE)));
  assertFalse(acMgr.hasPrivileges("/a/b",privilegesFromNames(PrivilegeConstants.REP_REMOVE_PROPERTIES)));
  try {
    testRoot.getTree("/a").remove();
    testRoot.commit();
    fail();
  }
 catch (  CommitFailedException e) {
    assertTrue(e.isAccessViolation());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.authorization.evaluation.ShadowInvisibleContentTest </h4><pre class="type-5 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShadowInvisibleNode() throws Exception {
  setupPermission("/a",testPrincipal,true,PrivilegeConstants.JCR_ALL);
  setupPermission("/a/b",testPrincipal,false,PrivilegeConstants.JCR_ALL);
  setupPermission("/a/b/c",testPrincipal,true,PrivilegeConstants.JCR_ALL);
  Root testRoot=getTestRoot();
  Tree a=testRoot.getTree("/a");
  assertFalse(a.hasChild("b"));
  Tree b=a.addChild("b");
  assertTrue(a.hasChild("b"));
  assertFalse(b.hasChild("c"));
  try {
    testRoot.commit();
    fail();
  }
 catch (  CommitFailedException e) {
    assertTrue(e.isConstraintViolation());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.authorization.evaluation.TreeTest </h4><pre class="type-12 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
"></span><br>
/** 
 * @see <a href="https://issues.apache.org/jira/browse/OAK-842">OAK-842</a>
 */
@Test public void testOrderableChildren() throws Exception {
  Tree a=root.getTree("/a");
  a.setOrderableChildren(true);
  testRoot.refresh();
  for (  Tree t : testRoot.getTree("/a").getChildren()) {
    if (!"b".equals(t.getName())) {
      fail("Child " + t.getName() + " should not be accessible.");
    }
  }
}

</code></pre>

<br>
<pre class="type-12 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testGetChildren() throws Exception {
  for (  Tree t : testRoot.getTree("/a").getChildren()) {
    if (!"b".equals(t.getName())) {
      fail("Child " + t.getName() + " should not be accessible.");
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.authorization.permission.L5_SpecialPermissionsTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testUserManagement() throws RepositoryException {
  paths.add(UserConstants.DEFAULT_USER_PATH);
  AccessControlUtils.addAccessControlEntry(superuser,UserConstants.DEFAULT_USER_PATH,testGroupPrincipal,new String[]{Privilege.JCR_ALL},true);
  String adminPath=((JackrabbitSession)superuser).getUserManager().getAuthorizable(superuser.getUserID()).getPath();
  paths.add(adminPath);
  AccessControlUtils.addAccessControlEntry(superuser,adminPath,EveryonePrincipal.getInstance(),new String[]{PrivilegeConstants.REP_WRITE},false);
  JackrabbitSession s=(JackrabbitSession)createTestSession();
  User u2=s.getUserManager().getAuthorizable(testUser2.getID(),User.class);
  u2.changePassword("gugus");
  s.save();
  try {
    User admin=s.getUserManager().getAuthorizable(superuser.getUserID(),User.class);
    admin.changePassword("gugus");
    s.save();
    fail("privilege escalation!");
  }
 catch (  AccessDeniedException e) {
  }
 finally {
    s.refresh(false);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.authorization.permission.PermissionHookTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * ACE    :  0   1   2   3   4   5   6   7
 * Before :  tp  ev  p0  p1  p2  p3
 * After  :      p1      ev  p3  p2
 */
@Test public void testReorderAndRemoveAces() throws Exception {
  createPrincipals();
  AccessControlManager acMgr=getAccessControlManager(root);
  JackrabbitAccessControlList acl=AccessControlUtils.getAccessControlList(acMgr,testPath);
  for (int i=0; i < 4; i++) {
    acl.addAccessControlEntry(principals.get(i),privilegesFromNames(JCR_READ));
  }
  acMgr.setPolicy(testPath,acl);
  root.commit();
  AccessControlEntry[] aces=acl.getAccessControlEntries();
  acl.removeAccessControlEntry(aces[0]);
  acl.removeAccessControlEntry(aces[2]);
  acl.orderBefore(aces[4],null);
  acl.orderBefore(aces[3],aces[1]);
  acMgr.setPolicy(testPath,acl);
  root.commit();
  Tree entry=getEntry(EveryonePrincipal.NAME,testPath,1);
  assertIndex(1,entry);
  entry=getEntry(principals.get(2).getName(),testPath,3);
  assertIndex(3,entry);
  for (  String pName : new String[]{testPrincipalName,principals.get(0).getName()}) {
    try {
      getEntry(pName,testPath,0);
      fail();
    }
 catch (    RepositoryException e) {
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.authorization.permission.PermissionValidatorTest </h4><pre class="type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testChangePrimaryTypeToPolicyNode() throws Exception {
  testRootNode.getChild("child").addChild(AccessControlConstants.REP_POLICY,NT_UNSTRUCTURED);
  root.commit();
  grant(TEST_ROOT_PATH,PrivilegeConstants.JCR_READ,PrivilegeConstants.JCR_READ_ACCESS_CONTROL,PrivilegeConstants.REP_WRITE);
  ContentSession testSession=createTestSession();
  try {
    Root testRoot=testSession.getLatestRoot();
    Tree testChild=testRoot.getTree(TEST_CHILD_PATH);
    testChild.setProperty(PropertyStates.createProperty(JcrConstants.JCR_MIXINTYPES,ImmutableList.of(AccessControlConstants.MIX_REP_ACCESS_CONTROLLABLE),Type.NAMES));
    Tree testPolicy=testChild.getChild(AccessControlConstants.REP_POLICY);
    testPolicy.setOrderableChildren(true);
    testPolicy.setProperty(JCR_PRIMARYTYPE,AccessControlConstants.NT_REP_ACL,Type.NAME);
    testRoot.commit();
    fail("Turning a false policy node into access control content requires the ability to write AC content.");
  }
 catch (  CommitFailedException e) {
    assertTrue(e.isAccessViolation());
    assertEquals(0,e.getCode());
  }
 finally {
    testSession.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.authorization.restriction.CustomRestrictionProviderTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * Tests the custom restriction provider that checks on the existence of a property.
 * @throws Exception
 */
@Test public void testProtectByRestriction() throws Exception {
  addEntry(TEST_ROOT_PATH,true,"",PrivilegeConstants.JCR_READ,PrivilegeConstants.REP_WRITE);
  addEntry(TEST_A_PATH,false,PROP_NAME_PROTECT_ME,PrivilegeConstants.JCR_REMOVE_NODE);
  ContentSession testSession=createTestSession();
  try {
    Root testRoot=testSession.getLatestRoot();
    PermissionProvider pp=getPermissionProvider(testSession);
    assertIsGranted(pp,testRoot,true,TEST_A_PATH,Permissions.REMOVE_NODE);
    assertIsGranted(pp,testRoot,true,TEST_B_PATH,Permissions.REMOVE_NODE);
    assertIsGranted(pp,testRoot,false,TEST_C_PATH,Permissions.REMOVE_NODE);
    assertIsGranted(pp,testRoot,true,TEST_D_PATH,Permissions.REMOVE_NODE);
    assertIsGranted(pp,testRoot,true,TEST_E_PATH,Permissions.REMOVE_NODE);
    testRoot.getTree(TEST_D_PATH).remove();
    testRoot.commit();
    try {
      testRoot.getTree(TEST_C_PATH).remove();
      testRoot.commit();
      fail("should not be able to delete " + TEST_C_PATH);
    }
 catch (    CommitFailedException e) {
    }
  }
  finally {
    testSession.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.authorization.restriction.GlobPatternTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMaxOccurrences(){
  GlobPattern gp=GlobPattern.create("/","1*/2*/3*/4*/5*/6*/7*/8*/9*/10*/11*/12*/13*/14*/15*/16*/17*/18*/19*/20*/21*");
  try {
    gp.matches("/1/2/3/4/5/6/7/8/9/10/11/12/13/14/15/16/17/18/19/20/21");
    fail();
  }
 catch (  IllegalArgumentException e) {
  }
  ;
  try {
    gp.matches("/11/22/33/44/55/66/77/88/99/100/111/122/133/144/155/166/177/188/199/200/211");
    fail();
  }
 catch (  IllegalArgumentException e) {
  }
  ;
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.authorization.restriction.ItemNameRestrictionTest </h4><pre class="type-5 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testModifyProperty() throws Exception {
  Root testRoot=testSession.getLatestRoot();
  Tree c=testRoot.getTree("/a/d/b/e/c");
  try {
    c.setProperty("a","anyvalue");
    testRoot.commit();
    fail();
  }
 catch (  CommitFailedException e) {
    assertTrue(e.isAccessViolation());
  }
 finally {
    testRoot.refresh();
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRemoveTree() throws Exception {
  Root testRoot=testSession.getLatestRoot();
  List<String> paths=ImmutableList.of("/a/d/b/e/c","/a/d/b","/a");
  for (  String p : paths) {
    try {
      testRoot.getTree(p).remove();
      testRoot.commit();
      fail();
    }
 catch (    CommitFailedException e) {
      assertTrue(e.isAccessViolation());
    }
 finally {
      testRoot.refresh();
    }
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddProperty() throws Exception {
  Root testRoot=testSession.getLatestRoot();
  List<String> paths=ImmutableList.of("/a","/a/d/b","/a/d/b/e/c");
  for (  String p : paths) {
    Tree t=testRoot.getTree(p);
    t.setProperty("b","anyvalue");
    testRoot.commit();
  }
  for (  String p : paths) {
    Tree t=testRoot.getTree(p);
    try {
      t.setProperty("notAllowed","anyvalue");
      testRoot.commit();
      fail();
    }
 catch (    CommitFailedException e) {
      assertTrue(e.isAccessViolation());
    }
 finally {
      testRoot.refresh();
    }
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRemoveTree2() throws Exception {
  AccessControlManager acMgr=getAccessControlManager(root);
  JackrabbitAccessControlList acl=AccessControlUtils.getAccessControlList(acMgr,"/a");
  acl.addEntry(testPrincipal,privilegesFromNames(PrivilegeConstants.JCR_READ,PrivilegeConstants.JCR_REMOVE_CHILD_NODES),true);
  acMgr.setPolicy(acl.getPath(),acl);
  root.commit();
  Root testRoot=testSession.getLatestRoot();
  List<String> paths=ImmutableList.of("/a/d/b/e/c","/a/d/b");
  for (  String p : paths) {
    testRoot.getTree(p).remove();
    testRoot.commit();
  }
  try {
    testRoot.getTree("/a").remove();
    testRoot.commit();
    fail();
  }
 catch (  CommitFailedException e) {
    assertTrue(e.isAccessViolation());
  }
 finally {
    testRoot.refresh();
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testModifyMembersOnly() throws Exception {
  AccessControlManager acMgr=getAccessControlManager(root);
  String path=PathUtils.getAncestorPath(UserConstants.DEFAULT_USER_PATH,1);
  try {
    JackrabbitAccessControlList acl=AccessControlUtils.getAccessControlList(acMgr,path);
    acl.addEntry(testPrincipal,privilegesFromNames(PrivilegeConstants.JCR_READ),true);
    acl.addEntry(testPrincipal,privilegesFromNames(PrivilegeConstants.REP_USER_MANAGEMENT),true,Collections.<String,Value>emptyMap(),ImmutableMap.<String,Value[]>of(AccessControlConstants.REP_ITEM_NAMES,new Value[]{vf.createValue(UserConstants.REP_MEMBERS,PropertyType.NAME)}));
    acMgr.setPolicy(acl.getPath(),acl);
    root.commit();
    Root testRoot=testSession.getLatestRoot();
    UserManager uMgr=getUserManager(testRoot);
    Group gr=uMgr.getAuthorizable(testGroup.getID(),Group.class);
    User u=uMgr.getAuthorizable(getTestUser().getID(),User.class);
    gr.addMember(u);
    testRoot.commit();
    try {
      u.changePassword("blub");
      testRoot.commit();
      fail();
    }
 catch (    CommitFailedException e) {
      assertTrue(e.isAccessViolation());
    }
 finally {
      testRoot.refresh();
    }
  }
 catch (  CommitFailedException e) {
    assertTrue(e.isAccessViolation());
  }
 finally {
    JackrabbitAccessControlList acl=AccessControlUtils.getAccessControlList(acMgr,path);
    if (acl != null) {
      acMgr.removePolicy(acl.getPath(),acl);
      root.commit();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.authorization.restriction.PermissionTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * Tests if the restrictions are properly inherited.
 * the restriction enable/disable the ACE where it is defined.
 * since the 'deny' on /a/b is after the 'allow' on a/b/c, the deny wins.
 */
@Test public void testHasPermissionWithRestrictions2() throws Exception {
  addEntry(TEST_ROOT_PATH,true,"",PrivilegeConstants.JCR_READ,PrivilegeConstants.REP_WRITE);
  addEntry(TEST_A_PATH,true,"*/b",PrivilegeConstants.JCR_REMOVE_NODE);
  addEntry(TEST_A_PATH,false,"*/c",PrivilegeConstants.JCR_REMOVE_NODE);
  ContentSession testSession=createTestSession();
  try {
    Root testRoot=testSession.getLatestRoot();
    PermissionProvider pp=getPermissionProvider(testSession);
    assertIsGranted(pp,testRoot,true,TEST_A_PATH,Permissions.REMOVE_NODE);
    assertIsGranted(pp,testRoot,true,TEST_B_PATH,Permissions.REMOVE_NODE);
    assertIsGranted(pp,testRoot,false,TEST_C_PATH,Permissions.REMOVE_NODE);
    assertIsGranted(pp,testRoot,true,TEST_D_PATH,Permissions.REMOVE_NODE);
    testRoot.getTree(TEST_D_PATH).remove();
    testRoot.commit();
    try {
      testRoot.getTree(TEST_C_PATH).remove();
      testRoot.commit();
      fail("should not be able to delete " + TEST_C_PATH);
    }
 catch (    CommitFailedException e) {
      testRoot.refresh();
    }
  }
  finally {
    testSession.close();
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * Tests if the restrictions are properly inherited.
 * the restriction enable/disable the ACE where it is defined.
 * since the 'allow' on /a/b is after the 'deny' on a/b/c, the allow wins.
 * The test currently fails on evaluation of /a/b/c/d. Probably because the evaluation
 * of /a/b/c yields a deny, which terminates the iteration.
 */
@Test public void testHasPermissionWithRestrictions() throws Exception {
  addEntry(TEST_ROOT_PATH,true,"",PrivilegeConstants.JCR_READ,PrivilegeConstants.REP_WRITE);
  addEntry(TEST_A_PATH,false,"*/c",PrivilegeConstants.JCR_REMOVE_NODE);
  addEntry(TEST_A_PATH,true,"*/b",PrivilegeConstants.JCR_REMOVE_NODE);
  ContentSession testSession=createTestSession();
  try {
    Root testRoot=testSession.getLatestRoot();
    PermissionProvider pp=getPermissionProvider(testSession);
    assertIsGranted(pp,testRoot,true,TEST_A_PATH,Permissions.REMOVE_NODE);
    assertIsGranted(pp,testRoot,true,TEST_B_PATH,Permissions.REMOVE_NODE);
    assertIsGranted(pp,testRoot,false,TEST_C_PATH,Permissions.REMOVE_NODE);
    assertIsGranted(pp,testRoot,true,TEST_D_PATH,Permissions.REMOVE_NODE);
    assertIsGranted(pp,testRoot,true,TEST_E_PATH,Permissions.REMOVE_NODE);
    testRoot.getTree(TEST_D_PATH).remove();
    testRoot.commit();
    try {
      testRoot.getTree(TEST_C_PATH).remove();
      testRoot.commit();
      fail("user should not be able to remove c");
    }
 catch (    CommitFailedException e) {
    }
  }
  finally {
    testSession.close();
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testHasPermission() throws Exception {
  addEntry(TEST_ROOT_PATH,true,"",PrivilegeConstants.JCR_READ,PrivilegeConstants.REP_WRITE);
  addEntry(TEST_B_PATH,true,"",PrivilegeConstants.JCR_REMOVE_NODE);
  addEntry(TEST_C_PATH,false,"",PrivilegeConstants.JCR_REMOVE_NODE);
  ContentSession testSession=createTestSession();
  try {
    Root testRoot=testSession.getLatestRoot();
    PermissionProvider pp=getPermissionProvider(testSession);
    assertIsGranted(pp,testRoot,true,TEST_A_PATH,Permissions.REMOVE_NODE);
    assertIsGranted(pp,testRoot,true,TEST_B_PATH,Permissions.REMOVE_NODE);
    assertIsGranted(pp,testRoot,false,TEST_C_PATH,Permissions.REMOVE_NODE);
    try {
      testRoot.getTree(TEST_C_PATH).remove();
      testRoot.commit();
      fail("removing node on /a/b/c should fail");
    }
 catch (    CommitFailedException e) {
    }
  }
  finally {
    testSession.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.authorization.restriction.RestrictionProviderImplTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testValidateGlobRestriction() throws Exception {
  Tree t=new NodeUtil(root.getTree("/")).addChild("testTree","nt:unstructured").getTree();
  String path=t.getPath();
  AccessControlManager acMgr=getAccessControlManager(root);
  List<String> globs=ImmutableList.of("/1*/2*/3*/4*/5*/6*/7*/8*/9*/10*/11*/12*/13*/14*/15*/16*/17*/18*/19*/20*/21*","*********************");
  for (  String glob : globs) {
    JackrabbitAccessControlList acl=AccessControlUtils.getAccessControlList(acMgr,path);
    acl.addEntry(getTestPrincipal(),AccessControlUtils.privilegesFromNames(acMgr,PrivilegeConstants.JCR_READ),true,Collections.singletonMap(REP_GLOB,getValueFactory().createValue(glob)));
    acMgr.setPolicy(path,acl);
    try {
      provider.validateRestrictions(path,t.getChild(REP_POLICY).getChild("allow"));
      fail("AccessControlException expected.");
    }
 catch (    AccessControlException e) {
    }
 finally {
      acMgr.removePolicy(path,acl);
    }
  }
}

</code></pre>

<br>
<pre class="type-12 type-5 type-7 type-6 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetSupportedDefinitions(){
  assertTrue(provider.getSupportedRestrictions(null).isEmpty());
  Set<RestrictionDefinition> defs=provider.getSupportedRestrictions("/testPath");
  assertNotNull(defs);
  assertEquals(4,defs.size());
  for (  RestrictionDefinition def : defs) {
    if (REP_GLOB.equals(def.getName())) {
      assertEquals(Type.STRING,def.getRequiredType());
      assertFalse(def.isMandatory());
    }
 else     if (REP_NT_NAMES.equals(def.getName())) {
      assertEquals(Type.NAMES,def.getRequiredType());
      assertFalse(def.isMandatory());
    }
 else     if (REP_PREFIXES.equals(def.getName())) {
      assertEquals(Type.STRINGS,def.getRequiredType());
      assertFalse(def.isMandatory());
    }
 else     if (REP_ITEM_NAMES.equals(def.getName())) {
      assertEquals(Type.NAMES,def.getRequiredType());
      assertFalse(def.isMandatory());
    }
 else {
      fail("unexpected restriction " + def.getName());
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.privilege.PrivilegeDefinitionWriterTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testMissingPrivilegeRoot() throws Exception {
  ContentRepository repo=new Oak().with(new OpenSecurityProvider()).createContentRepository();
  Root tmpRoot=repo.login(null,null).getLatestRoot();
  try {
    PrivilegeDefinitionWriter writer=new PrivilegeDefinitionWriter(tmpRoot);
    writer.writeDefinition(new ImmutablePrivilegeDefinition("newName",true,null));
    fail("missing privilege root");
  }
 catch (  RepositoryException e) {
  }
 finally {
    tmpRoot.getContentSession().close();
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testNameCollision(){
  try {
    PrivilegeDefinitionWriter writer=new PrivilegeDefinitionWriter(root);
    writer.writeDefinition(new ImmutablePrivilegeDefinition(JCR_READ,true,null));
    fail("name collision");
  }
 catch (  RepositoryException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.privilege.PrivilegeValidatorTest </h4><pre class="type-5 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBitsConflict(){
  try {
    Tree privTree=createPrivilegeTree();
    bitsProvider.getBits(JCR_READ).writeTo(privTree);
    root.commit();
    fail("Conflicting privilege bits property must be detected.");
  }
 catch (  CommitFailedException e) {
    assertEquals("OakConstraint0049: PrivilegeBits already in used.",e.getMessage());
  }
 finally {
    root.refresh();
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMissingPrivilegeBits(){
  try {
    createPrivilegeTree();
    root.commit();
    fail("Missing privilege bits property must be detected.");
  }
 catch (  CommitFailedException e) {
    assertTrue(e.isConstraintViolation());
  }
 finally {
    root.refresh();
  }
}

</code></pre>

<br>
<pre class="type-5 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNextNotUpdated(){
  try {
    Tree privTree=createPrivilegeTree();
    PrivilegeBits.getInstance(privilegesTree).writeTo(privTree);
    root.commit();
    fail("Outdated rep:next property must be detected.");
  }
 catch (  CommitFailedException e) {
    assertEquals("OakConstraint0043: Next bits not updated",e.getMessage());
  }
 finally {
    root.refresh();
  }
}

</code></pre>

<br>
<pre class="type-5 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSingularAggregation(){
  try {
    Tree privTree=createPrivilegeTree();
    privTree.setProperty(PropertyStates.createProperty(REP_AGGREGATES,Collections.singletonList(JCR_READ),Type.NAMES));
    PrivilegeBits.getInstance(bitsProvider.getBits(JCR_READ)).writeTo(privTree);
    root.commit();
    fail("Aggregation of a single privilege is invalid.");
  }
 catch (  CommitFailedException e) {
    assertEquals("OakConstraint0050: Singular aggregation is equivalent to existing privilege.",e.getMessage());
  }
 finally {
    root.refresh();
  }
}

</code></pre>

<br>
<pre class="type-5 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBitsConflictWithAggregation(){
  try {
    Tree privTree=createPrivilegeTree();
    privTree.setProperty(PropertyStates.createProperty(REP_AGGREGATES,ImmutableList.of(JCR_READ,JCR_MODIFY_PROPERTIES),Type.NAMES));
    setPrivilegeBits(privTree,REP_BITS,340);
    root.commit();
    fail("Privilege bits don't match the aggregation.");
  }
 catch (  CommitFailedException e) {
    assertEquals("OakConstraint0053: Invalid privilege bits for aggregated privilege definition.",e.getMessage());
  }
 finally {
    root.refresh();
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAggregatesIncludesJcrAll() throws Exception {
  try {
    Tree privTree=createPrivilegeTree();
    privTree.setProperty(PropertyStates.createProperty(REP_AGGREGATES,ImmutableList.of(JCR_ALL,JCR_READ,JCR_WRITE),Type.NAMES));
    PrivilegeBits.getInstance(bitsProvider.getBits(JCR_ALL,JCR_READ,JCR_WRITE)).writeTo(privTree);
    root.commit();
    fail("Aggregation containing jcr:all is invalid.");
  }
 catch (  CommitFailedException e) {
    assertTrue(e.isConstraintViolation());
    assertEquals(53,e.getCode());
  }
 finally {
    root.refresh();
  }
}

</code></pre>

<br>
<pre class="type-5 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testChangeNext(){
  try {
    setPrivilegeBits(bitsProvider.getPrivilegesTree(),REP_NEXT,1);
    root.commit();
    fail("Outdated rep:next property must be detected.");
  }
 catch (  CommitFailedException e) {
    assertEquals("OakConstraint0043: Next bits not updated",e.getMessage());
  }
 finally {
    root.refresh();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.user.AbstractAddMembersByIdTest </h4><pre class="type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCyclicMembership() throws Exception {
  memberGroup.addMember(testGroup);
  root.commit();
  Set<String> failed=testGroup.addMembers(memberGroup.getID());
  assertTrue(failed.isEmpty());
  try {
    root.commit();
    fail("cyclic group membership must be detected upon commit");
  }
 catch (  CommitFailedException e) {
    assertTrue(e.isConstraintViolation());
    assertEquals(31,e.getCode());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.user.AddMembersByIdBestEffortTest </h4><pre class="type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCyclicWithoutAccess() throws Exception {
  memberGroup.addMember(testGroup);
  root.commit();
  try {
    Set<String> failed=addExistingMemberWithoutAccess();
    fail("CommitFailedException expected");
  }
 catch (  CommitFailedException e) {
    assertTrue(e.isConstraintViolation());
    assertEquals(31,e.getCode());
  }
 finally {
    root.refresh();
    assertFalse(testGroup.isMember(memberGroup));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.user.CacheValidatorProviderTest </h4><pre class="type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateCacheBelowProfile() throws Exception {
  try {
    NodeUtil node=new NodeUtil(getAuthorizableTree(getTestUser()));
    NodeUtil child=node.addChild("profile",NodeTypeConstants.NT_OAK_UNSTRUCTURED);
    child.addChild(CacheConstants.REP_CACHE,CacheConstants.NT_REP_CACHE).setLong(CacheConstants.REP_EXPIRATION,23);
    root.commit(CacheValidatorProvider.asCommitAttributes());
    fail("Creating rep:cache node below a user or group must fail.");
  }
 catch (  CommitFailedException e) {
    assertTrue(e.isConstraintViolation());
    assertEquals(34,e.getCode());
  }
 finally {
    root.refresh();
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testModifyCache() throws Exception {
  List<PropertyState> props=new ArrayList();
  props.add(PropertyStates.createProperty(CacheConstants.REP_EXPIRATION,25));
  props.add(PropertyStates.createProperty(CacheConstants.REP_GROUP_PRINCIPAL_NAMES,EveryonePrincipal.NAME));
  props.add(PropertyStates.createProperty(JcrConstants.JCR_PRIMARYTYPE,JcrConstants.NT_UNSTRUCTURED,Type.NAME));
  props.add(PropertyStates.createProperty("residualProp","anyvalue"));
  Tree cache=getCache(getTestUser());
  for (  PropertyState prop : props) {
    try {
      cache.setProperty(prop);
      root.commit(CacheValidatorProvider.asCommitAttributes());
      fail("Modifying rep:cache node below a user or group must fail.");
    }
 catch (    CommitFailedException e) {
      assertTrue(e.isConstraintViolation());
      assertEquals(34,e.getCode());
    }
 finally {
      root.refresh();
    }
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateCacheByName() throws RepositoryException {
  for (  Authorizable a : authorizables) {
    try {
      NodeUtil node=new NodeUtil(getAuthorizableTree(a));
      node.addChild(CacheConstants.REP_CACHE,JcrConstants.NT_UNSTRUCTURED);
      root.commit();
      fail("Creating rep:cache node below a user or group must fail.");
    }
 catch (    CommitFailedException e) {
      assertTrue(e.isConstraintViolation());
      assertEquals(34,e.getCode());
    }
 finally {
      root.refresh();
    }
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateCacheWithCommitInfo() throws RepositoryException {
  for (  Authorizable a : authorizables) {
    try {
      NodeUtil node=new NodeUtil(getAuthorizableTree(a));
      NodeUtil cache=node.addChild(CacheConstants.REP_CACHE,CacheConstants.NT_REP_CACHE);
      cache.setLong(CacheConstants.REP_EXPIRATION,1);
      root.commit(CacheValidatorProvider.asCommitAttributes());
      fail("Creating rep:cache node below a user or group must fail.");
    }
 catch (    CommitFailedException e) {
      assertTrue(e.isConstraintViolation());
      assertEquals(34,e.getCode());
    }
 finally {
      root.refresh();
    }
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testChangePrimaryType() throws RepositoryException {
  for (  Authorizable a : authorizables) {
    try {
      NodeUtil node=new NodeUtil(getAuthorizableTree(a));
      NodeUtil cache=node.addChild("childNode",JcrConstants.NT_UNSTRUCTURED);
      root.commit();
      cache.setName(JcrConstants.JCR_PRIMARYTYPE,CacheConstants.NT_REP_CACHE);
      cache.setLong(CacheConstants.REP_EXPIRATION,1);
      root.commit();
      fail("Changing primary type of residual node below an user/group to rep:Cache must fail.");
    }
 catch (    CommitFailedException e) {
      assertTrue(e.isConstraintViolation());
      assertEquals(34,e.getCode());
    }
 finally {
      root.refresh();
    }
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateCacheBelowPersistedProfile() throws Exception {
  try {
    NodeUtil node=new NodeUtil(getAuthorizableTree(getTestUser()));
    NodeUtil child=node.addChild("profile",NodeTypeConstants.NT_OAK_UNSTRUCTURED);
    root.commit();
    child.addChild(CacheConstants.REP_CACHE,CacheConstants.NT_REP_CACHE).setLong(CacheConstants.REP_EXPIRATION,23);
    root.commit(CacheValidatorProvider.asCommitAttributes());
    fail("Creating rep:cache node below a user or group must fail.");
  }
 catch (  CommitFailedException e) {
    assertTrue(e.isConstraintViolation());
    assertEquals(34,e.getCode());
  }
 finally {
    root.refresh();
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateCacheOutsideOfAuthorizable() throws Exception {
  NodeUtil n=new NodeUtil(root.getTree("/"));
  try {
    NodeUtil child=n.addChild(CacheConstants.REP_CACHE,CacheConstants.NT_REP_CACHE);
    child.setLong(CacheConstants.REP_EXPIRATION,1);
    root.commit();
    fail("Using rep:cache/rep:Cache outside a user or group must fail.");
  }
 catch (  CommitFailedException e) {
    assertTrue(e.isConstraintViolation());
    assertEquals(34,e.getCode());
  }
 finally {
    root.refresh();
    Tree c=n.getTree().getChild(CacheConstants.REP_CACHE);
    if (c.exists()) {
      c.remove();
      root.commit();
    }
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNestedCache() throws Exception {
  NodeUtil cache=new NodeUtil(getCache(getTestUser()));
  try {
    NodeUtil c=cache.getOrAddChild(CacheConstants.REP_CACHE,CacheConstants.NT_REP_CACHE);
    c.setLong(CacheConstants.REP_EXPIRATION,223);
    root.commit(CacheValidatorProvider.asCommitAttributes());
    fail("Creating nested cache must fail.");
  }
 catch (  CommitFailedException e) {
    assertTrue(e.isConstraintViolation());
    assertEquals(34,e.getCode());
  }
 finally {
    root.refresh();
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateCacheByNodeType() throws RepositoryException {
  for (  Authorizable a : authorizables) {
    try {
      NodeUtil node=new NodeUtil(getAuthorizableTree(a));
      NodeUtil cache=node.addChild("childNode",CacheConstants.NT_REP_CACHE);
      cache.setLong(CacheConstants.REP_EXPIRATION,1);
      root.commit();
      fail("Creating node with nt rep:Cache below a user or group must fail.");
    }
 catch (    CommitFailedException e) {
      assertTrue(e.isConstraintViolation());
      assertEquals(34,e.getCode());
    }
 finally {
      root.refresh();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.user.IntermediatePathTest </h4><pre class="type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRelativePaths() throws Exception {
  new NodeUtil(root.getTree("/")).addChild("testNode",NodeTypeConstants.NT_OAK_UNSTRUCTURED);
  List<String> invalidPaths=ImmutableList.of("..","../..","../../..","../../../testNode","a/b/../../../c");
  for (  String relPath : invalidPaths) {
    try {
      Authorizable authorizable=createAuthorizable(false,relPath);
      root.commit();
      fail("Invalid path " + relPath + " outside of configured scope.");
    }
 catch (    CommitFailedException e) {
      assertTrue(e.isConstraintViolation());
      assertEquals(28,e.getCode());
    }
 finally {
      root.refresh();
    }
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testInvalidAbsolutePaths() throws Exception {
  new NodeUtil(root.getTree("/")).addChild("testNode",NodeTypeConstants.NT_OAK_UNSTRUCTURED);
  List<String> invalidPaths=ImmutableList.of("/",PathUtils.getAncestorPath(UserConstants.DEFAULT_GROUP_PATH,1),PathUtils.getAncestorPath(UserConstants.DEFAULT_GROUP_PATH,2),"/testNode","/nonExisting");
  for (  String absPath : invalidPaths) {
    try {
      createAuthorizable(false,absPath);
      fail("Invalid path " + absPath + " outside of configured scope.");
    }
 catch (    ConstraintViolationException e) {
    }
 finally {
      root.refresh();
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAbsolutePathsWithInvalidParentElements() throws Exception {
  try {
    String invalidPath=UserConstants.DEFAULT_GROUP_PATH + "/../a";
    Authorizable authorizable=createAuthorizable(true,invalidPath);
    assertTrue(authorizable.getPath().startsWith(PathUtils.getAncestorPath(UserConstants.DEFAULT_GROUP_PATH,1) + "/a"));
    root.commit();
    fail("Invalid path " + invalidPath + " outside of configured scope.");
  }
 catch (  CommitFailedException e) {
    assertTrue(e.isConstraintViolation());
    assertEquals(28,e.getCode());
  }
 finally {
    root.refresh();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.user.L15_RepositoryWithoutAnonymousTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testAnonymousLogin() throws Exception {
  ContentSession oakSession=null;
  try {
    oakSession=login(new GuestCredentials());
    fail("Anonymous login must fail.");
  }
 catch (  javax.security.auth.login.LoginException e) {
  }
 finally {
    if (oakSession != null) {
      oakSession.close();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.user.PasswordExpiryAndForceInitialChangeTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testAuthenticateMustChangePassword() throws Exception {
  Authentication a=new UserAuthentication(getUserConfiguration(),root,userId);
  try {
    a.authenticate(new SimpleCredentials(userId,userId.toCharArray()));
    fail("Credentials should be expired");
  }
 catch (  CredentialExpiredException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.user.PasswordExpiryHistoryTest </h4><pre class="type-9 type-5 type-6 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAuthenticatePasswordExpiredAndValidationFailure() throws Exception {
  User user=getTestUser();
  Authentication a=new UserAuthentication(getUserConfiguration(),root,userId);
  root.getTree(user.getPath()).getChild(UserConstants.REP_PWD).setProperty(UserConstants.REP_PASSWORD_LAST_MODIFIED,0);
  root.commit();
  try {
    a.authenticate(new SimpleCredentials(userId,userId.toCharArray()));
    fail("Credentials should be expired");
  }
 catch (  CredentialExpiredException e) {
    SimpleCredentials pwChangeCreds=new SimpleCredentials(userId,userId.toCharArray());
    try {
      pwChangeCreds.setAttribute(UserConstants.CREDENTIALS_ATTRIBUTE_NEWPASSWORD,"2");
      a.authenticate(pwChangeCreds);
      fail("User password changed in spite of expected validation failure");
    }
 catch (    CredentialExpiredException c) {
      assertNull(pwChangeCreds.getAttribute(PasswordHistoryException.class.getSimpleName()));
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-5 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAuthenticatePasswordExpiredAndSame() throws Exception {
  User user=getTestUser();
  Authentication a=new UserAuthentication(getUserConfiguration(),root,userId);
  root.getTree(user.getPath()).getChild(UserConstants.REP_PWD).setProperty(UserConstants.REP_PASSWORD_LAST_MODIFIED,0);
  root.commit();
  try {
    a.authenticate(new SimpleCredentials(userId,userId.toCharArray()));
    fail("Credentials should be expired");
  }
 catch (  CredentialExpiredException e) {
    SimpleCredentials pwChangeCreds=new SimpleCredentials(userId,userId.toCharArray());
    try {
      pwChangeCreds.setAttribute(UserConstants.CREDENTIALS_ATTRIBUTE_NEWPASSWORD,user.getID());
      a.authenticate(pwChangeCreds);
      fail("User password changed in spite of enabled pw history");
    }
 catch (    CredentialExpiredException c) {
      Object attr=pwChangeCreds.getAttribute(PasswordHistoryException.class.getSimpleName());
      assertEquals("credentials should contain pw change failure reason","New password is identical to the current password.",attr);
    }
  }
}

</code></pre>

<br>
<pre class="type-5 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAuthenticatePasswordExpiredAndInHistory() throws Exception {
  User user=getTestUser();
  user.changePassword("pw12345678");
  Authentication a=new UserAuthentication(getUserConfiguration(),root,userId);
  root.getTree(user.getPath()).getChild(UserConstants.REP_PWD).setProperty(UserConstants.REP_PASSWORD_LAST_MODIFIED,0);
  root.commit();
  try {
    a.authenticate(new SimpleCredentials(userId,"pw12345678".toCharArray()));
    fail("Credentials should be expired");
  }
 catch (  CredentialExpiredException e) {
    SimpleCredentials pwChangeCreds=new SimpleCredentials(userId,"pw12345678".toCharArray());
    try {
      pwChangeCreds.setAttribute(UserConstants.CREDENTIALS_ATTRIBUTE_NEWPASSWORD,user.getID());
      a.authenticate(pwChangeCreds);
      fail("User password changed in spite of enabled pw history");
    }
 catch (    CredentialExpiredException c) {
      Object attr=pwChangeCreds.getAttribute(PasswordHistoryException.class.getSimpleName());
      assertEquals("credentials should contain pw change failure reason","New password was found in password history.",attr);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.user.PasswordExpiryTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testAuthenticatePasswordExpired() throws Exception {
  Authentication a=new UserAuthentication(getUserConfiguration(),root,userId);
  root.getTree(getTestUser().getPath()).getChild(UserConstants.REP_PWD).setProperty(UserConstants.REP_PASSWORD_LAST_MODIFIED,0);
  root.commit();
  try {
    a.authenticate(new SimpleCredentials(userId,userId.toCharArray()));
    fail("Credentials should be expired");
  }
 catch (  CredentialExpiredException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testAuthenticateBeforePasswordExpired() throws Exception {
  Authentication a=new UserAuthentication(getUserConfiguration(),root,userId);
  root.getTree(getTestUser().getPath()).getChild(UserConstants.REP_PWD).setProperty(UserConstants.REP_PASSWORD_LAST_MODIFIED,0);
  root.commit();
  try {
    a.authenticate(new SimpleCredentials(userId,"wrong".toCharArray()));
  }
 catch (  CredentialExpiredException e) {
    fail("Login should fail before expiry");
  }
catch (  LoginException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.user.PasswordForceInitialPasswordChangeTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testAuthenticateMustChangePassword() throws Exception {
  Authentication a=new UserAuthentication(getUserConfiguration(),root,userId);
  try {
    a.authenticate(new SimpleCredentials(userId,userId.toCharArray()));
    fail("Credentials should be expired");
  }
 catch (  CredentialExpiredException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.user.PasswordHistoryTest </h4><pre class="type-5 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNoHistoryUpdateOnViolation() throws Exception {
  User user=getTestUser();
  try {
    user.changePassword("abc");
    user.changePassword("def");
    user.changePassword("abc");
    fail("history violation not detected");
  }
 catch (  ConstraintViolationException e) {
    String[] expected=new String[]{user.getID(),"abc"};
    int i=0;
    for (    String pwHash : getHistory(user)) {
      assertTrue(PasswordUtil.isSame(pwHash,expected[i++]));
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.user.ResetExpiredPasswordTest </h4><pre class="type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testChangeWithNonStringAttribute() throws Exception {
  try {
    authenticate(userId,new Long(1));
    fail("Authentication with non-string attribute should fail.");
  }
 catch (  CredentialExpiredException e) {
  }
 finally {
    Tree userTree=root.getTree(getTestUser().getPath());
    assertTrue(PasswordUtil.isSame(userTree.getProperty(UserConstants.REP_PASSWORD).getValue(Type.STRING),userId));
    assertEquals(0,userTree.getChild(UserConstants.REP_PWD).getProperty(UserConstants.REP_PASSWORD_LAST_MODIFIED).getValue(Type.LONG).longValue());
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testChangeWithWrongPw() throws Exception {
  try {
    authenticate("wrongPw","newPw");
    fail("Authentication with wrong expired password should fail and should not reset pw.");
  }
 catch (  LoginException e) {
  }
 finally {
    Tree userTree=root.getTree(getTestUser().getPath());
    assertTrue(PasswordUtil.isSame(userTree.getProperty(UserConstants.REP_PASSWORD).getValue(Type.STRING),userId));
    assertEquals(0,userTree.getChild(UserConstants.REP_PWD).getProperty(UserConstants.REP_PASSWORD_LAST_MODIFIED).getValue(Type.LONG).longValue());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.user.SystemUserImplTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testImpersonateDisabledSystemUser() throws Exception {
  user=createUser(null);
  user.disable("disabled");
  root.commit();
  try {
    ContentSession cs=login(new ImpersonationCredentials(new SimpleCredentials(uid,new char[0]),adminSession.getAuthInfo()));
    cs.close();
    fail();
  }
 catch (  LoginException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCreateUserWithAbsolutePath2() throws Exception {
  try {
    user=createUser(UserConstants.DEFAULT_USER_PATH + "/any/path/to/the/new/user");
    fail("ConstraintViolationException expected");
  }
 catch (  ConstraintViolationException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCreateUserWithRelativePath() throws Exception {
  try {
    user=createUser("any/path");
    fail("ConstraintViolationException expected");
  }
 catch (  ConstraintViolationException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * @since OAK 1.0 In contrast to Jackrabbit core the intermediate path may
 * not be an absolute path in OAK.
 */
@Test public void testCreateUserWithAbsolutePath() throws Exception {
  try {
    user=createUser("/any/path/to/the/new/user");
    fail("ConstraintViolationException expected");
  }
 catch (  ConstraintViolationException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testLoginAsSystemUser() throws Exception {
  user=createUser(null);
  try {
    login(new SimpleCredentials(uid,new char[0])).close();
    fail();
  }
 catch (  LoginException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testLoginAsSystemUser2() throws Exception {
  user=createUser(null);
  try {
    login(user.getCredentials()).close();
    fail();
  }
 catch (  LoginException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateSystemUserWithOtherPath() throws Exception {
  String path=null;
  try {
    Tree t=root.getTree(UserConstants.DEFAULT_USER_PATH);
    NodeUtil systemUserTree=new NodeUtil(t).addChild("systemUser",UserConstants.NT_REP_SYSTEM_USER);
    systemUserTree.setString(UserConstants.REP_PRINCIPAL_NAME,"systemUser");
    systemUserTree.setString(UserConstants.REP_AUTHORIZABLE_ID,"systemUser");
    path=systemUserTree.getTree().getPath();
    root.commit();
    fail();
  }
 catch (  CommitFailedException e) {
    assertTrue(e.isConstraintViolation());
  }
 finally {
    root.refresh();
    if (path != null) {
      Tree t=root.getTree(path);
      if (t.exists()) {
        t.remove();
        root.commit();
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.user.UserAuthenticationTest </h4><pre class="type-5 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAuthenticateIdMismatch() throws Exception {
  try {
    authentication.authenticate(new SimpleCredentials("unknownUser","pw".toCharArray()));
    fail("LoginException expected");
  }
 catch (  LoginException e) {
    assertTrue(e instanceof FailedLoginException);
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAuthenticateResolvesToGroup() throws Exception {
  Group g=getUserManager(root).createGroup("g1");
  SimpleCredentials sc=new SimpleCredentials(g.getID(),"pw".toCharArray());
  Authentication a=new UserAuthentication(getUserConfiguration(),root,sc.getUserID());
  try {
    a.authenticate(sc);
    fail("Authenticating Group should fail");
  }
 catch (  LoginException e) {
    assertTrue(e instanceof AccountNotFoundException);
  }
 finally {
    if (g != null) {
      g.remove();
      root.commit();
    }
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAuthenticateInvalidImpersonationCredentials() throws Exception {
  List<Credentials> invalid=new ArrayList<Credentials>();
  invalid.add(new ImpersonationCredentials(new GuestCredentials(),adminSession.getAuthInfo()));
  invalid.add(new ImpersonationCredentials(new SimpleCredentials(adminSession.getAuthInfo().getUserID(),new char[0]),new TestAuthInfo()));
  invalid.add(new ImpersonationCredentials(new SimpleCredentials("unknown",new char[0]),adminSession.getAuthInfo()));
  invalid.add(new ImpersonationCredentials(new SimpleCredentials("unknown",new char[0]),new TestAuthInfo()));
  for (  Credentials creds : invalid) {
    try {
      authentication.authenticate(creds);
      fail("LoginException expected");
    }
 catch (    LoginException e) {
      assertTrue(e instanceof FailedLoginException);
    }
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAuthenticateInvalidSimpleCredentials() throws Exception {
  List<Credentials> invalid=new ArrayList<Credentials>();
  invalid.add(new SimpleCredentials(userId,"wrongPw".toCharArray()));
  invalid.add(new SimpleCredentials(userId,"".toCharArray()));
  invalid.add(new SimpleCredentials("unknownUser","pw".toCharArray()));
  for (  Credentials creds : invalid) {
    try {
      authentication.authenticate(creds);
      fail("LoginException expected");
    }
 catch (    LoginException e) {
      assertTrue(e instanceof FailedLoginException);
    }
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAuthenticateResolvesToDisabledUser() throws Exception {
  User testUser=getTestUser();
  SimpleCredentials sc=new SimpleCredentials(testUser.getID(),testUser.getID().toCharArray());
  Authentication a=new UserAuthentication(getUserConfiguration(),root,sc.getUserID());
  try {
    getTestUser().disable("disabled");
    root.commit();
    a.authenticate(sc);
    fail("Authenticating disabled user should fail");
  }
 catch (  LoginException e) {
    assertTrue(e instanceof AccountLockedException);
  }
 finally {
    getTestUser().disable(null);
    root.commit();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.user.UserInitializerTest </h4><pre class="type-9 type-5 type-6 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @since OAK 1.0 The anonymous user is optional.
 */
@Test public void testAnonymousConfiguration() throws Exception {
  Map<String,Object> userParams=new HashMap();
  userParams.put(UserConstants.PARAM_ANONYMOUS_ID,"");
  ConfigurationParameters params=ConfigurationParameters.of(UserConfiguration.NAME,ConfigurationParameters.of(userParams));
  SecurityProvider sp=new SecurityProviderImpl(params);
  final ContentRepository repo=new Oak().with(new InitialContent()).with(new PropertyIndexEditorProvider()).with(new PropertyIndexProvider()).with(new TypeEditorProvider()).with(sp).createContentRepository();
  ContentSession cs=Subject.doAs(SystemSubject.INSTANCE,new PrivilegedExceptionAction<ContentSession>(){
    @Override public ContentSession run() throws Exception {
      return repo.login(null,null);
    }
  }
);
  try {
    Root root=cs.getLatestRoot();
    UserConfiguration uc=sp.getConfiguration(UserConfiguration.class);
    UserManager umgr=uc.getUserManager(root,NamePathMapper.DEFAULT);
    Authorizable anonymous=umgr.getAuthorizable(UserConstants.DEFAULT_ANONYMOUS_ID);
    assertNull(anonymous);
  }
  finally {
    cs.close();
  }
  ContentSession anonymousSession=null;
  try {
    anonymousSession=repo.login(new GuestCredentials(),null);
    fail();
  }
 catch (  LoginException e) {
  }
 finally {
    if (anonymousSession != null) {
      anonymousSession.close();
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-5 type-7 type-6 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @since OAK 1.0 The configuration defines if the password of the
 * admin user is being set.
 */
@Test public void testAdminConfiguration() throws Exception {
  Map<String,Object> userParams=new HashMap();
  userParams.put(UserConstants.PARAM_ADMIN_ID,"admin");
  userParams.put(UserConstants.PARAM_OMIT_ADMIN_PW,true);
  ConfigurationParameters params=ConfigurationParameters.of(UserConfiguration.NAME,ConfigurationParameters.of(userParams));
  SecurityProvider sp=new SecurityProviderImpl(params);
  final ContentRepository repo=new Oak().with(new InitialContent()).with(new PropertyIndexEditorProvider()).with(new PropertyIndexProvider()).with(new TypeEditorProvider()).with(sp).createContentRepository();
  ContentSession cs=Subject.doAs(SystemSubject.INSTANCE,new PrivilegedExceptionAction<ContentSession>(){
    @Override public ContentSession run() throws Exception {
      return repo.login(null,null);
    }
  }
);
  try {
    Root root=cs.getLatestRoot();
    UserConfiguration uc=sp.getConfiguration(UserConfiguration.class);
    UserManager umgr=uc.getUserManager(root,NamePathMapper.DEFAULT);
    Authorizable adminUser=umgr.getAuthorizable("admin");
    assertNotNull(adminUser);
    Tree adminTree=root.getTree(adminUser.getPath());
    assertTrue(adminTree.exists());
    assertNull(adminTree.getProperty(UserConstants.REP_PASSWORD));
  }
  finally {
    cs.close();
  }
  ContentSession adminSession=null;
  try {
    adminSession=repo.login(new SimpleCredentials("admin",new char[0]),null);
    fail();
  }
 catch (  LoginException e) {
  }
 finally {
    if (adminSession != null) {
      adminSession.close();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.user.UserManagerImplTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void setPasswordNull() throws Exception {
  User user=userMgr.createUser(testUserId,null);
  root.commit();
  Tree userTree=root.getTree(user.getPath());
  try {
    userMgr.setPassword(userTree,testUserId,null,true);
    fail("setting null password should fail");
  }
 catch (  NullPointerException e) {
  }
  try {
    userMgr.setPassword(userTree,testUserId,null,false);
    fail("setting null password should fail");
  }
 catch (  NullPointerException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testAutoSave() throws Exception {
  try {
    userMgr.autoSave(true);
    fail("should fail");
  }
 catch (  UnsupportedRepositoryOperationException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testEnforceAuthorizableFolderHierarchy() throws RepositoryException, CommitFailedException {
  User user=userMgr.createUser(testUserId,null);
  root.commit();
  NodeUtil userNode=new NodeUtil(root.getTree(user.getPath()));
  NodeUtil folder=userNode.addChild("folder",UserConstants.NT_REP_AUTHORIZABLE_FOLDER);
  String path=folder.getTree().getPath();
  try {
    Principal p=new PrincipalImpl("test2");
    userMgr.createUser(p.getName(),p.getName(),p,path);
    root.commit();
    fail("Users may not be nested.");
  }
 catch (  CommitFailedException e) {
  }
 finally {
    Authorizable a=userMgr.getAuthorizable("test2");
    if (a != null) {
      a.remove();
      root.commit();
    }
  }
  NodeUtil someContent=userNode.addChild("mystuff",JcrConstants.NT_UNSTRUCTURED);
  path=someContent.getTree().getPath();
  try {
    try {
      Principal p=new PrincipalImpl("test3");
      userMgr.createUser(p.getName(),p.getName(),p,path);
      root.commit();
      fail("Users may not be nested.");
    }
 catch (    CommitFailedException e) {
    }
 finally {
      Authorizable a=userMgr.getAuthorizable("test3");
      if (a != null) {
        a.remove();
        root.commit();
      }
    }
    folder=someContent.addChild("folder",UserConstants.NT_REP_AUTHORIZABLE_FOLDER);
    root.commit();
    try {
      Principal p=new PrincipalImpl("test4");
      userMgr.createUser(p.getName(),p.getName(),p,folder.getTree().getPath());
      root.commit();
      fail("Users may not be nested.");
    }
 catch (    CommitFailedException e) {
    }
 finally {
      root.refresh();
      Authorizable a=userMgr.getAuthorizable("test4");
      if (a != null) {
        a.remove();
        root.commit();
      }
    }
  }
  finally {
    root.refresh();
    Tree t=root.getTree(path);
    if (t.exists()) {
      t.remove();
      root.commit();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.user.UserPrincipalProviderWithCacheTest </h4><pre class="type-12 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testConcurrentLoginWithCacheRemoval() throws Exception {
  changeUserConfiguration(ConfigurationParameters.of(UserPrincipalProvider.PARAM_CACHE_EXPIRATION,1));
  final List<Exception> exceptions=new ArrayList<Exception>();
  List<Thread> threads=new ArrayList<Thread>();
  for (int i=0; i < 100; i++) {
    threads.add(new Thread(new Runnable(){
      public void run(){
        try {
          login(new SimpleCredentials(userId,userId.toCharArray())).close();
        }
 catch (        Exception e) {
          exceptions.add(e);
        }
      }
    }
));
  }
  for (  Thread t : threads) {
    t.start();
  }
  for (  Thread t : threads) {
    t.join();
  }
  for (  Exception e : exceptions) {
    e.printStackTrace();
  }
  if (!exceptions.isEmpty()) {
    fail();
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testChangeCache() throws Exception {
  PrincipalProvider pp=createPrincipalProvider(systemRoot);
  pp.getPrincipals(userId);
  root.refresh();
  List<PropertyState> props=new ArrayList();
  props.add(PropertyStates.createProperty(CacheConstants.REP_EXPIRATION,25));
  props.add(PropertyStates.createProperty(CacheConstants.REP_GROUP_PRINCIPAL_NAMES,EveryonePrincipal.NAME));
  props.add(PropertyStates.createProperty(JcrConstants.JCR_PRIMARYTYPE,JcrConstants.NT_UNSTRUCTURED));
  props.add(PropertyStates.createProperty("residualProp","anyvalue"));
  for (  PropertyState ps : props) {
    try {
      Tree cache=getCacheTree(root);
      cache.setProperty(ps);
      root.commit();
      fail("Attempt to modify the cache tree must fail.");
    }
 catch (    CommitFailedException e) {
    }
 finally {
      root.refresh();
    }
  }
  for (  PropertyState ps : props) {
    try {
      Tree cache=getCacheTree(systemRoot);
      cache.setProperty(ps);
      systemRoot.commit();
      fail("Attempt to modify the cache tree must fail.");
    }
 catch (    CommitFailedException e) {
    }
 finally {
      systemRoot.refresh();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.user.UserProviderTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCreateWithCollision() throws Exception {
  UserProvider userProvider=createUserProvider();
  Tree userTree=userProvider.createUser("AmaLia",null);
  Map<String,String> colliding=new HashMap<String,String>();
  colliding.put("AmaLia",null);
  colliding.put("AmaLia","s/ome/path");
  colliding.put("amalia",null);
  colliding.put("Amalia","a/b/c");
  for (  String uid : colliding.keySet()) {
    try {
      Tree c=userProvider.createUser(uid,colliding.get(uid));
      root.commit();
      fail("userID collision must be detected");
    }
 catch (    CommitFailedException e) {
    }
  }
  for (  String uid : colliding.keySet()) {
    try {
      Tree c=userProvider.createGroup(uid,colliding.get(uid));
      root.commit();
      fail("userID collision must be detected");
    }
 catch (    CommitFailedException e) {
    }
  }
}

</code></pre>

<br>
<pre class="type-12 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testRemoveParentTree() throws Exception {
  UserProvider up=createUserProvider();
  Tree u1=up.createUser("b","b");
  Tree u2=up.createUser("bb","bb");
  Tree folder=root.getTree(Text.getRelativeParent(u1.getPath(),2));
  folder.remove();
  if (up.getAuthorizable("b") != null) {
    fail("Removing the top authorizable folder must remove all users contained.");
    u1.remove();
  }
  if (up.getAuthorizable("bb") != null) {
    fail("Removing the top authorizable folder must remove all users contained.");
    u2.remove();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.user.UserValidatorTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void createWithInvalidUUID() throws Exception {
  try {
    User user=getUserManager(root).createUser("withInvalidUUID","pw");
    Tree tree=root.getTree(userPath);
    tree.setProperty(JcrConstants.JCR_UUID,UUID.randomUUID().toString());
    root.commit();
    fail("creating user with invalid jcr:uuid should fail");
  }
 catch (  CommitFailedException e) {
  }
 finally {
    root.refresh();
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void removePrincipalName() throws Exception {
  try {
    Tree userTree=root.getTree(userPath);
    userTree.removeProperty(REP_PRINCIPAL_NAME);
    root.commit();
    fail("removing principal name should fail");
  }
 catch (  CommitFailedException e) {
  }
 finally {
    root.refresh();
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testEnforceHierarchy() throws RepositoryException, CommitFailedException {
  List<String> invalid=new ArrayList<String>();
  invalid.add("/");
  invalid.add("/jcr:system");
  String groupRoot=getConfig().getConfigValue(PARAM_GROUP_PATH,DEFAULT_GROUP_PATH);
  invalid.add(groupRoot);
  String userRoot=getConfig().getConfigValue(PARAM_USER_PATH,DEFAULT_USER_PATH);
  invalid.add(Text.getRelativeParent(userRoot,1));
  invalid.add(userPath);
  invalid.add(userPath + "/folder");
  for (  String path : invalid) {
    try {
      Tree parent=root.getTree(path);
      if (!parent.exists()) {
        String[] segments=Text.explode(path,'/',false);
        parent=root.getTree("/");
        for (        String segment : segments) {
          Tree next=parent.getChild(segment);
          if (!next.exists()) {
            next=parent.addChild(segment);
            next.setProperty(JcrConstants.JCR_PRIMARYTYPE,NT_REP_AUTHORIZABLE_FOLDER,Type.NAME);
            parent=next;
          }
        }
      }
      Tree userTree=parent.addChild("testUser");
      userTree.setProperty(JcrConstants.JCR_PRIMARYTYPE,NT_REP_USER,Type.NAME);
      userTree.setProperty(JcrConstants.JCR_UUID,UserProvider.getContentID("testUser"));
      userTree.setProperty(REP_PRINCIPAL_NAME,"testUser");
      root.commit();
      fail("Invalid hierarchy should be detected");
    }
 catch (    CommitFailedException e) {
    }
 finally {
      root.refresh();
    }
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testDisableAdminUser() throws Exception {
  try {
    String adminId=getConfig().getConfigValue(PARAM_ADMIN_ID,DEFAULT_ADMIN_ID);
    UserManager userMgr=getUserManager(root);
    Authorizable admin=userMgr.getAuthorizable(adminId);
    if (admin == null) {
      admin=userMgr.createUser(adminId,adminId);
      root.commit();
    }
    root.getTree(admin.getPath()).setProperty(REP_DISABLED,"disabled");
    root.commit();
    fail("Admin user cannot be disabled");
  }
 catch (  CommitFailedException e) {
  }
 finally {
    root.refresh();
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @since oak 1.0 cyclic group membership added in a single set of transient
 * modifications must be detected upon save.
 */
@Test public void testDetectCyclicMembership() throws Exception {
  Group group1=null;
  Group group2=null;
  Group group3=null;
  UserManager userMgr=getUserManager(root);
  try {
    group1=userMgr.createGroup("group1");
    group2=userMgr.createGroup("group2");
    group3=userMgr.createGroup("group3");
    group1.addMember(group2);
    group2.addMember(group3);
    assertFalse(group3.addMember(group1));
    Tree group3Tree=root.getTree(group3.getPath());
    Set<String> values=Collections.singleton(root.getTree(group1.getPath()).getProperty(JcrConstants.JCR_UUID).getValue(Type.STRING));
    PropertyState prop=PropertyStates.createProperty(REP_MEMBERS,values,Type.WEAKREFERENCES);
    group3Tree.setProperty(prop);
    root.commit();
    fail("Cyclic group membership must be detected");
  }
 catch (  CommitFailedException e) {
  }
 finally {
    if (group1 != null)     group1.remove();
    if (group2 != null)     group2.remove();
    if (group3 != null)     group3.remove();
    root.commit();
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void removeAuthorizableId() throws Exception {
  try {
    Tree userTree=root.getTree(userPath);
    userTree.removeProperty(REP_AUTHORIZABLE_ID);
    root.commit();
    fail("removing authorizable id should fail");
  }
 catch (  CommitFailedException e) {
  }
 finally {
    root.refresh();
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void removePassword() throws Exception {
  try {
    Tree userTree=root.getTree(userPath);
    userTree.removeProperty(REP_PASSWORD);
    root.commit();
    fail("removing password should fail");
  }
 catch (  CommitFailedException e) {
  }
 finally {
    root.refresh();
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testRemoveAdminUserFolder() throws Exception {
  try {
    String adminId=getConfig().getConfigValue(PARAM_ADMIN_ID,DEFAULT_ADMIN_ID);
    UserManager userMgr=getUserManager(root);
    Authorizable admin=userMgr.getAuthorizable(adminId);
    if (admin == null) {
      admin=userMgr.createUser(adminId,adminId);
      root.commit();
    }
    root.getTree(admin.getPath()).getParent().remove();
    root.commit();
    fail("Admin user cannot be removed");
  }
 catch (  CommitFailedException e) {
  }
 finally {
    root.refresh();
  }
}

</code></pre>

<br>
<pre class="type-5 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateNestedUser() throws Exception {
  Tree userTree=root.getTree(getTestUser().getPath());
  NodeUtil userNode=new NodeUtil(userTree);
  NodeUtil profile=userNode.addChild("profile",JcrConstants.NT_UNSTRUCTURED);
  NodeUtil nested=profile.addChild("nested",UserConstants.NT_REP_USER);
  nested.setString(UserConstants.REP_PRINCIPAL_NAME,"nested");
  nested.setString(UserConstants.REP_AUTHORIZABLE_ID,"nested");
  nested.setString(JcrConstants.JCR_UUID,IdentifierManager.generateUUID("nested"));
  try {
    root.commit();
    fail("Creating nested users must be detected.");
  }
 catch (  CommitFailedException e) {
    assertEquals(29,e.getCode());
  }
 finally {
    root.refresh();
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testRemoveAdminUser() throws Exception {
  try {
    String adminId=getConfig().getConfigValue(PARAM_ADMIN_ID,DEFAULT_ADMIN_ID);
    UserManager userMgr=getUserManager(root);
    Authorizable admin=userMgr.getAuthorizable(adminId);
    if (admin == null) {
      admin=userMgr.createUser(adminId,adminId);
      root.commit();
    }
    root.getTree(admin.getPath()).remove();
    root.commit();
    fail("Admin user cannot be removed");
  }
 catch (  CommitFailedException e) {
  }
 finally {
    root.refresh();
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void createWithoutPrincipalName() throws Exception {
  try {
    User user=getUserManager(root).createUser("withoutPrincipalName","pw");
    Tree tree=root.getTree(userPath);
    tree.removeProperty(REP_PRINCIPAL_NAME);
    root.commit();
    fail("creating user with invalid jcr:uuid should fail");
  }
 catch (  CommitFailedException e) {
  }
 finally {
    root.refresh();
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void changePasswordToPlainText() throws Exception {
  try {
    Tree userTree=root.getTree(userPath);
    userTree.setProperty(REP_PASSWORD,"plaintext");
    root.commit();
    fail("storing a plaintext password should fail");
  }
 catch (  CommitFailedException e) {
  }
 finally {
    root.refresh();
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void changePrincipalName() throws Exception {
  try {
    Tree userTree=root.getTree(userPath);
    userTree.setProperty(REP_PRINCIPAL_NAME,"another");
    root.commit();
    fail("changing the principal name should fail");
  }
 catch (  CommitFailedException e) {
  }
 finally {
    root.refresh();
  }
}

</code></pre>

<br>
<pre class="type-5 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateNestedUser2Steps() throws Exception {
  Tree userTree=root.getTree(getTestUser().getPath());
  NodeUtil userNode=new NodeUtil(userTree);
  NodeUtil profile=userNode.addChild("profile",JcrConstants.NT_UNSTRUCTURED);
  NodeUtil nested=profile.addChild("nested",JcrConstants.NT_UNSTRUCTURED);
  nested.setString(UserConstants.REP_PRINCIPAL_NAME,"nested");
  nested.setString(UserConstants.REP_AUTHORIZABLE_ID,"nested");
  nested.setString(JcrConstants.JCR_UUID,IdentifierManager.generateUUID("nested"));
  root.commit();
  try {
    nested.setName(JcrConstants.JCR_PRIMARYTYPE,UserConstants.NT_REP_USER);
    root.commit();
    fail("Creating nested users must be detected.");
  }
 catch (  CommitFailedException e) {
    assertEquals(29,e.getCode());
  }
 finally {
    root.refresh();
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void changeAuthorizableId() throws Exception {
  try {
    Tree userTree=root.getTree(userPath);
    userTree.setProperty(REP_AUTHORIZABLE_ID,"modified");
    root.commit();
    fail("changing the authorizable id should fail");
  }
 catch (  CommitFailedException e) {
  }
 finally {
    root.refresh();
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void changeUUID() throws Exception {
  try {
    Tree userTree=root.getTree(userPath);
    userTree.setProperty(JcrConstants.JCR_UUID,UUID.randomUUID().toString());
    root.commit();
    fail("changing jcr:uuid should fail if it the uuid valid is invalid");
  }
 catch (  CommitFailedException e) {
  }
 finally {
    root.refresh();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.user.autosave.AuthorizableByTypeTest </h4><pre class="type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=AuthorizableTypeException.class) public void testGroupByIdAndWrongType() throws Exception {
  mgr.getAuthorizable(group.getID(),User.class);
  fail("Wrong Authorizable type is not detected.");
}

</code></pre>

<br>
<pre class="type-5 type-11 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=AuthorizableTypeException.class) public void testUserByIdAndWrongType() throws Exception {
  mgr.getAuthorizable(user.getID(),Group.class);
  fail("Wrong Authorizable type is not detected.");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.user.autosave.AutoSaveEnabledManagerTest </h4><pre class="type-5 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCommitFailedRevertChanges() throws RepositoryException {
  User u=mgr.createUser("u","u");
  try {
    User u2=mgr.createUser("u","u");
    fail();
  }
 catch (  RepositoryException e) {
    assertFalse(root.hasPendingChanges());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.spi.blob.AbstractBlobStoreTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testIllegalIdentifier() throws Exception {
  byte[] data=new byte[1];
  try {
    store.readBlob("ff",0,data,0,1);
    fail();
  }
 catch (  Exception e) {
  }
}

</code></pre>

<br>
<pre class="type-13 type-5 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWriteFile() throws Exception {
  store.setBlockSize(1024 * 1024);
  byte[] data=new byte[4 * 1024 * 1024];
  Random r=new Random(0);
  r.nextBytes(data);
  String tempFileName="target/temp/test";
  File tempFile=new File(tempFileName);
  tempFile.getParentFile().mkdirs();
  OutputStream out=new FileOutputStream(tempFile,false);
  out.write(data);
  out.close();
  String s=store.writeBlob(tempFileName);
  assertEquals(data.length,store.getBlobLength(s));
  byte[] buff=new byte[1];
  for (int i=0; i < data.length; i+=1024) {
    store.readBlob(s,i,buff,0,1);
    assertEquals(data[i],buff[0]);
  }
  try {
    store.writeBlob(tempFileName + "_wrong");
    fail();
  }
 catch (  Exception e) {
  }
}

</code></pre>

<br>
<pre class="type-12 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testIllegalIdentifier3() throws Exception {
  if (store instanceof AbstractBlobStore) {
    try {
      ((AbstractBlobStore)store).mark("ff");
      fail();
    }
 catch (    Exception e) {
    }
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testIllegalIdentifier2() throws Exception {
  try {
    store.getBlobLength("ff");
    fail();
  }
 catch (  Exception e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.spi.query.CursorsTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void intersectionCursorExceptions(){
  QueryEngineSettings s=new QueryEngineSettings();
  Cursor a=new SimpleCursor("1:","/x","/b","/c","/e","/e","/c");
  Cursor b=new SimpleCursor("2:","/a","/c","/d","/b","/c");
  Cursor c=Cursors.newIntersectionCursor(a,b,s);
  c.next();
  c.next();
  try {
    c.remove();
    fail();
  }
 catch (  UnsupportedOperationException e) {
  }
  try {
    c.next();
    fail();
  }
 catch (  IllegalStateException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.spi.security.ConfigurationParametersTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testImpossibleConversion(){
  Map<String,Object> map=new HashMap<String,Object>();
  map.put("string","v");
  map.put("obj",new TestObject("test"));
  map.put("int",10);
  ConfigurationParameters options=ConfigurationParameters.of(map);
  Map<String,Class> impossible=new HashMap<String,Class>();
  impossible.put("string",TestObject.class);
  impossible.put("string",Integer.class);
  impossible.put("string",Calendar.class);
  impossible.put("obj",Integer.class);
  impossible.put("int",TestObject.class);
  impossible.put("int",Calendar.class);
  for (  String key : impossible.keySet()) {
    try {
      options.getConfigValue(key,null,impossible.get(key));
      fail("Impossible conversion for " + key + " to "+ impossible.get(key));
    }
 catch (    IllegalArgumentException e) {
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.spi.security.authentication.PreAuthTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testNullLogin() throws Exception {
  ContentSession cs=null;
  try {
    cs=login(null);
    fail("Null login without pre-auth subject should fail");
  }
 catch (  LoginException e) {
  }
 finally {
    if (cs != null) {
      cs.close();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.spi.security.authentication.external.ExternalLoginModuleTest </h4><pre class="type-5 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLoginFailed() throws Exception {
  UserManager userManager=getUserManager(root);
  try {
    ContentSession cs=login(new SimpleCredentials("unknown",new char[0]));
    cs.close();
    fail("login failure expected");
  }
 catch (  LoginException e) {
  }
 finally {
    assertNull(userManager.getAuthorizable(userId));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.spi.security.authentication.external.impl.jmx.SyncMBeanImplTest </h4><pre class="type-5 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInvalidSyncHandlerName(){
  SyncMBeanImpl syncMBean=new SyncMBeanImpl(REPOSITORY,syncMgr,"invalid",idpMgr,idp.getName());
  assertEquals("invalid",syncMBean.getSyncHandlerName());
  try {
    syncMBean.syncAllExternalUsers();
    fail("syncAllExternalUsers with invalid SyncHandlerName must fail");
  }
 catch (  IllegalArgumentException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInvalidIDPName(){
  SyncMBeanImpl syncMBean=new SyncMBeanImpl(REPOSITORY,syncMgr,SYNC_NAME,idpMgr,"invalid");
  assertEquals("invalid",syncMBean.getIDPName());
  try {
    syncMBean.syncAllExternalUsers();
    fail("syncAllExternalUsers with invalid IDP name must fail");
  }
 catch (  IllegalArgumentException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.spi.security.authorization.accesscontrol.ACETest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * @since OAK 1.0: support for multi-value restrictions
 */
@Test public void testGetRestrictionForMultiValued() throws Exception {
  Restriction nameRestr=createRestriction(AccessControlConstants.REP_NT_NAMES,nameValues);
  ACE ace=createEntry(ImmutableSet.of(nameRestr));
  try {
    ace.getRestriction(AccessControlConstants.REP_NT_NAMES);
    fail("Multiple restriction values");
  }
 catch (  ValueFormatException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testEmptyPrivileges() throws Exception {
  try {
    ACE empty=new EmptyACE(PrivilegeBits.EMPTY);
    fail("Privileges must not be empty.");
  }
 catch (  AccessControlException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testNullPrivileges() throws Exception {
  try {
    ACE empty=new EmptyACE(null);
    fail("Privileges must not be null");
  }
 catch (  AccessControlException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testNullPrincipal() throws Exception {
  try {
    Privilege[] privs=new Privilege[]{acMgr.privilegeFromName(PrivilegeConstants.JCR_ALL)};
    createEntry(null,privs,true);
    fail("Principal must not be null");
  }
 catch (  AccessControlException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.spi.security.authorization.cug.impl.CugAccessControlManagerTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testSetInvalidPolicy() throws Exception {
  List<AccessControlPolicy> invalidPolicies=ImmutableList.of(new AccessControlPolicy(){
  }
,new NamedAccessControlPolicy(){
    public String getName(){
      return "name";
    }
  }
,InvalidCug.INSTANCE);
  for (  AccessControlPolicy policy : invalidPolicies) {
    try {
      cugAccessControlManager.setPolicy(SUPPORTED_PATH,policy);
      fail("Invalid cug policy must be detected.");
    }
 catch (    AccessControlException e) {
    }
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testRemoveInvalidPolicy() throws Exception {
  List<AccessControlPolicy> invalidPolicies=ImmutableList.of(new AccessControlPolicy(){
  }
,new NamedAccessControlPolicy(){
    public String getName(){
      return "name";
    }
  }
,InvalidCug.INSTANCE);
  for (  AccessControlPolicy policy : invalidPolicies) {
    try {
      cugAccessControlManager.removePolicy(SUPPORTED_PATH,policy);
      fail("Invalid cug policy must be detected.");
    }
 catch (    AccessControlException e) {
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.spi.security.authorization.cug.impl.CugEvaluationTest </h4><pre class="type-5 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWriteAcl() throws Exception {
  ContentSession cs=createTestSession2();
  Root r=cs.getLatestRoot();
  try {
    Tree tree=r.getTree("/content/a/b/c");
    tree.setProperty(JCR_MIXINTYPES,ImmutableList.of(MIX_REP_CUG_MIXIN,AccessControlConstants.MIX_REP_ACCESS_CONTROLLABLE),Type.NAMES);
    tree.addChild(AccessControlConstants.REP_POLICY).setProperty(JCR_PRIMARYTYPE,AccessControlConstants.NT_REP_ACL,Type.NAME);
    r.commit();
    fail();
  }
 catch (  CommitFailedException e) {
    assertTrue(e.isAccessViolation());
  }
 finally {
    r.refresh();
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWriteCug() throws Exception {
  ContentSession cs=createTestSession2();
  Root r=cs.getLatestRoot();
  try {
    Tree tree=r.getTree("/content/a/rep:cugPolicy");
    tree.setProperty(REP_PRINCIPAL_NAMES,ImmutableList.of(EveryonePrincipal.NAME,testGroupPrincipal.getName()),Type.STRINGS);
    r.commit();
    fail();
  }
 catch (  CommitFailedException e) {
    assertTrue(e.isAccessViolation());
  }
 finally {
    r.refresh();
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWrite() throws Exception {
  List<String> readOnly=ImmutableList.of("/content","/content/a/b/c");
  for (  String p : readOnly) {
    try {
      NodeUtil content=new NodeUtil(testRoot.getTree(p));
      content.addChild("writeTest",NT_OAK_UNSTRUCTURED);
      testRoot.commit();
      fail();
    }
 catch (    CommitFailedException e) {
      assertTrue(e.isAccessViolation());
    }
 finally {
      testRoot.refresh();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.spi.security.authorization.cug.impl.CugImportAbortTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testNodeWithCugInvalidPrincipals() throws Exception {
  try {
    doImport(getTargetPath(),XML_CHILD_WITH_CUG);
    fail();
  }
 catch (  AccessControlException e) {
  }
 finally {
    getImportSession().refresh(false);
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCugInvalidPrincipals() throws Exception {
  try {
    doImport(getTargetPath(),XML_CUG_POLICY);
    fail();
  }
 catch (  AccessControlException e) {
  }
 finally {
    getImportSession().refresh(false);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.spi.security.authorization.cug.impl.CugImportBaseTest </h4><pre class="type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCugValidPrincipalsNoMixin() throws Exception {
  testGroup=((JackrabbitSession)adminSession).getUserManager().createGroup(new PrincipalImpl(TEST_GROUP_PRINCIPAL_NAME));
  adminSession.save();
  doImport(getTargetPath(),XML_CUG_POLICY);
  try {
    adminSession.save();
    fail();
  }
 catch (  AccessControlException e) {
    Throwable cause=e.getCause();
    assertTrue(cause instanceof CommitFailedException);
    assertTrue(((CommitFailedException)cause).isAccessControlViolation());
    assertEquals(22,((CommitFailedException)cause).getCode());
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCugWithInvalidName() throws Exception {
  String xml="<?xml version=\"1.0\" encoding=\"UTF-8\"?>" + "<sv:node sv:name=\"someOtherNode\" xmlns:mix=\"http://www.jcp.org/jcr/mix/1.0\" xmlns:nt=\"http://www.jcp.org/jcr/nt/1.0\" xmlns:fn_old=\"http://www.w3.org/2004/10/xpath-functions\" xmlns:fn=\"http://www.w3.org/2005/xpath-functions\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:sv=\"http://www.jcp.org/jcr/sv/1.0\" xmlns:rep=\"internal\" xmlns:jcr=\"http://www.jcp.org/jcr/1.0\">" + "<sv:property sv:name=\"jcr:primaryType\" sv:type=\"Name\"><sv:value>rep:CugPolicy</sv:value></sv:property>"+ "<sv:property sv:name=\"rep:principalNames\" sv:type=\"String\" sv:multiple=\"true\">"+ "<sv:value>" + EveryonePrincipal.NAME + "</sv:value>"+ "</sv:property>"+ "</sv:node>";
  getTargetNode().addMixin(CugConstants.MIX_REP_CUG_MIXIN);
  doImport(getTargetPath(),xml);
  try {
    getImportSession().save();
    fail();
  }
 catch (  ConstraintViolationException e) {
  }
 finally {
    getImportSession().refresh(false);
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testNestedCug() throws Exception {
  try {
    doImport(getTargetPath(),XML_NESTED_CUG_POLICY);
    fail();
  }
 catch (  ConstraintViolationException e) {
  }
 finally {
    getImportSession().refresh(false);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.spi.security.authorization.cug.impl.CugPermissionProviderTest </h4><pre class="type-5 type-7 type-6 type-19 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @see PermissionProvider#getTreePermission(org.apache.jackrabbit.oak.api.Tree,org.apache.jackrabbit.oak.spi.security.authorization.permission.TreePermission)
 */
@Test public void testGetTreePermissions() throws AccessDeniedException {
  TreePermission rootTp=cugPermProvider.getTreePermission(root.getTree("/"),TreePermission.EMPTY);
  assertTrue(rootTp instanceof EmptyCugTreePermission);
  TreePermission contentTp=cugPermProvider.getTreePermission(root.getTree(SUPPORTED_PATH),rootTp);
  assertTrue(contentTp instanceof CugTreePermission);
  TreePermission aTp=cugPermProvider.getTreePermission(root.getTree("/content/a"),contentTp);
  assertTrue(aTp instanceof CugTreePermission);
  TreePermission bTp=cugPermProvider.getTreePermission(root.getTree("/content/a/b"),aTp);
  assertTrue(bTp instanceof CugTreePermission);
  TreePermission cTp=cugPermProvider.getTreePermission(root.getTree("/content/a/b/c"),bTp);
  assertTrue(cTp instanceof CugTreePermission);
  TreePermission aaTp=cugPermProvider.getTreePermission(root.getTree("/content/aa"),contentTp);
  assertTrue(aaTp instanceof CugTreePermission);
  TreePermission bbTp=cugPermProvider.getTreePermission(root.getTree("/content/aa/bb"),aaTp);
  assertTrue(bbTp instanceof CugTreePermission);
  TreePermission ccTp=cugPermProvider.getTreePermission(root.getTree("/content/aa/bb/cc"),bbTp);
  assertTrue(ccTp instanceof CugTreePermission);
  Tree aaTree=root.getTree("/content/aa");
  new NodeUtil(aaTree).addChild(CugConstants.REP_CUG_POLICY,NT_OAK_UNSTRUCTURED);
  TreePermission aaTp2=cugPermProvider.getTreePermission(root.getTree("/content/aa"),contentTp);
  assertTrue(aaTp2 instanceof CugTreePermission);
  TreePermission falseCugTp=cugPermProvider.getTreePermission(root.getTree("/content/aa/rep:cugPolicy"),aaTp2);
  assertNotSame(TreePermission.EMPTY,falseCugTp);
  TreePermission cugTp=cugPermProvider.getTreePermission(root.getTree("/content/a/rep:cugPolicy"),aTp);
  assertSame(TreePermission.NO_RECOURSE,cugTp);
  TreePermission jcrSystemTp=cugPermProvider.getTreePermission(root.getTree("/jcr:system"),rootTp);
  assertTrue(jcrSystemTp instanceof EmptyCugTreePermission);
  assertSame(TreePermission.NO_RECOURSE,cugPermProvider.getTreePermission(root.getTree(NodeTypeConstants.NODE_TYPES_PATH),jcrSystemTp));
  TreePermission unsupportedPathTp=cugPermProvider.getTreePermission(root.getTree(UNSUPPORTED_PATH),rootTp);
  assertSame(TreePermission.NO_RECOURSE,unsupportedPathTp);
  try {
    cugPermProvider.getTreePermission(root.getTree(UNSUPPORTED_PATH + "/child"),unsupportedPathTp);
    fail();
  }
 catch (  IllegalStateException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.spi.security.authorization.cug.impl.CugValidatorTest </h4><pre class="type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMissingMixin() throws Exception {
  NodeUtil cug=node.addChild(REP_CUG_POLICY,NT_REP_CUG_POLICY);
  cug.setStrings(REP_PRINCIPAL_NAMES,EveryonePrincipal.NAME);
  try {
    root.commit();
    fail();
  }
 catch (  CommitFailedException e) {
    assertTrue(e.isAccessControlViolation());
    assertEquals(22,e.getCode());
  }
 finally {
    root.refresh();
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInvalidPrimaryType() throws Exception {
  NodeUtil cug=node.addChild(REP_CUG_POLICY,NodeTypeConstants.NT_OAK_UNSTRUCTURED);
  cug.setStrings(REP_PRINCIPAL_NAMES,EveryonePrincipal.NAME);
  try {
    root.commit();
    fail();
  }
 catch (  CommitFailedException e) {
    assertTrue(e.isAccessControlViolation());
    assertEquals(21,e.getCode());
  }
 finally {
    root.refresh();
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCugPolicyWithDifferentName() throws Exception {
  node.setNames(JcrConstants.JCR_MIXINTYPES,MIX_REP_CUG_MIXIN);
  NodeUtil cug=node.addChild("anotherName",NT_REP_CUG_POLICY);
  cug.setStrings(REP_PRINCIPAL_NAMES,EveryonePrincipal.NAME);
  try {
    root.commit();
    fail();
  }
 catch (  CommitFailedException e) {
    assertTrue(e.isAccessControlViolation());
    assertEquals(23,e.getCode());
  }
 finally {
    root.refresh();
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testChangePrimaryType(){
  try {
    node.setName(JcrConstants.JCR_PRIMARYTYPE,NT_REP_CUG_POLICY);
    root.commit();
    fail();
  }
 catch (  CommitFailedException e) {
    assertTrue(e.isAccessControlViolation());
    assertEquals(20,e.getCode());
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testChangePrimaryTypeOfCug() throws Exception {
  node.setNames(JcrConstants.JCR_MIXINTYPES,MIX_REP_CUG_MIXIN);
  NodeUtil cug=node.addChild(REP_CUG_POLICY,NT_REP_CUG_POLICY);
  cug.setStrings(REP_PRINCIPAL_NAMES,EveryonePrincipal.NAME);
  root.commit();
  try {
    cug.setName(JcrConstants.JCR_PRIMARYTYPE,NodeTypeConstants.NT_OAK_UNSTRUCTURED);
    root.commit();
    fail();
  }
 catch (  CommitFailedException e) {
    assertTrue(e.isAccessControlViolation());
    assertEquals(21,e.getCode());
  }
}

</code></pre>

<br>
<pre class="type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRemoveMixin() throws Exception {
  node.setNames(JcrConstants.JCR_MIXINTYPES,MIX_REP_CUG_MIXIN);
  NodeUtil cug=node.addChild(REP_CUG_POLICY,NT_REP_CUG_POLICY);
  cug.setStrings(REP_PRINCIPAL_NAMES,EveryonePrincipal.NAME);
  root.commit();
  try {
    node.removeProperty(JcrConstants.JCR_MIXINTYPES);
    root.commit();
    fail();
  }
 catch (  CommitFailedException e) {
    assertTrue(e.isAccessControlViolation());
    assertEquals(22,e.getCode());
  }
 finally {
    root.refresh();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.spi.security.authorization.permission.PermissionsTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testGetPermissionsFromInvalidActions(){
  TreeLocation tl=TreeLocation.create(root.getTree("/"));
  List<String> l=ImmutableList.of(Session.ACTION_READ + ",invalid","invalid","invalid," + Session.ACTION_REMOVE);
  for (  String invalid : l) {
    try {
      Permissions.getPermissions(invalid,tl,false);
      fail();
    }
 catch (    IllegalArgumentException e) {
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.spi.security.authorization.restriction.AbstractRestrictionProviderTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCreateForUnsupportedName() throws Exception {
  try {
    restrictionProvider.createRestriction(unsupportedPath,"unsupported",globValue);
    fail();
  }
 catch (  AccessControlException e) {
  }
  try {
    restrictionProvider.createRestriction(unsupportedPath,"unsupported",nameValues);
    fail();
  }
 catch (  AccessControlException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testValidateRestrictionsUnsupportedPath() throws Exception {
  restrictionProvider.validateRestrictions(null,getAceTree());
  try {
    Restriction restr=restrictionProvider.createRestriction(testPath,REP_GLOB,globValue);
    restrictionProvider.validateRestrictions(null,getAceTree(restr));
    fail();
  }
 catch (  AccessControlException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCreateForUnsupportedMultiValues() throws Exception {
  try {
    restrictionProvider.createRestriction(unsupportedPath,REP_GLOB,valueFactory.createValue("*"),valueFactory.createValue("/a/*"));
    fail();
  }
 catch (  AccessControlException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCreateForUnsupportedType() throws Exception {
  try {
    restrictionProvider.createRestriction(unsupportedPath,REP_GLOB,valueFactory.createValue(true));
    fail();
  }
 catch (  AccessControlException e) {
  }
  try {
    restrictionProvider.createRestriction(unsupportedPath,REP_NT_NAMES,valueFactory.createValue("nt:file",PropertyType.NAME),valueFactory.createValue(true));
    fail();
  }
 catch (  AccessControlException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testValidateRestrictionsWrongType() throws Exception {
  Restriction mand=restrictionProvider.createRestriction(testPath,"mandatory",valueFactory.createValue(true));
  try {
    Tree ace=getAceTree(mand);
    new NodeUtil(ace).getChild(REP_RESTRICTIONS).setBoolean(REP_GLOB,true);
    restrictionProvider.validateRestrictions(testPath,ace);
    fail("wrong type with restriction 'rep:glob");
  }
 catch (  AccessControlException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCreateForUnsupportedPath() throws Exception {
  try {
    restrictionProvider.createRestriction(unsupportedPath,REP_GLOB,globValue);
    fail();
  }
 catch (  AccessControlException e) {
  }
  try {
    restrictionProvider.createRestriction(unsupportedPath,REP_NT_NAMES,nameValues);
    fail();
  }
 catch (  AccessControlException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testValidateRestrictionsMissingMandatory() throws Exception {
  Restriction glob=restrictionProvider.createRestriction(testPath,REP_GLOB,globValue);
  try {
    restrictionProvider.validateRestrictions(testPath,getAceTree(glob));
    fail("missing mandatory restriction");
  }
 catch (  AccessControlException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testValidateRestrictionsUnsupportedRestriction() throws Exception {
  Restriction mand=restrictionProvider.createRestriction(testPath,"mandatory",valueFactory.createValue(true));
  try {
    Tree ace=getAceTree(mand);
    new NodeUtil(ace).getChild(REP_RESTRICTIONS).setString("Unsupported","value");
    restrictionProvider.validateRestrictions(testPath,ace);
    fail("wrong type with restriction 'rep:glob");
  }
 catch (  AccessControlException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.spi.security.authorization.restriction.CompositeRestrictionProviderTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCreateRestrictionWithInvalidPath() throws Exception {
  try {
    provider.createRestriction(null,REP_GLOB,vf.createValue("*"));
    fail("rep:glob not supported at 'null' path");
  }
 catch (  AccessControlException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCreateMvRestrictionWithInvalidPath() throws Exception {
  try {
    provider.createRestriction(null,REP_NT_NAMES,new Value[]{vf.createValue("nt:base",PropertyType.NAME)});
    fail("rep:glob not supported at 'null' path");
  }
 catch (  AccessControlException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testWriteUnsupportedRestrictions() throws Exception {
  NodeUtil aceNode=new NodeUtil(root.getTree("/")).addChild("test",NT_REP_GRANT_ACE);
  Restriction invalid=new RestrictionImpl(PropertyStates.createProperty("invalid",vf.createValue(true)),false);
  try {
    provider.writeRestrictions("/test",aceNode.getTree(),ImmutableSet.<Restriction>of(invalid));
    fail("AccessControlException expected");
  }
 catch (  AccessControlException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testValidateRestrictions() throws Exception {
  NodeUtil aceNode=new NodeUtil(root.getTree("/")).addChild("test",NT_REP_GRANT_ACE);
  NodeUtil rNode=aceNode.addChild(REP_RESTRICTIONS,NT_REP_RESTRICTIONS);
  rNode.setBoolean("boolean",true);
  rNode.setValues("longs",new Value[]{vf.createValue(10),vf.createValue(290)});
  rNode.setString(REP_GLOB,"*");
  rNode.setNames(REP_NT_NAMES);
  provider.validateRestrictions("/test",aceNode.getTree());
  rNode.removeProperty("boolean");
  try {
    provider.validateRestrictions("/test",aceNode.getTree());
    fail("validation should detect missing mandatory restrictions");
  }
 catch (  AccessControlException e) {
  }
  rNode.setName("boolean","nt:base");
  try {
    provider.validateRestrictions("/test",aceNode.getTree());
    fail("validation should detect wrong restriction type");
  }
 catch (  AccessControlException e) {
  }
 finally {
    rNode.setBoolean("boolean",true);
  }
  rNode.setStrings(REP_GLOB,"*","/jcr:content");
  try {
    provider.validateRestrictions("/test",aceNode.getTree());
    fail("validation should detect wrong restriction type (multi vs single valued)");
  }
 catch (  AccessControlException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCreateInvalidMvRestriction() throws Exception {
  Map<String,Value[]> invalid=ImmutableMap.of("boolean",new Value[]{vf.createValue(true),vf.createValue(false)},"longs",new Value[]{vf.createValue("wrong_type")},REP_NT_NAMES,new Value[]{vf.createValue(true)});
  for (  String name : invalid.keySet()) {
    try {
      provider.createRestriction("/testPath",name,invalid.get(name));
      fail("invalid restriction " + name);
    }
 catch (    AccessControlException e) {
    }
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCreateInvalidRestriction() throws Exception {
  Map<String,Value> invalid=ImmutableMap.of("boolean",vf.createValue("wrong_type"),REP_GLOB,vf.createValue(true));
  for (  String name : invalid.keySet()) {
    try {
      provider.createRestriction("/testPath",name,invalid.get(name));
      fail("invalid restriction " + name);
    }
 catch (    AccessControlException e) {
    }
  }
}

</code></pre>

<br>
<pre class="type-12 type-5 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadRestrictions() throws Exception {
  NodeUtil aceNode=new NodeUtil(root.getTree("/")).addChild("test",NT_REP_GRANT_ACE);
  aceNode.setBoolean("boolean",true);
  aceNode.setValues("longs",new Value[]{vf.createValue(10),vf.createValue(290)});
  aceNode.setString(REP_GLOB,"*");
  aceNode.setNames(REP_NT_NAMES);
  aceNode.setString("invalid","val");
  aceNode.setStrings("invalid2","val1","val2","val3");
  Set<Restriction> restrictions=provider.readRestrictions("/test",aceNode.getTree());
  assertEquals(4,restrictions.size());
  for (  Restriction r : restrictions) {
    String name=r.getDefinition().getName();
    if (!supported.contains(name)) {
      fail("read unsupported restriction");
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.spi.security.authorization.restriction.RestrictionDefinitionImplTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testInvalid(){
  try {
    new RestrictionDefinitionImpl(null,Type.BOOLEAN,false);
    fail("Creating RestrictionDefinition with null name should fail.");
  }
 catch (  NullPointerException e) {
  }
  try {
    new RestrictionDefinitionImpl(name,Type.UNDEFINED,false);
    fail("Creating RestrictionDefinition with undefined required type should fail.");
  }
 catch (  IllegalArgumentException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.spi.security.authorization.restriction.RestrictionImplTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testInvalid(){
  try {
    new RestrictionImpl(null,false);
    fail("Creating RestrictionDefinition with null name should fail.");
  }
 catch (  NullPointerException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.spi.security.privilege.PrivilegeBitsTest </h4><pre class="type-13 type-9 type-5 type-7 type-6 type-19 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNextBits(){
  assertSame(PrivilegeBits.EMPTY,PrivilegeBits.EMPTY.nextBits());
  PrivilegeBits pb=READ_NODES_PRIVILEGE_BITS;
  long l=getLongValue(pb);
  while (l < Long.MAX_VALUE / 2) {
    l=l << 1;
    pb=pb.nextBits();
    assertEquals(l,getLongValue(pb));
  }
  for (int i=0; i < 10; i++) {
    PrivilegeBits nxt=pb.nextBits();
    assertEquals(nxt,pb.nextBits());
    assertFalse(pb.equals(nxt));
    pb=nxt;
  }
  pb=READ_NODES_PRIVILEGE_BITS;
  for (int i=0; i < 100; i++) {
    PrivilegeBits modifiable=PrivilegeBits.getInstance(pb);
    try {
      modifiable.nextBits();
      fail("UnsupportedOperation expected");
    }
 catch (    UnsupportedOperationException e) {
    }
    pb=pb.nextBits();
  }
}

</code></pre>

<br>
<pre class="type-13 type-9 type-12 type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAdd(){
  try {
    PrivilegeBits.EMPTY.add(PrivilegeBits.EMPTY);
    fail("UnsupportedOperation expected");
  }
 catch (  UnsupportedOperationException e) {
  }
  PrivilegeBits pb=READ_NODES_PRIVILEGE_BITS;
  PrivilegeBits mod=PrivilegeBits.getInstance(pb);
  for (int i=0; i < 100; i++) {
    try {
      pb.add(PrivilegeBits.EMPTY);
      fail("UnsupportedOperation expected");
    }
 catch (    UnsupportedOperationException e) {
    }
    try {
      pb.add(mod);
      fail("UnsupportedOperation expected");
    }
 catch (    UnsupportedOperationException e) {
    }
    PrivilegeBits nxt=pb.nextBits();
    try {
      pb.add(nxt);
      fail("UnsupportedOperation expected");
    }
 catch (    UnsupportedOperationException e) {
    }
    long before=getLongValue(mod);
    long nxtLong=getLongValue(nxt);
    mod.add(nxt);
    if (getLongValue(nxt) != 0) {
      assertEquals(before | nxtLong,getLongValue(mod));
    }
    assertTrue(mod.includes(nxt));
    PrivilegeBits tmp=PrivilegeBits.getInstance(pb);
    assertTrue(tmp.includes(pb));
    assertFalse(tmp.includes(nxt));
    if (READ_NODES_PRIVILEGE_BITS.equals(pb)) {
      assertTrue(tmp.includes(PrivilegeBits.BUILT_IN.get(PrivilegeConstants.REP_READ_NODES)));
    }
 else {
      assertFalse(tmp.includes(PrivilegeBits.BUILT_IN.get(PrivilegeConstants.REP_READ_NODES)));
    }
    tmp.add(nxt);
    assertTrue(tmp.includes(pb) && tmp.includes(nxt));
    if (READ_NODES_PRIVILEGE_BITS.equals(pb)) {
      assertTrue(tmp.includes(READ_NODES_PRIVILEGE_BITS));
    }
 else {
      assertFalse(tmp.includes(READ_NODES_PRIVILEGE_BITS));
    }
    tmp.add(READ_NODES_PRIVILEGE_BITS);
    assertTrue(tmp.includes(READ_NODES_PRIVILEGE_BITS));
    pb=nxt;
  }
}

</code></pre>

<br>
<pre class="type-13 type-9 type-5 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDiff(){
  try {
    PrivilegeBits.EMPTY.diff(PrivilegeBits.EMPTY);
    fail("UnsupportedOperation expected");
  }
 catch (  UnsupportedOperationException e) {
  }
  PrivilegeBits pb=READ_NODES_PRIVILEGE_BITS;
  PrivilegeBits mod=PrivilegeBits.getInstance(pb);
  for (int i=0; i < 100; i++) {
    PrivilegeBits nxt=pb.nextBits();
    try {
      pb.diff(nxt);
      fail("UnsupportedOperation expected");
    }
 catch (    UnsupportedOperationException e) {
    }
    try {
      pb.diff(mod);
      fail("UnsupportedOperation expected");
    }
 catch (    UnsupportedOperationException e) {
    }
    PrivilegeBits before=PrivilegeBits.getInstance(mod);
    mod.diff(nxt);
    assertEquivalent(before,mod);
    mod.add(nxt);
    assertFalse(before.equals(mod));
    mod.diff(nxt);
    assertEquivalent(before,mod);
    mod.add(nxt);
    PrivilegeBits tmp=PrivilegeBits.getInstance(pb);
    tmp.add(nxt);
    tmp.add(READ_NODES_PRIVILEGE_BITS);
    tmp.diff(tmp);
    assertEquivalent(PrivilegeBits.EMPTY,tmp);
    tmp=PrivilegeBits.getInstance(pb);
    tmp.add(nxt);
    tmp.add(READ_NODES_PRIVILEGE_BITS);
    tmp.diff(PrivilegeBits.getInstance(tmp));
    assertEquivalent(PrivilegeBits.EMPTY,tmp);
    tmp=PrivilegeBits.getInstance(pb);
    tmp.diff(nxt);
    assertEquivalent(PrivilegeBits.getInstance(pb),tmp);
    tmp=PrivilegeBits.getInstance(nxt);
    tmp.add(READ_NODES_PRIVILEGE_BITS);
    assertTrue(tmp.includes(READ_NODES_PRIVILEGE_BITS));
    assertTrue(tmp.includes(nxt));
    tmp.diff(nxt);
    assertEquivalent(READ_NODES_PRIVILEGE_BITS,tmp);
    assertTrue(tmp.includes(READ_NODES_PRIVILEGE_BITS));
    assertFalse(tmp.includes(nxt));
    tmp=PrivilegeBits.getInstance(pb);
    tmp.add(READ_NODES_PRIVILEGE_BITS);
    PrivilegeBits tmp2=PrivilegeBits.getInstance(pb);
    tmp2.add(nxt);
    PrivilegeBits tmp3=PrivilegeBits.getInstance(tmp2);
    assertEquivalent(tmp2,tmp3);
    tmp.diff(tmp2);
    if (READ_NODES_PRIVILEGE_BITS.equals(pb)) {
      assertEquivalent(PrivilegeBits.EMPTY,tmp);
    }
 else {
      assertEquivalent(READ_NODES_PRIVILEGE_BITS,tmp);
    }
    assertEquivalent(tmp3,tmp2);
    pb=nxt;
  }
}

</code></pre>

<br>
<pre class="type-9 type-5 type-19 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether two objects/variables are the same
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetInstance(){
  PrivilegeBits pb=PrivilegeBits.getInstance();
  assertEquivalent(PrivilegeBits.EMPTY,pb);
  assertNotSame(PrivilegeBits.EMPTY,pb);
  assertNotSame(pb,pb.unmodifiable());
  pb.add(READ_NODES_PRIVILEGE_BITS);
  pb.addDifference(READ_NODES_PRIVILEGE_BITS,READ_NODES_PRIVILEGE_BITS);
  pb.diff(READ_NODES_PRIVILEGE_BITS);
  pb=PrivilegeBits.getInstance(PrivilegeBits.EMPTY);
  assertEquivalent(PrivilegeBits.EMPTY,pb);
  assertNotSame(PrivilegeBits.EMPTY,pb);
  assertNotSame(pb,pb.unmodifiable());
  pb.add(READ_NODES_PRIVILEGE_BITS);
  pb.addDifference(READ_NODES_PRIVILEGE_BITS,READ_NODES_PRIVILEGE_BITS);
  pb.diff(READ_NODES_PRIVILEGE_BITS);
  pb=PrivilegeBits.getInstance(READ_NODES_PRIVILEGE_BITS);
  assertEquivalent(READ_NODES_PRIVILEGE_BITS,pb);
  assertNotSame(READ_NODES_PRIVILEGE_BITS,pb);
  assertNotSame(pb,pb.unmodifiable());
  pb.add(READ_NODES_PRIVILEGE_BITS);
  pb.addDifference(READ_NODES_PRIVILEGE_BITS,PrivilegeBits.EMPTY);
  pb.diff(READ_NODES_PRIVILEGE_BITS);
  pb=PrivilegeBits.EMPTY;
  assertEquivalent(pb,PrivilegeBits.EMPTY);
  assertSame(pb,PrivilegeBits.EMPTY);
  assertSame(pb,pb.unmodifiable());
  try {
    pb.add(READ_NODES_PRIVILEGE_BITS);
    fail("UnsupportedOperation expected");
  }
 catch (  UnsupportedOperationException e) {
  }
  try {
    pb.addDifference(READ_NODES_PRIVILEGE_BITS,READ_NODES_PRIVILEGE_BITS);
    fail("UnsupportedOperation expected");
  }
 catch (  UnsupportedOperationException e) {
  }
  try {
    pb.diff(READ_NODES_PRIVILEGE_BITS);
    fail("UnsupportedOperation expected");
  }
 catch (  UnsupportedOperationException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testRetainUnmodifiable(){
  PrivilegeBits unmodifiable=READ_NODES_PRIVILEGE_BITS;
  try {
    unmodifiable.retain(PrivilegeBits.getInstance());
    fail();
  }
 catch (  UnsupportedOperationException e) {
  }
}

</code></pre>

<br>
<pre class="type-9 type-5 type-6 type-19 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetInstanceFromPropertyState(){
  for (  long l : LONGS) {
    PropertyState property=createPropertyState(l);
    PrivilegeBits pb=PrivilegeBits.getInstance(property);
    assertEquivalent(pb,PrivilegeBits.getInstance(property));
    assertSame(pb,pb.unmodifiable());
    assertEquivalent(pb,PrivilegeBits.getInstance(pb));
    assertEquivalent(PrivilegeBits.getInstance(pb),pb);
    assertNotSame(pb,PrivilegeBits.getInstance(pb));
    try {
      pb.add(READ_NODES_PRIVILEGE_BITS);
      fail("UnsupportedOperation expected");
    }
 catch (    UnsupportedOperationException e) {
    }
    try {
      pb.addDifference(READ_NODES_PRIVILEGE_BITS,READ_NODES_PRIVILEGE_BITS);
      fail("UnsupportedOperation expected");
    }
 catch (    UnsupportedOperationException e) {
    }
    try {
      pb.diff(READ_NODES_PRIVILEGE_BITS);
      fail("UnsupportedOperation expected");
    }
 catch (    UnsupportedOperationException e) {
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-9 type-12 type-5 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddDifference(){
  try {
    PrivilegeBits.EMPTY.addDifference(PrivilegeBits.EMPTY,PrivilegeBits.EMPTY);
    fail("UnsupportedOperation expected");
  }
 catch (  UnsupportedOperationException e) {
  }
  PrivilegeBits pb=READ_NODES_PRIVILEGE_BITS;
  PrivilegeBits mod=PrivilegeBits.getInstance(pb);
  for (int i=0; i < 100; i++) {
    PrivilegeBits nxt=pb.nextBits();
    try {
      pb.addDifference(nxt,mod);
      fail("UnsupportedOperation expected");
    }
 catch (    UnsupportedOperationException e) {
    }
    try {
      pb.addDifference(nxt,READ_NODES_PRIVILEGE_BITS);
      fail("UnsupportedOperation expected");
    }
 catch (    UnsupportedOperationException e) {
    }
    PrivilegeBits tmp=PrivilegeBits.getInstance(mod);
    tmp.addDifference(nxt,READ_NODES_PRIVILEGE_BITS);
    mod.add(nxt);
    assertEquivalent(mod,tmp);
    if (!pb.equals(READ_NODES_PRIVILEGE_BITS)) {
      tmp=PrivilegeBits.getInstance(nxt);
      PrivilegeBits mod2=PrivilegeBits.getInstance(mod);
      tmp.addDifference(mod2,READ_NODES_PRIVILEGE_BITS);
      assertFalse(nxt.equals(tmp));
      assertEquivalent(mod2,mod);
      assertTrue(tmp.includes(pb));
      assertFalse(tmp.includes(READ_NODES_PRIVILEGE_BITS));
      assertFalse(tmp.includes(mod));
    }
    tmp=PrivilegeBits.getInstance(nxt);
    PrivilegeBits mod2=PrivilegeBits.getInstance(mod);
    tmp.addDifference(READ_NODES_PRIVILEGE_BITS,mod2);
    assertEquivalent(nxt,tmp);
    assertEquivalent(mod2,mod);
    assertFalse(tmp.includes(pb));
    assertFalse(tmp.includes(READ_NODES_PRIVILEGE_BITS));
    assertFalse(tmp.includes(mod));
    tmp=PrivilegeBits.getInstance(nxt);
    tmp.addDifference(READ_NODES_PRIVILEGE_BITS,READ_NODES_PRIVILEGE_BITS);
    assertEquivalent(nxt,tmp);
    assertFalse(tmp.includes(READ_NODES_PRIVILEGE_BITS));
    tmp=PrivilegeBits.getInstance(mod);
    tmp.addDifference(READ_NODES_PRIVILEGE_BITS,READ_NODES_PRIVILEGE_BITS);
    assertEquivalent(mod,tmp);
    assertTrue(tmp.includes(READ_NODES_PRIVILEGE_BITS));
    pb=nxt;
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.spi.security.user.action.PasswordValidationActionTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testPasswordValidationActionOnChange() throws Exception {
  testUser=getUserManager(root).createUser("testuser","testPw123456");
  root.commit();
  try {
    pwAction.init(getSecurityProvider(),ConfigurationParameters.of(PasswordValidationAction.CONSTRAINT,"abc"));
    String hashed=PasswordUtil.buildPasswordHash("abc");
    testUser.changePassword(hashed);
    fail("Password change must always enforce password validation.");
  }
 catch (  ConstraintViolationException e) {
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testPasswordValidationAction() throws Exception {
  List<String> invalid=new ArrayList<String>();
  invalid.add("pw1");
  invalid.add("only6C");
  invalid.add("12345678");
  invalid.add("WITHOUTLOWERCASE");
  invalid.add("withoutuppercase");
  for (  String pw : invalid) {
    try {
      pwAction.onPasswordChange(user,pw,root,NamePathMapper.DEFAULT);
      fail("should throw constraint violation");
    }
 catch (    ConstraintViolationException e) {
    }
  }
  List<String> valid=new ArrayList<String>();
  valid.add("abCDefGH");
  valid.add("Abbbbbbbbbbbb");
  valid.add("cDDDDDDDDDDDDDDDDD");
  valid.add("gH%%%%%%%%%%%%%%%%^^");
  valid.add("&)(*&^%23qW");
  for (  String pw : valid) {
    pwAction.onPasswordChange(user,pw,root,NamePathMapper.DEFAULT);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.spi.security.user.util.PasswordUtilTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testBuildPasswordHashInvalidAlgorithm() throws Exception {
  List<String> invalidAlgorithms=new ArrayList<String>();
  invalidAlgorithms.add("");
  invalidAlgorithms.add("+");
  invalidAlgorithms.add("invalid");
  for (  String invalid : invalidAlgorithms) {
    try {
      PasswordUtil.buildPasswordHash("pw",invalid,PasswordUtil.DEFAULT_SALT_SIZE,PasswordUtil.DEFAULT_ITERATIONS);
      fail("Invalid algorithm " + invalid);
    }
 catch (    NoSuchAlgorithmException e) {
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.spi.state.NodeStoreTest </h4><pre class="type-9 type-5 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void rebaseWithFailedMerge() throws CommitFailedException {
  NodeBuilder rootBuilder=store.getRoot().builder();
  rootBuilder.child("foo");
  NodeBuilder b=store.getRoot().builder();
  b.child("bar");
  store.merge(b,EmptyHook.INSTANCE,CommitInfo.EMPTY);
  try {
    store.merge(rootBuilder,new CommitHook(){
      @Nonnull @Override public NodeState processCommit(      NodeState before,      NodeState after,      CommitInfo info) throws CommitFailedException {
        throw new CommitFailedException("",0,"commit rejected");
      }
    }
,CommitInfo.EMPTY);
    fail("must throw CommitFailedException");
  }
 catch (  CommitFailedException e) {
  }
  NodeState root=store.merge(rootBuilder,EmptyHook.INSTANCE,CommitInfo.EMPTY);
  assertTrue(root.hasChildNode("bar"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.util.AggregatingDescriptorsTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testNullServices() throws Exception {
  try {
    new AggregatingDescriptors(null);
    fail("should complain");
  }
 catch (  IllegalArgumentException iae) {
  }
  final MyTracker<Descriptors> tracker=createTracker();
  AggregatingDescriptors aggregator=new AggregatingDescriptors(tracker);
  assertEmpty(aggregator);
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
