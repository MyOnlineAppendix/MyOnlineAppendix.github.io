<h3><span class=" glyphicon glyphicon-tag"/>&nbspIterativeVerifier</h3><kbd>Verifies assertions in iterations</kbd><br><br><br><h4 style="margin:0px">Class: org.apache.jackrabbit.oak.cache.CacheTest </h4><pre class="type-13 type-9 type-12 type-6 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRandomOperations(){
  boolean log=false;
  int size=10;
  Random r=new Random(1);
  for (int j=0; j < 100; j++) {
    CacheLIRS<Integer,Integer> test=createCache(size / 2);
    HashMap<Integer,Integer> good=new HashMap<Integer,Integer>();
    for (int i=0; i < 10000; i++) {
      int key=r.nextInt(size);
      int value=r.nextInt();
switch (r.nextInt(3)) {
case 0:
        if (log) {
          System.out.println(i + " put " + key+ " "+ value);
        }
      good.put(key,value);
    test.put(key,value);
  break;
case 1:
if (log) {
  System.out.println(i + " get " + key);
}
Integer a=good.get(key);
Integer b=test.getIfPresent(key);
if (a == null) {
assertNull(b);
}
 else if (b != null) {
assertEquals(a,b);
}
break;
case 2:
if (log) {
System.out.println(i + " remove " + key);
}
good.remove(key);
test.remove(key);
break;
}
if (log) {
System.out.println(" -> " + toString(test));
}
}
verify(test,null);
}
}

</code></pre>

<br>
<pre class="type-13 type-12 type-6 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBadHashMethod(){
  final int size=4;
  /** 
 * A class with a bad hashCode implementation.
 */
class BadHash {
    int x;
    BadHash(    int x){
      this.x=x;
    }
    @Override public int hashCode(){
      return (x & 1) * size * 2;
    }
    @Override public boolean equals(    Object o){
      return ((BadHash)o).x == x;
    }
    @Override public String toString(){
      return "" + x;
    }
  }
  CacheLIRS<BadHash,Integer> test=createCache(size * 2);
  for (int i=0; i < size; i++) {
    test.put(new BadHash(i),i);
  }
  for (int i=0; i < size; i++) {
    if (i % 3 == 0) {
      assertEquals(i,test.remove(new BadHash(i)).intValue());
      assertNull(test.remove(new BadHash(i)));
    }
  }
  for (int i=0; i < size; i++) {
    if (i % 3 == 0) {
      assertNull(test.getIfPresent(new BadHash(i)));
    }
 else {
      assertEquals(i,test.getIfPresent(new BadHash(i)).intValue());
    }
  }
  for (int i=0; i < size; i++) {
    test.put(new BadHash(i),i);
  }
  for (int i=0; i < size; i++) {
    if (i % 3 == 0) {
      assertEquals(i,test.remove(new BadHash(i)).intValue());
      assertNull(test.remove(new BadHash(i)));
    }
  }
  for (int i=0; i < size; i++) {
    if (i % 3 == 0) {
      assertNull(test.getIfPresent(new BadHash(i)));
    }
 else {
      assertEquals(i,test.getIfPresent(new BadHash(i)).intValue());
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-12 type-7 type-6 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testScanResistance(){
  boolean log=false;
  int size=20;
  CacheLIRS<Integer,Integer> test=createCache(size / 2 + 1);
  for (int i=0; i < size; i++) {
    test.put(-i,-i * 10);
  }
  verify(test,null);
  for (int i=0; i < size / 2; i++) {
    test.put(i,i * 10);
    test.getUnchecked(i);
    if (log) {
      System.out.println("get " + i + " -> "+ test);
    }
  }
  verify(test,null);
  for (int i=0; i < size; i++) {
    Integer x=test.getIfPresent(i);
    Integer y=test.peek(i);
    if (i < size / 2) {
      assertTrue("i: " + i,x != null);
      assertTrue("i: " + i,y != null);
      assertEquals(i * 10,x.intValue());
      assertEquals(i * 10,y.intValue());
    }
 else {
      assertNull(x);
      assertNull(y);
      test.put(i,i * 10);
      assertEquals(i * 10,test.peek(i).intValue());
    }
    if (log) {
      System.out.println("get " + i + " -> "+ test);
    }
    verify(test,null);
  }
  for (int i=0; i < size; i++) {
    Integer x=test.getIfPresent(i);
    if (i < size / 2 || i == size - 1) {
      assertTrue("i: " + i,x != null);
      assertEquals(i * 10,x.intValue());
    }
 else {
      assertNull(x);
    }
    verify(test,null);
  }
}

</code></pre>

<br>
<pre class="type-13 type-9 type-12 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void evictionCallbackRandomized() throws ExecutionException {
  final HashMap<Integer,Integer> evictedMap=new HashMap<Integer,Integer>();
  final HashSet<Integer> evictedNonResidentSet=new HashSet<Integer>();
  CacheLIRS<Integer,Integer> cache=CacheLIRS.<Integer,Integer>newBuilder().maximumSize(10).evictionCallback(new EvictionCallback<Integer,Integer>(){
    @Override public void evicted(    Integer key,    Integer value){
      if (value == null) {
        assertTrue(evictedNonResidentSet.add(key));
      }
 else {
        assertEquals(null,evictedMap.put(key,value));
      }
    }
  }
).build();
  Random r=new Random(1);
  for (int k=0; k < 10000; k++) {
    if (r.nextInt(20) == 0) {
      evictedMap.clear();
      evictedNonResidentSet.clear();
      long size=cache.size();
      long sizeNonResident=cache.sizeNonResident();
      cache.invalidateAll();
      assertEquals(evictedMap.size(),size);
      assertEquals(evictedNonResidentSet.size(),sizeNonResident);
    }
    evictedMap.clear();
    evictedNonResidentSet.clear();
    int key=r.nextInt(20);
    if (r.nextBoolean()) {
      cache.put(key,k);
    }
 else {
      cache.get(key);
    }
    for (    Entry<Integer,Integer> ev : evictedMap.entrySet()) {
      int ek=ev.getKey();
      if (ek == key) {
      }
 else {
        assertFalse(cache.containsKey(ek));
      }
    }
    for (    Entry<Integer,Integer> ev : evictedMap.entrySet()) {
      int ek=ev.getKey();
      Integer v=ev.getValue();
      assertTrue(v < k);
      if (ek == key) {
      }
 else {
        assertFalse(cache.containsKey(ek));
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.commons.sort.EscapeUtilsTest </h4><pre class="type-13 type-9 type-7 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void randomized() throws Exception {
  Random r=new Random(1);
  for (int i=0; i < 100000; i++) {
    int len=r.nextInt(10);
    StringBuilder buff=new StringBuilder();
    for (int j=0; j < len; j++) {
switch (r.nextInt(3)) {
case 0:
        String s="\\\r\nrnRN ";
      buff.append(s.charAt(r.nextInt(s.length())));
    break;
case 1:
  buff.append(RandomStringUtils.random(4,true,false));
break;
case 2:
buff.append((char)r.nextInt(65000));
break;
}
}
String original=buff.toString();
String escaped=EscapeUtils.escapeLineBreak(original);
String unescaped=EscapeUtils.unescapeLineBreaks(escaped);
assertTrue(escaped.indexOf('\n') < 0);
assertTrue(escaped.indexOf('\r') < 0);
assertEquals(original,unescaped);
}
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.core.RootTest </h4><pre class="type-13 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void purgePreservesStatus() throws CommitFailedException {
  Tree x=session.getLatestRoot().getTree("/x");
  Tree added=x.addChild("added");
  for (int k=0; k < 10000; k++) {
    assertEquals("k=" + k,NEW,x.getChild("added").getStatus());
    x.addChild("k" + k);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.AtomicCounterClusterIT </h4><pre class="type-13 type-9 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void increments() throws Exception {
  setUpCluster(this.getClass(),mks,repos,NOT_PROVIDED);
  assertEquals("repositories and executors should match",repos.size(),executors.size());
  final String counterPath;
  final Random rnd=new Random(14);
  final AtomicLong expected=new AtomicLong(0);
  final Map<String,Exception> exceptions=Collections.synchronizedMap(new HashMap<String,Exception>());
  Repository repo=repos.get(0);
  Session session=repo.login(ADMIN);
  Node counter;
  try {
    counter=session.getRootNode().addNode("counter");
    counter.addMixin(MIX_ATOMIC_COUNTER);
    session.save();
    counterPath=counter.getPath();
  }
  finally {
    session.logout();
  }
  alignCluster(mks);
  assertFalse("Path to the counter node should be set",Strings.isNullOrEmpty(counterPath));
  for (  Repository r : repos) {
    try {
      session=r.login(ADMIN);
      counter=session.getNode(counterPath);
      assertEquals("Nothing should have touched the `expected`",0,expected.get());
      assertEquals("Wrong initial counter",expected.get(),counter.getProperty(PROP_COUNTER).getLong());
    }
  finally {
      session.logout();
    }
  }
  final int numIncrements=Integer.getInteger("oak.test.it.atomiccounter.threads",100);
  LOG.debug("pushing {} increments per each of the {} cluster nodes for a total of {} concurrent updates",numIncrements,repos.size(),numIncrements * repos.size());
  long start=LOG_PERF.start("Firing the threads");
  List<ListenableFutureTask<Void>> tasks=Lists.newArrayList();
  for (  Repository rep : repos) {
    final Repository r=rep;
    for (int i=0; i < numIncrements; i++) {
      ListenableFutureTask<Void> task=ListenableFutureTask.create(new Callable<Void>(){
        @Override public Void call() throws Exception {
          Session s=r.login(ADMIN);
          try {
            try {
              Node n=s.getNode(counterPath);
              int increment=rnd.nextInt(10) + 1;
              n.setProperty(PROP_INCREMENT,increment);
              expected.addAndGet(increment);
              s.save();
            }
  finally {
              s.logout();
            }
          }
 catch (          Exception e) {
            exceptions.put(Thread.currentThread().getName(),e);
          }
          return null;
        }
      }
);
      new Thread(task).start();
      tasks.add(task);
    }
  }
  LOG_PERF.end(start,-1,"Firing threads completed","");
  Futures.allAsList(tasks).get();
  LOG_PERF.end(start,-1,"Futures completed","");
  waitForTaskCompletion();
  LOG_PERF.end(start,-1,"All tasks completed","");
  Thread.sleep(5000);
  raiseExceptions(exceptions,LOG);
  for (int i=0; i < repos.size(); i++) {
    Repository r=repos.get(i);
    try {
      session=r.login(ADMIN);
      counter=session.getNode(counterPath);
      LOG.debug("Cluster node: {}, actual counter: {}, expected counter: {}",i + 1,expected.get(),counter.getProperty(PROP_COUNTER).getLong());
      assertEquals("Wrong counter on node " + (i + 1),expected.get(),counter.getProperty(PROP_COUNTER).getLong());
    }
  finally {
      session.logout();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.CopyTest </h4><pre class="type-13 type-12 type-5 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCopyVersionableNodeClearsVersions() throws Exception {
  Session session=getAdminSession();
  Node toCopy=session.getNode(TEST_PATH + "/source/node");
  toCopy.addMixin(JcrConstants.MIX_VERSIONABLE);
  session.save();
  Version v1=toCopy.checkin();
  toCopy.checkout();
  Version v2=toCopy.checkin();
  toCopy.checkout();
  session.getWorkspace().copy(TEST_PATH + "/source/node",TEST_PATH + "/target/copied");
  Node copy=testNode.getNode("target/copied");
  VersionHistory vh=copy.getVersionHistory();
  Version rootV=vh.getRootVersion();
  assertEquals(0,rootV.getSuccessors().length);
  VersionIterator vItr=vh.getAllVersions();
  while (vItr.hasNext()) {
    if (!rootV.isSame(vItr.nextVersion())) {
      fail("Unexpected version in version history of copied node.");
    }
  }
  try {
    vh.getVersion(v1.getName());
    fail("Unexpected version in version history of copied node.");
  }
 catch (  VersionException e) {
  }
  try {
    vh.getVersion(v2.getName());
    fail("Unexpected version in version history of copied node.");
  }
 catch (  VersionException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.LongPathTest </h4><pre class="type-13 type-9 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testLongPath() throws Exception {
  Session s=getAdminSession();
  StringBuilder buff=new StringBuilder();
  for (int i=0; i < 10; i++) {
    buff.append("0123456789");
  }
  String longName="n" + buff.toString();
  Node n=s.getRootNode();
  ArrayList<String> paths=new ArrayList<String>();
  for (int i=0; i < 30; i++) {
    n=n.addNode(longName + "_" + i);
    paths.add(n.getPath());
  }
  s.save();
  Session s2=createAdminSession();
  Node n2=s2.getRootNode();
  for (int i=0; i < 30; i++) {
    n2=n2.getNode(longName + "_" + i);
    assertEquals(paths.get(i),n2.getPath());
  }
  s2.logout();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.ManyChildrenIT </h4><pre class="type-13 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void sizeTest() throws Exception {
  Session session=getAdminSession();
  int count=5000;
  String nodeType="nt:folder";
  Node many=session.getRootNode().addNode("many",nodeType);
  for (int i=0; i < count; i++) {
    many.addNode("test" + i,nodeType);
  }
  session.save();
  Session session2=getAdminSession();
  many=session2.getRootNode().getNode("many");
  NodeIterator it=many.getNodes();
  long size=it.getSize();
  assertTrue("size: " + size,size == -1 || size == count);
  for (int i=0; i < count; i++) {
    assertTrue(it.hasNext());
    it.next();
  }
  assertFalse(it.hasNext());
  session2.logout();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.OrderableNodesTest </h4><pre class="type-13 type-9 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void setPrimaryType() throws Exception {
  new TestContentLoader().loadTestContent(getAdminSession());
  Session session=getAdminSession();
  Node root=session.getRootNode().addNode("test","nt:folder");
  List<String> names=new ArrayList<String>();
  for (int i=0; i < 100; i++) {
    String name="node-" + i;
    root.addNode(name,"nt:folder");
    names.add(name);
  }
  root.setPrimaryType("test:orderableFolder");
  List<String> expected=getChildNames(root);
  while (!expected.isEmpty()) {
    String name=expected.remove((int)Math.floor(Math.random() * expected.size()));
    root.getNode(name).remove();
    assertEquals(expected,getChildNames(root));
  }
  for (  String name : names) {
    root.addNode(name,"nt:folder");
    expected.add(name);
    assertEquals(expected,getChildNames(root));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.RepositoryTest </h4><pre class="type-13 type-12 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void getProperties() throws RepositoryException {
  Set<String> propertyNames=new HashSet<String>(){
{
      add("intProp");
      add("mvProp");
      add("added");
    }
  }
;
  Set<String> values=new HashSet<String>(){
{
      add("added");
      add("1");
      add("2");
      add("3");
      add("42");
    }
  }
;
  Node node=getNode("/foo");
  node.setProperty("added","added");
  node.getProperty("stringProp").remove();
  node.getProperty("intProp").remove();
  node.setProperty("intProp",42);
  PropertyIterator properties=node.getProperties();
  assertEquals(4,properties.getSize());
  while (properties.hasNext()) {
    Property p=properties.nextProperty();
    if (JcrConstants.JCR_PRIMARYTYPE.equals(p.getName())) {
      continue;
    }
    assertTrue(propertyNames.remove(p.getName()));
    if (p.isMultiple()) {
      for (      Value v : p.getValues()) {
        assertTrue(values.remove(v.getString()));
      }
    }
 else {
      assertTrue(values.remove(p.getString()));
    }
  }
  assertTrue(propertyNames.isEmpty());
  assertTrue(values.isEmpty());
}

</code></pre>

<br>
<pre class="type-13 type-9 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void getNodes() throws RepositoryException {
  Node test=getNode(TEST_PATH);
  test.addNode("foo");
  test.addNode("bar");
  test.addNode("baz");
  getAdminSession().save();
  Set<String> nodeNames=new HashSet<String>(){
{
      add("bar");
      add("added");
      add("baz");
    }
  }
;
  test=getNode(TEST_PATH);
  test.addNode("added");
  test.getNode("foo").remove();
  test.getNode("bar").remove();
  test.addNode("bar");
  NodeIterator nodes=test.getNodes();
  assertEquals(3,nodes.getSize());
  while (nodes.hasNext()) {
    String name=nodes.nextNode().getName();
    assertTrue(nodeNames.remove(name));
  }
  assertTrue(nodeNames.isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.SameNameSiblingTest </h4><pre class="type-13 type-9 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void iterateSiblings() throws RepositoryException {
  Set<String> expected=newHashSet(SIBLINGS);
  expected.add(SIBLING);
  expected.remove(SIBLINGS[0]);
  NodeIterator siblings=sns.getNodes();
  while (siblings.hasNext()) {
    Node sib=siblings.nextNode();
    assertTrue("Unexpected node: " + sib.getPath(),expected.remove(sib.getName()));
  }
  assertTrue("Missing nodes: " + expected,expected.isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.cluster.ManyChildrenTest </h4><pre class="type-13 type-9 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void manyChildrenWithoutIndex() throws Exception {
  if (session == null) {
    return;
  }
  Node index=session.getRootNode().getNode("oak:index");
  if (index.hasNode("nodetype")) {
    index.getNode("nodetype").remove();
    session.save();
  }
  long start=System.currentTimeMillis(), last=start;
  int count=10;
  Profiler prof=null;
  String nodeType=NodeTypeConstants.NT_OAK_UNSTRUCTURED;
  if (session.getRootNode().hasNode("many")) {
    session.getRootNode().getNode("many").remove();
    session.save();
  }
  Node many=session.getRootNode().addNode("many",nodeType);
  for (int i=0; i < count; i++) {
    Node n=many.addNode("test" + i,nodeType);
    n.setProperty("prop",i);
    if (i % 100 == 0) {
      session.save();
    }
    long now=System.currentTimeMillis();
    if (now - last > 5000) {
      int opsPerSecond=(int)(i * 1000 / (now - start));
      System.out.println(i + " ops; " + opsPerSecond+ " op/s");
      last=now;
      if (prof != null) {
        System.out.println(prof.getTop(5));
      }
      if (opsPerSecond < 1000 && i % 100 == 0) {
        prof=new Profiler();
        prof.startCollecting();
      }
    }
  }
  start=System.currentTimeMillis();
  last=start;
  for (int i=0; i < count; i++) {
    Node n=many.getNode("test" + i);
    long x=n.getProperty("prop").getValue().getLong();
    assertEquals(i,x);
    long now=System.currentTimeMillis();
    if (now - last > 5000) {
      int opsPerSecond=(int)(i * 1000 / (now - start));
      System.out.println(i + " read ops; " + opsPerSecond+ " op/s");
      last=now;
      if (prof != null) {
        System.out.println(prof.getTop(5));
      }
      if (opsPerSecond < 1000 && i % 100 == 0) {
        prof=new Profiler();
        prof.startCollecting();
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.cluster.ObservationTest </h4><pre class="type-13 type-9 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void externalEvents() throws Throwable {
  final Set<String> externallyAdded=synchronizedSet(new LinkedHashSet<String>());
  final List<Throwable> exceptions=Lists.newArrayList();
  ObservationManager obsMgr=s1.getWorkspace().getObservationManager();
  final AtomicLong localEvents=new AtomicLong();
  final AtomicLong externalEvents=new AtomicLong();
  EventListener listener=new EventListener(){
    @Override public void onEvent(    EventIterator events){
      try {
        Set<String> paths=Sets.newHashSet();
        while (events.hasNext()) {
          Event event=events.nextEvent();
          String external="";
          AtomicLong counter=localEvents;
          if (event instanceof JackrabbitEvent) {
            if (((JackrabbitEvent)event).isExternal()) {
              external=" (external)";
              counter=externalEvents;
              paths.add(event.getPath());
            }
          }
          System.out.println(event.getPath() + external);
          counter.incrementAndGet();
        }
        while (!paths.isEmpty()) {
          Iterator<String> it=externallyAdded.iterator();
          String p=it.next();
          assertTrue("missing event for " + p,paths.remove(p));
          it.remove();
        }
      }
 catch (      Throwable e) {
        exceptions.add(e);
      }
    }
  }
;
  obsMgr.addEventListener(listener,Event.NODE_ADDED,"/",true,null,null,false);
  Future f1=executor.submit(new Worker(s1,exceptions,new HashSet<String>()));
  Future f2=executor.submit(new Worker(s2,exceptions,externallyAdded));
  f1.get();
  f2.get();
  Thread.sleep(10 * 1000);
  System.out.println("local events: " + localEvents.get());
  System.out.println("external events: " + externalEvents.get());
  for (  Throwable t : exceptions) {
    throw t;
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.observation.ObservationRefreshTest </h4><pre class="type-13 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void observation() throws RepositoryException, InterruptedException, ExecutionException {
  final MyListener listener=new MyListener();
  observationManager.addEventListener(listener,ALL_EVENTS,"/",true,null,null,false);
  try {
    Node n=getAdminSession().getNode(TEST_PATH);
    for (int i=0; i < 1000; i++) {
      n.addNode("n" + i);
      n.getSession().save();
    }
    listener.waitFor(CONDITION_TIMEOUT,new Condition(){
      @Override public boolean evaluate(){
        return listener.numAdded == 1000;
      }
    }
);
    assertEquals("",listener.error);
    assertEquals("added nodes",1000,listener.numAdded);
    for (int i=0; i < 1000; i++) {
      n.getNode("n" + i).remove();
      n.getSession().save();
    }
    listener.waitFor(CONDITION_TIMEOUT,new Condition(){
      @Override public boolean evaluate(){
        return listener.numRemoved == 1000;
      }
    }
);
    assertEquals("",listener.error);
    assertEquals("removed nodes",1000,listener.numRemoved);
    for (int i=0; i < 100; i++) {
      n.setProperty("test" + i,"foo");
      n.getSession().save();
    }
    listener.waitFor(CONDITION_TIMEOUT,new Condition(){
      @Override public boolean evaluate(){
        return listener.numPropsAdded == 1100;
      }
    }
);
    assertEquals("",listener.error);
    assertEquals("properties added",1100,listener.numPropsAdded);
    for (int i=0; i < 100; i++) {
      n.setProperty("test" + i,i);
      n.getSession().save();
    }
    listener.waitFor(CONDITION_TIMEOUT,new Condition(){
      @Override public boolean evaluate(){
        return listener.numPropsModified == 100;
      }
    }
);
    assertEquals("",listener.error);
    assertEquals("properties modified",100,listener.numPropsModified);
    for (int i=0; i < 10; i++) {
      n.setProperty("test100","foo");
      n.getSession().save();
      assertTrue("Gave up waiting for events",listener.waitFor(CONDITION_TIMEOUT,new Condition(){
        @Override public boolean evaluate(){
          return listener.test100Exists;
        }
      }
));
      n.getProperty("test100").remove();
      n.getSession().save();
      assertTrue("Gave up waiting for events",listener.waitFor(CONDITION_TIMEOUT,new Condition(){
        @Override public boolean evaluate(){
          return !listener.test100Exists;
        }
      }
));
    }
    assertEquals("",listener.error);
    for (int i=0; i < 100; i++) {
      n.getProperty("test" + i).remove();
      n.getSession().save();
    }
    listener.waitFor(CONDITION_TIMEOUT,new Condition(){
      @Override public boolean evaluate(){
        return listener.numPropsRemoved == 1100;
      }
    }
);
    assertEquals("",listener.error);
    assertEquals("properties removed",1100,listener.numPropsRemoved);
  }
  finally {
    observationManager.removeEventListener(listener);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.query.QueryTest </h4><pre class="type-13 type-12 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void skip() throws RepositoryException {
  Session session=getAdminSession();
  Node hello1=session.getRootNode().addNode("hello1");
  hello1.setProperty("id","1");
  hello1.setProperty("data","x");
  session.save();
  Node hello3=hello1.addNode("hello3");
  hello3.setProperty("id","3");
  hello3.setProperty("data","z");
  session.save();
  Node hello2=hello3.addNode("hello2");
  hello2.setProperty("id","2");
  hello2.setProperty("data","y");
  session.save();
  ValueFactory vf=session.getValueFactory();
  QueryManager qm=session.getWorkspace().getQueryManager();
  Query q=qm.createQuery("select id from [nt:base] where data >= $data order by id",Query.JCR_SQL2);
  q.bindValue("data",vf.createValue("x"));
  for (int i=-1; i < 5; i++) {
    QueryResult r=q.execute();
    RowIterator it=r.getRows();
    assertEquals(3,r.getRows().getSize());
    assertEquals(3,r.getNodes().getSize());
    Row row;
    try {
      it.skip(i);
      assertTrue(i >= 0 && i <= 3);
    }
 catch (    IllegalArgumentException e) {
      assertEquals(-1,i);
    }
catch (    NoSuchElementException e) {
      assertTrue(i >= 2);
    }
    if (i <= 0) {
      assertTrue(it.hasNext());
      row=it.nextRow();
      assertEquals("1",row.getValue("id").getString());
    }
    if (i <= 1) {
      assertTrue(it.hasNext());
      row=it.nextRow();
      assertEquals("2",row.getValue("id").getString());
    }
    if (i <= 2) {
      assertTrue(it.hasNext());
      row=it.nextRow();
      assertEquals("3",row.getValue("id").getString());
    }
    assertFalse(it.hasNext());
  }
}

</code></pre>

<br>
<pre class="type-13 type-9 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void limit() throws RepositoryException {
  Session session=getAdminSession();
  Node hello1=session.getRootNode().addNode("hello1");
  hello1.setProperty("id","1");
  hello1.setProperty("data","x");
  session.save();
  Node hello3=session.getRootNode().addNode("hello3");
  hello3.setProperty("id","3");
  hello3.setProperty("data","z");
  session.save();
  Node hello2=session.getRootNode().addNode("hello2");
  hello2.setProperty("id","2");
  hello2.setProperty("data","y");
  session.save();
  ValueFactory vf=session.getValueFactory();
  QueryManager qm=session.getWorkspace().getQueryManager();
  Query q=qm.createQuery("select id from [nt:base] where data >= $data order by id",Query.JCR_SQL2);
  q.bindValue("data",vf.createValue("x"));
  for (int limit=0; limit < 5; limit++) {
    q.setLimit(limit);
    for (int offset=0; offset < 3; offset++) {
      q.setOffset(offset);
      QueryResult r=q.execute();
      RowIterator it=r.getRows();
      int l=Math.min(Math.max(0,3 - offset),limit);
      assertEquals(l,r.getRows().getSize());
      assertEquals(l,r.getNodes().getSize());
      Row row;
      for (int x=offset + 1, i=0; i < limit && x < 4; i++, x++) {
        assertTrue(it.hasNext());
        row=it.nextRow();
        assertEquals("" + x,row.getValue("id").getString());
      }
      assertFalse(it.hasNext());
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.authorization.AccessControlManagementTest </h4><pre class="type-13 type-12 type-5 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAcContentIsProtected() throws Exception {
  Node policyNode=findPolicyNode(superuser.getRootNode());
  if (policyNode == null) {
    throw new NotExecutableException("no policy node found.");
  }
  assertTrue("The rep:Policy node must be protected",policyNode.getDefinition().isProtected());
  try {
    policyNode.remove();
    fail("rep:Policy node must be protected.");
  }
 catch (  ConstraintViolationException e) {
  }
  for (NodeIterator it=policyNode.getNodes(); it.hasNext(); ) {
    Node n=it.nextNode();
    if (n.isNodeType("rep:ACE")) {
      try {
        n.remove();
        fail("ACE node must be protected.");
      }
 catch (      ConstraintViolationException e) {
      }
      break;
    }
  }
  try {
    policyNode.setProperty("test","anyvalue");
    fail("rep:policy node must be protected.");
  }
 catch (  ConstraintViolationException e) {
  }
  try {
    policyNode.addNode("test","rep:ACE");
    fail("rep:policy node must be protected.");
  }
 catch (  ConstraintViolationException e) {
  }
}

</code></pre>

<br>
<pre class="type-13 type-9 type-12 type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRetrievePrivilegesOnAcNodes() throws Exception {
  Privilege[] privileges=privilegesFromName(Privilege.JCR_READ_ACCESS_CONTROL);
  allow(path,privileges);
  assertTrue(testAcMgr.hasPrivileges(path,privileges));
  AccessControlPolicy[] policies=testAcMgr.getPolicies(path);
  assertEquals(1,policies.length);
  assertTrue(policies[0] instanceof JackrabbitAccessControlList);
  String aclNodePath=null;
  Node n=superuser.getNode(path);
  for (NodeIterator itr=n.getNodes(); itr.hasNext(); ) {
    Node child=itr.nextNode();
    if (child.isNodeType("rep:Policy")) {
      aclNodePath=child.getPath();
    }
  }
  if (aclNodePath == null) {
    fail("Expected node at " + path + " to have an ACL child node.");
  }
  assertTrue(testAcMgr.hasPrivileges(aclNodePath,privileges));
  assertTrue(testSession.hasPermission(aclNodePath,Session.ACTION_READ));
  for (NodeIterator aceNodes=superuser.getNode(aclNodePath).getNodes(); aceNodes.hasNext(); ) {
    String aceNodePath=aceNodes.nextNode().getPath();
    assertTrue(testAcMgr.hasPrivileges(aceNodePath,privileges));
    assertTrue(testSession.hasPermission(aceNodePath,Session.ACTION_READ));
  }
}

</code></pre>

<br>
<pre class="type-13 type-9 type-5 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadAccessControlWithoutPrivilege() throws Exception {
  Privilege[] privileges=privilegesFromName(Privilege.JCR_READ);
  JackrabbitAccessControlList tmpl=allow(path,privileges);
  String policyPath=tmpl.getPath() + "/rep:policy";
  assertTrue(superuser.itemExists(policyPath));
  assertFalse(testAcMgr.hasPrivileges(path,privilegesFromName(Privilege.JCR_READ_ACCESS_CONTROL)));
  assertFalse(testSession.itemExists(policyPath));
  assertFalse(testSession.nodeExists(policyPath));
  try {
    testSession.getNode(policyPath);
    fail("Accessing the rep:policy node must throw PathNotFoundException.");
  }
 catch (  PathNotFoundException e) {
  }
  try {
    testAcMgr.getPolicies(tmpl.getPath());
    fail("test user must not have READ_AC privilege.");
  }
 catch (  AccessDeniedException e) {
  }
  try {
    testAcMgr.getEffectivePolicies(tmpl.getPath());
    fail("test user must not have READ_AC privilege.");
  }
 catch (  AccessDeniedException e) {
  }
  for (NodeIterator aceNodes=superuser.getNode(policyPath).getNodes(); aceNodes.hasNext(); ) {
    Node aceNode=aceNodes.nextNode();
    String aceNodePath=aceNode.getPath();
    assertFalse(testSession.nodeExists(aceNodePath));
    for (PropertyIterator it=aceNode.getProperties(); it.hasNext(); ) {
      assertFalse(testSession.propertyExists(it.nextProperty().getPath()));
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.authorization.ReadPropertyTest </h4><pre class="type-13 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testDenySingleProperty() throws Exception {
  allow(path,privilegesFromName(PrivilegeConstants.JCR_READ));
  deny(path,privilegesFromName(PrivilegeConstants.REP_READ_PROPERTIES),createGlobRestriction("*/" + propertyName1));
  assertTrue(testSession.nodeExists(path));
  assertTrue(testSession.itemExists(path));
  assertTrue(testSession.nodeExists(childNPath));
  List<String> allowed=new ArrayList<String>();
  allowed.add(path + "/jcr:primaryType");
  allowed.add(childNPath + "/jcr:primaryType");
  for (  String pPath : allowed) {
    assertTrue(testSession.itemExists(pPath));
    assertTrue(testSession.propertyExists(pPath));
  }
  List<String> denied=new ArrayList<String>();
  denied.add(childPPath);
  denied.add(childchildPPath);
  for (  String pPath : denied) {
    assertFalse(testSession.itemExists(pPath));
    assertFalse(testSession.propertyExists(pPath));
  }
  Node target=testSession.getNode(path);
  PropertyIterator pit=target.getProperties();
  while (pit.hasNext()) {
    assertFalse(propertyName1.equals(pit.nextProperty().getName()));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.authorization.UserManagementTest </h4><pre class="type-13 type-12 type-5 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @see <a href="https://issues.apache.org/jira/browse/JCR-3412">JCR-3412 :
     *      UserManager.findAuthorizables() does not work, if session does not have
     *      read access to common root of all user and groups. </a>
 */
@Test public void testFindAuthorizables() throws Exception {
  String home=Text.getRelativeParent(UserConstants.DEFAULT_USER_PATH,1);
  deny(home,privilegesFromName(PrivilegeConstants.JCR_READ));
  allow(getUserManager(superuser).getAuthorizable(testSession.getUserID()).getPath(),privilegesFromName(PrivilegeConstants.JCR_ALL));
  UserManager testUserMgr=getUserManager(testSession);
  Iterator<Authorizable> result=testUserMgr.findAuthorizables(UserConstants.REP_PRINCIPAL_NAME,null,UserManager.SEARCH_TYPE_USER);
  Set<String> ids=new HashSet<String>();
  while (result.hasNext()) {
    ids.add(result.next().getID());
  }
  assertFalse(ids.isEmpty());
  NodeIterator nodeIterator=testSession.getWorkspace().getQueryManager().createQuery("/jcr:root//element(*,rep:User)",Query.XPATH).execute().getNodes();
  assertTrue(nodeIterator.hasNext());
  while (nodeIterator.hasNext()) {
    String userId=nodeIterator.nextNode().getProperty(UserConstants.REP_AUTHORIZABLE_ID).getString();
    if (!ids.remove(userId)) {
      fail("UserId " + userId + " missing in result set.");
    }
  }
  assertTrue("Result mismatch",ids.isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.principal.PrincipalManagerTest </h4><pre class="type-13 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testGetGroupPrincipals(){
  PrincipalIterator it=principalMgr.getPrincipals(PrincipalManager.SEARCH_TYPE_GROUP);
  while (it.hasNext()) {
    Principal p=it.nextPrincipal();
    assertTrue(isGroup(p));
  }
}

</code></pre>

<br>
<pre class="type-13 type-9 type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testMembers(){
  PrincipalIterator it=principalMgr.getPrincipals(PrincipalManager.SEARCH_TYPE_ALL);
  while (it.hasNext()) {
    Principal p=it.nextPrincipal();
    if (p.equals(principalMgr.getEveryone())) {
      continue;
    }
    if (isGroup(p)) {
      Enumeration<? extends Principal> en=((java.security.acl.Group)p).members();
      while (en.hasMoreElements()) {
        Principal memb=en.nextElement();
        assertTrue(principalMgr.hasPrincipal(memb.getName()));
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-12 type-5 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEveryoneGroupMembership(){
  Principal everyone=EveryonePrincipal.getInstance();
  for (PrincipalIterator membership=principalMgr.getGroupMembership(everyone); membership.hasNext(); ) {
    Principal gr=membership.nextPrincipal();
    assertTrue(isGroup(gr));
    if (gr.equals(everyone)) {
      fail("Everyone must never be a member of the EveryOne group.");
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testGetPrincipals(){
  PrincipalIterator it=principalMgr.getPrincipals(PrincipalManager.SEARCH_TYPE_NOT_GROUP);
  while (it.hasNext()) {
    Principal p=it.nextPrincipal();
    assertFalse(isGroup(p));
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetAllPrincipals(){
  PrincipalIterator it=principalMgr.getPrincipals(PrincipalManager.SEARCH_TYPE_ALL);
  while (it.hasNext()) {
    Principal p=it.nextPrincipal();
    assertTrue(principalMgr.hasPrincipal(p.getName()));
    assertEquals(principalMgr.getPrincipal(p.getName()),p);
  }
}

</code></pre>

<br>
<pre class="type-13 type-9 type-7 type-6 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetMembersConsistentWithMembership(){
  Principal everyone=principalMgr.getEveryone();
  PrincipalIterator it=principalMgr.getPrincipals(PrincipalManager.SEARCH_TYPE_GROUP);
  while (it.hasNext()) {
    Principal p=it.nextPrincipal();
    if (p.equals(everyone)) {
      continue;
    }
    assertTrue(isGroup(p));
    Enumeration<? extends Principal> members=((java.security.acl.Group)p).members();
    while (members.hasMoreElements()) {
      Principal memb=members.nextElement();
      Principal group=null;
      PrincipalIterator mship=principalMgr.getGroupMembership(memb);
      while (mship.hasNext() && group == null) {
        Principal gr=mship.nextPrincipal();
        if (p.equals(gr)) {
          group=gr;
        }
      }
      assertNotNull("Group member " + memb.getName() + "does not reveal group upon getGroupMembership",p.getName());
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-9 type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testMembers2() throws Exception {
  Authorizable gr=null;
  try {
    gr=((JackrabbitSession)superuser).getUserManager().createGroup(getClass().getName());
    superuser.save();
    PrincipalIterator it=principalMgr.getPrincipals(PrincipalManager.SEARCH_TYPE_ALL);
    while (it.hasNext()) {
      Principal p=it.nextPrincipal();
      if (p.equals(principalMgr.getEveryone())) {
        continue;
      }
      if (isGroup(p)) {
        Enumeration<? extends Principal> en=((java.security.acl.Group)p).members();
        while (en.hasMoreElements()) {
          Principal memb=en.nextElement();
          assertTrue(principalMgr.hasPrincipal(memb.getName()));
        }
      }
    }
  }
  finally {
    if (gr != null) {
      gr.remove();
      superuser.save();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.user.AuthorizablePropertyTest </h4><pre class="type-13 type-12 type-7 type-6 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGroupGetProperties() throws RepositoryException, NotExecutableException {
  Node n=getNode(group,superuser);
  for (PropertyIterator it=n.getProperties(); it.hasNext(); ) {
    Property prop=it.nextProperty();
    if (prop.getDefinition().isProtected()) {
      assertFalse(group.hasProperty(prop.getName()));
      assertNull(group.getProperty(prop.getName()));
    }
 else {
      assertTrue(group.hasProperty(prop.getName()));
      assertNotNull(group.getProperty(prop.getName()));
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-12 type-7 type-6 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUserGetProperties() throws RepositoryException, NotExecutableException {
  Node n=getNode(user,superuser);
  for (PropertyIterator it=n.getProperties(); it.hasNext(); ) {
    Property p=it.nextProperty();
    if (p.getDefinition().isProtected()) {
      assertFalse(user.hasProperty(p.getName()));
      assertNull(user.getProperty(p.getName()));
    }
 else {
      assertTrue(user.hasProperty(p.getName()));
      assertNotNull(user.getProperty(p.getName()));
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-9 type-7 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetPropertyNamesByRelPath() throws NotExecutableException, RepositoryException {
  String relPath="testing/Fullname";
  Value v=superuser.getValueFactory().createValue("Super User");
  try {
    user.setProperty(relPath,v);
    superuser.save();
  }
 catch (  RepositoryException e) {
    throw new NotExecutableException("Cannot test 'Authorizable.setProperty'.");
  }
  try {
    for (Iterator<String> it=user.getPropertyNames(); it.hasNext(); ) {
      String name=it.next();
      assertFalse("Fullname".equals(name));
    }
    for (Iterator<String> it=user.getPropertyNames("testing"); it.hasNext(); ) {
      String name=it.next();
      String rp="testing/" + name;
      assertFalse(user.hasProperty(name));
      assertNull(user.getProperty(name));
      assertTrue(user.hasProperty(rp));
      assertNotNull(user.getProperty(rp));
    }
    for (Iterator<String> it=user.getPropertyNames("./testing"); it.hasNext(); ) {
      String name=it.next();
      String rp="testing/" + name;
      assertFalse(user.hasProperty(name));
      assertNull(user.getProperty(name));
      assertTrue(user.hasProperty(rp));
      assertNotNull(user.getProperty(rp));
    }
  }
  finally {
    user.removeProperty(relPath);
    superuser.save();
  }
}

</code></pre>

<br>
<pre class="type-13 type-9 type-7 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetPropertyNames() throws NotExecutableException, RepositoryException {
  String propName="Fullname";
  Value v=superuser.getValueFactory().createValue("Super User");
  try {
    user.setProperty(propName,v);
    superuser.save();
  }
 catch (  RepositoryException e) {
    throw new NotExecutableException("Cannot test 'Authorizable.setProperty'.");
  }
  try {
    for (Iterator<String> it=user.getPropertyNames(); it.hasNext(); ) {
      String name=it.next();
      assertTrue(user.hasProperty(name));
      assertNotNull(user.getProperty(name));
    }
  }
  finally {
    user.removeProperty(propName);
    superuser.save();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.user.EveryoneGroupTest </h4><pre class="type-13 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testMembers() throws RepositoryException, NotExecutableException {
  assertTrue(everyone.isDeclaredMember(getTestUser(superuser)));
  assertTrue(everyone.isMember(getTestUser(superuser)));
  Iterator<Authorizable> it=everyone.getDeclaredMembers();
  assertTrue(it.hasNext());
  Set<Authorizable> members=new HashSet<Authorizable>();
  while (it.hasNext()) {
    members.add(it.next());
  }
  it=everyone.getMembers();
  assertTrue(it.hasNext());
  while (it.hasNext()) {
    assertTrue(members.contains(it.next()));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.user.FindAuthorizablesTest </h4><pre class="type-13 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
"></span><br>
@Test public void testFindAllGroupsDoesNotContainUser() throws RepositoryException {
  Iterator<Authorizable> it=userMgr.findAuthorizables(UserConstants.REP_PRINCIPAL_NAME,null,UserManager.SEARCH_TYPE_GROUP);
  while (it.hasNext()) {
    assertTrue(it.next().isGroup());
  }
}

</code></pre>

<br>
<pre class="type-13 type-12 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testFindUserInAllGroups() throws RepositoryException, NotExecutableException {
  User u=null;
  try {
    Principal p=getTestPrincipal();
    String uid=createUserId();
    u=userMgr.createUser(uid,"pw",p,null);
    superuser.save();
    Iterator<Authorizable> it=userMgr.findAuthorizables(UserConstants.REP_PRINCIPAL_NAME,null,UserManager.SEARCH_TYPE_GROUP);
    while (it.hasNext()) {
      if (it.next().getPrincipal().getName().equals(p.getName())) {
        fail("Searching for Groups should never find a user");
      }
    }
  }
  finally {
    if (u != null) {
      u.remove();
      superuser.save();
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
"></span><br>
@Test public void testFindAllUsersDoesNotContainGroup() throws RepositoryException {
  Iterator<Authorizable> it=userMgr.findAuthorizables(UserConstants.REP_PRINCIPAL_NAME,null,UserManager.SEARCH_TYPE_USER);
  while (it.hasNext()) {
    assertFalse(it.next().isGroup());
  }
}

</code></pre>

<br>
<pre class="type-13 type-12 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testFindGroupInAllUsers() throws RepositoryException, NotExecutableException {
  Group gr=null;
  try {
    Principal p=getTestPrincipal();
    gr=userMgr.createGroup(p);
    superuser.save();
    boolean found=false;
    Iterator<Authorizable> it=userMgr.findAuthorizables(UserConstants.REP_PRINCIPAL_NAME,null,UserManager.SEARCH_TYPE_USER);
    while (it.hasNext()) {
      if (it.next().getPrincipal().getName().equals(p.getName())) {
        fail("Searching for Users should never find a group");
      }
    }
  }
  finally {
    if (gr != null) {
      gr.remove();
      superuser.save();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.user.GroupImportTest </h4><pre class="type-13 type-7 type-6 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @since OAK 1.0 : Importing new rep:MembershipReferences structure
 */
@Test public void testImportGroupMembersFromOakNodes() throws Exception {
  List<String> createdUsers=new LinkedList<String>();
  Session s=getImportSession();
  UserManager uMgr=getUserManager();
  try {
    for (int i=0; i < 32; i++) {
      String user="testUser" + i;
      if (uMgr.getAuthorizable(user) == null) {
        uMgr.createUser(user,user);
        createdUsers.add(user);
      }
    }
    if (!uMgr.isAutoSave()) {
      s.save();
    }
    doImport(getTargetPath(),"GroupImportTest-testImportGroupMembersFromOakNodes.xml");
    if (!uMgr.isAutoSave()) {
      s.save();
    }
    Authorizable authorizable=uMgr.getAuthorizable("testGroup");
    assertNotNull("testGroup authorizable must exist",authorizable);
    assertTrue("testGroup authorizable must be a group",authorizable.isGroup());
    Group testGroup=(Group)authorizable;
    for (int i=0; i < 32; i++) {
      String user="testUser" + i;
      assertTrue(user + " should be member of " + testGroup,testGroup.isMember(uMgr.getAuthorizable(user)));
    }
    authorizable=uMgr.getAuthorizable("shrimps");
    assertNotNull("shrimps authorizable must exist",authorizable);
    assertTrue("shrimps authorizable must be a group",authorizable.isGroup());
    testGroup=(Group)authorizable;
    for (int i=0; i < 32; i++) {
      String user="testUser" + i;
      assertTrue(user + " should be member of " + testGroup,testGroup.isMember(uMgr.getAuthorizable(user)));
    }
  }
  finally {
    for (    String user : createdUsers) {
      Authorizable a=uMgr.getAuthorizable(user);
      if (a != null && !a.isGroup()) {
        a.remove();
      }
    }
    for (NodeIterator it=s.getNode(getTargetPath()).getNodes(); it.hasNext(); ) {
      Node n=it.nextNode();
      if (!n.getDefinition().isProtected()) {
        n.remove();
      }
    }
    s.save();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.user.GroupTest </h4><pre class="type-13 type-9 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testGetMembersAgainstIsMember() throws NotExecutableException, RepositoryException {
  Iterator<Authorizable> it=group.getMembers();
  while (it.hasNext()) {
    Authorizable auth=it.next();
    assertTrue(group.isMember(auth));
  }
}

</code></pre>

<br>
<pre class="type-13 type-9 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testInheritedMembers() throws Exception {
  Set<Authorizable> authorizables=new HashSet<Authorizable>();
  try {
    User testUser=userMgr.createUser(createUserId(),"pw");
    authorizables.add(testUser);
    Group group1=userMgr.createGroup(createGroupId());
    authorizables.add(group1);
    Group group2=userMgr.createGroup(createGroupId());
    authorizables.add(group2);
    Group group3=userMgr.createGroup(createGroupId());
    group1.addMember(testUser);
    group2.addMember(testUser);
    group3.addMember(group1);
    group3.addMember(group2);
    Iterator<Authorizable> members=group3.getMembers();
    while (members.hasNext()) {
      Authorizable a=members.next();
      assertTrue(authorizables.contains(a));
      assertTrue(authorizables.remove(a));
    }
    assertTrue(authorizables.isEmpty());
  }
  finally {
    for (    Authorizable a : authorizables) {
      a.remove();
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetMembers() throws NotExecutableException, RepositoryException {
  Iterator<Authorizable> it=group.getMembers();
  assertNotNull(it);
  while (it.hasNext()) {
    assertTrue(it.next() != null);
  }
}

</code></pre>

<br>
<pre class="type-13 type-9 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testRemoveMembership() throws RepositoryException {
  String grId2=createGroupId();
  Group gr2=null;
  try {
    gr2=userMgr.createGroup(grId2);
    gr2.addMember(user);
    superuser.save();
    Iterator<Group> groups=user.declaredMemberOf();
    while (groups.hasNext()) {
      Group group=groups.next();
      group.removeMember(user);
      superuser.save();
    }
    assertFalse(userMgr.getAuthorizable(group.getID(),Group.class).isDeclaredMember(user));
    assertFalse(userMgr.getAuthorizable(grId2,Group.class).isDeclaredMember(user));
    groups=user.declaredMemberOf();
    while (groups.hasNext()) {
      String id=groups.next().getID();
      assertFalse(group.getID().equals(id));
      assertFalse(grId2.equals(id));
    }
  }
  finally {
    if (gr2 != null) {
      gr2.remove();
      superuser.save();
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-9 type-7 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetDeclaredMembers() throws NotExecutableException, RepositoryException {
  Iterator<Authorizable> it=group.getDeclaredMembers();
  assertNotNull(it);
  while (it.hasNext()) {
    Authorizable a=it.next();
    assertNotNull(a);
    members.remove(a.getID());
  }
  assertTrue(members.isEmpty());
}

</code></pre>

<br>
<pre class="type-13 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
"></span><br>
@Test public void testGetMembersContainsDeclaredMembers() throws NotExecutableException, RepositoryException {
  List<String> l=new ArrayList<String>();
  for (Iterator<Authorizable> it=group.getMembers(); it.hasNext(); ) {
    l.add(it.next().getID());
  }
  for (Iterator<Authorizable> it=group.getDeclaredMembers(); it.hasNext(); ) {
    assertTrue("All declared members must also be part of the Iterator " + "returned upon getMembers()",l.contains(it.next().getID()));
  }
}

</code></pre>

<br>
<pre class="type-13 type-9 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testRemoveMembershipWithDifferentSessions() throws Exception {
  String grId2=createGroupId();
  Group gr2=null;
  Session s2=null;
  Session s3=null;
  try {
    gr2=userMgr.createGroup(grId2);
    gr2.addMember(user);
    superuser.save();
    s2=getHelper().getReadWriteSession();
    Authorizable u2=getUserManager(s2).getAuthorizable(user.getID());
    Iterator<Group> groups=u2.declaredMemberOf();
    while (groups.hasNext()) {
      Group group=groups.next();
      group.removeMember(u2);
    }
    s2.save();
    s3=getHelper().getReadWriteSession();
    Authorizable u3=getUserManager(s3).getAuthorizable(user.getID());
    assertFalse(getUserManager(s3).getAuthorizable(group.getID(),Group.class).isDeclaredMember(u3));
    assertFalse(getUserManager(s3).getAuthorizable(grId2,Group.class).isDeclaredMember(u3));
    groups=u3.declaredMemberOf();
    while (groups.hasNext()) {
      String id=groups.next().getID();
      assertFalse(group.getID().equals(id));
      assertFalse(grId2.equals(id));
    }
  }
  finally {
    if (gr2 != null) {
      gr2.remove();
      superuser.save();
    }
    if (s2 != null) {
      s2.logout();
    }
    if (s3 != null) {
      s3.logout();
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-9 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testGetDeclaredMembersWithMemberRemoved() throws RepositoryException {
  String uid=user.getID();
  user.remove();
  superuser.save();
  user=null;
  Iterator<Authorizable> it=group.getDeclaredMembers();
  while (it.hasNext()) {
    Authorizable a=it.next();
    assertFalse(uid.equals(a.getID()));
  }
}

</code></pre>

<br>
<pre class="type-13 type-9 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testDeeplyNestedGroups() throws NotExecutableException, RepositoryException {
  Set<Group> groups=new HashSet<Group>();
  try {
    User auth=getTestUser(superuser);
    Group topGroup=userMgr.createGroup(createGroupId());
    Group bottomGroup=topGroup;
    for (int k=0; k < 100; k++) {
      Group g=userMgr.createGroup(createGroupId());
      groups.add(g);
      bottomGroup.addMember(g);
      bottomGroup=g;
    }
    bottomGroup.addMember(auth);
    for (    Group g : groups) {
      Iterator<Authorizable> declaredMembers=g.getDeclaredMembers();
      assertTrue(declaredMembers.hasNext());
      declaredMembers.next();
      assertFalse(declaredMembers.hasNext());
    }
    HashSet<Group> allGroups=new HashSet<Group>(groups);
    for (Iterator<Authorizable> it=topGroup.getMembers(); it.hasNext(); ) {
      Authorizable a=it.next();
      assertTrue(a.equals(auth) || allGroups.remove(a));
    }
    assertTrue(allGroups.isEmpty());
  }
  finally {
    for (    Group g : groups) {
      g.remove();
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-9 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testRemoveGroupClearsMembership() throws NotExecutableException, RepositoryException {
  User auth=getTestUser(superuser);
  Group newGroup=null;
  String groupId;
  try {
    newGroup=userMgr.createGroup(createGroupId());
    groupId=newGroup.getID();
    superuser.save();
    assertTrue(newGroup.addMember(auth));
    superuser.save();
    boolean isMember=false;
    Iterator<Group> it=auth.declaredMemberOf();
    while (it.hasNext() && !isMember) {
      isMember=groupId.equals(it.next().getID());
    }
    assertTrue(isMember);
  }
  finally {
    if (newGroup != null) {
      newGroup.remove();
      superuser.save();
    }
  }
  Iterator<Group> it=auth.declaredMemberOf();
  while (it.hasNext()) {
    assertFalse(groupId.equals(it.next().getID()));
  }
  it=auth.memberOf();
  while (it.hasNext()) {
    assertFalse(groupId.equals(it.next().getID()));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.user.UserImportIgnoreTest </h4><pre class="type-13 type-12 type-5 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testImportInvalidImpersonationIgnore() throws Exception {
  List<String> invalid=new ArrayList<String>();
  invalid.add("anybody");
  invalid.add("administrators");
  invalid.add("t");
  for (  String principalName : invalid) {
    String xml="<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n" + "<sv:node sv:name=\"t\" xmlns:mix=\"http://www.jcp.org/jcr/mix/1.0\" xmlns:nt=\"http://www.jcp.org/jcr/nt/1.0\" xmlns:fn_old=\"http://www.w3.org/2004/10/xpath-functions\" xmlns:fn=\"http://www.w3.org/2005/xpath-functions\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:sv=\"http://www.jcp.org/jcr/sv/1.0\" xmlns:rep=\"internal\" xmlns:jcr=\"http://www.jcp.org/jcr/1.0\">" + "   <sv:property sv:name=\"jcr:primaryType\" sv:type=\"Name\"><sv:value>rep:User</sv:value></sv:property>"+ "   <sv:property sv:name=\"jcr:uuid\" sv:type=\"String\"><sv:value>e358efa4-89f5-3062-b10d-d7316b65649e</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:password\" sv:type=\"String\"><sv:value>{sha1}8efd86fb78a56a5145ed7739dcb00c78581c5375</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:principalName\" sv:type=\"String\"><sv:value>t</sv:value></sv:property><sv:property sv:name=\"rep:impersonators\" sv:type=\"String\"><sv:value>" + principalName + "</sv:value></sv:property>"+ "</sv:node>";
    Subject subj=new Subject();
    subj.getPrincipals().add(new PrincipalImpl(principalName));
    try {
      doImport(getTargetPath(),xml);
      Authorizable a=getUserManager().getAuthorizable("t");
      if (!a.isGroup()) {
        Impersonation imp=((User)a).getImpersonation();
        Subject s=new Subject();
        s.getPrincipals().add(new PrincipalImpl(principalName));
        assertFalse(imp.allows(s));
        for (PrincipalIterator it=imp.getImpersonators(); it.hasNext(); ) {
          assertFalse(principalName.equals(it.nextPrincipal().getName()));
        }
      }
 else {
        fail("Importing 't' didn't create a User.");
      }
    }
  finally {
      getImportSession().refresh(false);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.user.UserQueryTest </h4><pre class="type-13 type-9 type-7 type-6 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSortOrderRespectCaseAscendingDoubleValue() throws RepositoryException {
  Iterator<Authorizable> result=userMgr.findAuthorizables(new Query(){
    public <T>void build(    QueryBuilder<T> builder){
      builder.setCondition(builder.exists("profile/@weight"));
      builder.setSortOrder("profile/@weight",QueryBuilder.Direction.ASCENDING,false);
    }
  }
);
  assertTrue(result.hasNext());
  double prev=Double.MIN_VALUE;
  while (result.hasNext()) {
    Authorizable authorizable=result.next();
    Value[] weight=authorizable.getProperty("profile/weight");
    assertNotNull(weight);
    assertEquals(1,weight.length);
    assertTrue(prev <= weight[0].getDouble());
    prev=weight[0].getDouble();
  }
}

</code></pre>

<br>
<pre class="type-13 type-9 type-12 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * @see <a href="https://issues.apache.org/jira/browse/OAK-2266">OAK-2266</a>
 */
@Test public void testSortOrderIgnoreCaseAscending() throws Exception {
  Iterator<Authorizable> result=userMgr.findAuthorizables(new Query(){
    public <T>void build(    QueryBuilder<T> builder){
      builder.setCondition(builder.exists("@continent"));
      builder.setSortOrder("@continent",QueryBuilder.Direction.ASCENDING,true);
    }
  }
);
  Iterator<String> continents=ImmutableList.of("africa","america","australia").iterator();
  String expected=continents.next();
  while (result.hasNext()) {
    Authorizable a=result.next();
    String continent=a.getProperty("continent")[0].getString().toLowerCase();
    if (!continent.equals(expected)) {
      expected=continents.next();
      assertEquals(expected,continent);
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-19 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOffset() throws RepositoryException {
  long[] offsets={2,0,3,0,100000};
  long[] counts={4,4,0,100000,100000};
  for (int k=0; k < offsets.length; k++) {
    final long offset=offsets[k];
    final long count=counts[k];
    Iterator<Authorizable> result=userMgr.findAuthorizables(new Query(){
      public <T>void build(      QueryBuilder<T> builder){
        builder.setSortOrder("profile/@weight",QueryBuilder.Direction.ASCENDING);
        builder.setLimit(offset,count);
      }
    }
);
    Iterator<Authorizable> expected=userMgr.findAuthorizables(new Query(){
      public <T>void build(      QueryBuilder<T> builder){
        builder.setSortOrder("profile/@weight",QueryBuilder.Direction.ASCENDING);
      }
    }
);
    skip(expected,offset);
    assertSame(expected,result,count);
    assertFalse(result.hasNext());
  }
}

</code></pre>

<br>
<pre class="type-13 type-9 type-12 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * @see <a href="https://issues.apache.org/jira/browse/OAK-2266">OAK-2266</a>
 */
@Test() public void testSortOrderRespectCaseAscending() throws Exception {
  Iterator<Authorizable> result=userMgr.findAuthorizables(new Query(){
    public <T>void build(    QueryBuilder<T> builder){
      builder.setCondition(builder.exists("@continent"));
      builder.setSortOrder("@continent",QueryBuilder.Direction.ASCENDING,false);
    }
  }
);
  Iterator<String> continents=ImmutableList.of("Africa","America","africa","australia").iterator();
  String expected=continents.next();
  while (result.hasNext()) {
    Authorizable a=result.next();
    String continent=a.getProperty("continent")[0].getString();
    if (!continent.equals(expected)) {
      expected=continents.next();
      assertEquals(expected,continent);
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-9 type-7 type-6 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSortOrderIgnoreCaseDescending() throws RepositoryException {
  Iterator<Authorizable> result=userMgr.findAuthorizables(new Query(){
    public <T>void build(    QueryBuilder<T> builder){
      builder.setCondition(builder.exists("@color"));
      builder.setSortOrder("@color",QueryBuilder.Direction.DESCENDING,true);
    }
  }
);
  assertTrue(result.hasNext());
  String prev=null;
  while (result.hasNext()) {
    Authorizable authorizable=result.next();
    Value[] color=authorizable.getProperty("color");
    assertNotNull(color);
    assertEquals(1,color.length);
    assertTrue(prev == null || prev.compareToIgnoreCase(color[0].getString()) >= 0);
    prev=color[0].getString();
  }
}

</code></pre>

<br>
<pre class="type-13 type-9 type-7 type-6 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSortOrderRespectCaseDescending() throws RepositoryException {
  Iterator<Authorizable> result=userMgr.findAuthorizables(new Query(){
    public <T>void build(    QueryBuilder<T> builder){
      builder.setCondition(builder.exists("@color"));
      builder.setSortOrder("@color",QueryBuilder.Direction.DESCENDING,false);
    }
  }
);
  assertTrue(result.hasNext());
  String prev=null;
  while (result.hasNext()) {
    Authorizable authorizable=result.next();
    Value[] color=authorizable.getProperty("color");
    assertNotNull(color);
    assertEquals(1,color.length);
    assertTrue(prev == null || prev.compareTo(color[0].getString()) >= 0);
    prev=color[0].getString();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.BasicDocumentStoreTest </h4><pre class="type-13 type-12 type-5 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreatePartialFailure(){
  String bid=this.getClass().getName() + ".testCreatePartialFailure-";
  int cnt=10;
  assertTrue(cnt > 8);
  for (int i=0; i < cnt; i++) {
    super.ds.remove(Collection.NODES,bid + i);
    removeMe.add(bid + i);
  }
  int pre=cnt / 2;
  UpdateOp up=new UpdateOp(bid + pre,true);
  up.set("_id",bid + pre);
  up.set("foo","bar");
  assertTrue(super.ds.create(Collection.NODES,Collections.singletonList(up)));
  Set<String> toCreate=new HashSet<String>();
  Set<String> toCreateFailEarly=new HashSet<String>();
  List<UpdateOp> ups=new ArrayList<UpdateOp>();
  for (int i=0; i < cnt; i++) {
    UpdateOp op=new UpdateOp(bid + i,true);
    op.set("_id",bid + i);
    op.set("foo","qux");
    ups.add(op);
    if (i != pre) {
      toCreate.add(bid + i);
    }
    if (i < pre) {
      toCreateFailEarly.add(bid + i);
    }
  }
  assertFalse(super.ds.create(Collection.NODES,ups));
  Set<String> created=new HashSet<String>();
  for (int i=0; i < cnt; i++) {
    boolean present=null != super.ds.find(Collection.NODES,bid + i,0);
    if (i == pre && !present) {
      fail(super.dsname + ": batch update removed previously existing node " + (bid + i));
    }
 else     if (present && i != pre) {
      created.add(bid + i);
    }
  }
  toCreate.removeAll(created);
  if (created.isEmpty()) {
    LOG.info(super.dsname + ": create() apparently is atomic");
  }
 else   if (created.size() == toCreate.size()) {
    LOG.info(super.dsname + ": create() apparently is best-effort");
  }
 else   if (created.equals(toCreateFailEarly)) {
    LOG.info(super.dsname + ": create() stops at first failure");
  }
 else {
    LOG.info(super.dsname + ": create() created: " + created+ ", missing: "+ toCreate);
  }
}

</code></pre>

<br>
<pre class="type-13 type-9 type-12 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies whether objects are null
"></span><br>
@Test public void testMaxProperty(){
  int min=0;
  int max=1024 * 1024 * 8;
  int test=0;
  int last=0;
  while (max - min >= 256) {
    if (test == 0) {
      test=max;
    }
 else {
      test=(max + min) / 2;
    }
    String id=this.getClass().getName() + ".testMaxProperty-" + test;
    String pval=generateString(test,true);
    UpdateOp up=new UpdateOp(id,true);
    up.set("_id",id);
    up.set("foo",pval);
    boolean success=super.ds.create(Collection.NODES,Collections.singletonList(up));
    if (success) {
      NodeDocument findme=super.ds.find(Collection.NODES,id,0);
      assertNotNull("failed to retrieve previously stored document",findme);
      super.ds.remove(Collection.NODES,id);
      min=test;
      last=test;
    }
 else {
      max=test;
    }
  }
  LOG.info("max prop length for " + super.dsname + " was "+ last);
}

</code></pre>

<br>
<pre class="type-13 type-9 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testQuery(){
  String base=this.getClass().getName() + ".testQuery-";
  for (int i=0; i < 10; i++) {
    String id=base + i;
    UpdateOp up=new UpdateOp(id,true);
    up.set("_id",id);
    boolean success=super.ds.create(Collection.NODES,Collections.singletonList(up));
    assertTrue("document with " + id + " not created",success);
    removeMe.add(id);
  }
  List<String> result=getKeys(ds.query(Collection.NODES,base,base + "A",5));
  assertEquals(5,result.size());
  assertTrue(result.contains(base + "4"));
  assertFalse(result.contains(base + "5"));
  result=getKeys(ds.query(Collection.NODES,base,base + "A",20));
  assertEquals(10,result.size());
  assertTrue(result.contains(base + "0"));
  assertTrue(result.contains(base + "9"));
}

</code></pre>

<br>
<pre class="type-13 type-9 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testQueryBinary(){
  String base=this.getClass().getName() + ".testQueryBinary-";
  for (int i=0; i < 10; i++) {
    String id=base + i;
    UpdateOp up=new UpdateOp(id,true);
    up.set("_id",id);
    up.set(NodeDocument.HAS_BINARY_FLAG,i % 2L);
    boolean success=super.ds.create(Collection.NODES,Collections.singletonList(up));
    assertTrue("document with " + id + " not created",success);
    removeMe.add(id);
  }
  List<String> result=getKeys(ds.query(Collection.NODES,base,base + "Z",NodeDocument.HAS_BINARY_FLAG,NodeDocument.HAS_BINARY_VAL,1000));
  assertEquals(5,result.size());
  assertTrue(result.contains(base + "1"));
  assertFalse(result.contains(base + "0"));
}

</code></pre>

<br>
<pre class="type-13 type-9 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testQueryDeletedOnce(){
  String base=this.getClass().getName() + ".testQueryDeletedOnce-";
  for (int i=0; i < 10; i++) {
    String id=base + i;
    UpdateOp up=new UpdateOp(id,true);
    up.set("_id",id);
    up.set(NodeDocument.DELETED_ONCE,Boolean.valueOf(i % 2 == 0));
    boolean success=super.ds.create(Collection.NODES,Collections.singletonList(up));
    assertTrue("document with " + id + " not created",success);
    removeMe.add(id);
  }
  List<String> result=getKeys(ds.query(Collection.NODES,base,base + "Z",NodeDocument.DELETED_ONCE,1L,1000));
  assertEquals(5,result.size());
  assertTrue(result.contains(base + "0"));
  assertFalse(result.contains(base + "1"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.BulkCreateOrUpdateClusterTest </h4><pre class="type-13 type-9 type-12 type-5 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Run multiple batch updates concurrently. Each thread modifies only its own documents.
 */
@Test public void testConcurrentNoConflict() throws InterruptedException {
  int amountPerThread=100;
  int threadCount=10;
  int amount=amountPerThread * threadCount;
  List<UpdateOp> updates=new ArrayList<UpdateOp>(amount);
  for (int i=0; i < amount; i+=2) {
    String id=this.getClass().getName() + ".testConcurrentNoConflict" + i;
    UpdateOp up=new UpdateOp(id,true);
    up.set("_id",id);
    up.set("prop",100);
    updates.add(up);
  }
  ds1.create(Collection.NODES,updates);
  final Set<Exception> exceptions=new HashSet<Exception>();
  List<Thread> threads=new ArrayList<Thread>();
  final Map<String,NodeDocument> oldDocs=new ConcurrentHashMap<String,NodeDocument>();
  for (int i=0; i < threadCount; i++) {
    final DocumentStore selectedDs=i % 2 == 0 ? this.ds1 : this.ds2;
    final List<UpdateOp> threadUpdates=new ArrayList<UpdateOp>(amountPerThread);
    for (int j=0; j < amountPerThread; j++) {
      String id=this.getClass().getName() + ".testConcurrentNoConflict" + (j + i * amountPerThread);
      UpdateOp up=new UpdateOp(id,true);
      up.set("_id",id);
      up.set("prop",200 + i + j);
      threadUpdates.add(up);
      removeMe.add(id);
    }
    shuffle(threadUpdates);
    threads.add(new Thread(){
      public void run(){
        try {
          for (          NodeDocument d : selectedDs.createOrUpdate(Collection.NODES,threadUpdates)) {
            if (d == null) {
              continue;
            }
            oldDocs.put(d.getId(),d);
          }
        }
 catch (        Exception ex) {
          exceptions.add(ex);
        }
      }
    }
);
  }
  for (  Thread t : threads) {
    t.start();
  }
  for (  Thread t : threads) {
    t.join();
    if (t.isAlive()) {
      fail("Thread hasn't finished in 10s");
    }
  }
  if (!exceptions.isEmpty()) {
    String msg=exceptions.size() + " out of " + threadCount+ " failed with exceptions, the first being: "+ exceptions.iterator().next();
    fail(msg);
  }
  for (int i=0; i < amount; i++) {
    String id=this.getClass().getName() + ".testConcurrentNoConflict" + i;
    NodeDocument oldDoc=oldDocs.get(id);
    NodeDocument newDoc;
    if (i % 2 == 1) {
      assertNull("The returned value should be null for created doc",oldDoc);
      newDoc=ds1.find(Collection.NODES,id);
    }
 else {
      assertNotNull("The returned doc shouldn't be null for updated doc",oldDoc);
      assertEquals("The old value is not correct",100l,oldDoc.get("prop"));
      newDoc=ds2.find(Collection.NODES,id);
    }
    assertNotEquals("The document hasn't been updated",100l,newDoc.get("prop"));
  }
}

</code></pre>

<br>
<pre class="type-13 type-9 type-12 type-5 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Run multiple batch updates concurrently. Each thread modifies the same set of documents.
 */
@Test public void testConcurrentWithConflict() throws InterruptedException {
  int threadCount=10;
  int amount=500;
  List<UpdateOp> updates=new ArrayList<UpdateOp>(amount);
  for (int i=0; i < amount; i+=2) {
    String id=this.getClass().getName() + ".testConcurrentNoConflict" + i;
    UpdateOp up=new UpdateOp(id,true);
    up.set("_id",id);
    up.set("prop",100);
    updates.add(up);
    removeMe.add(id);
  }
  ds1.create(Collection.NODES,updates);
  final Set<Exception> exceptions=new HashSet<Exception>();
  List<Thread> threads=new ArrayList<Thread>();
  for (int i=0; i < threadCount; i++) {
    final DocumentStore selectedDs=i % 2 == 0 ? this.ds1 : this.ds2;
    final List<UpdateOp> threadUpdates=new ArrayList<UpdateOp>(amount);
    for (int j=0; j < amount; j++) {
      String id=this.getClass().getName() + ".testConcurrentWithConflict" + j;
      UpdateOp up=new UpdateOp(id,true);
      up.set("_id",id);
      up.set("prop",200 + i * amount + j);
      threadUpdates.add(up);
      removeMe.add(id);
    }
    shuffle(threadUpdates);
    threads.add(new Thread(){
      public void run(){
        try {
          selectedDs.createOrUpdate(Collection.NODES,threadUpdates);
        }
 catch (        Exception ex) {
          exceptions.add(ex);
        }
      }
    }
);
  }
  for (  Thread t : threads) {
    t.start();
  }
  for (  Thread t : threads) {
    t.join(10000);
    if (t.isAlive()) {
      fail("Thread hasn't finished in 10s");
    }
  }
  if (!exceptions.isEmpty()) {
    String msg=exceptions.size() + " out of " + threadCount+ " failed with exceptions, the first being: "+ exceptions.iterator().next();
    fail(msg);
  }
  for (int i=0; i < amount; i++) {
    String id=this.getClass().getName() + ".testConcurrentWithConflict" + i;
    NodeDocument newDoc=ds1.find(Collection.NODES,id);
    assertNotNull("The document hasn't been inserted",newDoc);
    assertNotEquals("The document hasn't been updated",100l,newDoc.get("prop"));
    newDoc=ds2.find(Collection.NODES,id);
    assertNotNull("The document hasn't been inserted",newDoc);
    assertNotEquals("The document hasn't been updated",100l,newDoc.get("prop"));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.BulkCreateOrUpdateTest </h4><pre class="type-13 type-9 type-12 type-5 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Run multiple batch updates concurrently. Each thread modifies only its own documents.
 */
@Test public void testConcurrentNoConflict() throws InterruptedException {
  int amountPerThread=100;
  int threadCount=10;
  int amount=amountPerThread * threadCount;
  List<UpdateOp> updates=new ArrayList<UpdateOp>(amount);
  for (int i=0; i < amount; i+=2) {
    String id=this.getClass().getName() + ".testConcurrentNoConflict" + i;
    UpdateOp up=new UpdateOp(id,true);
    up.set("_id",id);
    up.set("prop",100);
    updates.add(up);
  }
  ds.create(Collection.NODES,updates);
  List<Thread> threads=new ArrayList<Thread>();
  final Map<String,NodeDocument> oldDocs=new ConcurrentHashMap<String,NodeDocument>();
  for (int i=0; i < threadCount; i++) {
    final List<UpdateOp> threadUpdates=new ArrayList<UpdateOp>(amountPerThread);
    for (int j=0; j < amountPerThread; j++) {
      String id=this.getClass().getName() + ".testConcurrentNoConflict" + (j + i * amountPerThread);
      UpdateOp up=new UpdateOp(id,true);
      up.set("_id",id);
      up.set("prop",200 + i + j);
      threadUpdates.add(up);
      removeMe.add(id);
    }
    shuffle(threadUpdates);
    threads.add(new Thread(){
      public void run(){
        for (        NodeDocument d : ds.createOrUpdate(Collection.NODES,threadUpdates)) {
          if (d == null) {
            continue;
          }
          oldDocs.put(d.getId(),d);
        }
      }
    }
);
  }
  for (  Thread t : threads) {
    t.start();
  }
  for (  Thread t : threads) {
    t.join();
    if (t.isAlive()) {
      fail("Thread hasn't finished in 10s");
    }
  }
  for (int i=0; i < amount; i++) {
    String id=this.getClass().getName() + ".testConcurrentNoConflict" + i;
    NodeDocument oldDoc=oldDocs.get(id);
    NodeDocument newDoc=ds.find(Collection.NODES,id);
    if (i % 2 == 1) {
      assertNull("The returned value should be null for created doc",oldDoc);
    }
 else {
      assertNotNull("The returned doc shouldn't be null for updated doc",oldDoc);
      assertEquals("The old value is not correct",100l,oldDoc.get("prop"));
    }
    assertNotEquals("The document hasn't been updated",100l,newDoc.get("prop"));
  }
}

</code></pre>

<br>
<pre class="type-13 type-9 type-12 type-5 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Run multiple batch updates concurrently. Each thread modifies the same set of documents.
 */
@Test public void testConcurrentWithConflict() throws InterruptedException {
  int threadCount=10;
  int amount=500;
  List<UpdateOp> updates=new ArrayList<UpdateOp>(amount);
  for (int i=0; i < amount; i+=2) {
    String id=this.getClass().getName() + ".testConcurrentNoConflict" + i;
    UpdateOp up=new UpdateOp(id,true);
    up.set("_id",id);
    up.set("prop",100);
    updates.add(up);
    removeMe.add(id);
  }
  ds.create(Collection.NODES,updates);
  final Set<Exception> exceptions=new HashSet<Exception>();
  List<Thread> threads=new ArrayList<Thread>();
  for (int i=0; i < threadCount; i++) {
    final List<UpdateOp> threadUpdates=new ArrayList<UpdateOp>(amount);
    for (int j=0; j < amount; j++) {
      String id=this.getClass().getName() + ".testConcurrentWithConflict" + j;
      UpdateOp up=new UpdateOp(id,true);
      up.set("_id",id);
      up.set("prop",200 + i * amount + j);
      threadUpdates.add(up);
      removeMe.add(id);
    }
    shuffle(threadUpdates);
    threads.add(new Thread(){
      public void run(){
        try {
          ds.createOrUpdate(Collection.NODES,threadUpdates);
        }
 catch (        Exception ex) {
          exceptions.add(ex);
        }
      }
    }
);
  }
  for (  Thread t : threads) {
    t.start();
  }
  for (  Thread t : threads) {
    t.join(10000);
    if (t.isAlive()) {
      fail("Thread hasn't finished in 10s");
    }
  }
  if (!exceptions.isEmpty()) {
    String msg=exceptions.size() + " out of " + threadCount+ " failed with exceptions, the first being: "+ exceptions.iterator().next();
    fail(msg);
  }
  for (int i=0; i < amount; i++) {
    String id=this.getClass().getName() + ".testConcurrentWithConflict" + i;
    NodeDocument newDoc=ds.find(Collection.NODES,id);
    assertNotNull("The document hasn't been inserted",newDoc);
    assertNotEquals("The document hasn't been updated",100l,newDoc.get("prop"));
  }
}

</code></pre>

<br>
<pre class="type-13 type-9 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * This method updates multiple items using createOrUpdate() method. The
 * return value should be a list of items before the update.
 */
@Test public void testUpdateMultiple(){
  final int amount=100;
  List<UpdateOp> updates=new ArrayList<UpdateOp>(amount);
  for (int i=0; i < amount; i++) {
    String id=this.getClass().getName() + ".testUpdateMultiple" + i;
    UpdateOp up=new UpdateOp(id,true);
    up.set("_id",id);
    up.set("prop",100);
    updates.add(up);
    removeMe.add(id);
  }
  ds.create(Collection.NODES,updates);
  for (int i=0; i < amount; i++) {
    UpdateOp up=updates.get(i).copy();
    up.set("prop",200);
    updates.set(i,up);
  }
  List<NodeDocument> docs=ds.createOrUpdate(Collection.NODES,updates);
  assertEquals(amount,docs.size());
  for (int i=0; i < amount; i++) {
    NodeDocument oldDoc=docs.get(i);
    String id=oldDoc.getId();
    NodeDocument newDoc=ds.find(Collection.NODES,id);
    assertEquals("The result list order is incorrect",updates.get(i).getId(),id);
    assertEquals("The old value is not correct",100l,oldDoc.get("prop"));
    assertEquals("The document hasn't been updated",200l,newDoc.get("prop"));
  }
}

</code></pre>

<br>
<pre class="type-13 type-9 type-12 type-6 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This method creates or updates multiple items using createOrUpdate()
 * method. New items have odd indexes and updates items have even indexes.
 * The return value should be a list of old documents (for the updates) or
 * nulls (for the inserts).
 */
@Test public void testCreateOrUpdateMultiple(){
  int amount=100;
  List<UpdateOp> updates=new ArrayList<UpdateOp>(amount);
  for (int i=0; i < amount; i+=2) {
    String id=this.getClass().getName() + ".testCreateOrUpdateMultiple" + i;
    UpdateOp up=new UpdateOp(id,true);
    up.set("_id",id);
    up.set("prop",100);
    updates.add(up);
    removeMe.add(id);
  }
  ds.create(Collection.NODES,updates);
  updates.clear();
  for (int i=0; i < amount; i++) {
    String id=this.getClass().getName() + ".testCreateOrUpdateMultiple" + i;
    UpdateOp up=new UpdateOp(id,true);
    up.set("_id",id);
    up.set("prop",200);
    updates.add(up);
    removeMe.add(id);
  }
  List<NodeDocument> docs=ds.createOrUpdate(Collection.NODES,updates);
  assertEquals(amount,docs.size());
  for (int i=0; i < amount; i++) {
    String id=this.getClass().getName() + ".testCreateOrUpdateMultiple" + i;
    NodeDocument oldDoc=docs.get(i);
    NodeDocument newDoc=ds.find(Collection.NODES,id);
    if (i % 2 == 1) {
      assertNull("The returned value should be null for created doc",oldDoc);
    }
 else {
      assertNotNull("The returned doc shouldn't be null for updated doc",oldDoc);
      assertEquals("The old value is not correct",100l,oldDoc.get("prop"));
      assertEquals("The result list order is incorrect",updates.get(i).getId(),oldDoc.getId());
    }
    assertEquals("The document hasn't been updated",200l,newDoc.get("prop"));
  }
}

</code></pre>

<br>
<pre class="type-13 type-9 type-12 type-7 type-6 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This method adds a few updateOperations modifying the same document.
 */
@Test public void testUpdateSameDocument(){
  final int amount=5;
  List<UpdateOp> updates=new ArrayList<UpdateOp>(amount);
  String id=this.getClass().getName() + ".testUpdateSameDocument";
  removeMe.add(id);
  for (int i=0; i < amount; i++) {
    UpdateOp up=new UpdateOp(id,true);
    up.set("_id",id);
    up.set("update_id",i);
    up.set("prop_" + i,100);
    updates.add(up);
  }
  List<NodeDocument> docs=ds.createOrUpdate(Collection.NODES,updates);
  assertEquals(amount,docs.size());
  assertNull("The old value should be null for the first update",docs.get(0));
  Long prevModCount=null;
  for (int i=1; i < amount; i++) {
    Long modCount=docs.get(i).getModCount();
    if (prevModCount != null) {
      assertNotNull(modCount);
      assertTrue("_modCount, when present, must be increasing, but changed from " + prevModCount + " to "+ modCount,prevModCount.longValue() < modCount.longValue());
    }
    prevModCount=modCount;
    assertEquals("The old value is not correct",Long.valueOf(i - 1),docs.get(i).get("update_id"));
  }
  NodeDocument newDoc=ds.find(Collection.NODES,id);
  if (newDoc.getModCount() != null) {
    assertEquals("The final mod count is not correct",Long.valueOf(5),newDoc.getModCount());
  }
  for (int i=0; i < amount; i++) {
    assertEquals("The value is not correct",100l,newDoc.get("prop_" + i));
  }
}

</code></pre>

<br>
<pre class="type-13 type-9 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This tests create multiple items using createOrUpdate() method. The
 * return value should be a list of null values.
 */
@Test public void testCreateMultiple(){
  final int amount=100;
  List<UpdateOp> updates=new ArrayList<UpdateOp>(amount);
  for (int i=0; i < amount; i++) {
    String id=this.getClass().getName() + ".testCreateMultiple" + i;
    UpdateOp up=new UpdateOp(id,true);
    up.set("_id",id);
    updates.add(up);
    removeMe.add(id);
  }
  List<NodeDocument> docs=ds.createOrUpdate(Collection.NODES,updates);
  assertEquals(amount,docs.size());
  for (int i=0; i < amount; i++) {
    assertNull("There shouldn't be a value for created doc",docs.get(i));
    assertNotNull("The node hasn't been created",ds.find(Collection.NODES,updates.get(i).getId()));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.ClusterViewDocumentTest </h4><pre class="type-13 type-9 type-12 type-7 type-6 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHistory() throws Exception {
  final int localClusterId=1;
  final DocumentNodeStore ns=createMK(localClusterId).nodeStore;
  final Set<Integer> activeIds=new HashSet<Integer>();
  activeIds.add(localClusterId);
  ClusterViewDocument.readOrUpdate(ns,activeIds,null,null);
  final int LOOP_CNT=100;
  for (int i=0; i < LOOP_CNT; i++) {
    activeIds.add(i + 2);
    ClusterViewDocument result=ClusterViewDocument.readOrUpdate(ns,activeIds,null,null);
    assertNotNull(result);
    assertEquals(i + 2,result.getActiveIds().size());
    if (i < 10) {
      assertEquals(i + 1,result.getHistory().size());
    }
 else {
      assertTrue(result.getHistory().size() <= ClusterViewDocument.HISTORY_LIMIT);
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSetToCsv() throws Throwable {
  assertNull(callSetToCsv(null));
  assertNull(callSetToCsv(new HashSet<Integer>()));
  Set<Integer> input=new TreeSet<Integer>();
  StringBuffer sb=new StringBuffer();
  for (int i=100; i < 199; i++) {
    input.add(i);
    if (sb.length() != 0) {
      sb.append(",");
    }
    sb.append(String.valueOf(i));
    assertEquals(sb.toString(),callSetToCsv(input));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.DocumentDiscoveryLiteServiceTest </h4><pre class="type-13 type-9 type-12 type-5 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This test creates a large number of documentnodestores which it starts,
 * runs, stops in a random fashion, always testing to make sure the
 * clusterView is correct
 */
@Test public void testLargeStartStopFiesta() throws Throwable {
  logger.info("testLargeStartStopFiesta: start, seed=" + SEED);
  final List<SimplifiedInstance> instances=new LinkedList<SimplifiedInstance>();
  final Map<Integer,String> inactiveIds=new HashMap<Integer,String>();
  final Random random=new Random(SEED);
  final int LOOP_CNT=50;
  final int CHECK_EVERY=3;
  final int MAX_NUM_INSTANCES=8;
  for (int i=0; i < LOOP_CNT; i++) {
    if (i % CHECK_EVERY == 0) {
      checkFiestaState(instances,inactiveIds.keySet());
    }
    final int nextInt=random.nextInt(5);
    String workingDir=UUID.randomUUID().toString();
switch (nextInt) {
case 0:
{
        if (inactiveIds.size() > 0) {
          logger.info("Case 0 - reactivating an instance...");
          final int n=random.nextInt(inactiveIds.size());
          final Integer cid=new LinkedList<Integer>(inactiveIds.keySet()).get(n);
          final String reactivatedWorkingDir=inactiveIds.remove(cid);
          if (reactivatedWorkingDir == null) {
            fail("reactivatedWorkingDir null for n=" + n + ", cid="+ cid+ ", other inactives: "+ inactiveIds);
          }
          assertNotNull(reactivatedWorkingDir);
          logger.info("Case 0 - reactivated instance " + cid + ", workingDir="+ reactivatedWorkingDir);
          workingDir=reactivatedWorkingDir;
          logger.info("Case 0: creating instance");
          final SimplifiedInstance newInstance=createInstance(workingDir);
          if (newInstance.hasRandomMachineId()) {
            return;
          }
          newInstance.setLeastTimeout(5000,1000);
          newInstance.startSimulatingWrites(500);
          logger.info("Case 0: created instance: " + newInstance.ns.getClusterId());
          if (newInstance.ns.getClusterId() != cid) {
            logger.info("Case 0: reactivated instance did not take over cid - probably a testing artifact. expected cid: {}, actual cid: {}",cid,newInstance.ns.getClusterId());
            inactiveIds.put(cid,reactivatedWorkingDir);
            inactiveIds.remove(newInstance.ns.getClusterId());
          }
          instances.add(newInstance);
        }
        break;
      }
case 1:
{
      if (instances.size() < MAX_NUM_INSTANCES) {
        logger.info("Case 1: creating instance");
        final SimplifiedInstance newInstance=createInstance(workingDir);
        if (newInstance.hasRandomMachineId()) {
          return;
        }
        newInstance.setLeastTimeout(5000,1000);
        newInstance.startSimulatingWrites(500);
        logger.info("Case 1: created instance: " + newInstance.ns.getClusterId());
        instances.add(newInstance);
        inactiveIds.remove(newInstance.ns.getClusterId());
      }
      break;
    }
case 2:
{
    break;
  }
case 3:
{
  if (instances.size() > 1) {
    checkFiestaState(instances,inactiveIds.keySet());
    final SimplifiedInstance instance=instances.remove(random.nextInt(instances.size()));
    assertNotNull(instance.workingDir);
    logger.info("Case 3: Shutdown instance: " + instance.ns.getClusterId());
    inactiveIds.put(instance.ns.getClusterId(),instance.workingDir);
    instance.shutdown();
  }
  break;
}
case 4:
{
if (instances.size() > 1) {
  checkFiestaState(instances,inactiveIds.keySet());
  final SimplifiedInstance instance=instances.remove(random.nextInt(instances.size()));
  assertNotNull(instance.workingDir);
  logger.info("Case 4: Crashing instance: " + instance.ns.getClusterId());
  inactiveIds.put(instance.ns.getClusterId(),instance.workingDir);
  instance.addNode("/" + instance.ns.getClusterId() + "/stuffForRecovery/"+ random.nextInt(10000));
  instance.crash();
}
break;
}
}
}
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.DocumentNodeStoreTest </h4><pre class="type-13 type-9 type-6 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void ignoreUncommitted() throws Exception {
  final AtomicLong numPreviousFinds=new AtomicLong();
  MemoryDocumentStore store=new MemoryDocumentStore(){
    @Override public <T extends Document>T find(    Collection<T> collection,    String key){
      if (Utils.getPathFromId(key).startsWith("p")) {
        numPreviousFinds.incrementAndGet();
      }
      return super.find(collection,key);
    }
  }
;
  DocumentNodeStore ns=builderProvider.newBuilder().setDocumentStore(store).setAsyncDelay(0).getNodeStore();
  String id=Utils.getIdFromPath("/test");
  NodeBuilder b=ns.getRoot().builder();
  b.child("test").setProperty("p","a");
  merge(ns,b);
  NodeDocument doc;
  int i=0;
  do {
    b=ns.getRoot().builder();
    b.child("test").setProperty("q",i++);
    merge(ns,b);
    doc=store.find(NODES,id);
    assertNotNull(doc);
    if (i % 100 == 0) {
      ns.runBackgroundOperations();
    }
  }
 while (doc.getPreviousRanges().isEmpty());
  Revision r=ns.newRevision();
  UpdateOp op=new UpdateOp(id,false);
  NodeDocument.setCommitRoot(op,r,0);
  op.setMapEntry("p",r,"b");
  assertNotNull(store.findAndUpdate(NODES,op));
  doc=store.find(NODES,id);
  numPreviousFinds.set(0);
  doc.getNodeAtRevision(ns,ns.getHeadRevision(),null);
  assertEquals(0,numPreviousFinds.get());
}

</code></pre>

<br>
<pre class="type-13 type-5 type-7 type-6 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void commitHookChangesOnBranch() throws Exception {
  final int NUM_NODES=DocumentRootBuilder.UPDATE_LIMIT / 2;
  final int NUM_PROPS=10;
  DocumentNodeStore ns=builderProvider.newBuilder().getNodeStore();
  NodeBuilder builder=ns.getRoot().builder();
  for (int i=0; i < NUM_NODES; i++) {
    NodeBuilder c=builder.child("n" + i);
    for (int j=0; j < NUM_PROPS; j++) {
      c.setProperty("q" + j,"value");
      c.setProperty("p" + j,"value");
    }
  }
  try {
    ns.merge(builder,CompositeHook.compose(Arrays.asList(new TestHook("p"),new TestHook("q"),FAILING_HOOK)),CommitInfo.EMPTY);
    fail("merge must fail and reset changes done by commit hooks");
  }
 catch (  CommitFailedException e) {
  }
  for (int i=0; i < NUM_NODES; i++) {
    NodeBuilder c=builder.getChildNode("n" + i);
    assertTrue(c.exists());
    for (int j=0; j < NUM_PROPS; j++) {
      PropertyState p=c.getProperty("p" + j);
      assertNotNull(p);
      assertEquals("value",p.getValue(Type.STRING));
      p=c.getProperty("q" + j);
      assertNotNull(p);
      assertEquals("value",p.getValue(Type.STRING));
    }
  }
  ns.merge(builder,CompositeHook.compose(Arrays.<CommitHook>asList(new TestHook("p"),new TestHook("q"))),CommitInfo.EMPTY);
  builder=ns.getRoot().builder();
  for (int i=0; i < NUM_NODES; i++) {
    NodeBuilder c=builder.getChildNode("n" + i);
    assertTrue(c.exists());
    for (int j=0; j < NUM_PROPS; j++) {
      PropertyState p=c.getProperty("p" + j);
      assertNotNull(p);
      assertEquals("test",p.getValue(Type.STRING));
      p=c.getProperty("q" + j);
      assertNotNull(p);
      assertEquals("test",p.getValue(Type.STRING));
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
"></span><br>
@Test public void resolveMultipleConflictedRevisions() throws Exception {
  MemoryDocumentStore store=new MemoryDocumentStore();
  final DocumentNodeStore ds=builderProvider.newBuilder().setDocumentStore(store).setAsyncDelay(0).getNodeStore();
  DocumentNodeState root=ds.getRoot();
  final DocumentNodeStoreBranch b=ds.createBranch(root);
  NodeBuilder builder=root.builder();
  builder.child("foo");
  b.setRoot(builder.getNodeState());
  final Set<Revision> revisions=new HashSet<Revision>();
  final List<Commit> commits=new ArrayList<Commit>();
  for (int i=0; i < 10; i++) {
    Revision revision=ds.newRevision();
    Commit commit=ds.newCommit(new RevisionVector(revision),ds.createBranch(root));
    commits.add(commit);
    revisions.add(revision);
  }
  final AtomicBoolean merged=new AtomicBoolean();
  Thread t=new Thread(new Runnable(){
    public void run(){
      try {
        CommitFailedException exception=new ConflictException("Can't merge",revisions).asCommitFailedException();
        b.merge(new HookFailingOnce(exception),CommitInfo.EMPTY);
        merged.set(true);
      }
 catch (      CommitFailedException e) {
        LOG.error("Can't commit",e);
      }
    }
  }
);
  t.start();
  for (int i=0; i < 6; i++) {
    assertFalse("The branch can't be merged yet",merged.get());
    ds.done(commits.get(i),false,CommitInfo.EMPTY);
  }
  for (int i=6; i < 8; i++) {
    assertFalse("The branch can't be merged yet",merged.get());
    ds.canceled(commits.get(i));
  }
  for (int i=8; i < 10; i++) {
    assertFalse("The branch can't be merged yet",merged.get());
    ds.done(commits.get(i),true,CommitInfo.EMPTY);
  }
  for (int i=0; i < 100; i++) {
    if (merged.get()) {
      break;
    }
    Thread.sleep(10);
  }
  assertTrue("The branch should be merged by now",merged.get());
  t.join();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.DocumentSplitTest </h4><pre class="type-13 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void removeGarbage() throws Exception {
  final DocumentStore store=mk.getDocumentStore();
  final DocumentNodeStore ns=mk.getNodeStore();
  final List<Exception> exceptions=Lists.newArrayList();
  final List<RevisionVector> revisions=Lists.newArrayList();
  Thread t=new Thread(new Runnable(){
    @Override public void run(){
      try {
        for (int i=0; i < 200; i++) {
          NodeBuilder builder=ns.getRoot().builder();
          builder.child("foo").child("node").child("node").child("node").child("node");
          builder.child("bar").child("node").child("node").child("node").child("node");
          merge(ns,builder);
          revisions.add(ns.getHeadRevision());
          builder=ns.getRoot().builder();
          builder.child("foo").child("node").remove();
          builder.child("bar").child("node").remove();
          merge(ns,builder);
          revisions.add(ns.getHeadRevision());
        }
      }
 catch (      CommitFailedException e) {
        exceptions.add(e);
      }
    }
  }
);
  t.start();
  RevisionContext rc=new TestRevisionContext(ns);
  while (t.isAlive()) {
    for (    String id : ns.getSplitCandidates()) {
      RevisionVector head=ns.getHeadRevision();
      NodeDocument doc=store.find(NODES,id);
      List<UpdateOp> ops=SplitOperations.forDocument(doc,rc,head,NUM_REVS_THRESHOLD);
      Set<Revision> removed=Sets.newHashSet();
      Set<Revision> added=Sets.newHashSet();
      for (      UpdateOp op : ops) {
        for (        Map.Entry<Key,Operation> e : op.getChanges().entrySet()) {
          if (!"_deleted".equals(e.getKey().getName())) {
            continue;
          }
          Revision r=e.getKey().getRevision();
          if (e.getValue().type == Operation.Type.REMOVE_MAP_ENTRY) {
            removed.add(r);
          }
 else           if (e.getValue().type == Operation.Type.SET_MAP_ENTRY) {
            added.add(r);
          }
        }
      }
      removed.removeAll(added);
      assertTrue("SplitOperations must not remove committed changes: " + removed,removed.isEmpty());
    }
    ns.runBackgroundOperations();
  }
  for (  NodeDocument doc : Utils.getAllDocuments(store)) {
    if (doc.isSplitDocument() || Utils.getDepthFromId(doc.getId()) < 2) {
      continue;
    }
    Set<Revision> revs=Sets.newHashSet();
    for (    RevisionVector rv : revisions) {
      Iterables.addAll(revs,rv);
    }
    revs.removeAll(doc.getValueMap("_deleted").keySet());
    assertTrue("Missing _deleted entries on " + doc.getId() + ": "+ revs,revs.isEmpty());
  }
}

</code></pre>

<br>
<pre class="type-13 type-9 type-6 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void manyRevisions(){
  final int numMKs=3;
  MemoryDocumentStore ds=new MemoryDocumentStore();
  MemoryBlobStore bs=new MemoryBlobStore();
  List<Set<String>> changes=new ArrayList<Set<String>>();
  List<DocumentMK> mks=new ArrayList<DocumentMK>();
  for (int i=1; i <= numMKs; i++) {
    DocumentMK.Builder builder=new DocumentMK.Builder();
    builder.setDocumentStore(ds).setBlobStore(bs).setAsyncDelay(0);
    DocumentMK mk=builder.setClusterId(i).open();
    mks.add(mk);
    changes.add(new HashSet<String>());
    if (i == 1) {
      mk.commit("/","+\"test\":{}",null,null);
      mk.runBackgroundOperations();
    }
  }
  List<String> propNames=Arrays.asList("prop1","prop2","prop3");
  Random random=new Random(0);
  for (int i=0; i < 1000; i++) {
    int mkIdx=random.nextInt(mks.size());
    DocumentMK mk=mks.get(mkIdx);
    DocumentNodeStore ns=mk.getNodeStore();
    String name=propNames.get(random.nextInt(propNames.size()));
    for (int j=0; j < changes.size(); j++) {
      Set<String> c=changes.get(j);
      if (c.contains(name)) {
        syncMKs(mks,j);
        c.clear();
        break;
      }
    }
    NodeDocument doc=ds.find(NODES,Utils.getIdFromPath("/test"));
    assertNotNull(doc);
    RevisionVector head=ns.getHeadRevision();
    Revision lastRev=ns.getPendingModifications().get("/test");
    DocumentNodeState n=doc.getNodeAtRevision(mk.getNodeStore(),head,lastRev);
    assertNotNull(n);
    String value=n.getPropertyAsString(name);
    if (value == null) {
      value=String.valueOf(0);
    }
 else {
      value=String.valueOf(Integer.parseInt(value) + 1);
    }
    mk.commit("/test","^\"" + name + "\":"+ value,null,null);
    changes.get(mkIdx).add(name);
  }
  for (  DocumentMK mk : mks) {
    mk.dispose();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.DocumentStorePerformanceTest </h4><pre class="type-13 type-9 type-7 type-6 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPerfLastRevBatch(){
  String bid=this.getClass().getName() + ".testPerfLastRevBatch";
  int nodecount=100;
  long duration=5000;
  int cnt=0;
  List<String> ids=new ArrayList<String>();
  Revision cr=Revision.fromString("r0-0-1");
  for (int i=0; i < nodecount; i++) {
    String id=bid + "-" + i;
    super.ds.remove(Collection.NODES,id);
    removeMe.add(id);
    UpdateOp up=new UpdateOp(id,true);
    up.set("_id",id);
    up.set("testprop",generateString(100 * i,true));
    up.setMapEntry("_lastRev",cr,"setup");
    up.set("_modified",NodeDocument.getModifiedInSecs(System.currentTimeMillis()));
    boolean success=super.ds.create(Collection.NODES,Collections.singletonList(up));
    assertTrue("creation failed for " + id + " in "+ super.dsname,success);
    ids.add(id);
  }
  long end=System.currentTimeMillis() + duration;
  while (System.currentTimeMillis() < end) {
    UpdateOp up=new UpdateOp(bid,true);
    up.setMapEntry("_lastRev",cr,"iteration-" + cnt);
    up.max("_modified",NodeDocument.getModifiedInSecs(System.currentTimeMillis()));
    super.ds.update(Collection.NODES,ids,up);
    cnt+=1;
  }
  super.ds.invalidateCache();
  for (int i=0; i < nodecount; i++) {
    NodeDocument d=super.ds.find(Collection.NODES,bid + "-" + i);
    assertNotNull(d);
    Map<Revision,String> m=(Map<Revision,String>)d.get("_lastRev");
    assertEquals("iteration-" + (cnt - 1),m.get(cr));
  }
  LOG.info("batch update for _lastRev for " + super.dsname + " was "+ cnt+ " in "+ duration+ "ms ("+ (cnt / (duration / 1000f))+ "/s)");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.DocumentStoreStatsIT </h4><pre class="type-13 type-9 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void query() throws Exception {
  String base=testName.getMethodName();
  for (int i=0; i < 10; i++) {
    String id=base + i;
    UpdateOp up=new UpdateOp(id,true);
    up.set("_id",id);
    boolean success=super.ds.create(Collection.NODES,Collections.singletonList(up));
    assertTrue("document with " + id + " not created",success);
    removeMe.add(id);
  }
  ds.query(Collection.NODES,base,base + "A",5);
  verify(stats).doneQuery(anyLong(),eq(Collection.NODES),eq(base),eq(base + "A"),eq(false),eq(5),anyLong(),eq(false));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.MultiDocumentStoreTest </h4><pre class="type-13 type-9 type-12 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInterleavedBatchUpdate(){
  int amount=10;
  int halfAmount=amount / 2;
  String baseId=this.getClass().getName() + ".testInterleavedBatchUpdate";
  for (int i=0; i < amount; i++) {
    String id=baseId + "-" + i;
    NodeDocument nd=super.ds1.find(Collection.NODES,id);
    if (nd != null) {
      super.ds1.remove(Collection.NODES,id);
    }
    removeMe.add(id);
  }
{
    List<UpdateOp> ops=new ArrayList<UpdateOp>();
    for (int i=0; i < halfAmount; i++) {
      String id=baseId + "-" + i;
      UpdateOp up=new UpdateOp(id,true);
      up.set(Document.ID,id);
      up.set("_createdby","ds1");
      ops.add(up);
    }
    List<NodeDocument> result=super.ds1.createOrUpdate(Collection.NODES,ops);
    assertEquals(halfAmount,result.size());
    for (    NodeDocument doc : result) {
      assertNull(doc);
    }
  }
{
    List<UpdateOp> ops=new ArrayList<UpdateOp>();
    for (int i=0; i < amount; i++) {
      String id=baseId + "-" + i;
      UpdateOp up=new UpdateOp(id,true);
      up.set(Document.ID,id);
      up.set("_createdby","ds2");
      ops.add(up);
    }
    List<NodeDocument> result=super.ds2.createOrUpdate(Collection.NODES,ops);
    assertEquals(amount,result.size());
    for (    NodeDocument doc : result) {
      if (doc != null) {
        assertEquals("ds1",doc.get("_createdby"));
      }
    }
  }
  for (int i=0; i < amount; i++) {
    String id=baseId + "-" + i;
    NodeDocument doc=super.ds1.find(Collection.NODES,id,0);
    assertNotNull(doc);
    assertEquals("ds2",doc.get("_createdby"));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.NodeDocumentTest </h4><pre class="type-13 type-9 type-7 type-6 type-4 type-18 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void getPreviousDocLeavesAfterGC1() throws Exception {
  DocumentNodeStore ns=createTestStore(200);
  Revision previous=ns.newRevision();
  NodeDocument root=getRootDocument(ns.getDocumentStore());
  int numLeaves=Iterators.size(root.getPreviousDocLeaves());
  NodeDocument toRemove=root.getAllPreviousDocs().next();
  int numDeleted=new SplitDocumentCleanUp(ns.store,new VersionGCStats(),Collections.singleton(toRemove)).disconnect().deleteSplitDocuments();
  assertEquals(1,numDeleted);
  root=getRootDocument(ns.getDocumentStore());
  assertEquals(numLeaves - 1,Iterators.size(root.getPreviousDocLeaves()));
  Iterator<NodeDocument> it=root.getPreviousDocLeaves();
  while (it.hasNext()) {
    NodeDocument leaf=it.next();
    Revision r=leaf.getAllChanges().iterator().next();
    assertTrue(previous.compareRevisionTime(r) > 0);
    previous=r;
  }
  ns.dispose();
}

</code></pre>

<br>
<pre class="type-13 type-9 type-7 type-6 type-4 type-18 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void getPreviousDocLeavesAfterGC2() throws Exception {
  DocumentNodeStore ns=createTestStore(200);
  Revision previous=ns.newRevision();
  NodeDocument root=getRootDocument(ns.getDocumentStore());
  int numLeaves=Iterators.size(root.getPreviousDocLeaves());
  NodeDocument toRemove=Iterators.getLast(root.getAllPreviousDocs());
  int numDeleted=new SplitDocumentCleanUp(ns.store,new VersionGCStats(),Collections.singleton(toRemove)).disconnect().deleteSplitDocuments();
  assertEquals(1,numDeleted);
  root=getRootDocument(ns.getDocumentStore());
  assertEquals(numLeaves - 1,Iterators.size(root.getPreviousDocLeaves()));
  Iterator<NodeDocument> it=root.getPreviousDocLeaves();
  while (it.hasNext()) {
    NodeDocument leaf=it.next();
    Revision r=leaf.getAllChanges().iterator().next();
    assertTrue(previous.compareRevisionTime(r) > 0);
    previous=r;
  }
  ns.dispose();
}

</code></pre>

<br>
<pre class="type-13 type-9 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void getChanges() throws Exception {
  final int numChanges=200;
  Random random=new Random();
  DocumentNodeStore ns=createTestStore(numChanges);
  DocumentStore store=ns.getDocumentStore();
  NodeDocument doc=getRootDocument(store);
  for (int i=0; i < 10; i++) {
    int idx=random.nextInt(numChanges);
    Revision r=Iterables.get(doc.getValueMap("p").keySet(),idx);
    Iterable<Revision> revs=doc.getChanges("p",new RevisionVector(r));
    assertEquals(idx,Iterables.size(revs));
  }
  ns.dispose();
}

</code></pre>

<br>
<pre class="type-13 type-9 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void getChangesMixedClusterIds() throws Exception {
  final int numChanges=200;
  Random random=new Random();
  MemoryDocumentStore store=new MemoryDocumentStore();
  DocumentNodeStore ns1=createTestStore(store,1,0);
  DocumentNodeStore ns2=createTestStore(store,2,0);
  List<DocumentNodeStore> nodeStores=Lists.newArrayList(ns1,ns2);
  List<RevisionVector> headRevisions=Lists.newArrayList();
  for (int i=0; i < numChanges; i++) {
    DocumentNodeStore ns=nodeStores.get(random.nextInt(nodeStores.size()));
    ns.runBackgroundOperations();
    NodeBuilder builder=ns.getRoot().builder();
    builder.setProperty("p",i);
    merge(ns,builder);
    headRevisions.add(ns.getHeadRevision());
    ns.runBackgroundOperations();
    if (random.nextDouble() < 0.2) {
      RevisionVector head=ns.getHeadRevision();
      for (      UpdateOp op : SplitOperations.forDocument(getRootDocument(store),ns,head,2)) {
        store.createOrUpdate(NODES,op);
      }
    }
  }
  headRevisions=Lists.reverse(headRevisions);
  NodeDocument doc=getRootDocument(store);
  for (int i=0; i < 10; i++) {
    int idx=random.nextInt(numChanges);
    RevisionVector r=headRevisions.get(idx);
    Iterable<Revision> revs1=doc.getChanges("p",r);
    Iterable<Revision> revs2=doc.getChanges("p",r);
    assertEquals(Iterables.size(revs1),Iterables.size(revs2));
    assertEquals(idx,Iterables.size(revs1));
  }
  ns1.dispose();
  ns2.dispose();
}

</code></pre>

<br>
<pre class="type-13 type-9 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void getPreviousDocLeaves() throws Exception {
  DocumentNodeStore ns=createTestStore(200);
  Revision previous=ns.newRevision();
  NodeDocument root=getRootDocument(ns.getDocumentStore());
  Iterator<NodeDocument> it=root.getPreviousDocLeaves();
  while (it.hasNext()) {
    NodeDocument leaf=it.next();
    Revision r=leaf.getAllChanges().iterator().next();
    assertTrue(previous.compareRevisionTime(r) > 0);
    previous=r;
  }
  ns.dispose();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.OrphanedBranchTest </h4><pre class="type-13 type-9 type-7 type-6 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void orphanedBranches() throws Exception {
  int numCreated=0;
  for (; ; ) {
    NodeBuilder builder=store.getRoot().builder();
    NodeBuilder child=builder.child("foo");
    int numBranches=store.getBranches().size();
    int count=0;
    while (store.getBranches().size() == numBranches) {
      child.setProperty("prop",count++);
    }
    numCreated++;
    builder=store.getRoot().builder();
    builder.child("bar").setProperty("prop",numCreated);
    store.merge(builder,EmptyHook.INSTANCE,CommitInfo.EMPTY);
    numBranches=store.getBranches().size();
    store.runBackgroundOperations();
    String id=Utils.getIdFromPath("/");
    NodeDocument doc=store.getDocumentStore().find(NODES,id);
    assertNotNull(doc);
    Map<Revision,String> collisions=doc.getLocalMap(COLLISIONS);
    assertTrue("too many collisions: " + collisions.size(),collisions.size() <= numBranches);
    int limit=numBranches + NodeDocument.NUM_REVS_THRESHOLD;
    id=Utils.getIdFromPath("/foo");
    doc=store.getDocumentStore().find(NODES,id);
    assertNotNull(doc);
    Map<Revision,String> map=doc.getLocalMap("prop");
    assertTrue("too many orphaned changes: " + map.size() + " > "+ limit,map.size() <= limit);
    map=doc.getLocalCommitRoot();
    assertTrue("too many orphaned commit root entries: " + map.size() + " > "+ limit,map.size() <= limit);
    if (numCreated % NodeDocument.NUM_REVS_THRESHOLD == 0) {
      gc.gc(1,TimeUnit.SECONDS);
    }
    LOG.info("created {}, still considered active: {}",numCreated,store.getBranches().size());
    int collect=fixture instanceof DocumentStoreFixture.MemoryFixture ? 500 : 100;
    if (numCreated - store.getBranches().size() >= collect) {
      break;
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.RandomizedClusterTest </h4><pre class="type-13 type-12 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void addRemoveSet() throws Exception {
  for (int i=0; i < MK_COUNT; i++) {
    unseenChanges[i]=new HashSet<Integer>();
    mkList[i]=createMK(i);
    revList[i]=mkList[i].getHeadRevision();
  }
  HashMap<Integer,ClusterRev> revs=new HashMap<Integer,ClusterRev>();
  Random r=new Random(1);
  int operations=1000, nodeCount=10;
  int valueCount=10;
  int maxBackRev=20;
  log=new StringBuilder();
  try {
    int maskOk=0, maskFail=0;
    int opCount=6;
    nodeChange.clear();
    for (int i=0; i < operations; i++) {
      opId=i;
      mkId=r.nextInt(mkList.length);
      String node="t" + r.nextInt(nodeCount);
      String node2="t" + r.nextInt(nodeCount);
      String property="x";
      String value="" + r.nextInt(valueCount);
      String diff;
      int op=r.nextInt(opCount);
      if (i < 20) {
        op=0;
      }
      String result;
      boolean conflictExpected;
switch (op) {
case 0:
        diff="+ \"" + node + "\": { \""+ property+ "\": "+ value+ "}";
      log(diff);
    if (exists(node)) {
      log("already exists");
      result=null;
    }
 else {
      conflictExpected=isConflict(node);
      result=commit(diff,conflictExpected);
      if (result != null) {
        changes.put(i,Arrays.asList(new Op(mkId,node,value)));
        nodeChange.put(node,i);
      }
    }
  break;
case 1:
diff="- \"" + node + "\"";
log(diff);
if (exists(node)) {
conflictExpected=isConflict(node);
result=commit(diff,conflictExpected);
if (result != null) {
changes.put(i,Arrays.asList(new Op(mkId,node,null)));
nodeChange.put(node,i);
}
}
 else {
log("doesn't exist");
result=null;
}
break;
case 2:
diff="^ \"" + node + "/"+ property+ "\": "+ value;
log(diff);
if (exists(node)) {
conflictExpected=isConflict(node);
result=commit(diff,conflictExpected);
if (result != null) {
changes.put(i,Arrays.asList(new Op(mkId,node,value)));
nodeChange.put(node,i);
}
}
 else {
log("doesn't exist");
result=null;
}
break;
case 3:
diff="> \"" + node + "\": \""+ node2+ "\"";
log(diff);
if (exists(node) && !exists(node2)) {
conflictExpected=isConflict(node) | isConflict(node2);
result=commit(diff,conflictExpected);
if (result != null) {
value=getValue(mkId,i,node);
changes.put(i,Arrays.asList(new Op(mkId,node,null),new Op(mkId,node2,value)));
nodeChange.put(node,i);
nodeChange.put(node2,i);
}
}
 else {
log("source doesn't exist or target exists");
result=null;
}
break;
case 4:
if (isConflict(node)) {
result=null;
}
 else {
diff="* \"" + node + "\": \""+ node2+ "\"";
log(diff);
if (exists(node) && !exists(node2)) {
conflictExpected=isConflict(node2);
result=commit(diff,conflictExpected);
if (result != null) {
value=getValue(mkId,i,node);
changes.put(i,Arrays.asList(new Op(mkId,node2,value)));
nodeChange.put(node2,i);
}
}
 else {
log("source doesn't exist or target exists");
result=null;
}
}
break;
case 5:
log("sync/refresh");
syncAndRefreshAllClusterNodes();
result=revList[mkId]=mkList[mkId].getHeadRevision();
maskFail|=1 << op;
break;
default :
fail();
result=null;
}
if (result == null) {
maskFail|=1 << op;
log(" -> fail " + Integer.toBinaryString(maskFail));
}
 else {
maskOk|=1 << op;
log(" -> " + result);
for (int j=0; j < unseenChanges.length; j++) {
if (j != mkId) {
unseenChanges[j].add(i);
}
}
}
log("get " + node);
boolean x=get(i,node);
log("get " + node + " returns "+ x);
log("get " + node2);
x=get(i,node2);
log("get " + node2 + " returns "+ x);
DocumentMK mk=mkList[mkId];
ClusterRev cr=new ClusterRev();
cr.mkId=mkId;
cr.rev=mk.getHeadRevision();
revs.put(i,cr);
revs.remove(i - maxBackRev);
log.append('\n');
}
if (Integer.bitCount(maskOk) != opCount) {
fail("Not all operations were at least once successful: " + Integer.toBinaryString(maskOk));
}
if (Integer.bitCount(maskFail) != opCount) {
fail("Not all operations failed at least once: " + Integer.toBinaryString(maskFail));
}
}
 catch (AssertionError e) {
throw new Exception("log: " + log,e);
}
catch (Exception e) {
throw new Exception("log: " + log,e);
}
for (int i=0; i < MK_COUNT; i++) {
mkList[i].dispose();
}
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.RevisionTest </h4><pre class="type-13 type-5 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void compare() throws InterruptedException {
  Revision last=Revision.newRevision(0);
  try {
    last.compareRevisionTime(null);
    fail();
  }
 catch (  NullPointerException e) {
  }
  for (int i=0; i < 1000; i++) {
    Revision r=Revision.newRevision(0);
    assertTrue(r.compareRevisionTime(r) == 0);
    assertTrue(r.compareRevisionTime(last) > 0);
    assertTrue(last.compareRevisionTime(r) < 0);
    last=r;
    if (i % 100 == 0) {
      Thread.sleep(1);
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-9 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void fromStringToString(){
  for (int i=0; i < 10000; i++) {
    Revision r=Revision.newRevision(i);
    Revision r2=Revision.fromString(r.toString());
    assertEquals(r.toString(),r2.toString());
    assertEquals(r.hashCode(),r2.hashCode());
    assertTrue(r.equals(r2));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.SimpleTest </h4><pre class="type-13 type-9 type-12 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void escapeUnescape(){
  DocumentMK mk=createMK();
  String rev;
  String nodes;
  Random r=new Random(1);
  for (int i=0; i < 20; i++) {
    int len=1 + r.nextInt(5);
    StringBuilder buff=new StringBuilder();
    for (int j=0; j < len; j++) {
      buff.append((char)(32 + r.nextInt(128)));
    }
    String s=buff.toString();
    String x2=Utils.escapePropertyName(s);
    String s2=Utils.unescapePropertyName(x2);
    if (!s.equals(s2)) {
      assertEquals(s,s2);
    }
    if (s.indexOf('/') >= 0) {
      continue;
    }
    JsopBuilder jsop=new JsopBuilder();
    jsop.tag('+').key(s).object().key(s).value("x").endObject();
    rev=mk.commit("/",jsop.toString(),null,null);
    nodes=mk.getNodes("/" + s,rev,0,0,100,null);
    jsop=new JsopBuilder();
    jsop.object().key(s).value("x").key(":childNodeCount").value(0).endObject();
    String n=jsop.toString();
    assertEquals(n,nodes);
    nodes=mk.getNodes("/",rev,0,0,100,null);
    jsop=new JsopBuilder();
    jsop.object().key(s).object().endObject().key(":childNodeCount").value(1).endObject();
    n=jsop.toString();
    assertEquals(n,nodes);
    jsop=new JsopBuilder();
    jsop.tag('-').value(s);
    rev=mk.commit("/",jsop.toString(),rev,null);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.VersionGCDeletionTest </h4><pre class="type-13 type-6 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void deleteLargeNumber() throws Exception {
  int noOfDocsToDelete=10000;
  DocumentStore ts=new MemoryDocumentStore();
  store=new DocumentMK.Builder().clock(clock).setDocumentStore(new MemoryDocumentStore()).setAsyncDelay(0).getNodeStore();
  clock.waitUntil(Revision.getCurrentTimestamp());
  NodeBuilder b1=store.getRoot().builder();
  NodeBuilder xb=b1.child("x");
  for (int i=0; i < noOfDocsToDelete; i++) {
    xb.child("a" + i).child("b" + i);
  }
  store.merge(b1,EmptyHook.INSTANCE,CommitInfo.EMPTY);
  long maxAge=1;
  long delta=TimeUnit.MINUTES.toMillis(10);
  NodeBuilder b2=store.getRoot().builder();
  b2.child("x").remove();
  store.merge(b2,EmptyHook.INSTANCE,CommitInfo.EMPTY);
  store.runBackgroundOperations();
  clock.waitUntil(clock.getTime() + HOURS.toMillis(maxAge * 2) + delta);
  VersionGarbageCollector gc=store.getVersionGarbageCollector();
  gc.setOverflowToDiskThreshold(100);
  VersionGCStats stats=gc.gc(maxAge * 2,HOURS);
  assertEquals(noOfDocsToDelete * 2 + 1,stats.deletedDocGCCount);
  assertNull(ts.find(Collection.NODES,"1:/x"));
  for (int i=0; i < noOfDocsToDelete; i++) {
    assertNull(ts.find(Collection.NODES,"2:/a" + i + "/b"+ i));
    assertNull(ts.find(Collection.NODES,"1:/a" + i));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.VersionGarbageCollectorIT </h4><pre class="type-13 type-9 type-12 type-7 type-6 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void gcDefaultLeafSplitDocs() throws Exception {
  Revision.setClock(clock);
  NodeBuilder builder=store.getRoot().builder();
  builder.child("test").setProperty("prop",-1);
  merge(store,builder);
  String id=Utils.getIdFromPath("/test");
  long start=Revision.getCurrentTimestamp();
  int hours=24;
  if (fixture instanceof DocumentStoreFixture.MongoFixture) {
    hours=6;
  }
  for (int i=0; i < 3600 * hours; i++) {
    clock.waitUntil(start + i * 1000);
    builder=store.getRoot().builder();
    builder.child("test").setProperty("prop",i);
    merge(store,builder);
    if (i % 10 == 0) {
      store.runBackgroundOperations();
    }
    if (i % 1800 == 0) {
      gc.gc(1,HOURS);
      NodeDocument doc=store.getDocumentStore().find(NODES,id);
      assertNotNull(doc);
      int numPrevDocs=Iterators.size(doc.getAllPreviousDocs());
      assertTrue("too many previous docs: " + numPrevDocs,numPrevDocs < 70);
    }
  }
  NodeDocument doc=store.getDocumentStore().find(NODES,id);
  assertNotNull(doc);
  int numRevs=size(doc.getValueMap("prop").entrySet());
  assertTrue("too many revisions: " + numRevs,numRevs < 6000);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.mongo.MongoDocumentStoreTest </h4><pre class="type-13 type-12 type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void timeoutQuery(){
  String fromId=Utils.getKeyLowerLimit("/");
  String toId=Utils.getKeyUpperLimit("/");
  store.setMaxLockedQueryTimeMS(1);
  long index=0;
  for (int i=0; i < 100; i++) {
    StringBuilder sb=new StringBuilder();
    for (int j=0; j < 1000; j++) {
      sb.append("+\"node-").append(index++).append("\":{}");
    }
    mk.commit("/",sb.toString(),null,null);
    store.queriesWithoutLock.set(0);
    store.resetLockAcquisitionCount();
    List<NodeDocument> docs=store.query(Collection.NODES,fromId,toId,"foo",System.currentTimeMillis(),Integer.MAX_VALUE);
    assertTrue(docs.isEmpty());
    if (store.queriesWithoutLock.get() > 0) {
      assertEquals(1,store.getLockAcquisitionCount());
      return;
    }
  }
  fail("No query timeout triggered even after adding " + index + " nodes");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.rdb.RDBDocumentStoreTest </h4><pre class="type-13 type-9 type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testRDBQueryKeyPatterns(){
  if (ds instanceof RDBDocumentStore) {
    RDBDocumentStore rds=(RDBDocumentStore)ds;
    String base=this.getClass().getName() + ".testRDBQuery-";
    for (int i=0; i < 10; i++) {
      String id="1:" + (i % 2 == 1 ? "p" : "") + "/"+ base+ i;
      UpdateOp up=new UpdateOp(id,true);
      up.set("_id",id);
      up.set("_test",base);
      boolean success=super.ds.create(Collection.NODES,Collections.singletonList(up));
      assertTrue("document with " + id + " not created",success);
      removeMe.add(id);
    }
    System.out.println(removeMe);
    List<QueryCondition> conditions=new ArrayList<QueryCondition>();
    List<NodeDocument> result=rds.query(Collection.NODES,NodeDocument.MIN_ID_VALUE,NodeDocument.MAX_ID_VALUE,Arrays.asList("_:/%","__:/%","___:/%"),conditions,10000);
    for (    NodeDocument d : result) {
      if (base.equals(d.get("_test"))) {
        assertTrue(d.getId().startsWith("1:p"));
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-9 type-12 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRDBQueryConditions(){
  if (ds instanceof RDBDocumentStore) {
    RDBDocumentStore rds=(RDBDocumentStore)ds;
    long now=System.currentTimeMillis();
    String base=this.getClass().getName() + ".testRDBQuery-";
    for (int i=0; i < 10; i++) {
      String id=base + i;
      UpdateOp up=new UpdateOp(id,true);
      up.set("_id",id);
      up.set(NodeDocument.DELETED_ONCE,i % 2 == 1);
      up.set(NodeDocument.MODIFIED_IN_SECS,now++);
      boolean success=super.ds.create(Collection.NODES,Collections.singletonList(up));
      assertTrue("document with " + id + " not created",success);
      removeMe.add(id);
    }
    List<QueryCondition> conditions=new ArrayList<QueryCondition>();
    conditions.add(new QueryCondition(NodeDocument.DELETED_ONCE,"=",0));
    conditions.add(new QueryCondition(NodeDocument.MODIFIED_IN_SECS,"<",now - 2));
    List<NodeDocument> result=rds.query(Collection.NODES,base,base + "A",RDBDocumentStore.EMPTY_KEY_PATTERN,conditions,10);
    assertEquals(4,result.size());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.index.solr.query.SolrQueryIndexTest </h4><pre class="type-13 type-6 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNoMoreThanThreeSolrRequests() throws Exception {
  NodeState root=mock(NodeState.class);
  when(root.getNames(any(String.class))).thenReturn(Collections.<String>emptySet());
  SelectorImpl selector=new SelectorImpl(root,"a");
  String sqlQuery="select [jcr:path], [jcr:score] from [nt:base] as a where" + " contains([jcr:content/*], 'founded')";
  SolrServer solrServer=mock(SolrServer.class);
  OakSolrConfiguration configuration=new DefaultSolrConfiguration(){
    @Override public boolean useForPropertyRestrictions(){
      return true;
    }
    @Override public int getRows(){
      return 10;
    }
  }
;
  SolrQueryIndex solrQueryIndex=new SolrQueryIndex("solr",solrServer,configuration);
  FilterImpl filter=new FilterImpl(selector,sqlQuery,new QueryEngineSettings());
  CountingResponse response=new CountingResponse(0);
  when(solrServer.query(any(SolrParams.class))).thenReturn(response);
  Cursor cursor=solrQueryIndex.query(filter,root);
  assertNotNull(cursor);
  while (cursor.hasNext()) {
    IndexRow row=cursor.next();
    assertNotNull(row);
  }
  assertEquals(3,response.getCounter());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.observation.filter.GlobbingPathFilterTest </h4><pre class="type-13 type-7 type-6 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * **&#47r/s/t/u/v should match r/s/t/u/v and r/s/t/u/v/r/s/t/u/v and r/s/t/u/v/r/s/t/u/v/r/s/t/u/v
 */
@Test public void multipleMatches(){
  EventFilter filter=new GlobbingPathFilter("**/r/s/t/u/v");
  ImmutableTree t=tree;
  for (int c=0; c < 2; c++) {
    for (    String name : elements("r/s/t/u")) {
      t=t.getChild(name);
      assertFalse(filter.includeAdd(name,t.getNodeState()));
      filter=filter.create(name,t.getNodeState(),t.getNodeState());
      assertNotNull(filter);
    }
    t=t.getChild("v");
    assertTrue(filter.includeAdd("v",t.getNodeState()));
    filter=filter.create("v",t.getNodeState(),t.getNodeState());
    assertNotNull(filter);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.segment.MergeTest </h4><pre class="type-13 type-5 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPessimisticMerge() throws Exception {
  final SegmentNodeStore store=new SegmentNodeStore(new MemoryStore());
  final Semaphore semaphore=new Semaphore(0);
  final AtomicBoolean running=new AtomicBoolean(true);
  Thread background=new Thread(){
    @Override public void run(){
      for (int i=0; running.get(); i++) {
        try {
          NodeBuilder a=store.getRoot().builder();
          a.setProperty("foo","abc" + i);
          store.merge(a,EmptyHook.INSTANCE,CommitInfo.EMPTY);
          semaphore.release();
        }
 catch (        CommitFailedException e) {
          fail();
        }
      }
    }
  }
;
  background.start();
  semaphore.acquire();
  assertTrue(store.getRoot().hasProperty("foo"));
  assertFalse(store.getRoot().hasProperty("bar"));
  NodeBuilder b=store.getRoot().builder();
  b.setProperty("bar","xyz");
  store.setMaximumBackoff(100);
  store.merge(b,new CommitHook(){
    @Override @Nonnull public NodeState processCommit(    NodeState before,    NodeState after,    CommitInfo info){
      try {
        Thread.sleep(100);
      }
 catch (      InterruptedException e) {
        fail();
      }
      return after;
    }
  }
,CommitInfo.EMPTY);
  assertTrue(store.getRoot().hasProperty("foo"));
  assertTrue(store.getRoot().hasProperty("bar"));
  running.set(false);
  background.join();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.segment.RecordIdMapTest </h4><pre class="type-13 type-9 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRecordIdMap() throws IOException {
  int maxSegments=1000;
  int maxEntriesPerSegment=10;
  int seed=new Random().nextInt();
  Random r=new Random(seed);
  SegmentTracker tracker=new MemoryStore().getTracker();
  RecordIdMap map=new RecordIdMap();
  Map<Short,RecordId> reference=newHashMap();
  int segments=r.nextInt(maxSegments);
  for (int i=0; i < segments; i++) {
    SegmentId id=tracker.newDataSegmentId();
    int n=r.nextInt(maxEntriesPerSegment);
    int offset=MAX_SEGMENT_SIZE;
    for (int j=0; j < n; j++) {
      offset=newValidOffset(r,(n - j) << RECORD_ALIGN_BITS,offset);
      RecordId record=new RecordId(id,offset);
      reference.put(encode(record.getOffset()),record);
    }
  }
  for (  Entry<Short,RecordId> entry : reference.entrySet()) {
    map.put(entry.getKey(),entry.getValue());
  }
  assertEquals("Failed with seed " + seed,reference.size(),map.size());
  for (  Entry<Short,RecordId> entry : reference.entrySet()) {
    short key=entry.getKey();
    assertTrue("Failed with seed " + seed,map.containsKey(key));
    RecordId expected=entry.getValue();
    RecordId actual=map.get(key);
    assertEquals("Failed with seed " + seed,expected,actual);
  }
  for (int k=0; k < map.size(); k++) {
    short key=map.getKey(k);
    RecordId expected=reference.get(key);
    RecordId actual=map.get(key);
    assertEquals("Failed with seed " + seed,expected,actual);
    assertEquals("Failed with seed " + seed,expected,map.getRecordId(k));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.segment.RecordTest </h4><pre class="type-13 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWorstCaseMap() throws IOException {
  RecordId blockId=writer.writeBlock(bytes,0,bytes.length);
  Map<String,RecordId> map=newHashMap();
  char[] key=new char[2];
  for (int i=0; i <= MapRecord.BUCKETS_PER_LEVEL; i++) {
    key[0]=(char)('A' + i);
    key[1]=(char)('\u1000' - key[0] * 31);
    map.put(new String(key),blockId);
  }
  MapRecord bad=writer.writeMap(null,map);
  assertEquals(map.size(),bad.size());
  Iterator<MapEntry> iterator=bad.getEntries().iterator();
  for (int i=0; i < map.size(); i++) {
    assertTrue(iterator.hasNext());
    assertEquals('\u1000',iterator.next().getName().hashCode());
  }
  assertFalse(iterator.hasNext());
}

</code></pre>

<br>
<pre class="type-13 type-9 type-7 type-6 type-4 type-8 type-18 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapRecord() throws IOException {
  RecordId blockId=writer.writeBlock(bytes,0,bytes.length);
  MapRecord zero=writer.writeMap(null,ImmutableMap.<String,RecordId>of());
  MapRecord one=writer.writeMap(null,ImmutableMap.of("one",blockId));
  MapRecord two=writer.writeMap(null,ImmutableMap.of("one",blockId,"two",blockId));
  Map<String,RecordId> map=newHashMap();
  for (int i=0; i < 1000; i++) {
    map.put("key" + i,blockId);
  }
  MapRecord many=writer.writeMap(null,map);
  Iterator<MapEntry> iterator;
  assertEquals(0,zero.size());
  assertNull(zero.getEntry("one"));
  iterator=zero.getEntries().iterator();
  assertFalse(iterator.hasNext());
  assertEquals(1,one.size());
  assertEquals(blockId,one.getEntry("one").getValue());
  assertNull(one.getEntry("two"));
  iterator=one.getEntries().iterator();
  assertTrue(iterator.hasNext());
  assertEquals("one",iterator.next().getName());
  assertFalse(iterator.hasNext());
  assertEquals(2,two.size());
  assertEquals(blockId,two.getEntry("one").getValue());
  assertEquals(blockId,two.getEntry("two").getValue());
  assertNull(two.getEntry("three"));
  iterator=two.getEntries().iterator();
  assertTrue(iterator.hasNext());
  iterator.next();
  assertTrue(iterator.hasNext());
  iterator.next();
  assertFalse(iterator.hasNext());
  assertEquals(1000,many.size());
  iterator=many.getEntries().iterator();
  for (int i=0; i < 1000; i++) {
    assertTrue(iterator.hasNext());
    assertEquals(blockId,iterator.next().getValue());
    assertEquals(blockId,many.getEntry("key" + i).getValue());
  }
  assertFalse(iterator.hasNext());
  assertNull(many.getEntry("foo"));
  Map<String,RecordId> changes=newHashMap();
  changes.put("key0",null);
  changes.put("key1000",blockId);
  MapRecord modified=writer.writeMap(many,changes);
  assertEquals(1000,modified.size());
  iterator=modified.getEntries().iterator();
  for (int i=1; i <= 1000; i++) {
    assertTrue(iterator.hasNext());
    assertEquals(blockId,iterator.next().getValue());
    assertEquals(blockId,modified.getEntry("key" + i).getValue());
  }
  assertFalse(iterator.hasNext());
  assertNull(many.getEntry("foo"));
}

</code></pre>

<br>
<pre class="type-13 type-6 type-4 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testBlockRecord() throws IOException {
  RecordId blockId=writer.writeBlock(bytes,0,bytes.length);
  BlockRecord block=new BlockRecord(blockId,bytes.length);
  for (int n=1; n < bytes.length; n++) {
    for (int i=0; i + n <= bytes.length; i++) {
      Arrays.fill(bytes,i,i + n,(byte)'.');
      assertEquals(n,block.read(i,bytes,i,n));
      assertEquals(hello,new String(bytes,Charsets.UTF_8));
    }
  }
  byte[] large=new byte[bytes.length * 2];
  assertEquals(bytes.length,block.read(0,large,0,large.length));
  assertEquals(hello,new String(large,0,bytes.length,Charsets.UTF_8));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.segment.SegmentIdTableTest </h4><pre class="type-13 type-12 type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void gc() throws IOException {
  SegmentTracker tracker=new MemoryStore().getTracker();
  final SegmentIdTable tbl=new SegmentIdTable(tracker);
  List<SegmentId> refs=new ArrayList<SegmentId>();
  int originalCount=1024;
  for (int i=0; i < originalCount; i++) {
    refs.add(tbl.getSegmentId(i,i % 128));
  }
  Assert.assertEquals(originalCount,tbl.getEntryCount());
  Assert.assertEquals(1,tbl.getMapRebuildCount());
  for (int i=0; i < refs.size() / 2; i++) {
    refs.remove(0);
  }
  for (int gcCalls=0; ; gcCalls++) {
    System.gc();
    for (    SegmentId id : refs) {
      SegmentId id2=tbl.getSegmentId(id.getMostSignificantBits(),id.getLeastSignificantBits());
      Assert.assertTrue(id2 == id);
    }
    Assert.assertEquals(1,tbl.getMapRebuildCount());
    for (int i=0; i < 10; i++) {
      tbl.getSegmentId(i,i);
    }
    if (tbl.getEntryCount() < originalCount) {
      break;
    }
 else     if (gcCalls > 10) {
      fail("No entries were garbage collected after 10 times System.gc()");
    }
  }
  Assert.assertEquals(2,tbl.getMapRebuildCount());
}

</code></pre>

<br>
<pre class="type-13 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void randomized() throws IOException {
  SegmentTracker tracker=new MemoryStore().getTracker();
  final SegmentIdTable tbl=new SegmentIdTable(tracker);
  List<SegmentId> refs=new ArrayList<SegmentId>();
  Random r=new Random(1);
  for (int i=0; i < 16 * 1024; i++) {
    refs.add(tbl.getSegmentId(r.nextLong(),r.nextLong()));
  }
  Assert.assertEquals(16 * 1024,tbl.getEntryCount());
  Assert.assertEquals(16 * 2048,tbl.getMapSize());
  Assert.assertEquals(5,tbl.getMapRebuildCount());
  r=new Random(1);
  for (int i=0; i < 16 * 1024; i++) {
    refs.add(tbl.getSegmentId(r.nextLong(),r.nextLong()));
    Assert.assertEquals(16 * 1024,tbl.getEntryCount());
    Assert.assertEquals(16 * 2048,tbl.getMapSize());
    Assert.assertEquals(5,tbl.getMapRebuildCount());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.segment.ShortSetTest </h4><pre class="type-13 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
"></span><br>
@Test public void empty(){
  for (short k=Short.MIN_VALUE; k < Short.MAX_VALUE; k++) {
    assertFalse(set.contains(k));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.segment.StringCacheTest </h4><pre class="type-13 type-9 type-7 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void empty(){
  final AtomicInteger counter=new AtomicInteger();
  Function<Integer,String> loader=new Function<Integer,String>(){
    @Override @Nullable public String apply(    @Nullable Integer input){
      counter.incrementAndGet();
      return "" + input;
    }
  }
;
  StringCache c=new StringCache(0);
  for (int repeat=0; repeat < 10; repeat++) {
    for (int i=0; i < 1000; i++) {
      assertEquals("" + i,c.getString(i,i,i,loader));
    }
  }
  assertTrue("" + counter,counter.get() > 1000);
  assertTrue("" + counter,counter.get() < 5000);
}

</code></pre>

<br>
<pre class="type-13 type-9 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void largeEntries(){
  final AtomicInteger counter=new AtomicInteger();
  final String large=new String(new char[1024]);
  Function<Integer,String> loader=new Function<Integer,String>(){
    @Override @Nullable public String apply(    @Nullable Integer input){
      counter.incrementAndGet();
      return large + input;
    }
  }
;
  StringCache c=new StringCache(1024);
  for (int repeat=0; repeat < 10; repeat++) {
    for (int i=0; i < 1000; i++) {
      assertEquals(large + i,c.getString(i,i,i,loader));
      assertEquals(large + 0,c.getString(0,0,0,loader));
    }
  }
  assertTrue("" + counter,counter.get() > 9000);
  assertTrue("" + counter,counter.get() < 10000);
}

</code></pre>

<br>
<pre class="type-13 type-9 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void randomized(){
  ArrayList<Function<Integer,String>> loaderList=new ArrayList<Function<Integer,String>>();
  int segmentCount=10;
  for (int i=0; i < segmentCount; i++) {
    final int x=i;
    Function<Integer,String> loader=new Function<Integer,String>(){
      @Override @Nullable public String apply(      @Nullable Integer input){
        return "loader #" + x + " offset "+ input;
      }
    }
;
    loaderList.add(loader);
  }
  StringCache c=new StringCache(10);
  Random r=new Random(1);
  for (int i=0; i < 1000; i++) {
    int segment=r.nextInt(segmentCount);
    int offset=r.nextInt(10);
    Function<Integer,String> loader=loaderList.get(segment);
    String x=c.getString(segment,segment,offset,loader);
    assertEquals(loader.apply(offset),x);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.segment.file.ReversedLinesFileReaderTestParamFile </h4><pre class="type-13 type-9 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDataIntegrityWithBufferedReader() throws URISyntaxException, IOException {
  File testFileIso=createFile(data);
  reversedLinesFileReader=new ReversedLinesFileReader(testFileIso,buffSize,encoding);
  Stack<String> lineStack=new Stack<String>();
  bufferedReader=new BufferedReader(new InputStreamReader(new FileInputStream(testFileIso),encoding));
  String line;
  while ((line=bufferedReader.readLine()) != null) {
    lineStack.push(line);
  }
  while ((line=reversedLinesFileReader.readLine()) != null) {
    String lineFromBufferedReader=lineStack.pop();
    assertEquals(lineFromBufferedReader,line);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.segment.migration.DepthFirstNodeIteratorTest </h4><pre class="type-13 type-9 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetPath(){
  Map<String,String> nameToPath=new HashMap<String,String>();
  nameToPath.put("countries","/countries");
  nameToPath.put("uk","/countries/uk");
  nameToPath.put("frognal","/countries/uk/cities/london/districts/frognal");
  nameToPath.put("paris","/countries/france/cities/paris");
  DepthFirstNodeIterator iterator=new DepthFirstNodeIterator(store.getRoot());
  while (iterator.hasNext()) {
    String expectedPath=nameToPath.remove(iterator.next().getName());
    if (expectedPath == null) {
      continue;
    }
    assertEquals(expectedPath,iterator.getPath());
  }
  assertTrue(nameToPath.isEmpty());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIterate(){
  Map<String,String[]> subtrees=new HashMap<String,String[]>();
  subtrees.put("uk",new String[]{"cities","london","districts","frognal"});
  subtrees.put("germany",new String[]{});
  subtrees.put("france",new String[]{"cities","paris"});
  DepthFirstNodeIterator iterator=new DepthFirstNodeIterator(store.getRoot());
  assertTrue(iterator.hasNext());
  assertEquals("countries",iterator.next().getName());
  for (int i=0; i < 3; i++) {
    assertTrue(iterator.hasNext());
    String country=iterator.next().getName();
    for (    String node : subtrees.remove(country)) {
      assertTrue(iterator.hasNext());
      assertEquals(node,iterator.next().getName());
    }
  }
  assertFalse(iterator.hasNext());
  assertTrue(subtrees.isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.segment.standby.StandbyTestIT </h4><pre class="type-13 type-9 type-7 type-6 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * OAK-2430
 */
@Test public void testSyncLoop() throws Exception {
  final int blobSize=25 * 1024;
  final int dataNodes=5000;
  FileStore primary=getPrimary();
  FileStore secondary=getSecondary();
  NodeStore store=new SegmentNodeStore(primary);
  final StandbyServer server=new StandbyServer(port,primary);
  server.start();
  byte[] data=addTestContent(store,"server",blobSize,dataNodes);
  primary.flush();
  StandbyClient cl=newStandbyClient(secondary);
  try {
    for (int i=0; i < 5; i++) {
      String cp=store.checkpoint(Long.MAX_VALUE);
      primary.flush();
      cl.run();
      assertEquals(primary.getHead(),secondary.getHead());
      assertTrue(store.release(cp));
      cl.cleanup();
      assertTrue(secondary.size() > blobSize);
    }
  }
  finally {
    server.close();
    cl.close();
  }
  assertTrue(primary.size() > blobSize);
  assertTrue(secondary.size() > blobSize);
  long primaryFs=FileUtils.sizeOf(directoryS);
  long secondaryFs=FileUtils.sizeOf(directoryC);
  assertTrue(secondaryFs < primaryFs * 1.15);
  PropertyState ps=secondary.getHead().getChildNode("root").getChildNode("server").getProperty("testBlob");
  assertNotNull(ps);
  assertEquals(Type.BINARY.tag(),ps.getType().tag());
  Blob b=ps.getValue(Type.BINARY);
  assertEquals(blobSize,b.length());
  byte[] testData=new byte[blobSize];
  ByteStreams.readFully(b.getNewStream(),testData);
  assertArrayEquals(data,testData);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.value.BinaryBasedBlobTest </h4><pre class="type-13 type-9 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void getStream() throws RepositoryException, IOException {
  byte[] bytes="just a test".getBytes();
  Binary binary=new TestBinary(bytes);
  Blob blob=new BinaryBasedBlob(binary);
  assertEquals(bytes.length,blob.length());
  InputStream expected=binary.getStream();
  InputStream actual=blob.getNewStream();
  try {
    for (int e=expected.read(); e != -1; e=expected.read()) {
      assertEquals(e,actual.read());
    }
    assertEquals(-1,actual.read());
  }
  finally {
    expected.close();
    actual.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.query.UtilsTest </h4><pre class="type-13 type-9 type-4 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void saturatedAdd(){
  assertEquals(3,QueryImpl.saturatedAdd(1,2));
  assertEquals(Long.MAX_VALUE,QueryImpl.saturatedAdd(1,Long.MAX_VALUE));
  assertEquals(Long.MAX_VALUE,QueryImpl.saturatedAdd(Long.MAX_VALUE,1));
  assertEquals(Long.MAX_VALUE,QueryImpl.saturatedAdd(Long.MAX_VALUE,Long.MAX_VALUE));
  long[] test={Long.MIN_VALUE,Long.MIN_VALUE + 1,Long.MIN_VALUE + 10,-1000,-10,-1,0,1,3,10000,Long.MAX_VALUE - 20,Long.MAX_VALUE - 1,Long.MAX_VALUE};
  Random r=new Random(1);
  for (int i=0; i < 10000; i++) {
    long x=r.nextBoolean() ? test[r.nextInt(test.length)] : r.nextLong();
    long y=r.nextBoolean() ? test[r.nextInt(test.length)] : r.nextLong();
    long alt=altSaturatedAdd(x,y);
    long got=QueryImpl.saturatedAdd(x,y);
    assertEquals(x + "+" + y,alt,got);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.query.index.FilterTest </h4><pre class="type-13 type-9 type-12 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void pathRestrictionsRandomized() throws Exception {
  ArrayList<String> paths=new ArrayList<String>();
  paths.add("/");
  for (int i='a'; i <= 'c'; i++) {
    String p1="/" + (char)i;
    paths.add(p1);
    for (int j='a'; j <= 'c'; j++) {
      String p2="/" + (char)j;
      paths.add(p1 + p2);
      for (int k='a'; k <= 'c'; k++) {
        String p3="/" + (char)k;
        paths.add(p1 + p2 + p3);
      }
    }
  }
  Random r=new Random(1);
  for (int i=0; i < 10000; i++) {
    String p1=paths.get(r.nextInt(paths.size()));
    String p2=paths.get(r.nextInt(paths.size()));
    Filter.PathRestriction r1=Filter.PathRestriction.values()[r.nextInt(Filter.PathRestriction.values().length)];
    Filter.PathRestriction r2=Filter.PathRestriction.values()[r.nextInt(Filter.PathRestriction.values().length)];
    FilterImpl f1=new FilterImpl();
    f1.restrictPath(p1,r1);
    FilterImpl f2=new FilterImpl();
    f2.restrictPath(p2,r2);
    FilterImpl fc=new FilterImpl();
    fc.restrictPath(p1,r1);
    fc.restrictPath(p2,r2);
    int tooMany=0;
    for (    String p : paths) {
      boolean expected=f1.testPath(p) && f2.testPath(p);
      boolean got=fc.testPath(p);
      if (expected == got) {
      }
 else       if (expected && !got) {
        fc=new FilterImpl();
        fc.restrictPath(p1,r1);
        fc.restrictPath(p2,r2);
        fail("not matched: " + p1 + "/"+ r1.name()+ " && "+ p2+ "/"+ r2.name());
      }
 else {
        tooMany++;
      }
    }
    if (tooMany > 3) {
      fail("too many matches: " + p1 + "/"+ r1.name()+ " && "+ p2+ "/"+ r2.name()+ " superfluous: "+ tooMany);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.authentication.ldap.LdapProviderTest </h4><pre class="type-13 type-6 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAuthenticateValidateTrueFalse() throws Exception {
  providerConfig.getAdminPoolConfig().setMaxActive(2).setLookupOnValidate(true);
  providerConfig.getUserPoolConfig().setMaxActive(2).setLookupOnValidate(false);
  idp.close();
  idp=new LdapIdentityProvider(providerConfig);
  SimpleCredentials creds=new SimpleCredentials(TEST_USER1_UID,"pass".toCharArray());
  for (int i=0; i < 8; i++) {
    ExternalUser user=idp.authenticate(creds);
    assertNotNull("User 1 must authenticate (i=" + i + ")",user);
    assertEquals("User Ref",TEST_USER1_DN,user.getExternalId().getId());
  }
}

</code></pre>

<br>
<pre class="type-13 type-6 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAuthenticateValidateTrueTrue() throws Exception {
  providerConfig.getAdminPoolConfig().setMaxActive(2).setLookupOnValidate(true);
  providerConfig.getUserPoolConfig().setMaxActive(2).setLookupOnValidate(true);
  idp.close();
  idp=new LdapIdentityProvider(providerConfig);
  SimpleCredentials creds=new SimpleCredentials(TEST_USER1_UID,"pass".toCharArray());
  for (int i=0; i < 8; i++) {
    ExternalUser user=idp.authenticate(creds);
    assertNotNull("User 1 must authenticate (i=" + i + ")",user);
    assertEquals("User Ref",TEST_USER1_DN,user.getExternalId().getId());
  }
}

</code></pre>

<br>
<pre class="type-13 type-6 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAuthenticateValidateFalseTrue() throws Exception {
  providerConfig.getAdminPoolConfig().setMaxActive(2).setLookupOnValidate(false);
  providerConfig.getUserPoolConfig().setMaxActive(2).setLookupOnValidate(true);
  idp.close();
  idp=new LdapIdentityProvider(providerConfig);
  SimpleCredentials creds=new SimpleCredentials(TEST_USER1_UID,"pass".toCharArray());
  for (int i=0; i < 8; i++) {
    ExternalUser user=idp.authenticate(creds);
    assertNotNull("User 1 must authenticate",user);
    assertEquals("User Ref",TEST_USER1_DN,user.getExternalId().getId());
  }
}

</code></pre>

<br>
<pre class="type-13 type-6 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAuthenticateValidateFalseFalse() throws Exception {
  providerConfig.getAdminPoolConfig().setMaxActive(2).setLookupOnValidate(false);
  providerConfig.getUserPoolConfig().setMaxActive(2).setLookupOnValidate(false);
  idp.close();
  idp=new LdapIdentityProvider(providerConfig);
  SimpleCredentials creds=new SimpleCredentials(TEST_USER1_UID,"pass".toCharArray());
  for (int i=0; i < 8; i++) {
    ExternalUser user=idp.authenticate(creds);
    assertNotNull("User 1 must authenticate",user);
    assertEquals("User Ref",TEST_USER1_DN,user.getExternalId().getId());
  }
}

</code></pre>

<br>
<pre class="type-13 type-9 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
/** 
 * Test case to reproduce OAK-3396 where an ldap user entry
 * without a uid caused a NullpointerException in LdapIdentityProvider.createUser
 */
@Test public void testListUsersWithMissingUid() throws Exception {
  InputStream erroneousDIF=LdapProviderTest.class.getResourceAsStream(ERRONEOUS_LDIF);
  LDAP_SERVER.loadLdif(erroneousDIF);
  Iterator<ExternalUser> users=idp.listUsers();
  while (users.hasNext()) {
    ExternalUser user=users.next();
    assertTrue(!user.getPrincipalName().startsWith("cn=Faulty Entry"));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.authorization.composite.CompositeAccessControlManagerTest </h4><pre class="type-13 type-12 type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetApplicablePolicies() throws Exception {
  AccessControlPolicyIterator it=acMgr.getApplicablePolicies("/");
  while (it.hasNext()) {
    if (it.nextAccessControlPolicy() == TestPolicy.INSTANCE) {
      fail("TestPolicy should only be applicable at /test.");
    }
  }
  Set<AccessControlPolicy> applicable=ImmutableSet.copyOf(acMgr.getApplicablePolicies(TEST_PATH));
  assertEquals(2,applicable.size());
  assertTrue(applicable.contains(TestPolicy.INSTANCE));
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSetPolicyAtRoot() throws Exception {
  AccessControlPolicyIterator it=acMgr.getApplicablePolicies("/");
  int cnt=0;
  while (it.hasNext()) {
    AccessControlPolicy plc=it.nextAccessControlPolicy();
    assertTrue(plc instanceof JackrabbitAccessControlList);
    acMgr.setPolicy("/",plc);
    cnt++;
  }
  assertEquals(1,cnt);
}

</code></pre>

<br>
<pre class="type-13 type-12 type-5 type-7 type-6 type-19 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetPolicies() throws Exception {
  int len=0;
  AccessControlPolicy[] policies=acMgr.getPolicies(TEST_PATH);
  assertEquals(len,policies.length);
  acMgr.setPolicy(TEST_PATH,TestPolicy.INSTANCE);
  len++;
  policies=acMgr.getPolicies(TEST_PATH);
  assertEquals(len,policies.length);
  assertSame(TestPolicy.INSTANCE,policies[0]);
  AccessControlPolicyIterator it=acMgr.getApplicablePolicies(TEST_PATH);
  while (it.hasNext()) {
    AccessControlPolicy plc=it.nextAccessControlPolicy();
    if (plc == TestPolicy.INSTANCE) {
      fail("TestPolicy should only be applicable at /test.");
    }
 else {
      acMgr.setPolicy(TEST_PATH,plc);
      len++;
      Set<AccessControlPolicy> policySet=ImmutableSet.copyOf(acMgr.getPolicies(TEST_PATH));
      assertEquals(len,policySet.size());
      assertTrue(policySet.contains(TestPolicy.INSTANCE));
      assertTrue(policySet.contains(plc));
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.principal.PrincipalProviderImplTest </h4><pre class="type-13 type-9 type-12 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
"></span><br>
@Test public void testEveryoneMembers() throws Exception {
  Principal everyone=principalProvider.getPrincipal(EveryonePrincipal.NAME);
  assertTrue(everyone instanceof EveryonePrincipal);
  Group everyoneGroup=null;
  try {
    UserManager userMgr=getUserManager(root);
    everyoneGroup=userMgr.createGroup(EveryonePrincipal.NAME);
    root.commit();
    Principal ep=principalProvider.getPrincipal(EveryonePrincipal.NAME);
    Set<? extends Principal> everyoneMembers=ImmutableSet.copyOf(Collections.list(((java.security.acl.Group)ep).members()));
    Iterator<? extends Principal> all=principalProvider.findPrincipals(PrincipalManager.SEARCH_TYPE_ALL);
    while (all.hasNext()) {
      Principal p=all.next();
      if (everyone.equals(p)) {
        assertFalse(everyoneMembers.contains(p));
      }
 else {
        assertTrue(everyoneMembers.contains(p));
      }
    }
  }
  finally {
    if (everyoneGroup != null) {
      everyoneGroup.remove();
      root.commit();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.user.L13_SystemUserTest </h4><pre class="type-13 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSystemUser() throws RepositoryException {
  UserManager userMgr=getUserManager(root);
  Authorizable authorizable=userMgr.getAuthorizable(systemUser.getID());
  Boolean isGroup=null;
  assertEquals(isGroup.booleanValue(),authorizable.isGroup());
  Boolean isAdmin=null;
  assertEquals(isAdmin.booleanValue(),systemUser.isAdmin());
  Class cls=null;
  Authorizable sUser=userMgr.getAuthorizable(systemUser.getID(),cls);
  Iterator<Group> memberOf=sUser.memberOf();
  Set<Group> expectedGroups=null;
  while (memberOf.hasNext()) {
    assertTrue(expectedGroups.remove(memberOf.next()));
  }
  assertTrue(expectedGroups.isEmpty());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSystemUserPrincipal() throws RepositoryException {
  Authorizable authorizable=getUserManager(root).getAuthorizable(systemUser.getID());
  Principal principal=authorizable.getPrincipal();
  PrincipalManager principalManager=getPrincipalManager(root);
  PrincipalIterator pIter=principalManager.getGroupMembership(principal);
  int expectedSize=-1;
  assertEquals(expectedSize,pIter.getSize());
  List<Principal> expectedGroupPrincipals=null;
  while (pIter.hasNext()) {
    Principal group=pIter.nextPrincipal();
    assertTrue(expectedGroupPrincipals.remove(group));
  }
  assertTrue(expectedGroupPrincipals.isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.user.L8_MembershipTest </h4><pre class="type-13 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testDeclaredMembership() throws RepositoryException, CommitFailedException {
  group.addMember(group2);
  group2.addMember(group3);
  group3.addMember(user);
  root.commit();
  Set<Group> expectedGroups=null;
  Iterator<Group> groups=user.declaredMemberOf();
  while (groups.hasNext()) {
    assertTrue(expectedGroups.remove(groups.next()));
  }
  assertTrue(expectedGroups.isEmpty());
  Set<Authorizable> expectedMembers=null;
  Iterator<Authorizable> memberIterator=group.getDeclaredMembers();
  while (memberIterator.hasNext()) {
    assertTrue(expectedMembers.remove(memberIterator.next()));
  }
  assertTrue(expectedMembers.isEmpty());
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testMembersContentStructure() throws RepositoryException, CommitFailedException {
  int size=new MembershipWriter().getMembershipSizeThreshold() * 5;
  List<String> memberUuids=new ArrayList<String>();
  for (int i=0; i < size; i++) {
    Authorizable user=createNewAuthorizable(false);
    String uuid=TreeUtil.getString(root.getTree(user.getPath()),JcrConstants.JCR_UUID);
    memberUuids.add(uuid);
    group.addMember(user);
  }
  root.commit();
  Tree groupTree=root.getTree(group.getPath());
  Iterator<String> values=groupTree.getProperty(UserConstants.REP_MEMBERS).getValue(Type.STRINGS).iterator();
  while (values.hasNext()) {
    assertTrue(memberUuids.remove(values.next()));
  }
  assertFalse(memberUuids.isEmpty());
  assertTrue(memberUuids.isEmpty());
}

</code></pre>

<br>
<pre class="type-13 type-9 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testInheritedMembership() throws RepositoryException, CommitFailedException {
  group.addMember(group2);
  group.addMember(group3);
  group3.addMember(user);
  root.commit();
  Set<Group> groups=null;
  Iterator<Group> groupIterator=user.memberOf();
  while (groupIterator.hasNext()) {
    Group gr=groupIterator.next();
    assertTrue(groups.remove(gr));
  }
  assertTrue(groups.isEmpty());
  Set<Authorizable> expectedMembers=null;
  Iterator<Authorizable> memberIterator=group.getMembers();
  while (memberIterator.hasNext()) {
    assertTrue(expectedMembers.remove(memberIterator.next()));
  }
  assertTrue(expectedMembers.isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.user.MembershipProviderTest </h4><pre class="type-13 type-9 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testManyMemberships() throws Exception {
  Set<String> memberships=new HashSet<String>();
  User usr=createUser();
  for (int i=0; i < NUM_GROUPS; i++) {
    Group grp=createGroup();
    grp.addMember(usr);
    memberships.add(grp.getID());
  }
  root.commit();
  Iterator<Group> iter=usr.declaredMemberOf();
  while (iter.hasNext()) {
    Group group=iter.next();
    Assert.assertTrue(memberships.remove(group.getID()));
  }
  assertEquals(0,memberships.size());
}

</code></pre>

<br>
<pre class="type-13 type-9 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNestedMembers() throws Exception {
  Set<String> members=new HashSet<String>();
  Set<String> declaredMembers=new HashSet<String>();
  Group grp=createGroup();
  for (int i=0; i < 10; i++) {
    Group g1=createGroup();
    grp.addMember(g1);
    members.add(g1.getID());
    declaredMembers.add(g1.getID());
    for (int j=0; j < 10; j++) {
      Group g2=createGroup();
      g1.addMember(g2);
      members.add(g2.getID());
      for (int k=0; k < 10; k++) {
        User usr=createUser();
        g2.addMember(usr);
        members.add(usr.getID());
      }
    }
  }
  root.commit();
  checkMembers(grp,members);
  Iterator<Authorizable> iter=grp.getDeclaredMembers();
  while (iter.hasNext()) {
    Authorizable member=iter.next();
    Assert.assertTrue(declaredMembers.remove(member.getID()));
  }
  assertEquals(0,declaredMembers.size());
}

</code></pre>

<br>
<pre class="type-13 type-9 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNestedMemberships() throws Exception {
  Set<String> memberships=new HashSet<String>();
  User user=createUser();
  Group grp=createGroup();
  memberships.add(grp.getID());
  for (int i=0; i < 10; i++) {
    Group g1=createGroup();
    grp.addMember(g1);
    memberships.add(g1.getID());
    for (int j=0; j < 10; j++) {
      Group g2=createGroup();
      g1.addMember(g2);
      memberships.add(g2.getID());
      g2.addMember(user);
    }
  }
  root.commit();
  Iterator<Group> iter=user.memberOf();
  while (iter.hasNext()) {
    Group group=iter.next();
    Assert.assertTrue(memberships.remove(group.getID()));
  }
  assertEquals(0,memberships.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.spi.blob.AbstractBlobStoreTest </h4><pre class="type-13 type-5 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWriteFile() throws Exception {
  store.setBlockSize(1024 * 1024);
  byte[] data=new byte[4 * 1024 * 1024];
  Random r=new Random(0);
  r.nextBytes(data);
  String tempFileName="target/temp/test";
  File tempFile=new File(tempFileName);
  tempFile.getParentFile().mkdirs();
  OutputStream out=new FileOutputStream(tempFile,false);
  out.write(data);
  out.close();
  String s=store.writeBlob(tempFileName);
  assertEquals(data.length,store.getBlobLength(s));
  byte[] buff=new byte[1];
  for (int i=0; i < data.length; i+=1024) {
    store.readBlob(s,i,buff,0,1);
    assertEquals(data[i],buff[0]);
  }
  try {
    store.writeBlob(tempFileName + "_wrong");
    fail();
  }
 catch (  Exception e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.spi.security.privilege.PrivilegeBitsTest </h4><pre class="type-13 type-9 type-5 type-7 type-6 type-19 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNextBits(){
  assertSame(PrivilegeBits.EMPTY,PrivilegeBits.EMPTY.nextBits());
  PrivilegeBits pb=READ_NODES_PRIVILEGE_BITS;
  long l=getLongValue(pb);
  while (l < Long.MAX_VALUE / 2) {
    l=l << 1;
    pb=pb.nextBits();
    assertEquals(l,getLongValue(pb));
  }
  for (int i=0; i < 10; i++) {
    PrivilegeBits nxt=pb.nextBits();
    assertEquals(nxt,pb.nextBits());
    assertFalse(pb.equals(nxt));
    pb=nxt;
  }
  pb=READ_NODES_PRIVILEGE_BITS;
  for (int i=0; i < 100; i++) {
    PrivilegeBits modifiable=PrivilegeBits.getInstance(pb);
    try {
      modifiable.nextBits();
      fail("UnsupportedOperation expected");
    }
 catch (    UnsupportedOperationException e) {
    }
    pb=pb.nextBits();
  }
}

</code></pre>

<br>
<pre class="type-13 type-9 type-12 type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAdd(){
  try {
    PrivilegeBits.EMPTY.add(PrivilegeBits.EMPTY);
    fail("UnsupportedOperation expected");
  }
 catch (  UnsupportedOperationException e) {
  }
  PrivilegeBits pb=READ_NODES_PRIVILEGE_BITS;
  PrivilegeBits mod=PrivilegeBits.getInstance(pb);
  for (int i=0; i < 100; i++) {
    try {
      pb.add(PrivilegeBits.EMPTY);
      fail("UnsupportedOperation expected");
    }
 catch (    UnsupportedOperationException e) {
    }
    try {
      pb.add(mod);
      fail("UnsupportedOperation expected");
    }
 catch (    UnsupportedOperationException e) {
    }
    PrivilegeBits nxt=pb.nextBits();
    try {
      pb.add(nxt);
      fail("UnsupportedOperation expected");
    }
 catch (    UnsupportedOperationException e) {
    }
    long before=getLongValue(mod);
    long nxtLong=getLongValue(nxt);
    mod.add(nxt);
    if (getLongValue(nxt) != 0) {
      assertEquals(before | nxtLong,getLongValue(mod));
    }
    assertTrue(mod.includes(nxt));
    PrivilegeBits tmp=PrivilegeBits.getInstance(pb);
    assertTrue(tmp.includes(pb));
    assertFalse(tmp.includes(nxt));
    if (READ_NODES_PRIVILEGE_BITS.equals(pb)) {
      assertTrue(tmp.includes(PrivilegeBits.BUILT_IN.get(PrivilegeConstants.REP_READ_NODES)));
    }
 else {
      assertFalse(tmp.includes(PrivilegeBits.BUILT_IN.get(PrivilegeConstants.REP_READ_NODES)));
    }
    tmp.add(nxt);
    assertTrue(tmp.includes(pb) && tmp.includes(nxt));
    if (READ_NODES_PRIVILEGE_BITS.equals(pb)) {
      assertTrue(tmp.includes(READ_NODES_PRIVILEGE_BITS));
    }
 else {
      assertFalse(tmp.includes(READ_NODES_PRIVILEGE_BITS));
    }
    tmp.add(READ_NODES_PRIVILEGE_BITS);
    assertTrue(tmp.includes(READ_NODES_PRIVILEGE_BITS));
    pb=nxt;
  }
}

</code></pre>

<br>
<pre class="type-13 type-9 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testRetain(){
  PrivilegeBits pb=READ_NODES_PRIVILEGE_BITS;
  List<PrivilegeBits> pbs=new ArrayList<PrivilegeBits>();
  pbs.add(pb);
  Random random=new Random();
  for (int i=0; i < 100; i++) {
    PrivilegeBits nxt=pb.nextBits();
    PrivilegeBits mod=PrivilegeBits.getInstance(nxt,pb);
    mod.retain(nxt);
    assertEquivalent(nxt,mod);
    mod=PrivilegeBits.getInstance(nxt);
    mod.retain(pb);
    assertTrue(nxt.toString(),mod.isEmpty());
    mod=PrivilegeBits.getInstance(nxt);
    mod.retain(READ_NODES_PRIVILEGE_BITS);
    assertTrue(nxt.toString(),mod.isEmpty());
    mod=PrivilegeBits.getInstance(nxt,READ_NODES_PRIVILEGE_BITS);
    mod.retain(nxt);
    assertEquivalent(nxt,mod);
    mod=PrivilegeBits.getInstance(nxt,pb,READ_NODES_PRIVILEGE_BITS);
    mod.retain(READ_NODES_PRIVILEGE_BITS);
    assertEquivalent(READ_NODES_PRIVILEGE_BITS,mod);
    mod=PrivilegeBits.getInstance(nxt);
    PrivilegeBits other=PrivilegeBits.getInstance();
    for (int j=0; j < pbs.size() / 2; j++) {
      other.add(pbs.get(random.nextInt(pbs.size() - 1)));
    }
    mod.add(other);
    mod.retain(other);
    assertEquivalent(other,mod);
    other.retain(nxt);
    assertTrue(other.isEmpty());
    pbs.add(nxt);
    pb=nxt;
  }
}

</code></pre>

<br>
<pre class="type-13 type-9 type-6 type-19 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUnmodifiable(){
  assertSame(PrivilegeBits.EMPTY,PrivilegeBits.EMPTY.unmodifiable());
  PrivilegeBits pb=READ_NODES_PRIVILEGE_BITS;
  PrivilegeBits mod=PrivilegeBits.getInstance(pb);
  for (int i=0; i < 100; i++) {
    PrivilegeBits nxt=pb.nextBits();
    assertSame(nxt,nxt.unmodifiable());
    assertEquals(nxt,nxt.unmodifiable());
    mod.add(nxt);
    assertNotSame(mod,mod.unmodifiable());
    pb=nxt;
  }
}

</code></pre>

<br>
<pre class="type-13 type-9 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testIsEmpty(){
  assertTrue(PrivilegeBits.EMPTY.isEmpty());
  PrivilegeBits pb=READ_NODES_PRIVILEGE_BITS;
  PrivilegeBits mod=PrivilegeBits.getInstance(pb);
  for (int i=0; i < 100; i++) {
    assertFalse(pb.isEmpty());
    assertFalse(PrivilegeBits.getInstance(pb).isEmpty());
    pb=pb.nextBits();
    mod.add(pb);
    assertFalse(mod.isEmpty());
    PrivilegeBits tmp=PrivilegeBits.getInstance(pb);
    tmp.diff(pb);
    assertTrue(tmp.toString(),tmp.isEmpty());
  }
}

</code></pre>

<br>
<pre class="type-13 type-9 type-5 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDiff(){
  try {
    PrivilegeBits.EMPTY.diff(PrivilegeBits.EMPTY);
    fail("UnsupportedOperation expected");
  }
 catch (  UnsupportedOperationException e) {
  }
  PrivilegeBits pb=READ_NODES_PRIVILEGE_BITS;
  PrivilegeBits mod=PrivilegeBits.getInstance(pb);
  for (int i=0; i < 100; i++) {
    PrivilegeBits nxt=pb.nextBits();
    try {
      pb.diff(nxt);
      fail("UnsupportedOperation expected");
    }
 catch (    UnsupportedOperationException e) {
    }
    try {
      pb.diff(mod);
      fail("UnsupportedOperation expected");
    }
 catch (    UnsupportedOperationException e) {
    }
    PrivilegeBits before=PrivilegeBits.getInstance(mod);
    mod.diff(nxt);
    assertEquivalent(before,mod);
    mod.add(nxt);
    assertFalse(before.equals(mod));
    mod.diff(nxt);
    assertEquivalent(before,mod);
    mod.add(nxt);
    PrivilegeBits tmp=PrivilegeBits.getInstance(pb);
    tmp.add(nxt);
    tmp.add(READ_NODES_PRIVILEGE_BITS);
    tmp.diff(tmp);
    assertEquivalent(PrivilegeBits.EMPTY,tmp);
    tmp=PrivilegeBits.getInstance(pb);
    tmp.add(nxt);
    tmp.add(READ_NODES_PRIVILEGE_BITS);
    tmp.diff(PrivilegeBits.getInstance(tmp));
    assertEquivalent(PrivilegeBits.EMPTY,tmp);
    tmp=PrivilegeBits.getInstance(pb);
    tmp.diff(nxt);
    assertEquivalent(PrivilegeBits.getInstance(pb),tmp);
    tmp=PrivilegeBits.getInstance(nxt);
    tmp.add(READ_NODES_PRIVILEGE_BITS);
    assertTrue(tmp.includes(READ_NODES_PRIVILEGE_BITS));
    assertTrue(tmp.includes(nxt));
    tmp.diff(nxt);
    assertEquivalent(READ_NODES_PRIVILEGE_BITS,tmp);
    assertTrue(tmp.includes(READ_NODES_PRIVILEGE_BITS));
    assertFalse(tmp.includes(nxt));
    tmp=PrivilegeBits.getInstance(pb);
    tmp.add(READ_NODES_PRIVILEGE_BITS);
    PrivilegeBits tmp2=PrivilegeBits.getInstance(pb);
    tmp2.add(nxt);
    PrivilegeBits tmp3=PrivilegeBits.getInstance(tmp2);
    assertEquivalent(tmp2,tmp3);
    tmp.diff(tmp2);
    if (READ_NODES_PRIVILEGE_BITS.equals(pb)) {
      assertEquivalent(PrivilegeBits.EMPTY,tmp);
    }
 else {
      assertEquivalent(READ_NODES_PRIVILEGE_BITS,tmp);
    }
    assertEquivalent(tmp3,tmp2);
    pb=nxt;
  }
}

</code></pre>

<br>
<pre class="type-13 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testIncludes(){
  assertTrue(PrivilegeBits.EMPTY.includes(PrivilegeBits.EMPTY));
  PrivilegeBits pb=READ_NODES_PRIVILEGE_BITS;
  PrivilegeBits mod=PrivilegeBits.getInstance();
  for (int i=0; i < 100; i++) {
    assertFalse(PrivilegeBits.EMPTY.includes(pb));
    assertTrue(pb.includes(PrivilegeBits.EMPTY));
    mod.add(pb);
    assertTrue(mod.includes(pb));
    PrivilegeBits nxt=pb.nextBits();
    assertTrue(nxt.includes(nxt));
    assertTrue(nxt.includes(PrivilegeBits.getInstance(nxt)));
    assertFalse(pb + " should not include " + nxt,pb.includes(nxt));
    assertFalse(nxt + " should not include " + pb,nxt.includes(pb));
    assertFalse(mod.includes(nxt));
    assertFalse(nxt.includes(mod));
    pb=nxt;
  }
}

</code></pre>

<br>
<pre class="type-13 type-9 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testLongValue(){
  assertEquals(NO_PRIVILEGE,getLongValue(PrivilegeBits.EMPTY));
  for (  long l : LONGS) {
    PrivilegeBits bits=PrivilegeBits.getInstance(createPropertyState(l));
    assertEquals(l,getLongValue(bits));
  }
  PrivilegeBits pb=READ_NODES_PRIVILEGE_BITS;
  long l=getLongValue(pb);
  while (l < Long.MAX_VALUE / 2) {
    l=l << 1;
    pb=pb.nextBits();
    assertEquals(l,getLongValue(pb));
  }
  for (int i=0; i < 10; i++) {
    pb=pb.nextBits();
    assertEquals(0,getLongValue(pb));
  }
  pb=READ_NODES_PRIVILEGE_BITS;
  for (int i=0; i < 100; i++) {
    PrivilegeBits modifiable=PrivilegeBits.getInstance(pb);
    assertEquals(getLongValue(pb),getLongValue(modifiable));
    pb=pb.nextBits();
  }
}

</code></pre>

<br>
<pre class="type-13 type-9 type-12 type-5 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddDifference(){
  try {
    PrivilegeBits.EMPTY.addDifference(PrivilegeBits.EMPTY,PrivilegeBits.EMPTY);
    fail("UnsupportedOperation expected");
  }
 catch (  UnsupportedOperationException e) {
  }
  PrivilegeBits pb=READ_NODES_PRIVILEGE_BITS;
  PrivilegeBits mod=PrivilegeBits.getInstance(pb);
  for (int i=0; i < 100; i++) {
    PrivilegeBits nxt=pb.nextBits();
    try {
      pb.addDifference(nxt,mod);
      fail("UnsupportedOperation expected");
    }
 catch (    UnsupportedOperationException e) {
    }
    try {
      pb.addDifference(nxt,READ_NODES_PRIVILEGE_BITS);
      fail("UnsupportedOperation expected");
    }
 catch (    UnsupportedOperationException e) {
    }
    PrivilegeBits tmp=PrivilegeBits.getInstance(mod);
    tmp.addDifference(nxt,READ_NODES_PRIVILEGE_BITS);
    mod.add(nxt);
    assertEquivalent(mod,tmp);
    if (!pb.equals(READ_NODES_PRIVILEGE_BITS)) {
      tmp=PrivilegeBits.getInstance(nxt);
      PrivilegeBits mod2=PrivilegeBits.getInstance(mod);
      tmp.addDifference(mod2,READ_NODES_PRIVILEGE_BITS);
      assertFalse(nxt.equals(tmp));
      assertEquivalent(mod2,mod);
      assertTrue(tmp.includes(pb));
      assertFalse(tmp.includes(READ_NODES_PRIVILEGE_BITS));
      assertFalse(tmp.includes(mod));
    }
    tmp=PrivilegeBits.getInstance(nxt);
    PrivilegeBits mod2=PrivilegeBits.getInstance(mod);
    tmp.addDifference(READ_NODES_PRIVILEGE_BITS,mod2);
    assertEquivalent(nxt,tmp);
    assertEquivalent(mod2,mod);
    assertFalse(tmp.includes(pb));
    assertFalse(tmp.includes(READ_NODES_PRIVILEGE_BITS));
    assertFalse(tmp.includes(mod));
    tmp=PrivilegeBits.getInstance(nxt);
    tmp.addDifference(READ_NODES_PRIVILEGE_BITS,READ_NODES_PRIVILEGE_BITS);
    assertEquivalent(nxt,tmp);
    assertFalse(tmp.includes(READ_NODES_PRIVILEGE_BITS));
    tmp=PrivilegeBits.getInstance(mod);
    tmp.addDifference(READ_NODES_PRIVILEGE_BITS,READ_NODES_PRIVILEGE_BITS);
    assertEquivalent(mod,tmp);
    assertTrue(tmp.includes(READ_NODES_PRIVILEGE_BITS));
    pb=nxt;
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.upgrade.RepositoryGroupMemberUpgradeTest </h4><pre class="type-13 type-7 type-6 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void verifyGroupNodeTypes() throws Exception {
  JackrabbitSession session=createAdminSession();
  try {
    UserManager userMgr=session.getUserManager();
    for (int i=0; i < getNumGroups(); i++) {
      Group grp=(Group)userMgr.getAuthorizable(TEST_GROUP_PREFIX + i);
      assertNotNull(grp);
      Node grpNode=session.getNode(grp.getPath());
      NodeType nt=grpNode.getPrimaryNodeType();
      assertEquals("Migrated group needs to be rep:Group",UserConstants.NT_REP_GROUP,nt.getName());
      assertTrue("Migrated group needs to be new node type",nt.isNodeType(UserConstants.NT_REP_MEMBER_REFERENCES));
    }
  }
  finally {
    session.logout();
  }
}

</code></pre>

<br>
<pre class="type-13 type-9 type-7 type-6 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void verifyMemberOf() throws Exception {
  JackrabbitSession session=createAdminSession();
  try {
    UserManager userMgr=session.getUserManager();
    for (int i=0; i < getNumUsers(); i++) {
      User user=(User)userMgr.getAuthorizable(TEST_USER_PREFIX + i);
      assertNotNull(user);
      Set<String> groups=new HashSet<String>();
      for (int j=0; j < getNumGroups(); j++) {
        groups.add(TEST_GROUP_PREFIX + j);
      }
      Iterator<Group> groupIterator=user.declaredMemberOf();
      while (groupIterator.hasNext()) {
        Group grp=groupIterator.next();
        assertTrue("user must be member of group " + grp.getID(),groups.remove(grp.getID()));
      }
      assertEquals("user " + user.getID() + " must be member of all groups",0,groups.size());
    }
  }
  finally {
    session.logout();
  }
}

</code></pre>

<br>
<pre class="type-13 type-9 type-7 type-6 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void verifyMembers() throws Exception {
  JackrabbitSession session=createAdminSession();
  try {
    UserManager userMgr=session.getUserManager();
    for (int i=0; i < getNumGroups(); i++) {
      Group grp=(Group)userMgr.getAuthorizable(TEST_GROUP_PREFIX + i);
      assertNotNull(grp);
      Set<String> testUsers=new HashSet<String>();
      for (int j=0; j < getNumUsers(); j++) {
        testUsers.add(TEST_USER_PREFIX + j);
      }
      Iterator<Authorizable> declaredMembers=grp.getDeclaredMembers();
      while (declaredMembers.hasNext()) {
        Authorizable auth=declaredMembers.next();
        assertTrue("group must have member " + auth.getID(),testUsers.remove(auth.getID()));
      }
      assertEquals("group must have all members",0,testUsers.size());
    }
  }
  finally {
    session.logout();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.upgrade.RepositoryUpgradeTest </h4><pre class="type-13 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void verifySNS() throws RepositoryException {
  Set<String> nodeNames=Sets.newHashSet("sibling","sibling[2]","sibling[3]");
  Session session=createAdminSession();
  try {
    Node sns=session.getNode("/sns");
    NodeIterator ns=sns.getNodes();
    int c=0;
    while (ns.hasNext()) {
      Node node=ns.nextNode();
      String name=node.getName();
      assertTrue("Unexpected node: " + name,nodeNames.remove(name));
    }
    assertTrue("Missing nodes: " + nodeNames,nodeNames.isEmpty());
  }
  finally {
    session.logout();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.util.ApproximateCounterTest </h4><pre class="type-13 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void highResolutionAdjust(){
  for (int i=0; i < 10; i++) {
    assertEquals(123,ApproximateCounter.adjustOffset(i,123,1));
  }
}

</code></pre>

<br>
<pre class="type-13 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void veryHighResolution(){
  for (int i=-100; i < 100; i++) {
    assertEquals(i,ApproximateCounter.calculateOffset(i,-1));
    assertEquals(i,ApproximateCounter.calculateOffset(i,0));
    assertEquals(i,ApproximateCounter.calculateOffset(i,1));
  }
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
