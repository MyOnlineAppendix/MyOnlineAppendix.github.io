<h3><span class=" glyphicon glyphicon-tag"/>&nbspBranchVerifier</h3><kbd>Verifies assertions inside branch conditions</kbd><br><br><br><h4 style="margin:0px">Class: org.apache.jackrabbit.oak.cache.CacheTest </h4><pre class="type-9 type-12 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void evictionCallback() throws ExecutionException {
  final Set<String> evictedKeys=newHashSet();
  final Set<Integer> evictedValues=newHashSet();
  CacheLIRS<String,Integer> cache=CacheLIRS.<String,Integer>newBuilder().maximumSize(100).evictionCallback(new EvictionCallback<String,Integer>(){
    @Override public void evicted(    String key,    Integer value){
      evictedKeys.add(key);
      if (value != null) {
        assertEquals(key,valueOf(value));
        evictedValues.add(value);
      }
    }
  }
).build();
  for (int k=0; k < 200; k++) {
    cache.put(valueOf(k),k);
  }
  assertTrue(evictedKeys.size() <= evictedValues.size());
  for (  String key : evictedKeys) {
    assertFalse(cache.containsKey(key));
  }
  cache.invalidateAll();
  assertEquals(200,evictedKeys.size());
  assertEquals(200,evictedValues.size());
}

</code></pre>

<br>
<pre class="type-13 type-9 type-12 type-6 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRandomOperations(){
  boolean log=false;
  int size=10;
  Random r=new Random(1);
  for (int j=0; j < 100; j++) {
    CacheLIRS<Integer,Integer> test=createCache(size / 2);
    HashMap<Integer,Integer> good=new HashMap<Integer,Integer>();
    for (int i=0; i < 10000; i++) {
      int key=r.nextInt(size);
      int value=r.nextInt();
switch (r.nextInt(3)) {
case 0:
        if (log) {
          System.out.println(i + " put " + key+ " "+ value);
        }
      good.put(key,value);
    test.put(key,value);
  break;
case 1:
if (log) {
  System.out.println(i + " get " + key);
}
Integer a=good.get(key);
Integer b=test.getIfPresent(key);
if (a == null) {
assertNull(b);
}
 else if (b != null) {
assertEquals(a,b);
}
break;
case 2:
if (log) {
System.out.println(i + " remove " + key);
}
good.remove(key);
test.remove(key);
break;
}
if (log) {
System.out.println(" -> " + toString(test));
}
}
verify(test,null);
}
}

</code></pre>

<br>
<pre class="type-13 type-12 type-6 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBadHashMethod(){
  final int size=4;
  /** 
 * A class with a bad hashCode implementation.
 */
class BadHash {
    int x;
    BadHash(    int x){
      this.x=x;
    }
    @Override public int hashCode(){
      return (x & 1) * size * 2;
    }
    @Override public boolean equals(    Object o){
      return ((BadHash)o).x == x;
    }
    @Override public String toString(){
      return "" + x;
    }
  }
  CacheLIRS<BadHash,Integer> test=createCache(size * 2);
  for (int i=0; i < size; i++) {
    test.put(new BadHash(i),i);
  }
  for (int i=0; i < size; i++) {
    if (i % 3 == 0) {
      assertEquals(i,test.remove(new BadHash(i)).intValue());
      assertNull(test.remove(new BadHash(i)));
    }
  }
  for (int i=0; i < size; i++) {
    if (i % 3 == 0) {
      assertNull(test.getIfPresent(new BadHash(i)));
    }
 else {
      assertEquals(i,test.getIfPresent(new BadHash(i)).intValue());
    }
  }
  for (int i=0; i < size; i++) {
    test.put(new BadHash(i),i);
  }
  for (int i=0; i < size; i++) {
    if (i % 3 == 0) {
      assertEquals(i,test.remove(new BadHash(i)).intValue());
      assertNull(test.remove(new BadHash(i)));
    }
  }
  for (int i=0; i < size; i++) {
    if (i % 3 == 0) {
      assertNull(test.getIfPresent(new BadHash(i)));
    }
 else {
      assertEquals(i,test.getIfPresent(new BadHash(i)).intValue());
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-12 type-7 type-6 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testScanResistance(){
  boolean log=false;
  int size=20;
  CacheLIRS<Integer,Integer> test=createCache(size / 2 + 1);
  for (int i=0; i < size; i++) {
    test.put(-i,-i * 10);
  }
  verify(test,null);
  for (int i=0; i < size / 2; i++) {
    test.put(i,i * 10);
    test.getUnchecked(i);
    if (log) {
      System.out.println("get " + i + " -> "+ test);
    }
  }
  verify(test,null);
  for (int i=0; i < size; i++) {
    Integer x=test.getIfPresent(i);
    Integer y=test.peek(i);
    if (i < size / 2) {
      assertTrue("i: " + i,x != null);
      assertTrue("i: " + i,y != null);
      assertEquals(i * 10,x.intValue());
      assertEquals(i * 10,y.intValue());
    }
 else {
      assertNull(x);
      assertNull(y);
      test.put(i,i * 10);
      assertEquals(i * 10,test.peek(i).intValue());
    }
    if (log) {
      System.out.println("get " + i + " -> "+ test);
    }
    verify(test,null);
  }
  for (int i=0; i < size; i++) {
    Integer x=test.getIfPresent(i);
    if (i < size / 2 || i == size - 1) {
      assertTrue("i: " + i,x != null);
      assertEquals(i * 10,x.intValue());
    }
 else {
      assertNull(x);
    }
    verify(test,null);
  }
}

</code></pre>

<br>
<pre class="type-13 type-9 type-12 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void evictionCallbackRandomized() throws ExecutionException {
  final HashMap<Integer,Integer> evictedMap=new HashMap<Integer,Integer>();
  final HashSet<Integer> evictedNonResidentSet=new HashSet<Integer>();
  CacheLIRS<Integer,Integer> cache=CacheLIRS.<Integer,Integer>newBuilder().maximumSize(10).evictionCallback(new EvictionCallback<Integer,Integer>(){
    @Override public void evicted(    Integer key,    Integer value){
      if (value == null) {
        assertTrue(evictedNonResidentSet.add(key));
      }
 else {
        assertEquals(null,evictedMap.put(key,value));
      }
    }
  }
).build();
  Random r=new Random(1);
  for (int k=0; k < 10000; k++) {
    if (r.nextInt(20) == 0) {
      evictedMap.clear();
      evictedNonResidentSet.clear();
      long size=cache.size();
      long sizeNonResident=cache.sizeNonResident();
      cache.invalidateAll();
      assertEquals(evictedMap.size(),size);
      assertEquals(evictedNonResidentSet.size(),sizeNonResident);
    }
    evictedMap.clear();
    evictedNonResidentSet.clear();
    int key=r.nextInt(20);
    if (r.nextBoolean()) {
      cache.put(key,k);
    }
 else {
      cache.get(key);
    }
    for (    Entry<Integer,Integer> ev : evictedMap.entrySet()) {
      int ek=ev.getKey();
      if (ek == key) {
      }
 else {
        assertFalse(cache.containsKey(ek));
      }
    }
    for (    Entry<Integer,Integer> ev : evictedMap.entrySet()) {
      int ek=ev.getKey();
      Integer v=ev.getValue();
      assertTrue(v < k);
      if (ek == key) {
      }
 else {
        assertFalse(cache.containsKey(ek));
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.cache.ConcurrentTest </h4><pre class="type-12 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
"></span><br>
@Test public void testCacheAccessInLoaderDeadlock() throws Exception {
  final Random r=new Random(1);
  final CacheLIRS<Integer,Integer> cache=new CacheLIRS.Builder<Integer,Integer>().maximumWeight(100).averageWeight(10).build();
  final Exception[] ex=new Exception[1];
  final int entryCount=10;
  int size=3;
  Thread[] threads=new Thread[size];
  final AtomicBoolean stop=new AtomicBoolean();
  for (int i=0; i < size; i++) {
    Thread t=new Thread(){
      @Override public void run(){
        Callable<Integer> callable=new Callable<Integer>(){
          @Override public Integer call() throws ExecutionException {
            if (r.nextBoolean()) {
              cache.get(r.nextInt(entryCount),this);
            }
 else {
              cache.get(r.nextInt(entryCount));
            }
            return 1;
          }
        }
;
        while (!stop.get()) {
          Integer key=r.nextInt(entryCount);
          try {
            cache.get(key,callable);
          }
 catch (          Exception e) {
            ex[0]=e;
          }
          cache.remove(key);
        }
      }
    }
;
    t.start();
    threads[i]=t;
  }
  Thread.sleep(100);
  stop.set(true);
  for (  Thread t : threads) {
    t.join(1000);
    if (t.isAlive()) {
      assertFalse("Deadlock detected!",t.isAlive());
    }
  }
  if (ex[0] != null) {
    throw ex[0];
  }
}

</code></pre>

<br>
<pre class="type-9 type-12 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
"></span><br>
@Test public void testLoaderBlock() throws Exception {
  final CacheLIRS<Integer,Integer> cache=new CacheLIRS.Builder<Integer,Integer>().maximumWeight(100).averageWeight(10).build();
  final Exception[] ex=new Exception[1];
  int threadCount=10;
  Thread[] threads=new Thread[threadCount];
  final AtomicBoolean stop=new AtomicBoolean();
  final AtomicInteger nextKey=new AtomicInteger();
  final AtomicLong additionalWait=new AtomicLong();
  for (int i=0; i < threadCount; i++) {
    Thread t=new Thread(){
      @Override public void run(){
        while (!stop.get()) {
          final int key=nextKey.getAndIncrement();
          final int wait=Math.min(key,100);
          Callable<Integer> callable=new Callable<Integer>(){
            @Override public Integer call() throws ExecutionException {
              try {
                Thread.sleep(wait);
              }
 catch (              InterruptedException e) {
              }
              cache.get(key * 10);
              return 1;
            }
          }
;
          long start=System.currentTimeMillis();
          try {
            cache.get(key,callable);
          }
 catch (          Exception e) {
            ex[0]=e;
          }
          long time=System.currentTimeMillis() - start;
          additionalWait.addAndGet(time - wait);
          cache.remove(key);
        }
      }
    }
;
    t.start();
    threads[i]=t;
  }
  Thread.sleep(1000);
  stop.set(true);
  for (  Thread t : threads) {
    t.join(1000);
    if (t.isAlive()) {
      assertFalse("Deadlock detected!",t.isAlive());
    }
  }
  if (ex[0] != null) {
    throw ex[0];
  }
  long add=additionalWait.get();
  assertTrue("Had to wait unexpectedly long for other threads: " + add,add < 1000);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.commons.PathUtilsTest </h4><pre class="type-12 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void test(){
  try {
    PathUtils.getParentPath("invalid/path/");
    if (assertsEnabled) {
      fail();
    }
  }
 catch (  AssertionFailedError e) {
    throw e;
  }
catch (  AssertionError e) {
  }
  try {
    PathUtils.getName("invalid/path/");
    if (assertsEnabled) {
      fail();
    }
  }
 catch (  AssertionFailedError e) {
    throw e;
  }
catch (  AssertionError e) {
  }
  test("parent","child");
  test("x","y");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.CopyTest </h4><pre class="type-13 type-12 type-5 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCopyVersionableNodeClearsVersions() throws Exception {
  Session session=getAdminSession();
  Node toCopy=session.getNode(TEST_PATH + "/source/node");
  toCopy.addMixin(JcrConstants.MIX_VERSIONABLE);
  session.save();
  Version v1=toCopy.checkin();
  toCopy.checkout();
  Version v2=toCopy.checkin();
  toCopy.checkout();
  session.getWorkspace().copy(TEST_PATH + "/source/node",TEST_PATH + "/target/copied");
  Node copy=testNode.getNode("target/copied");
  VersionHistory vh=copy.getVersionHistory();
  Version rootV=vh.getRootVersion();
  assertEquals(0,rootV.getSuccessors().length);
  VersionIterator vItr=vh.getAllVersions();
  while (vItr.hasNext()) {
    if (!rootV.isSame(vItr.nextVersion())) {
      fail("Unexpected version in version history of copied node.");
    }
  }
  try {
    vh.getVersion(v1.getName());
    fail("Unexpected version in version history of copied node.");
  }
 catch (  VersionException e) {
  }
  try {
    vh.getVersion(v2.getName());
    fail("Unexpected version in version history of copied node.");
  }
 catch (  VersionException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.RepositoryTest </h4><pre class="type-13 type-12 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void getProperties() throws RepositoryException {
  Set<String> propertyNames=new HashSet<String>(){
{
      add("intProp");
      add("mvProp");
      add("added");
    }
  }
;
  Set<String> values=new HashSet<String>(){
{
      add("added");
      add("1");
      add("2");
      add("3");
      add("42");
    }
  }
;
  Node node=getNode("/foo");
  node.setProperty("added","added");
  node.getProperty("stringProp").remove();
  node.getProperty("intProp").remove();
  node.setProperty("intProp",42);
  PropertyIterator properties=node.getProperties();
  assertEquals(4,properties.getSize());
  while (properties.hasNext()) {
    Property p=properties.nextProperty();
    if (JcrConstants.JCR_PRIMARYTYPE.equals(p.getName())) {
      continue;
    }
    assertTrue(propertyNames.remove(p.getName()));
    if (p.isMultiple()) {
      for (      Value v : p.getValues()) {
        assertTrue(values.remove(v.getString()));
      }
    }
 else {
      assertTrue(values.remove(p.getString()));
    }
  }
  assertTrue(propertyNames.isEmpty());
  assertTrue(values.isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.SameNamePropertyNodeTest </h4><pre class="type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testGetItem() throws Exception {
  Item item=superuser.getItem(n.getPath());
  if (item.isNode()) {
    assertTrue(n.isSame(item));
  }
 else {
    assertTrue(p.isSame(item));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.query.PrefetchIteratorTest </h4><pre class="type-12 type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test(){
  for (  int size : seq(0,100)) {
    for (    int readBefore : seq(0,30)) {
      final long testTimeout=size % 3 == 0 ? 100 : 0;
      Iterable<Integer> s=seq(0,size);
      PrefetchIterator<Integer> it=new PrefetchIterator<Integer>(s.iterator(),new PrefetchOptions(){
{
          min=20;
          timeout=testTimeout;
          max=30;
          size=-1;
        }
      }
);
      for (      int x : seq(0,readBefore)) {
        boolean hasNext=it.hasNext();
        if (!hasNext) {
          assertEquals(x,size);
          break;
        }
        String m="s:" + size + " b:"+ readBefore+ " x:"+ x;
        assertTrue(m,hasNext);
        assertEquals(m,x,it.next().intValue());
      }
      String m="s:" + size + " b:"+ readBefore;
      int max=testTimeout <= 0 ? 20 : 30;
      if (size > max && readBefore <= size) {
        assertEquals(m,-1,it.size());
        assertEquals(m,-1,it.size());
      }
 else {
        assertEquals(m,size,it.size());
        assertEquals(m,size,it.size());
      }
      for (      int x : seq(readBefore,size)) {
        m="s:" + size + " b:"+ readBefore+ " x:"+ x;
        assertTrue(m,it.hasNext());
        assertEquals(m,x,it.next().intValue());
      }
      assertFalse(it.hasNext());
      try {
        it.next();
        fail();
      }
 catch (      NoSuchElementException e) {
      }
      try {
        it.remove();
        fail();
      }
 catch (      UnsupportedOperationException e) {
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.query.QueryTest </h4><pre class="type-13 type-12 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void skip() throws RepositoryException {
  Session session=getAdminSession();
  Node hello1=session.getRootNode().addNode("hello1");
  hello1.setProperty("id","1");
  hello1.setProperty("data","x");
  session.save();
  Node hello3=hello1.addNode("hello3");
  hello3.setProperty("id","3");
  hello3.setProperty("data","z");
  session.save();
  Node hello2=hello3.addNode("hello2");
  hello2.setProperty("id","2");
  hello2.setProperty("data","y");
  session.save();
  ValueFactory vf=session.getValueFactory();
  QueryManager qm=session.getWorkspace().getQueryManager();
  Query q=qm.createQuery("select id from [nt:base] where data >= $data order by id",Query.JCR_SQL2);
  q.bindValue("data",vf.createValue("x"));
  for (int i=-1; i < 5; i++) {
    QueryResult r=q.execute();
    RowIterator it=r.getRows();
    assertEquals(3,r.getRows().getSize());
    assertEquals(3,r.getNodes().getSize());
    Row row;
    try {
      it.skip(i);
      assertTrue(i >= 0 && i <= 3);
    }
 catch (    IllegalArgumentException e) {
      assertEquals(-1,i);
    }
catch (    NoSuchElementException e) {
      assertTrue(i >= 2);
    }
    if (i <= 0) {
      assertTrue(it.hasNext());
      row=it.nextRow();
      assertEquals("1",row.getValue("id").getString());
    }
    if (i <= 1) {
      assertTrue(it.hasNext());
      row=it.nextRow();
      assertEquals("2",row.getValue("id").getString());
    }
    if (i <= 2) {
      assertTrue(it.hasNext());
      row=it.nextRow();
      assertEquals("3",row.getValue("id").getString());
    }
    assertFalse(it.hasNext());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.authorization.AccessControlManagementTest </h4><pre class="type-13 type-12 type-5 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAcContentIsProtected() throws Exception {
  Node policyNode=findPolicyNode(superuser.getRootNode());
  if (policyNode == null) {
    throw new NotExecutableException("no policy node found.");
  }
  assertTrue("The rep:Policy node must be protected",policyNode.getDefinition().isProtected());
  try {
    policyNode.remove();
    fail("rep:Policy node must be protected.");
  }
 catch (  ConstraintViolationException e) {
  }
  for (NodeIterator it=policyNode.getNodes(); it.hasNext(); ) {
    Node n=it.nextNode();
    if (n.isNodeType("rep:ACE")) {
      try {
        n.remove();
        fail("ACE node must be protected.");
      }
 catch (      ConstraintViolationException e) {
      }
      break;
    }
  }
  try {
    policyNode.setProperty("test","anyvalue");
    fail("rep:policy node must be protected.");
  }
 catch (  ConstraintViolationException e) {
  }
  try {
    policyNode.addNode("test","rep:ACE");
    fail("rep:policy node must be protected.");
  }
 catch (  ConstraintViolationException e) {
  }
}

</code></pre>

<br>
<pre class="type-13 type-9 type-12 type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRetrievePrivilegesOnAcNodes() throws Exception {
  Privilege[] privileges=privilegesFromName(Privilege.JCR_READ_ACCESS_CONTROL);
  allow(path,privileges);
  assertTrue(testAcMgr.hasPrivileges(path,privileges));
  AccessControlPolicy[] policies=testAcMgr.getPolicies(path);
  assertEquals(1,policies.length);
  assertTrue(policies[0] instanceof JackrabbitAccessControlList);
  String aclNodePath=null;
  Node n=superuser.getNode(path);
  for (NodeIterator itr=n.getNodes(); itr.hasNext(); ) {
    Node child=itr.nextNode();
    if (child.isNodeType("rep:Policy")) {
      aclNodePath=child.getPath();
    }
  }
  if (aclNodePath == null) {
    fail("Expected node at " + path + " to have an ACL child node.");
  }
  assertTrue(testAcMgr.hasPrivileges(aclNodePath,privileges));
  assertTrue(testSession.hasPermission(aclNodePath,Session.ACTION_READ));
  for (NodeIterator aceNodes=superuser.getNode(aclNodePath).getNodes(); aceNodes.hasNext(); ) {
    String aceNodePath=aceNodes.nextNode().getPath();
    assertTrue(testAcMgr.hasPrivileges(aceNodePath,privileges));
    assertTrue(testSession.hasPermission(aceNodePath,Session.ACTION_READ));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.authorization.ImportBesteffortTest </h4><pre class="type-12 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testImportUnknownPrincipal() throws Exception {
  runImport();
  AccessControlManager acMgr=adminSession.getAccessControlManager();
  AccessControlPolicy[] policies=acMgr.getPolicies(target.getPath());
  assertEquals(1,policies.length);
  assertTrue(policies[0] instanceof JackrabbitAccessControlList);
  AccessControlEntry[] entries=((JackrabbitAccessControlList)policies[0]).getAccessControlEntries();
  assertEquals(1,entries.length);
  AccessControlEntry entry=entries[0];
  assertEquals("unknownprincipal",entry.getPrincipal().getName());
  assertEquals(1,entry.getPrivileges().length);
  assertEquals(acMgr.privilegeFromName(Privilege.JCR_WRITE),entry.getPrivileges()[0]);
  if (entry instanceof JackrabbitAccessControlEntry) {
    assertTrue(((JackrabbitAccessControlEntry)entry).isAllow());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.authorization.JackrabbitAccessControlListTest </h4><pre class="type-12 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSize() throws RepositoryException {
  if (acl.addAccessControlEntry(testPrincipal,testPrivileges)) {
    assertTrue(acl.size() > 0);
  }
 else {
    assertEquals(0,acl.size());
  }
}

</code></pre>

<br>
<pre class="type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testIsEmpty() throws RepositoryException {
  if (acl.addAccessControlEntry(testPrincipal,testPrivileges)) {
    assertFalse(acl.isEmpty());
  }
 else {
    assertTrue(acl.isEmpty());
  }
}

</code></pre>

<br>
<pre class="type-12 type-7 type-6 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddEntry() throws NotExecutableException, RepositoryException {
  List<AccessControlEntry> entriesBefore=Arrays.asList(acl.getAccessControlEntries());
  if (acl.addEntry(testPrincipal,testPrivileges,true,Collections.<String,Value>emptyMap())) {
    AccessControlEntry[] entries=acl.getAccessControlEntries();
    AccessControlEntry ace=null;
    for (    AccessControlEntry entry : entries) {
      if (testPrincipal.equals(entry.getPrincipal())) {
        ace=entry;
      }
    }
    assertNotNull("addEntry was successful -> expected entry for tesPrincipal.",ace);
    assertTrue("addEntry was successful -> at least 1 entry.",entries.length > 0);
  }
 else {
    AccessControlEntry[] entries=acl.getAccessControlEntries();
    assertEquals("Grant ALL not successful -> entries must not have changed.",entriesBefore,Arrays.asList(entries));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.authorization.ObservationTest </h4><pre class="type-12 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testEventGeneration() throws Exception {
  deny(path,readPrivileges);
  ObservationManager obsMgr=testSession.getWorkspace().getObservationManager();
  EventResult listener=new EventResult(this.log);
  try {
    obsMgr.addEventListener(listener,Event.NODE_REMOVED,path,true,new String[0],new String[0],true);
    superuser.getItem(childNPath).remove();
    superuser.save();
    obsMgr.removeEventListener(listener);
    Event[] evts=listener.getEvents(DEFAULT_WAIT_TIMEOUT);
    for (    Event evt : evts) {
      if (evt.getType() == Event.NODE_REMOVED && evt.getPath().equals(childNPath)) {
        fail("TestUser does not have READ permission below " + path + " -> events below must not show up.");
      }
    }
  }
  finally {
    obsMgr.removeEventListener(listener);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.authorization.UserManagementTest </h4><pre class="type-13 type-12 type-5 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @see <a href="https://issues.apache.org/jira/browse/JCR-3412">JCR-3412 :
     *      UserManager.findAuthorizables() does not work, if session does not have
     *      read access to common root of all user and groups. </a>
 */
@Test public void testFindAuthorizables() throws Exception {
  String home=Text.getRelativeParent(UserConstants.DEFAULT_USER_PATH,1);
  deny(home,privilegesFromName(PrivilegeConstants.JCR_READ));
  allow(getUserManager(superuser).getAuthorizable(testSession.getUserID()).getPath(),privilegesFromName(PrivilegeConstants.JCR_ALL));
  UserManager testUserMgr=getUserManager(testSession);
  Iterator<Authorizable> result=testUserMgr.findAuthorizables(UserConstants.REP_PRINCIPAL_NAME,null,UserManager.SEARCH_TYPE_USER);
  Set<String> ids=new HashSet<String>();
  while (result.hasNext()) {
    ids.add(result.next().getID());
  }
  assertFalse(ids.isEmpty());
  NodeIterator nodeIterator=testSession.getWorkspace().getQueryManager().createQuery("/jcr:root//element(*,rep:User)",Query.XPATH).execute().getNodes();
  assertTrue(nodeIterator.hasNext());
  while (nodeIterator.hasNext()) {
    String userId=nodeIterator.nextNode().getProperty(UserConstants.REP_AUTHORIZABLE_ID).getString();
    if (!ids.remove(userId)) {
      fail("UserId " + userId + " missing in result set.");
    }
  }
  assertTrue("Result mismatch",ids.isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.principal.PrincipalManagerTest </h4><pre class="type-13 type-9 type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testMembers(){
  PrincipalIterator it=principalMgr.getPrincipals(PrincipalManager.SEARCH_TYPE_ALL);
  while (it.hasNext()) {
    Principal p=it.nextPrincipal();
    if (p.equals(principalMgr.getEveryone())) {
      continue;
    }
    if (isGroup(p)) {
      Enumeration<? extends Principal> en=((java.security.acl.Group)p).members();
      while (en.hasMoreElements()) {
        Principal memb=en.nextElement();
        assertTrue(principalMgr.hasPrincipal(memb.getName()));
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testFindPrincipalByType(){
  for (  Principal pcpl : adminPrincipals) {
    if (pcpl.equals(everyone)) {
      continue;
    }
    assertTrue(principalMgr.hasPrincipal(pcpl.getName()));
    if (isGroup(pcpl)) {
      PrincipalIterator it=principalMgr.findPrincipals(pcpl.getName(),PrincipalManager.SEARCH_TYPE_GROUP);
      assertTrue("findPrincipals does not find principal with filter " + pcpl.getName(),it.hasNext());
    }
 else {
      PrincipalIterator it=principalMgr.findPrincipals(pcpl.getName(),PrincipalManager.SEARCH_TYPE_NOT_GROUP);
      assertTrue("findPrincipals does not find principal with filter '" + pcpl.getName() + "' and type "+ PrincipalManager.SEARCH_TYPE_NOT_GROUP,it.hasNext());
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-12 type-5 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEveryoneGroupMembership(){
  Principal everyone=EveryonePrincipal.getInstance();
  for (PrincipalIterator membership=principalMgr.getGroupMembership(everyone); membership.hasNext(); ) {
    Principal gr=membership.nextPrincipal();
    assertTrue(isGroup(gr));
    if (gr.equals(everyone)) {
      fail("Everyone must never be a member of the EveryOne group.");
    }
  }
}

</code></pre>

<br>
<pre class="type-12 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
"></span><br>
@Test public void testReadOnlyIsEveryOne() throws Exception {
  Session s=getHelper().getReadOnlySession();
  try {
    Principal[] pcpls=getPrincipals(getHelper().getReadOnlyCredentials());
    for (    Principal pcpl : pcpls) {
      if (!(pcpl.equals(everyone))) {
        assertTrue(everyone.isMember(pcpl));
      }
    }
  }
  finally {
    s.logout();
  }
}

</code></pre>

<br>
<pre class="type-13 type-9 type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testMembers2() throws Exception {
  Authorizable gr=null;
  try {
    gr=((JackrabbitSession)superuser).getUserManager().createGroup(getClass().getName());
    superuser.save();
    PrincipalIterator it=principalMgr.getPrincipals(PrincipalManager.SEARCH_TYPE_ALL);
    while (it.hasNext()) {
      Principal p=it.nextPrincipal();
      if (p.equals(principalMgr.getEveryone())) {
        continue;
      }
      if (isGroup(p)) {
        Enumeration<? extends Principal> en=((java.security.acl.Group)p).members();
        while (en.hasMoreElements()) {
          Principal memb=en.nextElement();
          assertTrue(principalMgr.hasPrincipal(memb.getName()));
        }
      }
    }
  }
  finally {
    if (gr != null) {
      gr.remove();
      superuser.save();
    }
  }
}

</code></pre>

<br>
<pre class="type-12 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
"></span><br>
@Test public void testSuperUserIsEveryOne(){
  for (  Principal pcpl : adminPrincipals) {
    if (!(pcpl.equals(everyone))) {
      assertTrue(everyone.isMember(pcpl));
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.user.AuthorizablePropertyTest </h4><pre class="type-12 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testRemoveSpecialGroupPropertiesDirectly() throws RepositoryException, NotExecutableException {
  Node n=getNode(group,superuser);
  try {
    if (n.hasProperty(UserConstants.REP_PRINCIPAL_NAME)) {
      n.getProperty(UserConstants.REP_PRINCIPAL_NAME).remove();
      fail("Attempt to remove protected property rep:principalName should fail.");
    }
  }
 catch (  ConstraintViolationException e) {
  }
  try {
    if (n.hasProperty(UserConstants.REP_MEMBERS)) {
      n.getProperty(UserConstants.REP_MEMBERS).remove();
      fail("Attempt to remove protected property rep:members should fail.");
    }
  }
 catch (  ConstraintViolationException e) {
  }
}

</code></pre>

<br>
<pre class="type-12 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testRemoveSpecialUserPropertiesDirectly() throws RepositoryException, NotExecutableException {
  Node n=getNode(user,superuser);
  try {
    n.getProperty(UserConstants.REP_PASSWORD).remove();
    fail("Attempt to remove protected property rep:password should fail.");
  }
 catch (  ConstraintViolationException e) {
  }
  try {
    if (n.hasProperty(UserConstants.REP_PRINCIPAL_NAME)) {
      n.getProperty(UserConstants.REP_PRINCIPAL_NAME).remove();
      fail("Attempt to remove protected property rep:principalName should fail.");
    }
  }
 catch (  ConstraintViolationException e) {
  }
}

</code></pre>

<br>
<pre class="type-13 type-12 type-7 type-6 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGroupGetProperties() throws RepositoryException, NotExecutableException {
  Node n=getNode(group,superuser);
  for (PropertyIterator it=n.getProperties(); it.hasNext(); ) {
    Property prop=it.nextProperty();
    if (prop.getDefinition().isProtected()) {
      assertFalse(group.hasProperty(prop.getName()));
      assertNull(group.getProperty(prop.getName()));
    }
 else {
      assertTrue(group.hasProperty(prop.getName()));
      assertNotNull(group.getProperty(prop.getName()));
    }
  }
}

</code></pre>

<br>
<pre class="type-12 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testRemoveSpecialProperties() throws NotExecutableException, RepositoryException {
  for (  String pName : protectedUserProps.keySet()) {
    try {
      if (user.removeProperty(pName)) {
        superuser.save();
        fail("removing the '" + pName + "' property on a User should fail.");
      }
    }
 catch (    RepositoryException e) {
    }
 finally {
      superuser.refresh(false);
    }
  }
  for (  String pName : protectedGroupProps.keySet()) {
    try {
      if (group.removeProperty(pName)) {
        superuser.save();
        fail("removing the '" + pName + "' property on a Group should fail.");
      }
    }
 catch (    RepositoryException e) {
    }
 finally {
      superuser.refresh(false);
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-12 type-7 type-6 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUserGetProperties() throws RepositoryException, NotExecutableException {
  Node n=getNode(user,superuser);
  for (PropertyIterator it=n.getProperties(); it.hasNext(); ) {
    Property p=it.nextProperty();
    if (p.getDefinition().isProtected()) {
      assertFalse(user.hasProperty(p.getName()));
      assertNull(user.getProperty(p.getName()));
    }
 else {
      assertTrue(user.hasProperty(p.getName()));
      assertNotNull(user.getProperty(p.getName()));
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.user.FindAuthorizablesTest </h4><pre class="type-13 type-12 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testFindUserInAllGroups() throws RepositoryException, NotExecutableException {
  User u=null;
  try {
    Principal p=getTestPrincipal();
    String uid=createUserId();
    u=userMgr.createUser(uid,"pw",p,null);
    superuser.save();
    Iterator<Authorizable> it=userMgr.findAuthorizables(UserConstants.REP_PRINCIPAL_NAME,null,UserManager.SEARCH_TYPE_GROUP);
    while (it.hasNext()) {
      if (it.next().getPrincipal().getName().equals(p.getName())) {
        fail("Searching for Groups should never find a user");
      }
    }
  }
  finally {
    if (u != null) {
      u.remove();
      superuser.save();
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-12 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFindAuthorizable() throws RepositoryException, NotExecutableException {
  Set<Principal> principals=new HashSet<Principal>();
  PrincipalManager pMgr=((JackrabbitSession)superuser).getPrincipalManager();
  Principal p=pMgr.getPrincipal(superuser.getUserID());
  if (p != null) {
    principals.add(p);
    PrincipalIterator principalIterator=pMgr.getGroupMembership(p);
    while (principalIterator.hasNext()) {
      principals.add(principalIterator.nextPrincipal());
    }
  }
  Authorizable auth;
  for (  Principal principal : principals) {
    auth=userMgr.getAuthorizable(principal);
    if (auth != null) {
      if (!auth.isGroup() && auth.hasProperty(UserConstants.REP_PRINCIPAL_NAME)) {
        String val=auth.getProperty(UserConstants.REP_PRINCIPAL_NAME)[0].getString();
        Iterator<Authorizable> users=userMgr.findAuthorizables(UserConstants.REP_PRINCIPAL_NAME,val);
        assertTrue(users.hasNext());
        Authorizable first=users.next();
        assertEquals(first.getID(),val);
        assertFalse(users.hasNext());
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-12 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testFindGroupInAllUsers() throws RepositoryException, NotExecutableException {
  Group gr=null;
  try {
    Principal p=getTestPrincipal();
    gr=userMgr.createGroup(p);
    superuser.save();
    boolean found=false;
    Iterator<Authorizable> it=userMgr.findAuthorizables(UserConstants.REP_PRINCIPAL_NAME,null,UserManager.SEARCH_TYPE_USER);
    while (it.hasNext()) {
      if (it.next().getPrincipal().getName().equals(p.getName())) {
        fail("Searching for Users should never find a group");
      }
    }
  }
  finally {
    if (gr != null) {
      gr.remove();
      superuser.save();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.user.GroupImportBestEffortTest </h4><pre class="type-12 type-5 type-7 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testImportNonExistingMemberBestEffort() throws Exception {
  List<String> invalid=new ArrayList<String>();
  invalid.add(UUID.randomUUID().toString());
  invalid.add(getExistingUUID());
  Session s=getImportSession();
  for (  String id : invalid) {
    String xml="<?xml version=\"1.0\" encoding=\"UTF-8\"?>" + "<sv:node sv:name=\"gFolder\" xmlns:mix=\"http://www.jcp.org/jcr/mix/1.0\" xmlns:nt=\"http://www.jcp.org/jcr/nt/1.0\" xmlns:fn_old=\"http://www.w3.org/2004/10/xpath-functions\" xmlns:fn=\"http://www.w3.org/2005/xpath-functions\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:sv=\"http://www.jcp.org/jcr/sv/1.0\" xmlns:rep=\"internal\" xmlns:jcr=\"http://www.jcp.org/jcr/1.0\">" + "   <sv:property sv:name=\"jcr:primaryType\" sv:type=\"Name\"><sv:value>rep:AuthorizableFolder</sv:value></sv:property>"+ "<sv:node sv:name=\"g1\"><sv:property sv:name=\"jcr:primaryType\" sv:type=\"Name\"><sv:value>rep:Group</sv:value></sv:property>"+ "   <sv:property sv:name=\"jcr:uuid\" sv:type=\"String\"><sv:value>0120a4f9-196a-3f9e-b9f5-23f31f914da7</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:principalName\" sv:type=\"String\"><sv:value>g1</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:members\" sv:type=\"WeakReference\"><sv:value>" + id + "</sv:value></sv:property>"+ "</sv:node>"+ "</sv:node>";
    try {
      doImport(getTargetPath(),xml);
      Authorizable a=getUserManager().getAuthorizable("g1");
      if (a.isGroup()) {
        boolean found=false;
        Node grNode=s.getNode(a.getPath());
        for (        Value memberValue : grNode.getProperty(UserConstants.REP_MEMBERS).getValues()) {
          assertEquals(PropertyType.WEAKREFERENCE,memberValue.getType());
          if (id.equals(memberValue.getString())) {
            found=true;
            break;
          }
        }
        assertTrue("ImportBehavior.BESTEFFORT must import non-existing members.",found);
        assertNotDeclaredMember((Group)a,id,s);
      }
 else {
        fail("'g1' was not imported as Group.");
      }
    }
  finally {
      s.refresh(false);
    }
  }
}

</code></pre>

<br>
<pre class="type-12 type-5 type-7 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testImportNonExistingMemberBestEffort2() throws Exception {
  String g1Id="0120a4f9-196a-3f9e-b9f5-23f31f914da7";
  String nonExistingId="b2f5ff47-4366-31b6-a533-d8dc3614845d";
  if (getUserManager().getAuthorizable("g") != null) {
    throw new NotExecutableException();
  }
  String xml="<?xml version=\"1.0\" encoding=\"UTF-8\"?>" + "<sv:node sv:name=\"gFolder\" xmlns:mix=\"http://www.jcp.org/jcr/mix/1.0\" xmlns:nt=\"http://www.jcp.org/jcr/nt/1.0\" xmlns:fn_old=\"http://www.w3.org/2004/10/xpath-functions\" xmlns:fn=\"http://www.w3.org/2005/xpath-functions\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:sv=\"http://www.jcp.org/jcr/sv/1.0\" xmlns:rep=\"internal\" xmlns:jcr=\"http://www.jcp.org/jcr/1.0\">" + "   <sv:property sv:name=\"jcr:primaryType\" sv:type=\"Name\"><sv:value>rep:AuthorizableFolder</sv:value></sv:property>"+ "<sv:node sv:name=\"g1\"><sv:property sv:name=\"jcr:primaryType\" sv:type=\"Name\"><sv:value>rep:Group</sv:value></sv:property>"+ "   <sv:property sv:name=\"jcr:uuid\" sv:type=\"String\"><sv:value>" + g1Id + "</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:principalName\" sv:type=\"String\"><sv:value>g1</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:members\" sv:type=\"WeakReference\"><sv:value>"+ nonExistingId+ "</sv:value></sv:property>"+ "</sv:node>"+ "</sv:node>";
  doImport(getTargetPath(),xml);
  Authorizable g1=getUserManager().getAuthorizable("g1");
  if (g1.isGroup()) {
    boolean found=false;
    Node grNode=getImportSession().getNode(g1.getPath());
    for (    Value memberValue : grNode.getProperty(UserConstants.REP_MEMBERS).getValues()) {
      assertEquals(PropertyType.WEAKREFERENCE,memberValue.getType());
      if (nonExistingId.equals(memberValue.getString())) {
        found=true;
        break;
      }
    }
    assertTrue("ImportBehavior.BESTEFFORT must import non-existing members.",found);
  }
 else {
    fail("'g1' was not imported as Group.");
  }
}

</code></pre>

<br>
<pre class="type-12 type-5 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testImportCircularMembership() throws Exception {
  String g1Id="0120a4f9-196a-3f9e-b9f5-23f31f914da7";
  String nonExistingId="b2f5ff47-4366-31b6-a533-d8dc3614845d";
  if (getUserManager().getAuthorizable("g") != null) {
    throw new NotExecutableException();
  }
  String xml="<?xml version=\"1.0\" encoding=\"UTF-8\"?>" + "<sv:node sv:name=\"gFolder\" xmlns:mix=\"http://www.jcp.org/jcr/mix/1.0\" xmlns:nt=\"http://www.jcp.org/jcr/nt/1.0\" xmlns:fn_old=\"http://www.w3.org/2004/10/xpath-functions\" xmlns:fn=\"http://www.w3.org/2005/xpath-functions\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:sv=\"http://www.jcp.org/jcr/sv/1.0\" xmlns:rep=\"internal\" xmlns:jcr=\"http://www.jcp.org/jcr/1.0\">" + "   <sv:property sv:name=\"jcr:primaryType\" sv:type=\"Name\"><sv:value>rep:AuthorizableFolder</sv:value></sv:property>"+ "<sv:node sv:name=\"g1\"><sv:property sv:name=\"jcr:primaryType\" sv:type=\"Name\"><sv:value>rep:Group</sv:value></sv:property>"+ "   <sv:property sv:name=\"jcr:uuid\" sv:type=\"String\"><sv:value>" + g1Id + "</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:principalName\" sv:type=\"String\"><sv:value>g1</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:members\" sv:type=\"WeakReference\"><sv:value>"+ nonExistingId+ "</sv:value></sv:property>"+ "</sv:node>"+ "</sv:node>";
  String xml2="<?xml version=\"1.0\" encoding=\"UTF-8\"?>" + "   <sv:node sv:name=\"g\" xmlns:mix=\"http://www.jcp.org/jcr/mix/1.0\" xmlns:nt=\"http://www.jcp.org/jcr/nt/1.0\" xmlns:fn_old=\"http://www.w3.org/2004/10/xpath-functions\" xmlns:fn=\"http://www.w3.org/2005/xpath-functions\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:sv=\"http://www.jcp.org/jcr/sv/1.0\" xmlns:rep=\"internal\" xmlns:jcr=\"http://www.jcp.org/jcr/1.0\">" + "       <sv:property sv:name=\"jcr:primaryType\" sv:type=\"Name\"><sv:value>rep:Group</sv:value></sv:property>"+ "       <sv:property sv:name=\"jcr:uuid\" sv:type=\"String\"><sv:value>" + nonExistingId + "</sv:value></sv:property>"+ "       <sv:property sv:name=\"rep:principalName\" sv:type=\"String\"><sv:value>g</sv:value></sv:property>"+ "       <sv:property sv:name=\"rep:members\" sv:type=\"WeakReference\"><sv:value>"+ g1Id+ "</sv:value></sv:property>"+ "   </sv:node>";
  doImport(getTargetPath(),xml);
  doImport(getTargetPath() + "/gFolder",xml2);
  Authorizable g=getUserManager().getAuthorizable("g");
  assertNotNull(g);
  if (g.isGroup()) {
    assertNotDeclaredMember((Group)g,g1Id,getImportSession());
  }
 else {
    fail("'g' was not imported as Group.");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.user.GroupImportIgnoreTest </h4><pre class="type-12 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testImportNonExistingMemberIgnore() throws Exception {
  List<String> invalid=new ArrayList<String>();
  invalid.add(UUID.randomUUID().toString());
  invalid.add(getExistingUUID());
  for (  String id : invalid) {
    String xml="<?xml version=\"1.0\" encoding=\"UTF-8\"?>" + "<sv:node sv:name=\"gFolder\" xmlns:mix=\"http://www.jcp.org/jcr/mix/1.0\" xmlns:nt=\"http://www.jcp.org/jcr/nt/1.0\" xmlns:fn_old=\"http://www.w3.org/2004/10/xpath-functions\" xmlns:fn=\"http://www.w3.org/2005/xpath-functions\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:sv=\"http://www.jcp.org/jcr/sv/1.0\" xmlns:rep=\"internal\" xmlns:jcr=\"http://www.jcp.org/jcr/1.0\">" + "   <sv:property sv:name=\"jcr:primaryType\" sv:type=\"Name\"><sv:value>rep:AuthorizableFolder</sv:value></sv:property>"+ "<sv:node sv:name=\"g1\"><sv:property sv:name=\"jcr:primaryType\" sv:type=\"Name\"><sv:value>rep:Group</sv:value></sv:property>"+ "   <sv:property sv:name=\"jcr:uuid\" sv:type=\"String\"><sv:value>0120a4f9-196a-3f9e-b9f5-23f31f914da7</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:principalName\" sv:type=\"String\"><sv:value>g1</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:members\" sv:type=\"WeakReference\"><sv:value>" + id + "</sv:value></sv:property>"+ "</sv:node>"+ "</sv:node>";
    try {
      doImport(getTargetPath(),xml);
      Authorizable a=getUserManager().getAuthorizable("g1");
      if (a.isGroup()) {
        assertNotDeclaredMember((Group)a,id,getImportSession());
      }
 else {
        fail("'g1' was not imported as Group.");
      }
    }
  finally {
      getImportSession().refresh(false);
    }
  }
}

</code></pre>

<br>
<pre class="type-12 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testImportSelfAsGroupIgnore() throws Exception {
  String invalidId="0120a4f9-196a-3f9e-b9f5-23f31f914da7";
  String xml="<?xml version=\"1.0\" encoding=\"UTF-8\"?>" + "<sv:node sv:name=\"gFolder\" xmlns:mix=\"http://www.jcp.org/jcr/mix/1.0\" xmlns:nt=\"http://www.jcp.org/jcr/nt/1.0\" xmlns:fn_old=\"http://www.w3.org/2004/10/xpath-functions\" xmlns:fn=\"http://www.w3.org/2005/xpath-functions\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:sv=\"http://www.jcp.org/jcr/sv/1.0\" xmlns:rep=\"internal\" xmlns:jcr=\"http://www.jcp.org/jcr/1.0\">" + "   <sv:property sv:name=\"jcr:primaryType\" sv:type=\"Name\"><sv:value>rep:AuthorizableFolder</sv:value></sv:property>"+ "<sv:node sv:name=\"g1\"><sv:property sv:name=\"jcr:primaryType\" sv:type=\"Name\"><sv:value>rep:Group</sv:value></sv:property>"+ "   <sv:property sv:name=\"jcr:uuid\" sv:type=\"String\"><sv:value>" + invalidId + "</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:principalName\" sv:type=\"String\"><sv:value>g1</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:members\" sv:type=\"WeakReference\"><sv:value>"+ invalidId+ "</sv:value></sv:property>"+ "</sv:node>"+ "</sv:node>";
  doImport(getTargetPath(),xml);
  Authorizable a=getUserManager().getAuthorizable("g1");
  if (a.isGroup()) {
    assertNotDeclaredMember((Group)a,invalidId,getImportSession());
  }
 else {
    fail("'g1' was not imported as Group.");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.user.RemappingTest </h4><pre class="type-12 type-6 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetProperty() throws Exception {
  for (  String relPath : unmappedPaths) {
    user.setProperty(relPath,nameValue);
    user.setProperty(relPath,new Value[]{nameValue});
  }
  superuser.save();
  session.refresh(false);
  for (  String relPath : mappedPaths) {
    Value[] values=authorizable.getProperty(relPath);
    assertNotNull(values);
    assertEquals(1,values.length);
    if (PropertyType.STRING == values[0].getType()) {
      assertEquals("value",values[0].getString());
    }
 else {
      assertEquals("my:value",values[0].getString());
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.user.UserImportIgnoreTest </h4><pre class="type-13 type-12 type-5 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testImportInvalidImpersonationIgnore() throws Exception {
  List<String> invalid=new ArrayList<String>();
  invalid.add("anybody");
  invalid.add("administrators");
  invalid.add("t");
  for (  String principalName : invalid) {
    String xml="<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n" + "<sv:node sv:name=\"t\" xmlns:mix=\"http://www.jcp.org/jcr/mix/1.0\" xmlns:nt=\"http://www.jcp.org/jcr/nt/1.0\" xmlns:fn_old=\"http://www.w3.org/2004/10/xpath-functions\" xmlns:fn=\"http://www.w3.org/2005/xpath-functions\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:sv=\"http://www.jcp.org/jcr/sv/1.0\" xmlns:rep=\"internal\" xmlns:jcr=\"http://www.jcp.org/jcr/1.0\">" + "   <sv:property sv:name=\"jcr:primaryType\" sv:type=\"Name\"><sv:value>rep:User</sv:value></sv:property>"+ "   <sv:property sv:name=\"jcr:uuid\" sv:type=\"String\"><sv:value>e358efa4-89f5-3062-b10d-d7316b65649e</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:password\" sv:type=\"String\"><sv:value>{sha1}8efd86fb78a56a5145ed7739dcb00c78581c5375</sv:value></sv:property>"+ "   <sv:property sv:name=\"rep:principalName\" sv:type=\"String\"><sv:value>t</sv:value></sv:property><sv:property sv:name=\"rep:impersonators\" sv:type=\"String\"><sv:value>" + principalName + "</sv:value></sv:property>"+ "</sv:node>";
    Subject subj=new Subject();
    subj.getPrincipals().add(new PrincipalImpl(principalName));
    try {
      doImport(getTargetPath(),xml);
      Authorizable a=getUserManager().getAuthorizable("t");
      if (!a.isGroup()) {
        Impersonation imp=((User)a).getImpersonation();
        Subject s=new Subject();
        s.getPrincipals().add(new PrincipalImpl(principalName));
        assertFalse(imp.allows(s));
        for (PrincipalIterator it=imp.getImpersonators(); it.hasNext(); ) {
          assertFalse(principalName.equals(it.nextPrincipal().getName()));
        }
      }
 else {
        fail("Importing 't' didn't create a User.");
      }
    }
  finally {
      getImportSession().refresh(false);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.security.user.UserQueryTest </h4><pre class="type-13 type-9 type-12 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * @see <a href="https://issues.apache.org/jira/browse/OAK-2266">OAK-2266</a>
 */
@Test public void testSortOrderIgnoreCaseAscending() throws Exception {
  Iterator<Authorizable> result=userMgr.findAuthorizables(new Query(){
    public <T>void build(    QueryBuilder<T> builder){
      builder.setCondition(builder.exists("@continent"));
      builder.setSortOrder("@continent",QueryBuilder.Direction.ASCENDING,true);
    }
  }
);
  Iterator<String> continents=ImmutableList.of("africa","america","australia").iterator();
  String expected=continents.next();
  while (result.hasNext()) {
    Authorizable a=result.next();
    String continent=a.getProperty("continent")[0].getString().toLowerCase();
    if (!continent.equals(expected)) {
      expected=continents.next();
      assertEquals(expected,continent);
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-9 type-12 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * @see <a href="https://issues.apache.org/jira/browse/OAK-2266">OAK-2266</a>
 */
@Test() public void testSortOrderRespectCaseAscending() throws Exception {
  Iterator<Authorizable> result=userMgr.findAuthorizables(new Query(){
    public <T>void build(    QueryBuilder<T> builder){
      builder.setCondition(builder.exists("@continent"));
      builder.setSortOrder("@continent",QueryBuilder.Direction.ASCENDING,false);
    }
  }
);
  Iterator<String> continents=ImmutableList.of("Africa","America","africa","australia").iterator();
  String expected=continents.next();
  while (result.hasNext()) {
    Authorizable a=result.next();
    String continent=a.getProperty("continent")[0].getString();
    if (!continent.equals(expected)) {
      expected=continents.next();
      assertEquals(expected,continent);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.BasicDocumentStoreTest </h4><pre class="type-13 type-12 type-5 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreatePartialFailure(){
  String bid=this.getClass().getName() + ".testCreatePartialFailure-";
  int cnt=10;
  assertTrue(cnt > 8);
  for (int i=0; i < cnt; i++) {
    super.ds.remove(Collection.NODES,bid + i);
    removeMe.add(bid + i);
  }
  int pre=cnt / 2;
  UpdateOp up=new UpdateOp(bid + pre,true);
  up.set("_id",bid + pre);
  up.set("foo","bar");
  assertTrue(super.ds.create(Collection.NODES,Collections.singletonList(up)));
  Set<String> toCreate=new HashSet<String>();
  Set<String> toCreateFailEarly=new HashSet<String>();
  List<UpdateOp> ups=new ArrayList<UpdateOp>();
  for (int i=0; i < cnt; i++) {
    UpdateOp op=new UpdateOp(bid + i,true);
    op.set("_id",bid + i);
    op.set("foo","qux");
    ups.add(op);
    if (i != pre) {
      toCreate.add(bid + i);
    }
    if (i < pre) {
      toCreateFailEarly.add(bid + i);
    }
  }
  assertFalse(super.ds.create(Collection.NODES,ups));
  Set<String> created=new HashSet<String>();
  for (int i=0; i < cnt; i++) {
    boolean present=null != super.ds.find(Collection.NODES,bid + i,0);
    if (i == pre && !present) {
      fail(super.dsname + ": batch update removed previously existing node " + (bid + i));
    }
 else     if (present && i != pre) {
      created.add(bid + i);
    }
  }
  toCreate.removeAll(created);
  if (created.isEmpty()) {
    LOG.info(super.dsname + ": create() apparently is atomic");
  }
 else   if (created.size() == toCreate.size()) {
    LOG.info(super.dsname + ": create() apparently is best-effort");
  }
 else   if (created.equals(toCreateFailEarly)) {
    LOG.info(super.dsname + ": create() stops at first failure");
  }
 else {
    LOG.info(super.dsname + ": create() created: " + created+ ", missing: "+ toCreate);
  }
}

</code></pre>

<br>
<pre class="type-13 type-9 type-12 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies whether objects are null
"></span><br>
@Test public void testMaxProperty(){
  int min=0;
  int max=1024 * 1024 * 8;
  int test=0;
  int last=0;
  while (max - min >= 256) {
    if (test == 0) {
      test=max;
    }
 else {
      test=(max + min) / 2;
    }
    String id=this.getClass().getName() + ".testMaxProperty-" + test;
    String pval=generateString(test,true);
    UpdateOp up=new UpdateOp(id,true);
    up.set("_id",id);
    up.set("foo",pval);
    boolean success=super.ds.create(Collection.NODES,Collections.singletonList(up));
    if (success) {
      NodeDocument findme=super.ds.find(Collection.NODES,id,0);
      assertNotNull("failed to retrieve previously stored document",findme);
      super.ds.remove(Collection.NODES,id);
      min=test;
      last=test;
    }
 else {
      max=test;
    }
  }
  LOG.info("max prop length for " + super.dsname + " was "+ last);
}

</code></pre>

<br>
<pre class="type-9 type-12 type-5 type-6 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void removeWithCondition() throws Exception {
  Set<String> existingDocs=new HashSet<String>();
  for (  NodeDocument doc : Utils.getAllDocuments(ds)) {
    existingDocs.add(doc.getPath());
  }
  List<UpdateOp> docs=Lists.newArrayList();
  docs.add(newDocument("/foo",100));
  removeMe.add(Utils.getIdFromPath("/foo"));
  docs.add(newDocument("/bar",200));
  removeMe.add(Utils.getIdFromPath("/bar"));
  docs.add(newDocument("/baz",300));
  removeMe.add(Utils.getIdFromPath("/baz"));
  ds.create(Collection.NODES,docs);
  for (  UpdateOp op : docs) {
    assertNotNull(ds.find(Collection.NODES,op.getId()));
  }
  Map<String,Map<Key,Condition>> toRemove=Maps.newHashMap();
  removeDocument(toRemove,"/foo",100);
  removeDocument(toRemove,"/bar",300);
  removeDocument(toRemove,"/qux",100);
  removeDocument(toRemove,"/baz",300);
  int removed=ds.remove(Collection.NODES,toRemove);
  assertEquals(2,removed);
  assertNotNull(ds.find(Collection.NODES,Utils.getIdFromPath("/bar")));
  for (  NodeDocument doc : Utils.getAllDocuments(ds)) {
    if (!doc.getPath().equals("/bar") && !existingDocs.contains(doc.getPath())) {
      fail("document must not exist: " + doc.getId());
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-12 type-7 type-6 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testModifyDeletedOnce(){
  String id=this.getClass().getName() + ".testModifyDeletedOnce";
  UpdateOp up=new UpdateOp(id,true);
  up.set("_id",id);
  up.set(NodeDocument.DELETED_ONCE,Boolean.FALSE);
  boolean success=super.ds.create(Collection.NODES,Collections.singletonList(up));
  assertTrue(success);
  removeMe.add(id);
  NodeDocument nd=super.ds.find(Collection.NODES,id,0);
  assertNotNull(nd);
  Boolean dovalue=(Boolean)nd.get(NodeDocument.DELETED_ONCE);
  if (dovalue != null) {
    assertEquals(dovalue.booleanValue(),Boolean.FALSE);
  }
  up=new UpdateOp(id,false);
  up.set("_id",id);
  up.set(NodeDocument.DELETED_ONCE,Boolean.TRUE);
  super.ds.update(Collection.NODES,Collections.singletonList(id),up);
  nd=super.ds.find(Collection.NODES,id,0);
  assertNotNull(nd);
  assertNotNull(nd.get(NodeDocument.DELETED_ONCE));
  assertEquals(((Boolean)nd.get(NodeDocument.DELETED_ONCE)).booleanValue(),Boolean.TRUE);
}

</code></pre>

<br>
<pre class="type-9 type-12 type-5 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInterestingPropLengths() throws UnsupportedEncodingException {
  int lengths[]={1,10,100,1000,2000,3000,4000,5000,6000,7000,8000,9000,10000,11000,12000,13000,14000,15000,16000,20000};
  for (  int test : lengths) {
    String id=this.getClass().getName() + ".testInterestingPropLengths-" + test;
    String pval=generateString(test,true);
    UpdateOp up=new UpdateOp(id,true);
    up.set("_id",id);
    up.set("foo",pval);
    super.ds.remove(Collection.NODES,id);
    boolean success=super.ds.create(Collection.NODES,Collections.singletonList(up));
    assertTrue("failed to insert a document with property of length " + test + "(ASCII) in "+ super.dsname,success);
    super.ds.remove(Collection.NODES,id);
  }
  for (  int test : lengths) {
    String id=this.getClass().getName() + ".testInterestingPropLengths-" + test;
    String pval=generateString(test,false);
    UpdateOp up=new UpdateOp(id,true);
    up.set("_id",id);
    up.set("foo",pval);
    super.ds.remove(Collection.NODES,id);
    boolean success=super.ds.create(Collection.NODES,Collections.singletonList(up));
    assertTrue("failed to insert a document with property of length " + test + " (potentially non-ASCII, actual octet length with UTF-8 encoding: "+ pval.getBytes("UTF-8").length+ ") in "+ super.dsname,success);
    if (success) {
      try {
        super.ds.findAndUpdate(Collection.NODES,up);
      }
 catch (      Exception ex) {
        ex.printStackTrace(System.err);
        fail("failed to update a document with property of length " + test + " (potentially non-ASCII, actual octet length with UTF-8 encoding: "+ pval.getBytes("UTF-8").length+ ") in "+ super.dsname);
      }
    }
    super.ds.remove(Collection.NODES,id);
  }
}

</code></pre>

<br>
<pre class="type-9 type-12 type-5 type-7 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testQueryCollation(){
  String base="2:/" + this.getClass().getName() + ".testQueryCollation";
  List<UpdateOp> creates=new ArrayList<UpdateOp>();
  List<String> expected=new ArrayList<String>();
  for (  char c : "!\"#$%&'()*+,-./0123456789:;<=>?@AZ[\\]^_`az{|}~".toCharArray()) {
    String id=base + c;
    UpdateOp up=new UpdateOp(id,true);
    up.set("_id",id);
    creates.add(up);
    removeMe.add(id);
    id=base + "/" + c;
    up=new UpdateOp(id,true);
    up.set("_id",id);
    creates.add(up);
    expected.add(id);
    removeMe.add(id);
  }
  boolean success=super.ds.create(Collection.NODES,creates);
  assertTrue("documents not created",success);
  List<String> result=getKeys(ds.query(Collection.NODES,base + "/",base + "0",1000));
  List<String> diff=new ArrayList<String>();
  diff.addAll(result);
  diff.removeAll(expected);
  if (!diff.isEmpty()) {
    fail("unexpected query results (broken collation handling in persistence?): " + diff);
  }
  diff=new ArrayList<String>();
  diff.addAll(expected);
  diff.removeAll(result);
  if (!diff.isEmpty()) {
    fail("missing query results (broken collation handling in persistence?): " + diff);
  }
  assertEquals("incorrect result ordering in query result (broken collation handling in persistence?)",expected,result);
}

</code></pre>

<br>
<pre class="type-9 type-12 type-7 type-6 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCollisionsModCount(){
  String id=this.getClass().getName() + ".testCollisionsModCount";
  NodeDocument nd=super.ds.find(Collection.NODES,id);
  if (nd != null) {
    super.ds.remove(Collection.NODES,id);
  }
  Revision revision=Revision.fromString("r0-0-1");
  UpdateOp up=new UpdateOp(id,true);
  up.set("_id",id);
  up.setMapEntry("_collisions",revision,"foo");
  assertTrue(super.ds.create(Collection.NODES,Collections.singletonList(up)));
  removeMe.add(id);
  nd=super.ds.find(Collection.NODES,id);
  assertNotNull(nd);
  Number cmc=(Number)nd.get("_collisionsModCount");
  if (cmc == null) {
  }
 else {
    Revision revision2=Revision.fromString("r0-0-2");
    UpdateOp up2=new UpdateOp(id,false);
    up2.set("_id",id);
    up2.setMapEntry("_collisions",revision2,"foobar");
    NodeDocument old=super.ds.findAndUpdate(Collection.NODES,up2);
    assertNotNull(old);
    nd=super.ds.find(Collection.NODES,id,0);
    assertNotNull(nd);
    Number cmc2=(Number)nd.get("_collisionsModCount");
    assertNotNull(cmc2);
    assertTrue(cmc2.longValue() > cmc.longValue());
    UpdateOp up3=new UpdateOp(id,false);
    up3.set("_id",id);
    up3.set("foo","bar");
    old=super.ds.findAndUpdate(Collection.NODES,up3);
    assertNotNull(old);
    nd=super.ds.find(Collection.NODES,id,0);
    assertNotNull(nd);
    Number cmc3=(Number)nd.get("_collisionsModCount");
    assertNotNull(cmc3);
    assertTrue(cmc2.longValue() == cmc3.longValue());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.BulkCreateOrUpdateClusterTest </h4><pre class="type-13 type-9 type-12 type-5 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Run multiple batch updates concurrently. Each thread modifies only its own documents.
 */
@Test public void testConcurrentNoConflict() throws InterruptedException {
  int amountPerThread=100;
  int threadCount=10;
  int amount=amountPerThread * threadCount;
  List<UpdateOp> updates=new ArrayList<UpdateOp>(amount);
  for (int i=0; i < amount; i+=2) {
    String id=this.getClass().getName() + ".testConcurrentNoConflict" + i;
    UpdateOp up=new UpdateOp(id,true);
    up.set("_id",id);
    up.set("prop",100);
    updates.add(up);
  }
  ds1.create(Collection.NODES,updates);
  final Set<Exception> exceptions=new HashSet<Exception>();
  List<Thread> threads=new ArrayList<Thread>();
  final Map<String,NodeDocument> oldDocs=new ConcurrentHashMap<String,NodeDocument>();
  for (int i=0; i < threadCount; i++) {
    final DocumentStore selectedDs=i % 2 == 0 ? this.ds1 : this.ds2;
    final List<UpdateOp> threadUpdates=new ArrayList<UpdateOp>(amountPerThread);
    for (int j=0; j < amountPerThread; j++) {
      String id=this.getClass().getName() + ".testConcurrentNoConflict" + (j + i * amountPerThread);
      UpdateOp up=new UpdateOp(id,true);
      up.set("_id",id);
      up.set("prop",200 + i + j);
      threadUpdates.add(up);
      removeMe.add(id);
    }
    shuffle(threadUpdates);
    threads.add(new Thread(){
      public void run(){
        try {
          for (          NodeDocument d : selectedDs.createOrUpdate(Collection.NODES,threadUpdates)) {
            if (d == null) {
              continue;
            }
            oldDocs.put(d.getId(),d);
          }
        }
 catch (        Exception ex) {
          exceptions.add(ex);
        }
      }
    }
);
  }
  for (  Thread t : threads) {
    t.start();
  }
  for (  Thread t : threads) {
    t.join();
    if (t.isAlive()) {
      fail("Thread hasn't finished in 10s");
    }
  }
  if (!exceptions.isEmpty()) {
    String msg=exceptions.size() + " out of " + threadCount+ " failed with exceptions, the first being: "+ exceptions.iterator().next();
    fail(msg);
  }
  for (int i=0; i < amount; i++) {
    String id=this.getClass().getName() + ".testConcurrentNoConflict" + i;
    NodeDocument oldDoc=oldDocs.get(id);
    NodeDocument newDoc;
    if (i % 2 == 1) {
      assertNull("The returned value should be null for created doc",oldDoc);
      newDoc=ds1.find(Collection.NODES,id);
    }
 else {
      assertNotNull("The returned doc shouldn't be null for updated doc",oldDoc);
      assertEquals("The old value is not correct",100l,oldDoc.get("prop"));
      newDoc=ds2.find(Collection.NODES,id);
    }
    assertNotEquals("The document hasn't been updated",100l,newDoc.get("prop"));
  }
}

</code></pre>

<br>
<pre class="type-13 type-9 type-12 type-5 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Run multiple batch updates concurrently. Each thread modifies the same set of documents.
 */
@Test public void testConcurrentWithConflict() throws InterruptedException {
  int threadCount=10;
  int amount=500;
  List<UpdateOp> updates=new ArrayList<UpdateOp>(amount);
  for (int i=0; i < amount; i+=2) {
    String id=this.getClass().getName() + ".testConcurrentNoConflict" + i;
    UpdateOp up=new UpdateOp(id,true);
    up.set("_id",id);
    up.set("prop",100);
    updates.add(up);
    removeMe.add(id);
  }
  ds1.create(Collection.NODES,updates);
  final Set<Exception> exceptions=new HashSet<Exception>();
  List<Thread> threads=new ArrayList<Thread>();
  for (int i=0; i < threadCount; i++) {
    final DocumentStore selectedDs=i % 2 == 0 ? this.ds1 : this.ds2;
    final List<UpdateOp> threadUpdates=new ArrayList<UpdateOp>(amount);
    for (int j=0; j < amount; j++) {
      String id=this.getClass().getName() + ".testConcurrentWithConflict" + j;
      UpdateOp up=new UpdateOp(id,true);
      up.set("_id",id);
      up.set("prop",200 + i * amount + j);
      threadUpdates.add(up);
      removeMe.add(id);
    }
    shuffle(threadUpdates);
    threads.add(new Thread(){
      public void run(){
        try {
          selectedDs.createOrUpdate(Collection.NODES,threadUpdates);
        }
 catch (        Exception ex) {
          exceptions.add(ex);
        }
      }
    }
);
  }
  for (  Thread t : threads) {
    t.start();
  }
  for (  Thread t : threads) {
    t.join(10000);
    if (t.isAlive()) {
      fail("Thread hasn't finished in 10s");
    }
  }
  if (!exceptions.isEmpty()) {
    String msg=exceptions.size() + " out of " + threadCount+ " failed with exceptions, the first being: "+ exceptions.iterator().next();
    fail(msg);
  }
  for (int i=0; i < amount; i++) {
    String id=this.getClass().getName() + ".testConcurrentWithConflict" + i;
    NodeDocument newDoc=ds1.find(Collection.NODES,id);
    assertNotNull("The document hasn't been inserted",newDoc);
    assertNotEquals("The document hasn't been updated",100l,newDoc.get("prop"));
    newDoc=ds2.find(Collection.NODES,id);
    assertNotNull("The document hasn't been inserted",newDoc);
    assertNotEquals("The document hasn't been updated",100l,newDoc.get("prop"));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.BulkCreateOrUpdateTest </h4><pre class="type-13 type-9 type-12 type-5 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Run multiple batch updates concurrently. Each thread modifies only its own documents.
 */
@Test public void testConcurrentNoConflict() throws InterruptedException {
  int amountPerThread=100;
  int threadCount=10;
  int amount=amountPerThread * threadCount;
  List<UpdateOp> updates=new ArrayList<UpdateOp>(amount);
  for (int i=0; i < amount; i+=2) {
    String id=this.getClass().getName() + ".testConcurrentNoConflict" + i;
    UpdateOp up=new UpdateOp(id,true);
    up.set("_id",id);
    up.set("prop",100);
    updates.add(up);
  }
  ds.create(Collection.NODES,updates);
  List<Thread> threads=new ArrayList<Thread>();
  final Map<String,NodeDocument> oldDocs=new ConcurrentHashMap<String,NodeDocument>();
  for (int i=0; i < threadCount; i++) {
    final List<UpdateOp> threadUpdates=new ArrayList<UpdateOp>(amountPerThread);
    for (int j=0; j < amountPerThread; j++) {
      String id=this.getClass().getName() + ".testConcurrentNoConflict" + (j + i * amountPerThread);
      UpdateOp up=new UpdateOp(id,true);
      up.set("_id",id);
      up.set("prop",200 + i + j);
      threadUpdates.add(up);
      removeMe.add(id);
    }
    shuffle(threadUpdates);
    threads.add(new Thread(){
      public void run(){
        for (        NodeDocument d : ds.createOrUpdate(Collection.NODES,threadUpdates)) {
          if (d == null) {
            continue;
          }
          oldDocs.put(d.getId(),d);
        }
      }
    }
);
  }
  for (  Thread t : threads) {
    t.start();
  }
  for (  Thread t : threads) {
    t.join();
    if (t.isAlive()) {
      fail("Thread hasn't finished in 10s");
    }
  }
  for (int i=0; i < amount; i++) {
    String id=this.getClass().getName() + ".testConcurrentNoConflict" + i;
    NodeDocument oldDoc=oldDocs.get(id);
    NodeDocument newDoc=ds.find(Collection.NODES,id);
    if (i % 2 == 1) {
      assertNull("The returned value should be null for created doc",oldDoc);
    }
 else {
      assertNotNull("The returned doc shouldn't be null for updated doc",oldDoc);
      assertEquals("The old value is not correct",100l,oldDoc.get("prop"));
    }
    assertNotEquals("The document hasn't been updated",100l,newDoc.get("prop"));
  }
}

</code></pre>

<br>
<pre class="type-13 type-9 type-12 type-5 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Run multiple batch updates concurrently. Each thread modifies the same set of documents.
 */
@Test public void testConcurrentWithConflict() throws InterruptedException {
  int threadCount=10;
  int amount=500;
  List<UpdateOp> updates=new ArrayList<UpdateOp>(amount);
  for (int i=0; i < amount; i+=2) {
    String id=this.getClass().getName() + ".testConcurrentNoConflict" + i;
    UpdateOp up=new UpdateOp(id,true);
    up.set("_id",id);
    up.set("prop",100);
    updates.add(up);
    removeMe.add(id);
  }
  ds.create(Collection.NODES,updates);
  final Set<Exception> exceptions=new HashSet<Exception>();
  List<Thread> threads=new ArrayList<Thread>();
  for (int i=0; i < threadCount; i++) {
    final List<UpdateOp> threadUpdates=new ArrayList<UpdateOp>(amount);
    for (int j=0; j < amount; j++) {
      String id=this.getClass().getName() + ".testConcurrentWithConflict" + j;
      UpdateOp up=new UpdateOp(id,true);
      up.set("_id",id);
      up.set("prop",200 + i * amount + j);
      threadUpdates.add(up);
      removeMe.add(id);
    }
    shuffle(threadUpdates);
    threads.add(new Thread(){
      public void run(){
        try {
          ds.createOrUpdate(Collection.NODES,threadUpdates);
        }
 catch (        Exception ex) {
          exceptions.add(ex);
        }
      }
    }
);
  }
  for (  Thread t : threads) {
    t.start();
  }
  for (  Thread t : threads) {
    t.join(10000);
    if (t.isAlive()) {
      fail("Thread hasn't finished in 10s");
    }
  }
  if (!exceptions.isEmpty()) {
    String msg=exceptions.size() + " out of " + threadCount+ " failed with exceptions, the first being: "+ exceptions.iterator().next();
    fail(msg);
  }
  for (int i=0; i < amount; i++) {
    String id=this.getClass().getName() + ".testConcurrentWithConflict" + i;
    NodeDocument newDoc=ds.find(Collection.NODES,id);
    assertNotNull("The document hasn't been inserted",newDoc);
    assertNotEquals("The document hasn't been updated",100l,newDoc.get("prop"));
  }
}

</code></pre>

<br>
<pre class="type-13 type-9 type-12 type-6 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This method creates or updates multiple items using createOrUpdate()
 * method. New items have odd indexes and updates items have even indexes.
 * The return value should be a list of old documents (for the updates) or
 * nulls (for the inserts).
 */
@Test public void testCreateOrUpdateMultiple(){
  int amount=100;
  List<UpdateOp> updates=new ArrayList<UpdateOp>(amount);
  for (int i=0; i < amount; i+=2) {
    String id=this.getClass().getName() + ".testCreateOrUpdateMultiple" + i;
    UpdateOp up=new UpdateOp(id,true);
    up.set("_id",id);
    up.set("prop",100);
    updates.add(up);
    removeMe.add(id);
  }
  ds.create(Collection.NODES,updates);
  updates.clear();
  for (int i=0; i < amount; i++) {
    String id=this.getClass().getName() + ".testCreateOrUpdateMultiple" + i;
    UpdateOp up=new UpdateOp(id,true);
    up.set("_id",id);
    up.set("prop",200);
    updates.add(up);
    removeMe.add(id);
  }
  List<NodeDocument> docs=ds.createOrUpdate(Collection.NODES,updates);
  assertEquals(amount,docs.size());
  for (int i=0; i < amount; i++) {
    String id=this.getClass().getName() + ".testCreateOrUpdateMultiple" + i;
    NodeDocument oldDoc=docs.get(i);
    NodeDocument newDoc=ds.find(Collection.NODES,id);
    if (i % 2 == 1) {
      assertNull("The returned value should be null for created doc",oldDoc);
    }
 else {
      assertNotNull("The returned doc shouldn't be null for updated doc",oldDoc);
      assertEquals("The old value is not correct",100l,oldDoc.get("prop"));
      assertEquals("The result list order is incorrect",updates.get(i).getId(),oldDoc.getId());
    }
    assertEquals("The document hasn't been updated",200l,newDoc.get("prop"));
  }
}

</code></pre>

<br>
<pre class="type-13 type-9 type-12 type-7 type-6 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This method adds a few updateOperations modifying the same document.
 */
@Test public void testUpdateSameDocument(){
  final int amount=5;
  List<UpdateOp> updates=new ArrayList<UpdateOp>(amount);
  String id=this.getClass().getName() + ".testUpdateSameDocument";
  removeMe.add(id);
  for (int i=0; i < amount; i++) {
    UpdateOp up=new UpdateOp(id,true);
    up.set("_id",id);
    up.set("update_id",i);
    up.set("prop_" + i,100);
    updates.add(up);
  }
  List<NodeDocument> docs=ds.createOrUpdate(Collection.NODES,updates);
  assertEquals(amount,docs.size());
  assertNull("The old value should be null for the first update",docs.get(0));
  Long prevModCount=null;
  for (int i=1; i < amount; i++) {
    Long modCount=docs.get(i).getModCount();
    if (prevModCount != null) {
      assertNotNull(modCount);
      assertTrue("_modCount, when present, must be increasing, but changed from " + prevModCount + " to "+ modCount,prevModCount.longValue() < modCount.longValue());
    }
    prevModCount=modCount;
    assertEquals("The old value is not correct",Long.valueOf(i - 1),docs.get(i).get("update_id"));
  }
  NodeDocument newDoc=ds.find(Collection.NODES,id);
  if (newDoc.getModCount() != null) {
    assertEquals("The final mod count is not correct",Long.valueOf(5),newDoc.getModCount());
  }
  for (int i=0; i < amount; i++) {
    assertEquals("The value is not correct",100l,newDoc.get("prop_" + i));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.ClusterViewDocumentTest </h4><pre class="type-13 type-9 type-12 type-7 type-6 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testHistory() throws Exception {
  final int localClusterId=1;
  final DocumentNodeStore ns=createMK(localClusterId).nodeStore;
  final Set<Integer> activeIds=new HashSet<Integer>();
  activeIds.add(localClusterId);
  ClusterViewDocument.readOrUpdate(ns,activeIds,null,null);
  final int LOOP_CNT=100;
  for (int i=0; i < LOOP_CNT; i++) {
    activeIds.add(i + 2);
    ClusterViewDocument result=ClusterViewDocument.readOrUpdate(ns,activeIds,null,null);
    assertNotNull(result);
    assertEquals(i + 2,result.getActiveIds().size());
    if (i < 10) {
      assertEquals(i + 1,result.getHistory().size());
    }
 else {
      assertTrue(result.getHistory().size() <= ClusterViewDocument.HISTORY_LIMIT);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.DocumentDiscoveryLiteServiceTest </h4><pre class="type-13 type-9 type-12 type-5 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * This test creates a large number of documentnodestores which it starts,
 * runs, stops in a random fashion, always testing to make sure the
 * clusterView is correct
 */
@Test public void testLargeStartStopFiesta() throws Throwable {
  logger.info("testLargeStartStopFiesta: start, seed=" + SEED);
  final List<SimplifiedInstance> instances=new LinkedList<SimplifiedInstance>();
  final Map<Integer,String> inactiveIds=new HashMap<Integer,String>();
  final Random random=new Random(SEED);
  final int LOOP_CNT=50;
  final int CHECK_EVERY=3;
  final int MAX_NUM_INSTANCES=8;
  for (int i=0; i < LOOP_CNT; i++) {
    if (i % CHECK_EVERY == 0) {
      checkFiestaState(instances,inactiveIds.keySet());
    }
    final int nextInt=random.nextInt(5);
    String workingDir=UUID.randomUUID().toString();
switch (nextInt) {
case 0:
{
        if (inactiveIds.size() > 0) {
          logger.info("Case 0 - reactivating an instance...");
          final int n=random.nextInt(inactiveIds.size());
          final Integer cid=new LinkedList<Integer>(inactiveIds.keySet()).get(n);
          final String reactivatedWorkingDir=inactiveIds.remove(cid);
          if (reactivatedWorkingDir == null) {
            fail("reactivatedWorkingDir null for n=" + n + ", cid="+ cid+ ", other inactives: "+ inactiveIds);
          }
          assertNotNull(reactivatedWorkingDir);
          logger.info("Case 0 - reactivated instance " + cid + ", workingDir="+ reactivatedWorkingDir);
          workingDir=reactivatedWorkingDir;
          logger.info("Case 0: creating instance");
          final SimplifiedInstance newInstance=createInstance(workingDir);
          if (newInstance.hasRandomMachineId()) {
            return;
          }
          newInstance.setLeastTimeout(5000,1000);
          newInstance.startSimulatingWrites(500);
          logger.info("Case 0: created instance: " + newInstance.ns.getClusterId());
          if (newInstance.ns.getClusterId() != cid) {
            logger.info("Case 0: reactivated instance did not take over cid - probably a testing artifact. expected cid: {}, actual cid: {}",cid,newInstance.ns.getClusterId());
            inactiveIds.put(cid,reactivatedWorkingDir);
            inactiveIds.remove(newInstance.ns.getClusterId());
          }
          instances.add(newInstance);
        }
        break;
      }
case 1:
{
      if (instances.size() < MAX_NUM_INSTANCES) {
        logger.info("Case 1: creating instance");
        final SimplifiedInstance newInstance=createInstance(workingDir);
        if (newInstance.hasRandomMachineId()) {
          return;
        }
        newInstance.setLeastTimeout(5000,1000);
        newInstance.startSimulatingWrites(500);
        logger.info("Case 1: created instance: " + newInstance.ns.getClusterId());
        instances.add(newInstance);
        inactiveIds.remove(newInstance.ns.getClusterId());
      }
      break;
    }
case 2:
{
    break;
  }
case 3:
{
  if (instances.size() > 1) {
    checkFiestaState(instances,inactiveIds.keySet());
    final SimplifiedInstance instance=instances.remove(random.nextInt(instances.size()));
    assertNotNull(instance.workingDir);
    logger.info("Case 3: Shutdown instance: " + instance.ns.getClusterId());
    inactiveIds.put(instance.ns.getClusterId(),instance.workingDir);
    instance.shutdown();
  }
  break;
}
case 4:
{
if (instances.size() > 1) {
  checkFiestaState(instances,inactiveIds.keySet());
  final SimplifiedInstance instance=instances.remove(random.nextInt(instances.size()));
  assertNotNull(instance.workingDir);
  logger.info("Case 4: Crashing instance: " + instance.ns.getClusterId());
  inactiveIds.put(instance.ns.getClusterId(),instance.workingDir);
  instance.addNode("/" + instance.ns.getClusterId() + "/stuffForRecovery/"+ random.nextInt(10000));
  instance.crash();
}
break;
}
}
}
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.DocumentNodeStoreTest </h4><pre class="type-9 type-12 type-5 type-6 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void readBranchCommit() throws Exception {
  final Set<String> readSet=Sets.newHashSet();
  DocumentStore store=new MemoryDocumentStore(){
    @Override public <T extends Document>T find(    Collection<T> collection,    String key){
      readSet.add(key);
      return super.find(collection,key);
    }
  }
;
  DocumentNodeStore ns=builderProvider.newBuilder().setDocumentStore(store).setAsyncDelay(0).getNodeStore();
  NodeBuilder builder=ns.getRoot().builder();
  String testId=Utils.getIdFromPath("/test");
  NodeBuilder test=builder.child("test");
  test.setProperty("p","value");
  int q=0;
  while (store.find(NODES,testId) == null) {
    test.setProperty("q",q++);
  }
  merge(ns,builder);
  for (int i=0; i < NUM_REVS_THRESHOLD; i++) {
    builder=ns.getRoot().builder();
    builder.child("test").setProperty("q",i);
    merge(ns,builder);
  }
  ns.runBackgroundOperations();
  NodeDocument doc=store.find(NODES,Utils.getIdFromPath("/test"));
  assertNotNull(doc);
  readSet.clear();
  doc.getNodeAtRevision(ns,ns.getHeadRevision(),null);
  for (  String id : Sets.newHashSet(readSet)) {
    doc=store.find(NODES,id);
    assertNotNull(doc);
    if (doc.isSplitDocument() && !doc.getMainPath().equals("/")) {
      fail("must not access previous document: " + id);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.DocumentSplitTest </h4><pre class="type-9 type-12 type-5 type-7 type-6 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void cascadingWithSplitRatio(){
  String id=Utils.getIdFromPath("/test");
  mk.commit("/","+\"test\":{}",null,null);
  DocumentStore store=mk.getDocumentStore();
  int clusterId=mk.getNodeStore().getClusterId();
  UpdateOp op=new UpdateOp(id,false);
  for (int i=0; i < 1000; i++) {
    Revision r=Revision.newRevision(2);
    op.setMapEntry("prop",r,"some long test value with many characters");
    NodeDocument.setRevision(op,r,"c");
  }
  store.findAndUpdate(NODES,op);
  NodeDocument doc=store.find(NODES,id);
  assertNotNull(doc);
  assertTrue(doc.getMemory() > NodeDocument.DOC_SIZE_THRESHOLD);
  for (int i=0; i < NUM_REVS_THRESHOLD / 2; i++) {
    Revision r=Revision.newRevision(clusterId);
    op.setMapEntry("prop",r,"value");
    NodeDocument.setRevision(op,r,"c");
  }
  TreeSet<Revision> prev=Sets.newTreeSet(StableRevisionComparator.INSTANCE);
  for (int i=0; i < PREV_SPLIT_FACTOR; i++) {
    Revision low=Revision.newRevision(clusterId);
    Revision high=Revision.newRevision(clusterId);
    prev.add(high);
    NodeDocument.setPrevious(op,new Range(high,low,0));
  }
  store.findAndUpdate(NODES,op);
  doc=store.find(NODES,id);
  assertNotNull(doc);
  List<UpdateOp> splitOps=Lists.newArrayList(doc.split(mk.getNodeStore(),mk.getNodeStore().getHeadRevision()));
  assertEquals(2,splitOps.size());
  op=splitOps.get(0);
  String newPrevId=Utils.getPreviousIdFor("/test",prev.last(),1);
  assertEquals(newPrevId,op.getId());
  op=splitOps.get(1);
  assertEquals(id,op.getId());
  for (  Map.Entry<Key,Operation> entry : op.getChanges().entrySet()) {
    Revision r=entry.getKey().getRevision();
    assertNotNull(r);
    assertEquals(clusterId,r.getClusterId());
    if (entry.getKey().getName().equals("_prev")) {
      if (entry.getValue().type == REMOVE_MAP_ENTRY) {
        assertTrue(prev.contains(r));
      }
 else       if (entry.getValue().type == SET_MAP_ENTRY) {
        assertEquals(newPrevId,Utils.getPreviousIdFor("/test",r,1));
      }
 else {
        fail("unexpected update operation " + entry);
      }
    }
 else {
      fail("unexpected update operation " + entry);
    }
  }
}

</code></pre>

<br>
<pre class="type-12 type-7 type-6 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void cluster(){
  MemoryDocumentStore ds=new MemoryDocumentStore();
  MemoryBlobStore bs=new MemoryBlobStore();
  DocumentMK.Builder builder;
  builder=new DocumentMK.Builder();
  builder.setDocumentStore(ds).setBlobStore(bs).setAsyncDelay(0);
  DocumentMK mk1=builder.setClusterId(1).open();
  mk1.commit("/","+\"test\":{\"prop1\":0}",null,null);
  mk1.backgroundWrite();
  builder=new DocumentMK.Builder();
  builder.setDocumentStore(ds).setBlobStore(bs).setAsyncDelay(0);
  DocumentMK mk2=builder.setClusterId(2).open();
  builder=new DocumentMK.Builder();
  builder.setDocumentStore(ds).setBlobStore(bs).setAsyncDelay(0);
  DocumentMK mk3=builder.setClusterId(3).open();
  for (int i=0; i < NodeDocument.NUM_REVS_THRESHOLD; i++) {
    mk1.commit("/","^\"test/prop1\":" + i,null,null);
    mk2.commit("/","^\"test/prop2\":" + i,null,null);
    mk3.commit("/","^\"test/prop3\":" + i,null,null);
  }
  mk1.runBackgroundOperations();
  mk2.runBackgroundOperations();
  mk3.runBackgroundOperations();
  NodeDocument doc=ds.find(NODES,Utils.getIdFromPath("/test"));
  assertNotNull(doc);
  Map<Revision,String> revs=doc.getLocalRevisions();
  assertEquals(3,revs.size());
  revs=doc.getValueMap("_revisions");
  assertEquals(3 * NodeDocument.NUM_REVS_THRESHOLD,revs.size());
  Revision previous=null;
  for (  Map.Entry<Revision,String> entry : revs.entrySet()) {
    if (previous != null) {
      assertTrue(previous.compareRevisionTimeThenClusterId(entry.getKey()) > 0);
    }
    previous=entry.getKey();
  }
  mk1.dispose();
  mk2.dispose();
  mk3.dispose();
}

</code></pre>

<br>
<pre class="type-9 type-12 type-5 type-6 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void readLocalCommitInfo() throws Exception {
  final Set<String> readSet=Sets.newHashSet();
  DocumentStore store=new MemoryDocumentStore(){
    @Override public <T extends Document>T find(    Collection<T> collection,    String key,    int maxCacheAge){
      readSet.add(key);
      return super.find(collection,key,maxCacheAge);
    }
  }
;
  DocumentNodeStore ns=new DocumentMK.Builder().setDocumentStore(store).setAsyncDelay(0).getNodeStore();
  NodeBuilder builder=ns.getRoot().builder();
  builder.child("test");
  ns.merge(builder,EmptyHook.INSTANCE,CommitInfo.EMPTY);
  for (int i=0; i < NUM_REVS_THRESHOLD; i++) {
    builder=ns.getRoot().builder();
    builder.setProperty("p",i);
    builder.child("test").setProperty("p",i);
    builder.child("test").setProperty("q",i);
    ns.merge(builder,EmptyHook.INSTANCE,CommitInfo.EMPTY);
  }
  builder=ns.getRoot().builder();
  builder.child("test").removeProperty("q");
  ns.merge(builder,EmptyHook.INSTANCE,CommitInfo.EMPTY);
  ns.runBackgroundOperations();
  NodeDocument doc=store.find(NODES,Utils.getIdFromPath("/test"));
  assertNotNull(doc);
  readSet.clear();
  doc.getNodeAtRevision(ns,ns.getHeadRevision(),null);
  for (  String id : Sets.newHashSet(readSet)) {
    doc=store.find(NODES,id);
    assertNotNull(doc);
    if (doc.isSplitDocument() && !doc.getMainPath().equals("/")) {
      fail("must not access previous document: " + id);
    }
  }
  ns.dispose();
}

</code></pre>

<br>
<pre class="type-9 type-12 type-7 type-6 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void splitDeleted() throws Exception {
  DocumentStore store=mk.getDocumentStore();
  DocumentNodeStore ns=mk.getNodeStore();
  Set<Revision> revisions=Sets.newHashSet();
  mk.commit("/","+\"foo\":{}",null,null);
  NodeDocument doc=store.find(NODES,Utils.getIdFromPath("/foo"));
  assertNotNull(doc);
  revisions.addAll(doc.getLocalRevisions().keySet());
  boolean create=false;
  while (revisions.size() <= NodeDocument.NUM_REVS_THRESHOLD) {
    if (create) {
      revisions.add(Revision.fromString(mk.commit("/","+\"foo\":{}",null,null)));
    }
 else {
      revisions.add(Revision.fromString(mk.commit("/","-\"foo\"",null,null)));
    }
    create=!create;
  }
  mk.runBackgroundOperations();
  String head=mk.getHeadRevision();
  doc=store.find(NODES,Utils.getIdFromPath("/foo"));
  assertNotNull(doc);
  Map<Revision,String> deleted=doc.getLocalDeleted();
  assertEquals(1,deleted.size());
  for (  Revision rev : revisions) {
    assertTrue("document should contain revision (or have revision in commit root path):" + rev,doc.containsRevision(rev) || doc.getCommitRootPath(rev) != null);
    assertTrue(doc.isCommitted(rev));
  }
  DocumentNodeState node=ns.getNode("/foo",RevisionVector.fromString(head));
  if (create) {
    assertNull(node);
  }
 else {
    assertNotNull(node);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.MultiDocumentStoreTest </h4><pre class="type-13 type-9 type-12 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInterleavedBatchUpdate(){
  int amount=10;
  int halfAmount=amount / 2;
  String baseId=this.getClass().getName() + ".testInterleavedBatchUpdate";
  for (int i=0; i < amount; i++) {
    String id=baseId + "-" + i;
    NodeDocument nd=super.ds1.find(Collection.NODES,id);
    if (nd != null) {
      super.ds1.remove(Collection.NODES,id);
    }
    removeMe.add(id);
  }
{
    List<UpdateOp> ops=new ArrayList<UpdateOp>();
    for (int i=0; i < halfAmount; i++) {
      String id=baseId + "-" + i;
      UpdateOp up=new UpdateOp(id,true);
      up.set(Document.ID,id);
      up.set("_createdby","ds1");
      ops.add(up);
    }
    List<NodeDocument> result=super.ds1.createOrUpdate(Collection.NODES,ops);
    assertEquals(halfAmount,result.size());
    for (    NodeDocument doc : result) {
      assertNull(doc);
    }
  }
{
    List<UpdateOp> ops=new ArrayList<UpdateOp>();
    for (int i=0; i < amount; i++) {
      String id=baseId + "-" + i;
      UpdateOp up=new UpdateOp(id,true);
      up.set(Document.ID,id);
      up.set("_createdby","ds2");
      ops.add(up);
    }
    List<NodeDocument> result=super.ds2.createOrUpdate(Collection.NODES,ops);
    assertEquals(amount,result.size());
    for (    NodeDocument doc : result) {
      if (doc != null) {
        assertEquals("ds1",doc.get("_createdby"));
      }
    }
  }
  for (int i=0; i < amount; i++) {
    String id=baseId + "-" + i;
    NodeDocument doc=super.ds1.find(Collection.NODES,id,0);
    assertNotNull(doc);
    assertEquals("ds2",doc.get("_createdby"));
  }
}

</code></pre>

<br>
<pre class="type-9 type-12 type-5 type-6 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void concurrentBatchUpdate() throws Exception {
  final CountDownLatch ready=new CountDownLatch(2);
  final CountDownLatch go=new CountDownLatch(1);
  final List<String> ids=Lists.newArrayList();
  for (int i=0; i < 100; i++) {
    ids.add(Utils.getIdFromPath("/node-" + i));
  }
  removeMe.addAll(ids);
  ds1.remove(Collection.NODES,ids);
  final List<Exception> exceptions=synchronizedList(new ArrayList<Exception>());
  final Map<String,NodeDocument> result1=Maps.newHashMap();
  Thread t1=new Thread(new Runnable(){
    @Override public void run(){
      try {
        List<UpdateOp> ops=Lists.newArrayList();
        for (        String id : ids) {
          UpdateOp op=new UpdateOp(id,true);
          op.set(Document.ID,id);
          op.set("_t1","value");
          ops.add(op);
        }
        Collections.shuffle(ops);
        ready.countDown();
        go.await();
        List<NodeDocument> docs=ds1.createOrUpdate(Collection.NODES,ops);
        for (int i=0; i < ops.size(); i++) {
          UpdateOp op=ops.get(i);
          result1.put(op.getId(),docs.get(i));
        }
      }
 catch (      Exception e) {
        exceptions.add(e);
      }
    }
  }
,"t1");
  final Map<String,NodeDocument> result2=Maps.newHashMap();
  Thread t2=new Thread(new Runnable(){
    @Override public void run(){
      try {
        List<UpdateOp> ops=Lists.newArrayList();
        for (        String id : ids) {
          UpdateOp op=new UpdateOp(id,true);
          op.set(Document.ID,id);
          op.set("_t2","value");
          ops.add(op);
        }
        Collections.shuffle(ops);
        ready.countDown();
        go.await();
        List<NodeDocument> docs=ds2.createOrUpdate(Collection.NODES,ops);
        for (int i=0; i < ops.size(); i++) {
          UpdateOp op=ops.get(i);
          result2.put(op.getId(),docs.get(i));
        }
      }
 catch (      Exception e) {
        exceptions.add(e);
      }
    }
  }
,"t2");
  t1.start();
  t2.start();
  ready.await();
  go.countDown();
  t1.join();
  t2.join();
  for (  Exception e : exceptions) {
    fail(e.toString());
  }
  for (  String id : ids) {
    NodeDocument d1=result1.get(id);
    NodeDocument d2=result2.get(id);
    if (d1 != null) {
      if (d2 != null) {
        fail("found " + id + " in both result sets, modcounts are: "+ d1.getModCount()+ "/"+ d2.getModCount());
      }
    }
 else {
      assertNotNull("id " + id + " is in neither result set",d2);
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testChangeVisibility(){
  String id=this.getClass().getName() + ".testChangeVisibility";
  super.ds1.remove(Collection.NODES,id);
  UpdateOp up=new UpdateOp(id,true);
  up.set("_id",id);
  up.set("_foo",0);
  up.set("_bar",0);
  assertTrue(super.ds1.create(Collection.NODES,Collections.singletonList(up)));
  removeMe.add(id);
  NodeDocument orig=super.ds1.find(Collection.NODES,id);
  if (orig.getModCount() != null) {
    long origMc=orig.getModCount();
    UpdateOp up2=new UpdateOp(id,false);
    up2.set("_id",id);
    up2.increment("_foo",1L);
    super.ds2.update(Collection.NODES,Collections.singletonList(id),up2);
    NodeDocument ds2doc=super.ds2.find(Collection.NODES,id);
    long ds2Mc=ds2doc.getModCount();
    assertTrue("_modCount needs to be > " + origMc + " but was "+ ds2Mc,ds2Mc > origMc);
    UpdateOp up1=new UpdateOp(id,false);
    up1.set("_id",id);
    up1.increment("_bar",1L);
    super.ds1.update(Collection.NODES,Collections.singletonList(id),up1);
    NodeDocument ds1doc=super.ds1.find(Collection.NODES,id);
    long ds1Mc=ds1doc.getModCount();
    assertTrue("_modCount needs to be > " + ds2Mc + " but was "+ ds1Mc,ds1Mc > ds2Mc);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.RandomizedClusterTest </h4><pre class="type-13 type-12 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void addRemoveSet() throws Exception {
  for (int i=0; i < MK_COUNT; i++) {
    unseenChanges[i]=new HashSet<Integer>();
    mkList[i]=createMK(i);
    revList[i]=mkList[i].getHeadRevision();
  }
  HashMap<Integer,ClusterRev> revs=new HashMap<Integer,ClusterRev>();
  Random r=new Random(1);
  int operations=1000, nodeCount=10;
  int valueCount=10;
  int maxBackRev=20;
  log=new StringBuilder();
  try {
    int maskOk=0, maskFail=0;
    int opCount=6;
    nodeChange.clear();
    for (int i=0; i < operations; i++) {
      opId=i;
      mkId=r.nextInt(mkList.length);
      String node="t" + r.nextInt(nodeCount);
      String node2="t" + r.nextInt(nodeCount);
      String property="x";
      String value="" + r.nextInt(valueCount);
      String diff;
      int op=r.nextInt(opCount);
      if (i < 20) {
        op=0;
      }
      String result;
      boolean conflictExpected;
switch (op) {
case 0:
        diff="+ \"" + node + "\": { \""+ property+ "\": "+ value+ "}";
      log(diff);
    if (exists(node)) {
      log("already exists");
      result=null;
    }
 else {
      conflictExpected=isConflict(node);
      result=commit(diff,conflictExpected);
      if (result != null) {
        changes.put(i,Arrays.asList(new Op(mkId,node,value)));
        nodeChange.put(node,i);
      }
    }
  break;
case 1:
diff="- \"" + node + "\"";
log(diff);
if (exists(node)) {
conflictExpected=isConflict(node);
result=commit(diff,conflictExpected);
if (result != null) {
changes.put(i,Arrays.asList(new Op(mkId,node,null)));
nodeChange.put(node,i);
}
}
 else {
log("doesn't exist");
result=null;
}
break;
case 2:
diff="^ \"" + node + "/"+ property+ "\": "+ value;
log(diff);
if (exists(node)) {
conflictExpected=isConflict(node);
result=commit(diff,conflictExpected);
if (result != null) {
changes.put(i,Arrays.asList(new Op(mkId,node,value)));
nodeChange.put(node,i);
}
}
 else {
log("doesn't exist");
result=null;
}
break;
case 3:
diff="> \"" + node + "\": \""+ node2+ "\"";
log(diff);
if (exists(node) && !exists(node2)) {
conflictExpected=isConflict(node) | isConflict(node2);
result=commit(diff,conflictExpected);
if (result != null) {
value=getValue(mkId,i,node);
changes.put(i,Arrays.asList(new Op(mkId,node,null),new Op(mkId,node2,value)));
nodeChange.put(node,i);
nodeChange.put(node2,i);
}
}
 else {
log("source doesn't exist or target exists");
result=null;
}
break;
case 4:
if (isConflict(node)) {
result=null;
}
 else {
diff="* \"" + node + "\": \""+ node2+ "\"";
log(diff);
if (exists(node) && !exists(node2)) {
conflictExpected=isConflict(node2);
result=commit(diff,conflictExpected);
if (result != null) {
value=getValue(mkId,i,node);
changes.put(i,Arrays.asList(new Op(mkId,node2,value)));
nodeChange.put(node2,i);
}
}
 else {
log("source doesn't exist or target exists");
result=null;
}
}
break;
case 5:
log("sync/refresh");
syncAndRefreshAllClusterNodes();
result=revList[mkId]=mkList[mkId].getHeadRevision();
maskFail|=1 << op;
break;
default :
fail();
result=null;
}
if (result == null) {
maskFail|=1 << op;
log(" -> fail " + Integer.toBinaryString(maskFail));
}
 else {
maskOk|=1 << op;
log(" -> " + result);
for (int j=0; j < unseenChanges.length; j++) {
if (j != mkId) {
unseenChanges[j].add(i);
}
}
}
log("get " + node);
boolean x=get(i,node);
log("get " + node + " returns "+ x);
log("get " + node2);
x=get(i,node2);
log("get " + node2 + " returns "+ x);
DocumentMK mk=mkList[mkId];
ClusterRev cr=new ClusterRev();
cr.mkId=mkId;
cr.rev=mk.getHeadRevision();
revs.put(i,cr);
revs.remove(i - maxBackRev);
log.append('\n');
}
if (Integer.bitCount(maskOk) != opCount) {
fail("Not all operations were at least once successful: " + Integer.toBinaryString(maskOk));
}
if (Integer.bitCount(maskFail) != opCount) {
fail("Not all operations failed at least once: " + Integer.toBinaryString(maskFail));
}
}
 catch (AssertionError e) {
throw new Exception("log: " + log,e);
}
catch (Exception e) {
throw new Exception("log: " + log,e);
}
for (int i=0; i < MK_COUNT; i++) {
mkList[i].dispose();
}
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.SharedBlobStoreGCTest </h4><pre class="type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testGCStats() throws Exception {
  log.debug("Running testGCStats()");
  cluster1.gc.collectGarbage(true);
  cluster2.gc.collectGarbage(true);
  Set<String> actualRepoIds=Sets.newHashSet();
  actualRepoIds.add(cluster1.repoId);
  actualRepoIds.add(cluster2.repoId);
  Set<Integer> actualNumBlobs=Sets.newHashSet();
  actualNumBlobs.add(cluster1.initBlobs.size());
  actualNumBlobs.add(cluster2.initBlobs.size());
  List<GarbageCollectionRepoStats> statsList=cluster1.gc.getStats();
  Set<Integer> observedNumBlobs=Sets.newHashSet();
  Set<String> observedRepoIds=Sets.newHashSet();
  for (  GarbageCollectionRepoStats stat : statsList) {
    observedNumBlobs.add(stat.getNumLines());
    observedRepoIds.add(stat.getRepositoryId());
    Assert.assertTrue(stat.getStartTime() <= stat.getEndTime());
    if (stat.getRepositoryId().equals(cluster1.repoId)) {
      Assert.assertTrue(stat.isLocal());
    }
  }
  Assert.assertTrue(Sets.difference(actualNumBlobs,observedNumBlobs).isEmpty());
  Assert.assertTrue(Sets.difference(actualRepoIds,observedRepoIds).isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.SimpleTest </h4><pre class="type-9 type-12 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void nodeAndPropertyNames(){
  DocumentMK mk=createMK();
  String rev;
  String nodes;
  for (  String s : new String[]{"_","$","__","_id","$x",".",".\\","x\\","\\x","first.name"}) {
    String x2=Utils.escapePropertyName(s);
    String s2=Utils.unescapePropertyName(x2);
    if (!s.equals(s2)) {
      assertEquals(s,s2);
    }
    JsopBuilder jsop=new JsopBuilder();
    jsop.tag('+').key(s).object().key(s).value("x").endObject();
    rev=mk.commit("/",jsop.toString(),null,null);
    nodes=mk.getNodes("/" + s,rev,0,0,10,null);
    jsop=new JsopBuilder();
    jsop.object().key(s).value("x").key(":childNodeCount").value(0).endObject();
    String n=jsop.toString();
    assertEquals(n,nodes);
    nodes=mk.getNodes("/",rev,0,0,10,null);
    jsop=new JsopBuilder();
    jsop.object().key(s).object().endObject().key(":childNodeCount").value(1).endObject();
    n=jsop.toString();
    assertEquals(n,nodes);
    jsop=new JsopBuilder();
    jsop.tag('-').value(s);
    rev=mk.commit("/",jsop.toString(),rev,null);
  }
}

</code></pre>

<br>
<pre class="type-13 type-9 type-12 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void escapeUnescape(){
  DocumentMK mk=createMK();
  String rev;
  String nodes;
  Random r=new Random(1);
  for (int i=0; i < 20; i++) {
    int len=1 + r.nextInt(5);
    StringBuilder buff=new StringBuilder();
    for (int j=0; j < len; j++) {
      buff.append((char)(32 + r.nextInt(128)));
    }
    String s=buff.toString();
    String x2=Utils.escapePropertyName(s);
    String s2=Utils.unescapePropertyName(x2);
    if (!s.equals(s2)) {
      assertEquals(s,s2);
    }
    if (s.indexOf('/') >= 0) {
      continue;
    }
    JsopBuilder jsop=new JsopBuilder();
    jsop.tag('+').key(s).object().key(s).value("x").endObject();
    rev=mk.commit("/",jsop.toString(),null,null);
    nodes=mk.getNodes("/" + s,rev,0,0,100,null);
    jsop=new JsopBuilder();
    jsop.object().key(s).value("x").key(":childNodeCount").value(0).endObject();
    String n=jsop.toString();
    assertEquals(n,nodes);
    nodes=mk.getNodes("/",rev,0,0,100,null);
    jsop=new JsopBuilder();
    jsop.object().key(s).object().endObject().key(":childNodeCount").value(1).endObject();
    n=jsop.toString();
    assertEquals(n,nodes);
    jsop=new JsopBuilder();
    jsop.tag('-').value(s);
    rev=mk.commit("/",jsop.toString(),rev,null);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.VersionGarbageCollectorIT </h4><pre class="type-13 type-9 type-12 type-7 type-6 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void gcDefaultLeafSplitDocs() throws Exception {
  Revision.setClock(clock);
  NodeBuilder builder=store.getRoot().builder();
  builder.child("test").setProperty("prop",-1);
  merge(store,builder);
  String id=Utils.getIdFromPath("/test");
  long start=Revision.getCurrentTimestamp();
  int hours=24;
  if (fixture instanceof DocumentStoreFixture.MongoFixture) {
    hours=6;
  }
  for (int i=0; i < 3600 * hours; i++) {
    clock.waitUntil(start + i * 1000);
    builder=store.getRoot().builder();
    builder.child("test").setProperty("prop",i);
    merge(store,builder);
    if (i % 10 == 0) {
      store.runBackgroundOperations();
    }
    if (i % 1800 == 0) {
      gc.gc(1,HOURS);
      NodeDocument doc=store.getDocumentStore().find(NODES,id);
      assertNotNull(doc);
      int numPrevDocs=Iterators.size(doc.getAllPreviousDocs());
      assertTrue("too many previous docs: " + numPrevDocs,numPrevDocs < 70);
    }
  }
  NodeDocument doc=store.getDocumentStore().find(NODES,id);
  assertNotNull(doc);
  int numRevs=size(doc.getValueMap("prop").entrySet());
  assertTrue("too many revisions: " + numRevs,numRevs < 6000);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.locks.TreeNodeDocumentsLocksTest </h4><pre class="type-12 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * Test for the OAK-3949. It uses multiple threads to acquire a shared lock
 * collection. There's also another set of threads that acquires parent
 * locks exclusively. Such combination can't lead to a deadlock.
 */
@Test public void testBulkAcquire() throws InterruptedException {
  int threadCount=10;
  int locksCount=100;
  final TreeNodeDocumentLocks locks=new TreeNodeDocumentLocks();
  List<Thread> threads=new ArrayList<Thread>();
  for (int i=0; i < threadCount; i++) {
    final List<String> keys=new ArrayList<String>(locksCount);
    for (int j=0; j < locksCount; j++) {
      keys.add(String.format("2:/parent_%d/lock_%d",j,j));
    }
    threads.add(new Thread(new Runnable(){
      @Override public void run(){
        Lock lock=locks.acquire(keys);
        try {
          Thread.sleep(100);
        }
 catch (        InterruptedException e) {
        }
 finally {
          lock.unlock();
        }
      }
    }
));
  }
  for (int j=0; j < threadCount; j++) {
    final int from=j * 10;
    final int to=(j + 1) * 10;
    threads.add(new Thread(new Runnable(){
      @Override public void run(){
        try {
          for (int i=from; i < to; i++) {
            Lock parentLock=locks.acquireExclusive(String.format("1:/parent_%d",i));
            Thread.sleep(100);
            Lock childLock=locks.acquire(String.format("2:/parent_%d/lock_%d",i,i));
            Thread.sleep(100);
            childLock.unlock();
            Thread.sleep(100);
            parentLock.unlock();
          }
        }
 catch (        InterruptedException e) {
        }
      }
    }
));
  }
  Collections.shuffle(threads);
  for (  Thread t : threads) {
    t.start();
  }
  for (  Thread t : threads) {
    t.join(10000);
    if (t.isAlive()) {
      fail("Thread hasn't stopped in 10s");
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.mongo.MongoDocumentStoreTest </h4><pre class="type-13 type-12 type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void timeoutQuery(){
  String fromId=Utils.getKeyLowerLimit("/");
  String toId=Utils.getKeyUpperLimit("/");
  store.setMaxLockedQueryTimeMS(1);
  long index=0;
  for (int i=0; i < 100; i++) {
    StringBuilder sb=new StringBuilder();
    for (int j=0; j < 1000; j++) {
      sb.append("+\"node-").append(index++).append("\":{}");
    }
    mk.commit("/",sb.toString(),null,null);
    store.queriesWithoutLock.set(0);
    store.resetLockAcquisitionCount();
    List<NodeDocument> docs=store.query(Collection.NODES,fromId,toId,"foo",System.currentTimeMillis(),Integer.MAX_VALUE);
    assertTrue(docs.isEmpty());
    if (store.queriesWithoutLock.get() > 0) {
      assertEquals(1,store.getLockAcquisitionCount());
      return;
    }
  }
  fail("No query timeout triggered even after adding " + index + " nodes");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.mongo.MongoUtilsTest </h4><pre class="type-12 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void createIndex(){
  MongoConnection c=connectionFactory.getConnection();
  c.getDB().dropDatabase();
  DBCollection collection=c.getDB().getCollection("test");
  MongoUtils.createIndex(collection,"foo",true,false,true);
  MongoUtils.createIndex(collection,"bar",false,true,false);
  MongoUtils.createIndex(collection,new String[]{"baz","qux"},new boolean[]{true,false},false,false);
  assertTrue(MongoUtils.hasIndex(collection,"_id"));
  assertTrue(MongoUtils.hasIndex(collection,"foo"));
  assertFalse(MongoUtils.hasIndex(collection,"foo","bar"));
  assertTrue(MongoUtils.hasIndex(collection,"baz","qux"));
  assertEquals(4,collection.getIndexInfo().size());
  for (  DBObject info : collection.getIndexInfo()) {
    DBObject key=(DBObject)info.get("key");
    if (key.keySet().contains("foo")) {
      assertEquals(1,key.keySet().size());
      assertEquals(1,key.get("foo"));
      assertEquals(Boolean.TRUE,info.get("sparse"));
    }
 else     if (key.keySet().contains("bar")) {
      assertEquals(1,key.keySet().size());
      assertEquals(-1,key.get("bar"));
      assertEquals(Boolean.TRUE,info.get("unique"));
    }
 else     if (key.keySet().contains("baz")) {
      assertEquals(2,key.keySet().size());
      assertEquals(1,key.get("baz"));
      assertEquals(-1,key.get("qux"));
    }
  }
  c.getDB().dropDatabase();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.rdb.RDBDocumentStoreJDBCTest </h4><pre class="type-9 type-12 type-5 type-7 type-16 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void batchFailingInsertResult() throws SQLException {
  assumeTrue(super.dsf != DocumentStoreFixture.RDB_PG);
  String table=((RDBDocumentStore)super.ds).getTable(Collection.NODES).getName();
  Connection con=super.rdbDataSource.getConnection();
  con.setReadOnly(false);
  try {
    PreparedStatement st=con.prepareStatement("DELETE FROM " + table + " WHERE ID in (?, ?, ?)");
    setIdInStatement(st,1,"key-1");
    setIdInStatement(st,2,"key-2");
    setIdInStatement(st,3,"key-3");
    st.executeUpdate();
    st.close();
    con.commit();
    removeMe.add("key-3");
    st=con.prepareStatement("INSERT INTO " + table + " (id) VALUES (?)");
    setIdInStatement(st,1,"key-3");
    st.executeUpdate();
    st.close();
    con.commit();
    removeMe.add("key-1");
    removeMe.add("key-2");
    PreparedStatement batchSt=con.prepareStatement("INSERT INTO " + table + " (id) VALUES (?)");
    setIdInStatement(batchSt,1,"key-1");
    batchSt.addBatch();
    setIdInStatement(batchSt,1,"key-2");
    batchSt.addBatch();
    setIdInStatement(batchSt,1,"key-3");
    batchSt.addBatch();
    int[] batchResult=null;
    try {
      batchSt.executeBatch();
      fail("Batch operation should fail");
    }
 catch (    BatchUpdateException e) {
      batchResult=e.getUpdateCounts();
    }
    batchSt.close();
    con.commit();
    assertTrue(batchResult.length >= 2);
    assertTrue("Row should be inserted correctly.",isSuccess(batchResult[0]));
    assertTrue("Row should be inserted correctly.",isSuccess(batchResult[1]));
    if (batchResult.length == 3) {
      assertTrue("Row already exists, shouldn't be inserted.",!isSuccess(batchResult[2]));
    }
    PreparedStatement rst=con.prepareStatement("SELECT id FROM " + table + " WHERE id in (?, ?, ?)");
    setIdInStatement(rst,1,"key-1");
    setIdInStatement(rst,2,"key-2");
    setIdInStatement(rst,3,"key-3");
    ResultSet results=rst.executeQuery();
    Set<String> ids=new HashSet<String>();
    while (results.next()) {
      ids.add(getIdFromRS(results,1));
    }
    results.close();
    rst.close();
    assertEquals("Some of the rows weren't inserted.",of("key-1","key-2","key-3"),ids);
  }
  finally {
    con.close();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.rdb.RDBDocumentStoreTest </h4><pre class="type-13 type-9 type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testRDBQueryKeyPatterns(){
  if (ds instanceof RDBDocumentStore) {
    RDBDocumentStore rds=(RDBDocumentStore)ds;
    String base=this.getClass().getName() + ".testRDBQuery-";
    for (int i=0; i < 10; i++) {
      String id="1:" + (i % 2 == 1 ? "p" : "") + "/"+ base+ i;
      UpdateOp up=new UpdateOp(id,true);
      up.set("_id",id);
      up.set("_test",base);
      boolean success=super.ds.create(Collection.NODES,Collections.singletonList(up));
      assertTrue("document with " + id + " not created",success);
      removeMe.add(id);
    }
    System.out.println(removeMe);
    List<QueryCondition> conditions=new ArrayList<QueryCondition>();
    List<NodeDocument> result=rds.query(Collection.NODES,NodeDocument.MIN_ID_VALUE,NodeDocument.MAX_ID_VALUE,Arrays.asList("_:/%","__:/%","___:/%"),conditions,10000);
    for (    NodeDocument d : result) {
      if (base.equals(d.get("_test"))) {
        assertTrue(d.getId().startsWith("1:p"));
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-9 type-12 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRDBQueryConditions(){
  if (ds instanceof RDBDocumentStore) {
    RDBDocumentStore rds=(RDBDocumentStore)ds;
    long now=System.currentTimeMillis();
    String base=this.getClass().getName() + ".testRDBQuery-";
    for (int i=0; i < 10; i++) {
      String id=base + i;
      UpdateOp up=new UpdateOp(id,true);
      up.set("_id",id);
      up.set(NodeDocument.DELETED_ONCE,i % 2 == 1);
      up.set(NodeDocument.MODIFIED_IN_SECS,now++);
      boolean success=super.ds.create(Collection.NODES,Collections.singletonList(up));
      assertTrue("document with " + id + " not created",success);
      removeMe.add(id);
    }
    List<QueryCondition> conditions=new ArrayList<QueryCondition>();
    conditions.add(new QueryCondition(NodeDocument.DELETED_ONCE,"=",0));
    conditions.add(new QueryCondition(NodeDocument.MODIFIED_IN_SECS,"<",now - 2));
    List<NodeDocument> result=rds.query(Collection.NODES,base,base + "A",RDBDocumentStore.EMPTY_KEY_PATTERN,conditions,10);
    assertEquals(4,result.size());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.index.solr.server.RemoteSolrServerProviderIT </h4><pre class="type-12 type-6 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testCloudRemoteServerCreation() throws Exception {
  for (  String host : zkHosts) {
    boolean cloudServerAvailable=false;
    try {
      cloudServerAvailable=canCreateCollections(host);
    }
 catch (    Exception e) {
    }
    if (cloudServerAvailable) {
      String collection="sample_" + System.nanoTime();
      RemoteSolrServerProvider remoteSolrServerProvider=new RemoteSolrServerProvider(new RemoteSolrServerConfiguration(host,collection,2,2,null));
      SolrServer solrServer=remoteSolrServerProvider.getSolrServer();
      assertNotNull(solrServer);
      solrServer.shutdown();
      break;
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.segment.CompactionMapTest </h4><pre class="type-12 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies whether objects are null
"></span><br>
@Test public void checkNonExistingKeys(){
  for (  RecordId keys : randomRecordIdMap(rnd,store.getTracker(),10,10).keySet()) {
    if (!referenceMap.containsKey(keys)) {
      assertNull(compactionMap.get(keys));
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-12 type-6 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void removeSome(){
  Set<UUID> removedUUIDs=newHashSet();
  for (int k=0; k < 1 + rnd.nextInt(referenceMap.size()); k++) {
    RecordId key=get(referenceMap.keySet(),rnd.nextInt(referenceMap.size()));
    removedUUIDs.add(key.asUUID());
  }
  compactionMap.remove(removedUUIDs);
  for (  Entry<RecordId,RecordId> reference : referenceMap.entrySet()) {
    RecordId key=reference.getKey();
    if (removedUUIDs.contains(key.asUUID())) {
      assertNull(compactionMap.get(key));
    }
 else {
      assertEquals(reference.getValue(),compactionMap.get(key));
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.segment.SegmentIdTableTest </h4><pre class="type-13 type-12 type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void gc() throws IOException {
  SegmentTracker tracker=new MemoryStore().getTracker();
  final SegmentIdTable tbl=new SegmentIdTable(tracker);
  List<SegmentId> refs=new ArrayList<SegmentId>();
  int originalCount=1024;
  for (int i=0; i < originalCount; i++) {
    refs.add(tbl.getSegmentId(i,i % 128));
  }
  Assert.assertEquals(originalCount,tbl.getEntryCount());
  Assert.assertEquals(1,tbl.getMapRebuildCount());
  for (int i=0; i < refs.size() / 2; i++) {
    refs.remove(0);
  }
  for (int gcCalls=0; ; gcCalls++) {
    System.gc();
    for (    SegmentId id : refs) {
      SegmentId id2=tbl.getSegmentId(id.getMostSignificantBits(),id.getLeastSignificantBits());
      Assert.assertTrue(id2 == id);
    }
    Assert.assertEquals(1,tbl.getMapRebuildCount());
    for (int i=0; i < 10; i++) {
      tbl.getSegmentId(i,i);
    }
    if (tbl.getEntryCount() < originalCount) {
      break;
    }
 else     if (gcCalls > 10) {
      fail("No entries were garbage collected after 10 times System.gc()");
    }
  }
  Assert.assertEquals(2,tbl.getMapRebuildCount());
}

</code></pre>

<br>
<pre class="type-12 type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void clearTable() throws IOException {
  SegmentTracker tracker=new MemoryStore().getTracker();
  final SegmentIdTable tbl=new SegmentIdTable(tracker);
  List<SegmentId> refs=new ArrayList<SegmentId>();
  int originalCount=8;
  for (int i=0; i < originalCount; i++) {
    refs.add(tbl.getSegmentId(i,i % 2));
  }
  Assert.assertEquals(originalCount,tbl.getEntryCount());
  Assert.assertEquals(0,tbl.getMapRebuildCount());
  tbl.clearSegmentIdTables(new CompactionStrategy(false,false,CleanupType.CLEAN_NONE,originalCount,(byte)0){
    @Override public boolean compacted(    @Nonnull Callable<Boolean> setHead) throws Exception {
      return true;
    }
    @Override public boolean canRemove(    SegmentId id){
      return id.getMostSignificantBits() < 4;
    }
  }
);
  Assert.assertEquals(4,tbl.getEntryCount());
  for (  SegmentId id : refs) {
    if (id.getMostSignificantBits() >= 4) {
      SegmentId id2=tbl.getSegmentId(id.getMostSignificantBits(),id.getLeastSignificantBits());
      List<SegmentId> list=tbl.getRawSegmentIdList();
      if (list.size() != new HashSet<SegmentId>(list).size()) {
        Collections.sort(list);
        fail("duplicate entry " + list.toString());
      }
      Assert.assertTrue(id == id2);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.segment.standby.MBeanTest </h4><pre class="type-9 type-12 type-5 type-7 type-6 type-4 type-8 type-3 type-14 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
- Is not executed with the test suite
"></span><br>
@Test @Ignore("OAK-2086") public void testClientAndServerEmptyConfig() throws Exception {
  final StandbyServer server=new StandbyServer(port,this.storeS);
  server.start();
  System.setProperty(StandbyClient.CLIENT_ID_PROPERTY_NAME,"Bar");
  final StandbyClient client=newStandbyClient(storeC);
  client.start();
  final MBeanServer jmxServer=ManagementFactory.getPlatformMBeanServer();
  ObjectName status=new ObjectName(StandbyStatusMBean.JMX_NAME + ",id=*");
  ObjectName clientStatus=new ObjectName(client.getMBeanName());
  ObjectName serverStatus=new ObjectName(server.getMBeanName());
  try {
    Set<ObjectName> instances=jmxServer.queryNames(status,null);
    assertEquals(3,instances.size());
    ObjectName connectionStatus=null;
    for (    ObjectName s : instances) {
      if (!s.equals(clientStatus) && !s.equals(serverStatus))       connectionStatus=s;
    }
    assertNotNull(connectionStatus);
    assertTrue(jmxServer.isRegistered(clientStatus));
    assertTrue(jmxServer.isRegistered(serverStatus));
    assertTrue(jmxServer.isRegistered(connectionStatus));
    String m=jmxServer.getAttribute(clientStatus,"Mode").toString();
    if (!m.startsWith("client: "))     fail("unexpected mode " + m);
    assertEquals("master",jmxServer.getAttribute(serverStatus,"Mode"));
    assertEquals(true,jmxServer.getAttribute(serverStatus,"Running"));
    assertEquals(true,jmxServer.getAttribute(clientStatus,"Running"));
    assertEquals("0",jmxServer.getAttribute(clientStatus,"FailedRequests").toString());
    assertEquals("0",jmxServer.getAttribute(clientStatus,"SecondsSinceLastSuccess").toString());
    assertEquals("0",jmxServer.invoke(clientStatus,"calcFailedRequests",null,null).toString());
    assertEquals("0",jmxServer.invoke(clientStatus,"calcSecondsSinceLastSuccess",null,null).toString());
    Thread.sleep(1000);
    assertEquals("0",jmxServer.getAttribute(clientStatus,"FailedRequests").toString());
    assertEquals("1",jmxServer.getAttribute(clientStatus,"SecondsSinceLastSuccess").toString());
    assertEquals("0",jmxServer.invoke(clientStatus,"calcFailedRequests",null,null).toString());
    assertEquals("1",jmxServer.invoke(clientStatus,"calcSecondsSinceLastSuccess",null,null).toString());
    assertEquals(new Long(2),jmxServer.getAttribute(connectionStatus,"TransferredSegments"));
    assertEquals(new Long(128),jmxServer.getAttribute(connectionStatus,"TransferredSegmentBytes"));
    jmxServer.invoke(serverStatus,"stop",null,null);
    assertEquals(false,jmxServer.getAttribute(serverStatus,"Running"));
    m=jmxServer.getAttribute(serverStatus,"Status").toString();
    if (!m.equals(StandbyStatusMBean.STATUS_STOPPED) && !m.equals("channel unregistered"))     fail("unexpected Status" + m);
    jmxServer.invoke(serverStatus,"start",null,null);
    assertEquals(true,jmxServer.getAttribute(serverStatus,"Running"));
    assertEquals(true,jmxServer.getAttribute(clientStatus,"Running"));
    m=jmxServer.getAttribute(serverStatus,"Status").toString();
    if (!m.equals(StandbyStatusMBean.STATUS_STARTING) && !m.equals("channel unregistered"))     fail("unexpected Status" + m);
    jmxServer.invoke(clientStatus,"stop",null,null);
    assertEquals(true,jmxServer.getAttribute(serverStatus,"Running"));
    assertEquals(false,jmxServer.getAttribute(clientStatus,"Running"));
    assertEquals(StandbyStatusMBean.STATUS_STOPPED,jmxServer.getAttribute(clientStatus,"Status"));
    jmxServer.invoke(clientStatus,"start",null,null);
    assertEquals(true,jmxServer.getAttribute(clientStatus,"Running"));
    assertEquals(StandbyStatusMBean.STATUS_RUNNING,jmxServer.getAttribute(clientStatus,"Status"));
  }
  finally {
    client.close();
    server.close();
  }
  assertTrue(!jmxServer.isRegistered(clientStatus));
  assertTrue(!jmxServer.isRegistered(serverStatus));
}

</code></pre>

<br>
<pre class="type-9 type-12 type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testServerEmptyConfig() throws Exception {
  final StandbyServer server=new StandbyServer(this.port,this.storeS);
  server.start();
  final MBeanServer jmxServer=ManagementFactory.getPlatformMBeanServer();
  ObjectName status=new ObjectName(StandbyStatusMBean.JMX_NAME + ",id=*");
  try {
    Set<ObjectName> instances=jmxServer.queryNames(status,null);
    assertEquals(1,instances.size());
    status=instances.toArray(new ObjectName[0])[0];
    assertEquals(new ObjectName(server.getMBeanName()),status);
    assertTrue(jmxServer.isRegistered(status));
    assertEquals("primary",jmxServer.getAttribute(status,"Mode"));
    String m=jmxServer.getAttribute(status,"Status").toString();
    if (!m.equals(StandbyStatusMBean.STATUS_STARTING) && !m.equals("channel unregistered"))     fail("unexpected Status " + m);
    assertEquals(StandbyStatusMBean.STATUS_STARTING,jmxServer.getAttribute(status,"Status"));
    assertEquals(true,jmxServer.getAttribute(status,"Running"));
    jmxServer.invoke(status,"stop",null,null);
    assertEquals(false,jmxServer.getAttribute(status,"Running"));
    assertEquals(StandbyStatusMBean.STATUS_STOPPED,jmxServer.getAttribute(status,"Status"));
    jmxServer.invoke(status,"start",null,null);
    assertEquals(true,jmxServer.getAttribute(status,"Running"));
    assertEquals(StandbyStatusMBean.STATUS_RUNNING,jmxServer.getAttribute(status,"Status"));
  }
  finally {
    server.close();
  }
  assertTrue(!jmxServer.isRegistered(status));
}

</code></pre>

<br>
<pre class="type-9 type-12 type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testClientEmptyConfigNoServer() throws Exception {
  final StandbyClient client=newStandbyClient(storeC);
  client.start();
  final MBeanServer jmxServer=ManagementFactory.getPlatformMBeanServer();
  ObjectName status=new ObjectName(StandbyStatusMBean.JMX_NAME + ",id=*");
  try {
    Set<ObjectName> instances=jmxServer.queryNames(status,null);
    assertEquals(1,instances.size());
    status=instances.toArray(new ObjectName[0])[0];
    assertEquals(new ObjectName(client.getMBeanName()),status);
    assertTrue(jmxServer.isRegistered(status));
    String m=jmxServer.getAttribute(status,"Mode").toString();
    if (!m.startsWith("client: "))     fail("unexpected mode " + m);
    assertEquals("0",jmxServer.getAttribute(status,"FailedRequests").toString());
    assertEquals("-1",jmxServer.getAttribute(status,"SecondsSinceLastSuccess").toString());
    assertEquals(StandbyStatusMBean.STATUS_INITIALIZING,jmxServer.getAttribute(status,"Status"));
    assertEquals(false,jmxServer.getAttribute(status,"Running"));
    jmxServer.invoke(status,"stop",null,null);
    assertEquals(false,jmxServer.getAttribute(status,"Running"));
    assertEquals(StandbyStatusMBean.STATUS_STOPPED,jmxServer.getAttribute(status,"Status"));
    jmxServer.invoke(status,"start",null,null);
    assertEquals(false,jmxServer.getAttribute(status,"Running"));
    assertEquals(StandbyStatusMBean.STATUS_STOPPED,jmxServer.getAttribute(status,"Status"));
  }
  finally {
    client.close();
  }
  assertTrue(!jmxServer.isRegistered(status));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.tree.TreeTypeProviderTest </h4><pre class="type-12 type-6 type-4 type-18 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testGetTypeWithDefaultParentType(){
  for (  TypeTest test : tests) {
    TreeType typeIfParentDefault=typeProvider.getType(root.getTree(test.path),TreeType.DEFAULT);
    if (TreeType.DEFAULT == test.parentType) {
      assertEquals(test.path,test.type,typeIfParentDefault);
    }
 else {
      assertNotEquals(test.path,test.type,typeIfParentDefault);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.query.index.FilterTest </h4><pre class="type-13 type-9 type-12 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void pathRestrictionsRandomized() throws Exception {
  ArrayList<String> paths=new ArrayList<String>();
  paths.add("/");
  for (int i='a'; i <= 'c'; i++) {
    String p1="/" + (char)i;
    paths.add(p1);
    for (int j='a'; j <= 'c'; j++) {
      String p2="/" + (char)j;
      paths.add(p1 + p2);
      for (int k='a'; k <= 'c'; k++) {
        String p3="/" + (char)k;
        paths.add(p1 + p2 + p3);
      }
    }
  }
  Random r=new Random(1);
  for (int i=0; i < 10000; i++) {
    String p1=paths.get(r.nextInt(paths.size()));
    String p2=paths.get(r.nextInt(paths.size()));
    Filter.PathRestriction r1=Filter.PathRestriction.values()[r.nextInt(Filter.PathRestriction.values().length)];
    Filter.PathRestriction r2=Filter.PathRestriction.values()[r.nextInt(Filter.PathRestriction.values().length)];
    FilterImpl f1=new FilterImpl();
    f1.restrictPath(p1,r1);
    FilterImpl f2=new FilterImpl();
    f2.restrictPath(p2,r2);
    FilterImpl fc=new FilterImpl();
    fc.restrictPath(p1,r1);
    fc.restrictPath(p2,r2);
    int tooMany=0;
    for (    String p : paths) {
      boolean expected=f1.testPath(p) && f2.testPath(p);
      boolean got=fc.testPath(p);
      if (expected == got) {
      }
 else       if (expected && !got) {
        fc=new FilterImpl();
        fc.restrictPath(p1,r1);
        fc.restrictPath(p2,r2);
        fail("not matched: " + p1 + "/"+ r1.name()+ " && "+ p2+ "/"+ r2.name());
      }
 else {
        tooMany++;
      }
    }
    if (tooMany > 3) {
      fail("too many matches: " + p1 + "/"+ r1.name()+ " && "+ p2+ "/"+ r2.name()+ " superfluous: "+ tooMany);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.authentication.token.TokenProviderImplTest </h4><pre class="type-9 type-12 type-7 type-6 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTokenNode() throws Exception {
  Map<String,String> reserved=new HashMap<String,String>();
  reserved.put(TOKEN_ATTRIBUTE,"value");
  reserved.put(TOKEN_ATTRIBUTE_KEY,"value");
  reserved.put(TOKEN_ATTRIBUTE_EXPIRY,"value");
  Map<String,String> privateAttributes=new HashMap<String,String>();
  privateAttributes.put(".token_exp","value");
  privateAttributes.put(".tokenTest","value");
  privateAttributes.put(".token_something","value");
  Map<String,String> publicAttributes=new HashMap<String,String>();
  publicAttributes.put("any","value");
  publicAttributes.put("another","value");
  Map<String,String> attributes=new HashMap<String,String>();
  attributes.putAll(reserved);
  attributes.putAll(publicAttributes);
  attributes.putAll(privateAttributes);
  TokenInfo info=tokenProvider.createToken(userId,attributes);
  Tree tokenTree=getTokenTree(info);
  PropertyState prop=tokenTree.getProperty(TOKEN_ATTRIBUTE_KEY);
  assertNotNull(prop);
  assertEquals(Type.STRING,prop.getType());
  prop=tokenTree.getProperty(TOKEN_ATTRIBUTE_EXPIRY);
  assertNotNull(prop);
  assertEquals(Type.DATE,prop.getType());
  for (  String key : reserved.keySet()) {
    PropertyState p=tokenTree.getProperty(key);
    if (p != null) {
      assertFalse(reserved.get(key).equals(p.getValue(Type.STRING)));
    }
  }
  for (  String key : privateAttributes.keySet()) {
    assertEquals(privateAttributes.get(key),tokenTree.getProperty(key).getValue(Type.STRING));
  }
  for (  String key : publicAttributes.keySet()) {
    assertEquals(publicAttributes.get(key),tokenTree.getProperty(key).getValue(Type.STRING));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.authorization.accesscontrol.AccessControlManagerImplTest </h4><pre class="type-12 type-6 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTestSessionGetPolicies() throws Exception {
  setupPolicy(testPath);
  root.commit();
  Root testRoot=getTestRoot();
  testRoot.refresh();
  JackrabbitAccessControlManager testAcMgr=getTestAccessControlManager();
  PrincipalManager testPrincipalMgr=getPrincipalManager(testRoot);
  List<Principal> principals=ImmutableList.of(testPrincipal,EveryonePrincipal.getInstance());
  for (  Principal principal : principals) {
    if (testPrincipalMgr.hasPrincipal(principal.getName())) {
      AccessControlPolicy[] policies=testAcMgr.getPolicies(principal);
      assertNotNull(policies);
      assertEquals(0,policies.length);
    }
 else {
      assertEquals(0,testAcMgr.getPolicies(principal).length);
    }
  }
}

</code></pre>

<br>
<pre class="type-12 type-6 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetEffectivePoliciesByPrincipal() throws Exception {
  Set<Set<Principal>> principalSets=new HashSet<Set<Principal>>();
  principalSets.add(Collections.singleton(getTestPrincipal()));
  principalSets.add(Collections.<Principal>singleton(EveryonePrincipal.getInstance()));
  principalSets.add(ImmutableSet.of(testPrincipal,EveryonePrincipal.getInstance()));
  for (  Set<Principal> principals : principalSets) {
    AccessControlPolicy[] policies=acMgr.getEffectivePolicies(principals);
    assertNotNull(policies);
    assertEquals(0,policies.length);
  }
  setupPolicy(testPath);
  for (  Set<Principal> principals : principalSets) {
    AccessControlPolicy[] policies=acMgr.getEffectivePolicies(principals);
    assertNotNull(policies);
    assertEquals(0,policies.length);
  }
  root.commit();
  for (  Set<Principal> principals : principalSets) {
    AccessControlPolicy[] policies=acMgr.getEffectivePolicies(principals);
    assertNotNull(policies);
    if (principals.contains(getTestPrincipal())) {
      assertEquals(1,policies.length);
    }
 else {
      assertEquals(0,policies.length);
    }
  }
  NodeUtil child=new NodeUtil(root.getTree(testPath)).addChild("child",JcrConstants.NT_UNSTRUCTURED);
  String childPath=child.getTree().getPath();
  setupPolicy(childPath);
  for (  Set<Principal> principals : principalSets) {
    AccessControlPolicy[] policies=acMgr.getEffectivePolicies(principals);
    assertNotNull(policies);
    if (principals.contains(getTestPrincipal())) {
      assertEquals(1,policies.length);
    }
 else {
      assertEquals(0,policies.length);
    }
  }
  root.commit();
  for (  Set<Principal> principals : principalSets) {
    AccessControlPolicy[] policies=acMgr.getEffectivePolicies(principals);
    assertNotNull(policies);
    if (principals.contains(getTestPrincipal())) {
      assertEquals(2,policies.length);
    }
 else {
      assertEquals(0,policies.length);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.authorization.composite.CompositeAccessControlManagerTest </h4><pre class="type-13 type-12 type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetApplicablePolicies() throws Exception {
  AccessControlPolicyIterator it=acMgr.getApplicablePolicies("/");
  while (it.hasNext()) {
    if (it.nextAccessControlPolicy() == TestPolicy.INSTANCE) {
      fail("TestPolicy should only be applicable at /test.");
    }
  }
  Set<AccessControlPolicy> applicable=ImmutableSet.copyOf(acMgr.getApplicablePolicies(TEST_PATH));
  assertEquals(2,applicable.size());
  assertTrue(applicable.contains(TestPolicy.INSTANCE));
}

</code></pre>

<br>
<pre class="type-13 type-12 type-5 type-7 type-6 type-19 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetPolicies() throws Exception {
  int len=0;
  AccessControlPolicy[] policies=acMgr.getPolicies(TEST_PATH);
  assertEquals(len,policies.length);
  acMgr.setPolicy(TEST_PATH,TestPolicy.INSTANCE);
  len++;
  policies=acMgr.getPolicies(TEST_PATH);
  assertEquals(len,policies.length);
  assertSame(TestPolicy.INSTANCE,policies[0]);
  AccessControlPolicyIterator it=acMgr.getApplicablePolicies(TEST_PATH);
  while (it.hasNext()) {
    AccessControlPolicy plc=it.nextAccessControlPolicy();
    if (plc == TestPolicy.INSTANCE) {
      fail("TestPolicy should only be applicable at /test.");
    }
 else {
      acMgr.setPolicy(TEST_PATH,plc);
      len++;
      Set<AccessControlPolicy> policySet=ImmutableSet.copyOf(acMgr.getPolicies(TEST_PATH));
      assertEquals(len,policySet.size());
      assertTrue(policySet.contains(TestPolicy.INSTANCE));
      assertTrue(policySet.contains(plc));
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.authorization.composite.CompositeProviderAllTest </h4><pre class="type-9 type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testTreePermissionIsGrantedProperty() throws Exception {
  TreePermission parentPermission=TreePermission.EMPTY;
  for (  String path : TP_PATHS) {
    TreePermission tp=cpp.getTreePermission(readOnlyRoot.getTree(path),parentPermission);
    Long toTest=(defPermissions.containsKey(path)) ? defPermissions.get(path) : defPermissions.get(PathUtils.getAncestorPath(path,1));
    if (toTest != null) {
      assertTrue(tp.isGranted(toTest,PROPERTY_STATE));
    }
    parentPermission=tp;
  }
}

</code></pre>

<br>
<pre class="type-9 type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testTreePermissionIsGranted() throws Exception {
  TreePermission parentPermission=TreePermission.EMPTY;
  for (  String path : TP_PATHS) {
    TreePermission tp=cpp.getTreePermission(root.getTree(path),parentPermission);
    Long toTest=(defPermissions.containsKey(path)) ? defPermissions.get(path) : defPermissions.get(PathUtils.getAncestorPath(path,1));
    if (toTest != null) {
      assertTrue(tp.isGranted(toTest));
    }
    parentPermission=tp;
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.authorization.composite.CompositeProviderFullScopeTest </h4><pre class="type-9 type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testHasPrivileges() throws Exception {
  PrivilegeBitsProvider pbp=new PrivilegeBitsProvider(readOnlyRoot);
  PrivilegeBits readNodes=pbp.getBits(REP_READ_NODES);
  for (  String path : defPrivileges.keySet()) {
    Set<String> defaultPrivs=defPrivileges.get(path);
    PrivilegeBits defaultBits=pbp.getBits(defaultPrivs);
    Tree tree=readOnlyRoot.getTree(path);
    if (defaultPrivs.isEmpty()) {
      assertFalse(path,cppTestUser.hasPrivileges(tree,REP_READ_NODES));
    }
 else     if (defaultBits.includes(readNodes)) {
      assertTrue(path,cppTestUser.hasPrivileges(tree,REP_READ_NODES));
      if (!readNodes.equals(defaultBits)) {
        assertFalse(path,cppTestUser.hasPrivileges(tree,defaultPrivs.toArray(new String[defaultPrivs.size()])));
      }
    }
 else {
      assertFalse(path,cppTestUser.hasPrivileges(tree,REP_READ_NODES));
      assertFalse(path,cppTestUser.hasPrivileges(tree,defaultPrivs.toArray(new String[defaultPrivs.size()])));
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-12 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetPrivileges() throws Exception {
  PrivilegeBitsProvider pbp=new PrivilegeBitsProvider(readOnlyRoot);
  PrivilegeBits readNodes=pbp.getBits(REP_READ_NODES);
  Set<String> expected=ImmutableSet.of(REP_READ_NODES);
  for (  String path : defPrivileges.keySet()) {
    Set<String> defaultPrivs=defPrivileges.get(path);
    Tree tree=readOnlyRoot.getTree(path);
    Set<String> privNames=cppTestUser.getPrivileges(tree);
    if (pbp.getBits(defaultPrivs).includes(readNodes)) {
      assertEquals(expected,privNames);
    }
 else {
      assertTrue(privNames.isEmpty());
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-12 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTreePermissionIsGranted() throws Exception {
  TreePermission parentPermission=TreePermission.EMPTY;
  for (  String path : TP_PATHS) {
    TreePermission tp=cppTestUser.getTreePermission(readOnlyRoot.getTree(path),parentPermission);
    Long toTest=(defPermissions.containsKey(path)) ? defPermissions.get(path) : defPermissions.get(PathUtils.getAncestorPath(path,1));
    if (toTest != null) {
      if (Permissions.READ_NODE == toTest) {
        assertTrue(path,tp.isGranted(toTest));
      }
 else {
        boolean canRead=Permissions.includes(toTest,Permissions.READ_NODE);
        assertEquals(path,canRead,tp.isGranted(Permissions.READ_NODE));
        assertFalse(path,tp.isGranted(toTest));
      }
    }
    parentPermission=tp;
  }
}

</code></pre>

<br>
<pre class="type-9 type-12 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIsGrantedAction() throws Exception {
  for (  String p : defActionsGranted.keySet()) {
    String[] actions=defActionsGranted.get(p);
    if (ImmutableList.copyOf(actions).contains(Session.ACTION_READ)) {
      TreeLocation tl=TreeLocation.create(readOnlyRoot,p);
      assertEquals(p,tl.getTree() != null,cppTestUser.isGranted(p,Session.ACTION_READ));
    }
 else {
      assertFalse(p,cppTestUser.isGranted(p,Session.ACTION_READ));
    }
    if (actions.length > 1) {
      assertFalse(p,cppTestUser.isGranted(p,getActionString(actions)));
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-12 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTreePermissionIsGrantedProperty() throws Exception {
  TreePermission parentPermission=TreePermission.EMPTY;
  for (  String path : TP_PATHS) {
    TreePermission tp=cppTestUser.getTreePermission(readOnlyRoot.getTree(path),parentPermission);
    Long toTest=(defPermissions.containsKey(path)) ? defPermissions.get(path) : defPermissions.get(PathUtils.getAncestorPath(path,1));
    if (toTest != null) {
      boolean granted=(toTest == Permissions.READ_NODE);
      assertEquals(path,granted,tp.isGranted(toTest,PROPERTY_STATE));
    }
    assertFalse(tp.isGranted(Permissions.READ_PROPERTY,PROPERTY_STATE));
    parentPermission=tp;
  }
}

</code></pre>

<br>
<pre class="type-9 type-12 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIsGranted() throws Exception {
  for (  String p : defPermissions.keySet()) {
    long defaultPerms=defPermissions.get(p);
    Tree tree=readOnlyRoot.getTree(p);
    if (Permissions.READ_NODE != defaultPerms) {
      assertFalse(p,cppTestUser.isGranted(tree,null,defaultPerms));
    }
    boolean expectedReadNode=Permissions.includes(defaultPerms,Permissions.READ_NODE);
    assertEquals(p,expectedReadNode,cppTestUser.isGranted(tree,null,Permissions.READ_NODE));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.authorization.composite.CompositeProviderNoScopeTest </h4><pre class="type-9 type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testTreePermissionIsGrantedProperty() throws Exception {
  TreePermission parentPermission=TreePermission.EMPTY;
  for (  String path : TP_PATHS) {
    TreePermission tp=cppTestUser.getTreePermission(readOnlyRoot.getTree(path),parentPermission);
    Long toTest=(defPermissions.containsKey(path)) ? defPermissions.get(path) : defPermissions.get(PathUtils.getAncestorPath(path,1));
    if (toTest != null) {
      assertTrue(tp.isGranted(toTest,PROPERTY_STATE));
    }
    parentPermission=tp;
  }
}

</code></pre>

<br>
<pre class="type-9 type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testTreePermissionIsGranted() throws Exception {
  TreePermission parentPermission=TreePermission.EMPTY;
  for (  String path : TP_PATHS) {
    TreePermission tp=cppTestUser.getTreePermission(readOnlyRoot.getTree(path),parentPermission);
    Long toTest=(defPermissions.containsKey(path)) ? defPermissions.get(path) : defPermissions.get(PathUtils.getAncestorPath(path,1));
    if (toTest != null) {
      assertTrue(tp.isGranted(toTest));
    }
    parentPermission=tp;
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.authorization.composite.CompositeProviderScopeTest </h4><pre class="type-9 type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testIsGrantedProperty() throws Exception {
  for (  String p : defPermissions.keySet()) {
    long defaultPerms=defPermissions.get(p);
    Tree tree=readOnlyRoot.getTree(p);
    if (testProvider.isSupported(p)) {
      long expected=Permissions.diff(defaultPerms,Permissions.ADD_NODE | Permissions.ADD_PROPERTY);
      assertTrue(cppTestUser.isGranted(tree,PROPERTY_STATE,expected));
      assertFalse(cppTestUser.isGranted(tree,PROPERTY_STATE,Permissions.ADD_PROPERTY));
      assertFalse(cppTestUser.isGranted(tree,PROPERTY_STATE,Permissions.SET_PROPERTY));
      assertFalse(cppTestUser.isGranted(tree,PROPERTY_STATE,Permissions.WRITE));
    }
 else {
      assertTrue(cppTestUser.isGranted(tree,PROPERTY_STATE,defaultPerms));
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testIsGrantedAdmin() throws Exception {
  for (  String path : NODE_PATHS) {
    Tree tree=readOnlyRoot.getTree(path);
    if (testProvider.isSupported(path)) {
      assertTrue(cppAdminUser.isGranted(tree,null,Permissions.diff(Permissions.ALL,Permissions.ADD_NODE | Permissions.ADD_PROPERTY)));
      assertFalse(cppAdminUser.isGranted(tree,null,Permissions.ADD_NODE));
      assertFalse(cppAdminUser.isGranted(tree,null,Permissions.ADD_PROPERTY));
      assertFalse(cppAdminUser.isGranted(tree,null,Permissions.ADD_NODE | Permissions.ADD_PROPERTY));
      assertFalse(cppAdminUser.isGranted(tree,null,Permissions.WRITE));
    }
 else {
      assertTrue(cppAdminUser.isGranted(tree,null,Permissions.ALL));
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-12 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetPrivileges() throws Exception {
  PrivilegeBitsProvider pbp=new PrivilegeBitsProvider(readOnlyRoot);
  for (  String path : defPrivileges.keySet()) {
    Tree tree=readOnlyRoot.getTree(path);
    Set<String> defaultPrivs=defPrivileges.get(path);
    Set<String> privNames=cppTestUser.getPrivileges(tree);
    if (testProvider.isSupported(path)) {
      PrivilegeBits expected=pbp.getBits(defaultPrivs).modifiable().diff(denied).unmodifiable();
      assertEquals(expected,pbp.getBits(privNames));
    }
 else {
      assertEquals(path,defaultPrivs,privNames);
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testTreePermissionIsGrantedProperty() throws Exception {
  TreePermission parentPermission=TreePermission.EMPTY;
  for (  String path : TP_PATHS) {
    TreePermission tp=cppTestUser.getTreePermission(readOnlyRoot.getTree(path),parentPermission);
    Long toTest=(defPermissions.containsKey(path)) ? defPermissions.get(path) : defPermissions.get(PathUtils.getAncestorPath(path,1));
    if (toTest != null) {
      if (testProvider.isSupported(path)) {
        assertTrue(tp.isGranted(Permissions.diff(toTest,Permissions.ADD_NODE | Permissions.ADD_PROPERTY),PROPERTY_STATE));
        assertFalse(tp.isGranted(Permissions.ADD_PROPERTY,PROPERTY_STATE));
      }
 else {
        assertTrue(tp.isGranted(toTest,PROPERTY_STATE));
      }
    }
    parentPermission=tp;
  }
}

</code></pre>

<br>
<pre class="type-9 type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testTreePermissionIsGranted() throws Exception {
  TreePermission parentPermission=TreePermission.EMPTY;
  for (  String path : TP_PATHS) {
    TreePermission tp=cppTestUser.getTreePermission(readOnlyRoot.getTree(path),parentPermission);
    Long toTest=(defPermissions.containsKey(path)) ? defPermissions.get(path) : defPermissions.get(PathUtils.getAncestorPath(path,1));
    if (toTest != null) {
      if (testProvider.isSupported(path)) {
        assertTrue(tp.isGranted(Permissions.diff(toTest,Permissions.ADD_NODE | Permissions.ADD_PROPERTY)));
        assertFalse(tp.isGranted(Permissions.ADD_PROPERTY | Permissions.ADD_NODE));
      }
 else {
        assertTrue(tp.isGranted(toTest));
      }
    }
    parentPermission=tp;
  }
}

</code></pre>

<br>
<pre class="type-9 type-12 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetPrivilegesAdmin() throws Exception {
  for (  String path : NODE_PATHS) {
    Tree tree=readOnlyRoot.getTree(path);
    Set<String> privNames=cppAdminUser.getPrivileges(tree);
    if (testProvider.isSupported(path)) {
      PrivilegeBits expected=pbp.getBits(JCR_ALL).modifiable().diff(denied).unmodifiable();
      assertEquals(expected,pbp.getBits(privNames));
    }
 else {
      assertEquals(path,ImmutableSet.of(JCR_ALL),privNames);
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testHasPrivileges() throws Exception {
  for (  String path : defPrivileges.keySet()) {
    Set<String> defaultPrivs=defPrivileges.get(path);
    Tree tree=readOnlyRoot.getTree(path);
    if (testProvider.isSupported(path)) {
      Set<String> expected=pbp.getPrivilegeNames(pbp.getBits(defaultPrivs).modifiable().diff(denied));
      assertTrue(path,cppTestUser.hasPrivileges(tree,expected.toArray(new String[expected.size()])));
      assertFalse(path,cppTestUser.hasPrivileges(tree,JCR_ADD_CHILD_NODES));
      assertFalse(path,cppTestUser.hasPrivileges(tree,REP_ADD_PROPERTIES));
      assertFalse(path,cppTestUser.hasPrivileges(tree,JCR_MODIFY_PROPERTIES));
    }
 else {
      assertTrue(path,cppTestUser.hasPrivileges(tree,defaultPrivs.toArray(new String[defaultPrivs.size()])));
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testIsGrantedPropertyAdmin() throws Exception {
  for (  String p : NODE_PATHS) {
    Tree tree=readOnlyRoot.getTree(p);
    if (testProvider.isSupported(p)) {
      assertTrue(cppAdminUser.isGranted(tree,PROPERTY_STATE,Permissions.diff(Permissions.ALL,Permissions.ADD_NODE | Permissions.ADD_PROPERTY)));
      assertFalse(cppAdminUser.isGranted(tree,PROPERTY_STATE,Permissions.ADD_NODE));
      assertFalse(cppAdminUser.isGranted(tree,PROPERTY_STATE,Permissions.ADD_PROPERTY));
      assertFalse(cppAdminUser.isGranted(tree,PROPERTY_STATE,Permissions.ADD_NODE | Permissions.ADD_PROPERTY));
      assertFalse(cppAdminUser.isGranted(tree,PROPERTY_STATE,Permissions.WRITE));
    }
 else {
      assertTrue(cppAdminUser.isGranted(tree,PROPERTY_STATE,Permissions.ALL));
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-12 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIsGrantedAction() throws Exception {
  Set<String> denied=ImmutableSet.of(Session.ACTION_ADD_NODE,JackrabbitSession.ACTION_ADD_PROPERTY);
  for (  String p : defActionsGranted.keySet()) {
    String[] actions=defActionsGranted.get(p);
    if (testProvider.isSupported(p)) {
      Set<String> expected=Sets.newHashSet(actions);
      expected.removeAll(denied);
      boolean canSetProperty=TreeLocation.create(readOnlyRoot,p).getProperty() != null;
      if (!canSetProperty) {
        expected.remove(Session.ACTION_SET_PROPERTY);
      }
      assertTrue(p,cppTestUser.isGranted(p,getActionString(expected.toArray(new String[expected.size()]))));
      assertEquals(p,canSetProperty,cppTestUser.isGranted(p,Session.ACTION_SET_PROPERTY));
      assertFalse(p,cppTestUser.isGranted(p,Session.ACTION_ADD_NODE));
      assertFalse(p,cppTestUser.isGranted(p,JackrabbitSession.ACTION_ADD_PROPERTY));
    }
 else {
      assertTrue(p,cppTestUser.isGranted(p,getActionString(actions)));
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testTreePermissionIsGrantedAdmin(){
  TreePermission parentPermission=TreePermission.EMPTY;
  for (  String path : TP_PATHS) {
    TreePermission tp=cppAdminUser.getTreePermission(readOnlyRoot.getTree(path),parentPermission);
    if (testProvider.isSupported(path)) {
      assertTrue(path,tp.isGranted(Permissions.diff(Permissions.ALL,Permissions.ADD_NODE | Permissions.ADD_PROPERTY)));
      assertFalse(path,tp.isGranted(Permissions.ADD_PROPERTY | Permissions.ADD_NODE));
      assertFalse(path,tp.isGranted(Permissions.ALL));
    }
 else {
      assertTrue(path,tp.isGranted(Permissions.ALL));
    }
    parentPermission=tp;
  }
  parentPermission=TreePermission.EMPTY;
  for (  String nodePath : PATH_OUTSIDE_SCOPE) {
    Tree tree=readOnlyRoot.getTree(nodePath);
    TreePermission tp=cppAdminUser.getTreePermission(tree,parentPermission);
    assertTrue(nodePath,tp.isGranted(Permissions.ALL));
    parentPermission=tp;
  }
}

</code></pre>

<br>
<pre class="type-9 type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testIsGranted() throws Exception {
  for (  String p : defPermissions.keySet()) {
    long defaultPerms=defPermissions.get(p);
    Tree tree=readOnlyRoot.getTree(p);
    if (testProvider.isSupported(p)) {
      long expected=Permissions.diff(defaultPerms,Permissions.ADD_NODE | Permissions.ADD_PROPERTY);
      assertTrue(cppTestUser.isGranted(tree,null,expected));
      assertFalse(cppTestUser.isGranted(tree,null,Permissions.ADD_NODE));
      assertFalse(cppTestUser.isGranted(tree,null,Permissions.ADD_PROPERTY));
      assertFalse(cppTestUser.isGranted(tree,null,Permissions.SET_PROPERTY));
      assertFalse(cppTestUser.isGranted(tree,null,Permissions.WRITE));
    }
 else {
      assertTrue(cppTestUser.isGranted(tree,null,defaultPerms));
    }
  }
}

</code></pre>

<br>
<pre class="type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testIsGrantedActionAdmin() throws Exception {
  String[] grantedActions=new String[]{Session.ACTION_READ,JackrabbitSession.ACTION_REMOVE_NODE,JackrabbitSession.ACTION_MODIFY_PROPERTY,JackrabbitSession.ACTION_REMOVE_PROPERTY,Session.ACTION_REMOVE,JackrabbitSession.ACTION_READ_ACCESS_CONTROL,JackrabbitSession.ACTION_MODIFY_ACCESS_CONTROL,JackrabbitSession.ACTION_LOCKING,JackrabbitSession.ACTION_NODE_TYPE_MANAGEMENT,JackrabbitSession.ACTION_VERSIONING,JackrabbitSession.ACTION_USER_MANAGEMENT};
  for (  String path : NODE_PATHS) {
    if (testProvider.isSupported(path)) {
      assertTrue(cppAdminUser.isGranted(path,getActionString(grantedActions)));
      assertFalse(cppAdminUser.isGranted(path,Session.ACTION_ADD_NODE));
      assertFalse(cppAdminUser.isGranted(path,Session.ACTION_SET_PROPERTY));
      assertFalse(cppAdminUser.isGranted(path,JackrabbitSession.ACTION_ADD_PROPERTY));
    }
 else {
      assertTrue(cppAdminUser.isGranted(path,Permissions.getString(Permissions.ALL)));
      assertTrue(cppAdminUser.isGranted(path,getActionString(ALL_ACTIONS)));
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testHasPrivilegesAdmin() throws Exception {
  Set<String> expectedAllowed=pbp.getPrivilegeNames(pbp.getBits(JCR_ALL).modifiable().diff(pbp.getBits(JCR_ADD_CHILD_NODES,REP_ADD_PROPERTIES)));
  for (  String path : NODE_PATHS) {
    Tree tree=readOnlyRoot.getTree(path);
    if (testProvider.isSupported(path)) {
      assertTrue(cppAdminUser.hasPrivileges(tree,expectedAllowed.toArray(new String[expectedAllowed.size()])));
      assertFalse(cppAdminUser.hasPrivileges(tree,JCR_ADD_CHILD_NODES));
      assertFalse(cppAdminUser.hasPrivileges(tree,REP_ADD_PROPERTIES));
      assertFalse(cppAdminUser.hasPrivileges(tree,JCR_WRITE));
    }
 else {
      assertTrue(cppAdminUser.hasPrivileges(tree,JCR_ALL));
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.authorization.evaluation.TreeTest </h4><pre class="type-12 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
"></span><br>
/** 
 * @see <a href="https://issues.apache.org/jira/browse/OAK-842">OAK-842</a>
 */
@Test public void testOrderableChildren() throws Exception {
  Tree a=root.getTree("/a");
  a.setOrderableChildren(true);
  testRoot.refresh();
  for (  Tree t : testRoot.getTree("/a").getChildren()) {
    if (!"b".equals(t.getName())) {
      fail("Child " + t.getName() + " should not be accessible.");
    }
  }
}

</code></pre>

<br>
<pre class="type-12 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testGetChildren() throws Exception {
  for (  Tree t : testRoot.getTree("/a").getChildren()) {
    if (!"b".equals(t.getName())) {
      fail("Child " + t.getName() + " should not be accessible.");
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.authorization.permission.PermissionHookTest </h4><pre class="type-9 type-12 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @see <a href="https://issues.apache.org/jira/browse/OAK-2015">OAK-2015</a>
 */
@Test public void testDynamicJcrAll() throws Exception {
  AccessControlManager acMgr=getAccessControlManager(root);
  JackrabbitAccessControlList acl=AccessControlUtils.getAccessControlList(acMgr,childPath);
  acl.addAccessControlEntry(EveryonePrincipal.getInstance(),privilegesFromNames(JCR_ALL));
  acMgr.setPolicy(childPath,acl);
  root.commit();
  Tree allEntry=getEntry(EveryonePrincipal.NAME,childPath,0);
  assertTrue(allEntry.exists());
  PropertyState ps=allEntry.getProperty(PermissionConstants.REP_PRIVILEGE_BITS);
  assertEquals(1,ps.count());
  assertEquals(PermissionStore.DYNAMIC_ALL_BITS,ps.getValue(Type.LONG,0).longValue());
  Set<Principal> principalSet=ImmutableSet.<Principal>of(EveryonePrincipal.getInstance());
  PermissionProvider permissionProvider=getConfig(AuthorizationConfiguration.class).getPermissionProvider(root,root.getContentSession().getWorkspaceName(),principalSet);
  Tree childTree=root.getTree(childPath);
  assertTrue(permissionProvider.hasPrivileges(childTree,PrivilegeConstants.JCR_ALL));
  assertTrue(permissionProvider.getPrivileges(childTree).contains(PrivilegeConstants.JCR_ALL));
  long diff=Permissions.diff(Permissions.ALL,Permissions.REMOVE_NODE | Permissions.ADD_NODE);
  assertFalse(permissionProvider.isGranted(childTree,null,Permissions.REMOVE_NODE));
  assertFalse(permissionProvider.isGranted(childTree,null,Permissions.ADD_NODE));
  assertTrue(permissionProvider.isGranted(childTree,null,diff));
  acl=AccessControlUtils.getAccessControlList(acMgr,childPath);
  for (  AccessControlEntry ace : acl.getAccessControlEntries()) {
    if (EveryonePrincipal.NAME.equals(ace.getPrincipal().getName())) {
      acl.removeAccessControlEntry(ace);
    }
  }
  acMgr.setPolicy(childPath,acl);
  root.commit();
  Tree everyoneRoot=getPrincipalRoot(EveryonePrincipal.NAME);
  Tree parent=everyoneRoot.getChild(PermissionUtil.getEntryName(childPath));
  if (parent.exists()) {
    assertFalse(parent.getChild("0").exists());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.authorization.restriction.RestrictionProviderImplTest </h4><pre class="type-12 type-5 type-7 type-6 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetSupportedDefinitions(){
  assertTrue(provider.getSupportedRestrictions(null).isEmpty());
  Set<RestrictionDefinition> defs=provider.getSupportedRestrictions("/testPath");
  assertNotNull(defs);
  assertEquals(4,defs.size());
  for (  RestrictionDefinition def : defs) {
    if (REP_GLOB.equals(def.getName())) {
      assertEquals(Type.STRING,def.getRequiredType());
      assertFalse(def.isMandatory());
    }
 else     if (REP_NT_NAMES.equals(def.getName())) {
      assertEquals(Type.NAMES,def.getRequiredType());
      assertFalse(def.isMandatory());
    }
 else     if (REP_PREFIXES.equals(def.getName())) {
      assertEquals(Type.STRINGS,def.getRequiredType());
      assertFalse(def.isMandatory());
    }
 else     if (REP_ITEM_NAMES.equals(def.getName())) {
      assertEquals(Type.NAMES,def.getRequiredType());
      assertFalse(def.isMandatory());
    }
 else {
      fail("unexpected restriction " + def.getName());
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.principal.PrincipalProviderImplTest </h4><pre class="type-13 type-9 type-12 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
"></span><br>
@Test public void testEveryoneMembers() throws Exception {
  Principal everyone=principalProvider.getPrincipal(EveryonePrincipal.NAME);
  assertTrue(everyone instanceof EveryonePrincipal);
  Group everyoneGroup=null;
  try {
    UserManager userMgr=getUserManager(root);
    everyoneGroup=userMgr.createGroup(EveryonePrincipal.NAME);
    root.commit();
    Principal ep=principalProvider.getPrincipal(EveryonePrincipal.NAME);
    Set<? extends Principal> everyoneMembers=ImmutableSet.copyOf(Collections.list(((java.security.acl.Group)ep).members()));
    Iterator<? extends Principal> all=principalProvider.findPrincipals(PrincipalManager.SEARCH_TYPE_ALL);
    while (all.hasNext()) {
      Principal p=all.next();
      if (everyone.equals(p)) {
        assertFalse(everyoneMembers.contains(p));
      }
 else {
        assertTrue(everyoneMembers.contains(p));
      }
    }
  }
  finally {
    if (everyoneGroup != null) {
      everyoneGroup.remove();
      root.commit();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.user.L3_UserVsPrincipalTest </h4><pre class="type-9 type-12 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testLookup() throws RepositoryException {
  Map<String,Object[]> resultMap=ImmutableMap.of(testId,new Object[]{null,null,null},testPrincipal.getName(),new Object[]{null,null,null},testGroupId,new Object[]{null,null},testGroupPrincipal.getName(),new Object[]{null,null});
  for (  String key : resultMap.keySet()) {
    Object[] result=resultMap.get(key);
    Principal expectedP=(Principal)result[0];
    Principal principal=principalManager.getPrincipal(key);
    assertEquals(expectedP,principal);
    Principal p=new PrincipalImpl(key);
    Authorizable a=getUserManager(root).getAuthorizable(p);
    if (a != null) {
      assertEquals(expectedP,a.getPrincipal());
    }
    Authorizable expectedA=(Authorizable)result[1];
    a=getUserManager(root).getAuthorizable(key);
    assertEquals(expectedA,a);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.user.UserManagerImplTest </h4><pre class="type-12 type-7 type-6 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSetPassword() throws Exception {
  User user=userMgr.createUser(testUserId,"pw");
  root.commit();
  List<String> pwds=new ArrayList<String>();
  pwds.add("pw");
  pwds.add("");
  pwds.add("{sha1}pw");
  Tree userTree=root.getTree(user.getPath());
  for (  String pw : pwds) {
    userMgr.setPassword(userTree,testUserId,pw,true);
    String pwHash=userTree.getProperty(UserConstants.REP_PASSWORD).getValue(Type.STRING);
    assertNotNull(pwHash);
    assertTrue(PasswordUtil.isSame(pwHash,pw));
  }
  for (  String pw : pwds) {
    userMgr.setPassword(userTree,testUserId,pw,false);
    String pwHash=userTree.getProperty(UserConstants.REP_PASSWORD).getValue(Type.STRING);
    assertNotNull(pwHash);
    if (!pw.startsWith("{")) {
      assertTrue(PasswordUtil.isSame(pwHash,pw));
    }
 else {
      assertFalse(PasswordUtil.isSame(pwHash,pw));
      assertEquals(pw,pwHash);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.user.UserPrincipalProviderTest </h4><pre class="type-12 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
"></span><br>
@Test public void testGetPrincipalsForSystemUser() throws Exception {
  User systemUser=getUserManager(root).createSystemUser("systemUser" + UUID.randomUUID(),null);
  Group group=getUserManager(root).createGroup("testGroup" + UUID.randomUUID());
  group.addMember(systemUser);
  root.commit();
  try {
    Set<? extends Principal> principals=principalProvider.getPrincipals(systemUser.getID());
    for (    Principal p : principals) {
      String name=p.getName();
      if (name.equals(systemUser.getPrincipal().getName())) {
        assertTrue(p instanceof SystemUserPrincipalImpl);
      }
 else       if (!EveryonePrincipal.NAME.equals(name)) {
        assertTrue(p instanceof AbstractGroupPrincipal);
      }
    }
  }
  finally {
    systemUser.remove();
    group.remove();
    root.commit();
  }
}

</code></pre>

<br>
<pre class="type-12 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
"></span><br>
@Test public void testGetPrincipalsForUser() throws Exception {
  Group group=getUserManager(root).createGroup("testGroup" + UUID.randomUUID());
  group.addMember(getTestUser());
  root.commit();
  try {
    Set<? extends Principal> principals=principalProvider.getPrincipals(getTestUser().getID());
    for (    Principal p : principals) {
      String name=p.getName();
      if (name.equals(getTestUser().getPrincipal().getName())) {
        assertTrue(p instanceof TreeBasedPrincipal);
      }
 else       if (!EveryonePrincipal.NAME.equals(name)) {
        assertTrue(p instanceof AbstractGroupPrincipal);
      }
    }
  }
  finally {
    group.remove();
    root.commit();
  }
}

</code></pre>

<br>
<pre class="type-12 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
"></span><br>
@Test public void testGetPrincipalsForAdminUser() throws Exception {
  Authorizable adminUser=getUserManager(root).getAuthorizable(adminSession.getAuthInfo().getUserID());
  if (adminUser != null && adminUser.getPrincipal() instanceof AdminPrincipal) {
    Set<? extends Principal> principals=principalProvider.getPrincipals(adminUser.getID());
    for (    Principal p : principals) {
      String name=p.getName();
      if (name.equals(adminUser.getPrincipal().getName())) {
        assertTrue(p instanceof AdminPrincipalImpl);
      }
 else       if (!EveryonePrincipal.NAME.equals(name)) {
        assertTrue(p instanceof AbstractGroupPrincipal);
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.user.UserPrincipalProviderWithCacheTest </h4><pre class="type-12 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testConcurrentLoginWithCacheRemoval() throws Exception {
  changeUserConfiguration(ConfigurationParameters.of(UserPrincipalProvider.PARAM_CACHE_EXPIRATION,1));
  final List<Exception> exceptions=new ArrayList<Exception>();
  List<Thread> threads=new ArrayList<Thread>();
  for (int i=0; i < 100; i++) {
    threads.add(new Thread(new Runnable(){
      public void run(){
        try {
          login(new SimpleCredentials(userId,userId.toCharArray())).close();
        }
 catch (        Exception e) {
          exceptions.add(e);
        }
      }
    }
));
  }
  for (  Thread t : threads) {
    t.start();
  }
  for (  Thread t : threads) {
    t.join();
  }
  for (  Exception e : exceptions) {
    e.printStackTrace();
  }
  if (!exceptions.isEmpty()) {
    fail();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.user.UserProviderTest </h4><pre class="type-12 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testRemoveParentTree() throws Exception {
  UserProvider up=createUserProvider();
  Tree u1=up.createUser("b","b");
  Tree u2=up.createUser("bb","bb");
  Tree folder=root.getTree(Text.getRelativeParent(u1.getPath(),2));
  folder.remove();
  if (up.getAuthorizable("b") != null) {
    fail("Removing the top authorizable folder must remove all users contained.");
    u1.remove();
  }
  if (up.getAuthorizable("bb") != null) {
    fail("Removing the top authorizable folder must remove all users contained.");
    u2.remove();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.user.autosave.AutoSaveEnabledManagerTest </h4><pre class="type-9 type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testGroup() throws Exception {
  User u=mgr.createUser("u","u");
  Group g=mgr.createGroup("g");
  assertTrue(g.addMember(u));
  assertFalse(root.hasPendingChanges());
  assertTrue(g.isDeclaredMember(u));
  Iterator<Authorizable> it=g.getDeclaredMembers();
  if (it.hasNext()) {
    Authorizable a=it.next();
    assertTrue(a instanceof AuthorizableImpl);
    a.setProperty("prop",getValueFactory().createValue("blub"));
    assertFalse(root.hasPendingChanges());
  }
  it=g.getMembers();
  if (it.hasNext()) {
    Authorizable a=it.next();
    assertTrue(a instanceof AuthorizableImpl);
    a.setProperty("prop",getValueFactory().createValue("blub"));
    assertFalse(root.hasPendingChanges());
  }
  assertTrue(g.removeMember(u));
  assertFalse(root.hasPendingChanges());
  assertFalse(g.isDeclaredMember(u));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.spi.blob.AbstractBlobStoreTest </h4><pre class="type-12 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testIllegalIdentifier3() throws Exception {
  if (store instanceof AbstractBlobStore) {
    try {
      ((AbstractBlobStore)store).mark("ff");
      fail();
    }
 catch (    Exception e) {
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.spi.security.ConfigurationParametersTest </h4><pre class="type-9 type-12 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testConversionToSet(){
  String[] stringArray=new String[]{"a","b"};
  Set<String> stringSet=ImmutableSet.copyOf(stringArray);
  TestObject[] testObjectArray=new TestObject[]{new TestObject("a"),new TestObject("b")};
  Set<TestObject> testObjectSet=ImmutableSet.copyOf(testObjectArray);
  Map<Object,Set> configValues=new HashMap<Object,Set>();
  configValues.put("a",ImmutableSet.of("a"));
  configValues.put(stringArray,stringSet);
  configValues.put(stringSet,stringSet);
  configValues.put(testObjectArray,testObjectSet);
  configValues.put(testObjectSet,testObjectSet);
  configValues.put(new String[0],Collections.<String>emptySet());
  configValues.put(new HashSet(),Collections.emptySet());
  configValues.put(ImmutableSet.of(),Collections.emptySet());
  configValues.put(new ArrayList(),Collections.emptySet());
  configValues.put(ConfigurationParameters.EMPTY,Collections.<String>emptySet());
  Set<String> defaultStrings=ImmutableSet.of("abc","def","ghi");
  Set<TestObject> defaultObjects=ImmutableSet.of(new TestObject("abc"),new TestObject("def"));
  for (  Object value : configValues.keySet()) {
    ConfigurationParameters config;
    if (value instanceof ConfigurationParameters) {
      config=ConfigurationParameters.of((ConfigurationParameters)value);
    }
 else {
      config=ConfigurationParameters.of("key",value);
    }
    Set expected=configValues.get(value);
    assertEquals(expected,config.getConfigValue("key",Collections.emptySet()));
    assertEquals(expected,config.getConfigValue("key",Collections.<String>emptySet()));
    assertEquals(expected,config.getConfigValue("key",ImmutableSet.of()));
    assertEquals(expected,config.getConfigValue("key",Collections.emptySet(),Set.class));
    assertEquals(expected,config.getConfigValue("key",Collections.<String>emptySet(),Set.class));
    assertEquals(expected,config.getConfigValue("key",ImmutableSet.of(),Set.class));
    if (!config.containsKey("key")) {
      assertEquals(defaultStrings,config.getConfigValue("key",defaultStrings,Set.class));
      assertEquals(defaultObjects,config.getConfigValue("key",defaultObjects,Set.class));
      assertEquals(null,config.getConfigValue("key",null,Set.class));
      assertEquals(defaultStrings,config.getConfigValue("key",defaultStrings));
      assertEquals(defaultObjects,config.getConfigValue("key",defaultObjects));
    }
 else {
      assertEquals(expected,config.getConfigValue("key",defaultStrings,Set.class));
      assertEquals(expected,config.getConfigValue("key",defaultObjects,Set.class));
      assertEquals(expected,config.getConfigValue("key",null,Set.class));
      assertEquals(expected,config.getConfigValue("key",defaultStrings));
      assertEquals(expected,config.getConfigValue("key",defaultObjects));
    }
    assertEquals(defaultStrings,config.getConfigValue("nonexisting",defaultStrings));
    assertEquals(defaultStrings,config.getConfigValue("nonexisting",defaultStrings,Set.class));
    assertEquals(defaultObjects,config.getConfigValue("nonexisting",defaultObjects));
    assertEquals(defaultObjects,config.getConfigValue("nonexisting",defaultObjects,Set.class));
  }
}

</code></pre>

<br>
<pre class="type-9 type-12 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testConversionToStringArray(){
  String[] stringArray=new String[]{"a","b"};
  Set<String> stringSet=ImmutableSet.copyOf(stringArray);
  TestObject[] testObjectArray=new TestObject[]{new TestObject("a"),new TestObject("b")};
  Set<TestObject> testObjectSet=ImmutableSet.copyOf(testObjectArray);
  String[] defaultStrings=new String[]{"abc","def","ghi"};
  Map<Object,Object[]> configValues=new HashMap<Object,Object[]>();
  configValues.put("a",new String[]{"a"});
  configValues.put(stringArray,stringArray);
  configValues.put(stringSet,stringArray);
  configValues.put(testObjectArray,stringArray);
  configValues.put(testObjectSet,stringArray);
  configValues.put(new String[0],new String[0]);
  configValues.put(new HashSet(),new String[0]);
  configValues.put(ImmutableSet.of(),new String[0]);
  configValues.put(new ArrayList(),new String[0]);
  configValues.put(ConfigurationParameters.EMPTY,new String[0]);
  for (  Object value : configValues.keySet()) {
    ConfigurationParameters config;
    if (value instanceof ConfigurationParameters) {
      config=ConfigurationParameters.of((ConfigurationParameters)value);
    }
 else {
      config=ConfigurationParameters.of("key",value);
    }
    Object[] expected=configValues.get(value);
    assertArrayEquals(expected,config.getConfigValue("key",new String[0]));
    assertArrayEquals(expected,config.getConfigValue("key",new String[0],String[].class));
    if (!config.containsKey("key")) {
      assertArrayEquals(defaultStrings,config.getConfigValue("key",defaultStrings,String[].class));
      assertArrayEquals(null,config.getConfigValue("key",null,String[].class));
      assertArrayEquals(defaultStrings,config.getConfigValue("key",defaultStrings));
    }
 else {
      assertArrayEquals(expected,config.getConfigValue("key",defaultStrings,String[].class));
      assertArrayEquals(expected,config.getConfigValue("key",null,String[].class));
      assertArrayEquals(expected,config.getConfigValue("key",defaultStrings));
    }
    assertArrayEquals(defaultStrings,config.getConfigValue("nonexisting",defaultStrings));
    assertArrayEquals(defaultStrings,config.getConfigValue("nonexisting",defaultStrings,String[].class));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.spi.security.authorization.cug.impl.CugPermissionProviderTest </h4><pre class="type-9 type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
/** 
 * @see PermissionProvider#isGranted(org.apache.jackrabbit.oak.api.Tree,org.apache.jackrabbit.oak.api.PropertyState,long)
 */
@Test public void testIsGrantedRead(){
  for (  String p : NOT_READABLE_PATHS) {
    Tree tree=root.getTree(p);
    if (tree.exists()) {
      assertFalse(cugPermProvider.isGranted(tree,null,Permissions.READ));
      assertFalse(cugPermProvider.isGranted(tree,tree.getProperty(JCR_PRIMARYTYPE),Permissions.READ_PROPERTY));
    }
  }
  for (  String p : READABLE_PATHS) {
    Tree tree=root.getTree(p);
    if (tree.exists()) {
      assertTrue(cugPermProvider.isGranted(tree,null,Permissions.READ));
      assertTrue(cugPermProvider.isGranted(tree,null,Permissions.READ_NODE));
      assertTrue(cugPermProvider.isGranted(tree,tree.getProperty(JCR_PRIMARYTYPE),Permissions.READ_PROPERTY));
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
/** 
 * @see PermissionProvider#hasPrivileges(org.apache.jackrabbit.oak.api.Tree,String)
 */
@Test public void testHasReadPrivilegesAtCug(){
  for (  String p : READABLE_PATHS) {
    Tree tree=root.getTree(p);
    if (tree.exists()) {
      assertTrue(cugPermProvider.hasPrivileges(tree,PrivilegeConstants.JCR_READ));
      assertTrue(cugPermProvider.hasPrivileges(tree,PrivilegeConstants.REP_READ_NODES));
      assertTrue(cugPermProvider.hasPrivileges(tree,PrivilegeConstants.REP_READ_PROPERTIES));
      assertTrue(cugPermProvider.hasPrivileges(tree,PrivilegeConstants.REP_READ_NODES,PrivilegeConstants.REP_READ_PROPERTIES));
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-12 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * @see PermissionProvider#getPrivileges(org.apache.jackrabbit.oak.api.Tree)
 */
@Test public void testGetPrivilegesAtCug(){
  Set<String> expected=ImmutableSet.of(PrivilegeConstants.JCR_READ,PrivilegeConstants.REP_READ_NODES,PrivilegeConstants.REP_READ_PROPERTIES);
  for (  String p : READABLE_PATHS) {
    Tree tree=root.getTree(p);
    if (tree.exists()) {
      assertEquals(expected,cugPermProvider.getPrivileges(tree));
    }
  }
}

</code></pre>

<br>
<pre class="type-12 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * @see org.apache.jackrabbit.oak.spi.security.authorization.permission.AggregatedPermissionProvider#supportedPermissions(org.apache.jackrabbit.oak.spi.security.authorization.permission.TreePermission,org.apache.jackrabbit.oak.api.PropertyState,long)
 */
@Test public void testSupportedPermissionsByTreePermission(){
  TreePermission rootTp=cugPermProvider.getTreePermission(root.getTree("/"),TreePermission.EMPTY);
  Map<TreePermission,Boolean> tpMap=new HashMap<TreePermission,Boolean>();
  TreePermission contentTp=cugPermProvider.getTreePermission(root.getTree(SUPPORTED_PATH),rootTp);
  tpMap.put(contentTp,false);
  TreePermission aTp=cugPermProvider.getTreePermission(root.getTree("/content/a"),contentTp);
  tpMap.put(aTp,true);
  tpMap.put(cugPermProvider.getTreePermission(root.getTree("/content/a/rep:cugPolicy"),aTp),true);
  TreePermission bTp=cugPermProvider.getTreePermission(root.getTree("/content/a/b"),aTp);
  tpMap.put(bTp,true);
  tpMap.put(cugPermProvider.getTreePermission(root.getTree("/content/a/b/c"),bTp),true);
  TreePermission aaTp=cugPermProvider.getTreePermission(root.getTree("/content/aa"),contentTp);
  tpMap.put(aaTp,false);
  TreePermission bbTp=cugPermProvider.getTreePermission(root.getTree("/content/aa/bb"),aaTp);
  tpMap.put(cugPermProvider.getTreePermission(root.getTree("/content/aa/bb/cc"),bbTp),true);
  tpMap.put(cugPermProvider.getTreePermission(root.getTree("/jcr:system"),rootTp),false);
  tpMap.put(rootTp,false);
  tpMap.put(cugPermProvider.getTreePermission(root.getTree(UNSUPPORTED_PATH),rootTp),false);
  for (  TreePermission tp : tpMap.keySet()) {
    boolean isInCug=tpMap.get(tp);
    if (isInCug) {
      assertEquals(Permissions.READ,cugPermProvider.supportedPermissions(tp,null,Permissions.READ));
      assertEquals(Permissions.READ_NODE,cugPermProvider.supportedPermissions(tp,null,Permissions.READ_NODE));
      assertEquals(Permissions.READ_PROPERTY,cugPermProvider.supportedPermissions(tp,null,Permissions.READ_PROPERTY));
      assertEquals(Permissions.READ,cugPermProvider.supportedPermissions(tp,null,Permissions.ALL));
      assertEquals(Permissions.READ_NODE,cugPermProvider.supportedPermissions(tp,null,Permissions.READ_NODE | Permissions.READ_ACCESS_CONTROL));
    }
 else {
      assertEquals(Permissions.NO_PERMISSION,cugPermProvider.supportedPermissions(tp,null,Permissions.READ));
      assertEquals(Permissions.NO_PERMISSION,cugPermProvider.supportedPermissions(tp,null,Permissions.READ_NODE));
      assertEquals(Permissions.NO_PERMISSION,cugPermProvider.supportedPermissions(tp,null,Permissions.READ_PROPERTY));
      assertEquals(Permissions.NO_PERMISSION,cugPermProvider.supportedPermissions(tp,null,Permissions.ALL));
      assertEquals(Permissions.NO_PERMISSION,cugPermProvider.supportedPermissions(tp,null,Permissions.READ_NODE | Permissions.READ_ACCESS_CONTROL));
    }
    assertEquals(Permissions.NO_PERMISSION,cugPermProvider.supportedPermissions(tp,null,Permissions.ADD_NODE | Permissions.REMOVE));
  }
}

</code></pre>

<br>
<pre class="type-12 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
"></span><br>
/** 
 * @see PermissionProvider#getPrivileges(org.apache.jackrabbit.oak.api.Tree)
 */
@Test public void getPrivileges(){
  for (  String p : NOT_READABLE_PATHS) {
    Tree tree=root.getTree(p);
    if (tree.exists()) {
      assertTrue(cugPermProvider.getPrivileges(root.getTree(p)).isEmpty());
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-12 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * @see org.apache.jackrabbit.oak.spi.security.authorization.permission.AggregatedPermissionProvider#supportedPermissions(org.apache.jackrabbit.oak.plugins.tree.TreeLocation,long)
 */
@Test public void testSupportedPermissionsByLocation(){
  for (  String path : PATH_INCUG_MAP.keySet()) {
    boolean isInCug=PATH_INCUG_MAP.get(path);
    TreeLocation location=TreeLocation.create(root,path);
    if (isInCug) {
      assertEquals(path,Permissions.READ,cugPermProvider.supportedPermissions(location,Permissions.READ));
      assertEquals(path,Permissions.READ_NODE,cugPermProvider.supportedPermissions(location,Permissions.READ_NODE));
      assertEquals(path,Permissions.READ_PROPERTY,cugPermProvider.supportedPermissions(location,Permissions.READ_PROPERTY));
      assertEquals(path,Permissions.READ,cugPermProvider.supportedPermissions(location,Permissions.ALL));
      assertEquals(path,Permissions.READ_NODE,cugPermProvider.supportedPermissions(location,Permissions.READ_NODE | Permissions.READ_ACCESS_CONTROL));
    }
 else {
      assertEquals(path,Permissions.NO_PERMISSION,cugPermProvider.supportedPermissions(location,Permissions.READ));
      assertEquals(path,Permissions.NO_PERMISSION,cugPermProvider.supportedPermissions(location,Permissions.READ_NODE));
      assertEquals(path,Permissions.NO_PERMISSION,cugPermProvider.supportedPermissions(location,Permissions.READ_PROPERTY));
      assertEquals(path,Permissions.NO_PERMISSION,cugPermProvider.supportedPermissions(location,Permissions.ALL));
      assertEquals(path,Permissions.NO_PERMISSION,cugPermProvider.supportedPermissions(location,Permissions.READ_NODE | Permissions.READ_ACCESS_CONTROL));
    }
    assertEquals(path,Permissions.NO_PERMISSION,cugPermProvider.supportedPermissions(location,Permissions.READ_ACCESS_CONTROL));
    assertEquals(path,Permissions.NO_PERMISSION,cugPermProvider.supportedPermissions(location,Permissions.MODIFY_ACCESS_CONTROL));
    assertEquals(path,Permissions.NO_PERMISSION,cugPermProvider.supportedPermissions(location,Permissions.ADD_NODE));
    assertEquals(path,Permissions.NO_PERMISSION,cugPermProvider.supportedPermissions(location,Permissions.WRITE));
    assertEquals(path,Permissions.NO_PERMISSION,cugPermProvider.supportedPermissions(TreeLocation.create(root,"/path/to/no-existing/tree"),Permissions.READ));
  }
}

</code></pre>

<br>
<pre class="type-9 type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
/** 
 * @see org.apache.jackrabbit.oak.spi.security.authorization.permission.AggregatedPermissionProvider#supportedPrivileges(org.apache.jackrabbit.oak.api.Tree,org.apache.jackrabbit.oak.spi.security.privilege.PrivilegeBits)
 */
@Test public void testSupportedPrivileges(){
  PrivilegeBits readBits=PrivilegeBits.BUILT_IN.get(PrivilegeConstants.JCR_READ);
  PrivilegeBits readNodeBits=PrivilegeBits.BUILT_IN.get(PrivilegeConstants.REP_READ_NODES);
  PrivilegeBits readPropBits=PrivilegeBits.BUILT_IN.get(PrivilegeConstants.REP_READ_PROPERTIES);
  PrivilegeBitsProvider provider=new PrivilegeBitsProvider(root);
  for (  String path : PATH_INCUG_MAP.keySet()) {
    boolean isInCug=PATH_INCUG_MAP.get(path);
    Tree tree=root.getTree(path);
    if (isInCug) {
      assertPrivilegeBits(readBits,cugPermProvider.supportedPrivileges(tree,readBits));
      assertPrivilegeBits(readNodeBits,cugPermProvider.supportedPrivileges(tree,readNodeBits));
      assertPrivilegeBits(readPropBits,cugPermProvider.supportedPrivileges(tree,readPropBits));
      assertPrivilegeBits(readBits,cugPermProvider.supportedPrivileges(tree,provider.getBits(PrivilegeConstants.JCR_ALL)));
      assertPrivilegeBits(readNodeBits,cugPermProvider.supportedPrivileges(tree,provider.getBits(PrivilegeConstants.REP_READ_NODES,PrivilegeConstants.JCR_READ_ACCESS_CONTROL)));
    }
 else {
      assertTrue(cugPermProvider.supportedPrivileges(tree,readBits).isEmpty());
      assertTrue(cugPermProvider.supportedPrivileges(tree,readNodeBits).isEmpty());
      assertTrue(cugPermProvider.supportedPrivileges(tree,readPropBits).isEmpty());
      assertTrue(cugPermProvider.supportedPrivileges(tree,provider.getBits(PrivilegeConstants.JCR_ALL)).isEmpty());
      assertTrue(cugPermProvider.supportedPrivileges(tree,provider.getBits(PrivilegeConstants.REP_READ_NODES,PrivilegeConstants.JCR_READ_ACCESS_CONTROL)).isEmpty());
    }
    assertTrue(cugPermProvider.supportedPrivileges(tree,provider.getBits(PrivilegeConstants.REP_WRITE)).isEmpty());
    assertTrue(cugPermProvider.supportedPrivileges(tree,provider.getBits(PrivilegeConstants.JCR_ADD_CHILD_NODES,PrivilegeConstants.JCR_REMOVE_CHILD_NODES,PrivilegeConstants.JCR_REMOVE_NODE)).isEmpty());
    assertTrue(cugPermProvider.supportedPrivileges(tree,provider.getBits(PrivilegeConstants.JCR_READ_ACCESS_CONTROL)).isEmpty());
  }
}

</code></pre>

<br>
<pre class="type-9 type-12 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * @see org.apache.jackrabbit.oak.spi.security.authorization.permission.AggregatedPermissionProvider#supportedPermissions(org.apache.jackrabbit.oak.api.Tree,org.apache.jackrabbit.oak.api.PropertyState,long)
 */
@Test public void testSupportedPermissionsByTree(){
  for (  String path : PATH_INCUG_MAP.keySet()) {
    boolean isInCug=PATH_INCUG_MAP.get(path);
    Tree tree=root.getTree(path);
    if (isInCug) {
      assertEquals(Permissions.READ,cugPermProvider.supportedPermissions(tree,null,Permissions.READ));
      assertEquals(Permissions.READ_NODE,cugPermProvider.supportedPermissions(tree,null,Permissions.READ_NODE));
      assertEquals(Permissions.READ_PROPERTY,cugPermProvider.supportedPermissions(tree,null,Permissions.READ_PROPERTY));
      assertEquals(Permissions.READ,cugPermProvider.supportedPermissions(tree,null,Permissions.ALL));
      assertEquals(Permissions.READ_NODE,cugPermProvider.supportedPermissions(tree,null,Permissions.READ_NODE | Permissions.READ_ACCESS_CONTROL));
    }
 else {
      assertEquals(Permissions.NO_PERMISSION,cugPermProvider.supportedPermissions(tree,null,Permissions.READ));
      assertEquals(Permissions.NO_PERMISSION,cugPermProvider.supportedPermissions(tree,null,Permissions.READ_NODE));
      assertEquals(Permissions.NO_PERMISSION,cugPermProvider.supportedPermissions(tree,null,Permissions.READ_PROPERTY));
      assertEquals(Permissions.NO_PERMISSION,cugPermProvider.supportedPermissions(tree,null,Permissions.ALL));
      assertEquals(Permissions.NO_PERMISSION,cugPermProvider.supportedPermissions(tree,null,Permissions.READ_NODE | Permissions.READ_ACCESS_CONTROL));
    }
    assertEquals(Permissions.NO_PERMISSION,cugPermProvider.supportedPermissions(tree,null,Permissions.WRITE));
    assertEquals(Permissions.NO_PERMISSION,cugPermProvider.supportedPermissions(tree,null,Permissions.ADD_NODE | Permissions.REMOVE));
    assertEquals(Permissions.NO_PERMISSION,cugPermProvider.supportedPermissions(tree,null,Permissions.READ_ACCESS_CONTROL));
  }
}

</code></pre>

<br>
<pre class="type-9 type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
/** 
 * @see PermissionProvider#hasPrivileges(org.apache.jackrabbit.oak.api.Tree,String)
 */
@Test public void testHasNonReadPrivileges(){
  for (  String p : Iterables.concat(READABLE_PATHS,NOT_READABLE_PATHS)) {
    Tree tree=root.getTree(p);
    if (tree.exists()) {
      assertFalse(cugPermProvider.hasPrivileges(tree,PrivilegeConstants.JCR_WRITE));
      assertFalse(cugPermProvider.hasPrivileges(tree,PrivilegeConstants.JCR_LIFECYCLE_MANAGEMENT));
      assertFalse(cugPermProvider.hasPrivileges(tree,PrivilegeConstants.JCR_READ,PrivilegeConstants.JCR_LIFECYCLE_MANAGEMENT));
      assertFalse(cugPermProvider.hasPrivileges(tree,PrivilegeConstants.JCR_READ_ACCESS_CONTROL));
      assertFalse(cugPermProvider.hasPrivileges(tree,PrivilegeConstants.JCR_ALL));
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
/** 
 * @see PermissionProvider#hasPrivileges(org.apache.jackrabbit.oak.api.Tree,String)
 */
@Test public void testHasReadPrivileges(){
  for (  String p : NOT_READABLE_PATHS) {
    Tree tree=root.getTree(p);
    if (tree.exists()) {
      assertFalse(cugPermProvider.hasPrivileges(tree,PrivilegeConstants.JCR_READ));
      assertFalse(cugPermProvider.hasPrivileges(tree,PrivilegeConstants.REP_READ_NODES));
      assertFalse(cugPermProvider.hasPrivileges(tree,PrivilegeConstants.REP_READ_PROPERTIES));
      assertFalse(cugPermProvider.hasPrivileges(tree,PrivilegeConstants.REP_READ_NODES,PrivilegeConstants.REP_READ_PROPERTIES));
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
/** 
 * @see PermissionProvider#isGranted(org.apache.jackrabbit.oak.api.Tree,org.apache.jackrabbit.oak.api.PropertyState,long)
 */
@Test public void testIsGrantedNonRead(){
  for (  String p : Iterables.concat(READABLE_PATHS,NOT_READABLE_PATHS)) {
    Tree tree=root.getTree(p);
    if (tree.exists()) {
      assertFalse(cugPermProvider.isGranted(tree,null,Permissions.ALL));
      assertFalse(cugPermProvider.isGranted(tree,null,Permissions.READ | Permissions.READ_ACCESS_CONTROL));
      assertFalse(cugPermProvider.isGranted(tree,null,Permissions.REMOVE_NODE));
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.spi.security.authorization.cug.impl.VersionTest </h4><pre class="type-12 type-7 type-6 type-19 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTreePermissionVersionableUnsupportedPath() throws Exception {
  Tree versionable=root.getTree(UNSUPPORTED_PATH);
  Tree vh=checkNotNull(versionManager.getVersionHistory(versionable));
  CugPermissionProvider pp=createCugPermissionProvider(ImmutableSet.of(SUPPORTED_PATH,SUPPORTED_PATH2));
  Tree t=root.getTree("/");
  TreePermission tp=pp.getTreePermission(t,TreePermission.EMPTY);
  for (  String segm : PathUtils.elements(vh.getPath())) {
    t=t.getChild(segm);
    tp=pp.getTreePermission(t,tp);
    if (JCR_SYSTEM.equals(segm) || ReadOnlyVersionManager.isVersionStoreTree(t)) {
      assertTrue(t.getPath(),tp instanceof EmptyCugTreePermission);
    }
 else {
      assertSame(t.getPath(),TreePermission.NO_RECOURSE,tp);
    }
  }
}

</code></pre>

<br>
<pre class="type-12 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTreePermissionVersionable() throws Exception {
  Tree versionable=root.getTree("/content/a");
  Tree vh=checkNotNull(versionManager.getVersionHistory(versionable));
  CugPermissionProvider pp=createCugPermissionProvider(ImmutableSet.of(SUPPORTED_PATH,SUPPORTED_PATH2),EveryonePrincipal.getInstance());
  Tree t=root.getTree("/");
  TreePermission tp=pp.getTreePermission(t,TreePermission.EMPTY);
  String path=PathUtils.concat(vh.getPath(),"1.0",JCR_FROZENNODE,"b/c");
  for (  String segm : PathUtils.elements(path)) {
    t=t.getChild(segm);
    tp=pp.getTreePermission(t,tp);
    if (JCR_SYSTEM.equals(segm) || ReadOnlyVersionManager.isVersionStoreTree(t)) {
      assertTrue(t.getPath(),tp instanceof EmptyCugTreePermission);
    }
 else {
      assertTrue(t.getPath(),tp instanceof CugTreePermission);
      assertEquals(t.getPath(),"c".equals(segm),tp.canRead());
    }
  }
}

</code></pre>

<br>
<pre class="type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testTreePermissionVersionable2() throws Exception {
  Tree versionable=root.getTree("/content");
  Tree vh=checkNotNull(versionManager.getVersionHistory(versionable));
  CugPermissionProvider pp=createCugPermissionProvider(ImmutableSet.of(SUPPORTED_PATH,SUPPORTED_PATH2));
  Tree t=root.getTree("/");
  TreePermission tp=pp.getTreePermission(t,TreePermission.EMPTY);
  String path=PathUtils.concat(vh.getPath(),"1.0",JCR_FROZENNODE,"aa");
  for (  String segm : PathUtils.elements(path)) {
    t=t.getChild(segm);
    tp=pp.getTreePermission(t,tp);
    if (JCR_SYSTEM.equals(segm) || ReadOnlyVersionManager.isVersionStoreTree(t)) {
      assertTrue(t.getPath(),tp instanceof EmptyCugTreePermission);
    }
 else {
      assertTrue(t.getPath(),tp instanceof CugTreePermission);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.spi.security.authorization.restriction.CompositeRestrictionProviderTest </h4><pre class="type-12 type-5 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadRestrictions() throws Exception {
  NodeUtil aceNode=new NodeUtil(root.getTree("/")).addChild("test",NT_REP_GRANT_ACE);
  aceNode.setBoolean("boolean",true);
  aceNode.setValues("longs",new Value[]{vf.createValue(10),vf.createValue(290)});
  aceNode.setString(REP_GLOB,"*");
  aceNode.setNames(REP_NT_NAMES);
  aceNode.setString("invalid","val");
  aceNode.setStrings("invalid2","val1","val2","val3");
  Set<Restriction> restrictions=provider.readRestrictions("/test",aceNode.getTree());
  assertEquals(4,restrictions.size());
  for (  Restriction r : restrictions) {
    String name=r.getDefinition().getName();
    if (!supported.contains(name)) {
      fail("read unsupported restriction");
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.spi.security.principal.AbstractPrincipalProviderTest </h4><pre class="type-9 type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testAdminPrincipal() throws Exception {
  String userId=adminSession.getAuthInfo().getUserID();
  Authorizable admin=getUserManager(root).getAuthorizable(userId);
  if (admin != null && admin.getPrincipal() instanceof AdminPrincipal) {
    Principal principal=principalProvider.getPrincipal(admin.getPrincipal().getName());
    assertTrue(principal instanceof AdminPrincipal);
    Set<? extends Principal> principals=principalProvider.getPrincipals(userId);
    boolean containsAdminPrincipal=false;
    for (    Principal p : principals) {
      if (p instanceof AdminPrincipal) {
        containsAdminPrincipal=true;
        break;
      }
    }
    assertTrue(containsAdminPrincipal);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.spi.security.privilege.PrivilegeBitsTest </h4><pre class="type-13 type-9 type-12 type-5 type-7 type-6 type-4 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAdd(){
  try {
    PrivilegeBits.EMPTY.add(PrivilegeBits.EMPTY);
    fail("UnsupportedOperation expected");
  }
 catch (  UnsupportedOperationException e) {
  }
  PrivilegeBits pb=READ_NODES_PRIVILEGE_BITS;
  PrivilegeBits mod=PrivilegeBits.getInstance(pb);
  for (int i=0; i < 100; i++) {
    try {
      pb.add(PrivilegeBits.EMPTY);
      fail("UnsupportedOperation expected");
    }
 catch (    UnsupportedOperationException e) {
    }
    try {
      pb.add(mod);
      fail("UnsupportedOperation expected");
    }
 catch (    UnsupportedOperationException e) {
    }
    PrivilegeBits nxt=pb.nextBits();
    try {
      pb.add(nxt);
      fail("UnsupportedOperation expected");
    }
 catch (    UnsupportedOperationException e) {
    }
    long before=getLongValue(mod);
    long nxtLong=getLongValue(nxt);
    mod.add(nxt);
    if (getLongValue(nxt) != 0) {
      assertEquals(before | nxtLong,getLongValue(mod));
    }
    assertTrue(mod.includes(nxt));
    PrivilegeBits tmp=PrivilegeBits.getInstance(pb);
    assertTrue(tmp.includes(pb));
    assertFalse(tmp.includes(nxt));
    if (READ_NODES_PRIVILEGE_BITS.equals(pb)) {
      assertTrue(tmp.includes(PrivilegeBits.BUILT_IN.get(PrivilegeConstants.REP_READ_NODES)));
    }
 else {
      assertFalse(tmp.includes(PrivilegeBits.BUILT_IN.get(PrivilegeConstants.REP_READ_NODES)));
    }
    tmp.add(nxt);
    assertTrue(tmp.includes(pb) && tmp.includes(nxt));
    if (READ_NODES_PRIVILEGE_BITS.equals(pb)) {
      assertTrue(tmp.includes(READ_NODES_PRIVILEGE_BITS));
    }
 else {
      assertFalse(tmp.includes(READ_NODES_PRIVILEGE_BITS));
    }
    tmp.add(READ_NODES_PRIVILEGE_BITS);
    assertTrue(tmp.includes(READ_NODES_PRIVILEGE_BITS));
    pb=nxt;
  }
}

</code></pre>

<br>
<pre class="type-13 type-9 type-12 type-5 type-7 type-6 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddDifference(){
  try {
    PrivilegeBits.EMPTY.addDifference(PrivilegeBits.EMPTY,PrivilegeBits.EMPTY);
    fail("UnsupportedOperation expected");
  }
 catch (  UnsupportedOperationException e) {
  }
  PrivilegeBits pb=READ_NODES_PRIVILEGE_BITS;
  PrivilegeBits mod=PrivilegeBits.getInstance(pb);
  for (int i=0; i < 100; i++) {
    PrivilegeBits nxt=pb.nextBits();
    try {
      pb.addDifference(nxt,mod);
      fail("UnsupportedOperation expected");
    }
 catch (    UnsupportedOperationException e) {
    }
    try {
      pb.addDifference(nxt,READ_NODES_PRIVILEGE_BITS);
      fail("UnsupportedOperation expected");
    }
 catch (    UnsupportedOperationException e) {
    }
    PrivilegeBits tmp=PrivilegeBits.getInstance(mod);
    tmp.addDifference(nxt,READ_NODES_PRIVILEGE_BITS);
    mod.add(nxt);
    assertEquivalent(mod,tmp);
    if (!pb.equals(READ_NODES_PRIVILEGE_BITS)) {
      tmp=PrivilegeBits.getInstance(nxt);
      PrivilegeBits mod2=PrivilegeBits.getInstance(mod);
      tmp.addDifference(mod2,READ_NODES_PRIVILEGE_BITS);
      assertFalse(nxt.equals(tmp));
      assertEquivalent(mod2,mod);
      assertTrue(tmp.includes(pb));
      assertFalse(tmp.includes(READ_NODES_PRIVILEGE_BITS));
      assertFalse(tmp.includes(mod));
    }
    tmp=PrivilegeBits.getInstance(nxt);
    PrivilegeBits mod2=PrivilegeBits.getInstance(mod);
    tmp.addDifference(READ_NODES_PRIVILEGE_BITS,mod2);
    assertEquivalent(nxt,tmp);
    assertEquivalent(mod2,mod);
    assertFalse(tmp.includes(pb));
    assertFalse(tmp.includes(READ_NODES_PRIVILEGE_BITS));
    assertFalse(tmp.includes(mod));
    tmp=PrivilegeBits.getInstance(nxt);
    tmp.addDifference(READ_NODES_PRIVILEGE_BITS,READ_NODES_PRIVILEGE_BITS);
    assertEquivalent(nxt,tmp);
    assertFalse(tmp.includes(READ_NODES_PRIVILEGE_BITS));
    tmp=PrivilegeBits.getInstance(mod);
    tmp.addDifference(READ_NODES_PRIVILEGE_BITS,READ_NODES_PRIVILEGE_BITS);
    assertEquivalent(mod,tmp);
    assertTrue(tmp.includes(READ_NODES_PRIVILEGE_BITS));
    pb=nxt;
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.spi.security.user.util.PasswordUtilTest </h4><pre class="type-9 type-12 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
"></span><br>
@Test public void testIsNotSame() throws Exception {
  String previous=null;
  for (  String pw : hashedPasswords.keySet()) {
    String pwHash=hashedPasswords.get(pw);
    assertFalse(pw,PasswordUtil.isSame(pw,pw));
    assertFalse(pwHash,PasswordUtil.isSame(pwHash,pwHash));
    if (previous != null) {
      assertFalse(previous,PasswordUtil.isSame(pwHash,previous));
    }
    previous=pw;
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.spi.state.NodeStoreTest </h4><pre class="type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void moveToDescendant(){
  NodeBuilder test=store.getRoot().builder().getChildNode("test");
  NodeBuilder x=test.getChildNode("x");
  if (fixture == NodeStoreFixtures.SEGMENT_MK || fixture == NodeStoreFixtures.MEMORY_NS) {
    assertTrue(x.moveTo(x,"xx"));
    assertFalse(x.exists());
    assertFalse(test.hasChildNode("x"));
  }
 else {
    assertFalse(x.moveTo(x,"xx"));
    assertTrue(x.exists());
    assertTrue(test.hasChildNode("x"));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.upgrade.PrivilegeUpgradeTest </h4><pre class="type-9 type-12 type-6 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void verifyCustomPrivilegeBits() throws Exception {
  JackrabbitSession session=createAdminSession();
  try {
    Node privilegeRoot=session.getNode(PrivilegeConstants.PRIVILEGES_PATH);
    Node testPrivilegeNode=privilegeRoot.getNode("test:privilege");
    long l=getLong(testPrivilegeNode);
    PrivilegeBits pb=readBits(testPrivilegeNode,PrivilegeConstants.REP_BITS);
    Node testPrivilege2Node=privilegeRoot.getNode("test:privilege2");
    long l2=getLong(testPrivilege2Node);
    PrivilegeBits pb2=readBits(testPrivilege2Node,PrivilegeConstants.REP_BITS);
    PrivilegeBits nextExpected;
    if (l < l2) {
      assertEquals(PrivilegeBits.NEXT_AFTER_BUILT_INS,pb);
      assertEquals(pb.nextBits(),pb2);
      nextExpected=pb2.nextBits();
    }
 else {
      assertEquals(PrivilegeBits.NEXT_AFTER_BUILT_INS,pb2);
      assertEquals(pb2.nextBits(),pb);
      nextExpected=pb.nextBits();
    }
    PrivilegeBits nextBits=readBits(privilegeRoot,PrivilegeConstants.REP_NEXT);
    assertEquals(nextExpected,nextBits);
    Node testAggregateNode=privilegeRoot.getNode("test:aggregate");
    PrivilegeBits aggrPb=readBits(testAggregateNode,PrivilegeConstants.REP_BITS);
    PrivilegeBits expected=PrivilegeBits.getInstance(PrivilegeBits.BUILT_IN.get(PrivilegeConstants.JCR_READ),pb).unmodifiable();
    assertEquals(expected,aggrPb);
    Node testAggregate2Node=privilegeRoot.getNode("test:aggregate2");
    PrivilegeBits aggr2Pb=readBits(testAggregate2Node,PrivilegeConstants.REP_BITS);
    PrivilegeBits expected2=PrivilegeBits.getInstance(aggrPb,pb2).unmodifiable();
    assertEquals(expected2,aggr2Pb);
  }
  finally {
    session.logout();
  }
}

</code></pre>

<br>
<pre class="type-9 type-12 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void verifyPrivileges() throws RepositoryException {
  Set<String> nonAggregatePrivileges=newHashSet(REP_READ_NODES,REP_READ_PROPERTIES,REP_ADD_PROPERTIES,REP_ALTER_PROPERTIES,REP_REMOVE_PROPERTIES,JCR_ADD_CHILD_NODES,JCR_REMOVE_CHILD_NODES,JCR_REMOVE_NODE,JCR_READ_ACCESS_CONTROL,JCR_MODIFY_ACCESS_CONTROL,JCR_NODE_TYPE_MANAGEMENT,JCR_VERSION_MANAGEMENT,JCR_LOCK_MANAGEMENT,JCR_LIFECYCLE_MANAGEMENT,JCR_RETENTION_MANAGEMENT,JCR_WORKSPACE_MANAGEMENT,JCR_NODE_TYPE_DEFINITION_MANAGEMENT,JCR_NAMESPACE_MANAGEMENT,REP_PRIVILEGE_MANAGEMENT,REP_USER_MANAGEMENT,REP_INDEX_DEFINITION_MANAGEMENT,"test:privilege","test:privilege2");
  Map<String,Set<String>> aggregatePrivileges=Maps.newHashMap();
  aggregatePrivileges.put(JCR_READ,ImmutableSet.of(REP_READ_NODES,REP_READ_PROPERTIES));
  aggregatePrivileges.put(JCR_MODIFY_PROPERTIES,ImmutableSet.of(REP_ADD_PROPERTIES,REP_ALTER_PROPERTIES,REP_REMOVE_PROPERTIES));
  aggregatePrivileges.put(JCR_WRITE,ImmutableSet.of(JCR_MODIFY_PROPERTIES,REP_ADD_PROPERTIES,REP_ALTER_PROPERTIES,REP_REMOVE_PROPERTIES,JCR_ADD_CHILD_NODES,JCR_REMOVE_CHILD_NODES,JCR_REMOVE_NODE));
  aggregatePrivileges.put(REP_WRITE,ImmutableSet.of(JCR_WRITE,JCR_MODIFY_PROPERTIES,REP_ADD_PROPERTIES,REP_ALTER_PROPERTIES,REP_REMOVE_PROPERTIES,JCR_ADD_CHILD_NODES,JCR_REMOVE_CHILD_NODES,JCR_REMOVE_NODE,JCR_NODE_TYPE_MANAGEMENT));
  aggregatePrivileges.put(JCR_ALL,ImmutableSet.of(REP_READ_NODES,REP_READ_PROPERTIES,REP_ADD_PROPERTIES,REP_ALTER_PROPERTIES,REP_REMOVE_PROPERTIES,JCR_ADD_CHILD_NODES,JCR_REMOVE_CHILD_NODES,JCR_REMOVE_NODE,JCR_READ_ACCESS_CONTROL,JCR_MODIFY_ACCESS_CONTROL,JCR_NODE_TYPE_MANAGEMENT,JCR_VERSION_MANAGEMENT,JCR_LOCK_MANAGEMENT,JCR_LIFECYCLE_MANAGEMENT,JCR_RETENTION_MANAGEMENT,JCR_WORKSPACE_MANAGEMENT,JCR_NODE_TYPE_DEFINITION_MANAGEMENT,JCR_NAMESPACE_MANAGEMENT,REP_PRIVILEGE_MANAGEMENT,REP_USER_MANAGEMENT,REP_INDEX_DEFINITION_MANAGEMENT,JCR_READ,JCR_MODIFY_PROPERTIES,JCR_WRITE,REP_WRITE,"test:privilege","test:privilege2","test:aggregate","test:aggregate2"));
  aggregatePrivileges.put("test:aggregate",ImmutableSet.of(JCR_READ,REP_READ_NODES,REP_READ_PROPERTIES,"test:privilege"));
  aggregatePrivileges.put("test:aggregate2",ImmutableSet.of(JCR_READ,REP_READ_NODES,REP_READ_PROPERTIES,"test:privilege","test:privilege2","test:aggregate"));
  JackrabbitSession session=createAdminSession();
  try {
    JackrabbitWorkspace workspace=(JackrabbitWorkspace)session.getWorkspace();
    PrivilegeManager manager=workspace.getPrivilegeManager();
    Privilege[] privileges=manager.getRegisteredPrivileges();
    for (    Privilege privilege : privileges) {
      if (privilege.isAggregate()) {
        Set<String> expected=aggregatePrivileges.remove(privilege.getName());
        if (expected != null) {
          String[] actual=getNames(privilege.getAggregatePrivileges());
          assertTrue("Miss match in aggregate privilege " + privilege.getName() + " expected "+ expected+ " actual "+ Arrays.toString(actual),newHashSet(expected).equals(newHashSet(actual)));
        }
      }
 else {
        nonAggregatePrivileges.remove(privilege.getName());
      }
    }
    assertTrue("Missing non aggregate privileges: " + nonAggregatePrivileges,nonAggregatePrivileges.isEmpty());
    assertTrue("Missing aggregate privileges: " + aggregatePrivileges.keySet(),aggregatePrivileges.isEmpty());
  }
  finally {
    session.logout();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.upgrade.RepositorySidegradeTest </h4><pre class="type-12 type-7 type-6 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void verifyCustomNodeTypes() throws Exception {
  Session session=createAdminSession();
  try {
    NodeTypeManager manager=session.getWorkspace().getNodeTypeManager();
    assertTrue(manager.hasNodeType("test:unstructured"));
    NodeType type=manager.getNodeType("test:unstructured");
    assertFalse(type.isMixin());
    assertTrue(type.isNodeType("nt:unstructured"));
    boolean foundDefaultString=false;
    boolean foundDefaultPath=false;
    for (    PropertyDefinition pDef : type.getPropertyDefinitions()) {
      if ("defaultString".equals(pDef.getName())) {
        assertEquals(PropertyType.STRING,pDef.getRequiredType());
        assertNotNull(pDef.getDefaultValues());
        assertEquals(1,pDef.getDefaultValues().length);
        assertEquals("stringValue",pDef.getDefaultValues()[0].getString());
        foundDefaultString=true;
      }
 else       if ("defaultPath".equals(pDef.getName())) {
        assertEquals(PropertyType.PATH,pDef.getRequiredType());
        assertNotNull(pDef.getDefaultValues());
        assertEquals(1,pDef.getDefaultValues().length);
        assertEquals("/jcr:path/nt:value",pDef.getDefaultValues()[0].getString());
        foundDefaultPath=true;
      }
    }
    assertTrue("Expected property definition with name \"defaultString\"",foundDefaultString);
    assertTrue("Expected property definition with name \"defaultPath\"",foundDefaultPath);
  }
  finally {
    session.logout();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.upgrade.RepositoryUpgradeTest </h4><pre class="type-12 type-7 type-6 type-4 type-8 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void verifyCustomNodeTypes() throws Exception {
  Session session=createAdminSession();
  try {
    NodeTypeManager manager=session.getWorkspace().getNodeTypeManager();
    assertTrue(manager.hasNodeType("test:unstructured"));
    NodeType type=manager.getNodeType("test:unstructured");
    assertFalse(type.isMixin());
    assertTrue(type.isNodeType("nt:unstructured"));
    boolean foundDefaultString=false;
    boolean foundDefaultPath=false;
    for (    PropertyDefinition pDef : type.getPropertyDefinitions()) {
      if ("defaultString".equals(pDef.getName())) {
        assertEquals(PropertyType.STRING,pDef.getRequiredType());
        assertNotNull(pDef.getDefaultValues());
        assertEquals(1,pDef.getDefaultValues().length);
        assertEquals("stringValue",pDef.getDefaultValues()[0].getString());
        foundDefaultString=true;
      }
 else       if ("defaultPath".equals(pDef.getName())) {
        assertEquals(PropertyType.PATH,pDef.getRequiredType());
        assertNotNull(pDef.getDefaultValues());
        assertEquals(1,pDef.getDefaultValues().length);
        assertEquals("/jcr:path/nt:value",pDef.getDefaultValues()[0].getString());
        foundDefaultPath=true;
      }
    }
    assertTrue("Expected property definition with name \"defaultString\"",foundDefaultString);
    assertTrue("Expected property definition with name \"defaultPath\"",foundDefaultPath);
  }
  finally {
    session.logout();
  }
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
