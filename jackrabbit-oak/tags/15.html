<h3><span class=" glyphicon glyphicon-tag"/>&nbspConditionMatcher</h3><kbd>Verifies logic rules using matcher-style statements</kbd><br><br><br><h4 style="margin:0px">Class: org.apache.jackrabbit.oak.commons.junit.LogCustomizerTest </h4><pre class="type-7 type-6 type-15 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLogs1(){
  LogCustomizer custom=LogCustomizer.forLogger("org.apache.jackrabbit.oak.commons.junit.LogCustomizerTest").enable(Level.DEBUG).create();
  try {
    custom.starting();
    LOG.debug("test message");
    List<String> logs=custom.getLogs();
    assertTrue(logs.size() == 1);
    assertThat("logs were recorded by custom logger",logs.toString(),containsString("test message"));
  }
  finally {
    custom.finished();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.CRUDTest </h4><pre class="type-6 type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void checkPathInInvalidItemStateException() throws Exception {
  Session s1=getAdminSession();
  Node root=s1.getRootNode();
  Node a=root.addNode("a");
  String path=a.getPath();
  s1.save();
  Session s2=getAdminSession();
  s2.getRootNode().getNode("a").remove();
  s2.save();
  s1.refresh(false);
  try {
    a.getPath();
  }
 catch (  InvalidItemStateException e) {
    assertThat(e.getMessage(),containsString(path));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.ConflictResolutionTest </h4><pre class="type-7 type-6 type-15 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void deleteChangedNode() throws RepositoryException {
  deleteChangedNodeOps("node0");
  Set<String> mnsdLogs;
  Set<String> cvLogs;
  try {
    logMergingNodeStateDiff.starting();
    logConflictValidator.starting();
    deleteChangedNodeOps("node1");
  }
  finally {
    mnsdLogs=Sets.newHashSet(logMergingNodeStateDiff.getLogs());
    cvLogs=Sets.newHashSet(logConflictValidator.getLogs());
    logMergingNodeStateDiff.finished();
    logConflictValidator.finished();
  }
  assertTrue(mnsdLogs.size() == 1);
  assertThat("MergingNodeStateDiff log message must contain a reference to the handler",mnsdLogs.toString(),containsString("NodeConflictHandler<DELETE_CHANGED_NODE>"));
  assertThat("MergingNodeStateDiff log message must contain a reference to the resolution",mnsdLogs.toString(),containsString("DELETE_CHANGED_NODE with resolution THEIRS"));
  assertThat("MergingNodeStateDiff log message must contain a reference to the modified property",mnsdLogs.toString(),containsString("^\"/metadata/updated\":\"myself\"]"));
  assertTrue(cvLogs.size() == 1);
  assertThat("ConflictValidator log message must contain a reference to the path",cvLogs.toString(),containsString("/node1 = {deleteChangedNode = {jcr:content}}"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.jcr.RepositoryTest </h4><pre class="type-7 type-6 type-15 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void largeMultiValueProperty() throws Exception {
  final List<String> logMessages=Lists.newArrayList();
  Appender<ILoggingEvent> a=new AppenderBase<ILoggingEvent>(){
    @Override protected void append(    ILoggingEvent e){
      if (Level.WARN.isGreaterOrEqual(e.getLevel())) {
        logMessages.add(e.getFormattedMessage());
      }
    }
  }
;
  a.start();
  rootLogger().addAppender(a);
  Session session=getAdminSession();
  Node node=session.getRootNode().addNode("largeMultiValueProperty","nt:unstructured");
  String[] largeArray=new String[1000 + 1];
  Arrays.fill(largeArray,"x");
  Property p=node.setProperty("fooProp",largeArray);
  Property p2=node.setProperty("barProp",new String[]{"x"});
  p2.setValue(largeArray);
  session.save();
  rootLogger().detachAppender(a);
  a.stop();
  assertTrue(logMessages.size() >= 2);
  assertThat("Warn log message must contains a reference to the large array property path",logMessages.toString(),containsString(p.getPath()));
  assertThat("Warn log message must contains a reference to the large array property path",logMessages.toString(),containsString(p2.getPath()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.document.OptimizedChildFetchTest </h4><pre class="type-9 type-7 type-8 type-15 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void checkForNoCallsToFetchChildForLeafNodes(){
  String head=mk.getHeadRevision();
  String rev=mk.commit("","+\"/root\":{}\n" + "+\"/root/a\":{}\n" + "+\"/root/c\":{}\n"+ "+\"/root/a/b\":{}\n",head,"");
  ds.paths.clear();
  resetMK();
  mk.getNodes("/root/a",rev,0,0,10,null);
  assertThat(ds.paths,hasItem("3:/root/a/"));
  resetMK();
  ds.paths.clear();
  assertNotNull(mk.getNodes("/root/c",rev,0,0,10,null));
  assertNotNull(mk.getNodes("/root/a/b",rev,0,0,10,null));
  assertTrue(ds.paths.isEmpty());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.index.AsyncIndexUpdateTest </h4><pre class="type-6 type-4 type-15 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void noRunWhenClosed() throws Exception {
  NodeStore store=new MemoryNodeStore();
  IndexEditorProvider provider=new PropertyIndexEditorProvider();
  AsyncIndexUpdate async=new AsyncIndexUpdate("async",store,provider);
  async.run();
  async.close();
  LogCustomizer lc=createLogCustomizer(Level.WARN);
  async.run();
  assertEquals(1,lc.getLogs().size());
  assertThat(lc.getLogs().get(0),containsString("Could not acquire run permit"));
  lc.finished();
  async.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.index.lucene.AggregateTest </h4><pre class="type-9 type-4 type-15 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void propOneLevelNamed() throws Exception {
  NodeBuilder rules=builder.child(INDEX_RULES);
  rules.child("nt:folder");
  child(rules,"nt:folder/properties/p1").setProperty(LuceneIndexConstants.PROP_NAME,"a/p1");
  IndexDefinition defn=new IndexDefinition(root,builder.getNodeState());
  Aggregate ag=defn.getApplicableIndexingRule("nt:folder").getAggregate();
  NodeBuilder nb=newNode("nt:folder");
  nb.child("a").setProperty("p1","foo");
  nb.child("a").setProperty("p2","foo");
  nb.child("b").setProperty("p2","foo");
  ag.collectAggregates(nb.getNodeState(),col);
  assertEquals(1,col.getPropPaths().size());
  assertThat(col.getPropPaths(),hasItems("a/p1"));
}

</code></pre>

<br>
<pre class="type-9 type-4 type-15 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void oneLevelNamed() throws Exception {
  Aggregate ag=new Aggregate("nt:base",of(ni("a")));
  NodeBuilder nb=newNode("nt:base");
  nb.child("a");
  nb.child("b");
  ag.collectAggregates(nb.getNodeState(),col);
  assertEquals(1,col.getNodePaths().size());
  assertThat(col.getNodePaths(),hasItems("a"));
}

</code></pre>

<br>
<pre class="type-9 type-4 type-15 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRelativeNodeInclude() throws Exception {
  Aggregate agContent=new Aggregate("app:Page",of(ni(null,"jcr:content",true)));
  mapper.add("app:Page",agContent);
  NodeBuilder nb=newNode("app:Page");
  nb.child("jcr:content").setProperty("foo","bar");
  agContent.collectAggregates(nb.getNodeState(),col);
  assertEquals(1,col.getNodePaths().size());
  assertThat(col.getNodePaths(),hasItems("jcr:content"));
  assertEquals(2,col.nodeResults.get("jcr:content").size());
  assertEquals(1,col.getRelativeNodeResults("jcr:content","jcr:content").size());
}

</code></pre>

<br>
<pre class="type-9 type-4 type-15 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void recursionEnabledWithLimitCheck() throws Exception {
  int limit=5;
  Aggregate agFile=new Aggregate("nt:file",of(ni("*")),limit);
  mapper.add("nt:file",agFile);
  List<String> expectedPaths=Lists.newArrayList();
  NodeBuilder nb=newNode("nt:file");
  nb.child("a").child("c");
  String path="";
  NodeBuilder fb=nb;
  for (int i=0; i < limit + 2; i++) {
    String name="f " + i;
    path=PathUtils.concat(path,name);
    fb=fb.child(name);
    fb.setProperty(JCR_PRIMARYTYPE,"nt:file");
    if (i < limit) {
      expectedPaths.add(path);
    }
  }
  expectedPaths.add("a");
  agFile.collectAggregates(nb.getNodeState(),col);
  assertEquals(expectedPaths.size(),col.getNodePaths().size());
  assertThat(col.getNodePaths(),hasItems(toArray(expectedPaths,String.class)));
}

</code></pre>

<br>
<pre class="type-9 type-4 type-15 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void multiLevelAll() throws Exception {
  Aggregate ag=new Aggregate("nt:base",of(ni("*"),ni("*/*")));
  NodeBuilder nb=newNode("nt:base");
  nb.child("a").child("c");
  nb.child("b");
  nb.child("d").child("e").child("f");
  ag.collectAggregates(nb.getNodeState(),col);
  assertEquals(5,col.getNodePaths().size());
  assertThat(col.getNodePaths(),hasItems("a","b","d","a/c","d/e"));
}

</code></pre>

<br>
<pre class="type-9 type-4 type-15 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void multiLevelNamed() throws Exception {
  Aggregate ag=new Aggregate("nt:base",of(ni("a"),ni("d/e")));
  NodeBuilder nb=newNode("nt:base");
  nb.child("a").child("c");
  nb.child("b");
  nb.child("d").child("e").child("f");
  ag.collectAggregates(nb.getNodeState(),col);
  assertEquals(2,col.getNodePaths().size());
  assertThat(col.getNodePaths(),hasItems("a","d/e"));
}

</code></pre>

<br>
<pre class="type-9 type-4 type-15 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void multiLevelNamedSubAll() throws Exception {
  Aggregate ag=new Aggregate("nt:base",of(ni("a"),ni("d/*/*")));
  NodeBuilder nb=newNode("nt:base");
  nb.child("a").child("c");
  nb.child("b");
  nb.child("d").child("e").child("f");
  nb.child("d").child("e").child("f2");
  nb.child("d").child("e2").child("f3");
  ag.collectAggregates(nb.getNodeState(),col);
  assertEquals(4,col.getNodePaths().size());
  assertThat(col.getNodePaths(),hasItems("a","d/e/f","d/e/f2","d/e2/f3"));
}

</code></pre>

<br>
<pre class="type-9 type-4 type-15 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void multiAggregateMapping() throws Exception {
  Aggregate ag=new Aggregate("nt:base",of(ni("*")));
  Aggregate agFile=new Aggregate("nt:file",of(ni("*"),ni("*/*")));
  mapper.add("nt:file",agFile);
  NodeBuilder nb=newNode("nt:base");
  nb.child("a").child("c");
  nb.child("b").setProperty(JCR_PRIMARYTYPE,"nt:file");
  nb.child("b").child("b1").child("b2");
  nb.child("c");
  ag.collectAggregates(nb.getNodeState(),col);
  assertEquals(5,col.getNodePaths().size());
  assertThat(col.getNodePaths(),hasItems("a","b","c","b/b1","b/b1/b2"));
}

</code></pre>

<br>
<pre class="type-9 type-4 type-15 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void recursionEnabled() throws Exception {
  Aggregate agFile=new Aggregate("nt:file",of(ni("*")),5);
  mapper.add("nt:file",agFile);
  NodeBuilder nb=newNode("nt:file");
  nb.child("a").child("c");
  nb.child("b").setProperty(JCR_PRIMARYTYPE,"nt:file");
  nb.child("b").child("b1").child("b2");
  nb.child("c");
  agFile.collectAggregates(nb.getNodeState(),col);
  assertEquals(4,col.getNodePaths().size());
  assertThat(col.getNodePaths(),hasItems("a","b","c","b/b1"));
}

</code></pre>

<br>
<pre class="type-9 type-4 type-15 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void oneLevelAll() throws Exception {
  Aggregate ag=new Aggregate("nt:base",of(ni("*")));
  NodeBuilder nb=newNode("nt:base");
  nb.child("a").child("c");
  nb.child("b");
  ag.collectAggregates(nb.getNodeState(),col);
  assertEquals(2,col.getNodePaths().size());
  assertThat(col.getNodePaths(),hasItems("a","b"));
}

</code></pre>

<br>
<pre class="type-9 type-4 type-15 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReaggregateMixin() throws Exception {
  Aggregate agFolder=new Aggregate("nt:folder",of(ni("mix:title","*",true)));
  Aggregate agFile=new Aggregate("mix:title",of(ni(null,"jcr:content",true)));
  mapper.add("mix:title",agFile);
  mapper.add("nt:folder",agFolder);
  NodeBuilder nb=newNode("nt:folder");
  nb.child("a").child("c");
  createFileMixin(nb,"b","hello world");
  createFileMixin(nb,"c","hello world");
  agFolder.collectAggregates(nb.getNodeState(),col);
  assertEquals(4,col.getNodePaths().size());
  assertThat(col.getNodePaths(),hasItems("b","c","b/jcr:content","c/jcr:content"));
  assertEquals(2,col.nodeResults.get("b/jcr:content").size());
  assertEquals(1,col.getRelativeNodeResults("b/jcr:content","b").size());
}

</code></pre>

<br>
<pre class="type-9 type-4 type-15 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void propOneLevelRegex() throws Exception {
  NodeBuilder rules=builder.child(INDEX_RULES);
  rules.child("nt:folder");
  child(rules,"nt:folder/properties/p1").setProperty(LuceneIndexConstants.PROP_NAME,"a/foo.*").setProperty(LuceneIndexConstants.PROP_IS_REGEX,true);
  IndexDefinition defn=new IndexDefinition(root,builder.getNodeState());
  Aggregate ag=defn.getApplicableIndexingRule("nt:folder").getAggregate();
  NodeBuilder nb=newNode("nt:folder");
  nb.child("a").setProperty("foo1","foo");
  nb.child("a").setProperty("foo2","foo");
  nb.child("a").setProperty("bar1","foo");
  nb.child("b").setProperty("p2","foo");
  ag.collectAggregates(nb.getNodeState(),col);
  assertEquals(2,col.getPropPaths().size());
  assertThat(col.getPropPaths(),hasItems("a/foo1","a/foo2"));
}

</code></pre>

<br>
<pre class="type-9 type-4 type-15 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReaggregate() throws Exception {
  Aggregate agFolder=new Aggregate("nt:folder",of(ni("nt:file","*",true)));
  Aggregate agFile=new Aggregate("nt:file",of(ni(null,"jcr:content",true)));
  mapper.add("nt:file",agFile);
  mapper.add("nt:folder",agFolder);
  NodeBuilder nb=newNode("nt:folder");
  nb.child("a").child("c");
  createFile(nb,"b","hello world");
  createFile(nb,"c","hello world");
  agFolder.collectAggregates(nb.getNodeState(),col);
  assertEquals(4,col.getNodePaths().size());
  assertThat(col.getNodePaths(),hasItems("b","c","b/jcr:content","c/jcr:content"));
  assertEquals(2,col.nodeResults.get("b/jcr:content").size());
  assertEquals(1,col.getRelativeNodeResults("b/jcr:content","b").size());
}

</code></pre>

<br>
<pre class="type-9 type-4 type-15 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void multiLevelTyped() throws Exception {
  Aggregate ag=new Aggregate("nt:base",of(ni("a"),ni("nt:resource","d/*/*",false)));
  NodeBuilder nb=newNode("nt:base");
  nb.child("a").child("c");
  nb.child("b");
  nb.child("d").child("e").child("f").setProperty(JCR_PRIMARYTYPE,"nt:resource");
  nb.child("d").child("e").child("f2");
  nb.child("d").child("e2").child("f3").setProperty(JCR_PRIMARYTYPE,"nt:resource");
  ag.collectAggregates(nb.getNodeState(),col);
  assertEquals(3,col.getNodePaths().size());
  assertThat(col.getNodePaths(),hasItems("a","d/e/f","d/e2/f3"));
}

</code></pre>

<br>
<pre class="type-9 type-4 type-15 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void oneLevelTypedMixin() throws Exception {
  Aggregate ag=new Aggregate("nt:base",of(ni("mix:title","*",false)));
  NodeBuilder nb=newNode("nt:base");
  nb.child("a").setProperty(JcrConstants.JCR_MIXINTYPES,Collections.singleton("mix:title"),Type.NAMES);
  nb.child("b");
  ag.collectAggregates(nb.getNodeState(),col);
  assertEquals(1,col.getNodePaths().size());
  assertThat(col.getNodePaths(),hasItems("a"));
}

</code></pre>

<br>
<pre class="type-9 type-4 type-15 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void oneLevelTyped() throws Exception {
  Aggregate ag=new Aggregate("nt:base",of(ni("nt:resource","*",false)));
  NodeBuilder nb=newNode("nt:base");
  nb.child("a").setProperty(JCR_PRIMARYTYPE,"nt:resource");
  nb.child("b");
  ag.collectAggregates(nb.getNodeState(),col);
  assertEquals(1,col.getNodePaths().size());
  assertThat(col.getNodePaths(),hasItems("a"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.index.lucene.IndexCopierTest </h4><pre class="type-9 type-7 type-6 type-4 type-15 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void basicTestWithPrefetch() throws Exception {
  final List<String> syncedFiles=Lists.newArrayList();
  Directory baseDir=new RAMDirectory(){
    @Override public void sync(    Collection<String> names) throws IOException {
      syncedFiles.addAll(names);
      super.sync(names);
    }
  }
;
  IndexDefinition defn=new IndexDefinition(root,builder.getNodeState());
  IndexCopier c1=new RAMIndexCopier(baseDir,sameThreadExecutor(),getWorkDir(),true);
  Directory remote=new RAMDirectory();
  byte[] t1=writeFile(remote,"t1");
  byte[] t2=writeFile(remote,"t2");
  Directory wrapped=c1.wrapForRead("/foo",defn,remote);
  assertEquals(2,wrapped.listAll().length);
  assertThat(syncedFiles,containsInAnyOrder("t1","t2"));
  assertTrue(wrapped.fileExists("t1"));
  assertTrue(wrapped.fileExists("t2"));
  assertTrue(baseDir.fileExists("t1"));
  assertTrue(baseDir.fileExists("t2"));
  assertEquals(t1.length,wrapped.fileLength("t1"));
  assertEquals(t2.length,wrapped.fileLength("t2"));
  readAndAssert(wrapped,"t1",t1);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.index.lucene.LucenePropertyIndexTest </h4><pre class="type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void rangeQueriesWithLong() throws Exception {
  Tree idx=createIndex("test1",of("propa","propb"));
  Tree propIdx=idx.addChild(PROP_NODE).addChild("propa");
  propIdx.setProperty(LuceneIndexConstants.PROP_TYPE,PropertyType.TYPENAME_LONG);
  root.commit();
  Tree test=root.getTree("/").addChild("test");
  test.addChild("a").setProperty("propa",10);
  test.addChild("b").setProperty("propa",20);
  test.addChild("c").setProperty("propa",30);
  test.addChild("c").setProperty("propb","foo");
  test.addChild("d").setProperty("propb","foo");
  root.commit();
  assertThat(explain("select [jcr:path] from [nt:base] where [propa] >= 20"),containsString("lucene:test1"));
  assertQuery("select [jcr:path] from [nt:base] where [propa] >= 20",asList("/test/b","/test/c"));
  assertQuery("select [jcr:path] from [nt:base] where [propa] >= 20",asList("/test/b","/test/c"));
  assertQuery("select [jcr:path] from [nt:base] where [propa] = 20",asList("/test/b"));
  assertQuery("select [jcr:path] from [nt:base] where [propa] <= 20",asList("/test/b","/test/a"));
  assertQuery("select [jcr:path] from [nt:base] where [propa] < 20",asList("/test/a"));
  assertQuery("select [jcr:path] from [nt:base] where [propa] = 20 or [propa] = 10 ",asList("/test/b","/test/a"));
  assertQuery("select [jcr:path] from [nt:base] where [propa] > 10 and [propa] < 30",asList("/test/b"));
  assertQuery("select [jcr:path] from [nt:base] where [propa] in (10,20)",asList("/test/b","/test/a"));
  assertQuery("select [jcr:path] from [nt:base] where propa is not null",asList("/test/a","/test/b","/test/c"));
}

</code></pre>

<br>
<pre class="type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void determinePropTypeFromRestriction() throws Exception {
  Tree idx=createIndex("test1",of("propa","propb"));
  root.commit();
  Tree test=root.getTree("/").addChild("test");
  test.addChild("a").setProperty("propa",10);
  test.addChild("b").setProperty("propa",20);
  test.addChild("c").setProperty("propa",30);
  test.addChild("c").setProperty("propb","foo");
  test.addChild("d").setProperty("propb","foo");
  root.commit();
  assertThat(explain("select [jcr:path] from [nt:base] where [propa] >= 20"),containsString("lucene:test1"));
  assertQuery("select [jcr:path] from [nt:base] where [propa] >= 20",asList("/test/b","/test/c"));
  assertQuery("select [jcr:path] from [nt:base] where [propa] >= 20",asList("/test/b","/test/c"));
  assertQuery("select [jcr:path] from [nt:base] where [propa] = 20",asList("/test/b"));
  assertQuery("select [jcr:path] from [nt:base] where [propa] <= 20",asList("/test/b","/test/a"));
  assertQuery("select [jcr:path] from [nt:base] where [propa] < 20",asList("/test/a"));
  assertQuery("select [jcr:path] from [nt:base] where [propa] = 20 or [propa] = 10 ",asList("/test/b","/test/a"));
  assertQuery("select [jcr:path] from [nt:base] where [propa] > 10 and [propa] < 30",asList("/test/b"));
  assertQuery("select [jcr:path] from [nt:base] where [propa] in (10,20)",asList("/test/b","/test/a"));
  assertQuery("select [jcr:path] from [nt:base] where propa is not null",asList("/test/a","/test/b","/test/c"));
}

</code></pre>

<br>
<pre class="type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void redundantNotNullCheck() throws Exception {
  Tree idx=createIndex("test1",of("tags"));
  root.commit();
  Tree test=root.getTree("/").addChild("test");
  test.addChild("a").setProperty("tags",of("a","b"),Type.STRINGS);
  test.addChild("b").setProperty("tags",of("a","c"),Type.STRINGS);
  root.commit();
  String q="SELECT * FROM [nt:unstructured] as content WHERE ISDESCENDANTNODE('/content/dam/en/us')\n" + "and(\n" + "    content.[tags] = 'Products:A'\n"+ "    or content.[tags] = 'Products:A/B'\n"+ "    or content.[tags] = 'Products:A/B'\n"+ "    or content.[tags] = 'Products:A'\n"+ ")\n"+ "and(\n"+ "    content.[tags] = 'DocTypes:A'\n"+ "    or content.[tags] = 'DocTypes:B'\n"+ "    or content.[tags] = 'DocTypes:C'\n"+ "    or content.[tags] = 'ProblemType:A'\n"+ ")\n"+ "and(\n"+ "    content.[hasRendition] IS NULL\n"+ "    or content.[hasRendition] = 'false'\n"+ ")";
  assertThat(explain(q),not(containsString("[content].[tags] is not null")));
}

</code></pre>

<br>
<pre class="type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void sortFulltextQueriesWithJcrScore() throws Exception {
  Tree idx=createIndex("test1",of("propa"));
  idx.setProperty(LuceneIndexConstants.FULL_TEXT_ENABLED,true);
  useV2(idx);
  Tree test=root.getTree("/").addChild("test");
  root.commit();
  test.addChild("a").setProperty("propa","foo");
  test.addChild("b").setProperty("propa","foo");
  test.addChild("c").setProperty("propa","foo");
  root.commit();
  String query="measure //*[jcr:contains(., 'foo' )] order by @jcr:score descending";
  assertThat(measureWithLimit(query,XPATH,1),containsString("scanCount: 1"));
  query="measure //*[jcr:contains(., 'foo' )] order by @jcr:score";
  assertThat(measureWithLimit(query,XPATH,1),containsString("scanCount: 3"));
}

</code></pre>

<br>
<pre class="type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void pathInclude() throws Exception {
  Tree idx=createIndex("test1",of("propa","propb"));
  idx.setProperty(createProperty(PROP_INCLUDED_PATHS,of("/test/a"),Type.STRINGS));
  root.commit();
  Tree test=root.getTree("/").addChild("test");
  test.addChild("a").setProperty("propa",10);
  test.addChild("a").addChild("b").setProperty("propa",10);
  test.addChild("c").setProperty("propa",10);
  root.commit();
  assertThat(explain("select [jcr:path] from [nt:base] where [propa] = 10"),containsString("lucene:test1"));
  assertQuery("select [jcr:path] from [nt:base] where [propa] = 10",asList("/test/a","/test/a/b"));
}

</code></pre>

<br>
<pre class="type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void indexSelectionVsNodeType() throws Exception {
  Tree luceneIndex=createIndex("test1",of("propa"));
  luceneIndex.setProperty(IndexConstants.ENTRY_COUNT_PROPERTY_NAME,5L,Type.LONG);
  Tree nodeTypeIndex=root.getTree("/").getChild("oak:index").getChild("nodetype");
  nodeTypeIndex.setProperty(IndexConstants.ENTRY_COUNT_PROPERTY_NAME,50L,Type.LONG);
  nodeTypeIndex.setProperty(IndexConstants.KEY_COUNT_PROPERTY_NAME,10L,Type.LONG);
  Tree test=root.getTree("/").addChild("test");
  test.setProperty("jcr:primaryType","nt:unstructured",Type.NAME);
  List<String> paths=Lists.newArrayList();
  for (int idx=0; idx < 15; idx++) {
    Tree a=test.addChild("n" + idx);
    a.setProperty("jcr:primaryType","nt:unstructured",Type.NAME);
    a.setProperty("propa","foo");
    paths.add("/test/n" + idx);
  }
  root.commit();
  String propaQuery="select [jcr:path] from [nt:unstructured] where [propa] = 'foo'";
  assertThat(explain(propaQuery),containsString("lucene:test1"));
  assertQuery(propaQuery,paths);
}

</code></pre>

<br>
<pre class="type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void indexingBasedOnMixinWithInheritence() throws Exception {
  Tree idx=createIndex("test1",of("propa","propb"));
  Tree props=TestUtil.newRulePropTree(idx,"mix:mimeType");
  Tree prop=props.addChild(TestUtil.unique("prop"));
  prop.setProperty(LuceneIndexConstants.PROP_NAME,"jcr:mimeType");
  prop.setProperty(LuceneIndexConstants.PROP_PROPERTY_INDEX,true);
  root.commit();
  Tree test=root.getTree("/").addChild("test");
  createNodeWithType(test,"a","nt:resource").setProperty("jcr:mimeType","a");
  createNodeWithType(test,"b","nt:resource").setProperty("jcr:mimeType","c");
  test.addChild("c").setProperty("jcr:mimeType","a");
  root.commit();
  String propabQuery="select [jcr:path] from [mix:mimeType] where [jcr:mimeType] = 'a'";
  assertThat(explain(propabQuery),containsString("lucene:test1(/oak:index/test1)"));
  assertQuery(propabQuery,asList("/test/a"));
}

</code></pre>

<br>
<pre class="type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void aggregationAndExcludeProperty() throws Exception {
  NodeTypeRegistry.register(root,IOUtils.toInputStream(TestUtil.TEST_NODE_TYPE),"test nodeType");
  Tree idx=createIndex("test1",of("propa","propb"));
  Tree props=TestUtil.newRulePropTree(idx,TestUtil.NT_TEST);
  Tree prop=props.addChild(TestUtil.unique("prop"));
  prop.setProperty(LuceneIndexConstants.PROP_NAME,"jcr:title");
  prop.setProperty(LuceneIndexConstants.PROP_PROPERTY_INDEX,true);
  Tree prop1=props.addChild(TestUtil.unique("prop"));
  prop1.setProperty(LuceneIndexConstants.PROP_NAME,"original/jcr:content/type");
  prop1.setProperty(LuceneIndexConstants.PROP_NODE_SCOPE_INDEX,false);
  prop1.setProperty(LuceneIndexConstants.PROP_PROPERTY_INDEX,true);
  newNodeAggregator(idx).newRuleWithName(NT_FILE,newArrayList(JCR_CONTENT,JCR_CONTENT + "/*")).newRuleWithName(TestUtil.NT_TEST,newArrayList("/*"));
  root.commit();
  Tree test=root.getTree("/").addChild("test");
  Tree a=createNodeWithType(test,"a",TestUtil.NT_TEST);
  Tree af=createFileNode(a,"original","hello","text/plain");
  af.setProperty("type","jpg");
  af.setProperty("class","image");
  root.commit();
  assertQuery("select [jcr:path] from [oak:TestNode] where contains(*, 'hello')",asList("/test/a"));
  assertQuery("select [jcr:path] from [oak:TestNode] where contains(*, 'image')",asList("/test/a"));
  assertQuery("select [jcr:path] from [oak:TestNode] where contains(*, 'jpg')",Collections.<String>emptyList());
  assertThat(explain("select [jcr:path] from [oak:TestNode] where [original/jcr:content/type] = 'foo'"),containsString("original/jcr:content/type:foo"));
}

</code></pre>

<br>
<pre class="type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void nodeNameViaPropDefinition() throws Exception {
  Tree idx=createIndex("test1",Collections.EMPTY_SET);
  useV2(idx);
  Tree rules=idx.addChild(LuceneIndexConstants.INDEX_RULES);
  rules.setOrderableChildren(true);
  Tree rule=rules.addChild("nt:base");
  Tree propDef=rule.addChild(PROP_NODE).addChild("nodeName");
  propDef.setProperty(PROP_NAME,PROPDEF_PROP_NODE_NAME);
  propDef.setProperty(PROP_PROPERTY_INDEX,true);
  root.commit();
  Tree test=root.getTree("/");
  test.addChild("foo");
  test.addChild("camelCase");
  test.addChild("test").addChild("bar");
  root.commit();
  String propabQuery="select [jcr:path] from [nt:base] where LOCALNAME() = 'foo'";
  assertThat(explain(propabQuery),containsString("lucene:test1(/oak:index/test1) :nodeName:foo"));
  assertQuery(propabQuery,asList("/foo"));
  assertQuery("select [jcr:path] from [nt:base] where LOCALNAME() = 'bar'",asList("/test/bar"));
  assertQuery("select [jcr:path] from [nt:base] where LOCALNAME() LIKE 'foo'",asList("/foo"));
  assertQuery("select [jcr:path] from [nt:base] where LOCALNAME() LIKE 'camel%'",asList("/camelCase"));
  assertQuery("select [jcr:path] from [nt:base] where NAME() = 'bar'",asList("/test/bar"));
  assertQuery("select [jcr:path] from [nt:base] where NAME() LIKE 'foo'",asList("/foo"));
  assertQuery("select [jcr:path] from [nt:base] where NAME() LIKE 'camel%'",asList("/camelCase"));
}

</code></pre>

<br>
<pre class="type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void sortQueriesWithLong_NotIndexed_relativeProps() throws Exception {
  Tree idx=createIndex("test1",Collections.<String>emptySet());
  idx.setProperty(createProperty(ORDERED_PROP_NAMES,of("foo/bar"),STRINGS));
  Tree propIdx=idx.addChild(PROP_NODE).addChild("foo").addChild("bar");
  propIdx.setProperty(LuceneIndexConstants.PROP_TYPE,PropertyType.TYPENAME_LONG);
  root.commit();
  assertThat(explain("select [jcr:path] from [nt:base] order by [foo/bar]"),containsString("lucene:test1"));
  Tree test=root.getTree("/").addChild("test");
  List<Long> values=createLongs(NUMBER_OF_NODES);
  List<Tuple> tuples=Lists.newArrayListWithCapacity(values.size());
  for (int i=0; i < values.size(); i++) {
    Tree child=test.addChild("n" + i);
    child.addChild("foo").setProperty("bar",values.get(i));
    tuples.add(new Tuple(values.get(i),child.getPath()));
  }
  root.commit();
  assertOrderedQuery("select [jcr:path] from [nt:base] order by [foo/bar]",getSortedPaths(tuples,OrderDirection.ASC));
  assertOrderedQuery("select [jcr:path] from [nt:base]  order by [foo/bar] DESC",getSortedPaths(tuples,OrderDirection.DESC));
}

</code></pre>

<br>
<pre class="type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void indexSelectionFulltextVsNodeType() throws Exception {
  Tree nodeTypeIdx=root.getTree("/oak:index/nodetype");
  nodeTypeIdx.setProperty(PropertyStates.createProperty(DECLARING_NODE_TYPES,of("nt:file"),NAMES));
  nodeTypeIdx.setProperty(IndexConstants.REINDEX_PROPERTY_NAME,true);
  nodeTypeIdx.setProperty(IndexConstants.ENTRY_COUNT_PROPERTY_NAME,Long.MAX_VALUE);
  Tree luceneIndex=createFullTextIndex(root.getTree("/"),"lucene");
  Tree test=root.getTree("/").addChild("test");
  setNodeType(test,"nt:file");
  setNodeType(test.addChild("a"),"nt:file");
  setNodeType(test.addChild("b"),"nt:file");
  setNodeType(test.addChild("c"),"nt:base");
  root.commit();
  String propabQuery="/jcr:root//element(*, nt:file)";
  System.out.println(explainXpath(propabQuery));
  assertThat(explainXpath(propabQuery),containsString("nodeType"));
}

</code></pre>

<br>
<pre class="type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void sortQueriesWithLong_NotIndexed() throws Exception {
  Tree idx=createIndex("test1",Collections.<String>emptySet());
  idx.setProperty(createProperty(ORDERED_PROP_NAMES,of("foo"),STRINGS));
  Tree propIdx=idx.addChild(PROP_NODE).addChild("foo");
  propIdx.setProperty(LuceneIndexConstants.PROP_TYPE,PropertyType.TYPENAME_LONG);
  root.commit();
  assertThat(explain("select [jcr:path] from [nt:base] order by [foo]"),containsString("lucene:test1"));
  List<Tuple> tuples=createDataForLongProp();
  assertOrderedQuery("select [jcr:path] from [nt:base] order by [foo]",getSortedPaths(tuples,OrderDirection.ASC));
  assertOrderedQuery("select [jcr:path] from [nt:base]  order by [foo] DESC",getSortedPaths(tuples,OrderDirection.DESC));
}

</code></pre>

<br>
<pre class="type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void indexingBasedOnMixinAndRelativeProps() throws Exception {
  Tree idx=createIndex("test1",of("propa","propb"));
  Tree props=TestUtil.newRulePropTree(idx,"mix:title");
  Tree prop1=props.addChild(TestUtil.unique("prop"));
  prop1.setProperty(LuceneIndexConstants.PROP_NAME,"jcr:title");
  prop1.setProperty(LuceneIndexConstants.PROP_PROPERTY_INDEX,true);
  Tree prop2=props.addChild(TestUtil.unique("prop"));
  prop2.setProperty(LuceneIndexConstants.PROP_NAME,"jcr:content/type");
  prop2.setProperty(LuceneIndexConstants.PROP_PROPERTY_INDEX,true);
  root.commit();
  Tree test=root.getTree("/").addChild("test");
  Tree a=createNodeWithMixinType(test,"a","mix:title");
  a.setProperty("jcr:title","a");
  a.addChild("jcr:content").setProperty("type","foo-a");
  Tree c=createNodeWithMixinType(test,"c","mix:title");
  c.setProperty("jcr:title","c");
  c.addChild("jcr:content").setProperty("type","foo-c");
  test.addChild("c").setProperty("jcr:title","a");
  root.commit();
  String propabQuery="select [jcr:path] from [mix:title] where [jcr:content/type] = 'foo-a'";
  assertThat(explain(propabQuery),containsString("lucene:test1(/oak:index/test1)"));
  assertQuery(propabQuery,asList("/test/a"));
}

</code></pre>

<br>
<pre class="type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void usedAsNodeTypeIndex() throws Exception {
  Tree nodeTypeIdx=root.getTree("/oak:index/nodetype");
  nodeTypeIdx.setProperty(PropertyStates.createProperty(DECLARING_NODE_TYPES,of("nt:resource"),NAMES));
  nodeTypeIdx.setProperty(IndexConstants.REINDEX_PROPERTY_NAME,true);
  Tree indexWithType=createIndex("test2",of(JcrConstants.JCR_PRIMARYTYPE,"propb"));
  indexWithType.setProperty(PropertyStates.createProperty(DECLARING_NODE_TYPES,of("nt:file"),NAMES));
  Tree test=root.getTree("/").addChild("test");
  setNodeType(test,"nt:file");
  root.commit();
  setNodeType(test.addChild("a"),"nt:file");
  setNodeType(test.addChild("b"),"nt:file");
  setNodeType(test.addChild("c"),"nt:base");
  root.commit();
  String propabQuery="select [jcr:path] from [nt:file]";
  assertThat(explain(propabQuery),containsString("lucene:test2"));
  assertQuery(propabQuery,asList("/test/a","/test/b","/test"));
}

</code></pre>

<br>
<pre class="type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void usedAsNodeTypeIndex2() throws Exception {
  Tree nodeTypeIdx=root.getTree("/oak:index/nodetype");
  nodeTypeIdx.setProperty(PropertyStates.createProperty(DECLARING_NODE_TYPES,of("nt:resource"),NAMES));
  nodeTypeIdx.setProperty(IndexConstants.REINDEX_PROPERTY_NAME,true);
  Tree indexWithType=createIndex("test2",of("propb"));
  indexWithType.setProperty(PropertyStates.createProperty(DECLARING_NODE_TYPES,of("nt:file"),NAMES));
  indexWithType.setProperty(LuceneIndexConstants.FULL_TEXT_ENABLED,true);
  TestUtil.useV2(indexWithType);
  Tree test=root.getTree("/").addChild("test");
  setNodeType(test,"nt:file");
  root.commit();
  setNodeType(test.addChild("a"),"nt:file");
  setNodeType(test.addChild("b"),"nt:file");
  setNodeType(test.addChild("c"),"nt:base");
  root.commit();
  String propabQuery="select [jcr:path] from [nt:file]";
  assertThat(explain(propabQuery),containsString("lucene:test2"));
  assertQuery(propabQuery,asList("/test/a","/test/b","/test"));
}

</code></pre>

<br>
<pre class="type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void emptyIndex() throws Exception {
  Tree idx=createIndex("test1",of("propa","propb"));
  idx.addChild(PROP_NODE).addChild("propa");
  root.commit();
  Tree test=root.getTree("/").addChild("test");
  test.addChild("a");
  test.addChild("b");
  root.commit();
  assertThat(explain("select [jcr:path] from [nt:base] where [propa] = 'foo'"),containsString("lucene:test1"));
}

</code></pre>

<br>
<pre class="type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void declaringNodeTypeSingleIndex() throws Exception {
  Tree indexWithType=createIndex("test2",of("propa","propb"));
  indexWithType.setProperty(PropertyStates.createProperty(DECLARING_NODE_TYPES,of("nt:unstructured"),Type.STRINGS));
  Tree test=root.getTree("/").addChild("test");
  test.setProperty("jcr:primaryType","nt:unstructured",Type.NAME);
  root.commit();
  Tree a=test.addChild("a");
  a.setProperty("jcr:primaryType","nt:unstructured",Type.NAME);
  a.setProperty("propa","foo");
  a.setProperty("propb","baz");
  Tree b=test.addChild("b");
  b.setProperty("jcr:primaryType","nt:unstructured",Type.NAME);
  b.setProperty("propa","foo");
  b.setProperty("propb","baz");
  root.commit();
  String propabQuery="select [jcr:path] from [nt:unstructured] where [propb] = 'baz' and " + "[propa] = 'foo'";
  assertThat(explain(propabQuery),containsString("lucene:test2"));
  assertQuery(propabQuery,asList("/test/a","/test/b"));
  String propNoIdxQuery="select [jcr:path] from [nt:base] where [propb] = 'baz'";
  assertThat(explain(propNoIdxQuery),containsString("no-index"));
  assertQuery(propNoIdxQuery,ImmutableList.<String>of());
}

</code></pre>

<br>
<pre class="type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void propertyNonExistenceQuery() throws Exception {
  NodeTypeRegistry.register(root,IOUtils.toInputStream(TestUtil.TEST_NODE_TYPE),"test nodeType");
  Tree idx=createIndex("test1",of("propa","propb"));
  Tree props=TestUtil.newRulePropTree(idx,TestUtil.NT_TEST);
  Tree prop=props.addChild(TestUtil.unique("prop"));
  prop.setProperty(LuceneIndexConstants.PROP_NAME,"propa");
  prop.setProperty(LuceneIndexConstants.PROP_PROPERTY_INDEX,true);
  prop.setProperty(LuceneIndexConstants.PROP_NULL_CHECK_ENABLED,true);
  root.commit();
  Tree test=root.getTree("/").addChild("test");
  createNodeWithType(test,"a","oak:TestNode").setProperty("propa","a");
  createNodeWithType(test,"b","oak:TestNode").setProperty("propa","c");
  createNodeWithType(test,"c","oak:TestNode").setProperty("propb","e");
  root.commit();
  String propabQuery="select [jcr:path] from [oak:TestNode] where [propa] is null";
  assertThat(explain(propabQuery),containsString("lucene:test1(/oak:index/test1) :nullProps:propa"));
  assertQuery(propabQuery,asList("/test/c"));
}

</code></pre>

<br>
<pre class="type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void declaringNodeTypeSameProp() throws Exception {
  createIndex("test1",of("propa"));
  Tree indexWithType=createIndex("test2",of("propa"));
  indexWithType.setProperty(PropertyStates.createProperty(DECLARING_NODE_TYPES,of("nt:unstructured"),Type.STRINGS));
  Tree test=root.getTree("/").addChild("test");
  test.setProperty("jcr:primaryType","nt:unstructured",Type.NAME);
  root.commit();
  Tree a=test.addChild("a");
  a.setProperty("jcr:primaryType","nt:unstructured",Type.NAME);
  a.setProperty("propa","foo");
  Tree b=test.addChild("b");
  b.setProperty("jcr:primaryType","nt:unstructured",Type.NAME);
  b.setProperty("propa","foo");
  test.addChild("c").setProperty("propa","foo");
  test.addChild("d").setProperty("propa","foo");
  root.commit();
  String propabQuery="select [jcr:path] from [nt:unstructured] where [propa] = 'foo'";
  assertThat(explain(propabQuery),containsString("lucene:test2"));
  assertQuery(propabQuery,asList("/test/a","/test/b"));
  String propcdQuery="select [jcr:path] from [nt:base] where [propa] = 'foo'";
  assertThat(explain(propcdQuery),containsString("lucene:test1"));
  assertQuery(propcdQuery,asList("/test/a","/test/b","/test/c","/test/d"));
}

</code></pre>

<br>
<pre class="type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void pathExclude() throws Exception {
  Tree idx=createIndex("test1",of("propa","propb"));
  idx.setProperty(createProperty(PROP_EXCLUDED_PATHS,of("/test/a"),Type.STRINGS));
  root.commit();
  Tree test=root.getTree("/").addChild("test");
  test.addChild("a").setProperty("propa",10);
  test.addChild("a").addChild("b").setProperty("propa",10);
  test.addChild("c").setProperty("propa",10);
  root.commit();
  assertThat(explain("select [jcr:path] from [nt:base] where [propa] = 10"),containsString("lucene:test1"));
  assertQuery("select [jcr:path] from [nt:base] where [propa] = 10",asList("/test/c"));
  test=root.getTree("/").getChild("test");
  test.addChild("a").addChild("e").setProperty("propa",10);
  test.addChild("f").setProperty("propa",10);
  root.commit();
  assertQuery("select [jcr:path] from [nt:base] where [propa] = 10",asList("/test/c","/test/f"));
}

</code></pre>

<br>
<pre class="type-9 type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void boostTitleOverDescription() throws Exception {
  NodeTypeRegistry.register(root,IOUtils.toInputStream(TestUtil.TEST_NODE_TYPE),"test nodeType");
  Tree idx=createIndex("test1",of("propa","propb"));
  Tree props=TestUtil.newRulePropTree(idx,TestUtil.NT_TEST);
  Tree title=props.addChild("title");
  title.setProperty(LuceneIndexConstants.PROP_NAME,"jcr:content/jcr:title");
  title.setProperty(LuceneIndexConstants.PROP_NODE_SCOPE_INDEX,true);
  title.setProperty(LuceneIndexConstants.FIELD_BOOST,4.0);
  Tree desc=props.addChild("desc");
  desc.setProperty(LuceneIndexConstants.PROP_NAME,"jcr:content/jcr:description");
  desc.setProperty(LuceneIndexConstants.PROP_NODE_SCOPE_INDEX,true);
  desc.setProperty(LuceneIndexConstants.FIELD_BOOST,2.0);
  Tree text=props.addChild("text");
  text.setProperty(LuceneIndexConstants.PROP_NAME,"jcr:content/text");
  text.setProperty(LuceneIndexConstants.PROP_NODE_SCOPE_INDEX,true);
  root.commit();
  Tree test=root.getTree("/").addChild("test");
  Tree a=createNodeWithType(test,"a","oak:TestNode").addChild("jcr:content");
  a.setProperty("jcr:title","Batman");
  a.setProperty("jcr:description","Silent angel of Gotham");
  a.setProperty("text","once upon a time a long text phrase so as to add penalty to /test/a and nullifying boost");
  Tree b=createNodeWithType(test,"b","oak:TestNode").addChild("jcr:content");
  b.setProperty("jcr:title","Superman");
  b.setProperty("jcr:description","Tale of two heroes Superman and Batman");
  b.setProperty("text","some stuff");
  Tree c=createNodeWithType(test,"c","oak:TestNode").addChild("jcr:content");
  c.setProperty("jcr:title","Ironman");
  c.setProperty("jcr:description","New kid in the town");
  c.setProperty("text","Friend of batman?");
  root.commit();
  String queryString="//element(*,oak:TestNode)[jcr:contains(., 'batman')]";
  String explain=explainXpath(queryString);
  assertThat(explain,containsString("full:jcr:content/jcr:title:batman^4.0"));
  assertThat(explain,containsString("full:jcr:content/jcr:description:batman^2.0"));
  assertThat(explain,containsString(":fulltext:batman"));
  assertOrderedQuery(queryString,asList("/test/a","/test/b","/test/c"),XPATH,true);
}

</code></pre>

<br>
<pre class="type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void propertyExistenceQuery2() throws Exception {
  NodeTypeRegistry.register(root,IOUtils.toInputStream(TestUtil.TEST_NODE_TYPE),"test nodeType");
  Tree idx=createIndex("test1",of("propa","propb"));
  Tree props=TestUtil.newRulePropTree(idx,TestUtil.NT_TEST);
  Tree prop=props.addChild(TestUtil.unique("prop"));
  prop.setProperty(LuceneIndexConstants.PROP_NAME,"propa");
  prop.setProperty(LuceneIndexConstants.PROP_PROPERTY_INDEX,true);
  prop.setProperty(LuceneIndexConstants.PROP_NOT_NULL_CHECK_ENABLED,true);
  root.commit();
  Tree test=root.getTree("/").addChild("test");
  createNodeWithType(test,"a","oak:TestNode").setProperty("propa","a");
  createNodeWithType(test,"b","oak:TestNode").setProperty("propa","c");
  createNodeWithType(test,"c","oak:TestNode").setProperty("propb","e");
  root.commit();
  String propabQuery="select [jcr:path] from [oak:TestNode] where [propa] is not null";
  assertThat(explain(propabQuery),containsString("lucene:test1(/oak:index/test1) :notNullProps:propa"));
  assertQuery(propabQuery,asList("/test/a","/test/b"));
}

</code></pre>

<br>
<pre class="type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void indexSelection() throws Exception {
  createIndex("test1",of("propa","propb"));
  createIndex("test2",of("propc"));
  Tree test=root.getTree("/").addChild("test");
  test.addChild("a").setProperty("propa","foo");
  test.addChild("b").setProperty("propa","foo");
  test.addChild("c").setProperty("propa","foo2");
  test.addChild("d").setProperty("propc","foo");
  test.addChild("e").setProperty("propd","foo");
  root.commit();
  String propaQuery="select [jcr:path] from [nt:base] where [propa] = 'foo'";
  assertThat(explain(propaQuery),containsString("lucene:test1"));
  assertThat(explain("select [jcr:path] from [nt:base] where [propc] = 'foo'"),containsString("lucene:test2"));
  assertQuery(propaQuery,asList("/test/a","/test/b"));
  assertQuery("select [jcr:path] from [nt:base] where [propa] = 'foo2'",asList("/test/c"));
  assertQuery("select [jcr:path] from [nt:base] where [propc] = 'foo'",asList("/test/d"));
}

</code></pre>

<br>
<pre class="type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void nodeName() throws Exception {
  Tree idx=createIndex("test1",of("propa","propb"));
  Tree rules=idx.addChild(LuceneIndexConstants.INDEX_RULES);
  rules.setOrderableChildren(true);
  Tree rule=rules.addChild("nt:base");
  rule.setProperty(LuceneIndexConstants.INDEX_NODE_NAME,true);
  root.commit();
  Tree test=root.getTree("/");
  test.addChild("foo");
  test.addChild("camelCase");
  test.addChild("test").addChild("bar");
  root.commit();
  String propabQuery="select [jcr:path] from [nt:base] where LOCALNAME() = 'foo'";
  assertThat(explain(propabQuery),containsString("lucene:test1(/oak:index/test1) :nodeName:foo"));
  assertQuery(propabQuery,asList("/foo"));
  assertQuery("select [jcr:path] from [nt:base] where LOCALNAME() = 'bar'",asList("/test/bar"));
  assertQuery("select [jcr:path] from [nt:base] where LOCALNAME() LIKE 'foo'",asList("/foo"));
  assertQuery("select [jcr:path] from [nt:base] where LOCALNAME() LIKE 'camel%'",asList("/camelCase"));
  assertQuery("select [jcr:path] from [nt:base] where NAME() = 'bar'",asList("/test/bar"));
  assertQuery("select [jcr:path] from [nt:base] where NAME() LIKE 'foo'",asList("/foo"));
  assertQuery("select [jcr:path] from [nt:base] where NAME() LIKE 'camel%'",asList("/camelCase"));
}

</code></pre>

<br>
<pre class="type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void unionSortResultCount() throws Exception {
  Tree idx=createIndex("test1",of("propa","propb","propc"));
  idx.setProperty(createProperty(ORDERED_PROP_NAMES,of("propc"),STRINGS));
  useV2(idx);
  Tree test=root.getTree("/").addChild("test");
  root.commit();
  List<Integer> nodes=Lists.newArrayList();
  Random r=new Random();
  int seed=-2;
  for (int i=0; i < 1000; i++) {
    Tree a=test.addChild("a" + i);
    a.setProperty("propa","fooa");
    seed+=2;
    int num=r.nextInt(100);
    a.setProperty("propc",num);
    nodes.add(num);
  }
  seed=-1;
  for (int i=0; i < 1000; i++) {
    Tree a=test.addChild("b" + i);
    a.setProperty("propb","foob");
    seed+=2;
    int num=100 + r.nextInt(100);
    a.setProperty("propc",num);
    nodes.add(num);
  }
  root.commit();
  String query="measure /jcr:root//element(*, nt:base)[(@propa = 'fooa' or @propb = 'foob')] order by @propc";
  assertThat(measureWithLimit(query,XPATH,100),containsString("scanCount: 101"));
}

</code></pre>

<br>
<pre class="type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void indexingPropertyWithAnalyzeButQueryWithWildcard() throws Exception {
  Tree index=root.getTree("/");
  Tree idx=index.addChild(INDEX_DEFINITIONS_NAME).addChild("test2");
  idx.setProperty(JcrConstants.JCR_PRIMARYTYPE,INDEX_DEFINITIONS_NODE_TYPE,Type.NAME);
  idx.setProperty(TYPE_PROPERTY_NAME,LuceneIndexConstants.TYPE_LUCENE);
  idx.setProperty(REINDEX_PROPERTY_NAME,true);
  Tree props=TestUtil.newRulePropTree(idx,"nt:base");
  Tree prop=props.addChild(TestUtil.unique("jcr:mimeType"));
  prop.setProperty(LuceneIndexConstants.PROP_NAME,"jcr:mimeType");
  prop.setProperty(LuceneIndexConstants.PROP_PROPERTY_INDEX,true);
  prop.setProperty(LuceneIndexConstants.PROP_ANALYZED,true);
  root.commit();
  Tree test=root.getTree("/").addChild("test");
  test.addChild("a").setProperty("jcr:mimeType","1234");
  test.addChild("b").setProperty("other","1234");
  test.addChild("c").setProperty("jcr:mimeType","a");
  root.commit();
  String query;
  query="/jcr:root/test//*[jcr:contains(@jcr:mimeType, '1234')]";
  assertThat(explainXpath(query),containsString("lucene:test2(/oak:index/test2)"));
  assertQuery(query,"xpath",asList("/test/a"));
  query="/jcr:root/test//*[jcr:contains(., '1234')]";
  assertThat(explainXpath(query),containsString("no-index"));
  query="/jcr:root/test//*[@jcr:mimeType = '1234']";
  assertThat(explainXpath(query),containsString("lucene:test2(/oak:index/test2)"));
  assertQuery(query,"xpath",asList("/test/a"));
}

</code></pre>

<br>
<pre class="type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void indexingBasedOnMixin() throws Exception {
  Tree idx=createIndex("test1",of("propa","propb"));
  Tree props=TestUtil.newRulePropTree(idx,"mix:title");
  Tree prop=props.addChild(TestUtil.unique("prop"));
  prop.setProperty(LuceneIndexConstants.PROP_NAME,"jcr:title");
  prop.setProperty(LuceneIndexConstants.PROP_PROPERTY_INDEX,true);
  root.commit();
  Tree test=root.getTree("/").addChild("test");
  createNodeWithMixinType(test,"a","mix:title").setProperty("jcr:title","a");
  createNodeWithMixinType(test,"b","mix:title").setProperty("jcr:title","c");
  test.addChild("c").setProperty("jcr:title","a");
  root.commit();
  String propabQuery="select [jcr:path] from [mix:title] where [jcr:title] = 'a'";
  assertThat(explain(propabQuery),containsString("lucene:test1(/oak:index/test1)"));
  assertQuery(propabQuery,asList("/test/a"));
}

</code></pre>

<br>
<pre class="type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void sortQueriesWithJcrScore() throws Exception {
  Tree idx=createIndex("test1",of("propa","n0","n1","n2"));
  root.commit();
  Tree test=root.getTree("/").addChild("test");
  for (int i=3; i > 0; i--) {
    Tree child=test.addChild("n" + i);
    child.setProperty("propa","foo");
  }
  root.commit();
  String query="measure select [jcr:path] from [nt:base] where [propa] = 'foo' order by [jcr:score] desc";
  assertThat(measureWithLimit(query,SQL2,1),containsString("scanCount: 1"));
  query="measure select [jcr:path] from [nt:base] where [propa] = 'foo' order by [jcr:score]";
  assertThat(measureWithLimit(query,SQL2,1),containsString("scanCount: 3"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.index.lucene.OakDirectoryTest </h4><pre class="type-5 type-15 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void dirNameInException_Writes() throws Exception {
  FailOnDemandBlobStore blobStore=new FailOnDemandBlobStore();
  FileStore store=FileStore.newFileStore(tempFolder.getRoot()).withMemoryMapping(false).withBlobStore(blobStore).create();
  SegmentNodeStore nodeStore=SegmentNodeStore.newSegmentNodeStore(store).create();
  String indexPath="/foo/bar";
  int minFileSize=Segment.MEDIUM_LIMIT;
  int blobSize=minFileSize + 1000;
  builder=nodeStore.getRoot().builder();
  builder.setProperty(LuceneIndexConstants.INDEX_PATH,indexPath);
  builder.setProperty(LuceneIndexConstants.BLOB_SIZE,blobSize);
  Directory dir=createDir(builder,false);
  blobStore.startFailing();
  IndexOutput o=dir.createOutput("test1.txt",IOContext.DEFAULT);
  try {
    o.writeBytes(randomBytes(blobSize + 10),blobSize + 10);
    fail();
  }
 catch (  IOException e) {
    assertThat(e.getMessage(),containsString(indexPath));
    assertThat(e.getMessage(),containsString("test1.txt"));
  }
  blobStore.reset();
  IndexOutput o3=dir.createOutput("test3.txt",IOContext.DEFAULT);
  o3.writeBytes(randomBytes(minFileSize),minFileSize);
  blobStore.startFailing();
  try {
    o3.flush();
    fail();
  }
 catch (  IOException e) {
    assertThat(e.getMessage(),containsString(indexPath));
    assertThat(e.getMessage(),containsString("test3.txt"));
  }
}

</code></pre>

<br>
<pre class="type-5 type-15 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void dirNameInExceptionMessage() throws Exception {
  String indexPath="/foo/bar";
  builder.setProperty(LuceneIndexConstants.INDEX_PATH,indexPath);
  Directory dir=createDir(builder,false);
  try {
    dir.openInput("foo.txt",IOContext.DEFAULT);
    fail();
  }
 catch (  IOException e) {
    assertThat(e.getMessage(),containsString(indexPath));
  }
  int fileSize=createFile(dir,"test.txt");
  IndexInput in=dir.openInput("test.txt",IOContext.DEFAULT);
  try {
    in.seek(fileSize + 1);
    fail();
  }
 catch (  IOException e) {
    assertThat(e.getMessage(),containsString(indexPath));
  }
  IndexInput in2=dir.openInput("test.txt",IOContext.DEFAULT);
  try {
    byte[] data=new byte[fileSize + 1];
    in2.readBytes(data,0,fileSize + 1);
    fail();
  }
 catch (  IOException e) {
    assertThat(e.getMessage(),containsString(indexPath));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.index.property.MultiPropertyOrTest </h4><pre class="type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void unionSortResultCount() throws Exception {
  Tree test=root.getTree("/").addChild("test");
  root.commit();
  List<Integer> nodes=Lists.newArrayList();
  Random r=new Random();
  int seed=-2;
  for (int i=0; i < 1000; i++) {
    Tree a=test.addChild("a" + i);
    a.setProperty("x","fooa");
    seed+=2;
    int num=r.nextInt(100);
    a.setProperty("z",num);
    nodes.add(num);
  }
  seed=-1;
  for (int i=0; i < 1000; i++) {
    Tree a=test.addChild("b" + i);
    a.setProperty("y","foob");
    seed+=2;
    int num=100 + r.nextInt(100);
    a.setProperty("z",num);
    nodes.add(num);
  }
  root.commit();
  String query="measure /jcr:root//element(*, nt:base)[(@x = 'fooa' or @y = 'foob')] order by @z";
  assertThat(measureWithLimit(query,XPATH,100),containsString("scanCount: 2000"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.index.property.OrderedPropertyIndexEditorProviderTest </h4><pre class="type-9 type-7 type-6 type-15 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void withIndexMultipleNodes() throws RepositoryException, CommitFailedException {
  final int threshold=5;
  final int nodes=16;
  final int traces=nodes / threshold;
  OrderedPropertyIndexEditorProvider.setThreshold(threshold);
  final List<String> expected=Collections.nCopies(traces,OrderedIndex.DEPRECATION_MESSAGE);
  NodeBuilder root=InitialContent.INITIAL_CONTENT.builder();
  createIndexDef(root);
  custom.starting();
  for (int i=0; i < nodes; i++) {
    NodeState before=root.getNodeState();
    root.child("n" + i).setProperty(indexedProperty,"dead" + i);
    NodeState after=root.getNodeState();
    root=hook.processCommit(before,after,CommitInfo.EMPTY).builder();
  }
  assertThat(custom.getLogs(),is(expected));
  custom.finished();
  assertFalse(root.getChildNode(INDEX_DEFINITIONS_NAME).getChildNode(indexName).getChildNode(INDEX_CONTENT_NODE_NAME).exists());
}

</code></pre>

<br>
<pre class="type-9 type-7 type-6 type-4 type-15 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void withIndexDefSingleNode() throws RepositoryException, CommitFailedException {
  NodeBuilder root=InitialContent.INITIAL_CONTENT.builder();
  createIndexDef(root);
  NodeState before=root.getNodeState();
  root.child("n1").setProperty(indexedProperty,"dead");
  NodeState after=root.getNodeState();
  custom.starting();
  root=hook.processCommit(before,after,CommitInfo.EMPTY).builder();
  assertEquals(1,custom.getLogs().size());
  assertThat(custom.getLogs(),hasItem(OrderedIndex.DEPRECATION_MESSAGE));
  custom.finished();
  NodeBuilder b=root.getChildNode(IndexConstants.INDEX_DEFINITIONS_NODE_TYPE).getChildNode(indexName).getChildNode(IndexConstants.INDEX_CONTENT_NODE_NAME);
  assertFalse("nothing should have been touched under the actual index",b.exists());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.plugins.index.property.OrderedPropertyIndexProviderTest </h4><pre class="type-6 type-4 type-15 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void singleQueryRun(){
  custom.starting();
  executeQuery("SELECT * FROM [oak:Unstructured]",SQL2);
  List<String> logs=custom.getLogs();
  assertEquals(1,logs.size());
  assertThat(logs,hasItem(OrderedIndex.DEPRECATION_MESSAGE));
  custom.finished();
}

</code></pre>

<br>
<pre class="type-9 type-6 type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void multipleQueryRuns(){
  final int executions=16;
  final int trackEvery=5;
  final int numTraces=executions / trackEvery;
  OrderedPropertyIndexProvider.setThreshold(trackEvery);
  List<String> expectedLogs=Collections.nCopies(numTraces,OrderedIndex.DEPRECATION_MESSAGE);
  custom.starting();
  for (int i=0; i < executions; i++) {
    executeQuery("SELECT * FROM [oak:Unstructured]",SQL2);
  }
  assertThat(custom.getLogs(),is(expectedLogs));
  custom.finished();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.query.ast.AndImplTest </h4><pre class="type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void simplifyForUnion(){
  ConstraintImpl and, op1, op2, op3, op4;
  Set<ConstraintImpl> expected;
  op1=mock(ComparisonImpl.class);
  op2=mock(ComparisonImpl.class);
  and=new AndImpl(op1,op2);
  expected=emptySet();
  assertThat(and.convertToUnion(),is(expected));
  op1=mockConstraint("op1",ComparisonImpl.class);
  op2=mockConstraint("op2",ComparisonImpl.class);
  op3=mockConstraint("op3",ComparisonImpl.class);
  and=new AndImpl(new OrImpl(op1,op2),op3);
  expected=of((ConstraintImpl)new AndImpl(op1,op3),(ConstraintImpl)new AndImpl(op2,op3));
  assertThat(and.convertToUnion(),is(expected));
  op1=mockConstraint("op1",ComparisonImpl.class);
  op2=mockConstraint("op2",ComparisonImpl.class);
  op3=mockConstraint("op3",ComparisonImpl.class);
  op4=mockConstraint("op4",ComparisonImpl.class);
  and=new AndImpl(new OrImpl(new OrImpl(op1,op4),op2),op3);
  expected=of((ConstraintImpl)new AndImpl(op1,op3),(ConstraintImpl)new AndImpl(op2,op3),(ConstraintImpl)new AndImpl(op4,op3));
  assertThat(and.convertToUnion(),is(expected));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.query.ast.OrImplTest </h4><pre class="type-9 type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void simplifyForUnion(){
  ConstraintImpl op1, op2, op3, op4, or;
  Set<ConstraintImpl> expected;
  op1=mock(ComparisonImpl.class);
  op2=mock(ComparisonImpl.class);
  or=new OrImpl(op1,op2);
  expected=of(op1,op2);
  assertThat(or.convertToUnion(),is(expected));
  op1=mock(ComparisonImpl.class);
  op2=mock(ComparisonImpl.class);
  op3=mock(ComparisonImpl.class);
  or=new OrImpl(new OrImpl(op1,op2),op3);
  expected=of(op1,op2,op3);
  assertThat(or.convertToUnion(),is(expected));
  op1=mock(ComparisonImpl.class);
  op2=mock(ComparisonImpl.class);
  op3=mock(ComparisonImpl.class);
  op4=mock(ComparisonImpl.class);
  or=new OrImpl(new OrImpl(new OrImpl(op1,op4),op2),op3);
  expected=of(op1,op2,op3,op4);
  assertThat(or.convertToUnion(),is(expected));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.security.authentication.ldap.LdapProviderTest </h4><pre class="type-6 type-8 type-15 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies logic rules using matcher-style statements
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetUserProperties() throws Exception {
  ExternalUser user=idp.getUser(TEST_USER1_UID);
  assertNotNull("User 1 must exist",user);
  Map<String,?> properties=user.getProperties();
  assertThat((Map<String,Collection<String>>)properties,Matchers.<String,Collection<String>>hasEntry(Matchers.equalTo("objectclass"),Matchers.containsInAnyOrder("inetOrgPerson","top","person","organizationalPerson")));
  assertThat(properties,Matchers.<String,Object>hasEntry("uid","hhornblo"));
  assertThat(properties,Matchers.<String,Object>hasEntry("mail","hhornblo@royalnavy.mod.uk"));
  assertThat(properties,Matchers.<String,Object>hasEntry("givenname","Horatio"));
  assertThat(properties,Matchers.<String,Object>hasEntry("description","Capt. Horatio Hornblower, R.N"));
  assertThat(properties,Matchers.<String,Object>hasEntry("sn","Hornblower"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.upgrade.nodestate.report.PeriodicReporterTest </h4><pre class="type-6 type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void callbackEveryTenNodes(){
  final AssertingPeriodicReporter reporter=new AssertingPeriodicReporter(10,-1);
  final NodeState counter=ReportingNodeState.wrap(EmptyNodeState.EMPTY_NODE,reporter).getChildNode("counter");
  reporter.reset();
  for (int i=1; i < 40; i++) {
    counter.getChildNode(Integer.toString(i));
  }
  assertThat(reporter,hasReportedNode(10,"/counter/10"));
  assertThat(reporter,hasReportedNode(20,"/counter/20"));
  assertThat(reporter,hasReportedNode(30,"/counter/30"));
}

</code></pre>

<br>
<pre class="type-6 type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void callbackEveryTenProperties(){
  final NodeBuilder builder=EmptyNodeState.EMPTY_NODE.builder();
  for (int i=1; i < 40; i++) {
    builder.child("counter").setProperty(Integer.toString(i),i);
  }
  final AssertingPeriodicReporter reporter=new AssertingPeriodicReporter(-1,10);
  final NodeState counter=ReportingNodeState.wrap(builder.getNodeState(),reporter).getChildNode("counter");
  reporter.reset();
  for (int i=1; i < 40; i++) {
    counter.getProperty(Integer.toString(i));
  }
  assertThat(reporter,hasReportedProperty(10,"/counter/10"));
  assertThat(reporter,hasReportedProperty(20,"/counter/20"));
  assertThat(reporter,hasReportedProperty(30,"/counter/30"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.jackrabbit.oak.upgrade.nodestate.report.ReportingNodeStateTest </h4><pre class="type-6 type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void getChildNodeEntriesReportsNode(){
  final NodeBuilder builder=EmptyNodeState.EMPTY_NODE.builder();
  for (int i=1; i < 20; i++) {
    builder.child("a" + i);
  }
  final AssertingPeriodicReporter reporter=new AssertingPeriodicReporter(10,10);
  final NodeState nodeState=ReportingNodeState.wrap(builder.getNodeState(),reporter);
  reporter.reset();
  int counter=0;
  String name="<none>";
  for (  final ChildNodeEntry child : nodeState.getChildNodeEntries()) {
    if (++counter == 10) {
      name=child.getName();
      break;
    }
  }
  assertThat(reporter,hasReportedNode(10,"/" + name));
}

</code></pre>

<br>
<pre class="type-6 type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void compareAgainstBaseState(){
  final NodeBuilder root=EmptyNodeState.EMPTY_NODE.builder();
  root.child("a").child("aa");
  final NodeState before=root.getNodeState();
  root.child("a").child("ab");
  root.child("b");
  final AssertingPeriodicReporter reporter=new AssertingPeriodicReporter(1,-1);
  final NodeState after=ReportingNodeState.wrap(root.getNodeState(),reporter);
  reporter.reset();
  NodeStateTestUtils.expectDifference().childNodeAdded("/a/ab","/b").childNodeChanged("/a").strict().verify(before,after);
  assertThat(reporter,hasReportedNodes("/a","/a/ab","/b"));
}

</code></pre>

<br>
<pre class="type-6 type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void getPropertyReportsProperty(){
  final NodeBuilder builder=EmptyNodeState.EMPTY_NODE.builder();
  final String name="meaningOfLife";
  builder.setProperty(name,"42");
  final AssertingPeriodicReporter reporter=new AssertingPeriodicReporter(1,1);
  final NodeState nodeState=ReportingNodeState.wrap(builder.getNodeState(),reporter);
  reporter.reset();
  nodeState.getProperty(name);
  nodeState.getBoolean(name);
  nodeState.getLong(name);
  nodeState.getString(name);
  nodeState.getStrings(name);
  nodeState.getName(name);
  nodeState.getNames(name);
  assertThat(reporter,not(hasReportedProperty(0,"/meaningOfLife")));
  assertThat(reporter,hasReportedProperty(1,"/meaningOfLife"));
  assertThat(reporter,hasReportedProperty(2,"/meaningOfLife"));
  assertThat(reporter,hasReportedProperty(3,"/meaningOfLife"));
  assertThat(reporter,hasReportedProperty(4,"/meaningOfLife"));
  assertThat(reporter,hasReportedProperty(5,"/meaningOfLife"));
  assertThat(reporter,hasReportedProperty(6,"/meaningOfLife"));
  assertThat(reporter,hasReportedProperty(7,"/meaningOfLife"));
  assertThat(reporter,not(hasReportedProperty(8,"/meaningOfLife")));
}

</code></pre>

<br>
<pre class="type-6 type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void getPropertiesReportsProperty(){
  final NodeBuilder builder=EmptyNodeState.EMPTY_NODE.builder();
  for (int i=0; i < 20; i++) {
    builder.setProperty("a" + i,"foo");
  }
  final AssertingPeriodicReporter reporter=new AssertingPeriodicReporter(10,10);
  final NodeState nodeState=ReportingNodeState.wrap(builder.getNodeState(),reporter);
  reporter.reset();
  int counter=0;
  for (  final PropertyState property : nodeState.getProperties()) {
    if (++counter == 10) {
      break;
    }
  }
  assertThat(reporter,hasReportedProperty(10,any(String.class)));
}

</code></pre>

<br>
<pre class="type-6 type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
"></span><br>
@Test public void getChildNodeReportsNode(){
  final AssertingPeriodicReporter reporter=new AssertingPeriodicReporter(10,10);
  final NodeState nodeState=ReportingNodeState.wrap(EmptyNodeState.EMPTY_NODE,reporter);
  reporter.reset();
  for (int i=1; i <= 20; i++) {
    nodeState.getChildNode("a" + i);
  }
  assertThat(reporter,hasReportedNode(10,"/a10"));
  assertThat(reporter,hasReportedNode(20,"/a20"));
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
