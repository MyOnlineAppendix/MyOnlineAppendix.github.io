<h3><span class=" glyphicon glyphicon-tag"/>&nbspBranchVerifier</h3><kbd>Verifies assertions inside branch conditions</kbd><br><br><br><h4 style="margin:0px">Class: org.apache.accumulo.core.client.ClientConfigurationTest </h4><pre class="type-11 type-5 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConfPath() throws IOException {
  File target=new File(System.getProperty("user.dir"),"target");
  assertTrue("'target' build directory does not exist",target.exists());
  File testDir=new File(target,getClass().getName());
  if (!testDir.exists()) {
    assertTrue("Failed to create test dir " + testDir,testDir.mkdirs());
  }
  File clientConf=new File(testDir,"client.conf");
  if (!clientConf.exists()) {
    assertTrue("Failed to create file " + clientConf,clientConf.createNewFile());
  }
  assertEquals(clientConf.toString(),ClientConfiguration.getClientConfPath(testDir.toString()));
  assertEquals(clientConf.toString(),ClientConfiguration.getClientConfPath(clientConf.toString()));
  final File missing=new File("foobarbaz12332112");
  assertEquals(missing.toString(),ClientConfiguration.getClientConfPath(missing.toString()));
  assertNull(ClientConfiguration.getClientConfPath(null));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.client.mock.MockConnectorTest </h4><pre class="type-11 type-5 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSunnyDay() throws Exception {
  Connector c=new MockConnector("root",new MockInstance());
  c.tableOperations().create("test");
  BatchWriter bw=c.createBatchWriter("test",new BatchWriterConfig());
  for (int i=0; i < 100; i++) {
    int r=random.nextInt();
    Mutation m=new Mutation(asText(r));
    m.put(asText(random.nextInt()),asText(random.nextInt()),new Value(Integer.toHexString(r).getBytes()));
    bw.addMutation(m);
  }
  bw.close();
  BatchScanner s=c.createBatchScanner("test",Authorizations.EMPTY,2);
  s.setRanges(Collections.singletonList(new Range()));
  Key key=null;
  int count=0;
  for (  Entry<Key,Value> entry : s) {
    if (key != null)     assertTrue(key.compareTo(entry.getKey()) < 0);
    assertEquals(entry.getKey().getRow(),new Text(entry.getValue().get()));
    key=entry.getKey();
    count++;
  }
  assertEquals(100,count);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.conf.AccumuloConfigurationTest </h4><pre class="type-11 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetPropertyByString(){
  AccumuloConfiguration c=AccumuloConfiguration.getDefaultConfiguration();
  boolean found=false;
  for (  Property p : Property.values()) {
    if (p.getType() != PropertyType.PREFIX) {
      found=true;
      assertEquals(c.get(p),c.get(p.getKey()));
      assertEquals(p.getDefaultValue(),c.get(p.getKey()));
    }
  }
  assertTrue("test was a dud, and did nothing",found);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.conf.PropertyTest </h4><pre class="type-11 type-5 type-3 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void validatePropertyKeys(){
  for (  Property prop : Property.values()) {
    if (prop.getType().equals(PropertyType.PREFIX)) {
      assertTrue(prop.getKey().endsWith("."));
      assertNull(prop.getDefaultValue());
    }
  }
}

</code></pre>

<br>
<pre class="type-11 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testPorts(){
  HashSet<Integer> usedPorts=new HashSet<Integer>();
  for (  Property prop : Property.values())   if (prop.getType().equals(PropertyType.PORT)) {
    int port=Integer.parseInt(prop.getDefaultValue());
    assertFalse("Port already in use: " + port,usedPorts.contains(port));
    usedPorts.add(port);
    assertTrue("Port out of range of valid ports: " + port,port > 1023 && port < 65536);
  }
}

</code></pre>

<br>
<pre class="type-11 type-5 type-3 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testProperties(){
  HashSet<String> validPrefixes=new HashSet<String>();
  for (  Property prop : Property.values())   if (prop.getType().equals(PropertyType.PREFIX))   validPrefixes.add(prop.getKey());
  HashSet<String> propertyNames=new HashSet<String>();
  for (  Property prop : Property.values()) {
    if (prop.getType() == PropertyType.PREFIX) {
      assertNull("PREFIX property " + prop.name() + " has unexpected non-null default value.",prop.getDefaultValue());
    }
 else {
      assertTrue("Property " + prop + " has invalid default value "+ prop.getDefaultValue()+ " for type "+ prop.getType(),prop.getType().isValidFormat(prop.getDefaultValue()));
    }
    assertFalse("Description not set for " + prop,prop.getDescription() == null || prop.getDescription().isEmpty());
    boolean containsValidPrefix=false;
    for (    String pre : validPrefixes)     if (prop.getKey().startsWith(pre)) {
      containsValidPrefix=true;
      break;
    }
    assertTrue("Invalid prefix on prop " + prop,containsValidPrefix);
    assertFalse("Duplicate property name " + prop.getKey(),propertyNames.contains(prop.getKey()));
    propertyNames.add(prop.getKey());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.data.ColumnTest </h4><pre class="type-13 type-11 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
"></span><br>
@Test public void testEquals(){
  for (int i=0; i < col.length; i++) {
    for (int j=0; j < col.length; j++) {
      if (i == j || (i == 0 && j == 1) || (i == 1 && j == 0))       assertTrue(col[i].equals(col[j]));
 else       assertFalse(col[i].equals(col[j]));
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-11 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCompare(){
  for (int i=0; i < col.length; i++) {
    for (int j=0; j < col.length; j++) {
      if (i == j || (i == 0 && j == 1) || (i == 1 && j == 0))       assertEquals(0,col[i].compareTo(col[j]));
 else       assertNotEquals(0,col[i].compareTo(col[j]));
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.file.BloomFilterLayerLookupTest </h4><pre class="type-9 type-13 type-11 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void test() throws IOException {
  HashSet<Integer> valsSet=new HashSet<Integer>();
  for (int i=0; i < 100000; i++) {
    valsSet.add(random.nextInt(Integer.MAX_VALUE));
  }
  ArrayList<Integer> vals=new ArrayList<Integer>(valsSet);
  Collections.sort(vals);
  ConfigurationCopy acuconf=new ConfigurationCopy(AccumuloConfiguration.getDefaultConfiguration());
  acuconf.set(Property.TABLE_BLOOM_ENABLED,"true");
  acuconf.set(Property.TABLE_BLOOM_KEY_FUNCTOR,ColumnFamilyFunctor.class.getName());
  acuconf.set(Property.TABLE_FILE_TYPE,RFile.EXTENSION);
  acuconf.set(Property.TABLE_BLOOM_LOAD_THRESHOLD,"1");
  acuconf.set(Property.TSERV_BLOOM_LOAD_MAXCONCURRENT,"1");
  Configuration conf=CachedConfiguration.getInstance();
  FileSystem fs=FileSystem.get(conf);
  String suffix=FileOperations.getNewFileExtension(acuconf);
  String fname=new File(tempDir.getRoot(),testName + "." + suffix).getAbsolutePath();
  FileSKVWriter bmfw=FileOperations.getInstance().openWriter(fname,fs,conf,acuconf);
  long t1=System.currentTimeMillis();
  bmfw.startDefaultLocalityGroup();
  for (  Integer i : vals) {
    String fi=String.format("%010d",i);
    bmfw.append(new Key(new Text("r" + fi),new Text("cf1")),new Value(("v" + fi).getBytes()));
    bmfw.append(new Key(new Text("r" + fi),new Text("cf2")),new Value(("v" + fi).getBytes()));
  }
  long t2=System.currentTimeMillis();
  LOG.debug(String.format("write rate %6.2f%n",vals.size() / ((t2 - t1) / 1000.0)));
  bmfw.close();
  t1=System.currentTimeMillis();
  FileSKVIterator bmfr=FileOperations.getInstance().openReader(fname,false,fs,conf,acuconf);
  t2=System.currentTimeMillis();
  LOG.debug("Opened " + fname + " in "+ (t2 - t1));
  int hits=0;
  t1=System.currentTimeMillis();
  for (int i=0; i < 5000; i++) {
    int row=random.nextInt(Integer.MAX_VALUE);
    seek(bmfr,row);
    if (valsSet.contains(row)) {
      hits++;
      assertTrue(bmfr.hasTop());
    }
  }
  t2=System.currentTimeMillis();
  double rate1=5000 / ((t2 - t1) / 1000.0);
  LOG.debug(String.format("random lookup rate : %6.2f%n",rate1));
  LOG.debug("hits = " + hits);
  int count=0;
  t1=System.currentTimeMillis();
  for (  Integer row : valsSet) {
    seek(bmfr,row);
    assertTrue(bmfr.hasTop());
    count++;
    if (count >= 500) {
      break;
    }
  }
  t2=System.currentTimeMillis();
  double rate2=500 / ((t2 - t1) / 1000.0);
  LOG.debug(String.format("existant lookup rate %6.2f%n",rate2));
  LOG.debug("expected hits 500.  Receive hits: " + count);
  bmfr.close();
  assertTrue(rate1 > rate2);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.file.rfile.BlockIndexTest </h4><pre class="type-9 type-13 type-11 type-3 type-15 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test1() throws IOException {
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  DataOutputStream out=new DataOutputStream(baos);
  Key prevKey=null;
  int num=1000;
  for (int i=0; i < num; i++) {
    Key key=new Key(RFileTest.nf("",i),"cf1","cq1");
    new RelativeKey(prevKey,key).write(out);
    new Value(new byte[0]).write(out);
    prevKey=key;
  }
  out.close();
  final byte[] data=baos.toByteArray();
  CacheEntry ce=new MyCacheEntry(data);
  ABlockReader cacheBlock=new CachableBlockFile.CachedBlockRead(ce,data);
  BlockIndex blockIndex=null;
  for (int i=0; i < 129; i++)   blockIndex=BlockIndex.getIndex(cacheBlock,new IndexEntry(prevKey,num,0,0,0));
  BlockIndexEntry[] indexEntries=blockIndex.getIndexEntries();
  for (int i=0; i < indexEntries.length; i++) {
    int row=Integer.parseInt(indexEntries[i].getPrevKey().getRowData().toString());
    BlockIndexEntry bie;
    bie=blockIndex.seekBlock(new Key(RFileTest.nf("",row),"cf1","cq1"),cacheBlock);
    if (i == 0)     Assert.assertSame(null,bie);
 else     Assert.assertSame(indexEntries[i - 1],bie);
    Assert.assertSame(bie,blockIndex.seekBlock(new Key(RFileTest.nf("",row - 1),"cf1","cq1"),cacheBlock));
    bie=blockIndex.seekBlock(new Key(RFileTest.nf("",row + 1),"cf1","cq1"),cacheBlock);
    Assert.assertSame(indexEntries[i],bie);
    RelativeKey rk=new RelativeKey();
    rk.setPrevKey(bie.getPrevKey());
    rk.readFields(cacheBlock);
    Assert.assertEquals(rk.getKey(),new Key(RFileTest.nf("",row + 1),"cf1","cq1"));
  }
  cacheBlock.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.file.rfile.RFileTest </h4><pre class="type-13 type-11 type-5 type-3 type-2 type-14 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test11() throws IOException {
  TestRFile trf=new TestRFile(conf);
  trf.openWriter(false);
  trf.writer.startNewLocalityGroup("lg1",ncfs("3mod10"));
  for (int i=3; i < 1024; i+=10) {
    trf.writer.append(nk(nf("i",i),"3mod10","","",i + 2),nv("" + i));
  }
  trf.writer.startNewLocalityGroup("lg2",ncfs("5mod10","7mod10"));
  for (int i=5; i < 1024; ) {
    trf.writer.append(nk(nf("i",i),"5mod10","","",i + 2),nv("" + i));
    i+=2;
    trf.writer.append(nk(nf("i",i),"7mod10","","",i + 2),nv("" + i));
    i+=8;
  }
  trf.writer.startDefaultLocalityGroup();
  for (int i=0; i < 1024; i++) {
    int m10=i % 10;
    if (m10 == 3 || m10 == 5 || m10 == 7)     continue;
    trf.writer.append(nk(nf("i",i),m10 + "mod10","","",i + 2),nv("" + i));
  }
  trf.writer.close();
  trf.openReader();
  trf.iter.seek(new Range(new Text(""),null),EMPTY_COL_FAMS,false);
  assertEquals(3,trf.reader.getNumLocalityGroupsSeeked());
  for (int i=0; i < 1024; i++) {
    assertTrue(trf.iter.hasTop());
    assertEquals(nk(nf("i",i),(i % 10) + "mod10","","",i + 2),trf.iter.getTopKey());
    assertEquals(nv("" + i),trf.iter.getTopValue());
    trf.iter.next();
  }
  assertFalse(trf.iter.hasTop());
  for (int m=0; m < 10; m++) {
    trf.iter.seek(new Range(new Key(),true,null,true),ncfs(m + "mod10"),true);
    assertEquals(1,trf.reader.getNumLocalityGroupsSeeked());
    for (int i=m; i < 1024; i+=10) {
      assertTrue(trf.iter.hasTop());
      assertEquals(nk(nf("i",i),(i % 10) + "mod10","","",i + 2),trf.iter.getTopKey());
      assertEquals(nv("" + i),trf.iter.getTopValue());
      trf.iter.next();
    }
    assertFalse(trf.iter.hasTop());
    trf.iter.seek(new Range(new Key(),true,null,true),ncfs(m + "mod10"),false);
    if (m == 3)     assertEquals(2,trf.reader.getNumLocalityGroupsSeeked());
 else     assertEquals(3,trf.reader.getNumLocalityGroupsSeeked());
    for (int i=0; i < 1024; i++) {
      if (i % 10 == m)       continue;
      assertTrue(trf.iter.hasTop());
      assertEquals(nk(nf("i",i),(i % 10) + "mod10","","",i + 2),trf.iter.getTopKey());
      assertEquals(nv("" + i),trf.iter.getTopValue());
      trf.iter.next();
    }
    assertFalse(trf.iter.hasTop());
  }
  SortedKeyValueIterator<Key,Value> reader2=trf.iter.deepCopy(null);
  for (int m=0; m < 9; m++) {
    trf.iter.seek(new Range(new Key(),true,null,true),ncfs(m + "mod10"),true);
    assertEquals(1,trf.reader.getNumLocalityGroupsSeeked());
    reader2.seek(new Range(new Key(),true,null,true),ncfs((m + 1) + "mod10"),true);
    for (int i=m; i < 1024; i+=10) {
      assertTrue(trf.iter.hasTop());
      assertEquals(nk(nf("i",i),(i % 10) + "mod10","","",i + 2),trf.iter.getTopKey());
      assertEquals(nv("" + i),trf.iter.getTopValue());
      trf.iter.next();
      if (i + 1 < 1024) {
        assertTrue(reader2.hasTop());
        assertEquals(nk(nf("i",(i + 1)),((i + 1) % 10) + "mod10","","",i + 3),reader2.getTopKey());
        assertEquals(nv("" + (i + 1)),reader2.getTopValue());
        reader2.next();
      }
    }
    assertFalse(trf.iter.hasTop());
    assertFalse(reader2.hasTop());
  }
  trf.closeReader();
}

</code></pre>

<br>
<pre class="type-11 type-3 type-2 type-14 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testCryptoDoesntLeakSensitive() throws IOException {
  conf=setAndGetAccumuloConfig(CryptoTest.CRYPTO_ON_CONF);
  TestRFile trf=new TestRFile(conf);
  trf.openWriter();
  trf.closeWriter();
  byte[] rfBytes=trf.baos.toByteArray();
  for (  Property prop : Property.values()) {
    if (prop.isSensitive()) {
      byte[] toCheck=prop.getKey().getBytes();
      assertEquals(-1,Bytes.indexOf(rfBytes,toCheck));
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.iterators.user.TestCfCqSlice </h4><pre class="type-13 type-11 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
"></span><br>
@Test public void testAllCfsCqSlice() throws Exception {
  boolean[][][] foundKvs=new boolean[LR_DIM][LR_DIM][LR_DIM];
  long sliceMinCq=10;
  long sliceMaxCq=30;
  Map<String,String> opts=new HashMap<String,String>();
  opts.put(CfCqSliceOpts.OPT_MIN_CQ,new String(LONG_LEX.encode(sliceMinCq),UTF_8));
  opts.put(CfCqSliceOpts.OPT_MAX_CQ,new String(LONG_LEX.encode(sliceMaxCq),UTF_8));
  loadKvs(foundKvs,opts,INFINITY);
  for (int i=0; i < LR_DIM; i++) {
    for (int j=0; j < LR_DIM; j++) {
      for (int k=0; k < LR_DIM; k++) {
        if (k >= sliceMinCq && k <= sliceMaxCq) {
          assertTrue("(r, cf, cq) == (" + i + ", "+ j+ ", "+ k+ ") must be found in scan",foundKvs[i][j][k]);
        }
 else {
          assertFalse("(r, cf, cq) == (" + i + ", "+ j+ ", "+ k+ ") must not be found in scan",foundKvs[i][j][k]);
        }
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-11 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
"></span><br>
@Test public void testSingleRowFullSlice() throws Exception {
  boolean[][][] foundKvs=new boolean[LR_DIM][LR_DIM][LR_DIM];
  int rowId=LR_DIM / 2;
  loadKvs(foundKvs,EMPTY_OPTS,Range.exact(new Text(LONG_LEX.encode((long)rowId))));
  for (int i=0; i < LR_DIM; i++) {
    for (int j=0; j < LR_DIM; j++) {
      for (int k=0; k < LR_DIM; k++) {
        if (rowId == i) {
          assertTrue("(r, cf, cq) == (" + i + ", "+ j+ ", "+ k+ ") must be found in scan",foundKvs[i][j][k]);
        }
 else {
          assertFalse("(r, cf, cq) == (" + i + ", "+ j+ ", "+ k+ ") must not be found in scan",foundKvs[i][j][k]);
        }
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-11 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
"></span><br>
@Test public void testSeekMinExclusive() throws Exception {
  boolean[][][] foundKvs=new boolean[LR_DIM][LR_DIM][LR_DIM];
  long sliceMinCf=20;
  long sliceMinCq=30;
  long sliceMaxCf=25;
  long sliceMaxCq=35;
  assertTrue("slice param must be less than LR_DIM",sliceMinCf < LR_DIM);
  assertTrue("slice param must be less than LR_DIM",sliceMinCq < LR_DIM);
  assertTrue("slice param must be less than LR_DIM",sliceMaxCf < LR_DIM);
  assertTrue("slice param must be less than LR_DIM",sliceMaxCq < LR_DIM);
  Map<String,String> opts=new HashMap<>();
  opts.put(CfCqSliceOpts.OPT_MIN_CF,new String(LONG_LEX.encode(sliceMinCf),UTF_8));
  opts.put(CfCqSliceOpts.OPT_MIN_INCLUSIVE,"false");
  opts.put(CfCqSliceOpts.OPT_MIN_CQ,new String(LONG_LEX.encode(sliceMinCq),UTF_8));
  opts.put(CfCqSliceOpts.OPT_MAX_CF,new String(LONG_LEX.encode(sliceMaxCf),UTF_8));
  opts.put(CfCqSliceOpts.OPT_MAX_CQ,new String(LONG_LEX.encode(sliceMaxCq),UTF_8));
  Range startsAtMinCf=new Range(new Key(LONG_LEX.encode(0l),LONG_LEX.encode(sliceMinCf),LONG_LEX.encode(sliceMinCq),new byte[]{},Long.MAX_VALUE),null);
  loadKvs(foundKvs,opts,startsAtMinCf);
  for (int i=0; i < LR_DIM; i++) {
    for (int j=0; j < LR_DIM; j++) {
      for (int k=0; k < LR_DIM; k++) {
        if (j > sliceMinCf && j <= sliceMaxCf && k > sliceMinCq && k <= sliceMaxCq) {
          assertTrue("(r, cf, cq) == (" + i + ", "+ j+ ", "+ k+ ") must be found in scan",foundKvs[i][j][k]);
        }
 else {
          assertFalse("(r, cf, cq) == (" + i + ", "+ j+ ", "+ k+ ") must not be found in scan",foundKvs[i][j][k]);
        }
      }
    }
  }
  foundKvs=new boolean[LR_DIM][LR_DIM][LR_DIM];
  sliceMinCq=0;
  sliceMaxCq=10;
  opts.put(CfCqSliceOpts.OPT_MIN_CF,new String(LONG_LEX.encode(sliceMinCf),UTF_8));
  opts.put(CfCqSliceOpts.OPT_MIN_INCLUSIVE,"false");
  opts.put(CfCqSliceOpts.OPT_MIN_CQ,new String(LONG_LEX.encode(sliceMinCq),UTF_8));
  opts.put(CfCqSliceOpts.OPT_MAX_CF,new String(LONG_LEX.encode(sliceMaxCf),UTF_8));
  opts.put(CfCqSliceOpts.OPT_MAX_CQ,new String(LONG_LEX.encode(sliceMaxCq),UTF_8));
  loadKvs(foundKvs,opts,INFINITY);
  for (int i=0; i < LR_DIM; i++) {
    for (int j=0; j < LR_DIM; j++) {
      for (int k=0; k < LR_DIM; k++) {
        if (j > sliceMinCf && j <= sliceMaxCf && k > sliceMinCq && k <= sliceMaxCq) {
          assertTrue("(r, cf, cq) == (" + i + ", "+ j+ ", "+ k+ ") must be found in scan",foundKvs[i][j][k]);
        }
 else {
          assertFalse("(r, cf, cq) == (" + i + ", "+ j+ ", "+ k+ ") must not be found in scan",foundKvs[i][j][k]);
        }
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-11 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
"></span><br>
@Test public void testStackedFilters() throws Exception {
  Map<String,String> firstOpts=new HashMap<>();
  Map<String,String> secondOpts=new HashMap<>();
  boolean[][][] foundKvs=new boolean[LR_DIM][LR_DIM][LR_DIM];
  long sliceMinCf=20;
  long sliceMaxCf=25;
  long sliceMinCq=30;
  long sliceMaxCq=35;
  assertTrue("slice param must be less than LR_DIM",sliceMinCf < LR_DIM);
  assertTrue("slice param must be less than LR_DIM",sliceMinCq < LR_DIM);
  assertTrue("slice param must be less than LR_DIM",sliceMaxCf < LR_DIM);
  assertTrue("slice param must be less than LR_DIM",sliceMaxCq < LR_DIM);
  firstOpts.put(CfCqSliceOpts.OPT_MIN_CF,new String(LONG_LEX.encode(sliceMinCf),UTF_8));
  firstOpts.put(CfCqSliceOpts.OPT_MAX_CF,new String(LONG_LEX.encode(sliceMaxCf),UTF_8));
  secondOpts.put(CfCqSliceOpts.OPT_MIN_CQ,new String(LONG_LEX.encode(sliceMinCq),UTF_8));
  secondOpts.put(CfCqSliceOpts.OPT_MAX_CQ,new String(LONG_LEX.encode(sliceMaxCq),UTF_8));
  SortedKeyValueIterator<Key,Value> skvi=getFilterClass().newInstance();
  skvi.init(new SortedMapIterator(data),firstOpts,null);
  loadKvs(skvi.deepCopy(null),foundKvs,secondOpts,INFINITY);
  for (int i=0; i < LR_DIM; i++) {
    for (int j=0; j < LR_DIM; j++) {
      for (int k=0; k < LR_DIM; k++) {
        if (j >= sliceMinCf && j <= sliceMaxCf && k >= sliceMinCq && k <= sliceMaxCq) {
          assertTrue("(r, cf, cq) == (" + i + ", "+ j+ ", "+ k+ ") must be found in scan",foundKvs[i][j][k]);
        }
 else {
          assertFalse("(r, cf, cq) == (" + i + ", "+ j+ ", "+ k+ ") must not be found in scan",foundKvs[i][j][k]);
        }
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-11 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
"></span><br>
@Test public void testSliceCfsAllCqs() throws Exception {
  boolean[][][] foundKvs=new boolean[LR_DIM][LR_DIM][LR_DIM];
  long sliceMinCf=10;
  long sliceMaxCf=30;
  Map<String,String> opts=new HashMap<String,String>();
  opts.put(CfCqSliceOpts.OPT_MIN_CF,new String(LONG_LEX.encode(sliceMinCf),UTF_8));
  opts.put(CfCqSliceOpts.OPT_MAX_CF,new String(LONG_LEX.encode(sliceMaxCf),UTF_8));
  loadKvs(foundKvs,opts,INFINITY);
  for (int i=0; i < LR_DIM; i++) {
    for (int j=0; j < LR_DIM; j++) {
      for (int k=0; k < LR_DIM; k++) {
        if (j >= sliceMinCf && j <= sliceMaxCf) {
          assertTrue("(r, cf, cq) == (" + i + ", "+ j+ ", "+ k+ ") must be found in scan",foundKvs[i][j][k]);
        }
 else {
          assertFalse("(r, cf, cq) == (" + i + ", "+ j+ ", "+ k+ ") must not be found in scan",foundKvs[i][j][k]);
        }
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-11 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
"></span><br>
@Test public void testAllRowsSlice() throws Exception {
  boolean[][][] foundKvs=new boolean[LR_DIM][LR_DIM][LR_DIM];
  long sliceMinCf=20;
  long sliceMinCq=30;
  long sliceMaxCf=25;
  long sliceMaxCq=35;
  assertTrue("slice param must be less than LR_DIM",sliceMinCf < LR_DIM);
  assertTrue("slice param must be less than LR_DIM",sliceMinCq < LR_DIM);
  assertTrue("slice param must be less than LR_DIM",sliceMaxCf < LR_DIM);
  assertTrue("slice param must be less than LR_DIM",sliceMaxCq < LR_DIM);
  Map<String,String> opts=new HashMap<String,String>();
  opts.put(CfCqSliceOpts.OPT_MIN_CF,new String(LONG_LEX.encode(sliceMinCf),UTF_8));
  opts.put(CfCqSliceOpts.OPT_MIN_CQ,new String(LONG_LEX.encode(sliceMinCq),UTF_8));
  opts.put(CfCqSliceOpts.OPT_MAX_CF,new String(LONG_LEX.encode(sliceMaxCf),UTF_8));
  opts.put(CfCqSliceOpts.OPT_MAX_CQ,new String(LONG_LEX.encode(sliceMaxCq),UTF_8));
  loadKvs(foundKvs,opts,INFINITY);
  for (int i=0; i < LR_DIM; i++) {
    for (int j=0; j < LR_DIM; j++) {
      for (int k=0; k < LR_DIM; k++) {
        if (j >= sliceMinCf && j <= sliceMaxCf && k >= sliceMinCq && k <= sliceMaxCq) {
          assertTrue("(r, cf, cq) == (" + i + ", "+ j+ ", "+ k+ ") must be found in scan",foundKvs[i][j][k]);
        }
 else {
          assertFalse("(r, cf, cq) == (" + i + ", "+ j+ ", "+ k+ ") must not be found in scan",foundKvs[i][j][k]);
        }
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-11 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
"></span><br>
@Test public void testSingleColumnSliceByExclude() throws Exception {
  boolean[][][] foundKvs=new boolean[LR_DIM][LR_DIM][LR_DIM];
  long sliceMinCf=20;
  long sliceMinCq=20;
  long sliceMaxCf=22;
  long sliceMaxCq=22;
  Map<String,String> opts=new HashMap<String,String>();
  opts.put(CfCqSliceOpts.OPT_MIN_CF,new String(LONG_LEX.encode(sliceMinCf),UTF_8));
  opts.put(CfCqSliceOpts.OPT_MIN_CQ,new String(LONG_LEX.encode(sliceMinCq),UTF_8));
  opts.put(CfCqSliceOpts.OPT_MAX_CF,new String(LONG_LEX.encode(sliceMaxCf),UTF_8));
  opts.put(CfCqSliceOpts.OPT_MAX_CQ,new String(LONG_LEX.encode(sliceMaxCq),UTF_8));
  opts.put(CfCqSliceOpts.OPT_MAX_INCLUSIVE,"false");
  opts.put(CfCqSliceOpts.OPT_MIN_INCLUSIVE,"false");
  loadKvs(foundKvs,opts,INFINITY);
  for (int i=0; i < LR_DIM; i++) {
    for (int j=0; j < LR_DIM; j++) {
      for (int k=0; k < LR_DIM; k++) {
        if (j == 21 && k == 21) {
          assertTrue("(r, cf, cq) == (" + i + ", "+ j+ ", "+ k+ ") must be found in scan",foundKvs[i][j][k]);
        }
 else {
          assertFalse("(r, cf, cq) == (" + i + ", "+ j+ ", "+ k+ ") must not be found in scan",foundKvs[i][j][k]);
        }
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-11 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
"></span><br>
@Test public void testSingleColumnSlice() throws Exception {
  boolean[][][] foundKvs=new boolean[LR_DIM][LR_DIM][LR_DIM];
  long sliceMinCf=20;
  long sliceMinCq=20;
  long sliceMaxCf=20;
  long sliceMaxCq=20;
  Map<String,String> opts=new HashMap<String,String>();
  opts.put(CfCqSliceOpts.OPT_MIN_CF,new String(LONG_LEX.encode(sliceMinCf),UTF_8));
  opts.put(CfCqSliceOpts.OPT_MIN_CQ,new String(LONG_LEX.encode(sliceMinCq),UTF_8));
  opts.put(CfCqSliceOpts.OPT_MAX_CF,new String(LONG_LEX.encode(sliceMaxCf),UTF_8));
  opts.put(CfCqSliceOpts.OPT_MAX_CQ,new String(LONG_LEX.encode(sliceMaxCq),UTF_8));
  loadKvs(foundKvs,opts,INFINITY);
  for (int i=0; i < LR_DIM; i++) {
    for (int j=0; j < LR_DIM; j++) {
      for (int k=0; k < LR_DIM; k++) {
        if (j == sliceMinCf && k == sliceMinCq) {
          assertTrue("(r, cf, cq) == (" + i + ", "+ j+ ", "+ k+ ") must be found in scan",foundKvs[i][j][k]);
        }
 else {
          assertFalse("(r, cf, cq) == (" + i + ", "+ j+ ", "+ k+ ") must not be found in scan",foundKvs[i][j][k]);
        }
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.security.crypto.CryptoTest </h4><pre class="type-9 type-11 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCryptoModuleDoesntLeakSensitive() throws IOException {
  AccumuloConfiguration conf=setAndGetAccumuloConfig(CRYPTO_ON_CONF);
  CryptoModuleParameters params=CryptoModuleFactory.createParamsObjectFromAccumuloConfiguration(conf);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  params.setPlaintextOutputStream(baos);
  CryptoModule cryptoModule=CryptoModuleFactory.getCryptoModule(conf);
  cryptoModule.getEncryptingOutputStream(params);
  params.getEncryptedOutputStream().close();
  byte[] streamBytes=baos.toByteArray();
  for (  Property prop : Property.values()) {
    if (prop.isSensitive()) {
      byte[] toCheck=prop.getKey().getBytes();
      assertEquals(-1,Bytes.indexOf(streamBytes,toCheck));
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.minicluster.MiniAccumuloClusterTest </h4><pre class="type-11 type-5 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=30000) public void test() throws Exception {
  Connector conn=accumulo.getConnector("root","superSecret");
  conn.tableOperations().create("table1",new NewTableConfiguration());
  conn.securityOperations().createLocalUser("user1",new PasswordToken("pass1"));
  conn.securityOperations().changeUserAuthorizations("user1",new Authorizations("A","B"));
  conn.securityOperations().grantTablePermission("user1","table1",TablePermission.WRITE);
  conn.securityOperations().grantTablePermission("user1","table1",TablePermission.READ);
  IteratorSetting is=new IteratorSetting(10,SummingCombiner.class);
  SummingCombiner.setEncodingType(is,LongCombiner.Type.STRING);
  SummingCombiner.setColumns(is,Collections.singletonList(new IteratorSetting.Column("META","COUNT")));
  conn.tableOperations().attachIterator("table1",is);
  Connector uconn=accumulo.getConnector("user1","pass1");
  BatchWriter bw=uconn.createBatchWriter("table1",new BatchWriterConfig());
  UUID uuid=UUID.randomUUID();
  Mutation m=new Mutation(uuid.toString());
  m.put("META","SIZE",new ColumnVisibility("A|B"),"8");
  m.put("META","CRC",new ColumnVisibility("A|B"),"456");
  m.put("META","COUNT",new ColumnVisibility("A|B"),"1");
  m.put("DATA","IMG",new ColumnVisibility("A&B"),"ABCDEFGH");
  bw.addMutation(m);
  bw.flush();
  m=new Mutation(uuid.toString());
  m.put("META","COUNT",new ColumnVisibility("A|B"),"1");
  m.put("META","CRC",new ColumnVisibility("A|B"),"123");
  bw.addMutation(m);
  bw.close();
  int count=0;
  Scanner scanner=uconn.createScanner("table1",new Authorizations("A"));
  for (  Entry<Key,Value> entry : scanner) {
    if (entry.getKey().getColumnQualifierData().toString().equals("COUNT")) {
      Assert.assertEquals("2",entry.getValue().toString());
    }
 else     if (entry.getKey().getColumnQualifierData().toString().equals("SIZE")) {
      Assert.assertEquals("8",entry.getValue().toString());
    }
 else     if (entry.getKey().getColumnQualifierData().toString().equals("CRC")) {
      Assert.assertEquals("123",entry.getValue().toString());
    }
 else {
      Assert.assertTrue(false);
    }
    count++;
  }
  Assert.assertEquals(3,count);
  count=0;
  scanner=uconn.createScanner("table1",new Authorizations("A","B"));
  for (  Entry<Key,Value> entry : scanner) {
    if (entry.getKey().getColumnQualifierData().toString().equals("IMG")) {
      Assert.assertEquals("ABCDEFGH",entry.getValue().toString());
    }
    count++;
  }
  Assert.assertEquals(4,count);
  conn.tableOperations().delete("table1");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.server.fs.ViewFSUtilsTest </h4><pre class="type-9 type-11 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testOverlappingMountPoints() throws IllegalArgumentException, IOException {
  if (ViewFSUtils.isViewFSSupported()) {
    Configuration conf=new Configuration(false);
    conf.set("fs.viewfs.mounttable.default.link./","file:///tmp/0");
    conf.set("fs.viewfs.mounttable.default.link./ns1","file:///tmp/1");
    conf.set("fs.viewfs.mounttable.default.link./ns1/A","file:///tmp/2");
    conf.set("fs.viewfs.mounttable.default.link./ns1/AA","file:///tmp/3");
    conf.set("fs.viewfs.mounttable.default.link./ns1/C","file:///tmp/3");
    conf.set("fs.viewfs.mounttable.default.link./ns2","file:///tmp/3");
    String[] tablesDirs1=shuffle("viewfs:///ns1/accumulo/tables","viewfs:///ns1/A/accumulo/tables","viewfs:///ns1/AA/accumulo/tables","viewfs:///ns1/C/accumulo/tables","viewfs:///ns2/accumulo/tables","viewfs:///accumulo/tables");
    String[] tablesDirs2=shuffle("viewfs:/ns1/accumulo/tables","viewfs:/ns1/A/accumulo/tables","viewfs:/ns1/AA/accumulo/tables","viewfs:/ns1/C/accumulo/tables","viewfs:/ns2/accumulo/tables","viewfs:/accumulo/tables");
    for (    String ns : Arrays.asList("","/ns1","/ns1/A","/ns1/AA","/ns1/C","/ns2")) {
      Path match=ViewFSUtils.matchingFileSystem(new Path("viewfs:" + ns + "/bulk_import_01"),tablesDirs2,conf);
      Assert.assertEquals(new Path("viewfs:" + ns + "/accumulo/tables"),match);
      match=ViewFSUtils.matchingFileSystem(new Path("viewfs://" + ns + "/bulk_import_01"),tablesDirs1,conf);
      Assert.assertEquals(new Path("viewfs:" + ns + "/accumulo/tables"),match);
      match=ViewFSUtils.matchingFileSystem(new Path("viewfs:" + ns + "/bulk_import_01"),tablesDirs2,conf);
      Assert.assertEquals(new Path("viewfs:" + ns + "/accumulo/tables"),match);
      match=ViewFSUtils.matchingFileSystem(new Path("viewfs://" + ns + "/bulk_import_01"),tablesDirs1,conf);
      Assert.assertEquals(new Path("viewfs:" + ns + "/accumulo/tables"),match);
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-11 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDisjointMountPoints() throws IllegalArgumentException, IOException {
  if (ViewFSUtils.isViewFSSupported()) {
    Configuration conf=new Configuration(false);
    conf.set("fs.viewfs.mounttable.default.link./ns","file:///tmp/ns");
    conf.set("fs.viewfs.mounttable.default.link./ns1","file:///tmp/ns1");
    conf.set("fs.viewfs.mounttable.default.link./ns2","file:///tmp/ns2");
    conf.set("fs.viewfs.mounttable.default.link./ns22","file:///tmp/ns22");
    String[] tablesDirs1=shuffle("viewfs:///ns1/accumulo/tables","viewfs:///ns2/accumulo/tables","viewfs:///ns22/accumulo/tables","viewfs:///ns/accumulo/tables");
    String[] tablesDirs2=shuffle("viewfs:/ns1/accumulo/tables","viewfs:/ns2/accumulo/tables","viewfs:/ns22/accumulo/tables","viewfs:/ns/accumulo/tables");
    for (    String ns : Arrays.asList("ns1","ns2","ns22","ns")) {
      Path match=ViewFSUtils.matchingFileSystem(new Path("viewfs:/" + ns + "/bulk_import_01"),tablesDirs2,conf);
      Assert.assertEquals(new Path("viewfs:/" + ns + "/accumulo/tables"),match);
      match=ViewFSUtils.matchingFileSystem(new Path("viewfs:///" + ns + "/bulk_import_01"),tablesDirs1,conf);
      Assert.assertEquals(new Path("viewfs:/" + ns + "/accumulo/tables"),match);
      match=ViewFSUtils.matchingFileSystem(new Path("viewfs:/" + ns + "/bulk_import_01"),tablesDirs2,conf);
      Assert.assertEquals(new Path("viewfs:/" + ns + "/accumulo/tables"),match);
      match=ViewFSUtils.matchingFileSystem(new Path("viewfs:///" + ns + "/bulk_import_01"),tablesDirs1,conf);
      Assert.assertEquals(new Path("viewfs:/" + ns + "/accumulo/tables"),match);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.BulkImportSequentialRowsIT </h4><pre class="type-11 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBulkImportFailure() throws Exception {
  String tableName=getUniqueNames(1)[0];
  TableOperations to=getConnector().tableOperations();
  to.create(tableName);
  FileSystem fs=getFileSystem();
  Path rootPath=new Path(fs.makeQualified(getUsableDir()),getClass().getSimpleName());
  log.info("Writing to {}",rootPath);
  if (fs.exists(rootPath)) {
    assertTrue(fs.delete(rootPath,true));
  }
  assertTrue(fs.mkdirs(rootPath));
  Path bulk=new Path(rootPath,"bulk");
  log.info("bulk: {}",bulk);
  assertTrue(fs.mkdirs(bulk));
  Path err=new Path(rootPath,"err");
  log.info("err: {}",err);
  assertTrue(fs.mkdirs(bulk));
  assertTrue(fs.mkdirs(err));
  Path rfile=new Path(bulk,"file.rf");
  log.info("Generating RFile {}",rfile.toUri().toString());
  GenerateSequentialRFile.main(new String[]{"-f",rfile.toUri().toString(),"-nr",Long.toString(NR),"-nv",Long.toString(NV)});
  assertTrue("Expected that " + rfile + " exists, but it does not",fs.exists(rfile));
  FsShell fsShell=new FsShell(fs.getConf());
  assertEquals("Failed to chmod " + rootPath,0,fsShell.run(new String[]{"-chmod","-R","777",rootPath.toString()}));
  to.addSplits(tableName,getSplits());
  to.importDirectory(tableName,bulk.toString(),err.toString(),false);
  assertEquals(NR * NV,Iterables.size(getConnector().createScanner(tableName,Authorizations.EMPTY)));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.ConditionalWriterIT </h4><pre class="type-9 type-13 type-11 type-5 type-3 type-21 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTrace() throws Exception {
  Assume.assumeTrue(getClusterType() == ClusterType.MINI);
  Process tracer=null;
  Connector conn=getConnector();
  AccumuloCluster cluster=getCluster();
  MiniAccumuloClusterImpl mac=(MiniAccumuloClusterImpl)cluster;
  if (!conn.tableOperations().exists("trace")) {
    tracer=mac.exec(TraceServer.class);
    while (!conn.tableOperations().exists("trace")) {
      sleepUninterruptibly(1,TimeUnit.SECONDS);
    }
  }
  String tableName=getUniqueNames(1)[0];
  conn.tableOperations().create(tableName);
  DistributedTrace.enable("localhost","testTrace",mac.getClientConfig());
  sleepUninterruptibly(1,TimeUnit.SECONDS);
  Span root=Trace.on("traceTest");
  ConditionalWriter cw=conn.createConditionalWriter(tableName,new ConditionalWriterConfig());
  ConditionalMutation cm0=new ConditionalMutation("99006",new Condition("tx","seq"));
  cm0.put("name","last","doe");
  cm0.put("name","first","john");
  cm0.put("tx","seq","1");
  Assert.assertEquals(Status.ACCEPTED,cw.write(cm0).getStatus());
  root.stop();
  final Scanner scanner=conn.createScanner("trace",Authorizations.EMPTY);
  scanner.setRange(new Range(new Text(Long.toHexString(root.traceId()))));
  loop:   while (true) {
    final StringBuilder finalBuffer=new StringBuilder();
    int traceCount=TraceDump.printTrace(scanner,new Printer(){
      @Override public void print(      final String line){
        try {
          finalBuffer.append(line).append("\n");
        }
 catch (        Exception ex) {
          throw new RuntimeException(ex);
        }
      }
    }
);
    String traceOutput=finalBuffer.toString();
    log.info("Trace output:" + traceOutput);
    if (traceCount > 0) {
      int lastPos=0;
      for (      String part : "traceTest, startScan,startConditionalUpdate,conditionalUpdate,Check conditions,apply conditional mutations".split(",")) {
        log.info("Looking in trace output for '" + part + "'");
        int pos=traceOutput.indexOf(part);
        if (-1 == pos) {
          log.info("Trace output doesn't contain '" + part + "'");
          Thread.sleep(1000);
          break loop;
        }
        assertTrue("Did not find '" + part + "' in output",pos > 0);
        assertTrue("'" + part + "' occurred earlier than the previous element unexpectedly",pos > lastPos);
        lastPos=pos;
      }
      break;
    }
 else {
      log.info("Ignoring trace output as traceCount not greater than zero: " + traceCount);
      Thread.sleep(1000);
    }
  }
  if (tracer != null) {
    tracer.destroy();
  }
}

</code></pre>

<br>
<pre class="type-9 type-13 type-11 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBatchErrors() throws Exception {
  Connector conn=getConnector();
  String tableName=getUniqueNames(1)[0];
  conn.tableOperations().create(tableName);
  conn.tableOperations().addConstraint(tableName,AlphaNumKeyConstraint.class.getName());
  conn.tableOperations().clone(tableName,tableName + "_clone",true,new HashMap<String,String>(),new HashSet<String>());
  conn.securityOperations().changeUserAuthorizations(getAdminPrincipal(),new Authorizations("A","B"));
  ColumnVisibility cvaob=new ColumnVisibility("A|B");
  ColumnVisibility cvaab=new ColumnVisibility("A&B");
switch ((new Random()).nextInt(3)) {
case 1:
    conn.tableOperations().addSplits(tableName,nss("6"));
  break;
case 2:
conn.tableOperations().addSplits(tableName,nss("2","95"));
break;
}
ArrayList<ConditionalMutation> mutations=new ArrayList<ConditionalMutation>();
ConditionalMutation cm0=new ConditionalMutation("99006",new Condition("tx","seq").setVisibility(cvaob));
cm0.put("name+","last",cvaob,"doe");
cm0.put("name","first",cvaob,"john");
cm0.put("tx","seq",cvaob,"1");
mutations.add(cm0);
ConditionalMutation cm1=new ConditionalMutation("59056",new Condition("tx","seq").setVisibility(cvaab));
cm1.put("name","last",cvaab,"doe");
cm1.put("name","first",cvaab,"jane");
cm1.put("tx","seq",cvaab,"1");
mutations.add(cm1);
ConditionalMutation cm2=new ConditionalMutation("19059",new Condition("tx","seq").setVisibility(cvaob));
cm2.put("name","last",cvaob,"doe");
cm2.put("name","first",cvaob,"jack");
cm2.put("tx","seq",cvaob,"1");
mutations.add(cm2);
ConditionalMutation cm3=new ConditionalMutation("90909",new Condition("tx","seq").setVisibility(cvaob).setValue("1"));
cm3.put("name","last",cvaob,"doe");
cm3.put("name","first",cvaob,"john");
cm3.put("tx","seq",cvaob,"2");
mutations.add(cm3);
ConditionalWriter cw=conn.createConditionalWriter(tableName,new ConditionalWriterConfig().setAuthorizations(new Authorizations("A")));
Iterator<Result> results=cw.write(mutations.iterator());
HashSet<String> rows=new HashSet<String>();
while (results.hasNext()) {
Result result=results.next();
String row=new String(result.getMutation().getRow());
if (row.equals("19059")) {
Assert.assertEquals(Status.ACCEPTED,result.getStatus());
}
 else if (row.equals("59056")) {
Assert.assertEquals(Status.INVISIBLE_VISIBILITY,result.getStatus());
}
 else if (row.equals("99006")) {
Assert.assertEquals(Status.VIOLATED,result.getStatus());
}
 else if (row.equals("90909")) {
Assert.assertEquals(Status.REJECTED,result.getStatus());
}
rows.add(row);
}
Assert.assertEquals(4,rows.size());
Scanner scanner=conn.createScanner(tableName,new Authorizations("A"));
scanner.fetchColumn(new Text("tx"),new Text("seq"));
Entry<Key,Value> entry=Iterables.getOnlyElement(scanner);
Assert.assertEquals("1",entry.getValue().toString());
cw.close();
}

</code></pre>

<br>
<pre class="type-9 type-13 type-11 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBatch() throws Exception {
  Connector conn=getConnector();
  String tableName=getUniqueNames(1)[0];
  conn.tableOperations().create(tableName);
  conn.securityOperations().changeUserAuthorizations(getAdminPrincipal(),new Authorizations("A","B"));
  ColumnVisibility cvab=new ColumnVisibility("A|B");
  ArrayList<ConditionalMutation> mutations=new ArrayList<ConditionalMutation>();
  ConditionalMutation cm0=new ConditionalMutation("99006",new Condition("tx","seq").setVisibility(cvab));
  cm0.put("name","last",cvab,"doe");
  cm0.put("name","first",cvab,"john");
  cm0.put("tx","seq",cvab,"1");
  mutations.add(cm0);
  ConditionalMutation cm1=new ConditionalMutation("59056",new Condition("tx","seq").setVisibility(cvab));
  cm1.put("name","last",cvab,"doe");
  cm1.put("name","first",cvab,"jane");
  cm1.put("tx","seq",cvab,"1");
  mutations.add(cm1);
  ConditionalMutation cm2=new ConditionalMutation("19059",new Condition("tx","seq").setVisibility(cvab));
  cm2.put("name","last",cvab,"doe");
  cm2.put("name","first",cvab,"jack");
  cm2.put("tx","seq",cvab,"1");
  mutations.add(cm2);
  ConditionalWriter cw=conn.createConditionalWriter(tableName,new ConditionalWriterConfig().setAuthorizations(new Authorizations("A")));
  Iterator<Result> results=cw.write(mutations.iterator());
  int count=0;
  while (results.hasNext()) {
    Result result=results.next();
    Assert.assertEquals(Status.ACCEPTED,result.getStatus());
    count++;
  }
  Assert.assertEquals(3,count);
  Scanner scanner=conn.createScanner(tableName,new Authorizations("A"));
  scanner.fetchColumn(new Text("tx"),new Text("seq"));
  for (  String row : new String[]{"99006","59056","19059"}) {
    scanner.setRange(new Range(row));
    Entry<Key,Value> entry=Iterables.getOnlyElement(scanner);
    Assert.assertEquals("1",entry.getValue().toString());
  }
  TreeSet<Text> splits=new TreeSet<Text>();
  splits.add(new Text("7"));
  splits.add(new Text("3"));
  conn.tableOperations().addSplits(tableName,splits);
  mutations.clear();
  ConditionalMutation cm3=new ConditionalMutation("99006",new Condition("tx","seq").setVisibility(cvab).setValue("1"));
  cm3.put("name","last",cvab,"Doe");
  cm3.put("tx","seq",cvab,"2");
  mutations.add(cm3);
  ConditionalMutation cm4=new ConditionalMutation("59056",new Condition("tx","seq").setVisibility(cvab));
  cm4.put("name","last",cvab,"Doe");
  cm4.put("tx","seq",cvab,"1");
  mutations.add(cm4);
  ConditionalMutation cm5=new ConditionalMutation("19059",new Condition("tx","seq").setVisibility(cvab).setValue("2"));
  cm5.put("name","last",cvab,"Doe");
  cm5.put("tx","seq",cvab,"3");
  mutations.add(cm5);
  results=cw.write(mutations.iterator());
  int accepted=0;
  int rejected=0;
  while (results.hasNext()) {
    Result result=results.next();
    if (new String(result.getMutation().getRow()).equals("99006")) {
      Assert.assertEquals(Status.ACCEPTED,result.getStatus());
      accepted++;
    }
 else {
      Assert.assertEquals(Status.REJECTED,result.getStatus());
      rejected++;
    }
  }
  Assert.assertEquals("Expected only one accepted conditional mutation",1,accepted);
  Assert.assertEquals("Expected two rejected conditional mutations",2,rejected);
  for (  String row : new String[]{"59056","19059"}) {
    scanner.setRange(new Range(row));
    Entry<Key,Value> entry=Iterables.getOnlyElement(scanner);
    Assert.assertEquals("1",entry.getValue().toString());
  }
  scanner.setRange(new Range("99006"));
  Entry<Key,Value> entry=Iterables.getOnlyElement(scanner);
  Assert.assertEquals("2",entry.getValue().toString());
  scanner.clearColumns();
  scanner.fetchColumn(new Text("name"),new Text("last"));
  entry=Iterables.getOnlyElement(scanner);
  Assert.assertEquals("Doe",entry.getValue().toString());
  cw.close();
}

</code></pre>

<br>
<pre class="type-9 type-11 type-8 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTimeout() throws Exception {
  Connector conn=getConnector();
  String table=getUniqueNames(1)[0];
  conn.tableOperations().create(table);
  ConditionalWriter cw=conn.createConditionalWriter(table,new ConditionalWriterConfig().setTimeout(3,TimeUnit.SECONDS));
  ConditionalMutation cm1=new ConditionalMutation("r1",new Condition("tx","seq"));
  cm1.put("tx","seq","1");
  cm1.put("data","x","a");
  Assert.assertEquals(cw.write(cm1).getStatus(),Status.ACCEPTED);
  IteratorSetting is=new IteratorSetting(5,SlowIterator.class);
  SlowIterator.setSeekSleepTime(is,5000);
  ConditionalMutation cm2=new ConditionalMutation("r1",new Condition("tx","seq").setValue("1").setIterators(is));
  cm2.put("tx","seq","2");
  cm2.put("data","x","b");
  Assert.assertEquals(cw.write(cm2).getStatus(),Status.UNKNOWN);
  Scanner scanner=conn.createScanner(table,Authorizations.EMPTY);
  for (  Entry<Key,Value> entry : scanner) {
    String cf=entry.getKey().getColumnFamilyData().toString();
    String cq=entry.getKey().getColumnQualifierData().toString();
    String val=entry.getValue().toString();
    if (cf.equals("tx") && cq.equals("seq"))     Assert.assertEquals("Unexpected value in tx:seq","1",val);
 else     if (cf.equals("data") && cq.equals("x"))     Assert.assertEquals("Unexpected value in data:x","a",val);
 else     Assert.fail("Saw unexpected column family and qualifier: " + entry);
  }
  ConditionalMutation cm3=new ConditionalMutation("r1",new Condition("tx","seq").setValue("1"));
  cm3.put("tx","seq","2");
  cm3.put("data","x","b");
  Assert.assertEquals(cw.write(cm3).getStatus(),Status.ACCEPTED);
  cw.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.CreateTableWithNewTableConfigIT </h4><pre class="type-9 type-11 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("deprecation") @Test public void addCustomPropAndChangeExisting() throws Exception {
  log.info("Starting addCustomPropAndChangeExisting");
  Map<String,String> properties=new HashMap<String,String>();
  String propertyName=Property.TABLE_SPLIT_THRESHOLD.getKey();
  String volume="10K";
  properties.put(propertyName,volume);
  String propertyName2="table.custom.testProp";
  String volume2="Test property";
  properties.put(propertyName2,volume2);
  Connector connector=getConnector();
  String tableName=getUniqueNames(2)[0];
  connector.tableOperations().create(tableName,new NewTableConfiguration().setProperties(properties));
  String tableNameOrig="originalWithTableName";
  connector.tableOperations().create(tableNameOrig,true);
  int countNew=numProperties(connector,tableName);
  int countOrig=compareProperties(connector,tableNameOrig,tableName,propertyName);
  for (  Entry<String,String> entry : connector.tableOperations().getProperties(tableName)) {
    if (entry.getKey().equals(Property.TABLE_SPLIT_THRESHOLD.getKey()))     Assert.assertTrue("TABLE_SPLIT_THRESHOLD has been changed",entry.getValue().equals("10K"));
    if (entry.getKey().equals("table.custom.testProp"))     Assert.assertTrue("table.custom.testProp has been changed",entry.getValue().equals("Test property"));
  }
  Assert.assertEquals("Extra properties using the new create method",countOrig + 1,countNew);
  Assert.assertTrue("Wrong TimeType",checkTimeType(connector,tableName,TimeType.MILLIS));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.ImportExportIT </h4><pre class="type-9 type-13 type-11 type-8 type-5 type-3 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExportImportThenScan() throws Exception {
  Connector conn=getConnector();
  String[] tableNames=getUniqueNames(2);
  String srcTable=tableNames[0], destTable=tableNames[1];
  conn.tableOperations().create(srcTable);
  BatchWriter bw=conn.createBatchWriter(srcTable,new BatchWriterConfig());
  for (int row=0; row < 1000; row++) {
    Mutation m=new Mutation(Integer.toString(row));
    for (int col=0; col < 100; col++) {
      m.put(Integer.toString(col),"",Integer.toString(col * 2));
    }
    bw.addMutation(m);
  }
  bw.close();
  conn.tableOperations().compact(srcTable,null,null,true,true);
  FileSystem fs=cluster.getFileSystem();
  Path tmp=cluster.getTemporaryPath();
  log.info("Using FileSystem: " + fs);
  Path baseDir=new Path(tmp,getClass().getName());
  if (fs.exists(baseDir)) {
    log.info("{} exists on filesystem, deleting",baseDir);
    assertTrue("Failed to deleted " + baseDir,fs.delete(baseDir,true));
  }
  log.info("Creating {}",baseDir);
  assertTrue("Failed to create " + baseDir,fs.mkdirs(baseDir));
  Path exportDir=new Path(baseDir,"export");
  Path importDir=new Path(baseDir,"import");
  for (  Path p : new Path[]{exportDir,importDir}) {
    assertTrue("Failed to create " + baseDir,fs.mkdirs(p));
  }
  log.info("Exporting table to {}",exportDir);
  log.info("Importing table from {}",importDir);
  conn.tableOperations().offline(srcTable,true);
  conn.tableOperations().exportTable(srcTable,exportDir.toString());
  Path distcp=new Path(exportDir,"distcp.txt");
  Assert.assertTrue("Distcp file doesn't exist",fs.exists(distcp));
  FSDataInputStream is=fs.open(distcp);
  BufferedReader reader=new BufferedReader(new InputStreamReader(is));
  String line;
  while (null != (line=reader.readLine())) {
    Path p=new Path(line.substring(5));
    Assert.assertTrue("File doesn't exist: " + p,fs.exists(p));
    Path dest=new Path(importDir,p.getName());
    Assert.assertFalse("Did not expect " + dest + " to exist",fs.exists(dest));
    FileUtil.copy(fs,p,fs,dest,false,fs.getConf());
  }
  reader.close();
  log.info("Import dir: {}",Arrays.toString(fs.listStatus(importDir)));
  conn.tableOperations().importTable(destTable,importDir.toString());
  final String tableId=conn.tableOperations().tableIdMap().get(destTable);
  Assert.assertNotNull(tableId);
  log.info("Imported into table with ID: {}",tableId);
  Scanner s=conn.createScanner(MetadataTable.NAME,Authorizations.EMPTY);
  s.setRange(MetadataSchema.TabletsSection.getRange(tableId));
  s.fetchColumnFamily(MetadataSchema.TabletsSection.DataFileColumnFamily.NAME);
  MetadataSchema.TabletsSection.ServerColumnFamily.DIRECTORY_COLUMN.fetch(s);
  for (  Entry<Key,Value> fileEntry : s) {
    Key k=fileEntry.getKey();
    String value=fileEntry.getValue().toString();
    if (k.getColumnFamily().equals(MetadataSchema.TabletsSection.DataFileColumnFamily.NAME)) {
      String fileUri=k.getColumnQualifier().toString();
      Assert.assertFalse("Imported files should have absolute URIs, not relative: " + fileUri,looksLikeRelativePath(fileUri));
    }
 else     if (k.getColumnFamily().equals(MetadataSchema.TabletsSection.ServerColumnFamily.NAME)) {
      Assert.assertFalse("Server directory should have absolute URI, not relative: " + value,looksLikeRelativePath(value));
    }
 else {
      Assert.fail("Got expected pair: " + k + "="+ fileEntry.getValue());
    }
  }
  conn.tableOperations().online(srcTable,true);
  verifyTableEquality(conn,srcTable,destTable);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.NamespacesIT </h4><pre class="type-13 type-11 type-8 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void verifyTableOperationsExceptions() throws Exception {
  String tableName=namespace + ".1";
  IteratorSetting setting=new IteratorSetting(200,VersioningIterator.class);
  Text a=new Text("a");
  Text z=new Text("z");
  TableOperations ops=c.tableOperations();
  assertFalse(ops.exists(tableName));
  int numRun=0;
  ACCUMULOEXCEPTIONS_NAMESPACENOTFOUND:   for (int i=0; ; ++i)   try {
switch (i) {
case 0:
      ops.create(tableName);
    fail();
  break;
case 1:
ops.create("a");
ops.clone("a",tableName,true,Collections.<String,String>emptyMap(),Collections.<String>emptySet());
fail();
break;
case 2:
ops.importTable(tableName,System.getProperty("user.dir") + "/target");
fail();
break;
default :
assertEquals(3,i);
assertEquals(3,numRun);
break ACCUMULOEXCEPTIONS_NAMESPACENOTFOUND;
}
}
 catch (Exception e) {
numRun++;
if (!(e instanceof AccumuloException) || !(e.getCause() instanceof NamespaceNotFoundException)) throw new Exception("Case " + i + " resulted in "+ e.getClass().getName(),e);
}
numRun=0;
ACCUMULOEXCEPTIONS_TABLENOTFOUND: for (int i=0; ; ++i) try {
switch (i) {
case 0:
ops.removeConstraint(tableName,0);
fail();
break;
case 1:
ops.removeProperty(tableName,"a");
fail();
break;
case 2:
ops.setProperty(tableName,"a","b");
fail();
break;
default :
assertEquals(3,i);
assertEquals(3,numRun);
break ACCUMULOEXCEPTIONS_TABLENOTFOUND;
}
}
 catch (Exception e) {
numRun++;
if (!(e instanceof AccumuloException) || !(e.getCause() instanceof TableNotFoundException) || !(e.getCause().getCause() instanceof NamespaceNotFoundException)) throw new Exception("Case " + i + " resulted in "+ e.getClass().getName(),e);
}
numRun=0;
TABLENOTFOUNDEXCEPTIONS: for (int i=0; ; ++i) try {
switch (i) {
case 0:
ops.addConstraint(tableName,NumericValueConstraint.class.getName());
fail();
break;
case 1:
ops.addSplits(tableName,new TreeSet<Text>());
fail();
break;
case 2:
ops.attachIterator(tableName,setting);
fail();
break;
case 3:
ops.cancelCompaction(tableName);
fail();
break;
case 4:
ops.checkIteratorConflicts(tableName,setting,EnumSet.allOf(IteratorScope.class));
fail();
break;
case 5:
ops.clearLocatorCache(tableName);
fail();
break;
case 6:
ops.clone(tableName,"2",true,Collections.<String,String>emptyMap(),Collections.<String>emptySet());
fail();
break;
case 7:
ops.compact(tableName,a,z,true,true);
fail();
break;
case 8:
ops.delete(tableName);
fail();
break;
case 9:
ops.deleteRows(tableName,a,z);
fail();
break;
case 10:
ops.splitRangeByTablets(tableName,new Range(),10);
fail();
break;
case 11:
ops.exportTable(tableName,namespace + "_dir");
fail();
break;
case 12:
ops.flush(tableName,a,z,true);
fail();
break;
case 13:
ops.getDiskUsage(Collections.singleton(tableName));
fail();
break;
case 14:
ops.getIteratorSetting(tableName,"a",IteratorScope.scan);
fail();
break;
case 15:
ops.getLocalityGroups(tableName);
fail();
break;
case 16:
ops.getMaxRow(tableName,Authorizations.EMPTY,a,true,z,true);
fail();
break;
case 17:
ops.getProperties(tableName);
fail();
break;
case 18:
ops.importDirectory(tableName,"","",false);
fail();
break;
case 19:
ops.testClassLoad(tableName,VersioningIterator.class.getName(),SortedKeyValueIterator.class.getName());
fail();
break;
case 20:
ops.listConstraints(tableName);
fail();
break;
case 21:
ops.listIterators(tableName);
fail();
break;
case 22:
ops.listSplits(tableName);
fail();
break;
case 23:
ops.merge(tableName,a,z);
fail();
break;
case 24:
ops.offline(tableName,true);
fail();
break;
case 25:
ops.online(tableName,true);
fail();
break;
case 26:
ops.removeIterator(tableName,"a",EnumSet.of(IteratorScope.scan));
fail();
break;
case 27:
ops.rename(tableName,tableName + "2");
fail();
break;
case 28:
ops.setLocalityGroups(tableName,Collections.<String,Set<Text>>emptyMap());
fail();
break;
default :
assertEquals(29,i);
assertEquals(29,numRun);
break TABLENOTFOUNDEXCEPTIONS;
}
}
 catch (Exception e) {
numRun++;
if (!(e instanceof TableNotFoundException) || !(e.getCause() instanceof NamespaceNotFoundException)) throw new Exception("Case " + i + " resulted in "+ e.getClass().getName(),e);
}
}

</code></pre>

<br>
<pre class="type-13 type-11 type-8 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void verifyNamespaceOperationsExceptions() throws Exception {
  IteratorSetting setting=new IteratorSetting(200,VersioningIterator.class);
  NamespaceOperations ops=c.namespaceOperations();
  assertFalse(ops.exists(namespace));
  int numRun=0;
  NAMESPACENOTFOUND:   for (int i=0; ; ++i)   try {
switch (i) {
case 0:
      ops.addConstraint(namespace,NumericValueConstraint.class.getName());
    fail();
  break;
case 1:
ops.attachIterator(namespace,setting);
fail();
break;
case 2:
ops.checkIteratorConflicts(namespace,setting,EnumSet.of(IteratorScope.scan));
fail();
break;
case 3:
ops.delete(namespace);
fail();
break;
case 4:
ops.getIteratorSetting(namespace,"thing",IteratorScope.scan);
fail();
break;
case 5:
ops.getProperties(namespace);
fail();
break;
case 6:
ops.listConstraints(namespace);
fail();
break;
case 7:
ops.listIterators(namespace);
fail();
break;
case 8:
ops.removeConstraint(namespace,1);
fail();
break;
case 9:
ops.removeIterator(namespace,"thing",EnumSet.allOf(IteratorScope.class));
fail();
break;
case 10:
ops.removeProperty(namespace,"a");
fail();
break;
case 11:
ops.rename(namespace,namespace + "2");
fail();
break;
case 12:
ops.setProperty(namespace,"k","v");
fail();
break;
case 13:
ops.testClassLoad(namespace,VersioningIterator.class.getName(),SortedKeyValueIterator.class.getName());
fail();
break;
default :
assertEquals(14,i);
assertEquals(14,numRun);
break NAMESPACENOTFOUND;
}
}
 catch (Exception e) {
numRun++;
if (!(e instanceof NamespaceNotFoundException)) throw new Exception("Case " + i + " resulted in "+ e.getClass().getName(),e);
}
numRun=0;
NAMESPACEEXISTS: for (int i=0; ; ++i) try {
switch (i) {
case 0:
ops.create(namespace + "0");
ops.create(namespace + "0");
fail();
break;
case 1:
ops.create(namespace + i + "_1");
ops.create(namespace + i + "_2");
ops.rename(namespace + i + "_1",namespace + i + "_2");
fail();
break;
case 2:
ops.create(Namespaces.DEFAULT_NAMESPACE);
fail();
break;
case 3:
ops.create(Namespaces.ACCUMULO_NAMESPACE);
fail();
break;
case 4:
ops.create(namespace + i + "_1");
ops.rename(namespace + i + "_1",Namespaces.DEFAULT_NAMESPACE);
fail();
break;
case 5:
ops.create(namespace + i + "_1");
ops.rename(namespace + i + "_1",Namespaces.ACCUMULO_NAMESPACE);
fail();
break;
default :
assertEquals(6,i);
assertEquals(6,numRun);
break NAMESPACEEXISTS;
}
}
 catch (Exception e) {
numRun++;
if (!(e instanceof NamespaceExistsException)) throw new Exception("Case " + i + " resulted in "+ e.getClass().getName(),e);
}
}

</code></pre>

<br>
<pre class="type-9 type-11 type-8 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests new Namespace permissions as well as modifications to Table permissions because of namespaces. Checks each permission to first make sure the user
 * doesn't have permission to perform the action, then root grants them the permission and we check to make sure they could perform the action.
 */
@Test public void testPermissions() throws Exception {
  ClusterUser user1=getUser(0), user2=getUser(1), root=getAdminUser();
  String u1=user1.getPrincipal();
  String u2=user2.getPrincipal();
  PasswordToken pass=(null != user1.getPassword() ? new PasswordToken(user1.getPassword()) : null);
  String n1=namespace;
  String t1=n1 + ".1";
  String t2=n1 + ".2";
  String t3=n1 + ".3";
  String n2=namespace + "_2";
  loginAs(root);
  c.namespaceOperations().create(n1);
  c.tableOperations().create(t1);
  c.securityOperations().createLocalUser(u1,pass);
  loginAs(user1);
  Connector user1Con=c.getInstance().getConnector(u1,user1.getToken());
  try {
    user1Con.tableOperations().create(t2);
    fail();
  }
 catch (  AccumuloSecurityException e) {
    expectPermissionDenied(e);
  }
  loginAs(root);
  c.securityOperations().grantNamespacePermission(u1,n1,NamespacePermission.CREATE_TABLE);
  loginAs(user1);
  user1Con.tableOperations().create(t2);
  loginAs(root);
  assertTrue(c.tableOperations().list().contains(t2));
  c.securityOperations().revokeNamespacePermission(u1,n1,NamespacePermission.CREATE_TABLE);
  loginAs(user1);
  try {
    user1Con.tableOperations().delete(t1);
    fail();
  }
 catch (  AccumuloSecurityException e) {
    expectPermissionDenied(e);
  }
  loginAs(root);
  c.securityOperations().grantNamespacePermission(u1,n1,NamespacePermission.DROP_TABLE);
  loginAs(user1);
  user1Con.tableOperations().delete(t1);
  loginAs(root);
  assertTrue(!c.tableOperations().list().contains(t1));
  c.securityOperations().revokeNamespacePermission(u1,n1,NamespacePermission.DROP_TABLE);
  c.tableOperations().create(t3);
  BatchWriter bw=c.createBatchWriter(t3,null);
  Mutation m=new Mutation("row");
  m.put("cf","cq","value");
  bw.addMutation(m);
  bw.close();
  loginAs(user1);
  Iterator<Entry<Key,Value>> i=user1Con.createScanner(t3,new Authorizations()).iterator();
  try {
    i.next();
    fail();
  }
 catch (  RuntimeException e) {
    assertEquals(AccumuloSecurityException.class.getName(),e.getCause().getClass().getName());
    expectPermissionDenied((AccumuloSecurityException)e.getCause());
  }
  loginAs(user1);
  m=new Mutation(u1);
  m.put("cf","cq","turtles");
  bw=user1Con.createBatchWriter(t3,null);
  try {
    bw.addMutation(m);
    bw.close();
    fail();
  }
 catch (  MutationsRejectedException e) {
    assertEquals(1,e.getSecurityErrorCodes().size());
    assertEquals(1,e.getSecurityErrorCodes().entrySet().iterator().next().getValue().size());
switch (e.getSecurityErrorCodes().entrySet().iterator().next().getValue().iterator().next()) {
case PERMISSION_DENIED:
      break;
default :
    fail();
}
}
loginAs(root);
c.securityOperations().grantNamespacePermission(u1,n1,NamespacePermission.READ);
loginAs(user1);
i=user1Con.createScanner(t3,new Authorizations()).iterator();
assertTrue(i.hasNext());
loginAs(root);
c.securityOperations().revokeNamespacePermission(u1,n1,NamespacePermission.READ);
c.securityOperations().grantNamespacePermission(u1,n1,NamespacePermission.WRITE);
loginAs(user1);
m=new Mutation(u1);
m.put("cf","cq","turtles");
bw=user1Con.createBatchWriter(t3,null);
bw.addMutation(m);
bw.close();
loginAs(root);
c.securityOperations().revokeNamespacePermission(u1,n1,NamespacePermission.WRITE);
loginAs(user1);
try {
user1Con.tableOperations().setProperty(t3,Property.TABLE_FILE_MAX.getKey(),"42");
fail();
}
 catch (AccumuloSecurityException e) {
expectPermissionDenied(e);
}
loginAs(root);
c.securityOperations().grantNamespacePermission(u1,n1,NamespacePermission.ALTER_TABLE);
loginAs(user1);
user1Con.tableOperations().setProperty(t3,Property.TABLE_FILE_MAX.getKey(),"42");
user1Con.tableOperations().removeProperty(t3,Property.TABLE_FILE_MAX.getKey());
loginAs(root);
c.securityOperations().revokeNamespacePermission(u1,n1,NamespacePermission.ALTER_TABLE);
loginAs(user1);
try {
user1Con.namespaceOperations().setProperty(n1,Property.TABLE_FILE_MAX.getKey(),"55");
fail();
}
 catch (AccumuloSecurityException e) {
expectPermissionDenied(e);
}
loginAs(root);
c.securityOperations().grantNamespacePermission(u1,n1,NamespacePermission.ALTER_NAMESPACE);
loginAs(user1);
user1Con.namespaceOperations().setProperty(n1,Property.TABLE_FILE_MAX.getKey(),"42");
user1Con.namespaceOperations().removeProperty(n1,Property.TABLE_FILE_MAX.getKey());
loginAs(root);
c.securityOperations().revokeNamespacePermission(u1,n1,NamespacePermission.ALTER_NAMESPACE);
loginAs(root);
c.securityOperations().createLocalUser(u2,(root.getPassword() == null ? null : new PasswordToken(user2.getPassword())));
loginAs(user1);
try {
user1Con.securityOperations().grantNamespacePermission(u2,n1,NamespacePermission.ALTER_NAMESPACE);
fail();
}
 catch (AccumuloSecurityException e) {
expectPermissionDenied(e);
}
loginAs(root);
c.securityOperations().grantNamespacePermission(u1,n1,NamespacePermission.GRANT);
loginAs(user1);
user1Con.securityOperations().grantNamespacePermission(u2,n1,NamespacePermission.ALTER_NAMESPACE);
user1Con.securityOperations().revokeNamespacePermission(u2,n1,NamespacePermission.ALTER_NAMESPACE);
loginAs(root);
c.securityOperations().revokeNamespacePermission(u1,n1,NamespacePermission.GRANT);
loginAs(user1);
try {
user1Con.namespaceOperations().create(n2);
fail();
}
 catch (AccumuloSecurityException e) {
expectPermissionDenied(e);
}
loginAs(root);
c.securityOperations().grantSystemPermission(u1,SystemPermission.CREATE_NAMESPACE);
loginAs(user1);
user1Con.namespaceOperations().create(n2);
loginAs(root);
c.securityOperations().revokeSystemPermission(u1,SystemPermission.CREATE_NAMESPACE);
c.securityOperations().revokeNamespacePermission(u1,n2,NamespacePermission.DROP_NAMESPACE);
loginAs(user1);
try {
user1Con.namespaceOperations().delete(n2);
fail();
}
 catch (AccumuloSecurityException e) {
expectPermissionDenied(e);
}
loginAs(root);
c.securityOperations().grantSystemPermission(u1,SystemPermission.DROP_NAMESPACE);
loginAs(user1);
user1Con.namespaceOperations().delete(n2);
loginAs(root);
c.securityOperations().revokeSystemPermission(u1,SystemPermission.DROP_NAMESPACE);
loginAs(user1);
try {
user1Con.namespaceOperations().setProperty(n1,Property.TABLE_FILE_MAX.getKey(),"33");
fail();
}
 catch (AccumuloSecurityException e) {
expectPermissionDenied(e);
}
loginAs(root);
c.securityOperations().grantSystemPermission(u1,SystemPermission.ALTER_NAMESPACE);
loginAs(user1);
user1Con.namespaceOperations().setProperty(n1,Property.TABLE_FILE_MAX.getKey(),"33");
user1Con.namespaceOperations().removeProperty(n1,Property.TABLE_FILE_MAX.getKey());
loginAs(root);
c.securityOperations().revokeSystemPermission(u1,SystemPermission.ALTER_NAMESPACE);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.ShellConfigIT </h4><pre class="type-11 type-8 type-5 type-3 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void experimentalPropTest() throws Exception {
  AuthenticationToken token=getAdminToken();
  File clientConfFile=null;
switch (getClusterType()) {
case MINI:
    MiniAccumuloClusterImpl mac=(MiniAccumuloClusterImpl)getCluster();
  clientConfFile=mac.getConfig().getClientConfFile();
break;
case STANDALONE:
StandaloneAccumuloClusterConfiguration standaloneConf=(StandaloneAccumuloClusterConfiguration)getClusterConfiguration();
clientConfFile=standaloneConf.getClientConfFile();
break;
default :
Assert.fail("Unknown cluster type");
}
Assert.assertNotNull(clientConfFile);
TestShell ts=null;
if (token instanceof PasswordToken) {
String passwd=new String(((PasswordToken)token).getPassword(),UTF_8);
ts=new TestShell(getAdminPrincipal(),passwd,getCluster().getInstanceName(),getCluster().getZooKeepers(),clientConfFile);
}
 else if (token instanceof KerberosToken) {
ts=new TestShell(getAdminPrincipal(),null,getCluster().getInstanceName(),getCluster().getZooKeepers(),clientConfFile);
}
 else {
Assert.fail("Unknown token type");
}
assertTrue(Property.TABLE_VOLUME_CHOOSER.isExperimental());
assertTrue(Property.CRYPTO_CIPHER_ALGORITHM_NAME.isExperimental());
String configOutput=ts.exec("config");
assertTrue(configOutput.contains(Property.TABLE_VOLUME_CHOOSER.getKey()));
assertFalse(configOutput.contains(Property.CRYPTO_CIPHER_ALGORITHM_NAME.getKey()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.ShellServerIT </h4><pre class="type-9 type-11 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
"></span><br>
@Test public void whoami() throws Exception {
  AuthenticationToken token=getToken();
  assertTrue(ts.exec("whoami",true).contains(getPrincipal()));
  if (token instanceof PasswordToken) {
    ts.input.set("secret\nsecret\n");
  }
  ts.exec("createuser test_user");
  ts.exec("setauths -u test_user -s 12,3,4");
  String auths=ts.exec("getauths -u test_user");
  assertTrue(auths.contains("3") && auths.contains("12") && auths.contains("4"));
  if (token instanceof PasswordToken) {
    ts.input.set("secret\n");
    ts.exec("user test_user",true);
    assertTrue(ts.exec("whoami",true).contains("test_user"));
    ts.input.set(getRootPassword() + "\n");
    ts.exec("user root",true);
  }
}

</code></pre>

<br>
<pre class="type-9 type-11 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void deleterows() throws Exception {
  final String table=name.getMethodName();
  ts.exec("createtable " + table);
  final String tableId=getTableId(table);
  int base=countFiles(tableId);
  assertEquals(0,base);
  log.info("Adding 2 splits");
  ts.exec("addsplits row5 row7");
  log.info("Writing 10 records");
  make10();
  log.info("Flushing table");
  ts.exec("flush -w -t " + table);
  log.info("Table flush completed");
  List<String> files=getFiles(tableId);
  if (3 < files.size()) {
    log.info("More than 3 files were found, compacting before proceeding");
    ts.exec("compact -w -t " + table);
    files=getFiles(tableId);
    assertEquals("Expected to only find 3 files after compaction: " + files,3,files.size());
  }
  assertNotNull(files);
  assertEquals("Found the following files: " + files,3,files.size());
  ts.exec("deleterows -t " + table + " -b row5 -e row7");
  assertEquals(2,countFiles(tableId));
  ts.exec("deletetable -f " + table);
}

</code></pre>

<br>
<pre class="type-11 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
"></span><br>
@Test public void createTableWithProperties() throws Exception {
  final String table=name.getMethodName();
  String testProp="table.custom.description=description,table.custom.testProp=testProp," + Property.TABLE_SPLIT_THRESHOLD.getKey() + "=10K";
  ts.exec("createtable " + table + " -prop "+ testProp,true);
  ts.exec("insert a b c value",true);
  ts.exec("scan",true,"value",true);
  Connector connector=getConnector();
  for (  Entry<String,String> entry : connector.tableOperations().getProperties(table)) {
    if (entry.getKey().equals("table.custom.description"))     Assert.assertTrue("Initial property was not set correctly",entry.getValue().equals("description"));
    if (entry.getKey().equals("table.custom.testProp"))     Assert.assertTrue("Initial property was not set correctly",entry.getValue().equals("testProp"));
    if (entry.getKey().equals(Property.TABLE_SPLIT_THRESHOLD.getKey()))     Assert.assertTrue("Initial property was not set correctly",entry.getValue().equals("10K"));
  }
  ts.exec("deletetable -f " + table);
}

</code></pre>

<br>
<pre class="type-9 type-11 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void exporttableImporttable() throws Exception {
  final String table=name.getMethodName(), table2=table + "2";
  ts.exec("createtable " + table + " -evc",true);
  make10();
  ts.exec("addsplits row5",true);
  ts.exec("config -t " + table + " -s table.split.threshold=345M",true);
  ts.exec("offline " + table,true);
  File exportDir=new File(rootPath,"ShellServerIT.export");
  String exportUri="file://" + exportDir.toString();
  String localTmp="file://" + new File(rootPath,"ShellServerIT.tmp").toString();
  ts.exec("exporttable -t " + table + " "+ exportUri,true);
  DistCp cp=newDistCp(new Configuration(false));
  String import_="file://" + new File(rootPath,"ShellServerIT.import").toString();
  if (getCluster().getClientConfig().getBoolean(ClientProperty.INSTANCE_RPC_SASL_ENABLED.getKey(),false)) {
    FileSystem fs=getCluster().getFileSystem();
    FileSystem localFs=FileSystem.getLocal(new Configuration(false));
    Path localTmpPath=new Path(localTmp);
    localFs.mkdirs(localTmpPath);
    Path importDir=new Path(import_);
    fs.mkdirs(importDir);
    try (BufferedReader reader=new BufferedReader(new FileReader(new File(exportDir,"distcp.txt")))){
      for (String line; (line=reader.readLine()) != null; ) {
        Path exportedFile=new Path(line);
        log.info("Copying " + line + " to "+ localTmpPath);
        fs.copyToLocalFile(exportedFile,localTmpPath);
        Path tmpFile=new Path(localTmpPath,exportedFile.getName());
        log.info("Moving " + tmpFile + " to the import directory "+ importDir);
        fs.moveFromLocalFile(tmpFile,importDir);
      }
    }
   }
 else {
    String[] distCpArgs=new String[]{"-f",exportUri + "/distcp.txt",import_};
    assertEquals("Failed to run distcp: " + Arrays.toString(distCpArgs),0,cp.run(distCpArgs));
  }
  ts.exec("importtable " + table2 + " "+ import_,true);
  ts.exec("config -t " + table2 + " -np",true,"345M",true);
  ts.exec("getsplits -t " + table2,true,"row5",true);
  ts.exec("constraint --list -t " + table2,true,"VisibilityConstraint=2",true);
  ts.exec("online " + table,true);
  ts.exec("deletetable -f " + table,true);
  ts.exec("deletetable -f " + table2,true);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.TableConfigurationUpdateIT </h4><pre class="type-9 type-11 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test() throws Exception {
  Connector conn=getConnector();
  Instance inst=conn.getInstance();
  String table=getUniqueNames(1)[0];
  conn.tableOperations().create(table);
  final NamespaceConfiguration defaultConf=new NamespaceConfiguration(Namespaces.DEFAULT_NAMESPACE_ID,inst,AccumuloConfiguration.getDefaultConfiguration());
  int randomMax=4;
  int numThreads=2;
  int iterations=100000;
  AccumuloConfiguration tableConf=new TableConfiguration(inst,table,defaultConf);
  long start=System.currentTimeMillis();
  ExecutorService svc=Executors.newFixedThreadPool(numThreads);
  CountDownLatch countDown=new CountDownLatch(numThreads);
  ArrayList<Future<Exception>> futures=new ArrayList<Future<Exception>>(numThreads);
  for (int i=0; i < numThreads; i++) {
    futures.add(svc.submit(new TableConfRunner(randomMax,iterations,tableConf,countDown)));
  }
  svc.shutdown();
  Assert.assertTrue(svc.awaitTermination(60,TimeUnit.MINUTES));
  for (  Future<Exception> fut : futures) {
    Exception e=fut.get();
    if (null != e) {
      Assert.fail("Thread failed with exception " + e);
    }
  }
  long end=System.currentTimeMillis();
  log.debug(tableConf + " with " + iterations+ " iterations and "+ numThreads+ " threads and cache invalidates "+ ((1. / randomMax) * 100.)+ "% took "+ (end - start) / 1000 + " second(s)");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.TableOperationsIT </h4><pre class="type-11 type-8 type-5 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompactEmptyTableWithGeneratorIterator_Splits_Cancel() throws TableExistsException, AccumuloException, AccumuloSecurityException, TableNotFoundException {
  String tableName=getUniqueNames(1)[0];
  connector.tableOperations().create(tableName);
  SortedSet<Text> splitset=new TreeSet<>();
  splitset.add(new Text("f"));
  connector.tableOperations().addSplits(tableName,splitset);
  List<IteratorSetting> list=new ArrayList<>();
  list.add(new IteratorSetting(15,HardListIterator.class));
  connector.tableOperations().compact(tableName,null,null,list,true,false);
  connector.tableOperations().cancelCompaction(tableName);
  Scanner scanner=connector.createScanner(tableName,Authorizations.EMPTY);
  Map<Key,Value> actual=new TreeMap<>(COMPARE_KEY_TO_COLQ);
  for (  Map.Entry<Key,Value> entry : scanner)   actual.put(entry.getKey(),entry.getValue());
switch (actual.size()) {
case 3:
    assertTrue(HardListIterator.allEntriesToInject.equals(actual));
  break;
case 2:
assertEquals(HardListIterator.allEntriesToInject.headMap(new Key("f")),actual);
break;
case 1:
assertEquals(HardListIterator.allEntriesToInject.tailMap(new Key("f")),actual);
break;
case 0:
break;
default :
Assert.fail("Unexpected number of entries");
break;
}
connector.tableOperations().delete(tableName);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.TracerRecoversAfterOfflineTableIT </h4><pre class="type-9 type-13 type-11 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
"></span><br>
@Test public void test() throws Exception {
  Process tracer=null;
  Connector conn=getConnector();
  if (!conn.tableOperations().exists("trace")) {
    MiniAccumuloClusterImpl mac=cluster;
    tracer=mac.exec(TraceServer.class);
    while (!conn.tableOperations().exists("trace")) {
      sleepUninterruptibly(1,TimeUnit.SECONDS);
    }
    sleepUninterruptibly(5,TimeUnit.SECONDS);
  }
  log.info("Taking table offline");
  conn.tableOperations().offline("trace",true);
  String tableName=getUniqueNames(1)[0];
  conn.tableOperations().create(tableName);
  log.info("Start a distributed trace span");
  DistributedTrace.enable("localhost","testTrace",getClientConfig());
  Span root=Trace.on("traceTest");
  BatchWriter bw=conn.createBatchWriter(tableName,null);
  Mutation m=new Mutation("m");
  m.put("a","b","c");
  bw.addMutation(m);
  bw.close();
  root.stop();
  log.info("Bringing trace table back online");
  conn.tableOperations().online("trace",true);
  log.info("Trace table is online, should be able to find trace");
  final Scanner scanner=conn.createScanner("trace",Authorizations.EMPTY);
  scanner.setRange(new Range(new Text(Long.toHexString(root.traceId()))));
  while (true) {
    final StringBuilder finalBuffer=new StringBuilder();
    int traceCount=TraceDump.printTrace(scanner,new Printer(){
      @Override public void print(      final String line){
        try {
          finalBuffer.append(line).append("\n");
        }
 catch (        Exception ex) {
          throw new RuntimeException(ex);
        }
      }
    }
);
    String traceOutput=finalBuffer.toString();
    log.info("Trace output:" + traceOutput);
    if (traceCount > 0) {
      int lastPos=0;
      for (      String part : "traceTest,close,binMutations".split(",")) {
        log.info("Looking in trace output for '" + part + "'");
        int pos=traceOutput.indexOf(part);
        assertTrue("Did not find '" + part + "' in output",pos > 0);
        assertTrue("'" + part + "' occurred earlier than the previous element unexpectedly",pos > lastPos);
        lastPos=pos;
      }
      break;
    }
 else {
      log.info("Ignoring trace output as traceCount not greater than zero: " + traceCount);
      Thread.sleep(1000);
    }
  }
  if (tracer != null) {
    tracer.destroy();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.UserCompactionStrategyIT </h4><pre class="type-11 type-8 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConcurrent() throws Exception {
  Connector c=getConnector();
  String tableName=getUniqueNames(1)[0];
  c.tableOperations().create(tableName);
  writeRandomValue(c,tableName,1 << 16);
  writeRandomValue(c,tableName,1 << 16);
  c.tableOperations().compact(tableName,new CompactionConfig().setWait(false));
  c.tableOperations().compact(tableName,new CompactionConfig().setWait(true));
  Assert.assertEquals(1,FunctionalTestUtils.countRFiles(c,tableName));
  writeRandomValue(c,tableName,1 << 16);
  IteratorSetting iterConfig=new IteratorSetting(30,SlowIterator.class);
  SlowIterator.setSleepTime(iterConfig,1000);
  long t1=System.currentTimeMillis();
  c.tableOperations().compact(tableName,new CompactionConfig().setWait(false).setIterators(Arrays.asList(iterConfig)));
  try {
    c.tableOperations().compact(tableName,new CompactionConfig().setWait(true));
    if (System.currentTimeMillis() - t1 < 2000)     Assert.fail("Expected compaction to fail because another concurrent compaction set iterators");
  }
 catch (  AccumuloException e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.VerifySerialRecoveryIT </h4><pre class="type-11 type-5 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=4 * 60 * 1000) public void testSerializedRecovery() throws Exception {
  String tableName=getUniqueNames(1)[0];
  Connector c=getConnector();
  c.tableOperations().create(tableName);
  SortedSet<Text> splits=new TreeSet<Text>();
  for (int i=0; i < 200; i++) {
    splits.add(new Text(AssignmentThreadsIT.randomHex(8)));
  }
  c.tableOperations().addSplits(tableName,splits);
  BatchWriter bw=c.createBatchWriter(tableName,null);
  for (int i=0; i < 50000; i++) {
    Mutation m=new Mutation(AssignmentThreadsIT.randomHex(8));
    m.put("","","");
    bw.addMutation(m);
  }
  bw.close();
  for (  ProcessReference ref : getCluster().getProcesses().get(ServerType.TABLET_SERVER))   getCluster().killProcess(ServerType.TABLET_SERVER,ref);
  final Process ts=cluster.exec(TabletServer.class);
  Iterators.size(c.createScanner(tableName,Authorizations.EMPTY).iterator());
  assertEquals(0,cluster.exec(Admin.class,"stopAll").waitFor());
  ts.waitFor();
  String result=FunctionalTestUtils.readAll(cluster,TabletServer.class,ts);
  for (  String line : result.split("\n")) {
    System.out.println(line);
  }
  boolean started=false;
  int recoveries=0;
  for (  String line : result.split("\n")) {
    if (line.contains("!0") || line.contains("+r"))     continue;
    if (line.contains("Starting Write-Ahead Log")) {
      assertFalse(started);
      started=true;
      recoveries++;
    }
    if (line.contains("Write-Ahead Log recovery complete")) {
      assertTrue(started);
      started=false;
    }
  }
  assertFalse(started);
  assertTrue(recoveries > 0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.functional.BulkSplitOptimizationIT </h4><pre class="type-11 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testBulkSplitOptimization() throws Exception {
  final Connector c=getConnector();
  final String tableName=getUniqueNames(1)[0];
  c.tableOperations().create(tableName);
  c.tableOperations().setProperty(tableName,Property.TABLE_MAJC_RATIO.getKey(),"1000");
  c.tableOperations().setProperty(tableName,Property.TABLE_FILE_MAX.getKey(),"1000");
  c.tableOperations().setProperty(tableName,Property.TABLE_SPLIT_THRESHOLD.getKey(),"1G");
  FileSystem fs=cluster.getFileSystem();
  Path testDir=new Path(getUsableDir(),"testmf");
  FunctionalTestUtils.createRFiles(c,fs,testDir.toString(),ROWS,SPLITS,8);
  FileStatus[] stats=fs.listStatus(testDir);
  System.out.println("Number of generated files: " + stats.length);
  FunctionalTestUtils.bulkImport(c,fs,tableName,testDir.toString());
  FunctionalTestUtils.checkSplits(c,tableName,0,0);
  FunctionalTestUtils.checkRFiles(c,tableName,1,1,100,100);
  getConnector().tableOperations().setProperty(tableName,Property.TABLE_SPLIT_THRESHOLD.getKey(),"100K");
  sleepUninterruptibly(2,TimeUnit.SECONDS);
  while (getConnector().tableOperations().listSplits(tableName).size() < 75) {
    sleepUninterruptibly(500,TimeUnit.MILLISECONDS);
  }
  FunctionalTestUtils.checkSplits(c,tableName,50,100);
  VerifyIngest.Opts opts=new VerifyIngest.Opts();
  opts.timestamp=1;
  opts.dataSize=50;
  opts.random=56;
  opts.rows=100000;
  opts.startRow=0;
  opts.cols=1;
  opts.setTableName(tableName);
  AuthenticationToken adminToken=getAdminToken();
  if (adminToken instanceof PasswordToken) {
    PasswordToken token=(PasswordToken)getAdminToken();
    opts.setPassword(new Password(new String(token.getPassword(),UTF_8)));
    opts.setPrincipal(getAdminPrincipal());
  }
 else   if (adminToken instanceof KerberosToken) {
    ClientConfiguration clientConf=cluster.getClientConfig();
    opts.updateKerberosCredentials(clientConf);
  }
 else {
    Assert.fail("Unknown token type");
  }
  VerifyIngest.verifyIngest(c,opts,new ScannerOpts());
  FunctionalTestUtils.checkRFiles(c,tableName,50,100,1,4);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.functional.CleanUpIT </h4><pre class="type-11 type-8 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void run() throws Exception {
  String tableName=getUniqueNames(1)[0];
  getConnector().tableOperations().create(tableName);
  BatchWriter bw=getConnector().createBatchWriter(tableName,new BatchWriterConfig());
  Mutation m1=new Mutation("r1");
  m1.put("cf1","cq1",1,"5");
  bw.addMutation(m1);
  bw.flush();
  Scanner scanner=getConnector().createScanner(tableName,new Authorizations());
  int count=0;
  for (  Entry<Key,Value> entry : scanner) {
    count++;
    if (!entry.getValue().toString().equals("5")) {
      Assert.fail("Unexpected value " + entry.getValue());
    }
  }
  Assert.assertEquals("Unexpected count",1,count);
  int threadCount=countThreads();
  if (threadCount < 2) {
    printThreadNames();
    Assert.fail("Not seeing expected threads. Saw " + threadCount);
  }
  CleanUp.shutdownNow();
  Mutation m2=new Mutation("r2");
  m2.put("cf1","cq1",1,"6");
  try {
    bw.addMutation(m1);
    bw.flush();
    Assert.fail("batch writer did not fail");
  }
 catch (  Exception e) {
  }
  try {
    bw.close();
    Assert.fail("batch writer close not fail");
  }
 catch (  Exception e) {
  }
  try {
    count=0;
    Iterator<Entry<Key,Value>> iter=scanner.iterator();
    while (iter.hasNext()) {
      iter.next();
      count++;
    }
    Assert.fail("scanner did not fail");
  }
 catch (  Exception e) {
  }
  threadCount=countThreads();
  if (threadCount > 0) {
    printThreadNames();
    Assert.fail("Threads did not go away. Saw " + threadCount);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.functional.CloneTestIT </h4><pre class="type-9 type-11 type-5 type-3 type-21 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteClone() throws Exception {
  String[] tableNames=getUniqueNames(3);
  String table1=tableNames[0];
  String table2=tableNames[1];
  String table3=tableNames[2];
  Connector c=getConnector();
  AccumuloCluster cluster=getCluster();
  Assume.assumeTrue(cluster instanceof MiniAccumuloClusterImpl);
  MiniAccumuloClusterImpl mac=(MiniAccumuloClusterImpl)cluster;
  String rootPath=mac.getConfig().getDir().getAbsolutePath();
  c.tableOperations().create(table3);
  writeData(table3,c).close();
  c.tableOperations().flush(table3,null,null,true);
  FileSystem fs=getCluster().getFileSystem();
  String id=c.tableOperations().tableIdMap().get(table3);
  FileStatus[] status=fs.listStatus(new Path(rootPath + "/accumulo/tables/" + id));
  assertTrue(status.length > 0);
  List<DiskUsage> diskUsage=c.tableOperations().getDiskUsage(Collections.singleton(table3));
  assertEquals(1,diskUsage.size());
  assertTrue(diskUsage.get(0).getUsage() > 100);
  c.tableOperations().delete(table3);
  Path tablePath=new Path(rootPath + "/accumulo/tables/" + id);
  if (fs.exists(tablePath)) {
    status=fs.listStatus(tablePath);
    assertTrue(status == null || status.length == 0);
  }
  c.tableOperations().create(table1);
  BatchWriter bw=writeData(table1,c);
  Map<String,String> props=new HashMap<String,String>();
  props.put(Property.TABLE_FILE_COMPRESSED_BLOCK_SIZE.getKey(),"500K");
  Set<String> exclude=new HashSet<String>();
  exclude.add(Property.TABLE_FILE_MAX.getKey());
  c.tableOperations().clone(table1,table2,true,props,exclude);
  Mutation m3=new Mutation("009");
  m3.put("data","x","1");
  m3.put("data","y","2");
  bw.addMutation(m3);
  bw.close();
  c.tableOperations().delete(table1);
  checkData(table2,c);
  c.tableOperations().compact(table2,null,null,true,true);
  checkData(table2,c);
  c.tableOperations().delete(table2);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.functional.ExamplesIT </h4><pre class="type-4 type-11 type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Before public void getClusterInfo() throws Exception {
  c=getConnector();
  user=getAdminPrincipal();
  AuthenticationToken token=getAdminToken();
  if (token instanceof KerberosToken) {
    keytab=getAdminUser().getKeytab().getAbsolutePath();
    saslEnabled=true;
  }
 else   if (token instanceof PasswordToken) {
    passwd=new String(((PasswordToken)getAdminToken()).getPassword(),UTF_8);
    saslEnabled=false;
  }
 else {
    Assert.fail("Unknown token type: " + token);
  }
  fs=getCluster().getFileSystem();
  instance=c.getInstance().getInstanceName();
  keepers=c.getInstance().getZooKeepers();
  dir=new Path(cluster.getTemporaryPath(),getClass().getName()).toString();
  origAuths=c.securityOperations().getUserAuthorizations(user);
  c.securityOperations().changeUserAuthorizations(user,new Authorizations(auths.split(",")));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.functional.GarbageCollectorIT </h4><pre class="type-9 type-13 type-11 type-8 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testProperPortAdvertisement() throws Exception {
  Connector conn=getConnector();
  Instance instance=conn.getInstance();
  ZooReaderWriter zk=new ZooReaderWriter(cluster.getZooKeepers(),30000,OUR_SECRET);
  String path=ZooUtil.getRoot(instance) + Constants.ZGC_LOCK;
  for (int i=0; i < 5; i++) {
    List<String> locks;
    try {
      locks=zk.getChildren(path,null);
    }
 catch (    NoNodeException e) {
      Thread.sleep(5000);
      continue;
    }
    if (locks != null && locks.size() > 0) {
      Collections.sort(locks);
      String lockPath=path + "/" + locks.get(0);
      String gcLoc=new String(zk.getData(lockPath,null));
      Assert.assertTrue("Found unexpected data in zookeeper for GC location: " + gcLoc,gcLoc.startsWith(Service.GC_CLIENT.name()));
      int loc=gcLoc.indexOf(ServerServices.SEPARATOR_CHAR);
      Assert.assertNotEquals("Could not find split point of GC location for: " + gcLoc,-1,loc);
      String addr=gcLoc.substring(loc + 1);
      int addrSplit=addr.indexOf(':');
      Assert.assertNotEquals("Could not find split of GC host:port for: " + addr,-1,addrSplit);
      String host=addr.substring(0,addrSplit), port=addr.substring(addrSplit + 1);
      Assert.assertNotEquals("0.0.0.0",host);
      Assert.assertNotEquals(0,Integer.parseInt(port));
      return;
    }
    Thread.sleep(5000);
  }
  Assert.fail("Could not find advertised GC address");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.functional.ReadWriteIT </h4><pre class="type-9 type-11 type-5 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void multiTableTest() throws Exception {
  final String instance=cluster.getInstanceName();
  final String keepers=cluster.getZooKeepers();
  final ClusterControl control=cluster.getClusterControl();
  final String prefix=getClass().getSimpleName() + "_" + testName.getMethodName();
  ExecutorService svc=Executors.newFixedThreadPool(2);
  Future<Integer> p1=svc.submit(new Callable<Integer>(){
    @Override public Integer call(){
      try {
        ClientConfiguration clientConf=cluster.getClientConfig();
        if (clientConf.getBoolean(ClientProperty.INSTANCE_RPC_SASL_ENABLED.getKey(),false)) {
          String principal=getAdminPrincipal();
          AuthenticationToken token=getAdminToken();
          assertTrue("Expected KerberosToken, but was " + token.getClass(),token instanceof KerberosToken);
          KerberosToken kt=(KerberosToken)token;
          assertNotNull("Expected keytab in token",kt.getKeytab());
          return control.exec(TestMultiTableIngest.class,args("--count",Integer.toString(ROWS),"-i",instance,"-z",keepers,"--tablePrefix",prefix,"--keytab",kt.getKeytab().getAbsolutePath(),"-u",principal));
        }
        return control.exec(TestMultiTableIngest.class,args("--count",Integer.toString(ROWS),"-u",getAdminPrincipal(),"-i",instance,"-z",keepers,"-p",new String(((PasswordToken)getAdminToken()).getPassword(),UTF_8),"--tablePrefix",prefix));
      }
 catch (      IOException e) {
        log.error("Error running MultiTableIngest",e);
        return -1;
      }
    }
  }
);
  Future<Integer> p2=svc.submit(new Callable<Integer>(){
    @Override public Integer call(){
      try {
        ClientConfiguration clientConf=cluster.getClientConfig();
        if (clientConf.getBoolean(ClientProperty.INSTANCE_RPC_SASL_ENABLED.getKey(),false)) {
          String principal=getAdminPrincipal();
          AuthenticationToken token=getAdminToken();
          assertTrue("Expected KerberosToken, but was " + token.getClass(),token instanceof KerberosToken);
          KerberosToken kt=(KerberosToken)token;
          assertNotNull("Expected keytab in token",kt.getKeytab());
          return control.exec(TestMultiTableIngest.class,args("--count",Integer.toString(ROWS),"--readonly","-i",instance,"-z",keepers,"--tablePrefix",prefix,"--keytab",kt.getKeytab().getAbsolutePath(),"-u",principal));
        }
        return control.exec(TestMultiTableIngest.class,args("--count",Integer.toString(ROWS),"--readonly","-u",getAdminPrincipal(),"-i",instance,"-z",keepers,"-p",new String(((PasswordToken)getAdminToken()).getPassword(),UTF_8),"--tablePrefix",prefix));
      }
 catch (      IOException e) {
        log.error("Error running MultiTableIngest",e);
        return -1;
      }
    }
  }
);
  svc.shutdown();
  while (!svc.isTerminated()) {
    svc.awaitTermination(15,TimeUnit.SECONDS);
  }
  assertEquals(0,p1.get().intValue());
  assertEquals(0,p2.get().intValue());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.functional.SessionBlockVerifyIT </h4><pre class="type-11 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void run() throws Exception {
  Connector c=getConnector();
  String tableName=getUniqueNames(1)[0];
  c.tableOperations().create(tableName);
  BatchWriter bw=c.createBatchWriter(tableName,new BatchWriterConfig());
  for (int i=0; i < 1000; i++) {
    Mutation m=new Mutation(new Text(String.format("%08d",i)));
    for (int j=0; j < 3; j++)     m.put(new Text("cf1"),new Text("cq" + j),new Value((i + "_" + j).getBytes(UTF_8)));
    bw.addMutation(m);
  }
  bw.close();
  Scanner scanner=c.createScanner(tableName,new Authorizations());
  scanner.setReadaheadThreshold(20000);
  scanner.setRange(new Range(String.format("%08d",0),String.format("%08d",1000)));
  IteratorSetting setting=new IteratorSetting(21,SlowIterator.class);
  SlowIterator.setSeekSleepTime(setting,Long.MAX_VALUE);
  SlowIterator.setSleepTime(setting,Long.MAX_VALUE);
  scanner.addScanIterator(setting);
  final Iterator<Entry<Key,Value>> slow=scanner.iterator();
  final List<Future<Boolean>> callables=new ArrayList<Future<Boolean>>();
  final CountDownLatch latch=new CountDownLatch(10);
  for (int i=0; i < 10; i++) {
    Future<Boolean> callable=service.submit(new Callable<Boolean>(){
      public Boolean call(){
        latch.countDown();
        while (slow.hasNext()) {
          slow.next();
        }
        return slow.hasNext();
      }
    }
);
    callables.add(callable);
  }
  latch.await();
  log.info("Starting SessionBlockVerifyIT");
  for (int i=0; i < 2; i++) {
    Scanner scanner2=c.createScanner(tableName,new Authorizations());
    scanner2.setRange(new Range(String.format("%08d",0),String.format("%08d",1000)));
    scanner2.setBatchSize(1);
    Iterator<Entry<Key,Value>> iter=scanner2.iterator();
    verify(iter,0,1000);
  }
  int sessionsFound=0;
  String tserver=Iterables.getOnlyElement(c.instanceOperations().getTabletServers());
  final List<ActiveScan> scans=c.instanceOperations().getActiveScans(tserver);
  for (  ActiveScan scan : scans) {
    if (tableName.equals(scan.getTable()) && scan.getSsiList().size() > 0) {
      assertEquals("Not the expected iterator",1,scan.getSsiList().size());
      assertTrue("Not the expected iterator",scan.getSsiList().iterator().next().contains("SlowIterator"));
      sessionsFound++;
    }
  }
  assertEquals("Must have ten sessions. Failure indicates a synchronization block within the sweep mechanism",10,sessionsFound);
  for (  Future<Boolean> callable : callables) {
    callable.cancel(true);
  }
  service.shutdown();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.proxy.SimpleProxyBase </h4><pre class="type-11 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void userAuthentication() throws Exception {
  if (isKerberosEnabled()) {
    assertTrue(client.authenticateUser(creds,clientPrincipal,Collections.<String,String>emptyMap()));
  }
 else {
    assertTrue(client.authenticateUser(creds,"root",s2pp(SharedMiniClusterBase.getRootPassword())));
    assertFalse(client.authenticateUser(creds,"root",s2pp("")));
  }
}

</code></pre>

<br>
<pre class="type-11 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testBatchWriter() throws Exception {
  client.addConstraint(creds,table,NumericValueConstraint.class.getName());
  sleepUninterruptibly(ZOOKEEPER_PROPAGATION_TIME,TimeUnit.MILLISECONDS);
  WriterOptions writerOptions=new WriterOptions();
  writerOptions.setLatencyMs(10000);
  writerOptions.setMaxMemory(2);
  writerOptions.setThreads(1);
  writerOptions.setTimeoutMs(100000);
  Map<String,Integer> constraints=client.listConstraints(creds,table);
  while (!constraints.containsKey(NumericValueConstraint.class.getName())) {
    log.info("Constraints don't contain NumericValueConstraint");
    Thread.sleep(2000);
    constraints=client.listConstraints(creds,table);
  }
  boolean success=false;
  for (int i=0; i < 15; i++) {
    String batchWriter=client.createWriter(creds,table,writerOptions);
    client.update(batchWriter,mutation("row1","cf","cq","x"));
    client.update(batchWriter,mutation("row1","cf","cq","x"));
    try {
      client.flush(batchWriter);
      log.debug("Constraint failed to fire. Waiting and retrying");
      Thread.sleep(5000);
      continue;
    }
 catch (    MutationsRejectedException ex) {
    }
    try {
      client.closeWriter(batchWriter);
      log.debug("Constraint failed to fire. Waiting and retrying");
      Thread.sleep(5000);
      continue;
    }
 catch (    MutationsRejectedException e) {
    }
    success=true;
    break;
  }
  if (!success) {
    fail("constraint did not fire");
  }
  client.removeConstraint(creds,table,2);
  constraints=client.listConstraints(creds,table);
  while (constraints.containsKey(NumericValueConstraint.class.getName())) {
    log.info("Constraints still contains NumericValueConstraint");
    Thread.sleep(2000);
    constraints=client.listConstraints(creds,table);
  }
  assertScan(new String[][]{},table);
  sleepUninterruptibly(ZOOKEEPER_PROPAGATION_TIME,TimeUnit.MILLISECONDS);
  writerOptions=new WriterOptions();
  writerOptions.setLatencyMs(10000);
  writerOptions.setMaxMemory(3000);
  writerOptions.setThreads(1);
  writerOptions.setTimeoutMs(100000);
  success=false;
  for (int i=0; i < 15; i++) {
    try {
      String batchWriter=client.createWriter(creds,table,writerOptions);
      client.update(batchWriter,mutation("row1","cf","cq","x"));
      client.flush(batchWriter);
      client.closeWriter(batchWriter);
      success=true;
      break;
    }
 catch (    MutationsRejectedException e) {
      log.info("Mutations were rejected, assuming constraint is still active",e);
      Thread.sleep(5000);
    }
  }
  if (!success) {
    fail("Failed to successfully write data after constraint was removed");
  }
  assertScan(new String[][]{{"row1","cf","cq","x"}},table);
  client.deleteTable(creds,table);
}

</code></pre>

<br>
<pre class="type-9 type-11 type-8 type-5 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void attachIteratorWithCompactions() throws Exception {
  if (client.tableExists(creds,"slow")) {
    client.deleteTable(creds,"slow");
  }
  client.createTable(creds,"slow",true,TimeType.MILLIS);
  IteratorSetting setting=new IteratorSetting(100,"slow",SlowIterator.class.getName(),Collections.singletonMap("sleepTime","250"));
  client.attachIterator(creds,"slow",setting,EnumSet.allOf(IteratorScope.class));
  for (int i=0; i < 40; i++) {
    client.updateAndFlush(creds,"slow",mutation("row" + i,"cf","cq","value"));
  }
  Map<String,String> map=client.tableIdMap(creds);
  Thread t=new Thread(){
    @Override public void run(){
      TestProxyClient proxyClient2=null;
      try {
        if (isKerberosEnabled()) {
          UserGroupInformation.loginUserFromKeytab(clientPrincipal,clientKeytab.getAbsolutePath());
          proxyClient2=new TestProxyClient(hostname,proxyPort,factory,proxyPrimary,UserGroupInformation.getCurrentUser());
        }
 else {
          proxyClient2=new TestProxyClient(hostname,proxyPort,factory);
        }
        Client client2=proxyClient2.proxy();
        client2.compactTable(creds,"slow",null,null,null,true,true,null);
      }
 catch (      Exception e) {
        throw new RuntimeException(e);
      }
 finally {
        if (null != proxyClient2) {
          proxyClient2.close();
        }
      }
    }
  }
;
  t.start();
  final String desiredTableId=map.get("slow");
  assertNotNull(desiredTableId);
  List<ActiveCompaction> compactions=new ArrayList<ActiveCompaction>();
  for (int i=0; i < 100 && compactions.isEmpty(); i++) {
    for (    String tserver : client.getTabletServers(creds)) {
      List<ActiveCompaction> compactionsOnServer=client.getActiveCompactions(creds,tserver);
      for (      ActiveCompaction compact : compactionsOnServer) {
        if (desiredTableId.equals(compact.getExtent().tableId)) {
          compactions.add(compact);
        }
      }
      if (!compactions.isEmpty())       break;
    }
    sleepUninterruptibly(10,TimeUnit.MILLISECONDS);
  }
  t.join();
  assertFalse(compactions.isEmpty());
  for (  ActiveCompaction c : compactions) {
    if (desiredTableId.equals(c.getExtent().tableId)) {
      assertTrue(c.inputFiles.isEmpty());
      assertEquals(CompactionType.MINOR,c.getType());
      assertEquals(CompactionReason.USER,c.getReason());
      assertEquals("",c.localityGroup);
      assertTrue(c.outputFile.contains("default_tablet"));
      return;
    }
  }
  fail("Expection to find running compaction for table 'slow' but did not find one");
}

</code></pre>

<br>
<pre class="type-9 type-11 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void userManagement() throws Exception {
  String user;
  ClusterUser otherClient=null;
  ByteBuffer password=s2bb("password");
  if (isKerberosEnabled()) {
    otherClient=getKdc().getClientPrincipal(1);
    user=otherClient.getPrincipal();
  }
 else {
    user=getUniqueNames(1)[0];
  }
  client.createLocalUser(creds,user,password);
  Set<String> users=client.listLocalUsers(creds);
  Set<String> expectedUsers=new HashSet<String>(Arrays.asList(clientPrincipal,user));
  assertTrue("Did not find all expected users: " + expectedUsers,users.containsAll(expectedUsers));
  HashSet<ByteBuffer> auths=new HashSet<ByteBuffer>(Arrays.asList(s2bb("A"),s2bb("B")));
  client.changeUserAuthorizations(creds,user,auths);
  List<ByteBuffer> update=client.getUserAuthorizations(creds,user);
  assertEquals(auths,new HashSet<ByteBuffer>(update));
  if (!isKerberosEnabled()) {
    password=s2bb("");
    client.changeLocalUserPassword(creds,user,password);
    assertTrue(client.authenticateUser(creds,user,s2pp(ByteBufferUtil.toString(password))));
  }
  if (isKerberosEnabled()) {
    UserGroupInformation.loginUserFromKeytab(otherClient.getPrincipal(),otherClient.getKeytab().getAbsolutePath());
    final UserGroupInformation ugi=UserGroupInformation.getCurrentUser();
    TestProxyClient otherProxyClient=null;
    try {
      otherProxyClient=new TestProxyClient(hostname,proxyPort,factory,proxyPrimary,ugi);
      otherProxyClient.proxy().login(user,Collections.<String,String>emptyMap());
    }
  finally {
      if (null != otherProxyClient) {
        otherProxyClient.close();
      }
    }
  }
 else {
    client.login(user,s2pp(ByteBufferUtil.toString(password)));
  }
}

</code></pre>

<br>
<pre class="type-9 type-13 type-11 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void attachIteratorsWithScans() throws Exception {
  if (client.tableExists(creds,"slow")) {
    client.deleteTable(creds,"slow");
  }
  client.createTable(creds,"slow",true,TimeType.MILLIS);
  IteratorSetting setting=new IteratorSetting(100,"slow",SlowIterator.class.getName(),Collections.singletonMap("sleepTime","250"));
  client.attachIterator(creds,"slow",setting,EnumSet.allOf(IteratorScope.class));
  for (int i=0; i < 40; i++) {
    client.updateAndFlush(creds,"slow",mutation("row" + i,"cf","cq","value"));
  }
  Thread t=new Thread(){
    @Override public void run(){
      String scanner;
      TestProxyClient proxyClient2=null;
      try {
        if (isKerberosEnabled()) {
          UserGroupInformation.loginUserFromKeytab(clientPrincipal,clientKeytab.getAbsolutePath());
          proxyClient2=new TestProxyClient(hostname,proxyPort,factory,proxyPrimary,UserGroupInformation.getCurrentUser());
        }
 else {
          proxyClient2=new TestProxyClient(hostname,proxyPort,factory);
        }
        Client client2=proxyClient2.proxy();
        scanner=client2.createScanner(creds,"slow",null);
        client2.nextK(scanner,10);
        client2.closeScanner(scanner);
      }
 catch (      Exception e) {
        throw new RuntimeException(e);
      }
 finally {
        if (null != proxyClient2) {
          proxyClient2.close();
        }
      }
    }
  }
;
  t.start();
  List<ActiveScan> scans=new ArrayList<ActiveScan>();
  for (int i=0; i < 100 && scans.isEmpty(); i++) {
    for (    String tserver : client.getTabletServers(creds)) {
      List<ActiveScan> scansForServer=client.getActiveScans(creds,tserver);
      for (      ActiveScan scan : scansForServer) {
        if (clientPrincipal.equals(scan.getUser())) {
          scans.add(scan);
        }
      }
      if (!scans.isEmpty())       break;
      sleepUninterruptibly(100,TimeUnit.MILLISECONDS);
    }
  }
  t.join();
  assertFalse("Expected to find scans, but found none",scans.isEmpty());
  boolean found=false;
  Map<String,String> map=null;
  for (int i=0; i < scans.size() && !found; i++) {
    ActiveScan scan=scans.get(i);
    if (clientPrincipal.equals(scan.getUser())) {
      assertTrue(ScanState.RUNNING.equals(scan.getState()) || ScanState.QUEUED.equals(scan.getState()));
      assertEquals(ScanType.SINGLE,scan.getType());
      assertEquals("slow",scan.getTable());
      map=client.tableIdMap(creds);
      assertEquals(map.get("slow"),scan.getExtent().tableId);
      assertTrue(scan.getExtent().endRow == null);
      assertTrue(scan.getExtent().prevEndRow == null);
      found=true;
    }
  }
  assertTrue("Could not find a scan against the 'slow' table",found);
}

</code></pre>

<br>
<pre class="type-11 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test(timeout=5000) public void authenticateUserLoginFailure() throws Exception {
  if (!isKerberosEnabled()) {
    try {
      client.authenticateUser(badLogin,"root",s2pp(SharedMiniClusterBase.getRootPassword()));
      fail("Expected AccumuloSecurityException");
    }
 catch (    AccumuloSecurityException e) {
      return;
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.replication.ReplicationIT </h4><pre class="type-9 type-11 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void replicationEntriesPrecludeWalDeletion() throws Exception {
  final Connector conn=getConnector();
  String table1="table1", table2="table2", table3="table3";
  final Multimap<String,String> logs=HashMultimap.create();
  final AtomicBoolean keepRunning=new AtomicBoolean(true);
  Thread t=new Thread(new Runnable(){
    @Override public void run(){
      while (keepRunning.get()) {
        try {
          logs.putAll(getAllLogs(conn));
        }
 catch (        Exception e) {
          log.error("Error getting logs",e);
        }
      }
    }
  }
);
  t.start();
  conn.tableOperations().create(table1);
  conn.tableOperations().setProperty(table1,Property.TABLE_REPLICATION.getKey(),"true");
  conn.tableOperations().setProperty(table1,Property.TABLE_REPLICATION_TARGET.getKey() + "cluster1","1");
  Thread.sleep(2000);
  writeSomeData(conn,table1,200,500);
  conn.tableOperations().create(table2);
  conn.tableOperations().setProperty(table2,Property.TABLE_REPLICATION.getKey(),"true");
  conn.tableOperations().setProperty(table2,Property.TABLE_REPLICATION_TARGET.getKey() + "cluster1","1");
  Thread.sleep(2000);
  writeSomeData(conn,table2,200,500);
  conn.tableOperations().create(table3);
  conn.tableOperations().setProperty(table3,Property.TABLE_REPLICATION.getKey(),"true");
  conn.tableOperations().setProperty(table3,Property.TABLE_REPLICATION_TARGET.getKey() + "cluster1","1");
  Thread.sleep(2000);
  writeSomeData(conn,table3,200,500);
  for (  String table : Arrays.asList(table1,table2,table3)) {
    conn.tableOperations().flush(table,null,null,true);
  }
  keepRunning.set(false);
  t.join(5000);
  Thread.sleep(5000);
  Set<String> replFiles=getReferencesToFilesToBeReplicated(conn);
  String replicationTableId=conn.tableOperations().tableIdMap().get(ReplicationTable.NAME);
  Iterator<Entry<String,String>> observedLogs=logs.entries().iterator();
  while (observedLogs.hasNext()) {
    Entry<String,String> observedLog=observedLogs.next();
    if (replicationTableId.equals(observedLog.getValue())) {
      log.info("Removing {} because its tableId is for the replication table",observedLog);
      observedLogs.remove();
    }
  }
  Assert.assertTrue("Metadata log distribution: " + logs + "replFiles "+ replFiles,logs.keySet().containsAll(replFiles));
  Assert.assertTrue("Difference between replication entries and current logs is bigger than one",logs.keySet().size() - replFiles.size() <= 1);
  final Configuration conf=new Configuration();
  for (  String replFile : replFiles) {
    Path p=new Path(replFile);
    FileSystem fs=p.getFileSystem(conf);
    if (!fs.exists(p)) {
      Set<String> currentSet=getReferencesToFilesToBeReplicated(conn);
      log.info("Current references {}",currentSet);
      log.info("Looking for reference to {}",replFile);
      log.info("Contains? {}",currentSet.contains(replFile));
      Assert.assertTrue("File does not exist anymore, it was likely incorrectly garbage collected: " + p,!currentSet.contains(replFile));
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-13 type-11 type-8 type-5 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void replicatedStatusEntriesAreDeleted() throws Exception {
  getCluster().getClusterControl().stop(ServerType.GARBAGE_COLLECTOR);
  final Connector conn=getConnector();
  log.info("Got connector to MAC");
  String table1="table1";
  Assert.assertFalse(ReplicationTable.isOnline(conn));
  conn.tableOperations().create(table1);
  int attempts=5;
  while (attempts > 0) {
    try {
      conn.tableOperations().setProperty(table1,Property.TABLE_REPLICATION.getKey(),"true");
      conn.tableOperations().setProperty(table1,Property.TABLE_REPLICATION_TARGET.getKey() + "cluster1","4");
      conn.instanceOperations().setProperty(Property.REPLICATION_PEERS.getKey() + "cluster1",ReplicaSystemFactory.getPeerConfigurationValue(MockReplicaSystem.class,"1000"));
      attempts=0;
    }
 catch (    Exception e) {
      attempts--;
      if (attempts <= 0) {
        throw e;
      }
      sleepUninterruptibly(500,TimeUnit.MILLISECONDS);
    }
  }
  String tableId=conn.tableOperations().tableIdMap().get(table1);
  Assert.assertNotNull("Could not determine table id for " + table1,tableId);
  writeSomeData(conn,table1,2000,50);
  conn.tableOperations().flush(table1,null,null,true);
  boolean online=ReplicationTable.isOnline(conn);
  attempts=10;
  do {
    if (!online) {
      sleepUninterruptibly(1,TimeUnit.SECONDS);
      online=ReplicationTable.isOnline(conn);
      attempts--;
    }
  }
 while (!online && attempts > 0);
  Assert.assertTrue("Replication table did not exist",online);
  conn.securityOperations().grantTablePermission("root",ReplicationTable.NAME,TablePermission.WRITE);
  log.info("Checking for replication entries in replication");
  Scanner s;
  Set<String> entries=new HashSet<>();
  for (int i=0; i < 5; i++) {
    s=conn.createScanner(MetadataTable.NAME,Authorizations.EMPTY);
    s.setRange(ReplicationSection.getRange());
    entries.clear();
    for (    Entry<Key,Value> entry : s) {
      entries.add(entry.getKey().getRow().toString());
      log.info("{}={}",entry.getKey().toStringNoTruncate(),entry.getValue());
    }
    if (!entries.isEmpty()) {
      log.info("Replication entries {}",entries);
      break;
    }
    Thread.sleep(1000);
  }
  Assert.assertFalse("Did not find any replication entries in the replication table",entries.isEmpty());
  boolean notFound=true;
  for (int i=0; i < 10 && notFound; i++) {
    try {
      s=ReplicationTable.getScanner(conn);
      WorkSection.limit(s);
      Entry<Key,Value> e=Iterables.getOnlyElement(s);
      log.info("Found entry: " + e.getKey().toStringNoTruncate());
      Text expectedColqual=new ReplicationTarget("cluster1","4",tableId).toText();
      Assert.assertEquals(expectedColqual,e.getKey().getColumnQualifier());
      notFound=false;
    }
 catch (    NoSuchElementException e) {
    }
catch (    IllegalArgumentException e) {
      s=ReplicationTable.getScanner(conn);
      for (      Entry<Key,Value> content : s) {
        log.info(content.getKey().toStringNoTruncate() + " => " + content.getValue());
      }
      Assert.fail("Found more than one work section entry");
    }
catch (    RuntimeException e) {
      Throwable cause=e.getCause();
      if (cause instanceof AccumuloSecurityException) {
        AccumuloSecurityException sec=(AccumuloSecurityException)cause;
switch (sec.getSecurityErrorCode()) {
case PERMISSION_DENIED:
          log.warn("Sleeping because permission was denied");
        break;
default :
      throw e;
  }
}
 else {
  throw e;
}
}
Thread.sleep(2000);
}
if (notFound) {
s=ReplicationTable.getScanner(conn);
for (Entry<Key,Value> content : s) {
log.info(content.getKey().toStringNoTruncate() + " => " + ProtobufUtil.toString(Status.parseFrom(content.getValue().get())));
}
Assert.assertFalse("Did not find the work entry for the status entry",notFound);
}
log.info("Killing tserver");
cluster.getClusterControl().stop(ServerType.TABLET_SERVER);
log.info("Starting tserver");
cluster.getClusterControl().start(ServerType.TABLET_SERVER);
log.info("Waiting to read tables");
sleepUninterruptibly(2 * 3,TimeUnit.SECONDS);
for (String table : new String[]{MetadataTable.NAME,table1}) {
Iterators.size(conn.createScanner(table,Authorizations.EMPTY).iterator());
}
log.info("Recovered metadata:");
s=conn.createScanner(MetadataTable.NAME,Authorizations.EMPTY);
for (Entry<Key,Value> entry : s) {
log.info("{}={}",entry.getKey().toStringNoTruncate(),entry.getValue());
}
cluster.getClusterControl().start(ServerType.GARBAGE_COLLECTOR);
waitForGCLock(conn);
Thread.sleep(1000);
log.info("After GC");
s=conn.createScanner(MetadataTable.NAME,Authorizations.EMPTY);
for (Entry<Key,Value> entry : s) {
log.info("{}={}",entry.getKey().toStringNoTruncate(),entry.getValue());
}
log.info("Checking metadata table for replication entries");
Set<String> remaining=new HashSet<>();
for (int i=0; i < 10; i++) {
s=conn.createScanner(MetadataTable.NAME,Authorizations.EMPTY);
s.setRange(ReplicationSection.getRange());
remaining.clear();
for (Entry<Key,Value> e : s) {
remaining.add(e.getKey().getRow().toString());
}
remaining.retainAll(entries);
if (remaining.isEmpty()) {
break;
}
log.info("remaining {}",remaining);
Thread.sleep(2000);
log.info("");
}
Assert.assertTrue("Replication status messages were not cleaned up from metadata table",remaining.isEmpty());
int recordsFound=0;
for (int i=0; i < 30; i++) {
s=ReplicationTable.getScanner(conn);
recordsFound=0;
for (Entry<Key,Value> entry : s) {
recordsFound++;
log.info("{} {}",entry.getKey().toStringNoTruncate(),ProtobufUtil.toString(Status.parseFrom(entry.getValue().get())));
}
if (recordsFound <= 2) {
break;
}
 else {
Thread.sleep(1000);
log.info("");
}
}
Assert.assertTrue("Found unexpected replication records in the replication table",recordsFound <= 2);
}

</code></pre>

<br>
<pre class="type-9 type-11 type-8 type-5 type-3 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void replicationRecordsAreClosedAfterGarbageCollection() throws Exception {
  getCluster().getClusterControl().stop(ServerType.GARBAGE_COLLECTOR);
  final Connector conn=getConnector();
  ReplicationTable.setOnline(conn);
  conn.securityOperations().grantTablePermission("root",ReplicationTable.NAME,TablePermission.WRITE);
  conn.tableOperations().deleteRows(ReplicationTable.NAME,null,null);
  final AtomicBoolean keepRunning=new AtomicBoolean(true);
  final Set<String> metadataWals=new HashSet<>();
  Thread t=new Thread(new Runnable(){
    @Override public void run(){
      while (keepRunning.get()) {
        try {
          metadataWals.addAll(getLogs(conn).keySet());
        }
 catch (        Exception e) {
          log.error("Metadata table doesn't exist");
        }
      }
    }
  }
);
  t.start();
  String table1="table1", table2="table2", table3="table3";
  try {
    conn.tableOperations().create(table1);
    conn.tableOperations().setProperty(table1,Property.TABLE_REPLICATION.getKey(),"true");
    conn.tableOperations().setProperty(table1,Property.TABLE_REPLICATION_TARGET.getKey() + "cluster1","1");
    conn.instanceOperations().setProperty(Property.REPLICATION_PEERS.getKey() + "cluster1",ReplicaSystemFactory.getPeerConfigurationValue(MockReplicaSystem.class,null));
    writeSomeData(conn,table1,200,500);
    conn.tableOperations().create(table2);
    conn.tableOperations().setProperty(table2,Property.TABLE_REPLICATION.getKey(),"true");
    conn.tableOperations().setProperty(table2,Property.TABLE_REPLICATION_TARGET.getKey() + "cluster1","1");
    writeSomeData(conn,table2,200,500);
    conn.tableOperations().create(table3);
    conn.tableOperations().setProperty(table3,Property.TABLE_REPLICATION.getKey(),"true");
    conn.tableOperations().setProperty(table3,Property.TABLE_REPLICATION_TARGET.getKey() + "cluster1","1");
    writeSomeData(conn,table3,200,500);
    for (    String table : Arrays.asList(table1,table2,table3)) {
      conn.tableOperations().compact(table,null,null,true,true);
    }
  }
  finally {
    keepRunning.set(false);
    t.join(5000);
    Assert.assertFalse(t.isAlive());
  }
  cluster.getClusterControl().stop(ServerType.TABLET_SERVER);
  cluster.getClusterControl().start(ServerType.TABLET_SERVER);
  for (  String table : Arrays.asList(table1,table2,table3)) {
    Iterators.size(conn.createScanner(table,Authorizations.EMPTY).iterator());
  }
  Process gc=cluster.exec(SimpleGarbageCollector.class);
  waitForGCLock(conn);
  Thread.sleep(1000);
  log.info("GC is up and should have had time to run at least once by now");
  try {
    boolean allClosed=true;
    for (int i=0; i < 10; i++) {
      Scanner s=conn.createScanner(MetadataTable.NAME,Authorizations.EMPTY);
      s.setRange(Range.prefix(ReplicationSection.getRowPrefix()));
      Iterator<Entry<Key,Value>> iter=s.iterator();
      long recordsFound=0l;
      while (allClosed && iter.hasNext()) {
        Entry<Key,Value> entry=iter.next();
        String wal=entry.getKey().getRow().toString();
        if (metadataWals.contains(wal)) {
          Status status=Status.parseFrom(entry.getValue().get());
          log.info("{}={}",entry.getKey().toStringNoTruncate(),ProtobufUtil.toString(status));
          allClosed&=status.getClosed();
          recordsFound++;
        }
      }
      log.info("Found {} records from the metadata table",recordsFound);
      if (allClosed) {
        break;
      }
      sleepUninterruptibly(2,TimeUnit.SECONDS);
    }
    if (!allClosed) {
      Scanner s=conn.createScanner(MetadataTable.NAME,Authorizations.EMPTY);
      s.setRange(Range.prefix(ReplicationSection.getRowPrefix()));
      for (      Entry<Key,Value> entry : s) {
        log.info(entry.getKey().toStringNoTruncate() + " " + ProtobufUtil.toString(Status.parseFrom(entry.getValue().get())));
      }
      Assert.fail("Expected all replication records in the metadata table to be closed");
    }
    for (int i=0; i < 10; i++) {
      allClosed=true;
      Scanner s=ReplicationTable.getScanner(conn);
      Iterator<Entry<Key,Value>> iter=s.iterator();
      long recordsFound=0l;
      while (allClosed && iter.hasNext()) {
        Entry<Key,Value> entry=iter.next();
        String wal=entry.getKey().getRow().toString();
        if (metadataWals.contains(wal)) {
          Status status=Status.parseFrom(entry.getValue().get());
          log.info("{}={}",entry.getKey().toStringNoTruncate(),ProtobufUtil.toString(status));
          allClosed&=status.getClosed();
          recordsFound++;
        }
      }
      log.info("Found {} records from the replication table",recordsFound);
      if (allClosed) {
        break;
      }
      sleepUninterruptibly(3,TimeUnit.SECONDS);
    }
    if (!allClosed) {
      Scanner s=ReplicationTable.getScanner(conn);
      StatusSection.limit(s);
      for (      Entry<Key,Value> entry : s) {
        log.info(entry.getKey().toStringNoTruncate() + " " + TextFormat.shortDebugString(Status.parseFrom(entry.getValue().get())));
      }
      Assert.fail("Expected all replication records in the replication table to be closed");
    }
  }
  finally {
    gc.destroy();
    gc.waitFor();
  }
}

</code></pre>

<br>
<pre class="type-9 type-13 type-11 type-8 type-5 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void correctClusterNameInWorkEntry() throws Exception {
  Connector conn=getConnector();
  String table1="table1";
  Assert.assertFalse(ReplicationTable.isOnline(conn));
  conn.tableOperations().create(table1);
  int attempts=5;
  while (attempts > 0) {
    try {
      conn.tableOperations().setProperty(table1,Property.TABLE_REPLICATION.getKey(),"true");
      conn.tableOperations().setProperty(table1,Property.TABLE_REPLICATION_TARGET.getKey() + "cluster1","4");
      attempts=0;
    }
 catch (    Exception e) {
      attempts--;
      if (attempts <= 0) {
        throw e;
      }
      sleepUninterruptibly(500,TimeUnit.MILLISECONDS);
    }
  }
  writeSomeData(conn,table1,2000,50);
  conn.tableOperations().flush(table1,null,null,true);
  String tableId=conn.tableOperations().tableIdMap().get(table1);
  Assert.assertNotNull("Table ID was null",tableId);
  boolean online=ReplicationTable.isOnline(conn);
  attempts=5;
  do {
    if (!online) {
      sleepUninterruptibly(500,TimeUnit.MILLISECONDS);
      online=ReplicationTable.isOnline(conn);
      attempts--;
    }
  }
 while (!online && attempts > 0);
  Assert.assertTrue("Replication table did not exist",online);
  for (int i=0; i < 5 && !conn.securityOperations().hasTablePermission("root",ReplicationTable.NAME,TablePermission.READ); i++) {
    Thread.sleep(1000);
  }
  Assert.assertTrue(conn.securityOperations().hasTablePermission("root",ReplicationTable.NAME,TablePermission.READ));
  boolean notFound=true;
  Scanner s;
  for (int i=0; i < 10 && notFound; i++) {
    s=ReplicationTable.getScanner(conn);
    WorkSection.limit(s);
    try {
      Entry<Key,Value> e=Iterables.getOnlyElement(s);
      Text expectedColqual=new ReplicationTarget("cluster1","4",tableId).toText();
      Assert.assertEquals(expectedColqual,e.getKey().getColumnQualifier());
      notFound=false;
    }
 catch (    NoSuchElementException e) {
    }
catch (    IllegalArgumentException e) {
      s=ReplicationTable.getScanner(conn);
      for (      Entry<Key,Value> content : s) {
        log.info(content.getKey().toStringNoTruncate() + " => " + content.getValue());
      }
      Assert.fail("Found more than one work section entry");
    }
    Thread.sleep(500);
  }
  if (notFound) {
    s=ReplicationTable.getScanner(conn);
    for (    Entry<Key,Value> content : s) {
      log.info(content.getKey().toStringNoTruncate() + " => " + content.getValue());
    }
    Assert.assertFalse("Did not find the work entry for the status entry",notFound);
  }
}

</code></pre>

<br>
<pre class="type-9 type-13 type-11 type-5 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void singleTableWithSingleTarget() throws Exception {
  getCluster().getClusterControl().stop(ServerType.GARBAGE_COLLECTOR);
  Connector conn=getConnector();
  String table1="table1";
  Assert.assertFalse(ReplicationTable.isOnline(conn));
  conn.tableOperations().create(table1);
  int attempts=10;
  while (attempts > 0) {
    try {
      conn.tableOperations().setProperty(table1,Property.TABLE_REPLICATION.getKey(),"true");
      conn.tableOperations().setProperty(table1,Property.TABLE_REPLICATION_TARGET.getKey() + "cluster1","4");
      conn.instanceOperations().setProperty(Property.REPLICATION_PEERS.getKey() + "cluster1",ReplicaSystemFactory.getPeerConfigurationValue(MockReplicaSystem.class,"100000"));
      break;
    }
 catch (    Exception e) {
      attempts--;
      if (attempts <= 0) {
        throw e;
      }
      sleepUninterruptibly(2,TimeUnit.SECONDS);
    }
  }
  writeSomeData(conn,table1,2000,50);
  boolean online=ReplicationTable.isOnline(conn);
  attempts=10;
  do {
    if (!online) {
      sleepUninterruptibly(2,TimeUnit.SECONDS);
      online=ReplicationTable.isOnline(conn);
      attempts--;
    }
  }
 while (!online && attempts > 0);
  Assert.assertTrue("Replication table was never created",online);
  for (int i=0; i < 10 && !conn.tableOperations().listIterators(ReplicationTable.NAME).keySet().contains(ReplicationTable.COMBINER_NAME); i++) {
    sleepUninterruptibly(2,TimeUnit.SECONDS);
  }
  Assert.assertTrue("Combiner was never set on replication table",conn.tableOperations().listIterators(ReplicationTable.NAME).keySet().contains(ReplicationTable.COMBINER_NAME));
  conn.tableOperations().flush(table1,null,null,true);
  Scanner s=ReplicationTable.getScanner(conn);
  StatusSection.limit(s);
  Entry<Key,Value> entry=null;
  Status expectedStatus=StatusUtil.openWithUnknownLength();
  attempts=10;
  while (null == entry && attempts > 0) {
    try {
      entry=Iterables.getOnlyElement(s);
      Status actual=Status.parseFrom(entry.getValue().get());
      if (actual.getInfiniteEnd() != expectedStatus.getInfiniteEnd()) {
        entry=null;
        Thread.sleep(1000);
      }
    }
 catch (    NoSuchElementException e) {
      entry=null;
      Thread.sleep(500);
    }
catch (    IllegalArgumentException e) {
      s=ReplicationTable.getScanner(conn);
      StatusSection.limit(s);
      for (      Entry<Key,Value> content : s) {
        log.info(content.getKey().toStringNoTruncate() + " => " + content.getValue());
      }
      throw e;
    }
 finally {
      attempts--;
    }
  }
  Assert.assertNotNull("Could not find expected entry in replication table",entry);
  Status actual=Status.parseFrom(entry.getValue().get());
  Assert.assertTrue("Expected to find a replication entry that is open with infinite length: " + ProtobufUtil.toString(actual),!actual.getClosed() && actual.getInfiniteEnd());
  boolean notFound=true;
  for (int i=0; i < 10 && notFound; i++) {
    s=ReplicationTable.getScanner(conn);
    WorkSection.limit(s);
    int elementsFound=Iterables.size(s);
    if (0 < elementsFound) {
      Assert.assertEquals(1,elementsFound);
      notFound=false;
    }
    Thread.sleep(500);
  }
  if (notFound) {
    s=ReplicationTable.getScanner(conn);
    for (    Entry<Key,Value> content : s) {
      log.info(content.getKey().toStringNoTruncate() + " => " + content.getValue());
    }
    Assert.assertFalse("Did not find the work entry for the status entry",notFound);
  }
  writeSomeData(conn,table1,3000,50);
  log.info("Issued compaction for table");
  conn.tableOperations().compact(table1,null,null,true,true);
  log.info("Compaction completed");
  Thread.sleep(5000);
  s=ReplicationTable.getScanner(conn);
  StatusSection.limit(s);
  int numRecords=0;
  for (  Entry<Key,Value> e : s) {
    numRecords++;
    log.info("Found status record {}\t{}",e.getKey().toStringNoTruncate(),ProtobufUtil.toString(Status.parseFrom(e.getValue().get())));
  }
  Assert.assertEquals(2,numRecords);
  notFound=true;
  for (int i=0; i < 10 && notFound; i++) {
    s=ReplicationTable.getScanner(conn);
    WorkSection.limit(s);
    int elementsFound=Iterables.size(s);
    if (2 == elementsFound) {
      notFound=false;
    }
    Thread.sleep(500);
  }
  if (notFound) {
    s=ReplicationTable.getScanner(conn);
    for (    Entry<Key,Value> content : s) {
      log.info(content.getKey().toStringNoTruncate() + " => " + content.getValue());
    }
    Assert.assertFalse("Did not find the work entries for the status entries",notFound);
  }
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
