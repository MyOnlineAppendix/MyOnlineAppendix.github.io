<h3><span class=" glyphicon glyphicon-tag"/>&nbspIterativeVerifier</h3><kbd>Verifies assertions in iterations</kbd><br><br><br><h4 style="margin:0px">Class: org.apache.accumulo.core.client.mock.MockTableOperationsTest </h4><pre class="type-9 type-13 type-5 type-3 type-2 type-14 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testImport() throws Throwable {
  ImportTestFilesAndData dataAndFiles=prepareTestFiles();
  TableOperations tableOperations=conn.tableOperations();
  tableOperations.create("a_table");
  tableOperations.importDirectory("a_table",dataAndFiles.importPath.toString(),dataAndFiles.failurePath.toString(),false);
  Scanner scanner=conn.createScanner("a_table",new Authorizations());
  Iterator<Entry<Key,Value>> iterator=scanner.iterator();
  for (int i=0; i < 5; i++) {
    Assert.assertTrue(iterator.hasNext());
    Entry<Key,Value> kv=iterator.next();
    Pair<Key,Value> expected=dataAndFiles.keyVals.get(i);
    Assert.assertEquals(expected.getFirst(),kv.getKey());
    Assert.assertEquals(expected.getSecond(),kv.getValue());
  }
  Assert.assertFalse(iterator.hasNext());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.data.ColumnTest </h4><pre class="type-13 type-11 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
"></span><br>
@Test public void testEquals(){
  for (int i=0; i < col.length; i++) {
    for (int j=0; j < col.length; j++) {
      if (i == j || (i == 0 && j == 1) || (i == 1 && j == 0))       assertTrue(col[i].equals(col[j]));
 else       assertFalse(col[i].equals(col[j]));
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testEqualsCompare(){
  for (int i=0; i < col.length; i++)   for (int j=0; j < col.length; j++)   assertEquals(col[i].equals(col[j]),col[i].compareTo(col[j]) == 0);
}

</code></pre>

<br>
<pre class="type-13 type-11 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCompare(){
  for (int i=0; i < col.length; i++) {
    for (int j=0; j < col.length; j++) {
      if (i == j || (i == 0 && j == 1) || (i == 1 && j == 0))       assertEquals(0,col[i].compareTo(col[j]));
 else       assertNotEquals(0,col[i].compareTo(col[j]));
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.data.KeyTest </h4><pre class="type-9 type-13 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCompressDecompress(){
  List<KeyValue> kvs=new ArrayList<KeyValue>();
  kvs.add(new KeyValue(new Key(),new byte[]{}));
  kvs.add(new KeyValue(new Key("r"),new byte[]{}));
  kvs.add(new KeyValue(new Key("r","cf"),new byte[]{}));
  kvs.add(new KeyValue(new Key("r2","cf"),new byte[]{}));
  kvs.add(new KeyValue(new Key("r","cf","cq"),new byte[]{}));
  kvs.add(new KeyValue(new Key("r2","cf2","cq"),new byte[]{}));
  kvs.add(new KeyValue(new Key("r","cf","cq","cv"),new byte[]{}));
  kvs.add(new KeyValue(new Key("r2","cf2","cq2","cv"),new byte[]{}));
  kvs.add(new KeyValue(new Key("r2","cf2","cq2","cv"),new byte[]{}));
  kvs.add(new KeyValue(new Key(),new byte[]{}));
  List<TKeyValue> tkvs=Key.compress(kvs);
  Key.decompress(tkvs);
  assertEquals(kvs.size(),tkvs.size());
  Iterator<KeyValue> kvi=kvs.iterator();
  Iterator<TKeyValue> tkvi=tkvs.iterator();
  while (kvi.hasNext()) {
    KeyValue kv=kvi.next();
    TKeyValue tkv=tkvi.next();
    assertEquals(kv.getKey(),new Key(tkv.getKey()));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.data.MutationTest </h4><pre class="type-9 type-13 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test3() throws IOException {
  Mutation m=new Mutation(new Text("r1"));
  for (int i=0; i < 5; i++) {
    int len=Mutation.VALUE_SIZE_COPY_CUTOFF - 2 + i;
    byte val[]=new byte[len];
    for (int j=0; j < len; j++)     val[j]=(byte)i;
    m.put(new Text("cf" + i),new Text("cq" + i),new Value(val));
  }
  for (int r=0; r < 3; r++) {
    assertEquals("r1",new String(m.getRow()));
    List<ColumnUpdate> updates=m.getUpdates();
    assertEquals(5,updates.size());
    for (int i=0; i < 5; i++) {
      ColumnUpdate cu=updates.get(i);
      assertEquals("cf" + i,new String(cu.getColumnFamily()));
      assertEquals("cq" + i,new String(cu.getColumnQualifier()));
      assertEquals("",new String(cu.getColumnVisibility()));
      assertFalse(cu.hasTimestamp());
      byte[] val=cu.getValue();
      int len=Mutation.VALUE_SIZE_COPY_CUTOFF - 2 + i;
      assertEquals(len,val.length);
      for (int j=0; j < len; j++)       assertEquals(i,val[j]);
    }
    m=cloneMutation(m);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.file.BloomFilterLayerLookupTest </h4><pre class="type-9 type-13 type-11 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void test() throws IOException {
  HashSet<Integer> valsSet=new HashSet<Integer>();
  for (int i=0; i < 100000; i++) {
    valsSet.add(random.nextInt(Integer.MAX_VALUE));
  }
  ArrayList<Integer> vals=new ArrayList<Integer>(valsSet);
  Collections.sort(vals);
  ConfigurationCopy acuconf=new ConfigurationCopy(AccumuloConfiguration.getDefaultConfiguration());
  acuconf.set(Property.TABLE_BLOOM_ENABLED,"true");
  acuconf.set(Property.TABLE_BLOOM_KEY_FUNCTOR,ColumnFamilyFunctor.class.getName());
  acuconf.set(Property.TABLE_FILE_TYPE,RFile.EXTENSION);
  acuconf.set(Property.TABLE_BLOOM_LOAD_THRESHOLD,"1");
  acuconf.set(Property.TSERV_BLOOM_LOAD_MAXCONCURRENT,"1");
  Configuration conf=CachedConfiguration.getInstance();
  FileSystem fs=FileSystem.get(conf);
  String suffix=FileOperations.getNewFileExtension(acuconf);
  String fname=new File(tempDir.getRoot(),testName + "." + suffix).getAbsolutePath();
  FileSKVWriter bmfw=FileOperations.getInstance().openWriter(fname,fs,conf,acuconf);
  long t1=System.currentTimeMillis();
  bmfw.startDefaultLocalityGroup();
  for (  Integer i : vals) {
    String fi=String.format("%010d",i);
    bmfw.append(new Key(new Text("r" + fi),new Text("cf1")),new Value(("v" + fi).getBytes()));
    bmfw.append(new Key(new Text("r" + fi),new Text("cf2")),new Value(("v" + fi).getBytes()));
  }
  long t2=System.currentTimeMillis();
  LOG.debug(String.format("write rate %6.2f%n",vals.size() / ((t2 - t1) / 1000.0)));
  bmfw.close();
  t1=System.currentTimeMillis();
  FileSKVIterator bmfr=FileOperations.getInstance().openReader(fname,false,fs,conf,acuconf);
  t2=System.currentTimeMillis();
  LOG.debug("Opened " + fname + " in "+ (t2 - t1));
  int hits=0;
  t1=System.currentTimeMillis();
  for (int i=0; i < 5000; i++) {
    int row=random.nextInt(Integer.MAX_VALUE);
    seek(bmfr,row);
    if (valsSet.contains(row)) {
      hits++;
      assertTrue(bmfr.hasTop());
    }
  }
  t2=System.currentTimeMillis();
  double rate1=5000 / ((t2 - t1) / 1000.0);
  LOG.debug(String.format("random lookup rate : %6.2f%n",rate1));
  LOG.debug("hits = " + hits);
  int count=0;
  t1=System.currentTimeMillis();
  for (  Integer row : valsSet) {
    seek(bmfr,row);
    assertTrue(bmfr.hasTop());
    count++;
    if (count >= 500) {
      break;
    }
  }
  t2=System.currentTimeMillis();
  double rate2=500 / ((t2 - t1) / 1000.0);
  LOG.debug(String.format("existant lookup rate %6.2f%n",rate2));
  LOG.debug("expected hits 500.  Receive hits: " + count);
  bmfr.close();
  assertTrue(rate1 > rate2);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.file.rfile.BlockIndexTest </h4><pre class="type-9 type-13 type-5 type-3 type-15 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSame() throws IOException {
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  DataOutputStream out=new DataOutputStream(baos);
  Key prevKey=null;
  int num=1000;
  for (int i=0; i < num; i++) {
    Key key=new Key(RFileTest.nf("",1),"cf1","cq1");
    new RelativeKey(prevKey,key).write(out);
    new Value(new byte[0]).write(out);
    prevKey=key;
  }
  for (int i=0; i < num; i++) {
    Key key=new Key(RFileTest.nf("",3),"cf1","cq1");
    new RelativeKey(prevKey,key).write(out);
    new Value(new byte[0]).write(out);
    prevKey=key;
  }
  for (int i=0; i < num; i++) {
    Key key=new Key(RFileTest.nf("",5),"cf1","cq1");
    new RelativeKey(prevKey,key).write(out);
    new Value(new byte[0]).write(out);
    prevKey=key;
  }
  out.close();
  final byte[] data=baos.toByteArray();
  CacheEntry ce=new MyCacheEntry(data);
  ABlockReader cacheBlock=new CachableBlockFile.CachedBlockRead(ce,data);
  BlockIndex blockIndex=null;
  for (int i=0; i < 257; i++)   blockIndex=BlockIndex.getIndex(cacheBlock,new IndexEntry(prevKey,num,0,0,0));
  Assert.assertSame(null,blockIndex.seekBlock(new Key(RFileTest.nf("",0),"cf1","cq1"),cacheBlock));
  Assert.assertSame(null,blockIndex.seekBlock(new Key(RFileTest.nf("",1),"cf1","cq1"),cacheBlock));
  for (int i=2; i < 6; i++) {
    Key seekKey=new Key(RFileTest.nf("",i),"cf1","cq1");
    BlockIndexEntry bie=blockIndex.seekBlock(seekKey,cacheBlock);
    Assert.assertTrue(bie.getPrevKey().compareTo(seekKey) < 0);
    RelativeKey rk=new RelativeKey();
    rk.setPrevKey(bie.getPrevKey());
    rk.readFields(cacheBlock);
    Assert.assertTrue(rk.getKey().compareTo(seekKey) <= 0);
  }
  cacheBlock.close();
}

</code></pre>

<br>
<pre class="type-9 type-13 type-11 type-3 type-15 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test1() throws IOException {
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  DataOutputStream out=new DataOutputStream(baos);
  Key prevKey=null;
  int num=1000;
  for (int i=0; i < num; i++) {
    Key key=new Key(RFileTest.nf("",i),"cf1","cq1");
    new RelativeKey(prevKey,key).write(out);
    new Value(new byte[0]).write(out);
    prevKey=key;
  }
  out.close();
  final byte[] data=baos.toByteArray();
  CacheEntry ce=new MyCacheEntry(data);
  ABlockReader cacheBlock=new CachableBlockFile.CachedBlockRead(ce,data);
  BlockIndex blockIndex=null;
  for (int i=0; i < 129; i++)   blockIndex=BlockIndex.getIndex(cacheBlock,new IndexEntry(prevKey,num,0,0,0));
  BlockIndexEntry[] indexEntries=blockIndex.getIndexEntries();
  for (int i=0; i < indexEntries.length; i++) {
    int row=Integer.parseInt(indexEntries[i].getPrevKey().getRowData().toString());
    BlockIndexEntry bie;
    bie=blockIndex.seekBlock(new Key(RFileTest.nf("",row),"cf1","cq1"),cacheBlock);
    if (i == 0)     Assert.assertSame(null,bie);
 else     Assert.assertSame(indexEntries[i - 1],bie);
    Assert.assertSame(bie,blockIndex.seekBlock(new Key(RFileTest.nf("",row - 1),"cf1","cq1"),cacheBlock));
    bie=blockIndex.seekBlock(new Key(RFileTest.nf("",row + 1),"cf1","cq1"),cacheBlock);
    Assert.assertSame(indexEntries[i],bie);
    RelativeKey rk=new RelativeKey();
    rk.setPrevKey(bie.getPrevKey());
    rk.readFields(cacheBlock);
    Assert.assertEquals(rk.getKey(),new Key(RFileTest.nf("",row + 1),"cf1","cq1"));
  }
  cacheBlock.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.file.rfile.RFileTest </h4><pre class="type-13 type-11 type-5 type-3 type-2 type-14 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test11() throws IOException {
  TestRFile trf=new TestRFile(conf);
  trf.openWriter(false);
  trf.writer.startNewLocalityGroup("lg1",ncfs("3mod10"));
  for (int i=3; i < 1024; i+=10) {
    trf.writer.append(nk(nf("i",i),"3mod10","","",i + 2),nv("" + i));
  }
  trf.writer.startNewLocalityGroup("lg2",ncfs("5mod10","7mod10"));
  for (int i=5; i < 1024; ) {
    trf.writer.append(nk(nf("i",i),"5mod10","","",i + 2),nv("" + i));
    i+=2;
    trf.writer.append(nk(nf("i",i),"7mod10","","",i + 2),nv("" + i));
    i+=8;
  }
  trf.writer.startDefaultLocalityGroup();
  for (int i=0; i < 1024; i++) {
    int m10=i % 10;
    if (m10 == 3 || m10 == 5 || m10 == 7)     continue;
    trf.writer.append(nk(nf("i",i),m10 + "mod10","","",i + 2),nv("" + i));
  }
  trf.writer.close();
  trf.openReader();
  trf.iter.seek(new Range(new Text(""),null),EMPTY_COL_FAMS,false);
  assertEquals(3,trf.reader.getNumLocalityGroupsSeeked());
  for (int i=0; i < 1024; i++) {
    assertTrue(trf.iter.hasTop());
    assertEquals(nk(nf("i",i),(i % 10) + "mod10","","",i + 2),trf.iter.getTopKey());
    assertEquals(nv("" + i),trf.iter.getTopValue());
    trf.iter.next();
  }
  assertFalse(trf.iter.hasTop());
  for (int m=0; m < 10; m++) {
    trf.iter.seek(new Range(new Key(),true,null,true),ncfs(m + "mod10"),true);
    assertEquals(1,trf.reader.getNumLocalityGroupsSeeked());
    for (int i=m; i < 1024; i+=10) {
      assertTrue(trf.iter.hasTop());
      assertEquals(nk(nf("i",i),(i % 10) + "mod10","","",i + 2),trf.iter.getTopKey());
      assertEquals(nv("" + i),trf.iter.getTopValue());
      trf.iter.next();
    }
    assertFalse(trf.iter.hasTop());
    trf.iter.seek(new Range(new Key(),true,null,true),ncfs(m + "mod10"),false);
    if (m == 3)     assertEquals(2,trf.reader.getNumLocalityGroupsSeeked());
 else     assertEquals(3,trf.reader.getNumLocalityGroupsSeeked());
    for (int i=0; i < 1024; i++) {
      if (i % 10 == m)       continue;
      assertTrue(trf.iter.hasTop());
      assertEquals(nk(nf("i",i),(i % 10) + "mod10","","",i + 2),trf.iter.getTopKey());
      assertEquals(nv("" + i),trf.iter.getTopValue());
      trf.iter.next();
    }
    assertFalse(trf.iter.hasTop());
  }
  SortedKeyValueIterator<Key,Value> reader2=trf.iter.deepCopy(null);
  for (int m=0; m < 9; m++) {
    trf.iter.seek(new Range(new Key(),true,null,true),ncfs(m + "mod10"),true);
    assertEquals(1,trf.reader.getNumLocalityGroupsSeeked());
    reader2.seek(new Range(new Key(),true,null,true),ncfs((m + 1) + "mod10"),true);
    for (int i=m; i < 1024; i+=10) {
      assertTrue(trf.iter.hasTop());
      assertEquals(nk(nf("i",i),(i % 10) + "mod10","","",i + 2),trf.iter.getTopKey());
      assertEquals(nv("" + i),trf.iter.getTopValue());
      trf.iter.next();
      if (i + 1 < 1024) {
        assertTrue(reader2.hasTop());
        assertEquals(nk(nf("i",(i + 1)),((i + 1) % 10) + "mod10","","",i + 3),reader2.getTopKey());
        assertEquals(nv("" + (i + 1)),reader2.getTopValue());
        reader2.next();
      }
    }
    assertFalse(trf.iter.hasTop());
    assertFalse(reader2.hasTop());
  }
  trf.closeReader();
}

</code></pre>

<br>
<pre class="type-9 type-13 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test3() throws IOException {
  TestRFile trf=new TestRFile(conf);
  trf.openWriter();
  int val=0;
  ArrayList<Key> expectedKeys=new ArrayList<Key>(10000);
  ArrayList<Value> expectedValues=new ArrayList<Value>(10000);
  for (int row=0; row < 4; row++) {
    String rowS=nf("r_",row);
    for (int cf=0; cf < 4; cf++) {
      String cfS=nf("cf_",cf);
      for (int cq=0; cq < 4; cq++) {
        String cqS=nf("cq_",cq);
        for (int cv='A'; cv < 'A' + 4; cv++) {
          String cvS="" + (char)cv;
          for (int ts=4; ts > 0; ts--) {
            Key k=nk(rowS,cfS,cqS,cvS,ts);
            k.setDeleted(true);
            Value v=nv("" + val);
            trf.writer.append(k,v);
            expectedKeys.add(k);
            expectedValues.add(v);
            k=nk(rowS,cfS,cqS,cvS,ts);
            v=nv("" + val);
            trf.writer.append(k,v);
            expectedKeys.add(k);
            expectedValues.add(v);
            val++;
          }
        }
      }
    }
  }
  trf.closeWriter();
  trf.openReader();
  trf.iter.seek(new Range((Key)null,null),EMPTY_COL_FAMS,false);
  verify(trf,expectedKeys.iterator(),expectedValues.iterator());
  int index=expectedKeys.size() / 2;
  trf.seek(expectedKeys.get(index));
  verify(trf,expectedKeys.subList(index,expectedKeys.size()).iterator(),expectedValues.subList(index,expectedKeys.size()).iterator());
  index=0;
  trf.seek(expectedKeys.get(index));
  verify(trf,expectedKeys.subList(index,expectedKeys.size()).iterator(),expectedValues.subList(index,expectedKeys.size()).iterator());
  index=expectedKeys.size() - 1;
  trf.seek(expectedKeys.get(index));
  verify(trf,expectedKeys.subList(index,expectedKeys.size()).iterator(),expectedValues.subList(index,expectedKeys.size()).iterator());
  index=expectedKeys.size();
  trf.seek(new Key(new Text("z")));
  verify(trf,expectedKeys.subList(index,expectedKeys.size()).iterator(),expectedValues.subList(index,expectedKeys.size()).iterator());
  index=expectedKeys.size() / 2;
  trf.seek(expectedKeys.get(index));
  assertTrue(trf.iter.hasTop());
  assertEquals(expectedKeys.get(index),trf.iter.getTopKey());
  assertEquals(expectedValues.get(index),trf.iter.getTopValue());
  trf.iter.next();
  index++;
  assertTrue(trf.iter.hasTop());
  assertEquals(expectedKeys.get(index),trf.iter.getTopKey());
  assertEquals(expectedValues.get(index),trf.iter.getTopValue());
  trf.seek(expectedKeys.get(index));
  assertTrue(trf.iter.hasTop());
  assertEquals(expectedKeys.get(index),trf.iter.getTopKey());
  assertEquals(expectedValues.get(index),trf.iter.getTopValue());
  index=0;
  for (  Key key : expectedKeys) {
    trf.seek(key);
    assertTrue(trf.iter.hasTop());
    assertEquals(key,trf.iter.getTopKey());
    assertEquals(expectedValues.get(index),trf.iter.getTopValue());
    if (index > 0) {
      expectedKeys.get(index - 1);
    }
    index++;
  }
  for (int i=expectedKeys.size() - 1; i >= 0; i--) {
    Key key=expectedKeys.get(i);
    trf.seek(key);
    assertTrue(trf.iter.hasTop());
    assertEquals(key,trf.iter.getTopKey());
    assertEquals(expectedValues.get(i),trf.iter.getTopValue());
    if (i - 1 > 0) {
      expectedKeys.get(i - 1);
    }
  }
  assertEquals(expectedKeys.get(expectedKeys.size() - 1),trf.reader.getLastKey());
  Random rand=new Random();
  for (int i=0; i < 12; i++) {
    index=rand.nextInt(expectedKeys.size());
    trf.seek(expectedKeys.get(index));
    for (; index < expectedKeys.size(); index++) {
      assertTrue(trf.iter.hasTop());
      assertEquals(expectedKeys.get(index),trf.iter.getTopKey());
      assertEquals(expectedValues.get(index),trf.iter.getTopValue());
      trf.iter.next();
    }
  }
  trf.closeReader();
}

</code></pre>

<br>
<pre class="type-9 type-13 type-3 type-2 type-14 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testSample() throws IOException {
  int num=10000;
  for (  int sampleBufferSize : new int[]{1 << 10,1 << 20}) {
    RFile.setSampleBufferSize(sampleBufferSize);
    for (    int modulus : new int[]{19,103,1019}) {
      Hasher dataHasher=Hashing.md5().newHasher();
      List<Entry<Key,Value>> sampleData=new ArrayList<Entry<Key,Value>>();
      ConfigurationCopy sampleConf=new ConfigurationCopy(conf == null ? AccumuloConfiguration.getDefaultConfiguration() : conf);
      sampleConf.set(Property.TABLE_SAMPLER,RowSampler.class.getName());
      sampleConf.set(Property.TABLE_SAMPLER_OPTS + "hasher","murmur3_32");
      sampleConf.set(Property.TABLE_SAMPLER_OPTS + "modulus",modulus + "");
      Sampler sampler=SamplerFactory.newSampler(SamplerConfigurationImpl.newSamplerConfig(sampleConf),sampleConf);
      TestRFile trf=new TestRFile(sampleConf);
      trf.openWriter();
      for (int i=0; i < num; i++) {
        add(trf,nk(i,0),nv(i,0),dataHasher,sampleData,sampler);
        add(trf,nk(i,1),nv(i,1),dataHasher,sampleData,sampler);
      }
      HashCode expectedDataHash=dataHasher.hash();
      trf.closeWriter();
      trf.openReader();
      FileSKVIterator sample=trf.reader.getSample(SamplerConfigurationImpl.newSamplerConfig(sampleConf));
      checkSample(sample,sampleData);
      Assert.assertEquals(expectedDataHash,hash(trf.reader));
      SampleIE ie=new SampleIE(SamplerConfigurationImpl.newSamplerConfig(sampleConf).toSamplerConfiguration());
      for (int i=0; i < 3; i++) {
        trf.reader.closeDeepCopies();
        sample=trf.reader.getSample(SamplerConfigurationImpl.newSamplerConfig(sampleConf));
        SortedKeyValueIterator<Key,Value> sampleDC1=sample.deepCopy(ie);
        SortedKeyValueIterator<Key,Value> sampleDC2=sample.deepCopy(ie);
        SortedKeyValueIterator<Key,Value> sampleDC3=trf.reader.deepCopy(ie);
        SortedKeyValueIterator<Key,Value> allDC1=sampleDC1.deepCopy(new SampleIE(null));
        SortedKeyValueIterator<Key,Value> allDC2=sample.deepCopy(new SampleIE(null));
        Assert.assertEquals(expectedDataHash,hash(allDC1));
        Assert.assertEquals(expectedDataHash,hash(allDC2));
        checkSample(sample,sampleData);
        checkSample(sampleDC1,sampleData);
        checkSample(sampleDC2,sampleData);
        checkSample(sampleDC3,sampleData);
      }
      trf.reader.closeDeepCopies();
      trf.closeReader();
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test6() throws IOException {
  TestRFile trf=new TestRFile(conf);
  trf.openWriter();
  for (int i=0; i < 500; i++) {
    trf.writer.append(nk(nf("r_",i),"cf1","cq1","L1",55),nv("foo1"));
  }
  trf.closeWriter();
  trf.openReader();
  for (int i=0; i < 10; i++) {
    trf.seek(nk(nf("q_",i),"cf1","cq1","L1",55));
    assertTrue(trf.iter.hasTop());
    assertEquals(nk(nf("r_",0),"cf1","cq1","L1",55),trf.iter.getTopKey());
    assertEquals(nv("foo1"),trf.iter.getTopValue());
  }
  for (int i=0; i < 10; i++) {
    trf.seek(nk(nf("s_",i),"cf1","cq1","L1",55));
    assertFalse(trf.iter.hasTop());
  }
  assertEquals(nk(nf("r_",499),"cf1","cq1","L1",55),trf.reader.getLastKey());
  trf.closeReader();
}

</code></pre>

<br>
<pre class="type-13 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test17() throws IOException {
  TestRFile trf=new TestRFile(conf);
  trf.openWriter(false);
  trf.writer.startDefaultLocalityGroup();
  for (int i=0; i < 2048; i++) {
    trf.writer.append(nk("r0000","cf1","cq1","",1),nv("" + i));
  }
  for (int i=2048; i < 4096; i++) {
    trf.writer.append(nk("r0001","cf1","cq1","",1),nv("" + i));
  }
  trf.writer.close();
  trf.openReader();
  FileSKVIterator indexIter=trf.reader.getIndex();
  int count=0;
  while (indexIter.hasTop()) {
    count++;
    indexIter.next();
  }
  assertTrue(count > 4);
  trf.iter.seek(new Range(nk("r0000","cf1","cq1","",1),true,nk("r0001","cf1","cq1","",1),false),EMPTY_COL_FAMS,false);
  for (int i=0; i < 2048; i++) {
    assertTrue(trf.iter.hasTop());
    assertEquals(nk("r0000","cf1","cq1","",1),trf.iter.getTopKey());
    assertEquals(nv("" + i),trf.iter.getTopValue());
    trf.iter.next();
  }
  assertFalse(trf.iter.hasTop());
  trf.iter.seek(new Range(nk("r0000","cf1","cq1","",1),false,nk("r0001","cf1","cq1","",1),true),EMPTY_COL_FAMS,false);
  for (int i=2048; i < 4096; i++) {
    assertTrue(trf.iter.hasTop());
    assertEquals(nk("r0001","cf1","cq1","",1),trf.iter.getTopKey());
    assertEquals(nv("" + i),trf.iter.getTopValue());
    trf.iter.next();
  }
  assertFalse(trf.iter.hasTop());
  trf.iter.seek(new Range(nk("r0001","cf1","cq1","",1),true,nk("r0001","cf1","cq1","",1),true),EMPTY_COL_FAMS,false);
  for (int i=2048; i < 4096; i++) {
    assertTrue(trf.iter.hasTop());
    assertEquals(nk("r0001","cf1","cq1","",1),trf.iter.getTopKey());
    assertEquals(nv("" + i),trf.iter.getTopValue());
    trf.iter.next();
  }
  assertFalse(trf.iter.hasTop());
  trf.iter.seek(new Range(nk("r0002","cf1","cq1","",1),true,nk("r0002","cf1","cq1","",1),true),EMPTY_COL_FAMS,false);
  assertFalse(trf.iter.hasTop());
  trf.iter.seek(new Range((Key)null,null),EMPTY_COL_FAMS,false);
  for (int i=0; i < 2048; i++) {
    assertTrue(trf.iter.hasTop());
    assertEquals(nk("r0000","cf1","cq1","",1),trf.iter.getTopKey());
    assertEquals(nv("" + i),trf.iter.getTopValue());
    trf.iter.next();
  }
  for (int i=2048; i < 4096; i++) {
    assertTrue(trf.iter.hasTop());
    assertEquals(nk("r0001","cf1","cq1","",1),trf.iter.getTopKey());
    assertEquals(nv("" + i),trf.iter.getTopValue());
    trf.iter.next();
  }
  assertFalse(trf.iter.hasTop());
  trf.closeReader();
}

</code></pre>

<br>
<pre class="type-9 type-13 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReseekUnconsumed() throws Exception {
  TestRFile trf=new TestRFile(conf);
  trf.openWriter();
  for (int i=0; i < 2500; i++) {
    trf.writer.append(nk(nf("r_",i),"cf1","cq1","L1",42),nv("foo" + i));
  }
  trf.closeWriter();
  trf.openReader();
  Set<ByteSequence> cfs=Collections.emptySet();
  Random rand=new Random();
  for (int count=0; count < 100; count++) {
    int start=rand.nextInt(2300);
    Range range=new Range(nk(nf("r_",start),"cf1","cq1","L1",42),nk(nf("r_",start + 100),"cf1","cq1","L1",42));
    trf.reader.seek(range,cfs,false);
    int numToScan=rand.nextInt(100);
    for (int j=0; j < numToScan; j++) {
      assertTrue(trf.reader.hasTop());
      assertEquals(nk(nf("r_",start + j),"cf1","cq1","L1",42),trf.reader.getTopKey());
      trf.reader.next();
    }
    assertTrue(trf.reader.hasTop());
    assertEquals(nk(nf("r_",start + numToScan),"cf1","cq1","L1",42),trf.reader.getTopKey());
    int start2=start + numToScan + rand.nextInt(3);
    int end2=start2 + rand.nextInt(3);
    range=new Range(nk(nf("r_",start2),"cf1","cq1","L1",42),nk(nf("r_",end2),"cf1","cq1","L1",42));
    trf.reader.seek(range,cfs,false);
    for (int j=start2; j <= end2; j++) {
      assertTrue(trf.reader.hasTop());
      assertEquals(nk(nf("r_",j),"cf1","cq1","L1",42),trf.reader.getTopKey());
      trf.reader.next();
    }
    assertFalse(trf.reader.hasTop());
  }
  trf.closeReader();
}

</code></pre>

<br>
<pre class="type-13 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test8() throws IOException {
  TestRFile trf=new TestRFile(conf);
  trf.openWriter();
  for (int i=0; i < 2500; i++) {
    trf.writer.append(nk(nf("r_",i),"cf1","cq1","L1",42),nv("foo" + i));
  }
  trf.closeWriter();
  trf.openReader();
  for (int i=0; i < 2499; i++) {
    trf.seek(nk(nf("r_",i),"cf1","cq1","L1",42).followingKey(PartialKey.ROW));
    assertTrue(trf.iter.hasTop());
    assertEquals(nk(nf("r_",i + 1),"cf1","cq1","L1",42),trf.iter.getTopKey());
  }
  for (int i=0; i < 2499; i+=2) {
    trf.seek(nk(nf("r_",i),"cf1","cq1","L1",42).followingKey(PartialKey.ROW));
    assertTrue(trf.iter.hasTop());
    assertEquals(nk(nf("r_",i + 1),"cf1","cq1","L1",42),trf.iter.getTopKey());
  }
  for (int i=2498; i >= 0; i--) {
    trf.seek(nk(nf("r_",i),"cf1","cq1","L1",42).followingKey(PartialKey.ROW));
    assertTrue(trf.iter.hasTop());
    assertEquals(nk(nf("r_",i + 1),"cf1","cq1","L1",42),trf.iter.getTopKey());
  }
  trf.closeReader();
  trf=new TestRFile(conf);
  trf.openWriter();
  for (int i=0; i < 2500; i++) {
    trf.writer.append(nk(nf("r_",0),nf("cf_",i),"cq1","L1",42),nv("foo" + i));
  }
  trf.closeWriter();
  trf.openReader();
  for (int i=0; i < 2499; i++) {
    trf.seek(nk(nf("r_",0),nf("cf_",i),"cq1","L1",42).followingKey(PartialKey.ROW_COLFAM));
    assertTrue(trf.iter.hasTop());
    assertEquals(nk(nf("r_",0),nf("cf_",i + 1),"cq1","L1",42),trf.iter.getTopKey());
  }
  for (int i=0; i < 2499; i+=2) {
    trf.seek(nk(nf("r_",0),nf("cf_",i),"cq1","L1",42).followingKey(PartialKey.ROW_COLFAM));
    assertTrue(trf.iter.hasTop());
    assertEquals(nk(nf("r_",0),nf("cf_",i + 1),"cq1","L1",42),trf.iter.getTopKey());
  }
  for (int i=2498; i >= 0; i--) {
    trf.seek(nk(nf("r_",0),nf("cf_",i),"cq1","L1",42).followingKey(PartialKey.ROW_COLFAM));
    assertTrue(trf.iter.hasTop());
    assertEquals(nk(nf("r_",0),nf("cf_",i + 1),"cq1","L1",42),trf.iter.getTopKey());
  }
  trf.closeReader();
  trf=new TestRFile(conf);
  trf.openWriter();
  for (int i=0; i < 2500; i++) {
    trf.writer.append(nk(nf("r_",0),nf("cf_",0),nf("cq_",i),"L1",42),nv("foo" + i));
  }
  trf.closeWriter();
  trf.openReader();
  for (int i=0; i < 2499; i++) {
    trf.seek(nk(nf("r_",0),nf("cf_",0),nf("cq_",i),"L1",42).followingKey(PartialKey.ROW_COLFAM_COLQUAL));
    assertTrue(trf.iter.hasTop());
    assertEquals(nk(nf("r_",0),nf("cf_",0),nf("cq_",i + 1),"L1",42),trf.iter.getTopKey());
  }
  for (int i=0; i < 2499; i+=2) {
    trf.seek(nk(nf("r_",0),nf("cf_",0),nf("cq_",i),"L1",42).followingKey(PartialKey.ROW_COLFAM_COLQUAL));
    assertTrue(trf.iter.hasTop());
    assertEquals(nk(nf("r_",0),nf("cf_",0),nf("cq_",i + 1),"L1",42),trf.iter.getTopKey());
  }
  for (int i=2498; i >= 0; i--) {
    trf.seek(nk(nf("r_",0),nf("cf_",0),nf("cq_",i),"L1",42).followingKey(PartialKey.ROW_COLFAM_COLQUAL));
    assertTrue(trf.iter.hasTop());
    assertEquals(nk(nf("r_",0),nf("cf_",0),nf("cq_",i + 1),"L1",42),trf.iter.getTopKey());
  }
  trf.closeReader();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.iterators.aggregation.NumSummationTest </h4><pre class="type-13 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void test2(){
  try {
    NumArraySummation nas=new NumArraySummation();
    long[] la={1l,2l,3l};
    nas.collect(new Value(NumArraySummation.longArrayToBytes(la)));
    long[] la2={3l,2l,1l,0l};
    nas.collect(new Value(NumArraySummation.longArrayToBytes(la2)));
    la=NumArraySummation.bytesToLongArray(nas.aggregate().get());
    assertTrue(la.length == 4);
    for (int i=0; i < la.length - 1; i++) {
      assertTrue(la[i] == 4);
    }
    assertTrue(la[la.length - 1] == 0);
    nas.reset();
    la=NumArraySummation.bytesToLongArray(nas.aggregate().get());
    assertTrue(la.length == 0);
  }
 catch (  Exception e) {
    log.error("{}",e.getMessage(),e);
    assertTrue(false);
  }
}

</code></pre>

<br>
<pre class="type-13 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void test3(){
  try {
    NumArraySummation nas=new NumArraySummation();
    long[] la={Long.MAX_VALUE,Long.MIN_VALUE,3l,-5l,5l,5l};
    nas.collect(new Value(NumArraySummation.longArrayToBytes(la)));
    long[] la2={1l,-3l,2l,10l};
    nas.collect(new Value(NumArraySummation.longArrayToBytes(la2)));
    la=NumArraySummation.bytesToLongArray(nas.aggregate().get());
    assertTrue(la.length == 6);
    for (int i=2; i < la.length; i++) {
      assertTrue(la[i] == 5);
    }
    assertTrue("max long plus one was " + la[0],la[0] == Long.MAX_VALUE);
    assertTrue("min long minus 3 was " + la[1],la[1] == Long.MIN_VALUE);
  }
 catch (  Exception e) {
    assertTrue(false);
  }
}

</code></pre>

<br>
<pre class="type-9 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
"></span><br>
@Test public void test1(){
  try {
    long[] la={1l,2l,3l};
    byte[] b=NumArraySummation.longArrayToBytes(la);
    long[] la2=NumArraySummation.bytesToLongArray(b);
    assertTrue(la.length == la2.length);
    for (int i=0; i < la.length; i++) {
      assertTrue(i + ": " + la[i]+ " does not equal "+ la2[i],la[i] == la2[i]);
    }
  }
 catch (  Exception e) {
    assertTrue(false);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.iterators.user.IntersectingIteratorTest </h4><pre class="type-13 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void test2() throws IOException {
  columnFamilies=new Text[3];
  columnFamilies[0]=new Text("A");
  columnFamilies[1]=new Text("E");
  columnFamilies[2]=new Text("G");
  otherColumnFamilies=new Text[4];
  otherColumnFamilies[0]=new Text("B");
  otherColumnFamilies[1]=new Text("C");
  otherColumnFamilies[2]=new Text("D");
  otherColumnFamilies[3]=new Text("F");
  float hitRatio=0.5f;
  SortedKeyValueIterator<Key,Value> source=createIteratorStack(hitRatio,NUM_ROWS,NUM_DOCIDS,columnFamilies,otherColumnFamilies,docs);
  IteratorSetting is=new IteratorSetting(1,IntersectingIterator.class);
  IntersectingIterator.setColumnFamilies(is,columnFamilies);
  IntersectingIterator iter=new IntersectingIterator();
  iter.init(source,is.getOptions(),env);
  iter.seek(new Range(),EMPTY_COL_FAMS,false);
  int hitCount=0;
  while (iter.hasTop()) {
    hitCount++;
    Key k=iter.getTopKey();
    assertTrue(docs.contains(k.getColumnQualifier()));
    iter.next();
  }
  assertTrue(hitCount == docs.size());
  cleanup();
}

</code></pre>

<br>
<pre class="type-13 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void test6() throws IOException {
  columnFamilies=new Text[1];
  columnFamilies[0]=new Text("C");
  otherColumnFamilies=new Text[4];
  otherColumnFamilies[0]=new Text("A");
  otherColumnFamilies[1]=new Text("B");
  otherColumnFamilies[2]=new Text("D");
  otherColumnFamilies[3]=new Text("F");
  float hitRatio=0.5f;
  SortedKeyValueIterator<Key,Value> source=createIteratorStack(hitRatio,NUM_ROWS,NUM_DOCIDS,columnFamilies,otherColumnFamilies,docs);
  IteratorSetting is=new IteratorSetting(1,IntersectingIterator.class);
  IntersectingIterator.setColumnFamilies(is,columnFamilies);
  IntersectingIterator iter=new IntersectingIterator();
  iter.init(source,is.getOptions(),env);
  iter.seek(new Range(),EMPTY_COL_FAMS,false);
  int hitCount=0;
  while (iter.hasTop()) {
    hitCount++;
    Key k=iter.getTopKey();
    assertTrue(docs.contains(k.getColumnQualifier()));
    iter.next();
  }
  assertTrue(hitCount == docs.size());
  cleanup();
}

</code></pre>

<br>
<pre class="type-13 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void test3() throws IOException {
  columnFamilies=new Text[6];
  columnFamilies[0]=new Text("C");
  columnFamilies[1]=new Text("E");
  columnFamilies[2]=new Text("G");
  columnFamilies[3]=new Text("H");
  columnFamilies[4]=new Text("I");
  columnFamilies[5]=new Text("J");
  otherColumnFamilies=new Text[4];
  otherColumnFamilies[0]=new Text("A");
  otherColumnFamilies[1]=new Text("B");
  otherColumnFamilies[2]=new Text("D");
  otherColumnFamilies[3]=new Text("F");
  float hitRatio=0.5f;
  SortedKeyValueIterator<Key,Value> source=createIteratorStack(hitRatio,NUM_ROWS,NUM_DOCIDS,columnFamilies,otherColumnFamilies,docs);
  SortedKeyValueIterator<Key,Value> source2=createIteratorStack(hitRatio,NUM_ROWS,NUM_DOCIDS,columnFamilies,otherColumnFamilies,docs);
  ArrayList<SortedKeyValueIterator<Key,Value>> sourceIters=new ArrayList<SortedKeyValueIterator<Key,Value>>();
  sourceIters.add(source);
  sourceIters.add(source2);
  MultiIterator mi=new MultiIterator(sourceIters,false);
  IteratorSetting is=new IteratorSetting(1,IntersectingIterator.class);
  IntersectingIterator.setColumnFamilies(is,columnFamilies);
  IntersectingIterator iter=new IntersectingIterator();
  iter.init(mi,is.getOptions(),env);
  iter.seek(new Range(),EMPTY_COL_FAMS,false);
  int hitCount=0;
  while (iter.hasTop()) {
    hitCount++;
    Key k=iter.getTopKey();
    assertTrue(docs.contains(k.getColumnQualifier()));
    iter.next();
  }
  assertTrue(hitCount == docs.size());
  cleanup();
}

</code></pre>

<br>
<pre class="type-13 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void test4() throws IOException {
  columnFamilies=new Text[3];
  notFlags=new boolean[3];
  columnFamilies[0]=new Text("A");
  notFlags[0]=true;
  columnFamilies[1]=new Text("E");
  notFlags[1]=false;
  columnFamilies[2]=new Text("G");
  notFlags[2]=true;
  negatedColumns=new Text[2];
  negatedColumns[0]=new Text("A");
  negatedColumns[1]=new Text("G");
  otherColumnFamilies=new Text[4];
  otherColumnFamilies[0]=new Text("B");
  otherColumnFamilies[1]=new Text("C");
  otherColumnFamilies[2]=new Text("D");
  otherColumnFamilies[3]=new Text("F");
  float hitRatio=0.5f;
  SortedKeyValueIterator<Key,Value> source=createIteratorStack(hitRatio,NUM_ROWS,NUM_DOCIDS,columnFamilies,otherColumnFamilies,docs,negatedColumns);
  IteratorSetting is=new IteratorSetting(1,IntersectingIterator.class);
  IntersectingIterator.setColumnFamilies(is,columnFamilies,notFlags);
  IntersectingIterator iter=new IntersectingIterator();
  iter.init(source,is.getOptions(),env);
  iter.seek(new Range(),EMPTY_COL_FAMS,false);
  int hitCount=0;
  while (iter.hasTop()) {
    hitCount++;
    Key k=iter.getTopKey();
    assertTrue(docs.contains(k.getColumnQualifier()));
    iter.next();
  }
  assertTrue(hitCount == docs.size());
  cleanup();
}

</code></pre>

<br>
<pre class="type-13 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void test1() throws IOException {
  columnFamilies=new Text[2];
  columnFamilies[0]=new Text("C");
  columnFamilies[1]=new Text("E");
  otherColumnFamilies=new Text[4];
  otherColumnFamilies[0]=new Text("A");
  otherColumnFamilies[1]=new Text("B");
  otherColumnFamilies[2]=new Text("D");
  otherColumnFamilies[3]=new Text("F");
  float hitRatio=0.5f;
  SortedKeyValueIterator<Key,Value> source=createIteratorStack(hitRatio,NUM_ROWS,NUM_DOCIDS,columnFamilies,otherColumnFamilies,docs);
  IteratorSetting is=new IteratorSetting(1,IntersectingIterator.class);
  IntersectingIterator.setColumnFamilies(is,columnFamilies);
  IntersectingIterator iter=new IntersectingIterator();
  iter.init(source,is.getOptions(),env);
  iter.seek(new Range(),EMPTY_COL_FAMS,false);
  int hitCount=0;
  while (iter.hasTop()) {
    hitCount++;
    Key k=iter.getTopKey();
    assertTrue(docs.contains(k.getColumnQualifier()));
    iter.next();
  }
  assertTrue(hitCount == docs.size());
  cleanup();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.iterators.user.RowFilterTest </h4><pre class="type-13 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void deepCopyCopiesTheSource() throws Exception {
  SortedMapIterator source=new SortedMapIterator(createKeyValues());
  RowFilter filter=new RowZeroOrOneFilter();
  filter.init(source,Collections.<String,String>emptyMap(),new DefaultIteratorEnvironment());
  filter.seek(new Range(),Collections.<ByteSequence>emptySet(),false);
  Key firstKey=filter.getTopKey();
  Value firstValue=filter.getTopValue();
  assertEquals("0",firstKey.getRow().toString());
  Key lastKeyRead=null;
  for (int i=0; i < 5; i++) {
    filter.next();
    lastKeyRead=filter.getTopKey();
    assertEquals("0",lastKeyRead.getRow().toString());
  }
  RowFilter copy=(RowFilter)filter.deepCopy(new DefaultIteratorEnvironment());
  copy.seek(new Range(),Collections.<ByteSequence>emptySet(),false);
  assertTrue("deepCopy'ed RowFilter did not have a top key",copy.hasTop());
  Key firstKeyFromCopy=copy.getTopKey();
  Value firstValueFromCopy=copy.getTopValue();
  assertEquals(firstKey,firstKeyFromCopy);
  assertEquals(firstValue,firstValueFromCopy);
  filter.next();
  Key finalKeyRead=filter.getTopKey();
  assertTrue("Expected next key read to be greater than the previous after deepCopy",lastKeyRead.compareTo(finalKeyRead) < 0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.iterators.user.TestCfCqSlice </h4><pre class="type-13 type-11 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
"></span><br>
@Test public void testAllCfsCqSlice() throws Exception {
  boolean[][][] foundKvs=new boolean[LR_DIM][LR_DIM][LR_DIM];
  long sliceMinCq=10;
  long sliceMaxCq=30;
  Map<String,String> opts=new HashMap<String,String>();
  opts.put(CfCqSliceOpts.OPT_MIN_CQ,new String(LONG_LEX.encode(sliceMinCq),UTF_8));
  opts.put(CfCqSliceOpts.OPT_MAX_CQ,new String(LONG_LEX.encode(sliceMaxCq),UTF_8));
  loadKvs(foundKvs,opts,INFINITY);
  for (int i=0; i < LR_DIM; i++) {
    for (int j=0; j < LR_DIM; j++) {
      for (int k=0; k < LR_DIM; k++) {
        if (k >= sliceMinCq && k <= sliceMaxCq) {
          assertTrue("(r, cf, cq) == (" + i + ", "+ j+ ", "+ k+ ") must be found in scan",foundKvs[i][j][k]);
        }
 else {
          assertFalse("(r, cf, cq) == (" + i + ", "+ j+ ", "+ k+ ") must not be found in scan",foundKvs[i][j][k]);
        }
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-11 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
"></span><br>
@Test public void testSingleRowFullSlice() throws Exception {
  boolean[][][] foundKvs=new boolean[LR_DIM][LR_DIM][LR_DIM];
  int rowId=LR_DIM / 2;
  loadKvs(foundKvs,EMPTY_OPTS,Range.exact(new Text(LONG_LEX.encode((long)rowId))));
  for (int i=0; i < LR_DIM; i++) {
    for (int j=0; j < LR_DIM; j++) {
      for (int k=0; k < LR_DIM; k++) {
        if (rowId == i) {
          assertTrue("(r, cf, cq) == (" + i + ", "+ j+ ", "+ k+ ") must be found in scan",foundKvs[i][j][k]);
        }
 else {
          assertFalse("(r, cf, cq) == (" + i + ", "+ j+ ", "+ k+ ") must not be found in scan",foundKvs[i][j][k]);
        }
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-11 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
"></span><br>
@Test public void testSeekMinExclusive() throws Exception {
  boolean[][][] foundKvs=new boolean[LR_DIM][LR_DIM][LR_DIM];
  long sliceMinCf=20;
  long sliceMinCq=30;
  long sliceMaxCf=25;
  long sliceMaxCq=35;
  assertTrue("slice param must be less than LR_DIM",sliceMinCf < LR_DIM);
  assertTrue("slice param must be less than LR_DIM",sliceMinCq < LR_DIM);
  assertTrue("slice param must be less than LR_DIM",sliceMaxCf < LR_DIM);
  assertTrue("slice param must be less than LR_DIM",sliceMaxCq < LR_DIM);
  Map<String,String> opts=new HashMap<>();
  opts.put(CfCqSliceOpts.OPT_MIN_CF,new String(LONG_LEX.encode(sliceMinCf),UTF_8));
  opts.put(CfCqSliceOpts.OPT_MIN_INCLUSIVE,"false");
  opts.put(CfCqSliceOpts.OPT_MIN_CQ,new String(LONG_LEX.encode(sliceMinCq),UTF_8));
  opts.put(CfCqSliceOpts.OPT_MAX_CF,new String(LONG_LEX.encode(sliceMaxCf),UTF_8));
  opts.put(CfCqSliceOpts.OPT_MAX_CQ,new String(LONG_LEX.encode(sliceMaxCq),UTF_8));
  Range startsAtMinCf=new Range(new Key(LONG_LEX.encode(0l),LONG_LEX.encode(sliceMinCf),LONG_LEX.encode(sliceMinCq),new byte[]{},Long.MAX_VALUE),null);
  loadKvs(foundKvs,opts,startsAtMinCf);
  for (int i=0; i < LR_DIM; i++) {
    for (int j=0; j < LR_DIM; j++) {
      for (int k=0; k < LR_DIM; k++) {
        if (j > sliceMinCf && j <= sliceMaxCf && k > sliceMinCq && k <= sliceMaxCq) {
          assertTrue("(r, cf, cq) == (" + i + ", "+ j+ ", "+ k+ ") must be found in scan",foundKvs[i][j][k]);
        }
 else {
          assertFalse("(r, cf, cq) == (" + i + ", "+ j+ ", "+ k+ ") must not be found in scan",foundKvs[i][j][k]);
        }
      }
    }
  }
  foundKvs=new boolean[LR_DIM][LR_DIM][LR_DIM];
  sliceMinCq=0;
  sliceMaxCq=10;
  opts.put(CfCqSliceOpts.OPT_MIN_CF,new String(LONG_LEX.encode(sliceMinCf),UTF_8));
  opts.put(CfCqSliceOpts.OPT_MIN_INCLUSIVE,"false");
  opts.put(CfCqSliceOpts.OPT_MIN_CQ,new String(LONG_LEX.encode(sliceMinCq),UTF_8));
  opts.put(CfCqSliceOpts.OPT_MAX_CF,new String(LONG_LEX.encode(sliceMaxCf),UTF_8));
  opts.put(CfCqSliceOpts.OPT_MAX_CQ,new String(LONG_LEX.encode(sliceMaxCq),UTF_8));
  loadKvs(foundKvs,opts,INFINITY);
  for (int i=0; i < LR_DIM; i++) {
    for (int j=0; j < LR_DIM; j++) {
      for (int k=0; k < LR_DIM; k++) {
        if (j > sliceMinCf && j <= sliceMaxCf && k > sliceMinCq && k <= sliceMaxCq) {
          assertTrue("(r, cf, cq) == (" + i + ", "+ j+ ", "+ k+ ") must be found in scan",foundKvs[i][j][k]);
        }
 else {
          assertFalse("(r, cf, cq) == (" + i + ", "+ j+ ", "+ k+ ") must not be found in scan",foundKvs[i][j][k]);
        }
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-11 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
"></span><br>
@Test public void testStackedFilters() throws Exception {
  Map<String,String> firstOpts=new HashMap<>();
  Map<String,String> secondOpts=new HashMap<>();
  boolean[][][] foundKvs=new boolean[LR_DIM][LR_DIM][LR_DIM];
  long sliceMinCf=20;
  long sliceMaxCf=25;
  long sliceMinCq=30;
  long sliceMaxCq=35;
  assertTrue("slice param must be less than LR_DIM",sliceMinCf < LR_DIM);
  assertTrue("slice param must be less than LR_DIM",sliceMinCq < LR_DIM);
  assertTrue("slice param must be less than LR_DIM",sliceMaxCf < LR_DIM);
  assertTrue("slice param must be less than LR_DIM",sliceMaxCq < LR_DIM);
  firstOpts.put(CfCqSliceOpts.OPT_MIN_CF,new String(LONG_LEX.encode(sliceMinCf),UTF_8));
  firstOpts.put(CfCqSliceOpts.OPT_MAX_CF,new String(LONG_LEX.encode(sliceMaxCf),UTF_8));
  secondOpts.put(CfCqSliceOpts.OPT_MIN_CQ,new String(LONG_LEX.encode(sliceMinCq),UTF_8));
  secondOpts.put(CfCqSliceOpts.OPT_MAX_CQ,new String(LONG_LEX.encode(sliceMaxCq),UTF_8));
  SortedKeyValueIterator<Key,Value> skvi=getFilterClass().newInstance();
  skvi.init(new SortedMapIterator(data),firstOpts,null);
  loadKvs(skvi.deepCopy(null),foundKvs,secondOpts,INFINITY);
  for (int i=0; i < LR_DIM; i++) {
    for (int j=0; j < LR_DIM; j++) {
      for (int k=0; k < LR_DIM; k++) {
        if (j >= sliceMinCf && j <= sliceMaxCf && k >= sliceMinCq && k <= sliceMaxCq) {
          assertTrue("(r, cf, cq) == (" + i + ", "+ j+ ", "+ k+ ") must be found in scan",foundKvs[i][j][k]);
        }
 else {
          assertFalse("(r, cf, cq) == (" + i + ", "+ j+ ", "+ k+ ") must not be found in scan",foundKvs[i][j][k]);
        }
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-11 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
"></span><br>
@Test public void testSliceCfsAllCqs() throws Exception {
  boolean[][][] foundKvs=new boolean[LR_DIM][LR_DIM][LR_DIM];
  long sliceMinCf=10;
  long sliceMaxCf=30;
  Map<String,String> opts=new HashMap<String,String>();
  opts.put(CfCqSliceOpts.OPT_MIN_CF,new String(LONG_LEX.encode(sliceMinCf),UTF_8));
  opts.put(CfCqSliceOpts.OPT_MAX_CF,new String(LONG_LEX.encode(sliceMaxCf),UTF_8));
  loadKvs(foundKvs,opts,INFINITY);
  for (int i=0; i < LR_DIM; i++) {
    for (int j=0; j < LR_DIM; j++) {
      for (int k=0; k < LR_DIM; k++) {
        if (j >= sliceMinCf && j <= sliceMaxCf) {
          assertTrue("(r, cf, cq) == (" + i + ", "+ j+ ", "+ k+ ") must be found in scan",foundKvs[i][j][k]);
        }
 else {
          assertFalse("(r, cf, cq) == (" + i + ", "+ j+ ", "+ k+ ") must not be found in scan",foundKvs[i][j][k]);
        }
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
"></span><br>
@Test public void testEmptySlice() throws Exception {
  boolean[][][] foundKvs=new boolean[LR_DIM][LR_DIM][LR_DIM];
  long sliceMinCf=LR_DIM + 1;
  long sliceMinCq=LR_DIM + 1;
  long sliceMaxCf=LR_DIM + 1;
  long sliceMaxCq=LR_DIM + 1;
  Map<String,String> opts=new HashMap<String,String>();
  opts.put(CfCqSliceOpts.OPT_MIN_CF,new String(LONG_LEX.encode(sliceMinCf),UTF_8));
  opts.put(CfCqSliceOpts.OPT_MIN_CQ,new String(LONG_LEX.encode(sliceMinCq),UTF_8));
  opts.put(CfCqSliceOpts.OPT_MAX_CF,new String(LONG_LEX.encode(sliceMaxCf),UTF_8));
  opts.put(CfCqSliceOpts.OPT_MAX_CQ,new String(LONG_LEX.encode(sliceMaxCq),UTF_8));
  opts.put(CfCqSliceOpts.OPT_MAX_INCLUSIVE,"false");
  opts.put(CfCqSliceOpts.OPT_MIN_INCLUSIVE,"false");
  loadKvs(foundKvs,opts,INFINITY);
  for (int i=0; i < LR_DIM; i++) {
    for (int j=0; j < LR_DIM; j++) {
      for (int k=0; k < LR_DIM; k++) {
        assertFalse("(r, cf, cq) == (" + i + ", "+ j+ ", "+ k+ ") must not be found in scan",foundKvs[i][j][k]);
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-11 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
"></span><br>
@Test public void testAllRowsSlice() throws Exception {
  boolean[][][] foundKvs=new boolean[LR_DIM][LR_DIM][LR_DIM];
  long sliceMinCf=20;
  long sliceMinCq=30;
  long sliceMaxCf=25;
  long sliceMaxCq=35;
  assertTrue("slice param must be less than LR_DIM",sliceMinCf < LR_DIM);
  assertTrue("slice param must be less than LR_DIM",sliceMinCq < LR_DIM);
  assertTrue("slice param must be less than LR_DIM",sliceMaxCf < LR_DIM);
  assertTrue("slice param must be less than LR_DIM",sliceMaxCq < LR_DIM);
  Map<String,String> opts=new HashMap<String,String>();
  opts.put(CfCqSliceOpts.OPT_MIN_CF,new String(LONG_LEX.encode(sliceMinCf),UTF_8));
  opts.put(CfCqSliceOpts.OPT_MIN_CQ,new String(LONG_LEX.encode(sliceMinCq),UTF_8));
  opts.put(CfCqSliceOpts.OPT_MAX_CF,new String(LONG_LEX.encode(sliceMaxCf),UTF_8));
  opts.put(CfCqSliceOpts.OPT_MAX_CQ,new String(LONG_LEX.encode(sliceMaxCq),UTF_8));
  loadKvs(foundKvs,opts,INFINITY);
  for (int i=0; i < LR_DIM; i++) {
    for (int j=0; j < LR_DIM; j++) {
      for (int k=0; k < LR_DIM; k++) {
        if (j >= sliceMinCf && j <= sliceMaxCf && k >= sliceMinCq && k <= sliceMaxCq) {
          assertTrue("(r, cf, cq) == (" + i + ", "+ j+ ", "+ k+ ") must be found in scan",foundKvs[i][j][k]);
        }
 else {
          assertFalse("(r, cf, cq) == (" + i + ", "+ j+ ", "+ k+ ") must not be found in scan",foundKvs[i][j][k]);
        }
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-11 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
"></span><br>
@Test public void testSingleColumnSliceByExclude() throws Exception {
  boolean[][][] foundKvs=new boolean[LR_DIM][LR_DIM][LR_DIM];
  long sliceMinCf=20;
  long sliceMinCq=20;
  long sliceMaxCf=22;
  long sliceMaxCq=22;
  Map<String,String> opts=new HashMap<String,String>();
  opts.put(CfCqSliceOpts.OPT_MIN_CF,new String(LONG_LEX.encode(sliceMinCf),UTF_8));
  opts.put(CfCqSliceOpts.OPT_MIN_CQ,new String(LONG_LEX.encode(sliceMinCq),UTF_8));
  opts.put(CfCqSliceOpts.OPT_MAX_CF,new String(LONG_LEX.encode(sliceMaxCf),UTF_8));
  opts.put(CfCqSliceOpts.OPT_MAX_CQ,new String(LONG_LEX.encode(sliceMaxCq),UTF_8));
  opts.put(CfCqSliceOpts.OPT_MAX_INCLUSIVE,"false");
  opts.put(CfCqSliceOpts.OPT_MIN_INCLUSIVE,"false");
  loadKvs(foundKvs,opts,INFINITY);
  for (int i=0; i < LR_DIM; i++) {
    for (int j=0; j < LR_DIM; j++) {
      for (int k=0; k < LR_DIM; k++) {
        if (j == 21 && k == 21) {
          assertTrue("(r, cf, cq) == (" + i + ", "+ j+ ", "+ k+ ") must be found in scan",foundKvs[i][j][k]);
        }
 else {
          assertFalse("(r, cf, cq) == (" + i + ", "+ j+ ", "+ k+ ") must not be found in scan",foundKvs[i][j][k]);
        }
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
"></span><br>
@Test public void testAllRowsFullSlice() throws Exception {
  boolean[][][] foundKvs=new boolean[LR_DIM][LR_DIM][LR_DIM];
  loadKvs(foundKvs,EMPTY_OPTS,INFINITY);
  for (int i=0; i < LR_DIM; i++) {
    for (int j=0; j < LR_DIM; j++) {
      for (int k=0; k < LR_DIM; k++) {
        assertTrue("(r, cf, cq) == (" + i + ", "+ j+ ", "+ k+ ") must be found in scan",foundKvs[i][j][k]);
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-13 type-11 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
"></span><br>
@Test public void testSingleColumnSlice() throws Exception {
  boolean[][][] foundKvs=new boolean[LR_DIM][LR_DIM][LR_DIM];
  long sliceMinCf=20;
  long sliceMinCq=20;
  long sliceMaxCf=20;
  long sliceMaxCq=20;
  Map<String,String> opts=new HashMap<String,String>();
  opts.put(CfCqSliceOpts.OPT_MIN_CF,new String(LONG_LEX.encode(sliceMinCf),UTF_8));
  opts.put(CfCqSliceOpts.OPT_MIN_CQ,new String(LONG_LEX.encode(sliceMinCq),UTF_8));
  opts.put(CfCqSliceOpts.OPT_MAX_CF,new String(LONG_LEX.encode(sliceMaxCf),UTF_8));
  opts.put(CfCqSliceOpts.OPT_MAX_CQ,new String(LONG_LEX.encode(sliceMaxCq),UTF_8));
  loadKvs(foundKvs,opts,INFINITY);
  for (int i=0; i < LR_DIM; i++) {
    for (int j=0; j < LR_DIM; j++) {
      for (int k=0; k < LR_DIM; k++) {
        if (j == sliceMinCf && k == sliceMinCq) {
          assertTrue("(r, cf, cq) == (" + i + ", "+ j+ ", "+ k+ ") must be found in scan",foundKvs[i][j][k]);
        }
 else {
          assertFalse("(r, cf, cq) == (" + i + ", "+ j+ ", "+ k+ ") must not be found in scan",foundKvs[i][j][k]);
        }
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.iterators.user.TransformingIteratorTest </h4><pre class="type-13 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDupes() throws Exception {
  setUpTransformIterator(DupeTransformingIterator.class);
  titer.seek(new Range(),new HashSet<ByteSequence>(),false);
  int count=0;
  while (titer.hasTop()) {
    Key key=titer.getTopKey();
    titer.next();
    assertEquals("cf1",key.getColumnFamily().toString());
    assertEquals("cq1",key.getColumnQualifier().toString());
    assertEquals("",key.getColumnVisibility().toString());
    assertEquals(5l,key.getTimestamp());
    count++;
  }
  assertEquals(81,count);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.iterators.user.VersioningIteratorTest </h4><pre class="type-9 type-13 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void test4(){
  Text colf=new Text("a");
  Text colq=new Text("b");
  TreeMap<Key,Value> tm=new TreeMap<Key,Value>();
  createTestData(tm,colf,colq);
  for (int i=1; i <= 30; i++) {
    try {
      VersioningIterator it=new VersioningIterator();
      IteratorSetting is=new IteratorSetting(1,VersioningIterator.class);
      VersioningIterator.setMaxVersions(is,i);
      it.init(new SortedMapIterator(tm),is.getOptions(),null);
      it.seek(new Range(),EMPTY_COL_FAMS,false);
      TreeMap<Key,Value> tmOut=iteratorOverTestData(it);
      assertTrue("size after keeping " + i + " versions was "+ tmOut.size(),tmOut.size() == Math.min(40,2 * i));
    }
 catch (    IOException e) {
      assertFalse(true);
    }
catch (    Exception e) {
      log.error("{}",e.getMessage(),e);
      assertFalse(true);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.replication.ReplicationSchemaTest </h4><pre class="type-9 type-13 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void separatorDoesntInterferWithSplit(){
  Text buff=new Text();
  for (long i=1; i < 258; i++) {
    Mutation m=OrderSection.createMutation("/accumulo/file",i);
    Key k=new Key(new Text(m.getRow()));
    Assert.assertEquals("/accumulo/file",OrderSection.getFile(k,buff));
    Assert.assertEquals(i,OrderSection.getTimeClosed(k,buff));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.security.crypto.BlockedIOStreamTest </h4><pre class="type-9 type-13 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGiantWrite() throws IOException {
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  int blockSize=16;
  BlockedOutputStream blockOut=new BlockedOutputStream(baos,blockSize,blockSize);
  Random r=new Random(22);
  int size=1024 * 1024 * 128;
  byte[] giant=new byte[size];
  byte[] pattern=new byte[1024];
  r.nextBytes(pattern);
  for (int i=0; i < size / 1024; i++) {
    System.arraycopy(pattern,0,giant,i * 1024,1024);
  }
  blockOut.write(giant);
  blockOut.flush();
  blockOut.close();
  baos.close();
  int blocks=(int)Math.ceil(size / (blockSize - 4.0));
  byte[] byteStream=baos.toByteArray();
  assertEquals(blocks * 16,byteStream.length);
  DataInputStream blockIn=new DataInputStream(new BlockedInputStream(new ByteArrayInputStream(byteStream),blockSize,blockSize));
  Arrays.fill(giant,(byte)0);
  blockIn.readFully(giant,0,size);
  blockIn.close();
  for (int i=0; i < size / 1024; i++) {
    byte[] readChunk=new byte[1024];
    System.arraycopy(giant,i * 1024,readChunk,0,1024);
    assertArrayEquals(pattern,readChunk);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.fate.zookeeper.RetryTest </h4><pre class="type-13 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void retriesAreCompleted(){
  for (int i=0; i < maxRetries; i++) {
    Assert.assertEquals(i,retry.retriesCompleted());
    retry.canRetry();
    Assert.assertEquals(i,retry.retriesCompleted());
    retry.useRetry();
    Assert.assertEquals(i + 1,retry.retriesCompleted());
  }
}

</code></pre>

<br>
<pre class="type-13 type-5 type-3 type-10 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=IllegalStateException.class) public void usingNonExistentRetryFails(){
  for (int i=0; i < maxRetries; i++) {
    Assert.assertTrue(retry.canRetry());
    retry.useRetry();
  }
  Assert.assertFalse(retry.canRetry());
  retry.useRetry();
}

</code></pre>

<br>
<pre class="type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
"></span><br>
@Test public void canRetryDoesntAlterState(){
  for (int i=0; i < maxRetries + 1; i++) {
    Assert.assertTrue(retry.canRetry());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.monitor.ZooKeeperStatusTest </h4><pre class="type-13 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void zkHostSortingTest(){
  List<String> expectedHosts=Arrays.asList("rack1node1","rack2node1","rack4node1","rack4node4");
  TreeSet<ZooKeeperState> states=new TreeSet<ZooKeeperState>();
  states.add(new ZooKeeperState("rack4node4","leader",10));
  states.add(new ZooKeeperState("rack4node1","follower",10));
  states.add(new ZooKeeperState("rack1node1","follower",10));
  states.add(new ZooKeeperState("rack2node1","follower",10));
  List<String> actualHosts=new ArrayList<String>(4);
  for (  ZooKeeperState state : states) {
    actualHosts.add(state.keeper);
  }
  Assert.assertEquals(expectedHosts.size(),actualHosts.size());
  for (int i=0; i < expectedHosts.size(); i++) {
    Assert.assertEquals(expectedHosts.get(i),actualHosts.get(i));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.ConditionalWriterIT </h4><pre class="type-9 type-13 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testThreads() throws Exception {
  String table=getUniqueNames(1)[0];
  Connector conn=getConnector();
  conn.tableOperations().create(table);
  Random rand=new Random();
switch (rand.nextInt(3)) {
case 1:
    conn.tableOperations().addSplits(table,nss("4"));
  break;
case 2:
conn.tableOperations().addSplits(table,nss("3","5"));
break;
}
ConditionalWriter cw=conn.createConditionalWriter(table,new ConditionalWriterConfig());
ArrayList<ByteSequence> rows=new ArrayList<ByteSequence>();
for (int i=0; i < 1000; i++) {
rows.add(new ArrayByteSequence(FastFormat.toZeroPaddedString(abs(rand.nextLong()),16,16,new byte[0])));
}
ArrayList<ConditionalMutation> mutations=new ArrayList<ConditionalMutation>();
for (ByteSequence row : rows) mutations.add(new Stats(row).toMutation());
ArrayList<ByteSequence> rows2=new ArrayList<ByteSequence>();
Iterator<Result> results=cw.write(mutations.iterator());
while (results.hasNext()) {
Result result=results.next();
Assert.assertEquals(Status.ACCEPTED,result.getStatus());
rows2.add(new ArrayByteSequence(result.getMutation().getRow()));
}
Collections.sort(rows);
Collections.sort(rows2);
Assert.assertEquals(rows,rows2);
AtomicBoolean failed=new AtomicBoolean(false);
ExecutorService tp=Executors.newFixedThreadPool(5);
for (int i=0; i < 5; i++) {
tp.submit(new MutatorTask(table,conn,rows,cw,failed));
}
tp.shutdown();
while (!tp.isTerminated()) {
tp.awaitTermination(1,TimeUnit.MINUTES);
}
Assert.assertFalse("A MutatorTask failed with an exception",failed.get());
Scanner scanner=conn.createScanner(table,Authorizations.EMPTY);
RowIterator rowIter=new RowIterator(scanner);
while (rowIter.hasNext()) {
Iterator<Entry<Key,Value>> row=rowIter.next();
new Stats(row);
}
}

</code></pre>

<br>
<pre class="type-9 type-13 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBigBatch() throws Exception {
  Connector conn=getConnector();
  String tableName=getUniqueNames(1)[0];
  conn.tableOperations().create(tableName);
  conn.tableOperations().addSplits(tableName,nss("2","4","6"));
  sleepUninterruptibly(2,TimeUnit.SECONDS);
  int num=100;
  ArrayList<byte[]> rows=new ArrayList<byte[]>(num);
  ArrayList<ConditionalMutation> cml=new ArrayList<ConditionalMutation>(num);
  Random r=new Random();
  byte[] e=new byte[0];
  for (int i=0; i < num; i++) {
    rows.add(FastFormat.toZeroPaddedString(abs(r.nextLong()),16,16,e));
  }
  for (int i=0; i < num; i++) {
    ConditionalMutation cm=new ConditionalMutation(rows.get(i),new Condition("meta","seq"));
    cm.put("meta","seq","1");
    cm.put("meta","tx",UUID.randomUUID().toString());
    cml.add(cm);
  }
  ConditionalWriter cw=conn.createConditionalWriter(tableName,new ConditionalWriterConfig());
  Iterator<Result> results=cw.write(cml.iterator());
  int count=0;
  while (results.hasNext()) {
    Result result=results.next();
    Assert.assertEquals(Status.ACCEPTED,result.getStatus());
    count++;
  }
  Assert.assertEquals("Did not receive the expected number of results",num,count);
  ArrayList<ConditionalMutation> cml2=new ArrayList<ConditionalMutation>(num);
  for (int i=0; i < num; i++) {
    ConditionalMutation cm=new ConditionalMutation(rows.get(i),new Condition("meta","seq").setValue("1"));
    cm.put("meta","seq","2");
    cm.put("meta","tx",UUID.randomUUID().toString());
    cml2.add(cm);
  }
  count=0;
  results=cw.write(cml2.iterator());
  while (results.hasNext()) {
    Result result=results.next();
    Assert.assertEquals(Status.ACCEPTED,result.getStatus());
    count++;
  }
  Assert.assertEquals("Did not receive the expected number of results",num,count);
  cw.close();
}

</code></pre>

<br>
<pre class="type-9 type-13 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTableAndConditionIterators() throws Exception {
  Connector conn=getConnector();
  String tableName=getUniqueNames(1)[0];
  IteratorSetting aiConfig1=new IteratorSetting(30,"AI1",AddingIterator.class);
  aiConfig1.addOption("amount","2");
  IteratorSetting aiConfig2=new IteratorSetting(35,"MI1",MultiplyingIterator.class);
  aiConfig2.addOption("amount","3");
  IteratorSetting aiConfig3=new IteratorSetting(40,"AI2",AddingIterator.class);
  aiConfig3.addOption("amount","5");
  conn.tableOperations().create(tableName);
  BatchWriter bw=conn.createBatchWriter(tableName,new BatchWriterConfig());
  Mutation m=new Mutation("ACCUMULO-1000");
  m.put("count","comments","6");
  bw.addMutation(m);
  m=new Mutation("ACCUMULO-1001");
  m.put("count","comments","7");
  bw.addMutation(m);
  m=new Mutation("ACCUMULO-1002");
  m.put("count","comments","8");
  bw.addMutation(m);
  bw.close();
  conn.tableOperations().attachIterator(tableName,aiConfig1,EnumSet.of(IteratorScope.scan));
  conn.tableOperations().offline(tableName,true);
  conn.tableOperations().online(tableName,true);
  ConditionalWriter cw=conn.createConditionalWriter(tableName,new ConditionalWriterConfig());
  ConditionalMutation cm6=new ConditionalMutation("ACCUMULO-1000",new Condition("count","comments").setValue("8"));
  cm6.put("count","comments","7");
  Assert.assertEquals(Status.ACCEPTED,cw.write(cm6).getStatus());
  Scanner scanner=conn.createScanner(tableName,new Authorizations());
  scanner.setRange(new Range("ACCUMULO-1000"));
  scanner.fetchColumn(new Text("count"),new Text("comments"));
  Entry<Key,Value> entry=Iterables.getOnlyElement(scanner);
  Assert.assertEquals("9",entry.getValue().toString());
  ConditionalMutation cm7=new ConditionalMutation("ACCUMULO-1000",new Condition("count","comments").setIterators(aiConfig2).setValue("27"));
  cm7.put("count","comments","8");
  Assert.assertEquals(Status.ACCEPTED,cw.write(cm7).getStatus());
  entry=Iterables.getOnlyElement(scanner);
  Assert.assertEquals("10",entry.getValue().toString());
  ConditionalMutation cm8=new ConditionalMutation("ACCUMULO-1000",new Condition("count","comments").setIterators(aiConfig2,aiConfig3).setValue("35"));
  cm8.put("count","comments","9");
  Assert.assertEquals(Status.ACCEPTED,cw.write(cm8).getStatus());
  entry=Iterables.getOnlyElement(scanner);
  Assert.assertEquals("11",entry.getValue().toString());
  ConditionalMutation cm3=new ConditionalMutation("ACCUMULO-1000",new Condition("count","comments").setIterators(aiConfig2).setValue("33"));
  cm3.put("count","comments","3");
  ConditionalMutation cm4=new ConditionalMutation("ACCUMULO-1001",new Condition("count","comments").setIterators(aiConfig3).setValue("14"));
  cm4.put("count","comments","3");
  ConditionalMutation cm5=new ConditionalMutation("ACCUMULO-1002",new Condition("count","comments").setIterators(aiConfig3).setValue("10"));
  cm5.put("count","comments","3");
  Iterator<Result> results=cw.write(Arrays.asList(cm3,cm4,cm5).iterator());
  Map<String,Status> actual=new HashMap<String,Status>();
  while (results.hasNext()) {
    Result result=results.next();
    String k=new String(result.getMutation().getRow());
    Assert.assertFalse("Did not expect to see multiple resultus for the row: " + k,actual.containsKey(k));
    actual.put(k,result.getStatus());
  }
  cw.close();
  Map<String,Status> expected=new HashMap<String,Status>();
  expected.put("ACCUMULO-1000",Status.ACCEPTED);
  expected.put("ACCUMULO-1001",Status.ACCEPTED);
  expected.put("ACCUMULO-1002",Status.REJECTED);
  Assert.assertEquals(expected,actual);
  cw.close();
}

</code></pre>

<br>
<pre class="type-9 type-13 type-11 type-5 type-3 type-21 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTrace() throws Exception {
  Assume.assumeTrue(getClusterType() == ClusterType.MINI);
  Process tracer=null;
  Connector conn=getConnector();
  AccumuloCluster cluster=getCluster();
  MiniAccumuloClusterImpl mac=(MiniAccumuloClusterImpl)cluster;
  if (!conn.tableOperations().exists("trace")) {
    tracer=mac.exec(TraceServer.class);
    while (!conn.tableOperations().exists("trace")) {
      sleepUninterruptibly(1,TimeUnit.SECONDS);
    }
  }
  String tableName=getUniqueNames(1)[0];
  conn.tableOperations().create(tableName);
  DistributedTrace.enable("localhost","testTrace",mac.getClientConfig());
  sleepUninterruptibly(1,TimeUnit.SECONDS);
  Span root=Trace.on("traceTest");
  ConditionalWriter cw=conn.createConditionalWriter(tableName,new ConditionalWriterConfig());
  ConditionalMutation cm0=new ConditionalMutation("99006",new Condition("tx","seq"));
  cm0.put("name","last","doe");
  cm0.put("name","first","john");
  cm0.put("tx","seq","1");
  Assert.assertEquals(Status.ACCEPTED,cw.write(cm0).getStatus());
  root.stop();
  final Scanner scanner=conn.createScanner("trace",Authorizations.EMPTY);
  scanner.setRange(new Range(new Text(Long.toHexString(root.traceId()))));
  loop:   while (true) {
    final StringBuilder finalBuffer=new StringBuilder();
    int traceCount=TraceDump.printTrace(scanner,new Printer(){
      @Override public void print(      final String line){
        try {
          finalBuffer.append(line).append("\n");
        }
 catch (        Exception ex) {
          throw new RuntimeException(ex);
        }
      }
    }
);
    String traceOutput=finalBuffer.toString();
    log.info("Trace output:" + traceOutput);
    if (traceCount > 0) {
      int lastPos=0;
      for (      String part : "traceTest, startScan,startConditionalUpdate,conditionalUpdate,Check conditions,apply conditional mutations".split(",")) {
        log.info("Looking in trace output for '" + part + "'");
        int pos=traceOutput.indexOf(part);
        if (-1 == pos) {
          log.info("Trace output doesn't contain '" + part + "'");
          Thread.sleep(1000);
          break loop;
        }
        assertTrue("Did not find '" + part + "' in output",pos > 0);
        assertTrue("'" + part + "' occurred earlier than the previous element unexpectedly",pos > lastPos);
        lastPos=pos;
      }
      break;
    }
 else {
      log.info("Ignoring trace output as traceCount not greater than zero: " + traceCount);
      Thread.sleep(1000);
    }
  }
  if (tracer != null) {
    tracer.destroy();
  }
}

</code></pre>

<br>
<pre class="type-9 type-13 type-11 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBatchErrors() throws Exception {
  Connector conn=getConnector();
  String tableName=getUniqueNames(1)[0];
  conn.tableOperations().create(tableName);
  conn.tableOperations().addConstraint(tableName,AlphaNumKeyConstraint.class.getName());
  conn.tableOperations().clone(tableName,tableName + "_clone",true,new HashMap<String,String>(),new HashSet<String>());
  conn.securityOperations().changeUserAuthorizations(getAdminPrincipal(),new Authorizations("A","B"));
  ColumnVisibility cvaob=new ColumnVisibility("A|B");
  ColumnVisibility cvaab=new ColumnVisibility("A&B");
switch ((new Random()).nextInt(3)) {
case 1:
    conn.tableOperations().addSplits(tableName,nss("6"));
  break;
case 2:
conn.tableOperations().addSplits(tableName,nss("2","95"));
break;
}
ArrayList<ConditionalMutation> mutations=new ArrayList<ConditionalMutation>();
ConditionalMutation cm0=new ConditionalMutation("99006",new Condition("tx","seq").setVisibility(cvaob));
cm0.put("name+","last",cvaob,"doe");
cm0.put("name","first",cvaob,"john");
cm0.put("tx","seq",cvaob,"1");
mutations.add(cm0);
ConditionalMutation cm1=new ConditionalMutation("59056",new Condition("tx","seq").setVisibility(cvaab));
cm1.put("name","last",cvaab,"doe");
cm1.put("name","first",cvaab,"jane");
cm1.put("tx","seq",cvaab,"1");
mutations.add(cm1);
ConditionalMutation cm2=new ConditionalMutation("19059",new Condition("tx","seq").setVisibility(cvaob));
cm2.put("name","last",cvaob,"doe");
cm2.put("name","first",cvaob,"jack");
cm2.put("tx","seq",cvaob,"1");
mutations.add(cm2);
ConditionalMutation cm3=new ConditionalMutation("90909",new Condition("tx","seq").setVisibility(cvaob).setValue("1"));
cm3.put("name","last",cvaob,"doe");
cm3.put("name","first",cvaob,"john");
cm3.put("tx","seq",cvaob,"2");
mutations.add(cm3);
ConditionalWriter cw=conn.createConditionalWriter(tableName,new ConditionalWriterConfig().setAuthorizations(new Authorizations("A")));
Iterator<Result> results=cw.write(mutations.iterator());
HashSet<String> rows=new HashSet<String>();
while (results.hasNext()) {
Result result=results.next();
String row=new String(result.getMutation().getRow());
if (row.equals("19059")) {
Assert.assertEquals(Status.ACCEPTED,result.getStatus());
}
 else if (row.equals("59056")) {
Assert.assertEquals(Status.INVISIBLE_VISIBILITY,result.getStatus());
}
 else if (row.equals("99006")) {
Assert.assertEquals(Status.VIOLATED,result.getStatus());
}
 else if (row.equals("90909")) {
Assert.assertEquals(Status.REJECTED,result.getStatus());
}
rows.add(row);
}
Assert.assertEquals(4,rows.size());
Scanner scanner=conn.createScanner(tableName,new Authorizations("A"));
scanner.fetchColumn(new Text("tx"),new Text("seq"));
Entry<Key,Value> entry=Iterables.getOnlyElement(scanner);
Assert.assertEquals("1",entry.getValue().toString());
cw.close();
}

</code></pre>

<br>
<pre class="type-9 type-13 type-11 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBatch() throws Exception {
  Connector conn=getConnector();
  String tableName=getUniqueNames(1)[0];
  conn.tableOperations().create(tableName);
  conn.securityOperations().changeUserAuthorizations(getAdminPrincipal(),new Authorizations("A","B"));
  ColumnVisibility cvab=new ColumnVisibility("A|B");
  ArrayList<ConditionalMutation> mutations=new ArrayList<ConditionalMutation>();
  ConditionalMutation cm0=new ConditionalMutation("99006",new Condition("tx","seq").setVisibility(cvab));
  cm0.put("name","last",cvab,"doe");
  cm0.put("name","first",cvab,"john");
  cm0.put("tx","seq",cvab,"1");
  mutations.add(cm0);
  ConditionalMutation cm1=new ConditionalMutation("59056",new Condition("tx","seq").setVisibility(cvab));
  cm1.put("name","last",cvab,"doe");
  cm1.put("name","first",cvab,"jane");
  cm1.put("tx","seq",cvab,"1");
  mutations.add(cm1);
  ConditionalMutation cm2=new ConditionalMutation("19059",new Condition("tx","seq").setVisibility(cvab));
  cm2.put("name","last",cvab,"doe");
  cm2.put("name","first",cvab,"jack");
  cm2.put("tx","seq",cvab,"1");
  mutations.add(cm2);
  ConditionalWriter cw=conn.createConditionalWriter(tableName,new ConditionalWriterConfig().setAuthorizations(new Authorizations("A")));
  Iterator<Result> results=cw.write(mutations.iterator());
  int count=0;
  while (results.hasNext()) {
    Result result=results.next();
    Assert.assertEquals(Status.ACCEPTED,result.getStatus());
    count++;
  }
  Assert.assertEquals(3,count);
  Scanner scanner=conn.createScanner(tableName,new Authorizations("A"));
  scanner.fetchColumn(new Text("tx"),new Text("seq"));
  for (  String row : new String[]{"99006","59056","19059"}) {
    scanner.setRange(new Range(row));
    Entry<Key,Value> entry=Iterables.getOnlyElement(scanner);
    Assert.assertEquals("1",entry.getValue().toString());
  }
  TreeSet<Text> splits=new TreeSet<Text>();
  splits.add(new Text("7"));
  splits.add(new Text("3"));
  conn.tableOperations().addSplits(tableName,splits);
  mutations.clear();
  ConditionalMutation cm3=new ConditionalMutation("99006",new Condition("tx","seq").setVisibility(cvab).setValue("1"));
  cm3.put("name","last",cvab,"Doe");
  cm3.put("tx","seq",cvab,"2");
  mutations.add(cm3);
  ConditionalMutation cm4=new ConditionalMutation("59056",new Condition("tx","seq").setVisibility(cvab));
  cm4.put("name","last",cvab,"Doe");
  cm4.put("tx","seq",cvab,"1");
  mutations.add(cm4);
  ConditionalMutation cm5=new ConditionalMutation("19059",new Condition("tx","seq").setVisibility(cvab).setValue("2"));
  cm5.put("name","last",cvab,"Doe");
  cm5.put("tx","seq",cvab,"3");
  mutations.add(cm5);
  results=cw.write(mutations.iterator());
  int accepted=0;
  int rejected=0;
  while (results.hasNext()) {
    Result result=results.next();
    if (new String(result.getMutation().getRow()).equals("99006")) {
      Assert.assertEquals(Status.ACCEPTED,result.getStatus());
      accepted++;
    }
 else {
      Assert.assertEquals(Status.REJECTED,result.getStatus());
      rejected++;
    }
  }
  Assert.assertEquals("Expected only one accepted conditional mutation",1,accepted);
  Assert.assertEquals("Expected two rejected conditional mutations",2,rejected);
  for (  String row : new String[]{"59056","19059"}) {
    scanner.setRange(new Range(row));
    Entry<Key,Value> entry=Iterables.getOnlyElement(scanner);
    Assert.assertEquals("1",entry.getValue().toString());
  }
  scanner.setRange(new Range("99006"));
  Entry<Key,Value> entry=Iterables.getOnlyElement(scanner);
  Assert.assertEquals("2",entry.getValue().toString());
  scanner.clearColumns();
  scanner.fetchColumn(new Text("name"),new Text("last"));
  entry=Iterables.getOnlyElement(scanner);
  Assert.assertEquals("Doe",entry.getValue().toString());
  cw.close();
}

</code></pre>

<br>
<pre class="type-9 type-13 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIterators() throws Exception {
  Connector conn=getConnector();
  String tableName=getUniqueNames(1)[0];
  conn.tableOperations().create(tableName,new NewTableConfiguration().withoutDefaultIterators());
  BatchWriter bw=conn.createBatchWriter(tableName,new BatchWriterConfig());
  Mutation m=new Mutation("ACCUMULO-1000");
  m.put("count","comments","1");
  bw.addMutation(m);
  bw.addMutation(m);
  bw.addMutation(m);
  m=new Mutation("ACCUMULO-1001");
  m.put("count2","comments","1");
  bw.addMutation(m);
  bw.addMutation(m);
  m=new Mutation("ACCUMULO-1002");
  m.put("count2","comments","1");
  bw.addMutation(m);
  bw.addMutation(m);
  bw.close();
  IteratorSetting iterConfig=new IteratorSetting(10,SummingCombiner.class);
  SummingCombiner.setEncodingType(iterConfig,Type.STRING);
  SummingCombiner.setColumns(iterConfig,Collections.singletonList(new IteratorSetting.Column("count")));
  IteratorSetting iterConfig2=new IteratorSetting(10,SummingCombiner.class);
  SummingCombiner.setEncodingType(iterConfig2,Type.STRING);
  SummingCombiner.setColumns(iterConfig2,Collections.singletonList(new IteratorSetting.Column("count2","comments")));
  IteratorSetting iterConfig3=new IteratorSetting(5,VersioningIterator.class);
  VersioningIterator.setMaxVersions(iterConfig3,1);
  Scanner scanner=conn.createScanner(tableName,new Authorizations());
  scanner.addScanIterator(iterConfig);
  scanner.setRange(new Range("ACCUMULO-1000"));
  scanner.fetchColumn(new Text("count"),new Text("comments"));
  Entry<Key,Value> entry=Iterables.getOnlyElement(scanner);
  Assert.assertEquals("3",entry.getValue().toString());
  ConditionalWriter cw=conn.createConditionalWriter(tableName,new ConditionalWriterConfig());
  ConditionalMutation cm0=new ConditionalMutation("ACCUMULO-1000",new Condition("count","comments").setValue("3"));
  cm0.put("count","comments","1");
  Assert.assertEquals(Status.REJECTED,cw.write(cm0).getStatus());
  entry=Iterables.getOnlyElement(scanner);
  Assert.assertEquals("3",entry.getValue().toString());
  ConditionalMutation cm1=new ConditionalMutation("ACCUMULO-1000",new Condition("count","comments").setIterators(iterConfig).setValue("3"));
  cm1.put("count","comments","1");
  Assert.assertEquals(Status.ACCEPTED,cw.write(cm1).getStatus());
  entry=Iterables.getOnlyElement(scanner);
  Assert.assertEquals("4",entry.getValue().toString());
  ConditionalMutation cm2=new ConditionalMutation("ACCUMULO-1000",new Condition("count","comments").setValue("4"));
  cm2.put("count","comments","1");
  Assert.assertEquals(Status.REJECTED,cw.write(cm1).getStatus());
  entry=Iterables.getOnlyElement(scanner);
  Assert.assertEquals("4",entry.getValue().toString());
  ConditionalMutation cm3=new ConditionalMutation("ACCUMULO-1000",new Condition("count","comments").setIterators(iterConfig).setValue("4"));
  cm3.put("count","comments","1");
  ConditionalMutation cm4=new ConditionalMutation("ACCUMULO-1001",new Condition("count2","comments").setIterators(iterConfig2).setValue("2"));
  cm4.put("count2","comments","1");
  ConditionalMutation cm5=new ConditionalMutation("ACCUMULO-1002",new Condition("count2","comments").setIterators(iterConfig2,iterConfig3).setValue("2"));
  cm5.put("count2","comments","1");
  Iterator<Result> results=cw.write(Arrays.asList(cm3,cm4,cm5).iterator());
  Map<String,Status> actual=new HashMap<String,Status>();
  while (results.hasNext()) {
    Result result=results.next();
    String k=new String(result.getMutation().getRow());
    Assert.assertFalse("Did not expect to see multiple resultus for the row: " + k,actual.containsKey(k));
    actual.put(k,result.getStatus());
  }
  Map<String,Status> expected=new HashMap<String,Status>();
  expected.put("ACCUMULO-1000",Status.ACCEPTED);
  expected.put("ACCUMULO-1001",Status.ACCEPTED);
  expected.put("ACCUMULO-1002",Status.REJECTED);
  Assert.assertEquals(expected,actual);
  cw.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.FindMaxIT </h4><pre class="type-9 type-13 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test1() throws Exception {
  Connector conn=getConnector();
  String tableName=getUniqueNames(1)[0];
  conn.tableOperations().create(tableName);
  BatchWriter bw=conn.createBatchWriter(tableName,new BatchWriterConfig());
  bw.addMutation(nm(new byte[]{0}));
  bw.addMutation(nm(new byte[]{0,0}));
  bw.addMutation(nm(new byte[]{0,1}));
  bw.addMutation(nm(new byte[]{0,1,0}));
  bw.addMutation(nm(new byte[]{1,0}));
  bw.addMutation(nm(new byte[]{'a','b','c'}));
  bw.addMutation(nm(new byte[]{(byte)0xff}));
  bw.addMutation(nm(new byte[]{(byte)0xff,(byte)0xff,(byte)0xff,(byte)0xff,(byte)0xff,(byte)0xff}));
  for (int i=0; i < 1000; i+=5) {
    bw.addMutation(nm(String.format("r%05d",i)));
  }
  bw.close();
  Scanner scanner=conn.createScanner(tableName,Authorizations.EMPTY);
  ArrayList<Text> rows=new ArrayList<Text>();
  for (  Entry<Key,Value> entry : scanner) {
    rows.add(entry.getKey().getRow());
  }
  for (int i=rows.size() - 1; i > 0; i--) {
    Text max=conn.tableOperations().getMaxRow(tableName,Authorizations.EMPTY,null,true,rows.get(i),false);
    assertEquals(rows.get(i - 1),max);
    max=conn.tableOperations().getMaxRow(tableName,Authorizations.EMPTY,rows.get(i - 1),true,rows.get(i),false);
    assertEquals(rows.get(i - 1),max);
    max=conn.tableOperations().getMaxRow(tableName,Authorizations.EMPTY,rows.get(i - 1),false,rows.get(i),false);
    assertNull(max);
    max=conn.tableOperations().getMaxRow(tableName,Authorizations.EMPTY,null,true,rows.get(i),true);
    assertEquals(rows.get(i),max);
    max=conn.tableOperations().getMaxRow(tableName,Authorizations.EMPTY,rows.get(i),true,rows.get(i),true);
    assertEquals(rows.get(i),max);
    max=conn.tableOperations().getMaxRow(tableName,Authorizations.EMPTY,rows.get(i - 1),false,rows.get(i),true);
    assertEquals(rows.get(i),max);
  }
  Text max=conn.tableOperations().getMaxRow(tableName,Authorizations.EMPTY,null,true,null,true);
  assertEquals(rows.get(rows.size() - 1),max);
  max=conn.tableOperations().getMaxRow(tableName,Authorizations.EMPTY,null,true,new Text(new byte[]{0}),false);
  assertNull(max);
  max=conn.tableOperations().getMaxRow(tableName,Authorizations.EMPTY,null,true,new Text(new byte[]{0}),true);
  assertEquals(rows.get(0),max);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.ImportExportIT </h4><pre class="type-9 type-13 type-11 type-8 type-5 type-3 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExportImportThenScan() throws Exception {
  Connector conn=getConnector();
  String[] tableNames=getUniqueNames(2);
  String srcTable=tableNames[0], destTable=tableNames[1];
  conn.tableOperations().create(srcTable);
  BatchWriter bw=conn.createBatchWriter(srcTable,new BatchWriterConfig());
  for (int row=0; row < 1000; row++) {
    Mutation m=new Mutation(Integer.toString(row));
    for (int col=0; col < 100; col++) {
      m.put(Integer.toString(col),"",Integer.toString(col * 2));
    }
    bw.addMutation(m);
  }
  bw.close();
  conn.tableOperations().compact(srcTable,null,null,true,true);
  FileSystem fs=cluster.getFileSystem();
  Path tmp=cluster.getTemporaryPath();
  log.info("Using FileSystem: " + fs);
  Path baseDir=new Path(tmp,getClass().getName());
  if (fs.exists(baseDir)) {
    log.info("{} exists on filesystem, deleting",baseDir);
    assertTrue("Failed to deleted " + baseDir,fs.delete(baseDir,true));
  }
  log.info("Creating {}",baseDir);
  assertTrue("Failed to create " + baseDir,fs.mkdirs(baseDir));
  Path exportDir=new Path(baseDir,"export");
  Path importDir=new Path(baseDir,"import");
  for (  Path p : new Path[]{exportDir,importDir}) {
    assertTrue("Failed to create " + baseDir,fs.mkdirs(p));
  }
  log.info("Exporting table to {}",exportDir);
  log.info("Importing table from {}",importDir);
  conn.tableOperations().offline(srcTable,true);
  conn.tableOperations().exportTable(srcTable,exportDir.toString());
  Path distcp=new Path(exportDir,"distcp.txt");
  Assert.assertTrue("Distcp file doesn't exist",fs.exists(distcp));
  FSDataInputStream is=fs.open(distcp);
  BufferedReader reader=new BufferedReader(new InputStreamReader(is));
  String line;
  while (null != (line=reader.readLine())) {
    Path p=new Path(line.substring(5));
    Assert.assertTrue("File doesn't exist: " + p,fs.exists(p));
    Path dest=new Path(importDir,p.getName());
    Assert.assertFalse("Did not expect " + dest + " to exist",fs.exists(dest));
    FileUtil.copy(fs,p,fs,dest,false,fs.getConf());
  }
  reader.close();
  log.info("Import dir: {}",Arrays.toString(fs.listStatus(importDir)));
  conn.tableOperations().importTable(destTable,importDir.toString());
  final String tableId=conn.tableOperations().tableIdMap().get(destTable);
  Assert.assertNotNull(tableId);
  log.info("Imported into table with ID: {}",tableId);
  Scanner s=conn.createScanner(MetadataTable.NAME,Authorizations.EMPTY);
  s.setRange(MetadataSchema.TabletsSection.getRange(tableId));
  s.fetchColumnFamily(MetadataSchema.TabletsSection.DataFileColumnFamily.NAME);
  MetadataSchema.TabletsSection.ServerColumnFamily.DIRECTORY_COLUMN.fetch(s);
  for (  Entry<Key,Value> fileEntry : s) {
    Key k=fileEntry.getKey();
    String value=fileEntry.getValue().toString();
    if (k.getColumnFamily().equals(MetadataSchema.TabletsSection.DataFileColumnFamily.NAME)) {
      String fileUri=k.getColumnQualifier().toString();
      Assert.assertFalse("Imported files should have absolute URIs, not relative: " + fileUri,looksLikeRelativePath(fileUri));
    }
 else     if (k.getColumnFamily().equals(MetadataSchema.TabletsSection.ServerColumnFamily.NAME)) {
      Assert.assertFalse("Server directory should have absolute URI, not relative: " + value,looksLikeRelativePath(value));
    }
 else {
      Assert.fail("Got expected pair: " + k + "="+ fileEntry.getValue());
    }
  }
  conn.tableOperations().online(srcTable,true);
  verifyTableEquality(conn,srcTable,destTable);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.IsolationAndDeepCopyIT </h4><pre class="type-13 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBugFix() throws Exception {
  String table=super.getUniqueNames(1)[0];
  Connector conn=getConnector();
  conn.tableOperations().create(table);
  BatchWriter bw=conn.createBatchWriter(table,new BatchWriterConfig());
  addDocument(bw,"000A","dog","cat","hamster","iguana","the");
  addDocument(bw,"000B","java","perl","C++","pascal","the");
  addDocument(bw,"000C","chrome","firefox","safari","opera","the");
  addDocument(bw,"000D","logarithmic","quadratic","linear","exponential","the");
  bw.close();
  conn.tableOperations().flush(table,null,null,true);
  IteratorSetting iterCfg=new IteratorSetting(30,"ayeaye",IntersectingIterator.class.getName());
  IntersectingIterator.setColumnFamilies(iterCfg,new Text[]{new Text("the"),new Text("hamster")});
  Scanner scanner=conn.createScanner(table,Authorizations.EMPTY);
  scanner.enableIsolation();
  scanner.addScanIterator(iterCfg);
  for (int i=0; i < 100; i++) {
    Iterator<Entry<Key,Value>> iter=scanner.iterator();
    Assert.assertTrue(iter.hasNext());
    Assert.assertEquals("000A",iter.next().getKey().getColumnQualifierData().toString());
    Assert.assertFalse(iter.hasNext());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.KeyValueEqualityIT </h4><pre class="type-9 type-13 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEquality() throws Exception {
  Connector conn=this.getConnector();
  final BatchWriterConfig config=new BatchWriterConfig();
  final String[] tables=getUniqueNames(2);
  final String table1=tables[0], table2=tables[1];
  final TableOperations tops=conn.tableOperations();
  tops.create(table1);
  tops.create(table2);
  final BatchWriter bw1=conn.createBatchWriter(table1,config), bw2=conn.createBatchWriter(table2,config);
  for (int row=0; row < 100; row++) {
    Mutation m=new Mutation(Integer.toString(row));
    for (int col=0; col < 10; col++) {
      m.put(Integer.toString(col),"",System.currentTimeMillis(),Integer.toString(col * 2));
    }
    bw1.addMutation(m);
    bw2.addMutation(m);
  }
  bw1.close();
  bw2.close();
  Iterator<Entry<Key,Value>> t1=conn.createScanner(table1,Authorizations.EMPTY).iterator(), t2=conn.createScanner(table2,Authorizations.EMPTY).iterator();
  while (t1.hasNext() && t2.hasNext()) {
    Entry<Key,Value> e1=t1.next(), e2=t2.next();
    Assert.assertEquals(e1,e2);
    Assert.assertEquals(e1.hashCode(),e2.hashCode());
  }
  Assert.assertFalse("table1 had more data to read",t1.hasNext());
  Assert.assertFalse("table2 had more data to read",t2.hasNext());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.NamespacesIT </h4><pre class="type-13 type-11 type-8 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void verifyTableOperationsExceptions() throws Exception {
  String tableName=namespace + ".1";
  IteratorSetting setting=new IteratorSetting(200,VersioningIterator.class);
  Text a=new Text("a");
  Text z=new Text("z");
  TableOperations ops=c.tableOperations();
  assertFalse(ops.exists(tableName));
  int numRun=0;
  ACCUMULOEXCEPTIONS_NAMESPACENOTFOUND:   for (int i=0; ; ++i)   try {
switch (i) {
case 0:
      ops.create(tableName);
    fail();
  break;
case 1:
ops.create("a");
ops.clone("a",tableName,true,Collections.<String,String>emptyMap(),Collections.<String>emptySet());
fail();
break;
case 2:
ops.importTable(tableName,System.getProperty("user.dir") + "/target");
fail();
break;
default :
assertEquals(3,i);
assertEquals(3,numRun);
break ACCUMULOEXCEPTIONS_NAMESPACENOTFOUND;
}
}
 catch (Exception e) {
numRun++;
if (!(e instanceof AccumuloException) || !(e.getCause() instanceof NamespaceNotFoundException)) throw new Exception("Case " + i + " resulted in "+ e.getClass().getName(),e);
}
numRun=0;
ACCUMULOEXCEPTIONS_TABLENOTFOUND: for (int i=0; ; ++i) try {
switch (i) {
case 0:
ops.removeConstraint(tableName,0);
fail();
break;
case 1:
ops.removeProperty(tableName,"a");
fail();
break;
case 2:
ops.setProperty(tableName,"a","b");
fail();
break;
default :
assertEquals(3,i);
assertEquals(3,numRun);
break ACCUMULOEXCEPTIONS_TABLENOTFOUND;
}
}
 catch (Exception e) {
numRun++;
if (!(e instanceof AccumuloException) || !(e.getCause() instanceof TableNotFoundException) || !(e.getCause().getCause() instanceof NamespaceNotFoundException)) throw new Exception("Case " + i + " resulted in "+ e.getClass().getName(),e);
}
numRun=0;
TABLENOTFOUNDEXCEPTIONS: for (int i=0; ; ++i) try {
switch (i) {
case 0:
ops.addConstraint(tableName,NumericValueConstraint.class.getName());
fail();
break;
case 1:
ops.addSplits(tableName,new TreeSet<Text>());
fail();
break;
case 2:
ops.attachIterator(tableName,setting);
fail();
break;
case 3:
ops.cancelCompaction(tableName);
fail();
break;
case 4:
ops.checkIteratorConflicts(tableName,setting,EnumSet.allOf(IteratorScope.class));
fail();
break;
case 5:
ops.clearLocatorCache(tableName);
fail();
break;
case 6:
ops.clone(tableName,"2",true,Collections.<String,String>emptyMap(),Collections.<String>emptySet());
fail();
break;
case 7:
ops.compact(tableName,a,z,true,true);
fail();
break;
case 8:
ops.delete(tableName);
fail();
break;
case 9:
ops.deleteRows(tableName,a,z);
fail();
break;
case 10:
ops.splitRangeByTablets(tableName,new Range(),10);
fail();
break;
case 11:
ops.exportTable(tableName,namespace + "_dir");
fail();
break;
case 12:
ops.flush(tableName,a,z,true);
fail();
break;
case 13:
ops.getDiskUsage(Collections.singleton(tableName));
fail();
break;
case 14:
ops.getIteratorSetting(tableName,"a",IteratorScope.scan);
fail();
break;
case 15:
ops.getLocalityGroups(tableName);
fail();
break;
case 16:
ops.getMaxRow(tableName,Authorizations.EMPTY,a,true,z,true);
fail();
break;
case 17:
ops.getProperties(tableName);
fail();
break;
case 18:
ops.importDirectory(tableName,"","",false);
fail();
break;
case 19:
ops.testClassLoad(tableName,VersioningIterator.class.getName(),SortedKeyValueIterator.class.getName());
fail();
break;
case 20:
ops.listConstraints(tableName);
fail();
break;
case 21:
ops.listIterators(tableName);
fail();
break;
case 22:
ops.listSplits(tableName);
fail();
break;
case 23:
ops.merge(tableName,a,z);
fail();
break;
case 24:
ops.offline(tableName,true);
fail();
break;
case 25:
ops.online(tableName,true);
fail();
break;
case 26:
ops.removeIterator(tableName,"a",EnumSet.of(IteratorScope.scan));
fail();
break;
case 27:
ops.rename(tableName,tableName + "2");
fail();
break;
case 28:
ops.setLocalityGroups(tableName,Collections.<String,Set<Text>>emptyMap());
fail();
break;
default :
assertEquals(29,i);
assertEquals(29,numRun);
break TABLENOTFOUNDEXCEPTIONS;
}
}
 catch (Exception e) {
numRun++;
if (!(e instanceof TableNotFoundException) || !(e.getCause() instanceof NamespaceNotFoundException)) throw new Exception("Case " + i + " resulted in "+ e.getClass().getName(),e);
}
}

</code></pre>

<br>
<pre class="type-13 type-11 type-8 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void verifyNamespaceOperationsExceptions() throws Exception {
  IteratorSetting setting=new IteratorSetting(200,VersioningIterator.class);
  NamespaceOperations ops=c.namespaceOperations();
  assertFalse(ops.exists(namespace));
  int numRun=0;
  NAMESPACENOTFOUND:   for (int i=0; ; ++i)   try {
switch (i) {
case 0:
      ops.addConstraint(namespace,NumericValueConstraint.class.getName());
    fail();
  break;
case 1:
ops.attachIterator(namespace,setting);
fail();
break;
case 2:
ops.checkIteratorConflicts(namespace,setting,EnumSet.of(IteratorScope.scan));
fail();
break;
case 3:
ops.delete(namespace);
fail();
break;
case 4:
ops.getIteratorSetting(namespace,"thing",IteratorScope.scan);
fail();
break;
case 5:
ops.getProperties(namespace);
fail();
break;
case 6:
ops.listConstraints(namespace);
fail();
break;
case 7:
ops.listIterators(namespace);
fail();
break;
case 8:
ops.removeConstraint(namespace,1);
fail();
break;
case 9:
ops.removeIterator(namespace,"thing",EnumSet.allOf(IteratorScope.class));
fail();
break;
case 10:
ops.removeProperty(namespace,"a");
fail();
break;
case 11:
ops.rename(namespace,namespace + "2");
fail();
break;
case 12:
ops.setProperty(namespace,"k","v");
fail();
break;
case 13:
ops.testClassLoad(namespace,VersioningIterator.class.getName(),SortedKeyValueIterator.class.getName());
fail();
break;
default :
assertEquals(14,i);
assertEquals(14,numRun);
break NAMESPACENOTFOUND;
}
}
 catch (Exception e) {
numRun++;
if (!(e instanceof NamespaceNotFoundException)) throw new Exception("Case " + i + " resulted in "+ e.getClass().getName(),e);
}
numRun=0;
NAMESPACEEXISTS: for (int i=0; ; ++i) try {
switch (i) {
case 0:
ops.create(namespace + "0");
ops.create(namespace + "0");
fail();
break;
case 1:
ops.create(namespace + i + "_1");
ops.create(namespace + i + "_2");
ops.rename(namespace + i + "_1",namespace + i + "_2");
fail();
break;
case 2:
ops.create(Namespaces.DEFAULT_NAMESPACE);
fail();
break;
case 3:
ops.create(Namespaces.ACCUMULO_NAMESPACE);
fail();
break;
case 4:
ops.create(namespace + i + "_1");
ops.rename(namespace + i + "_1",Namespaces.DEFAULT_NAMESPACE);
fail();
break;
case 5:
ops.create(namespace + i + "_1");
ops.rename(namespace + i + "_1",Namespaces.ACCUMULO_NAMESPACE);
fail();
break;
default :
assertEquals(6,i);
assertEquals(6,numRun);
break NAMESPACEEXISTS;
}
}
 catch (Exception e) {
numRun++;
if (!(e instanceof NamespaceExistsException)) throw new Exception("Case " + i + " resulted in "+ e.getClass().getName(),e);
}
}

</code></pre>

<br>
<pre class="type-9 type-13 type-5 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void verifyConstraintInheritance() throws Exception {
  String t1=namespace + ".1";
  c.namespaceOperations().create(namespace);
  c.tableOperations().create(t1,new NewTableConfiguration().withoutDefaultIterators());
  String constraintClassName=NumericValueConstraint.class.getName();
  assertFalse(c.namespaceOperations().listConstraints(namespace).containsKey(constraintClassName));
  assertFalse(c.tableOperations().listConstraints(t1).containsKey(constraintClassName));
  c.namespaceOperations().addConstraint(namespace,constraintClassName);
  boolean passed=false;
  for (int i=0; i < 5; i++) {
    if (!c.namespaceOperations().listConstraints(namespace).containsKey(constraintClassName)) {
      Thread.sleep(500);
      continue;
    }
    if (!c.tableOperations().listConstraints(t1).containsKey(constraintClassName)) {
      Thread.sleep(500);
      continue;
    }
    passed=true;
    break;
  }
  assertTrue("Failed to observe newly-added constraint",passed);
  passed=false;
  Integer namespaceNum=null;
  for (int i=0; i < 5; i++) {
    namespaceNum=c.namespaceOperations().listConstraints(namespace).get(constraintClassName);
    if (null == namespaceNum) {
      Thread.sleep(500);
      continue;
    }
    Integer tableNum=c.tableOperations().listConstraints(t1).get(constraintClassName);
    if (null == tableNum) {
      Thread.sleep(500);
      continue;
    }
    assertEquals(namespaceNum,tableNum);
    passed=true;
  }
  assertTrue("Failed to observe constraint in both table and namespace",passed);
  Mutation m1=new Mutation("r1");
  Mutation m2=new Mutation("r2");
  Mutation m3=new Mutation("r3");
  m1.put("a","b",new Value("abcde".getBytes(UTF_8)));
  m2.put("e","f",new Value("123".getBytes(UTF_8)));
  m3.put("c","d",new Value("zyxwv".getBytes(UTF_8)));
  passed=false;
  for (int i=0; i < 5; i++) {
    BatchWriter bw=c.createBatchWriter(t1,new BatchWriterConfig());
    bw.addMutations(Arrays.asList(m1,m2,m3));
    try {
      bw.close();
      Thread.sleep(500);
    }
 catch (    MutationsRejectedException e) {
      passed=true;
      assertEquals(1,e.getConstraintViolationSummaries().size());
      assertEquals(2,e.getConstraintViolationSummaries().get(0).getNumberOfViolatingMutations());
      break;
    }
  }
  assertTrue("Failed to see mutations rejected after constraint was added",passed);
  assertNotNull("Namespace constraint ID should not be null",namespaceNum);
  c.namespaceOperations().removeConstraint(namespace,namespaceNum);
  passed=false;
  for (int i=0; i < 5; i++) {
    if (c.namespaceOperations().listConstraints(namespace).containsKey(constraintClassName)) {
      Thread.sleep(500);
      continue;
    }
    if (c.tableOperations().listConstraints(t1).containsKey(constraintClassName)) {
      Thread.sleep(500);
      continue;
    }
    passed=true;
  }
  assertTrue("Failed to verify that constraint was removed from namespace and table",passed);
  passed=false;
  for (int i=0; i < 5; i++) {
    BatchWriter bw=c.createBatchWriter(t1,new BatchWriterConfig());
    try {
      bw.addMutations(Arrays.asList(m1,m2,m3));
      bw.close();
    }
 catch (    MutationsRejectedException e) {
      Thread.sleep(500);
      continue;
    }
    passed=true;
  }
  assertTrue("Failed to add mutations that should be allowed",passed);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.SplitRecoveryIT </h4><pre class="type-13 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test() throws Exception {
  String tableName=getUniqueNames(1)[0];
  for (int tn=0; tn < 2; tn++) {
    Connector connector=getConnector();
    connector.tableOperations().create(tableName);
    BatchWriter bw=connector.createBatchWriter(tableName,new BatchWriterConfig());
    bw.addMutation(m("a"));
    bw.addMutation(m("b"));
    bw.addMutation(m("c"));
    bw.close();
    connector.tableOperations().offline(tableName);
    while (!isOffline(tableName,connector))     sleepUninterruptibly(200,TimeUnit.MILLISECONDS);
    connector.securityOperations().grantTablePermission(getAdminPrincipal(),MetadataTable.NAME,TablePermission.WRITE);
    String tableId=connector.tableOperations().tableIdMap().get(tableName);
    KeyExtent extent=new KeyExtent(new Text(tableId),null,new Text("b"));
    Mutation m=extent.getPrevRowUpdateMutation();
    TabletsSection.TabletColumnFamily.SPLIT_RATIO_COLUMN.put(m,new Value(Double.toString(0.5).getBytes()));
    TabletsSection.TabletColumnFamily.OLD_PREV_ROW_COLUMN.put(m,KeyExtent.encodePrevEndRow(null));
    bw=connector.createBatchWriter(MetadataTable.NAME,new BatchWriterConfig());
    bw.addMutation(m);
    if (tn == 1) {
      bw.flush();
      Scanner scanner=connector.createScanner(MetadataTable.NAME,Authorizations.EMPTY);
      scanner.setRange(extent.toMetadataRange());
      scanner.fetchColumnFamily(DataFileColumnFamily.NAME);
      KeyExtent extent2=new KeyExtent(new Text(tableId),new Text("b"),null);
      m=extent2.getPrevRowUpdateMutation();
      TabletsSection.ServerColumnFamily.DIRECTORY_COLUMN.put(m,new Value("/t2".getBytes()));
      TabletsSection.ServerColumnFamily.TIME_COLUMN.put(m,new Value("M0".getBytes()));
      for (      Entry<Key,Value> entry : scanner) {
        m.put(DataFileColumnFamily.NAME,entry.getKey().getColumnQualifier(),entry.getValue());
      }
      bw.addMutation(m);
    }
    bw.close();
    connector.tableOperations().online(tableName);
    Scanner scanner=connector.createScanner(tableName,Authorizations.EMPTY);
    int i=0;
    String expected[]={"a","b","c"};
    for (    Entry<Key,Value> entry : scanner) {
      assertEquals(expected[i],entry.getKey().getRow().toString());
      i++;
    }
    assertEquals(3,i);
    connector.tableOperations().delete(tableName);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.TracerRecoversAfterOfflineTableIT </h4><pre class="type-9 type-13 type-11 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
"></span><br>
@Test public void test() throws Exception {
  Process tracer=null;
  Connector conn=getConnector();
  if (!conn.tableOperations().exists("trace")) {
    MiniAccumuloClusterImpl mac=cluster;
    tracer=mac.exec(TraceServer.class);
    while (!conn.tableOperations().exists("trace")) {
      sleepUninterruptibly(1,TimeUnit.SECONDS);
    }
    sleepUninterruptibly(5,TimeUnit.SECONDS);
  }
  log.info("Taking table offline");
  conn.tableOperations().offline("trace",true);
  String tableName=getUniqueNames(1)[0];
  conn.tableOperations().create(tableName);
  log.info("Start a distributed trace span");
  DistributedTrace.enable("localhost","testTrace",getClientConfig());
  Span root=Trace.on("traceTest");
  BatchWriter bw=conn.createBatchWriter(tableName,null);
  Mutation m=new Mutation("m");
  m.put("a","b","c");
  bw.addMutation(m);
  bw.close();
  root.stop();
  log.info("Bringing trace table back online");
  conn.tableOperations().online("trace",true);
  log.info("Trace table is online, should be able to find trace");
  final Scanner scanner=conn.createScanner("trace",Authorizations.EMPTY);
  scanner.setRange(new Range(new Text(Long.toHexString(root.traceId()))));
  while (true) {
    final StringBuilder finalBuffer=new StringBuilder();
    int traceCount=TraceDump.printTrace(scanner,new Printer(){
      @Override public void print(      final String line){
        try {
          finalBuffer.append(line).append("\n");
        }
 catch (        Exception ex) {
          throw new RuntimeException(ex);
        }
      }
    }
);
    String traceOutput=finalBuffer.toString();
    log.info("Trace output:" + traceOutput);
    if (traceCount > 0) {
      int lastPos=0;
      for (      String part : "traceTest,close,binMutations".split(",")) {
        log.info("Looking in trace output for '" + part + "'");
        int pos=traceOutput.indexOf(part);
        assertTrue("Did not find '" + part + "' in output",pos > 0);
        assertTrue("'" + part + "' occurred earlier than the previous element unexpectedly",pos > lastPos);
        lastPos=pos;
      }
      break;
    }
 else {
      log.info("Ignoring trace output as traceCount not greater than zero: " + traceCount);
      Thread.sleep(1000);
    }
  }
  if (tracer != null) {
    tracer.destroy();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.functional.CompactionIT </h4><pre class="type-9 type-13 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void test() throws Exception {
  final Connector c=getConnector();
  final String tableName=getUniqueNames(1)[0];
  c.tableOperations().create(tableName);
  c.tableOperations().setProperty(tableName,Property.TABLE_MAJC_RATIO.getKey(),"1.0");
  FileSystem fs=getFileSystem();
  Path root=new Path(cluster.getTemporaryPath(),getClass().getName());
  Path testrf=new Path(root,"testrf");
  FunctionalTestUtils.createRFiles(c,fs,testrf.toString(),500000,59,4);
  FunctionalTestUtils.bulkImport(c,fs,tableName,testrf.toString());
  int beforeCount=countFiles(c);
  final AtomicBoolean fail=new AtomicBoolean(false);
  final ClientConfiguration clientConf=cluster.getClientConfig();
  final int THREADS=5;
  for (int count=0; count < THREADS; count++) {
    ExecutorService executor=Executors.newFixedThreadPool(THREADS);
    final int span=500000 / 59;
    for (int i=0; i < 500000; i+=500000 / 59) {
      final int finalI=i;
      Runnable r=new Runnable(){
        @Override public void run(){
          try {
            VerifyIngest.Opts opts=new VerifyIngest.Opts();
            opts.startRow=finalI;
            opts.rows=span;
            opts.random=56;
            opts.dataSize=50;
            opts.cols=1;
            opts.setTableName(tableName);
            if (clientConf.getBoolean(ClientProperty.INSTANCE_RPC_SASL_ENABLED.getKey(),false)) {
              opts.updateKerberosCredentials(clientConf);
            }
 else {
              opts.setPrincipal(getAdminPrincipal());
              PasswordToken passwordToken=(PasswordToken)getAdminToken();
              opts.setPassword(new Password(new String(passwordToken.getPassword(),UTF_8)));
            }
            VerifyIngest.verifyIngest(c,opts,new ScannerOpts());
          }
 catch (          Exception ex) {
            log.warn("Got exception verifying data",ex);
            fail.set(true);
          }
        }
      }
;
      executor.execute(r);
    }
    executor.shutdown();
    executor.awaitTermination(defaultTimeoutSeconds(),TimeUnit.SECONDS);
    assertFalse("Failed to successfully run all threads, Check the test output for error",fail.get());
  }
  int finalCount=countFiles(c);
  assertTrue(finalCount < beforeCount);
  try {
    getClusterControl().adminStopAll();
  }
  finally {
    getCluster().stop();
    if (ClusterType.STANDALONE == getClusterType()) {
      getCluster().start();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.functional.CredentialsIT </h4><pre class="type-13 type-8 type-5 type-3 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDestroyTokenBeforeRPC() throws Exception {
  AuthenticationToken token=getUser(0).getToken();
  Connector userConnector=inst.getConnector(username,token);
  Scanner scanner=userConnector.createScanner(MetadataTable.NAME,Authorizations.EMPTY);
  assertFalse(token.isDestroyed());
  token.destroy();
  assertTrue(token.isDestroyed());
  try {
    Iterator<Entry<Key,Value>> iter=scanner.iterator();
    while (iter.hasNext())     fail();
    fail();
  }
 catch (  Exception e) {
    assertTrue(e instanceof RuntimeException);
    assertTrue(e.getCause() instanceof AccumuloSecurityException);
    assertTrue(AccumuloSecurityException.class.cast(e.getCause()).getSecurityErrorCode().equals(SecurityErrorCode.TOKEN_EXPIRED));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.functional.DeleteRowsSplitIT </h4><pre class="type-9 type-13 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void run() throws Exception {
  final String tableName=getUniqueNames(1)[0];
  final Connector conn=getConnector();
  for (int test=0; test < 10; test++) {
    log.info("Test " + test);
    conn.tableOperations().create(tableName);
    fillTable(conn,tableName);
    final Text start=new Text();
    final Text end=new Text();
    generateRandomRange(start,end);
    final boolean fail[]={false};
    Thread t=new Thread(){
      @Override public void run(){
        try {
          final SortedSet<Text> afterEnd=SPLITS.tailSet(new Text(end.toString() + "\0"));
          conn.tableOperations().addSplits(tableName,afterEnd);
        }
 catch (        Exception ex) {
          log.error("Exception",ex);
synchronized (fail) {
            fail[0]=true;
          }
        }
      }
    }
;
    t.start();
    sleepUninterruptibly(test * 2,TimeUnit.MILLISECONDS);
    conn.tableOperations().deleteRows(tableName,start,end);
    t.join();
synchronized (fail) {
      assertTrue(!fail[0]);
    }
    Scanner scanner=conn.createScanner(tableName,Authorizations.EMPTY);
    for (    Entry<Key,Value> entry : scanner) {
      Text row=entry.getKey().getRow();
      assertTrue(row.compareTo(start) <= 0 || row.compareTo(end) > 0);
    }
    conn.tableOperations().delete(tableName);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.functional.ExamplesIT </h4><pre class="type-9 type-13 type-5 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBloomFilters() throws Exception {
  String tableName=getUniqueNames(1)[0];
  c.tableOperations().create(tableName);
  c.tableOperations().setProperty(tableName,Property.TABLE_BLOOM_ENABLED.getKey(),"true");
  String[] args;
  if (saslEnabled) {
    args=new String[]{"--seed","7","-i",instance,"-z",keepers,"-u",user,"--keytab",keytab,"--num","100000","--min","0","--max","1000000000","--size","50","--batchMemory","2M","--batchLatency","60s","--batchThreads","3","-t",tableName};
  }
 else {
    args=new String[]{"--seed","7","-i",instance,"-z",keepers,"-u",user,"-p",passwd,"--num","100000","--min","0","--max","1000000000","--size","50","--batchMemory","2M","--batchLatency","60s","--batchThreads","3","-t",tableName};
  }
  goodExec(RandomBatchWriter.class,args);
  c.tableOperations().flush(tableName,null,null,true);
  long diff=0, diff2=0;
  for (int i=0; i < 2; i++) {
    long now=System.currentTimeMillis();
    if (saslEnabled) {
      args=new String[]{"--seed","7","-i",instance,"-z",keepers,"-u",user,"--keytab",keytab,"--num","10000","--min","0","--max","1000000000","--size","50","--scanThreads","4","-t",tableName};
    }
 else {
      args=new String[]{"--seed","7","-i",instance,"-z",keepers,"-u",user,"-p",passwd,"--num","10000","--min","0","--max","1000000000","--size","50","--scanThreads","4","-t",tableName};
    }
    goodExec(RandomBatchScanner.class,args);
    diff=System.currentTimeMillis() - now;
    now=System.currentTimeMillis();
    if (saslEnabled) {
      args=new String[]{"--seed","8","-i",instance,"-z",keepers,"-u",user,"--keytab",keytab,"--num","10000","--min","0","--max","1000000000","--size","50","--scanThreads","4","-t",tableName};
    }
 else {
      args=new String[]{"--seed","8","-i",instance,"-z",keepers,"-u",user,"-p",passwd,"--num","10000","--min","0","--max","1000000000","--size","50","--scanThreads","4","-t",tableName};
    }
    int retCode=getClusterControl().exec(RandomBatchScanner.class,args);
    assertEquals(1,retCode);
    diff2=System.currentTimeMillis() - now;
    if (diff2 < diff)     break;
  }
  assertTrue(diff2 < diff);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.functional.GarbageCollectorIT </h4><pre class="type-9 type-13 type-11 type-8 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testProperPortAdvertisement() throws Exception {
  Connector conn=getConnector();
  Instance instance=conn.getInstance();
  ZooReaderWriter zk=new ZooReaderWriter(cluster.getZooKeepers(),30000,OUR_SECRET);
  String path=ZooUtil.getRoot(instance) + Constants.ZGC_LOCK;
  for (int i=0; i < 5; i++) {
    List<String> locks;
    try {
      locks=zk.getChildren(path,null);
    }
 catch (    NoNodeException e) {
      Thread.sleep(5000);
      continue;
    }
    if (locks != null && locks.size() > 0) {
      Collections.sort(locks);
      String lockPath=path + "/" + locks.get(0);
      String gcLoc=new String(zk.getData(lockPath,null));
      Assert.assertTrue("Found unexpected data in zookeeper for GC location: " + gcLoc,gcLoc.startsWith(Service.GC_CLIENT.name()));
      int loc=gcLoc.indexOf(ServerServices.SEPARATOR_CHAR);
      Assert.assertNotEquals("Could not find split point of GC location for: " + gcLoc,-1,loc);
      String addr=gcLoc.substring(loc + 1);
      int addrSplit=addr.indexOf(':');
      Assert.assertNotEquals("Could not find split of GC host:port for: " + addr,-1,addrSplit);
      String host=addr.substring(0,addrSplit), port=addr.substring(addrSplit + 1);
      Assert.assertNotEquals("0.0.0.0",host);
      Assert.assertNotEquals(0,Integer.parseInt(port));
      return;
    }
    Thread.sleep(5000);
  }
  Assert.fail("Could not find advertised GC address");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.functional.NativeMapIT </h4><pre class="type-9 type-13 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBinary(){
  NativeMap nm=new NativeMap();
  byte emptyBytes[]=new byte[0];
  for (int i=0; i < 256; i++) {
    for (int j=0; j < 256; j++) {
      byte row[]=new byte[]{'r',(byte)(0xff & i),(byte)(0xff & j)};
      byte data[]=new byte[]{'v',(byte)(0xff & i),(byte)(0xff & j)};
      Key k=new Key(row,emptyBytes,emptyBytes,emptyBytes,1);
      Value v=new Value(data);
      nm.put(k,v);
    }
  }
  Iterator<Entry<Key,Value>> iter=nm.iterator();
  for (int i=0; i < 256; i++) {
    for (int j=0; j < 256; j++) {
      byte row[]=new byte[]{'r',(byte)(0xff & i),(byte)(0xff & j)};
      byte data[]=new byte[]{'v',(byte)(0xff & i),(byte)(0xff & j)};
      Key k=new Key(row,emptyBytes,emptyBytes,emptyBytes,1);
      Value v=new Value(data);
      assertTrue(iter.hasNext());
      Entry<Key,Value> entry=iter.next();
      assertEquals(k,entry.getKey());
      assertEquals(v,entry.getValue());
    }
  }
  assertFalse(iter.hasNext());
  for (int i=0; i < 256; i++) {
    for (int j=0; j < 256; j++) {
      byte row[]=new byte[]{'r',(byte)(0xff & i),(byte)(0xff & j)};
      byte data[]=new byte[]{'v',(byte)(0xff & i),(byte)(0xff & j)};
      Key k=new Key(row,emptyBytes,emptyBytes,emptyBytes,1);
      Value v=new Value(data);
      Value v2=nm.get(k);
      assertEquals(v,v2);
    }
  }
  nm.delete();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.functional.ScannerContextIT </h4><pre class="type-9 type-13 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testClearContext() throws Exception {
  Path baseDir=new Path(System.getProperty("user.dir"));
  Path targetDir=new Path(baseDir,"target");
  Path jarPath=new Path(targetDir,"TestIterators-tests.jar");
  Path dstPath=new Path(CONTEXT_DIR + "/Test.jar");
  fs.copyFromLocalFile(jarPath,dstPath);
  UtilWaitThread.sleep(WAIT);
  try {
    Connector c=getConnector();
    c.instanceOperations().setProperty(CONTEXT_PROPERTY,CONTEXT_CLASSPATH);
    String tableName=getUniqueNames(1)[0];
    c.tableOperations().create(tableName);
    BatchWriter bw=c.createBatchWriter(tableName,new BatchWriterConfig());
    for (int i=0; i < ITERATIONS; i++) {
      Mutation m=new Mutation("row" + i);
      m.put("cf","col1","Test");
      bw.addMutation(m);
    }
    bw.close();
    Scanner one=c.createScanner(tableName,Authorizations.EMPTY);
    IteratorSetting cfg=new IteratorSetting(21,"reverse","org.apache.accumulo.test.functional.ValueReversingIterator");
    one.addScanIterator(cfg);
    one.setClassLoaderContext(CONTEXT);
    Iterator<Entry<Key,Value>> iterator=one.iterator();
    for (int i=0; i < ITERATIONS; i++) {
      assertTrue(iterator.hasNext());
      Entry<Key,Value> next=iterator.next();
      assertEquals("tseT",next.getValue().toString());
    }
    one.removeScanIterator("reverse");
    one.clearClassLoaderContext();
    iterator=one.iterator();
    for (int i=0; i < ITERATIONS; i++) {
      assertTrue(iterator.hasNext());
      Entry<Key,Value> next=iterator.next();
      assertEquals("Test",next.getValue().toString());
    }
  }
  finally {
    fs.delete(dstPath,true);
  }
}

</code></pre>

<br>
<pre class="type-9 type-13 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOneScannerDoesntInterfereWithAnother() throws Exception {
  Path baseDir=new Path(System.getProperty("user.dir"));
  Path targetDir=new Path(baseDir,"target");
  Path jarPath=new Path(targetDir,"TestIterators-tests.jar");
  Path dstPath=new Path(CONTEXT_DIR + "/Test.jar");
  fs.copyFromLocalFile(jarPath,dstPath);
  UtilWaitThread.sleep(WAIT);
  try {
    Connector c=getConnector();
    c.instanceOperations().setProperty(CONTEXT_PROPERTY,CONTEXT_CLASSPATH);
    String tableName=getUniqueNames(1)[0];
    c.tableOperations().create(tableName);
    BatchWriter bw=c.createBatchWriter(tableName,new BatchWriterConfig());
    for (int i=0; i < ITERATIONS; i++) {
      Mutation m=new Mutation("row" + i);
      m.put("cf","col1","Test");
      bw.addMutation(m);
    }
    bw.close();
    Scanner one=c.createScanner(tableName,Authorizations.EMPTY);
    Scanner two=c.createScanner(tableName,Authorizations.EMPTY);
    IteratorSetting cfg=new IteratorSetting(21,"reverse","org.apache.accumulo.test.functional.ValueReversingIterator");
    one.addScanIterator(cfg);
    one.setClassLoaderContext(CONTEXT);
    Iterator<Entry<Key,Value>> iterator=one.iterator();
    for (int i=0; i < ITERATIONS; i++) {
      assertTrue(iterator.hasNext());
      Entry<Key,Value> next=iterator.next();
      assertEquals("tseT",next.getValue().toString());
    }
    Iterator<Entry<Key,Value>> iterator2=two.iterator();
    for (int i=0; i < ITERATIONS; i++) {
      assertTrue(iterator2.hasNext());
      Entry<Key,Value> next=iterator2.next();
      assertEquals("Test",next.getValue().toString());
    }
  }
  finally {
    fs.delete(dstPath,true);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.functional.SimpleBalancerFairnessIT </h4><pre class="type-9 type-13 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void simpleBalancerFairness() throws Exception {
  Connector c=getConnector();
  c.tableOperations().create("test_ingest");
  c.tableOperations().setProperty("test_ingest",Property.TABLE_SPLIT_THRESHOLD.getKey(),"10K");
  c.tableOperations().create("unused");
  TreeSet<Text> splits=TestIngest.getSplitPoints(0,10000000,500);
  log.info("Creating " + splits.size() + " splits");
  c.tableOperations().addSplits("unused",splits);
  List<String> tservers=c.instanceOperations().getTabletServers();
  TestIngest.Opts opts=new TestIngest.Opts();
  opts.rows=50000;
  opts.setPrincipal("root");
  TestIngest.ingest(c,opts,new BatchWriterOpts());
  c.tableOperations().flush("test_ingest",null,null,false);
  sleepUninterruptibly(45,TimeUnit.SECONDS);
  Credentials creds=new Credentials("root",new PasswordToken(ROOT_PASSWORD));
  ClientContext context=new ClientContext(c.getInstance(),creds,getClientConfig());
  MasterMonitorInfo stats=null;
  int unassignedTablets=1;
  for (int i=0; unassignedTablets > 0 && i < 10; i++) {
    MasterClientService.Iface client=null;
    try {
      client=MasterClient.getConnectionWithRetry(context);
      stats=client.getMasterStats(Tracer.traceInfo(),creds.toThrift(c.getInstance()));
    }
  finally {
      if (client != null)       MasterClient.close(client);
    }
    unassignedTablets=stats.getUnassignedTablets();
    if (unassignedTablets > 0) {
      log.info("Found " + unassignedTablets + " unassigned tablets, sleeping 3 seconds for tablet assignment");
      Thread.sleep(3000);
    }
  }
  assertEquals("Unassigned tablets were not assigned within 30 seconds",0,unassignedTablets);
  List<Integer> counts=new ArrayList<Integer>();
  for (  TabletServerStatus server : stats.tServerInfo) {
    int count=0;
    for (    TableInfo table : server.tableMap.values()) {
      count+=table.onlineTablets;
    }
    counts.add(count);
  }
  assertTrue("Expected to have at least two TabletServers",counts.size() > 1);
  for (int i=1; i < counts.size(); i++) {
    int diff=Math.abs(counts.get(0) - counts.get(i));
    assertTrue("Expected difference in tablets to be less than or equal to " + counts.size() + " but was "+ diff+ ". Counts "+ counts,diff <= tservers.size());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.proxy.SimpleProxyBase </h4><pre class="type-9 type-13 type-8 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConditionalWriter() throws Exception {
  log.debug("Adding constraint {} to {}",table,NumericValueConstraint.class.getName());
  client.addConstraint(creds,table,NumericValueConstraint.class.getName());
  sleepUninterruptibly(ZOOKEEPER_PROPAGATION_TIME,TimeUnit.MILLISECONDS);
  while (!client.listConstraints(creds,table).containsKey(NumericValueConstraint.class.getName())) {
    log.info("Failed to see constraint");
    Thread.sleep(1000);
  }
  String cwid=client.createConditionalWriter(creds,table,new ConditionalWriterOptions());
  Map<ByteBuffer,ConditionalUpdates> updates=new HashMap<ByteBuffer,ConditionalUpdates>();
  updates.put(s2bb("00345"),new ConditionalUpdates(Arrays.asList(newCondition("meta","seq")),Arrays.asList(newColUpdate("meta","seq",10,"1"),newColUpdate("data","img","73435435"))));
  Map<ByteBuffer,ConditionalStatus> results=client.updateRowsConditionally(cwid,updates);
  assertEquals(1,results.size());
  assertEquals(ConditionalStatus.ACCEPTED,results.get(s2bb("00345")));
  assertScan(new String[][]{{"00345","data","img","73435435"},{"00345","meta","seq","1"}},table);
  updates.clear();
  updates.put(s2bb("00345"),new ConditionalUpdates(Arrays.asList(newCondition("meta","seq")),Arrays.asList(newColUpdate("meta","seq","2"))));
  updates.put(s2bb("00346"),new ConditionalUpdates(Arrays.asList(newCondition("meta","seq")),Arrays.asList(newColUpdate("meta","seq","1"))));
  results=client.updateRowsConditionally(cwid,updates);
  assertEquals(2,results.size());
  assertEquals(ConditionalStatus.REJECTED,results.get(s2bb("00345")));
  assertEquals(ConditionalStatus.ACCEPTED,results.get(s2bb("00346")));
  assertScan(new String[][]{{"00345","data","img","73435435"},{"00345","meta","seq","1"},{"00346","meta","seq","1"}},table);
  updates.clear();
  updates.put(s2bb("00345"),new ConditionalUpdates(Arrays.asList(newCondition("meta","seq","1")),Arrays.asList(newColUpdate("meta","seq",20,"2"),newColUpdate("data","img","567890"))));
  updates.put(s2bb("00346"),new ConditionalUpdates(Arrays.asList(newCondition("meta","seq","2")),Arrays.asList(newColUpdate("meta","seq","3"))));
  results=client.updateRowsConditionally(cwid,updates);
  assertEquals(2,results.size());
  assertEquals(ConditionalStatus.ACCEPTED,results.get(s2bb("00345")));
  assertEquals(ConditionalStatus.REJECTED,results.get(s2bb("00346")));
  assertScan(new String[][]{{"00345","data","img","567890"},{"00345","meta","seq","2"},{"00346","meta","seq","1"}},table);
  updates.clear();
  updates.put(s2bb("00345"),new ConditionalUpdates(Arrays.asList(newCondition("meta","seq",10,"2")),Arrays.asList(newColUpdate("meta","seq",30,"3"),newColUpdate("data","img","1234567890"))));
  results=client.updateRowsConditionally(cwid,updates);
  assertEquals(1,results.size());
  assertEquals(ConditionalStatus.REJECTED,results.get(s2bb("00345")));
  assertScan(new String[][]{{"00345","data","img","567890"},{"00345","meta","seq","2"},{"00346","meta","seq","1"}},table);
  updates.clear();
  updates.put(s2bb("00345"),new ConditionalUpdates(Arrays.asList(newCondition("meta","seq",20,"2")),Arrays.asList(newColUpdate("meta","seq",30,"3"),newColUpdate("data","img","1234567890"))));
  results=client.updateRowsConditionally(cwid,updates);
  assertEquals(1,results.size());
  assertEquals(ConditionalStatus.ACCEPTED,results.get(s2bb("00345")));
  assertScan(new String[][]{{"00345","data","img","1234567890"},{"00345","meta","seq","3"},{"00346","meta","seq","1"}},table);
  client.updateAndFlush(creds,table,Collections.singletonMap(s2bb("00347"),Arrays.asList(newColUpdate("data","count","1"))));
  client.updateAndFlush(creds,table,Collections.singletonMap(s2bb("00347"),Arrays.asList(newColUpdate("data","count","1"))));
  client.updateAndFlush(creds,table,Collections.singletonMap(s2bb("00347"),Arrays.asList(newColUpdate("data","count","1"))));
  updates.clear();
  updates.put(s2bb("00347"),new ConditionalUpdates(Arrays.asList(newCondition("data","count","3")),Arrays.asList(newColUpdate("data","img","1234567890"))));
  results=client.updateRowsConditionally(cwid,updates);
  assertEquals(1,results.size());
  assertEquals(ConditionalStatus.REJECTED,results.get(s2bb("00347")));
  assertScan(new String[][]{{"00345","data","img","1234567890"},{"00345","meta","seq","3"},{"00346","meta","seq","1"},{"00347","data","count","1"}},table);
  Condition iterCond=newCondition("data","count","3");
  Map<String,String> props=new HashMap<String,String>();
  props.put("type","STRING");
  props.put("columns","data:count");
  IteratorSetting is=new IteratorSetting(1,"sumc",SummingCombiner.class.getName(),props);
  iterCond.setIterators(Arrays.asList(is));
  updates.clear();
  updates.put(s2bb("00347"),new ConditionalUpdates(Arrays.asList(iterCond),Arrays.asList(newColUpdate("data","img","1234567890"))));
  results=client.updateRowsConditionally(cwid,updates);
  assertEquals(1,results.size());
  assertEquals(ConditionalStatus.ACCEPTED,results.get(s2bb("00347")));
  assertScan(new String[][]{{"00345","data","img","1234567890"},{"00345","meta","seq","3"},{"00346","meta","seq","1"},{"00347","data","count","1"},{"00347","data","img","1234567890"}},table);
  ConditionalStatus status=null;
  for (int i=0; i < 30; i++) {
    updates.clear();
    updates.put(s2bb("00347"),new ConditionalUpdates(Arrays.asList(newCondition("data","img","1234567890")),Arrays.asList(newColUpdate("data","count","A"))));
    results=client.updateRowsConditionally(cwid,updates);
    assertEquals(1,results.size());
    status=results.get(s2bb("00347"));
    if (ConditionalStatus.VIOLATED != status) {
      log.info("ConditionalUpdate was not rejected by server due to table constraint. Sleeping and retrying");
      Thread.sleep(5000);
      continue;
    }
    assertEquals(ConditionalStatus.VIOLATED,status);
    break;
  }
  assertEquals(ConditionalStatus.VIOLATED,status);
  assertScan(new String[][]{{"00345","data","img","1234567890"},{"00345","meta","seq","3"},{"00346","meta","seq","1"},{"00347","data","count","1"},{"00347","data","img","1234567890"}},table);
  updates.clear();
  updates.put(s2bb("00347"),new ConditionalUpdates(Arrays.asList(newCondition("data","img","565"),newCondition("data","count","2")),Arrays.asList(newColUpdate("data","count","3"),newColUpdate("data","img","0987654321"))));
  results=client.updateRowsConditionally(cwid,updates);
  assertEquals(1,results.size());
  assertEquals(ConditionalStatus.REJECTED,results.get(s2bb("00347")));
  assertScan(new String[][]{{"00345","data","img","1234567890"},{"00345","meta","seq","3"},{"00346","meta","seq","1"},{"00347","data","count","1"},{"00347","data","img","1234567890"}},table);
  updates.clear();
  updates.put(s2bb("00347"),new ConditionalUpdates(Arrays.asList(newCondition("data","img","1234567890"),newCondition("data","count","2")),Arrays.asList(newColUpdate("data","count","3"),newColUpdate("data","img","0987654321"))));
  results=client.updateRowsConditionally(cwid,updates);
  assertEquals(1,results.size());
  assertEquals(ConditionalStatus.REJECTED,results.get(s2bb("00347")));
  assertScan(new String[][]{{"00345","data","img","1234567890"},{"00345","meta","seq","3"},{"00346","meta","seq","1"},{"00347","data","count","1"},{"00347","data","img","1234567890"}},table);
  updates.clear();
  updates.put(s2bb("00347"),new ConditionalUpdates(Arrays.asList(newCondition("data","img","565"),newCondition("data","count","1")),Arrays.asList(newColUpdate("data","count","3"),newColUpdate("data","img","0987654321"))));
  results=client.updateRowsConditionally(cwid,updates);
  assertEquals(1,results.size());
  assertEquals(ConditionalStatus.REJECTED,results.get(s2bb("00347")));
  assertScan(new String[][]{{"00345","data","img","1234567890"},{"00345","meta","seq","3"},{"00346","meta","seq","1"},{"00347","data","count","1"},{"00347","data","img","1234567890"}},table);
  ConditionalStatus result=client.updateRowConditionally(creds,table,s2bb("00347"),new ConditionalUpdates(Arrays.asList(newCondition("data","img","1234567890"),newCondition("data","count","1")),Arrays.asList(newColUpdate("data","count","3"),newColUpdate("data","img","0987654321"))));
  assertEquals(ConditionalStatus.ACCEPTED,result);
  assertScan(new String[][]{{"00345","data","img","1234567890"},{"00345","meta","seq","3"},{"00346","meta","seq","1"},{"00347","data","count","3"},{"00347","data","img","0987654321"}},table);
  client.closeConditionalWriter(cwid);
  try {
    client.updateRowsConditionally(cwid,updates);
    fail("conditional writer not closed");
  }
 catch (  UnknownWriter uk) {
  }
  String principal;
  ClusterUser cwuser=null;
  if (isKerberosEnabled()) {
    cwuser=getKdc().getClientPrincipal(1);
    principal=cwuser.getPrincipal();
    client.createLocalUser(creds,principal,s2bb("unused"));
  }
 else {
    principal="cwuser";
    client.createLocalUser(creds,principal,s2bb("bestpasswordever"));
  }
  client.changeUserAuthorizations(creds,principal,Collections.singleton(s2bb("A")));
  client.grantTablePermission(creds,principal,table,TablePermission.WRITE);
  client.grantTablePermission(creds,principal,table,TablePermission.READ);
  TestProxyClient cwuserProxyClient=null;
  Client origClient=null;
  Map<String,String> cwProperties;
  if (isKerberosEnabled()) {
    UserGroupInformation.loginUserFromKeytab(cwuser.getPrincipal(),cwuser.getKeytab().getAbsolutePath());
    final UserGroupInformation cwuserUgi=UserGroupInformation.getCurrentUser();
    cwuserProxyClient=new TestProxyClient(hostname,proxyPort,factory,proxyPrimary,cwuserUgi);
    origClient=client;
    client=cwuserProxyClient.proxy();
    cwProperties=Collections.emptyMap();
  }
 else {
    cwProperties=Collections.singletonMap("password","bestpasswordever");
  }
  try {
    ByteBuffer cwCreds=client.login(principal,cwProperties);
    cwid=client.createConditionalWriter(cwCreds,table,new ConditionalWriterOptions().setAuthorizations(Collections.singleton(s2bb("A"))));
    updates.clear();
    updates.put(s2bb("00348"),new ConditionalUpdates(Arrays.asList(new Condition(new Column(s2bb("data"),s2bb("c"),s2bb("A")))),Arrays.asList(newColUpdate("data","seq","1"),newColUpdate("data","c","1").setColVisibility(s2bb("A")))));
    updates.put(s2bb("00349"),new ConditionalUpdates(Arrays.asList(new Condition(new Column(s2bb("data"),s2bb("c"),s2bb("B")))),Arrays.asList(newColUpdate("data","seq","1"))));
    results=client.updateRowsConditionally(cwid,updates);
    assertEquals(2,results.size());
    assertEquals(ConditionalStatus.ACCEPTED,results.get(s2bb("00348")));
    assertEquals(ConditionalStatus.INVISIBLE_VISIBILITY,results.get(s2bb("00349")));
    if (isKerberosEnabled()) {
      UserGroupInformation.loginUserFromKeytab(clientPrincipal,clientKeytab.getAbsolutePath());
      client=origClient;
    }
    assertScan(new String[][]{{"00345","data","img","1234567890"},{"00345","meta","seq","3"},{"00346","meta","seq","1"},{"00347","data","count","3"},{"00347","data","img","0987654321"},{"00348","data","seq","1"}},table);
    if (isKerberosEnabled()) {
      UserGroupInformation.loginUserFromKeytab(cwuser.getPrincipal(),cwuser.getKeytab().getAbsolutePath());
      client=cwuserProxyClient.proxy();
    }
    updates.clear();
    updates.clear();
    updates.put(s2bb("00348"),new ConditionalUpdates(Arrays.asList(new Condition(new Column(s2bb("data"),s2bb("c"),s2bb("A"))).setValue(s2bb("0"))),Arrays.asList(newColUpdate("data","seq","2"),newColUpdate("data","c","2").setColVisibility(s2bb("A")))));
    results=client.updateRowsConditionally(cwid,updates);
    assertEquals(1,results.size());
    assertEquals(ConditionalStatus.REJECTED,results.get(s2bb("00348")));
    if (isKerberosEnabled()) {
      UserGroupInformation.loginUserFromKeytab(clientPrincipal,clientKeytab.getAbsolutePath());
      client=origClient;
    }
    assertScan(new String[][]{{"00345","data","img","1234567890"},{"00345","meta","seq","3"},{"00346","meta","seq","1"},{"00347","data","count","3"},{"00347","data","img","0987654321"},{"00348","data","seq","1"}},table);
    if (isKerberosEnabled()) {
      UserGroupInformation.loginUserFromKeytab(cwuser.getPrincipal(),cwuser.getKeytab().getAbsolutePath());
      client=cwuserProxyClient.proxy();
    }
    updates.clear();
    updates.put(s2bb("00348"),new ConditionalUpdates(Arrays.asList(new Condition(new Column(s2bb("data"),s2bb("c"),s2bb("A"))).setValue(s2bb("1"))),Arrays.asList(newColUpdate("data","seq","2"),newColUpdate("data","c","2").setColVisibility(s2bb("A")))));
    results=client.updateRowsConditionally(cwid,updates);
    assertEquals(1,results.size());
    assertEquals(ConditionalStatus.ACCEPTED,results.get(s2bb("00348")));
    if (isKerberosEnabled()) {
      UserGroupInformation.loginUserFromKeytab(clientPrincipal,clientKeytab.getAbsolutePath());
      client=origClient;
    }
    assertScan(new String[][]{{"00345","data","img","1234567890"},{"00345","meta","seq","3"},{"00346","meta","seq","1"},{"00347","data","count","3"},{"00347","data","img","0987654321"},{"00348","data","seq","2"}},table);
    if (isKerberosEnabled()) {
      UserGroupInformation.loginUserFromKeytab(cwuser.getPrincipal(),cwuser.getKeytab().getAbsolutePath());
      client=cwuserProxyClient.proxy();
    }
    client.closeConditionalWriter(cwid);
    try {
      client.updateRowsConditionally(cwid,updates);
      fail("conditional writer not closed");
    }
 catch (    UnknownWriter uk) {
    }
  }
  finally {
    if (isKerberosEnabled()) {
      if (null != cwuserProxyClient) {
        cwuserProxyClient.close();
      }
      UserGroupInformation.loginUserFromKeytab(clientPrincipal,clientKeytab.getAbsolutePath());
      client=origClient;
    }
    client.dropLocalUser(creds,principal);
  }
}

</code></pre>

<br>
<pre class="type-9 type-13 type-11 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void attachIteratorsWithScans() throws Exception {
  if (client.tableExists(creds,"slow")) {
    client.deleteTable(creds,"slow");
  }
  client.createTable(creds,"slow",true,TimeType.MILLIS);
  IteratorSetting setting=new IteratorSetting(100,"slow",SlowIterator.class.getName(),Collections.singletonMap("sleepTime","250"));
  client.attachIterator(creds,"slow",setting,EnumSet.allOf(IteratorScope.class));
  for (int i=0; i < 40; i++) {
    client.updateAndFlush(creds,"slow",mutation("row" + i,"cf","cq","value"));
  }
  Thread t=new Thread(){
    @Override public void run(){
      String scanner;
      TestProxyClient proxyClient2=null;
      try {
        if (isKerberosEnabled()) {
          UserGroupInformation.loginUserFromKeytab(clientPrincipal,clientKeytab.getAbsolutePath());
          proxyClient2=new TestProxyClient(hostname,proxyPort,factory,proxyPrimary,UserGroupInformation.getCurrentUser());
        }
 else {
          proxyClient2=new TestProxyClient(hostname,proxyPort,factory);
        }
        Client client2=proxyClient2.proxy();
        scanner=client2.createScanner(creds,"slow",null);
        client2.nextK(scanner,10);
        client2.closeScanner(scanner);
      }
 catch (      Exception e) {
        throw new RuntimeException(e);
      }
 finally {
        if (null != proxyClient2) {
          proxyClient2.close();
        }
      }
    }
  }
;
  t.start();
  List<ActiveScan> scans=new ArrayList<ActiveScan>();
  for (int i=0; i < 100 && scans.isEmpty(); i++) {
    for (    String tserver : client.getTabletServers(creds)) {
      List<ActiveScan> scansForServer=client.getActiveScans(creds,tserver);
      for (      ActiveScan scan : scansForServer) {
        if (clientPrincipal.equals(scan.getUser())) {
          scans.add(scan);
        }
      }
      if (!scans.isEmpty())       break;
      sleepUninterruptibly(100,TimeUnit.MILLISECONDS);
    }
  }
  t.join();
  assertFalse("Expected to find scans, but found none",scans.isEmpty());
  boolean found=false;
  Map<String,String> map=null;
  for (int i=0; i < scans.size() && !found; i++) {
    ActiveScan scan=scans.get(i);
    if (clientPrincipal.equals(scan.getUser())) {
      assertTrue(ScanState.RUNNING.equals(scan.getState()) || ScanState.QUEUED.equals(scan.getState()));
      assertEquals(ScanType.SINGLE,scan.getType());
      assertEquals("slow",scan.getTable());
      map=client.tableIdMap(creds);
      assertEquals(map.get("slow"),scan.getExtent().tableId);
      assertTrue(scan.getExtent().endRow == null);
      assertTrue(scan.getExtent().prevEndRow == null);
      found=true;
    }
  }
  assertTrue("Could not find a scan against the 'slow' table",found);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.proxy.TestProxyReadWrite </h4><pre class="type-13 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testVisibility() throws Exception {
  Set<ByteBuffer> auths=new HashSet<ByteBuffer>();
  auths.add(ByteBuffer.wrap("even".getBytes()));
  tpc.proxy().changeUserAuthorizations(userpass,"root",auths);
  int maxInserts=10000;
  Map<ByteBuffer,List<ColumnUpdate>> mutations=new HashMap<ByteBuffer,List<ColumnUpdate>>();
  String format="%1$05d";
  String writer=tpc.proxy().createWriter(userpass,testtable,null);
  for (int i=0; i < maxInserts; i++) {
    if (i % 2 == 0)     addMutation(mutations,String.format(format,i),"cf" + i,"cq" + i,"even",Util.randString(10));
 else     addMutation(mutations,String.format(format,i),"cf" + i,"cq" + i,"odd",Util.randString(10));
    if (i % 1000 == 0 || i == maxInserts - 1) {
      tpc.proxy().update(writer,mutations);
      mutations.clear();
    }
  }
  tpc.proxy().flush(writer);
  tpc.proxy().closeWriter(writer);
  ScanOptions opts=new ScanOptions();
  opts.authorizations=auths;
  String cookie=tpc.proxy().createScanner(userpass,testtable,opts);
  int i=0;
  boolean hasNext=true;
  int k=1000;
  int numRead=0;
  while (hasNext) {
    ScanResult kvList=tpc.proxy().nextK(cookie,k);
    for (    KeyValue kv : kvList.getResults()) {
      assertEquals(Integer.parseInt(new String(kv.getKey().getRow())),i);
      i+=2;
      numRead++;
    }
    hasNext=kvList.isMore();
  }
  assertEquals(maxInserts / 2,numRead);
}

</code></pre>

<br>
<pre class="type-13 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Insert 100000 cells which have as the row [0..99999] (padded with zeros). Filter the results so only the even numbers come back.
 */
@Test public void readWriteOneShotWithFilterIterator() throws Exception {
  int maxInserts=10000;
  Map<ByteBuffer,List<ColumnUpdate>> mutations=new HashMap<ByteBuffer,List<ColumnUpdate>>();
  String format="%1$05d";
  for (int i=0; i < maxInserts; i++) {
    addMutation(mutations,String.format(format,i),"cf" + i,"cq" + i,Util.randString(10));
    if (i % 1000 == 0 || i == maxInserts - 1) {
      tpc.proxy().updateAndFlush(userpass,testtable,mutations);
      mutations.clear();
    }
  }
  String regex=".*[02468]";
  org.apache.accumulo.core.client.IteratorSetting is=new org.apache.accumulo.core.client.IteratorSetting(50,regex,RegExFilter.class);
  RegExFilter.setRegexs(is,regex,null,null,null,false);
  IteratorSetting pis=Util.iteratorSetting2ProxyIteratorSetting(is);
  ScanOptions opts=new ScanOptions();
  opts.iterators=Collections.singletonList(pis);
  String cookie=tpc.proxy().createScanner(userpass,testtable,opts);
  int i=0;
  boolean hasNext=true;
  int k=1000;
  while (hasNext) {
    ScanResult kvList=tpc.proxy().nextK(cookie,k);
    for (    KeyValue kv : kvList.getResults()) {
      assertEquals(Integer.parseInt(new String(kv.getKey().getRow())),i);
      i+=2;
    }
    hasNext=kvList.isMore();
  }
}

</code></pre>

<br>
<pre class="type-13 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void asynchReadWrite() throws Exception {
  int maxInserts=10000;
  Map<ByteBuffer,List<ColumnUpdate>> mutations=new HashMap<ByteBuffer,List<ColumnUpdate>>();
  String format="%1$05d";
  String writer=tpc.proxy().createWriter(userpass,testtable,null);
  for (int i=0; i < maxInserts; i++) {
    addMutation(mutations,String.format(format,i),"cf" + i,"cq" + i,Util.randString(10));
    if (i % 1000 == 0 || i == maxInserts - 1) {
      tpc.proxy().update(writer,mutations);
      mutations.clear();
    }
  }
  tpc.proxy().flush(writer);
  tpc.proxy().closeWriter(writer);
  String regex=".*[02468]";
  org.apache.accumulo.core.client.IteratorSetting is=new org.apache.accumulo.core.client.IteratorSetting(50,regex,RegExFilter.class);
  RegExFilter.setRegexs(is,regex,null,null,null,false);
  IteratorSetting pis=Util.iteratorSetting2ProxyIteratorSetting(is);
  ScanOptions opts=new ScanOptions();
  opts.iterators=Collections.singletonList(pis);
  String cookie=tpc.proxy().createScanner(userpass,testtable,opts);
  int i=0;
  boolean hasNext=true;
  int k=1000;
  int numRead=0;
  while (hasNext) {
    ScanResult kvList=tpc.proxy().nextK(cookie,k);
    for (    KeyValue kv : kvList.getResults()) {
      assertEquals(i,Integer.parseInt(new String(kv.getKey().getRow())));
      numRead++;
      i+=2;
    }
    hasNext=kvList.isMore();
  }
  assertEquals(maxInserts / 2,numRead);
}

</code></pre>

<br>
<pre class="type-13 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Insert 100000 cells which have as the row [0..99999] (padded with zeros). Filter the results so only the even numbers come back.
 */
@Test public void readWriteBatchOneShotWithFilterIterator() throws Exception {
  int maxInserts=10000;
  Map<ByteBuffer,List<ColumnUpdate>> mutations=new HashMap<ByteBuffer,List<ColumnUpdate>>();
  String format="%1$05d";
  for (int i=0; i < maxInserts; i++) {
    addMutation(mutations,String.format(format,i),"cf" + i,"cq" + i,Util.randString(10));
    if (i % 1000 == 0 || i == maxInserts - 1) {
      tpc.proxy().updateAndFlush(userpass,testtable,mutations);
      mutations.clear();
    }
  }
  String regex=".*[02468]";
  org.apache.accumulo.core.client.IteratorSetting is=new org.apache.accumulo.core.client.IteratorSetting(50,regex,RegExFilter.class);
  RegExFilter.setRegexs(is,regex,null,null,null,false);
  IteratorSetting pis=Util.iteratorSetting2ProxyIteratorSetting(is);
  ScanOptions opts=new ScanOptions();
  opts.iterators=Collections.singletonList(pis);
  String cookie=tpc.proxy().createScanner(userpass,testtable,opts);
  int i=0;
  boolean hasNext=true;
  int k=1000;
  while (hasNext) {
    ScanResult kvList=tpc.proxy().nextK(cookie,k);
    for (    KeyValue kv : kvList.getResults()) {
      assertEquals(Integer.parseInt(new String(kv.getKey().getRow())),i);
      i+=2;
    }
    hasNext=kvList.isMore();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.replication.GarbageCollectorCommunicatesWithTServersIT </h4><pre class="type-9 type-13 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=2 * 60 * 1000) public void testUnreferencedWalInTserverIsClosed() throws Exception {
  final String[] names=getUniqueNames(2);
  final String table=names[0], otherTable=names[1];
  final Connector conn=getConnector();
  ReplicationTable.setOnline(conn);
  log.info("Creating {}",table);
  conn.tableOperations().create(table);
  conn.tableOperations().setProperty(table,Property.TABLE_REPLICATION.getKey(),"true");
  log.info("Writing a few mutations to the table");
  BatchWriter bw=conn.createBatchWriter(table,null);
  byte[] empty=new byte[0];
  for (int i=0; i < 5; i++) {
    Mutation m=new Mutation(Integer.toString(i));
    m.put(empty,empty,empty);
    bw.addMutation(m);
  }
  log.info("Flushing mutations to the server");
  bw.close();
  log.info("Checking that metadata only has one WAL recorded for this table");
  Set<String> wals=getWalsForTable(table);
  Assert.assertEquals("Expected to only find two WAL for the table",2,wals.size());
  log.info("Compacting the table which will remove all WALs from the tablets");
  conn.tableOperations().flush(table,null,null,true);
  conn.tableOperations().flush(MetadataTable.NAME,null,null,true);
  log.info("Fetching replication statuses from metadata table");
  Map<String,Status> fileToStatus=getMetadataStatusForTable(table);
  Assert.assertEquals("Expected to only find one replication status message",1,fileToStatus.size());
  String walName=fileToStatus.keySet().iterator().next();
  Assert.assertTrue("Expected log file name from tablet to equal replication entry",wals.contains(walName));
  Status status=fileToStatus.get(walName);
  Assert.assertEquals("Expected Status for file to not be closed",false,status.getClosed());
  Set<String> filesForTable=getFilesForTable(table);
  Assert.assertEquals("Expected to only find one rfile for table",1,filesForTable.size());
  log.info("Files for table before MajC: {}",filesForTable);
  conn.tableOperations().compact(table,null,null,false,true);
  Set<String> filesForTableAfterCompaction=getFilesForTable(table);
  log.info("Files for table after MajC: {}",filesForTableAfterCompaction);
  Assert.assertEquals("Expected to only find one rfile for table",1,filesForTableAfterCompaction.size());
  Assert.assertNotEquals("Expected the files before and after compaction to differ",filesForTableAfterCompaction,filesForTable);
  Path fileToBeDeleted=new Path(filesForTable.iterator().next());
  FileSystem fs=getCluster().getFileSystem();
  boolean fileExists=fs.exists(fileToBeDeleted);
  while (fileExists) {
    log.info("File which should get deleted still exists: {}",fileToBeDeleted);
    Thread.sleep(2000);
    fileExists=fs.exists(fileToBeDeleted);
  }
  Map<String,Status> fileToStatusAfterMinc=getMetadataStatusForTable(table);
  Assert.assertEquals("Expected to still find only one replication status message: " + fileToStatusAfterMinc,1,fileToStatusAfterMinc.size());
  conn.tableOperations().create(otherTable);
  bw=conn.createBatchWriter(otherTable,null);
  byte[] bigValue=new byte[1024 * 500];
  Arrays.fill(bigValue,(byte)1);
  for (int i=0; i < 50; i++) {
    Mutation m=new Mutation(Integer.toString(i));
    m.put(empty,empty,bigValue);
    bw.addMutation(m);
    if (i % 10 == 0) {
      bw.flush();
    }
  }
  bw.close();
  conn.tableOperations().flush(otherTable,null,null,true);
  final ClientContext context=new ClientContext(conn.getInstance(),new Credentials("root",new PasswordToken(ConfigurableMacBase.ROOT_PASSWORD)),getClientConfig());
  List<String> tservers=MasterClient.execute(context,new ClientExecReturn<List<String>,MasterClientService.Client>(){
    @Override public List<String> execute(    MasterClientService.Client client) throws Exception {
      return client.getActiveTservers(Tracer.traceInfo(),context.rpcCreds());
    }
  }
);
  Assert.assertEquals("Expected only one active tservers",1,tservers.size());
  HostAndPort tserver=HostAndPort.fromString(tservers.get(0));
  log.info("Fetching active WALs from {}",tserver);
  Client client=ThriftUtil.getTServerClient(tserver,context);
  List<String> activeWalsForTserver=client.getActiveLogs(Tracer.traceInfo(),context.rpcCreds());
  log.info("Active wals: {}",activeWalsForTserver);
  Assert.assertEquals("Expected to find only one active WAL",1,activeWalsForTserver.size());
  String activeWal=new Path(activeWalsForTserver.get(0)).toString();
  Assert.assertNotEquals("Current active WAL on tserver should not be the original WAL we saw",walName,activeWal);
  log.info("Ensuring that replication status does get closed after WAL is no longer in use by Tserver");
  do {
    Map<String,Status> replicationStatuses=getMetadataStatusForTable(table);
    log.info("Got replication status messages {}",replicationStatuses);
    Assert.assertEquals("Did not expect to find additional status records",1,replicationStatuses.size());
    status=replicationStatuses.values().iterator().next();
    log.info("Current status: {}",ProtobufUtil.toString(status));
    if (status.getClosed()) {
      return;
    }
    log.info("Status is not yet closed, waiting for garbage collector to close it");
    Thread.sleep(2000);
  }
 while (true);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.replication.MultiInstanceReplicationIT </h4><pre class="type-9 type-13 type-8 type-5 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=10 * 60 * 1000) public void dataWasReplicatedToThePeer() throws Exception {
  MiniAccumuloConfigImpl peerCfg=new MiniAccumuloConfigImpl(createTestDir(this.getClass().getName() + "_" + this.testName.getMethodName()+ "_peer"),ROOT_PASSWORD);
  peerCfg.setNumTservers(1);
  peerCfg.setInstanceName("peer");
  peerCfg.setProperty(Property.REPLICATION_NAME,"peer");
  updatePeerConfigFromPrimary(getCluster().getConfig(),peerCfg);
  MiniAccumuloClusterImpl peerCluster=new MiniAccumuloClusterImpl(peerCfg);
  peerCluster.start();
  try {
    final Connector connMaster=getConnector();
    final Connector connPeer=peerCluster.getConnector("root",new PasswordToken(ROOT_PASSWORD));
    ReplicationTable.setOnline(connMaster);
    String peerUserName="peer", peerPassword="foo";
    String peerClusterName="peer";
    connPeer.securityOperations().createLocalUser(peerUserName,new PasswordToken(peerPassword));
    connMaster.instanceOperations().setProperty(Property.REPLICATION_PEER_USER.getKey() + peerClusterName,peerUserName);
    connMaster.instanceOperations().setProperty(Property.REPLICATION_PEER_PASSWORD.getKey() + peerClusterName,peerPassword);
    connMaster.instanceOperations().setProperty(Property.REPLICATION_PEERS.getKey() + peerClusterName,ReplicaSystemFactory.getPeerConfigurationValue(AccumuloReplicaSystem.class,AccumuloReplicaSystem.buildConfiguration(peerCluster.getInstanceName(),peerCluster.getZooKeepers())));
    final String masterTable="master", peerTable="peer";
    connMaster.tableOperations().create(masterTable);
    String masterTableId=connMaster.tableOperations().tableIdMap().get(masterTable);
    Assert.assertNotNull(masterTableId);
    connPeer.tableOperations().create(peerTable);
    String peerTableId=connPeer.tableOperations().tableIdMap().get(peerTable);
    Assert.assertNotNull(peerTableId);
    connPeer.securityOperations().grantTablePermission(peerUserName,peerTable,TablePermission.WRITE);
    connMaster.tableOperations().setProperty(masterTable,Property.TABLE_REPLICATION.getKey(),"true");
    connMaster.tableOperations().setProperty(masterTable,Property.TABLE_REPLICATION_TARGET.getKey() + peerClusterName,peerTableId);
    BatchWriter bw=connMaster.createBatchWriter(masterTable,new BatchWriterConfig());
    for (int rows=0; rows < 5000; rows++) {
      Mutation m=new Mutation(Integer.toString(rows));
      for (int cols=0; cols < 100; cols++) {
        String value=Integer.toString(cols);
        m.put(value,"",value);
      }
      bw.addMutation(m);
    }
    bw.close();
    log.info("Wrote all data to master cluster");
    final Set<String> filesNeedingReplication=connMaster.replicationOperations().referencedFiles(masterTable);
    log.info("Files to replicate: " + filesNeedingReplication);
    for (    ProcessReference proc : cluster.getProcesses().get(ServerType.TABLET_SERVER)) {
      cluster.killProcess(ServerType.TABLET_SERVER,proc);
    }
    cluster.exec(TabletServer.class);
    log.info("TabletServer restarted");
    Iterators.size(ReplicationTable.getScanner(connMaster).iterator());
    log.info("TabletServer is online");
    while (!ReplicationTable.isOnline(connMaster)) {
      log.info("Replication table still offline, waiting");
      Thread.sleep(5000);
    }
    log.info("");
    log.info("Fetching metadata records:");
    for (    Entry<Key,Value> kv : connMaster.createScanner(MetadataTable.NAME,Authorizations.EMPTY)) {
      if (ReplicationSection.COLF.equals(kv.getKey().getColumnFamily())) {
        log.info(kv.getKey().toStringNoTruncate() + " " + ProtobufUtil.toString(Status.parseFrom(kv.getValue().get())));
      }
 else {
        log.info(kv.getKey().toStringNoTruncate() + " " + kv.getValue());
      }
    }
    log.info("");
    log.info("Fetching replication records:");
    for (    Entry<Key,Value> kv : ReplicationTable.getScanner(connMaster)) {
      log.info(kv.getKey().toStringNoTruncate() + " " + ProtobufUtil.toString(Status.parseFrom(kv.getValue().get())));
    }
    Future<Boolean> future=executor.submit(new Callable<Boolean>(){
      @Override public Boolean call() throws Exception {
        long then=System.currentTimeMillis();
        connMaster.replicationOperations().drain(masterTable,filesNeedingReplication);
        long now=System.currentTimeMillis();
        log.info("Drain completed in " + (now - then) + "ms");
        return true;
      }
    }
);
    try {
      future.get(60,TimeUnit.SECONDS);
    }
 catch (    TimeoutException e) {
      future.cancel(true);
      Assert.fail("Drain did not finish within 60 seconds");
    }
 finally {
      executor.shutdownNow();
    }
    log.info("drain completed");
    log.info("");
    log.info("Fetching metadata records:");
    for (    Entry<Key,Value> kv : connMaster.createScanner(MetadataTable.NAME,Authorizations.EMPTY)) {
      if (ReplicationSection.COLF.equals(kv.getKey().getColumnFamily())) {
        log.info(kv.getKey().toStringNoTruncate() + " " + ProtobufUtil.toString(Status.parseFrom(kv.getValue().get())));
      }
 else {
        log.info(kv.getKey().toStringNoTruncate() + " " + kv.getValue());
      }
    }
    log.info("");
    log.info("Fetching replication records:");
    for (    Entry<Key,Value> kv : ReplicationTable.getScanner(connMaster)) {
      log.info(kv.getKey().toStringNoTruncate() + " " + ProtobufUtil.toString(Status.parseFrom(kv.getValue().get())));
    }
    Scanner master=connMaster.createScanner(masterTable,Authorizations.EMPTY), peer=connPeer.createScanner(peerTable,Authorizations.EMPTY);
    Iterator<Entry<Key,Value>> masterIter=master.iterator(), peerIter=peer.iterator();
    Entry<Key,Value> masterEntry=null, peerEntry=null;
    while (masterIter.hasNext() && peerIter.hasNext()) {
      masterEntry=masterIter.next();
      peerEntry=peerIter.next();
      Assert.assertEquals(masterEntry.getKey() + " was not equal to " + peerEntry.getKey(),0,masterEntry.getKey().compareTo(peerEntry.getKey(),PartialKey.ROW_COLFAM_COLQUAL_COLVIS));
      Assert.assertEquals(masterEntry.getValue(),peerEntry.getValue());
    }
    log.info("Last master entry: " + masterEntry);
    log.info("Last peer entry: " + peerEntry);
    Assert.assertFalse("Had more data to read from the master",masterIter.hasNext());
    Assert.assertFalse("Had more data to read from the peer",peerIter.hasNext());
  }
  finally {
    peerCluster.stop();
  }
}

</code></pre>

<br>
<pre class="type-9 type-13 type-5 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void dataWasReplicatedToThePeerWithoutDrain() throws Exception {
  MiniAccumuloConfigImpl peerCfg=new MiniAccumuloConfigImpl(createTestDir(this.getClass().getName() + "_" + this.testName.getMethodName()+ "_peer"),ROOT_PASSWORD);
  peerCfg.setNumTservers(1);
  peerCfg.setInstanceName("peer");
  peerCfg.setProperty(Property.REPLICATION_NAME,"peer");
  updatePeerConfigFromPrimary(getCluster().getConfig(),peerCfg);
  MiniAccumuloClusterImpl peerCluster=new MiniAccumuloClusterImpl(peerCfg);
  peerCluster.start();
  Connector connMaster=getConnector();
  Connector connPeer=peerCluster.getConnector("root",new PasswordToken(ROOT_PASSWORD));
  String peerUserName="repl";
  String peerPassword="passwd";
  connPeer.securityOperations().createLocalUser(peerUserName,new PasswordToken(peerPassword));
  String peerClusterName="peer";
  connMaster.instanceOperations().setProperty(Property.REPLICATION_PEERS.getKey() + peerClusterName,ReplicaSystemFactory.getPeerConfigurationValue(AccumuloReplicaSystem.class,AccumuloReplicaSystem.buildConfiguration(peerCluster.getInstanceName(),peerCluster.getZooKeepers())));
  connMaster.instanceOperations().setProperty(Property.REPLICATION_PEER_USER.getKey() + peerClusterName,peerUserName);
  connMaster.instanceOperations().setProperty(Property.REPLICATION_PEER_PASSWORD.getKey() + peerClusterName,peerPassword);
  String masterTable="master", peerTable="peer";
  connMaster.tableOperations().create(masterTable);
  String masterTableId=connMaster.tableOperations().tableIdMap().get(masterTable);
  Assert.assertNotNull(masterTableId);
  connPeer.tableOperations().create(peerTable);
  String peerTableId=connPeer.tableOperations().tableIdMap().get(peerTable);
  Assert.assertNotNull(peerTableId);
  connPeer.securityOperations().grantTablePermission(peerUserName,peerTable,TablePermission.WRITE);
  connMaster.tableOperations().setProperty(masterTable,Property.TABLE_REPLICATION.getKey(),"true");
  connMaster.tableOperations().setProperty(masterTable,Property.TABLE_REPLICATION_TARGET.getKey() + peerClusterName,peerTableId);
  BatchWriter bw=connMaster.createBatchWriter(masterTable,new BatchWriterConfig());
  for (int rows=0; rows < 5000; rows++) {
    Mutation m=new Mutation(Integer.toString(rows));
    for (int cols=0; cols < 100; cols++) {
      String value=Integer.toString(cols);
      m.put(value,"",value);
    }
    bw.addMutation(m);
  }
  bw.close();
  log.info("Wrote all data to master cluster");
  Set<String> files=connMaster.replicationOperations().referencedFiles(masterTable);
  log.info("Files to replicate:" + files);
  for (  ProcessReference proc : cluster.getProcesses().get(ServerType.TABLET_SERVER)) {
    cluster.killProcess(ServerType.TABLET_SERVER,proc);
  }
  cluster.exec(TabletServer.class);
  while (!ReplicationTable.isOnline(connMaster)) {
    log.info("Replication table still offline, waiting");
    Thread.sleep(5000);
  }
  Iterators.size(connMaster.createScanner(masterTable,Authorizations.EMPTY).iterator());
  for (  Entry<Key,Value> kv : ReplicationTable.getScanner(connMaster)) {
    log.debug(kv.getKey().toStringNoTruncate() + " " + ProtobufUtil.toString(Status.parseFrom(kv.getValue().get())));
  }
  connMaster.replicationOperations().drain(masterTable,files);
  Scanner master=connMaster.createScanner(masterTable,Authorizations.EMPTY), peer=connPeer.createScanner(peerTable,Authorizations.EMPTY);
  Iterator<Entry<Key,Value>> masterIter=master.iterator(), peerIter=peer.iterator();
  while (masterIter.hasNext() && peerIter.hasNext()) {
    Entry<Key,Value> masterEntry=masterIter.next(), peerEntry=peerIter.next();
    Assert.assertEquals(peerEntry.getKey() + " was not equal to " + peerEntry.getKey(),0,masterEntry.getKey().compareTo(peerEntry.getKey(),PartialKey.ROW_COLFAM_COLQUAL_COLVIS));
    Assert.assertEquals(masterEntry.getValue(),peerEntry.getValue());
  }
  Assert.assertFalse("Had more data to read from the master",masterIter.hasNext());
  Assert.assertFalse("Had more data to read from the peer",peerIter.hasNext());
  peerCluster.stop();
}

</code></pre>

<br>
<pre class="type-9 type-13 type-5 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void dataReplicatedToCorrectTableWithoutDrain() throws Exception {
  MiniAccumuloConfigImpl peerCfg=new MiniAccumuloConfigImpl(createTestDir(this.getClass().getName() + "_" + this.testName.getMethodName()+ "_peer"),ROOT_PASSWORD);
  peerCfg.setNumTservers(1);
  peerCfg.setInstanceName("peer");
  peerCfg.setProperty(Property.REPLICATION_NAME,"peer");
  updatePeerConfigFromPrimary(getCluster().getConfig(),peerCfg);
  MiniAccumuloClusterImpl peer1Cluster=new MiniAccumuloClusterImpl(peerCfg);
  peer1Cluster.start();
  try {
    Connector connMaster=getConnector();
    Connector connPeer=peer1Cluster.getConnector("root",new PasswordToken(ROOT_PASSWORD));
    String peerClusterName="peer";
    String peerUserName="repl";
    String peerPassword="passwd";
    connPeer.securityOperations().createLocalUser(peerUserName,new PasswordToken(peerPassword));
    connMaster.instanceOperations().setProperty(Property.REPLICATION_PEER_USER.getKey() + peerClusterName,peerUserName);
    connMaster.instanceOperations().setProperty(Property.REPLICATION_PEER_PASSWORD.getKey() + peerClusterName,peerPassword);
    connMaster.instanceOperations().setProperty(Property.REPLICATION_PEERS.getKey() + peerClusterName,ReplicaSystemFactory.getPeerConfigurationValue(AccumuloReplicaSystem.class,AccumuloReplicaSystem.buildConfiguration(peer1Cluster.getInstanceName(),peer1Cluster.getZooKeepers())));
    String masterTable1="master1", peerTable1="peer1", masterTable2="master2", peerTable2="peer2";
    connMaster.tableOperations().create(masterTable1);
    String masterTableId1=connMaster.tableOperations().tableIdMap().get(masterTable1);
    Assert.assertNotNull(masterTableId1);
    connMaster.tableOperations().create(masterTable2);
    String masterTableId2=connMaster.tableOperations().tableIdMap().get(masterTable2);
    Assert.assertNotNull(masterTableId2);
    connPeer.tableOperations().create(peerTable1);
    String peerTableId1=connPeer.tableOperations().tableIdMap().get(peerTable1);
    Assert.assertNotNull(peerTableId1);
    connPeer.tableOperations().create(peerTable2);
    String peerTableId2=connPeer.tableOperations().tableIdMap().get(peerTable2);
    Assert.assertNotNull(peerTableId2);
    connPeer.securityOperations().grantTablePermission(peerUserName,peerTable1,TablePermission.WRITE);
    connPeer.securityOperations().grantTablePermission(peerUserName,peerTable2,TablePermission.WRITE);
    connMaster.tableOperations().setProperty(masterTable1,Property.TABLE_REPLICATION.getKey(),"true");
    connMaster.tableOperations().setProperty(masterTable1,Property.TABLE_REPLICATION_TARGET.getKey() + peerClusterName,peerTableId1);
    connMaster.tableOperations().setProperty(masterTable2,Property.TABLE_REPLICATION.getKey(),"true");
    connMaster.tableOperations().setProperty(masterTable2,Property.TABLE_REPLICATION_TARGET.getKey() + peerClusterName,peerTableId2);
    BatchWriter bw=connMaster.createBatchWriter(masterTable1,new BatchWriterConfig());
    for (int rows=0; rows < 2500; rows++) {
      Mutation m=new Mutation(masterTable1 + rows);
      for (int cols=0; cols < 100; cols++) {
        String value=Integer.toString(cols);
        m.put(value,"",value);
      }
      bw.addMutation(m);
    }
    bw.close();
    bw=connMaster.createBatchWriter(masterTable2,new BatchWriterConfig());
    for (int rows=0; rows < 2500; rows++) {
      Mutation m=new Mutation(masterTable2 + rows);
      for (int cols=0; cols < 100; cols++) {
        String value=Integer.toString(cols);
        m.put(value,"",value);
      }
      bw.addMutation(m);
    }
    bw.close();
    log.info("Wrote all data to master cluster");
    for (    ProcessReference proc : cluster.getProcesses().get(ServerType.TABLET_SERVER)) {
      cluster.killProcess(ServerType.TABLET_SERVER,proc);
    }
    cluster.exec(TabletServer.class);
    while (!ReplicationTable.isOnline(connMaster)) {
      log.info("Replication table still offline, waiting");
      Thread.sleep(5000);
    }
    boolean fullyReplicated=false;
    for (int i=0; i < 10 && !fullyReplicated; i++) {
      sleepUninterruptibly(2,TimeUnit.SECONDS);
      Scanner s=ReplicationTable.getScanner(connMaster);
      WorkSection.limit(s);
      for (      Entry<Key,Value> entry : s) {
        Status status=Status.parseFrom(entry.getValue().get());
        if (StatusUtil.isFullyReplicated(status)) {
          fullyReplicated|=true;
        }
      }
    }
    Assert.assertNotEquals(0,fullyReplicated);
    long countTable=0l;
    for (int i=0; i < 10; i++) {
      for (      Entry<Key,Value> entry : connPeer.createScanner(peerTable1,Authorizations.EMPTY)) {
        countTable++;
        Assert.assertTrue("Found unexpected key-value" + entry.getKey().toStringNoTruncate() + " "+ entry.getValue(),entry.getKey().getRow().toString().startsWith(masterTable1));
      }
      log.info("Found {} records in {}",countTable,peerTable1);
      if (0l == countTable) {
        Thread.sleep(5000);
      }
 else {
        break;
      }
    }
    Assert.assertTrue("Found no records in " + peerTable1 + " in the peer cluster",countTable > 0);
    for (int i=0; i < 10; i++) {
      countTable=0l;
      for (      Entry<Key,Value> entry : connPeer.createScanner(peerTable2,Authorizations.EMPTY)) {
        countTable++;
        Assert.assertTrue("Found unexpected key-value" + entry.getKey().toStringNoTruncate() + " "+ entry.getValue(),entry.getKey().getRow().toString().startsWith(masterTable2));
      }
      log.info("Found {} records in {}",countTable,peerTable2);
      if (0l == countTable) {
        Thread.sleep(5000);
      }
 else {
        break;
      }
    }
    Assert.assertTrue("Found no records in " + peerTable2 + " in the peer cluster",countTable > 0);
  }
  finally {
    peer1Cluster.stop();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.replication.ReplicationIT </h4><pre class="type-9 type-13 type-8 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void correctRecordsCompleteFile() throws Exception {
  Connector conn=getConnector();
  String table="table1";
  conn.tableOperations().create(table);
  conn.tableOperations().setProperty(table,Property.TABLE_REPLICATION.getKey(),"true");
  BatchWriter bw=conn.createBatchWriter(table,new BatchWriterConfig());
  for (int i=0; i < 10; i++) {
    Mutation m=new Mutation(Integer.toString(i));
    m.put(new byte[0],new byte[0],new byte[0]);
    bw.addMutation(m);
  }
  bw.close();
  boolean online=ReplicationTable.isOnline(conn);
  int attempts=10;
  do {
    if (!online) {
      sleepUninterruptibly(2,TimeUnit.SECONDS);
      online=ReplicationTable.isOnline(conn);
      attempts--;
    }
  }
 while (!online && attempts > 0);
  Assert.assertTrue("Replication table was not online",online);
  for (int i=0; i < 5; i++) {
    if (conn.securityOperations().hasTablePermission("root",ReplicationTable.NAME,TablePermission.READ)) {
      break;
    }
    log.info("Could not read replication table, waiting and will retry");
    Thread.sleep(2000);
  }
  Assert.assertTrue("'root' user could not read the replication table",conn.securityOperations().hasTablePermission("root",ReplicationTable.NAME,TablePermission.READ));
  Set<String> replRows=new HashSet<>();
  Scanner scanner;
  attempts=5;
  while (replRows.isEmpty() && attempts > 0) {
    scanner=ReplicationTable.getScanner(conn);
    StatusSection.limit(scanner);
    for (    Entry<Key,Value> entry : scanner) {
      Key k=entry.getKey();
      String fileUri=k.getRow().toString();
      try {
        new URI(fileUri);
      }
 catch (      URISyntaxException e) {
        Assert.fail("Expected a valid URI: " + fileUri);
      }
      replRows.add(fileUri);
    }
  }
  Set<String> wals=new HashSet<>();
  attempts=5;
  Instance i=conn.getInstance();
  ZooReaderWriter zk=new ZooReaderWriter(i.getZooKeepers(),i.getZooKeepersSessionTimeOut(),"");
  while (wals.isEmpty() && attempts > 0) {
    WalStateManager markers=new WalStateManager(i,zk);
    for (    Entry<Path,WalState> entry : markers.getAllState().entrySet()) {
      wals.add(entry.getKey().toString());
    }
    attempts--;
  }
  Assert.assertEquals("Rows found: " + replRows,1,replRows.size());
  replRows.removeAll(wals);
  Assert.assertEquals(2,wals.size());
  Assert.assertEquals(0,replRows.size());
}

</code></pre>

<br>
<pre class="type-9 type-13 type-11 type-8 type-5 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void replicatedStatusEntriesAreDeleted() throws Exception {
  getCluster().getClusterControl().stop(ServerType.GARBAGE_COLLECTOR);
  final Connector conn=getConnector();
  log.info("Got connector to MAC");
  String table1="table1";
  Assert.assertFalse(ReplicationTable.isOnline(conn));
  conn.tableOperations().create(table1);
  int attempts=5;
  while (attempts > 0) {
    try {
      conn.tableOperations().setProperty(table1,Property.TABLE_REPLICATION.getKey(),"true");
      conn.tableOperations().setProperty(table1,Property.TABLE_REPLICATION_TARGET.getKey() + "cluster1","4");
      conn.instanceOperations().setProperty(Property.REPLICATION_PEERS.getKey() + "cluster1",ReplicaSystemFactory.getPeerConfigurationValue(MockReplicaSystem.class,"1000"));
      attempts=0;
    }
 catch (    Exception e) {
      attempts--;
      if (attempts <= 0) {
        throw e;
      }
      sleepUninterruptibly(500,TimeUnit.MILLISECONDS);
    }
  }
  String tableId=conn.tableOperations().tableIdMap().get(table1);
  Assert.assertNotNull("Could not determine table id for " + table1,tableId);
  writeSomeData(conn,table1,2000,50);
  conn.tableOperations().flush(table1,null,null,true);
  boolean online=ReplicationTable.isOnline(conn);
  attempts=10;
  do {
    if (!online) {
      sleepUninterruptibly(1,TimeUnit.SECONDS);
      online=ReplicationTable.isOnline(conn);
      attempts--;
    }
  }
 while (!online && attempts > 0);
  Assert.assertTrue("Replication table did not exist",online);
  conn.securityOperations().grantTablePermission("root",ReplicationTable.NAME,TablePermission.WRITE);
  log.info("Checking for replication entries in replication");
  Scanner s;
  Set<String> entries=new HashSet<>();
  for (int i=0; i < 5; i++) {
    s=conn.createScanner(MetadataTable.NAME,Authorizations.EMPTY);
    s.setRange(ReplicationSection.getRange());
    entries.clear();
    for (    Entry<Key,Value> entry : s) {
      entries.add(entry.getKey().getRow().toString());
      log.info("{}={}",entry.getKey().toStringNoTruncate(),entry.getValue());
    }
    if (!entries.isEmpty()) {
      log.info("Replication entries {}",entries);
      break;
    }
    Thread.sleep(1000);
  }
  Assert.assertFalse("Did not find any replication entries in the replication table",entries.isEmpty());
  boolean notFound=true;
  for (int i=0; i < 10 && notFound; i++) {
    try {
      s=ReplicationTable.getScanner(conn);
      WorkSection.limit(s);
      Entry<Key,Value> e=Iterables.getOnlyElement(s);
      log.info("Found entry: " + e.getKey().toStringNoTruncate());
      Text expectedColqual=new ReplicationTarget("cluster1","4",tableId).toText();
      Assert.assertEquals(expectedColqual,e.getKey().getColumnQualifier());
      notFound=false;
    }
 catch (    NoSuchElementException e) {
    }
catch (    IllegalArgumentException e) {
      s=ReplicationTable.getScanner(conn);
      for (      Entry<Key,Value> content : s) {
        log.info(content.getKey().toStringNoTruncate() + " => " + content.getValue());
      }
      Assert.fail("Found more than one work section entry");
    }
catch (    RuntimeException e) {
      Throwable cause=e.getCause();
      if (cause instanceof AccumuloSecurityException) {
        AccumuloSecurityException sec=(AccumuloSecurityException)cause;
switch (sec.getSecurityErrorCode()) {
case PERMISSION_DENIED:
          log.warn("Sleeping because permission was denied");
        break;
default :
      throw e;
  }
}
 else {
  throw e;
}
}
Thread.sleep(2000);
}
if (notFound) {
s=ReplicationTable.getScanner(conn);
for (Entry<Key,Value> content : s) {
log.info(content.getKey().toStringNoTruncate() + " => " + ProtobufUtil.toString(Status.parseFrom(content.getValue().get())));
}
Assert.assertFalse("Did not find the work entry for the status entry",notFound);
}
log.info("Killing tserver");
cluster.getClusterControl().stop(ServerType.TABLET_SERVER);
log.info("Starting tserver");
cluster.getClusterControl().start(ServerType.TABLET_SERVER);
log.info("Waiting to read tables");
sleepUninterruptibly(2 * 3,TimeUnit.SECONDS);
for (String table : new String[]{MetadataTable.NAME,table1}) {
Iterators.size(conn.createScanner(table,Authorizations.EMPTY).iterator());
}
log.info("Recovered metadata:");
s=conn.createScanner(MetadataTable.NAME,Authorizations.EMPTY);
for (Entry<Key,Value> entry : s) {
log.info("{}={}",entry.getKey().toStringNoTruncate(),entry.getValue());
}
cluster.getClusterControl().start(ServerType.GARBAGE_COLLECTOR);
waitForGCLock(conn);
Thread.sleep(1000);
log.info("After GC");
s=conn.createScanner(MetadataTable.NAME,Authorizations.EMPTY);
for (Entry<Key,Value> entry : s) {
log.info("{}={}",entry.getKey().toStringNoTruncate(),entry.getValue());
}
log.info("Checking metadata table for replication entries");
Set<String> remaining=new HashSet<>();
for (int i=0; i < 10; i++) {
s=conn.createScanner(MetadataTable.NAME,Authorizations.EMPTY);
s.setRange(ReplicationSection.getRange());
remaining.clear();
for (Entry<Key,Value> e : s) {
remaining.add(e.getKey().getRow().toString());
}
remaining.retainAll(entries);
if (remaining.isEmpty()) {
break;
}
log.info("remaining {}",remaining);
Thread.sleep(2000);
log.info("");
}
Assert.assertTrue("Replication status messages were not cleaned up from metadata table",remaining.isEmpty());
int recordsFound=0;
for (int i=0; i < 30; i++) {
s=ReplicationTable.getScanner(conn);
recordsFound=0;
for (Entry<Key,Value> entry : s) {
recordsFound++;
log.info("{} {}",entry.getKey().toStringNoTruncate(),ProtobufUtil.toString(Status.parseFrom(entry.getValue().get())));
}
if (recordsFound <= 2) {
break;
}
 else {
Thread.sleep(1000);
log.info("");
}
}
Assert.assertTrue("Found unexpected replication records in the replication table",recordsFound <= 2);
}

</code></pre>

<br>
<pre class="type-9 type-13 type-11 type-8 type-5 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void correctClusterNameInWorkEntry() throws Exception {
  Connector conn=getConnector();
  String table1="table1";
  Assert.assertFalse(ReplicationTable.isOnline(conn));
  conn.tableOperations().create(table1);
  int attempts=5;
  while (attempts > 0) {
    try {
      conn.tableOperations().setProperty(table1,Property.TABLE_REPLICATION.getKey(),"true");
      conn.tableOperations().setProperty(table1,Property.TABLE_REPLICATION_TARGET.getKey() + "cluster1","4");
      attempts=0;
    }
 catch (    Exception e) {
      attempts--;
      if (attempts <= 0) {
        throw e;
      }
      sleepUninterruptibly(500,TimeUnit.MILLISECONDS);
    }
  }
  writeSomeData(conn,table1,2000,50);
  conn.tableOperations().flush(table1,null,null,true);
  String tableId=conn.tableOperations().tableIdMap().get(table1);
  Assert.assertNotNull("Table ID was null",tableId);
  boolean online=ReplicationTable.isOnline(conn);
  attempts=5;
  do {
    if (!online) {
      sleepUninterruptibly(500,TimeUnit.MILLISECONDS);
      online=ReplicationTable.isOnline(conn);
      attempts--;
    }
  }
 while (!online && attempts > 0);
  Assert.assertTrue("Replication table did not exist",online);
  for (int i=0; i < 5 && !conn.securityOperations().hasTablePermission("root",ReplicationTable.NAME,TablePermission.READ); i++) {
    Thread.sleep(1000);
  }
  Assert.assertTrue(conn.securityOperations().hasTablePermission("root",ReplicationTable.NAME,TablePermission.READ));
  boolean notFound=true;
  Scanner s;
  for (int i=0; i < 10 && notFound; i++) {
    s=ReplicationTable.getScanner(conn);
    WorkSection.limit(s);
    try {
      Entry<Key,Value> e=Iterables.getOnlyElement(s);
      Text expectedColqual=new ReplicationTarget("cluster1","4",tableId).toText();
      Assert.assertEquals(expectedColqual,e.getKey().getColumnQualifier());
      notFound=false;
    }
 catch (    NoSuchElementException e) {
    }
catch (    IllegalArgumentException e) {
      s=ReplicationTable.getScanner(conn);
      for (      Entry<Key,Value> content : s) {
        log.info(content.getKey().toStringNoTruncate() + " => " + content.getValue());
      }
      Assert.fail("Found more than one work section entry");
    }
    Thread.sleep(500);
  }
  if (notFound) {
    s=ReplicationTable.getScanner(conn);
    for (    Entry<Key,Value> content : s) {
      log.info(content.getKey().toStringNoTruncate() + " => " + content.getValue());
    }
    Assert.assertFalse("Did not find the work entry for the status entry",notFound);
  }
}

</code></pre>

<br>
<pre class="type-9 type-13 type-11 type-5 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void singleTableWithSingleTarget() throws Exception {
  getCluster().getClusterControl().stop(ServerType.GARBAGE_COLLECTOR);
  Connector conn=getConnector();
  String table1="table1";
  Assert.assertFalse(ReplicationTable.isOnline(conn));
  conn.tableOperations().create(table1);
  int attempts=10;
  while (attempts > 0) {
    try {
      conn.tableOperations().setProperty(table1,Property.TABLE_REPLICATION.getKey(),"true");
      conn.tableOperations().setProperty(table1,Property.TABLE_REPLICATION_TARGET.getKey() + "cluster1","4");
      conn.instanceOperations().setProperty(Property.REPLICATION_PEERS.getKey() + "cluster1",ReplicaSystemFactory.getPeerConfigurationValue(MockReplicaSystem.class,"100000"));
      break;
    }
 catch (    Exception e) {
      attempts--;
      if (attempts <= 0) {
        throw e;
      }
      sleepUninterruptibly(2,TimeUnit.SECONDS);
    }
  }
  writeSomeData(conn,table1,2000,50);
  boolean online=ReplicationTable.isOnline(conn);
  attempts=10;
  do {
    if (!online) {
      sleepUninterruptibly(2,TimeUnit.SECONDS);
      online=ReplicationTable.isOnline(conn);
      attempts--;
    }
  }
 while (!online && attempts > 0);
  Assert.assertTrue("Replication table was never created",online);
  for (int i=0; i < 10 && !conn.tableOperations().listIterators(ReplicationTable.NAME).keySet().contains(ReplicationTable.COMBINER_NAME); i++) {
    sleepUninterruptibly(2,TimeUnit.SECONDS);
  }
  Assert.assertTrue("Combiner was never set on replication table",conn.tableOperations().listIterators(ReplicationTable.NAME).keySet().contains(ReplicationTable.COMBINER_NAME));
  conn.tableOperations().flush(table1,null,null,true);
  Scanner s=ReplicationTable.getScanner(conn);
  StatusSection.limit(s);
  Entry<Key,Value> entry=null;
  Status expectedStatus=StatusUtil.openWithUnknownLength();
  attempts=10;
  while (null == entry && attempts > 0) {
    try {
      entry=Iterables.getOnlyElement(s);
      Status actual=Status.parseFrom(entry.getValue().get());
      if (actual.getInfiniteEnd() != expectedStatus.getInfiniteEnd()) {
        entry=null;
        Thread.sleep(1000);
      }
    }
 catch (    NoSuchElementException e) {
      entry=null;
      Thread.sleep(500);
    }
catch (    IllegalArgumentException e) {
      s=ReplicationTable.getScanner(conn);
      StatusSection.limit(s);
      for (      Entry<Key,Value> content : s) {
        log.info(content.getKey().toStringNoTruncate() + " => " + content.getValue());
      }
      throw e;
    }
 finally {
      attempts--;
    }
  }
  Assert.assertNotNull("Could not find expected entry in replication table",entry);
  Status actual=Status.parseFrom(entry.getValue().get());
  Assert.assertTrue("Expected to find a replication entry that is open with infinite length: " + ProtobufUtil.toString(actual),!actual.getClosed() && actual.getInfiniteEnd());
  boolean notFound=true;
  for (int i=0; i < 10 && notFound; i++) {
    s=ReplicationTable.getScanner(conn);
    WorkSection.limit(s);
    int elementsFound=Iterables.size(s);
    if (0 < elementsFound) {
      Assert.assertEquals(1,elementsFound);
      notFound=false;
    }
    Thread.sleep(500);
  }
  if (notFound) {
    s=ReplicationTable.getScanner(conn);
    for (    Entry<Key,Value> content : s) {
      log.info(content.getKey().toStringNoTruncate() + " => " + content.getValue());
    }
    Assert.assertFalse("Did not find the work entry for the status entry",notFound);
  }
  writeSomeData(conn,table1,3000,50);
  log.info("Issued compaction for table");
  conn.tableOperations().compact(table1,null,null,true,true);
  log.info("Compaction completed");
  Thread.sleep(5000);
  s=ReplicationTable.getScanner(conn);
  StatusSection.limit(s);
  int numRecords=0;
  for (  Entry<Key,Value> e : s) {
    numRecords++;
    log.info("Found status record {}\t{}",e.getKey().toStringNoTruncate(),ProtobufUtil.toString(Status.parseFrom(e.getValue().get())));
  }
  Assert.assertEquals(2,numRecords);
  notFound=true;
  for (int i=0; i < 10 && notFound; i++) {
    s=ReplicationTable.getScanner(conn);
    WorkSection.limit(s);
    int elementsFound=Iterables.size(s);
    if (2 == elementsFound) {
      notFound=false;
    }
    Thread.sleep(500);
  }
  if (notFound) {
    s=ReplicationTable.getScanner(conn);
    for (    Entry<Key,Value> content : s) {
      log.info(content.getKey().toStringNoTruncate() + " => " + content.getValue());
    }
    Assert.assertFalse("Did not find the work entries for the status entries",notFound);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.replication.StatusMakerIT </h4><pre class="type-9 type-13 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void closedMessagesCreateOrderRecords() throws Exception {
  String sourceTable=testName.getMethodName();
  conn.tableOperations().create(sourceTable);
  ReplicationTableUtil.configureMetadataTable(conn,sourceTable);
  BatchWriter bw=conn.createBatchWriter(sourceTable,new BatchWriterConfig());
  String walPrefix="hdfs://localhost:8020/accumulo/wals/tserver+port/";
  List<String> files=Arrays.asList(walPrefix + UUID.randomUUID(),walPrefix + UUID.randomUUID(),walPrefix + UUID.randomUUID(),walPrefix + UUID.randomUUID());
  Map<String,Integer> fileToTableId=new HashMap<>();
  Status.Builder statBuilder=Status.newBuilder().setBegin(0).setEnd(0).setInfiniteEnd(true).setClosed(true);
  int index=1;
  long time=System.currentTimeMillis();
  for (  String file : files) {
    statBuilder.setCreatedTime(time++);
    Mutation m=new Mutation(ReplicationSection.getRowPrefix() + file);
    m.put(ReplicationSection.COLF,new Text(Integer.toString(index)),ProtobufUtil.toValue(statBuilder.build()));
    bw.addMutation(m);
    fileToTableId.put(file,index);
    index++;
  }
  bw.close();
  StatusMaker statusMaker=new StatusMaker(conn);
  statusMaker.setSourceTableName(sourceTable);
  statusMaker.run();
  Scanner s=conn.createScanner(sourceTable,Authorizations.EMPTY);
  s.setRange(ReplicationSection.getRange());
  s.fetchColumnFamily(ReplicationSection.COLF);
  Assert.assertEquals(0,Iterables.size(s));
  s=ReplicationTable.getScanner(conn);
  OrderSection.limit(s);
  Iterator<Entry<Key,Value>> iter=s.iterator();
  Assert.assertTrue("Found no order records in replication table",iter.hasNext());
  Iterator<String> expectedFiles=files.iterator();
  Text buff=new Text();
  while (expectedFiles.hasNext() && iter.hasNext()) {
    String file=expectedFiles.next();
    Entry<Key,Value> entry=iter.next();
    Assert.assertEquals(file,OrderSection.getFile(entry.getKey(),buff));
    OrderSection.getTableId(entry.getKey(),buff);
    Assert.assertEquals(fileToTableId.get(file).intValue(),Integer.parseInt(buff.toString()));
  }
  Assert.assertFalse("Found more files unexpectedly",expectedFiles.hasNext());
  Assert.assertFalse("Found more entries in replication table unexpectedly",iter.hasNext());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.replication.UnorderedWorkAssignerReplicationIT </h4><pre class="type-9 type-13 type-5 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void dataReplicatedToCorrectTableWithoutDrain() throws Exception {
  MiniAccumuloConfigImpl peerCfg=new MiniAccumuloConfigImpl(createTestDir(this.getClass().getName() + "_" + this.testName.getMethodName()+ "_peer"),ROOT_PASSWORD);
  peerCfg.setNumTservers(1);
  peerCfg.setInstanceName("peer");
  updatePeerConfigFromPrimary(getCluster().getConfig(),peerCfg);
  peerCfg.setProperty(Property.REPLICATION_NAME,"peer");
  MiniAccumuloClusterImpl peer1Cluster=new MiniAccumuloClusterImpl(peerCfg);
  peer1Cluster.start();
  try {
    Connector connMaster=getConnector();
    Connector connPeer=peer1Cluster.getConnector("root",new PasswordToken(ROOT_PASSWORD));
    String peerClusterName="peer";
    String peerUserName="repl";
    String peerPassword="passwd";
    connPeer.securityOperations().createLocalUser(peerUserName,new PasswordToken(peerPassword));
    connMaster.instanceOperations().setProperty(Property.REPLICATION_PEER_USER.getKey() + peerClusterName,peerUserName);
    connMaster.instanceOperations().setProperty(Property.REPLICATION_PEER_PASSWORD.getKey() + peerClusterName,peerPassword);
    connMaster.instanceOperations().setProperty(Property.REPLICATION_PEERS.getKey() + peerClusterName,ReplicaSystemFactory.getPeerConfigurationValue(AccumuloReplicaSystem.class,AccumuloReplicaSystem.buildConfiguration(peer1Cluster.getInstanceName(),peer1Cluster.getZooKeepers())));
    String masterTable1="master1", peerTable1="peer1", masterTable2="master2", peerTable2="peer2";
    connMaster.tableOperations().create(masterTable1);
    String masterTableId1=connMaster.tableOperations().tableIdMap().get(masterTable1);
    Assert.assertNotNull(masterTableId1);
    connMaster.tableOperations().create(masterTable2);
    String masterTableId2=connMaster.tableOperations().tableIdMap().get(masterTable2);
    Assert.assertNotNull(masterTableId2);
    connPeer.tableOperations().create(peerTable1);
    String peerTableId1=connPeer.tableOperations().tableIdMap().get(peerTable1);
    Assert.assertNotNull(peerTableId1);
    connPeer.tableOperations().create(peerTable2);
    String peerTableId2=connPeer.tableOperations().tableIdMap().get(peerTable2);
    Assert.assertNotNull(peerTableId2);
    connPeer.securityOperations().grantTablePermission(peerUserName,peerTable1,TablePermission.WRITE);
    connPeer.securityOperations().grantTablePermission(peerUserName,peerTable2,TablePermission.WRITE);
    connMaster.tableOperations().setProperty(masterTable1,Property.TABLE_REPLICATION.getKey(),"true");
    connMaster.tableOperations().setProperty(masterTable1,Property.TABLE_REPLICATION_TARGET.getKey() + peerClusterName,peerTableId1);
    connMaster.tableOperations().setProperty(masterTable2,Property.TABLE_REPLICATION.getKey(),"true");
    connMaster.tableOperations().setProperty(masterTable2,Property.TABLE_REPLICATION_TARGET.getKey() + peerClusterName,peerTableId2);
    sleepUninterruptibly(3,TimeUnit.SECONDS);
    BatchWriter bw=connMaster.createBatchWriter(masterTable1,new BatchWriterConfig());
    for (int rows=0; rows < 2500; rows++) {
      Mutation m=new Mutation(masterTable1 + rows);
      for (int cols=0; cols < 100; cols++) {
        String value=Integer.toString(cols);
        m.put(value,"",value);
      }
      bw.addMutation(m);
    }
    bw.close();
    bw=connMaster.createBatchWriter(masterTable2,new BatchWriterConfig());
    for (int rows=0; rows < 2500; rows++) {
      Mutation m=new Mutation(masterTable2 + rows);
      for (int cols=0; cols < 100; cols++) {
        String value=Integer.toString(cols);
        m.put(value,"",value);
      }
      bw.addMutation(m);
    }
    bw.close();
    log.info("Wrote all data to master cluster");
    while (!ReplicationTable.isOnline(connMaster)) {
      Thread.sleep(500);
    }
    for (    ProcessReference proc : cluster.getProcesses().get(ServerType.TABLET_SERVER)) {
      cluster.killProcess(ServerType.TABLET_SERVER,proc);
    }
    cluster.exec(TabletServer.class);
    boolean fullyReplicated=false;
    for (int i=0; i < 10 && !fullyReplicated; i++) {
      sleepUninterruptibly(timeoutFactor * 2,TimeUnit.SECONDS);
      Scanner s=ReplicationTable.getScanner(connMaster);
      WorkSection.limit(s);
      for (      Entry<Key,Value> entry : s) {
        Status status=Status.parseFrom(entry.getValue().get());
        if (StatusUtil.isFullyReplicated(status)) {
          fullyReplicated|=true;
        }
      }
    }
    Assert.assertNotEquals(0,fullyReplicated);
    long countTable=0l;
    for (int i=0; i < 10; i++) {
      countTable=0l;
      for (      Entry<Key,Value> entry : connPeer.createScanner(peerTable1,Authorizations.EMPTY)) {
        countTable++;
        Assert.assertTrue("Found unexpected key-value" + entry.getKey().toStringNoTruncate() + " "+ entry.getValue(),entry.getKey().getRow().toString().startsWith(masterTable1));
      }
      log.info("Found {} records in {}",countTable,peerTable1);
      if (0 < countTable) {
        break;
      }
      Thread.sleep(2000);
    }
    Assert.assertTrue("Did not find any records in " + peerTable1 + " on peer",countTable > 0);
    for (int i=0; i < 10; i++) {
      countTable=0l;
      for (      Entry<Key,Value> entry : connPeer.createScanner(peerTable2,Authorizations.EMPTY)) {
        countTable++;
        Assert.assertTrue("Found unexpected key-value" + entry.getKey().toStringNoTruncate() + " "+ entry.getValue(),entry.getKey().getRow().toString().startsWith(masterTable2));
      }
      log.info("Found {} records in {}",countTable,peerTable2);
      if (0 < countTable) {
        break;
      }
      Thread.sleep(2000);
    }
    Assert.assertTrue("Did not find any records in " + peerTable2 + " on peer",countTable > 0);
  }
  finally {
    peer1Cluster.stop();
  }
}

</code></pre>

<br>
<pre class="type-9 type-13 type-5 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void dataWasReplicatedToThePeerWithoutDrain() throws Exception {
  MiniAccumuloConfigImpl peerCfg=new MiniAccumuloConfigImpl(createTestDir(this.getClass().getName() + "_" + this.testName.getMethodName()+ "_peer"),ROOT_PASSWORD);
  peerCfg.setNumTservers(1);
  peerCfg.setInstanceName("peer");
  updatePeerConfigFromPrimary(getCluster().getConfig(),peerCfg);
  peerCfg.setProperty(Property.REPLICATION_NAME,"peer");
  MiniAccumuloClusterImpl peerCluster=new MiniAccumuloClusterImpl(peerCfg);
  peerCluster.start();
  Connector connMaster=getConnector();
  Connector connPeer=peerCluster.getConnector("root",new PasswordToken(ROOT_PASSWORD));
  String peerUserName="repl";
  String peerPassword="passwd";
  connPeer.securityOperations().createLocalUser(peerUserName,new PasswordToken(peerPassword));
  String peerClusterName="peer";
  connMaster.instanceOperations().setProperty(Property.REPLICATION_PEERS.getKey() + peerClusterName,ReplicaSystemFactory.getPeerConfigurationValue(AccumuloReplicaSystem.class,AccumuloReplicaSystem.buildConfiguration(peerCluster.getInstanceName(),peerCluster.getZooKeepers())));
  connMaster.instanceOperations().setProperty(Property.REPLICATION_PEER_USER.getKey() + peerClusterName,peerUserName);
  connMaster.instanceOperations().setProperty(Property.REPLICATION_PEER_PASSWORD.getKey() + peerClusterName,peerPassword);
  String masterTable="master", peerTable="peer";
  connMaster.tableOperations().create(masterTable);
  String masterTableId=connMaster.tableOperations().tableIdMap().get(masterTable);
  Assert.assertNotNull(masterTableId);
  connPeer.tableOperations().create(peerTable);
  String peerTableId=connPeer.tableOperations().tableIdMap().get(peerTable);
  Assert.assertNotNull(peerTableId);
  connPeer.securityOperations().grantTablePermission(peerUserName,peerTable,TablePermission.WRITE);
  connMaster.tableOperations().setProperty(masterTable,Property.TABLE_REPLICATION.getKey(),"true");
  connMaster.tableOperations().setProperty(masterTable,Property.TABLE_REPLICATION_TARGET.getKey() + peerClusterName,peerTableId);
  BatchWriter bw=connMaster.createBatchWriter(masterTable,new BatchWriterConfig());
  for (int rows=0; rows < 5000; rows++) {
    Mutation m=new Mutation(Integer.toString(rows));
    for (int cols=0; cols < 100; cols++) {
      String value=Integer.toString(cols);
      m.put(value,"",value);
    }
    bw.addMutation(m);
  }
  bw.close();
  log.info("Wrote all data to master cluster");
  Set<String> files=connMaster.replicationOperations().referencedFiles(masterTable);
  for (  String s : files) {
    log.info("Found referenced file for " + masterTable + ": "+ s);
  }
  for (  ProcessReference proc : cluster.getProcesses().get(ServerType.TABLET_SERVER)) {
    cluster.killProcess(ServerType.TABLET_SERVER,proc);
  }
  cluster.exec(TabletServer.class);
  Iterators.size(connMaster.createScanner(masterTable,Authorizations.EMPTY).iterator());
  for (  Entry<Key,Value> kv : connMaster.createScanner(ReplicationTable.NAME,Authorizations.EMPTY)) {
    log.debug(kv.getKey().toStringNoTruncate() + " " + ProtobufUtil.toString(Status.parseFrom(kv.getValue().get())));
  }
  connMaster.replicationOperations().drain(masterTable,files);
  Scanner master=connMaster.createScanner(masterTable,Authorizations.EMPTY), peer=connPeer.createScanner(peerTable,Authorizations.EMPTY);
  Iterator<Entry<Key,Value>> masterIter=master.iterator(), peerIter=peer.iterator();
  Assert.assertTrue("No data in master table",masterIter.hasNext());
  Assert.assertTrue("No data in peer table",peerIter.hasNext());
  while (masterIter.hasNext() && peerIter.hasNext()) {
    Entry<Key,Value> masterEntry=masterIter.next(), peerEntry=peerIter.next();
    Assert.assertEquals(peerEntry.getKey() + " was not equal to " + peerEntry.getKey(),0,masterEntry.getKey().compareTo(peerEntry.getKey(),PartialKey.ROW_COLFAM_COLQUAL_COLVIS));
    Assert.assertEquals(masterEntry.getValue(),peerEntry.getValue());
  }
  Assert.assertFalse("Had more data to read from the master",masterIter.hasNext());
  Assert.assertFalse("Had more data to read from the peer",peerIter.hasNext());
  peerCluster.stop();
}

</code></pre>

<br>
<pre class="type-9 type-13 type-8 type-5 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void dataWasReplicatedToThePeer() throws Exception {
  MiniAccumuloConfigImpl peerCfg=new MiniAccumuloConfigImpl(createTestDir(this.getClass().getName() + "_" + this.testName.getMethodName()+ "_peer"),ROOT_PASSWORD);
  peerCfg.setNumTservers(1);
  peerCfg.setInstanceName("peer");
  updatePeerConfigFromPrimary(getCluster().getConfig(),peerCfg);
  peerCfg.setProperty(Property.REPLICATION_NAME,"peer");
  MiniAccumuloClusterImpl peerCluster=new MiniAccumuloClusterImpl(peerCfg);
  peerCluster.start();
  try {
    final Connector connMaster=getConnector();
    final Connector connPeer=peerCluster.getConnector("root",new PasswordToken(ROOT_PASSWORD));
    ReplicationTable.setOnline(connMaster);
    String peerUserName="peer", peerPassword="foo";
    String peerClusterName="peer";
    connPeer.securityOperations().createLocalUser(peerUserName,new PasswordToken(peerPassword));
    connMaster.instanceOperations().setProperty(Property.REPLICATION_PEER_USER.getKey() + peerClusterName,peerUserName);
    connMaster.instanceOperations().setProperty(Property.REPLICATION_PEER_PASSWORD.getKey() + peerClusterName,peerPassword);
    connMaster.instanceOperations().setProperty(Property.REPLICATION_PEERS.getKey() + peerClusterName,ReplicaSystemFactory.getPeerConfigurationValue(AccumuloReplicaSystem.class,AccumuloReplicaSystem.buildConfiguration(peerCluster.getInstanceName(),peerCluster.getZooKeepers())));
    final String masterTable="master", peerTable="peer";
    connMaster.tableOperations().create(masterTable);
    String masterTableId=connMaster.tableOperations().tableIdMap().get(masterTable);
    Assert.assertNotNull(masterTableId);
    connPeer.tableOperations().create(peerTable);
    String peerTableId=connPeer.tableOperations().tableIdMap().get(peerTable);
    Assert.assertNotNull(peerTableId);
    connPeer.securityOperations().grantTablePermission(peerUserName,peerTable,TablePermission.WRITE);
    connMaster.tableOperations().setProperty(masterTable,Property.TABLE_REPLICATION.getKey(),"true");
    connMaster.tableOperations().setProperty(masterTable,Property.TABLE_REPLICATION_TARGET.getKey() + peerClusterName,peerTableId);
    sleepUninterruptibly(3,TimeUnit.SECONDS);
    BatchWriter bw=connMaster.createBatchWriter(masterTable,new BatchWriterConfig());
    for (int rows=0; rows < 5000; rows++) {
      Mutation m=new Mutation(Integer.toString(rows));
      for (int cols=0; cols < 100; cols++) {
        String value=Integer.toString(cols);
        m.put(value,"",value);
      }
      bw.addMutation(m);
    }
    bw.close();
    log.info("Wrote all data to master cluster");
    final Set<String> filesNeedingReplication=connMaster.replicationOperations().referencedFiles(masterTable);
    for (    ProcessReference proc : cluster.getProcesses().get(ServerType.TABLET_SERVER)) {
      cluster.killProcess(ServerType.TABLET_SERVER,proc);
    }
    cluster.exec(TabletServer.class);
    log.info("TabletServer restarted");
    Iterators.size(ReplicationTable.getScanner(connMaster).iterator());
    log.info("TabletServer is online");
    log.info("");
    log.info("Fetching metadata records:");
    for (    Entry<Key,Value> kv : connMaster.createScanner(MetadataTable.NAME,Authorizations.EMPTY)) {
      if (ReplicationSection.COLF.equals(kv.getKey().getColumnFamily())) {
        log.info(kv.getKey().toStringNoTruncate() + " " + ProtobufUtil.toString(Status.parseFrom(kv.getValue().get())));
      }
 else {
        log.info(kv.getKey().toStringNoTruncate() + " " + kv.getValue());
      }
    }
    log.info("");
    log.info("Fetching replication records:");
    for (    Entry<Key,Value> kv : ReplicationTable.getScanner(connMaster)) {
      log.info(kv.getKey().toStringNoTruncate() + " " + ProtobufUtil.toString(Status.parseFrom(kv.getValue().get())));
    }
    Future<Boolean> future=executor.submit(new Callable<Boolean>(){
      @Override public Boolean call() throws Exception {
        connMaster.replicationOperations().drain(masterTable,filesNeedingReplication);
        log.info("Drain completed");
        return true;
      }
    }
);
    long timeoutSeconds=timeoutFactor * 30;
    try {
      future.get(timeoutSeconds,TimeUnit.SECONDS);
    }
 catch (    TimeoutException e) {
      future.cancel(true);
      Assert.fail("Drain did not finish within " + timeoutSeconds + " seconds");
    }
    log.info("drain completed");
    log.info("");
    log.info("Fetching metadata records:");
    for (    Entry<Key,Value> kv : connMaster.createScanner(MetadataTable.NAME,Authorizations.EMPTY)) {
      if (ReplicationSection.COLF.equals(kv.getKey().getColumnFamily())) {
        log.info(kv.getKey().toStringNoTruncate() + " " + ProtobufUtil.toString(Status.parseFrom(kv.getValue().get())));
      }
 else {
        log.info(kv.getKey().toStringNoTruncate() + " " + kv.getValue());
      }
    }
    log.info("");
    log.info("Fetching replication records:");
    for (    Entry<Key,Value> kv : ReplicationTable.getScanner(connMaster)) {
      log.info(kv.getKey().toStringNoTruncate() + " " + ProtobufUtil.toString(Status.parseFrom(kv.getValue().get())));
    }
    Scanner master=connMaster.createScanner(masterTable,Authorizations.EMPTY), peer=connPeer.createScanner(peerTable,Authorizations.EMPTY);
    Iterator<Entry<Key,Value>> masterIter=master.iterator(), peerIter=peer.iterator();
    Entry<Key,Value> masterEntry=null, peerEntry=null;
    while (masterIter.hasNext() && peerIter.hasNext()) {
      masterEntry=masterIter.next();
      peerEntry=peerIter.next();
      Assert.assertEquals(masterEntry.getKey() + " was not equal to " + peerEntry.getKey(),0,masterEntry.getKey().compareTo(peerEntry.getKey(),PartialKey.ROW_COLFAM_COLQUAL_COLVIS));
      Assert.assertEquals(masterEntry.getValue(),peerEntry.getValue());
    }
    log.info("Last master entry: " + masterEntry);
    log.info("Last peer entry: " + peerEntry);
    Assert.assertFalse("Had more data to read from the master",masterIter.hasNext());
    Assert.assertFalse("Had more data to read from the peer",peerIter.hasNext());
  }
  finally {
    peerCluster.stop();
  }
}

</code></pre>

<br>
<pre class="type-9 type-13 type-5 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void dataReplicatedToCorrectTable() throws Exception {
  MiniAccumuloConfigImpl peerCfg=new MiniAccumuloConfigImpl(createTestDir(this.getClass().getName() + "_" + this.testName.getMethodName()+ "_peer"),ROOT_PASSWORD);
  peerCfg.setNumTservers(1);
  peerCfg.setInstanceName("peer");
  updatePeerConfigFromPrimary(getCluster().getConfig(),peerCfg);
  peerCfg.setProperty(Property.REPLICATION_NAME,"peer");
  MiniAccumuloClusterImpl peer1Cluster=new MiniAccumuloClusterImpl(peerCfg);
  peer1Cluster.start();
  try {
    Connector connMaster=getConnector();
    Connector connPeer=peer1Cluster.getConnector("root",new PasswordToken(ROOT_PASSWORD));
    String peerClusterName="peer";
    String peerUserName="peer", peerPassword="foo";
    connPeer.securityOperations().createLocalUser(peerUserName,new PasswordToken(peerPassword));
    connMaster.instanceOperations().setProperty(Property.REPLICATION_PEER_USER.getKey() + peerClusterName,peerUserName);
    connMaster.instanceOperations().setProperty(Property.REPLICATION_PEER_PASSWORD.getKey() + peerClusterName,peerPassword);
    connMaster.instanceOperations().setProperty(Property.REPLICATION_PEERS.getKey() + peerClusterName,ReplicaSystemFactory.getPeerConfigurationValue(AccumuloReplicaSystem.class,AccumuloReplicaSystem.buildConfiguration(peer1Cluster.getInstanceName(),peer1Cluster.getZooKeepers())));
    String masterTable1="master1", peerTable1="peer1", masterTable2="master2", peerTable2="peer2";
    connMaster.tableOperations().create(masterTable1);
    String masterTableId1=connMaster.tableOperations().tableIdMap().get(masterTable1);
    Assert.assertNotNull(masterTableId1);
    connMaster.tableOperations().create(masterTable2);
    String masterTableId2=connMaster.tableOperations().tableIdMap().get(masterTable2);
    Assert.assertNotNull(masterTableId2);
    connPeer.tableOperations().create(peerTable1);
    String peerTableId1=connPeer.tableOperations().tableIdMap().get(peerTable1);
    Assert.assertNotNull(peerTableId1);
    connPeer.tableOperations().create(peerTable2);
    String peerTableId2=connPeer.tableOperations().tableIdMap().get(peerTable2);
    Assert.assertNotNull(peerTableId2);
    connPeer.securityOperations().grantTablePermission(peerUserName,peerTable1,TablePermission.WRITE);
    connPeer.securityOperations().grantTablePermission(peerUserName,peerTable2,TablePermission.WRITE);
    connMaster.tableOperations().setProperty(masterTable1,Property.TABLE_REPLICATION.getKey(),"true");
    connMaster.tableOperations().setProperty(masterTable1,Property.TABLE_REPLICATION_TARGET.getKey() + peerClusterName,peerTableId1);
    connMaster.tableOperations().setProperty(masterTable2,Property.TABLE_REPLICATION.getKey(),"true");
    connMaster.tableOperations().setProperty(masterTable2,Property.TABLE_REPLICATION_TARGET.getKey() + peerClusterName,peerTableId2);
    sleepUninterruptibly(3,TimeUnit.SECONDS);
    BatchWriter bw=connMaster.createBatchWriter(masterTable1,new BatchWriterConfig());
    long masterTable1Records=0l;
    for (int rows=0; rows < 2500; rows++) {
      Mutation m=new Mutation(masterTable1 + rows);
      for (int cols=0; cols < 100; cols++) {
        String value=Integer.toString(cols);
        m.put(value,"",value);
        masterTable1Records++;
      }
      bw.addMutation(m);
    }
    bw.close();
    bw=connMaster.createBatchWriter(masterTable2,new BatchWriterConfig());
    long masterTable2Records=0l;
    for (int rows=0; rows < 2500; rows++) {
      Mutation m=new Mutation(masterTable2 + rows);
      for (int cols=0; cols < 100; cols++) {
        String value=Integer.toString(cols);
        m.put(value,"",value);
        masterTable2Records++;
      }
      bw.addMutation(m);
    }
    bw.close();
    log.info("Wrote all data to master cluster");
    Set<String> filesFor1=connMaster.replicationOperations().referencedFiles(masterTable1), filesFor2=connMaster.replicationOperations().referencedFiles(masterTable2);
    while (!ReplicationTable.isOnline(connMaster)) {
      Thread.sleep(500);
    }
    for (    ProcessReference proc : cluster.getProcesses().get(ServerType.TABLET_SERVER)) {
      cluster.killProcess(ServerType.TABLET_SERVER,proc);
    }
    cluster.exec(TabletServer.class);
    log.info("Restarted the tserver");
    Iterators.size(connMaster.createScanner(masterTable1,Authorizations.EMPTY).iterator());
    log.info("Waiting for {} for {}",filesFor1,masterTable1);
    connMaster.replicationOperations().drain(masterTable1,filesFor1);
    log.info("Waiting for {} for {}",filesFor2,masterTable2);
    connMaster.replicationOperations().drain(masterTable2,filesFor2);
    long countTable=0l;
    for (int i=0; i < 5; i++) {
      countTable=0l;
      for (      Entry<Key,Value> entry : connPeer.createScanner(peerTable1,Authorizations.EMPTY)) {
        countTable++;
        Assert.assertTrue("Found unexpected key-value" + entry.getKey().toStringNoTruncate() + " "+ entry.getValue(),entry.getKey().getRow().toString().startsWith(masterTable1));
      }
      log.info("Found {} records in {}",countTable,peerTable1);
      if (masterTable1Records != countTable) {
        log.warn("Did not find {} expected records in {}, only found {}",masterTable1Records,peerTable1,countTable);
      }
    }
    Assert.assertEquals(masterTable1Records,countTable);
    for (int i=0; i < 5; i++) {
      countTable=0l;
      for (      Entry<Key,Value> entry : connPeer.createScanner(peerTable2,Authorizations.EMPTY)) {
        countTable++;
        Assert.assertTrue("Found unexpected key-value" + entry.getKey().toStringNoTruncate() + " "+ entry.getValue(),entry.getKey().getRow().toString().startsWith(masterTable2));
      }
      log.info("Found {} records in {}",countTable,peerTable2);
      if (masterTable2Records != countTable) {
        log.warn("Did not find {} expected records in {}, only found {}",masterTable2Records,peerTable2,countTable);
      }
    }
    Assert.assertEquals(masterTable2Records,countTable);
  }
  finally {
    peer1Cluster.stop();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.start.KeywordStartIT </h4><pre class="type-9 type-13 type-5 type-21 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExpectedClasses() throws IOException {
  assumeTrue(new File(System.getProperty("user.dir") + "/src").exists());
  TreeMap<String,Class<? extends KeywordExecutable>> expectSet=new TreeMap<>();
  expectSet.put("admin",Admin.class);
  expectSet.put("classpath",Classpath.class);
  expectSet.put("create-token",CreateToken.class);
  expectSet.put("gc",GCExecutable.class);
  expectSet.put("help",Help.class);
  expectSet.put("info",Info.class);
  expectSet.put("init",Initialize.class);
  expectSet.put("jar",Jar.class);
  expectSet.put("login-info",LoginProperties.class);
  expectSet.put("master",MasterExecutable.class);
  expectSet.put("minicluster",MiniClusterExecutable.class);
  expectSet.put("monitor",MonitorExecutable.class);
  expectSet.put("proxy",Proxy.class);
  expectSet.put("rfile-info",PrintInfo.class);
  expectSet.put("shell",Shell.class);
  expectSet.put("tracer",TracerExecutable.class);
  expectSet.put("tserver",TServerExecutable.class);
  expectSet.put("version",Version.class);
  expectSet.put("zookeeper",ZooKeeperMain.class);
  Iterator<Entry<String,Class<? extends KeywordExecutable>>> expectIter=expectSet.entrySet().iterator();
  TreeMap<String,KeywordExecutable> actualSet=new TreeMap<>(Main.getExecutables(getClass().getClassLoader()));
  Iterator<Entry<String,KeywordExecutable>> actualIter=actualSet.entrySet().iterator();
  Entry<String,Class<? extends KeywordExecutable>> expected;
  Entry<String,KeywordExecutable> actual;
  while (expectIter.hasNext() && actualIter.hasNext()) {
    expected=expectIter.next();
    actual=actualIter.next();
    assertEquals(expected.getKey(),actual.getKey());
    assertEquals(expected.getValue(),actual.getValue().getClass());
  }
  boolean moreExpected=expectIter.hasNext();
  if (moreExpected) {
    while (expectIter.hasNext()) {
      log.warn("Missing class for keyword '" + expectIter.next() + "'");
    }
  }
  assertFalse("Missing expected classes",moreExpected);
  boolean moreActual=actualIter.hasNext();
  if (moreActual) {
    while (actualIter.hasNext()) {
      log.warn("Extra class found with keyword '" + actualIter.next() + "'");
    }
  }
  assertFalse("Found additional unexpected classes",moreActual);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.tracer.TracerTest </h4><pre class="type-13 type-5 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testThrift() throws Exception {
  TestReceiver tracer=new TestReceiver();
  org.apache.htrace.Trace.addReceiver(tracer);
  ServerSocket socket=new ServerSocket(0);
  TServerSocket transport=new TServerSocket(socket);
  transport.listen();
  TThreadPoolServer.Args args=new TThreadPoolServer.Args(transport);
  args.processor(new Processor<Iface>(TraceWrap.service(new Service())));
  final TServer tserver=new TThreadPoolServer(args);
  Thread t=new Thread(){
    @Override public void run(){
      tserver.serve();
    }
  }
;
  t.start();
  TTransport clientTransport=new TSocket(new Socket("localhost",socket.getLocalPort()));
  TestService.Iface client=new TestService.Client(new TBinaryProtocol(clientTransport),new TBinaryProtocol(clientTransport));
  client=TraceWrap.client(client);
  assertFalse(client.checkTrace(null,"test"));
  Span start=Trace.on("start");
  assertTrue(client.checkTrace(null,"my test"));
  start.stop();
  assertNotNull(tracer.traces.get(start.traceId()));
  String traces[]={"my test","checkTrace","client:checkTrace","start"};
  assertTrue(tracer.traces.get(start.traceId()).size() == traces.length);
  for (int i=0; i < traces.length; i++)   assertEquals(traces[i],tracer.traces.get(start.traceId()).get(i).description);
  tserver.stop();
  t.join(100);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.tserver.InMemoryMapTest </h4><pre class="type-9 type-13 type-5 type-18 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Is not executed with the test suite
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @Ignore public void parallelWriteSpeed() throws Exception {
  List<Double> timings=new ArrayList<Double>();
  for (  int threads : new int[]{1,2,16}) {
    final long now=System.currentTimeMillis();
    final long counts[]=new long[threads];
    final InMemoryMap imm=newInMemoryMap(false,tempFolder.newFolder().getAbsolutePath());
    ExecutorService e=Executors.newFixedThreadPool(threads);
    for (int j=0; j < threads; j++) {
      final int threadId=j;
      e.execute(new Runnable(){
        @Override public void run(){
          while (System.currentTimeMillis() - now < 1000) {
            for (int k=0; k < 1000; k++) {
              Mutation m=new Mutation("row");
              m.put("cf","cq",new Value("v".getBytes()));
              List<Mutation> mutations=Collections.singletonList(m);
              imm.mutate(mutations);
              counts[threadId]++;
            }
          }
        }
      }
);
    }
    e.shutdown();
    e.awaitTermination(10,TimeUnit.SECONDS);
    imm.delete(10000);
    double mutationsPerSecond=sum(counts) / ((System.currentTimeMillis() - now) / 1000.);
    timings.add(mutationsPerSecond);
    log.info(String.format("%.1f mutations per second with %d threads",mutationsPerSecond,threads));
  }
  for (int i=0; i < timings.size(); i++) {
    double ratioFirst=timings.get(0) / timings.get(i);
    assertTrue(ratioFirst < 3);
    assertTrue(ratioFirst > 0.3);
  }
}

</code></pre>

<br>
<pre class="type-13 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testDeepCopyAndDelete() throws Exception {
  for (int i=0; i <= 4; i++)   deepCopyAndDelete(i,false);
  for (int i=1; i <= 4; i++)   try {
    deepCopyAndDelete(i,true);
    fail("i = " + i);
  }
 catch (  IterationInterruptedException iie) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.tserver.log.MultiReaderTest </h4><pre class="type-13 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultiReader() throws IOException {
  Path manyMaps=new Path("file://" + root.getRoot().getAbsolutePath() + "/manyMaps");
  MultiReader reader=new MultiReader(fs,manyMaps);
  IntWritable key=new IntWritable();
  BytesWritable value=new BytesWritable();
  for (int i=0; i < 1000; i++) {
    if (i == 10)     continue;
    assertTrue(reader.next(key,value));
    assertEquals(i,key.get());
  }
  assertEquals(value.compareTo(new BytesWritable("someValue".getBytes())),0);
  assertFalse(reader.next(key,value));
  key.set(500);
  assertTrue(reader.seek(key));
  scan(reader,500);
  key.set(10);
  assertFalse(reader.seek(key));
  scan(reader,10);
  key.set(1000);
  assertFalse(reader.seek(key));
  assertFalse(reader.next(key,value));
  key.set(-1);
  assertFalse(reader.seek(key));
  key.set(0);
  assertTrue(reader.next(key,value));
  assertEquals(0,key.get());
  reader.close();
  fs.deleteRecursively(new Path(manyMaps,"even"));
  reader=new MultiReader(fs,manyMaps);
  key.set(501);
  assertTrue(reader.seek(key));
  scanOdd(reader,501);
  key.set(1000);
  assertFalse(reader.seek(key));
  assertFalse(reader.next(key,value));
  key.set(-1);
  assertFalse(reader.seek(key));
  key.set(1);
  assertTrue(reader.next(key,value));
  assertEquals(1,key.get());
  reader.close();
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
