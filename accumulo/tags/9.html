<h3><span class=" glyphicon glyphicon-tag"/>&nbspAPIUtilityVerifier</h3><kbd>Verifies values of objects/variables related to API calls (Java or TPL) </kbd><br><br><br><h4 style="margin:0px">Class: org.apache.accumulo.core.client.BatchWriterConfigTest </h4><pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSerialize() throws IOException {
  final BatchWriterConfig bwDefaults=new BatchWriterConfig();
  assertNotEquals(7654321l,bwDefaults.getMaxLatency(TimeUnit.MILLISECONDS));
  assertNotEquals(9898989l,bwDefaults.getTimeout(TimeUnit.MILLISECONDS));
  assertNotEquals(42,bwDefaults.getMaxWriteThreads());
  assertNotEquals(1123581321l,bwDefaults.getMaxMemory());
  assertNotEquals(Durability.FLUSH,bwDefaults.getDurability());
  BatchWriterConfig bwConfig=new BatchWriterConfig();
  bwConfig.setMaxLatency(7654321l,TimeUnit.MILLISECONDS);
  bwConfig.setTimeout(9898989l,TimeUnit.MILLISECONDS);
  bwConfig.setMaxWriteThreads(42);
  bwConfig.setMaxMemory(1123581321l);
  bwConfig.setDurability(Durability.FLUSH);
  byte[] bytes=createBytes(bwConfig);
  checkBytes(bwConfig,bytes);
  bwConfig=new BatchWriterConfig();
  bwConfig.setMaxWriteThreads(42);
  bytes=createBytes(bwConfig);
  assertEquals("     i#maxWriteThreads=42",new String(bytes,UTF_8));
  checkBytes(bwConfig,bytes);
  bwConfig=new BatchWriterConfig();
  bwConfig.setMaxWriteThreads(24);
  bwConfig.setTimeout(3,TimeUnit.SECONDS);
  bytes=createBytes(bwConfig);
  assertEquals("     v#maxWriteThreads=24,timeout=3000",new String(bytes,UTF_8));
  checkBytes(bwConfig,bytes);
  bwConfig=new BatchWriterConfig();
  bwConfig.setDurability(Durability.LOG);
  bytes=createBytes(bwConfig);
  assertEquals("     e#durability=LOG",new String(bytes,UTF_8));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.client.ZooKeeperInstanceTest </h4><pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAllZooKeepersAreUsed(){
  final String zookeepers="zk1,zk2,zk3", instanceName="accumulo";
  ZooCacheFactory factory=createMock(ZooCacheFactory.class);
  EasyMock.reset(zc);
  expect(factory.getZooCache(zookeepers,30000)).andReturn(zc).anyTimes();
  expect(zc.get(Constants.ZROOT + Constants.ZINSTANCES + "/"+ instanceName)).andReturn(IID_STRING.getBytes(UTF_8));
  expect(zc.get(Constants.ZROOT + "/" + IID_STRING)).andReturn("yup".getBytes());
  replay(zc,factory);
  ClientConfiguration cfg=ClientConfiguration.loadDefault().withInstance(instanceName).withZkHosts(zookeepers);
  ZooKeeperInstance zki=new ZooKeeperInstance(cfg,factory);
  assertEquals(zookeepers,zki.getZooKeepers());
  assertEquals(instanceName,zki.getInstanceName());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.client.impl.ClientContextTest </h4><pre class="type-9 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void defaultValueForSensitiveProperty(){
  if (!isCredentialProviderAvailable) {
    return;
  }
  ClientConfiguration clientConf=new ClientConfiguration();
  AccumuloConfiguration accClientConf=ClientContext.convertClientConfig(clientConf);
  Assert.assertEquals(Property.INSTANCE_SECRET.getDefaultValue(),accClientConf.get(Property.INSTANCE_SECRET));
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void loadSensitivePropertyFromCredentialProvider(){
  if (!isCredentialProviderAvailable) {
    return;
  }
  String absPath=getKeyStoreUrl(keystore);
  ClientConfiguration clientConf=new ClientConfiguration();
  clientConf.addProperty(Property.GENERAL_SECURITY_CREDENTIAL_PROVIDER_PATHS.getKey(),absPath);
  AccumuloConfiguration accClientConf=ClientContext.convertClientConfig(clientConf);
  Assert.assertEquals("mysecret",accClientConf.get(Property.INSTANCE_SECRET));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.client.impl.DelegationTokenConfigSerializerTest </h4><pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test(){
  DelegationTokenConfig cfg=new DelegationTokenConfig();
  cfg.setTokenLifetime(8323,TimeUnit.HOURS);
  TDelegationTokenConfig tCfg=DelegationTokenConfigSerializer.serialize(cfg);
  assertEquals(tCfg.getLifetime(),cfg.getTokenLifetime(TimeUnit.MILLISECONDS));
  assertEquals(cfg,DelegationTokenConfigSerializer.deserialize(tCfg));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.client.impl.ScannerOptionsTest </h4><pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFetchColumn(){
  ScannerOptions options=new ScannerOptions();
  assertEquals(0,options.getFetchedColumns().size());
  IteratorSetting.Column col=new IteratorSetting.Column(new Text("family"),new Text("qualifier"));
  options.fetchColumn(col);
  SortedSet<Column> fetchedColumns=options.getFetchedColumns();
  assertEquals(1,fetchedColumns.size());
  Column fetchCol=fetchedColumns.iterator().next();
  assertEquals(col.getColumnFamily(),new Text(fetchCol.getColumnFamily()));
  assertEquals(col.getColumnQualifier(),new Text(fetchCol.getColumnQualifier()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.client.lexicoder.impl.ByteUtilsTest </h4><pre class="type-9 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSplit() throws Exception {
  byte[][] result;
  result=ByteUtils.split(empty);
  Assert.assertEquals(1,result.length);
  Assert.assertArrayEquals(empty,result[0]);
  result=ByteUtils.split(noSplits);
  Assert.assertEquals(1,result.length);
  Assert.assertArrayEquals(noSplits,result[0]);
  result=ByteUtils.split(splitAt5);
  Assert.assertEquals(2,result.length);
  Assert.assertArrayEquals("1234".getBytes(),result[0]);
  Assert.assertArrayEquals("56789".getBytes(),result[1]);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.client.mapred.AccumuloFileOutputFormatTest </h4><pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void validateConfiguration() throws IOException, InterruptedException {
  int a=7;
  long b=300l;
  long c=50l;
  long d=10l;
  String e="snappy";
  SamplerConfiguration samplerConfig=new SamplerConfiguration(RowSampler.class.getName());
  samplerConfig.addOption("hasher","murmur3_32");
  samplerConfig.addOption("modulus","109");
  JobConf job=new JobConf();
  AccumuloFileOutputFormat.setReplication(job,a);
  AccumuloFileOutputFormat.setFileBlockSize(job,b);
  AccumuloFileOutputFormat.setDataBlockSize(job,c);
  AccumuloFileOutputFormat.setIndexBlockSize(job,d);
  AccumuloFileOutputFormat.setCompressionType(job,e);
  AccumuloFileOutputFormat.setSampler(job,samplerConfig);
  AccumuloConfiguration acuconf=FileOutputConfigurator.getAccumuloConfiguration(AccumuloFileOutputFormat.class,job);
  assertEquals(7,acuconf.getCount(Property.TABLE_FILE_REPLICATION));
  assertEquals(300l,acuconf.getMemoryInBytes(Property.TABLE_FILE_BLOCK_SIZE));
  assertEquals(50l,acuconf.getMemoryInBytes(Property.TABLE_FILE_COMPRESSED_BLOCK_SIZE));
  assertEquals(10l,acuconf.getMemoryInBytes(Property.TABLE_FILE_COMPRESSED_BLOCK_SIZE_INDEX));
  assertEquals("snappy",acuconf.get(Property.TABLE_FILE_COMPRESSION_TYPE));
  assertEquals(new SamplerConfigurationImpl(samplerConfig),SamplerConfigurationImpl.newSamplerConfig(acuconf));
  a=17;
  b=1300l;
  c=150l;
  d=110l;
  e="lzo";
  samplerConfig=new SamplerConfiguration(RowSampler.class.getName());
  samplerConfig.addOption("hasher","md5");
  samplerConfig.addOption("modulus","100003");
  job=new JobConf();
  AccumuloFileOutputFormat.setReplication(job,a);
  AccumuloFileOutputFormat.setFileBlockSize(job,b);
  AccumuloFileOutputFormat.setDataBlockSize(job,c);
  AccumuloFileOutputFormat.setIndexBlockSize(job,d);
  AccumuloFileOutputFormat.setCompressionType(job,e);
  AccumuloFileOutputFormat.setSampler(job,samplerConfig);
  acuconf=FileOutputConfigurator.getAccumuloConfiguration(AccumuloFileOutputFormat.class,job);
  assertEquals(17,acuconf.getCount(Property.TABLE_FILE_REPLICATION));
  assertEquals(1300l,acuconf.getMemoryInBytes(Property.TABLE_FILE_BLOCK_SIZE));
  assertEquals(150l,acuconf.getMemoryInBytes(Property.TABLE_FILE_COMPRESSED_BLOCK_SIZE));
  assertEquals(110l,acuconf.getMemoryInBytes(Property.TABLE_FILE_COMPRESSED_BLOCK_SIZE_INDEX));
  assertEquals("lzo",acuconf.get(Property.TABLE_FILE_COMPRESSION_TYPE));
  assertEquals(new SamplerConfigurationImpl(samplerConfig),SamplerConfigurationImpl.newSamplerConfig(acuconf));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.client.mapred.AccumuloInputFormatTest </h4><pre class="type-9 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddIterator() throws IOException {
  AccumuloInputFormat.addIterator(job,new IteratorSetting(1,"WholeRow",WholeRowIterator.class));
  AccumuloInputFormat.addIterator(job,new IteratorSetting(2,"Versions","org.apache.accumulo.core.iterators.VersioningIterator"));
  IteratorSetting iter=new IteratorSetting(3,"Count","org.apache.accumulo.core.iterators.CountingIterator");
  iter.addOption("v1","1");
  iter.addOption("junk","\0omg:!\\xyzzy");
  AccumuloInputFormat.addIterator(job,iter);
  List<IteratorSetting> list=AccumuloInputFormat.getIterators(job);
  assertTrue(list.size() == 3);
  IteratorSetting setting=list.get(0);
  assertEquals(1,setting.getPriority());
  assertEquals("org.apache.accumulo.core.iterators.user.WholeRowIterator",setting.getIteratorClass());
  assertEquals("WholeRow",setting.getName());
  assertEquals(0,setting.getOptions().size());
  setting=list.get(1);
  assertEquals(2,setting.getPriority());
  assertEquals("org.apache.accumulo.core.iterators.VersioningIterator",setting.getIteratorClass());
  assertEquals("Versions",setting.getName());
  assertEquals(0,setting.getOptions().size());
  setting=list.get(2);
  assertEquals(3,setting.getPriority());
  assertEquals("org.apache.accumulo.core.iterators.CountingIterator",setting.getIteratorClass());
  assertEquals("Count",setting.getName());
  assertEquals(2,setting.getOptions().size());
  assertEquals("1",setting.getOptions().get("v1"));
  assertEquals("\0omg:!\\xyzzy",setting.getOptions().get("junk"));
}

</code></pre>

<br>
<pre class="type-9 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test adding iterator options where the keys and values contain both the FIELD_SEPARATOR character (':') and ITERATOR_SEPARATOR (',') characters. There
 * should be no exceptions thrown when trying to parse these types of option entries.
 * This test makes sure that the expected raw values, as appears in the Job, are equal to what's expected.
 */
@Test public void testIteratorOptionEncoding() throws Throwable {
  String key="colon:delimited:key";
  String value="comma,delimited,value";
  IteratorSetting someSetting=new IteratorSetting(1,"iterator","Iterator.class");
  someSetting.addOption(key,value);
  AccumuloInputFormat.addIterator(job,someSetting);
  List<IteratorSetting> list=AccumuloInputFormat.getIterators(job);
  assertEquals(1,list.size());
  assertEquals(1,list.get(0).getOptions().size());
  assertEquals(list.get(0).getOptions().get(key),value);
  someSetting.addOption(key + "2",value);
  someSetting.setPriority(2);
  someSetting.setName("it2");
  AccumuloInputFormat.addIterator(job,someSetting);
  list=AccumuloInputFormat.getIterators(job);
  assertEquals(2,list.size());
  assertEquals(1,list.get(0).getOptions().size());
  assertEquals(list.get(0).getOptions().get(key),value);
  assertEquals(2,list.get(1).getOptions().size());
  assertEquals(list.get(1).getOptions().get(key),value);
  assertEquals(list.get(1).getOptions().get(key + "2"),value);
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test getting iterator settings for multiple iterators set
 */
@Test public void testGetIteratorSettings() throws IOException {
  AccumuloInputFormat.addIterator(job,new IteratorSetting(1,"WholeRow","org.apache.accumulo.core.iterators.WholeRowIterator"));
  AccumuloInputFormat.addIterator(job,new IteratorSetting(2,"Versions","org.apache.accumulo.core.iterators.VersioningIterator"));
  AccumuloInputFormat.addIterator(job,new IteratorSetting(3,"Count","org.apache.accumulo.core.iterators.CountingIterator"));
  List<IteratorSetting> list=AccumuloInputFormat.getIterators(job);
  assertTrue(list.size() == 3);
  IteratorSetting setting=list.get(0);
  assertEquals(1,setting.getPriority());
  assertEquals("org.apache.accumulo.core.iterators.WholeRowIterator",setting.getIteratorClass());
  assertEquals("WholeRow",setting.getName());
  setting=list.get(1);
  assertEquals(2,setting.getPriority());
  assertEquals("org.apache.accumulo.core.iterators.VersioningIterator",setting.getIteratorClass());
  assertEquals("Versions",setting.getName());
  setting=list.get(2);
  assertEquals(3,setting.getPriority());
  assertEquals("org.apache.accumulo.core.iterators.CountingIterator",setting.getIteratorClass());
  assertEquals("Count",setting.getName());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.client.mapred.AccumuloOutputFormatTest </h4><pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBWSettings() throws IOException {
  JobConf job=new JobConf();
  final BatchWriterConfig bwDefaults=new BatchWriterConfig();
  assertNotEquals(7654321l,bwDefaults.getMaxLatency(TimeUnit.MILLISECONDS));
  assertNotEquals(9898989l,bwDefaults.getTimeout(TimeUnit.MILLISECONDS));
  assertNotEquals(42,bwDefaults.getMaxWriteThreads());
  assertNotEquals(1123581321l,bwDefaults.getMaxMemory());
  final BatchWriterConfig bwConfig=new BatchWriterConfig();
  bwConfig.setMaxLatency(7654321l,TimeUnit.MILLISECONDS);
  bwConfig.setTimeout(9898989l,TimeUnit.MILLISECONDS);
  bwConfig.setMaxWriteThreads(42);
  bwConfig.setMaxMemory(1123581321l);
  AccumuloOutputFormat.setBatchWriterOptions(job,bwConfig);
  AccumuloOutputFormat myAOF=new AccumuloOutputFormat(){
    @Override public void checkOutputSpecs(    FileSystem ignored,    JobConf job) throws IOException {
      BatchWriterConfig bwOpts=getBatchWriterOptions(job);
      assertEquals(bwConfig.getMaxLatency(TimeUnit.MILLISECONDS),bwOpts.getMaxLatency(TimeUnit.MILLISECONDS));
      assertEquals(bwConfig.getTimeout(TimeUnit.MILLISECONDS),bwOpts.getTimeout(TimeUnit.MILLISECONDS));
      assertEquals(bwConfig.getMaxWriteThreads(),bwOpts.getMaxWriteThreads());
      assertEquals(bwConfig.getMaxMemory(),bwOpts.getMaxMemory());
      assertEquals(7654321l,bwOpts.getMaxLatency(TimeUnit.MILLISECONDS));
      assertEquals(9898989l,bwOpts.getTimeout(TimeUnit.MILLISECONDS));
      assertEquals(42,bwOpts.getMaxWriteThreads());
      assertEquals(1123581321l,bwOpts.getMaxMemory());
    }
  }
;
  myAOF.checkOutputSpecs(null,job);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.client.mapreduce.AccumuloInputFormatTest </h4><pre class="type-9 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddIterator() throws IOException {
  Job job=Job.getInstance();
  AccumuloInputFormat.addIterator(job,new IteratorSetting(1,"WholeRow",WholeRowIterator.class));
  AccumuloInputFormat.addIterator(job,new IteratorSetting(2,"Versions","org.apache.accumulo.core.iterators.VersioningIterator"));
  IteratorSetting iter=new IteratorSetting(3,"Count","org.apache.accumulo.core.iterators.CountingIterator");
  iter.addOption("v1","1");
  iter.addOption("junk","\0omg:!\\xyzzy");
  AccumuloInputFormat.addIterator(job,iter);
  List<IteratorSetting> list=AccumuloInputFormat.getIterators(job);
  assertTrue(list.size() == 3);
  IteratorSetting setting=list.get(0);
  assertEquals(1,setting.getPriority());
  assertEquals("org.apache.accumulo.core.iterators.user.WholeRowIterator",setting.getIteratorClass());
  assertEquals("WholeRow",setting.getName());
  assertEquals(0,setting.getOptions().size());
  setting=list.get(1);
  assertEquals(2,setting.getPriority());
  assertEquals("org.apache.accumulo.core.iterators.VersioningIterator",setting.getIteratorClass());
  assertEquals("Versions",setting.getName());
  assertEquals(0,setting.getOptions().size());
  setting=list.get(2);
  assertEquals(3,setting.getPriority());
  assertEquals("org.apache.accumulo.core.iterators.CountingIterator",setting.getIteratorClass());
  assertEquals("Count",setting.getName());
  assertEquals(2,setting.getOptions().size());
  assertEquals("1",setting.getOptions().get("v1"));
  assertEquals("\0omg:!\\xyzzy",setting.getOptions().get("junk"));
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test getting iterator settings for multiple iterators set
 */
@Test public void testGetIteratorSettings() throws IOException {
  Job job=Job.getInstance();
  AccumuloInputFormat.addIterator(job,new IteratorSetting(1,"WholeRow","org.apache.accumulo.core.iterators.WholeRowIterator"));
  AccumuloInputFormat.addIterator(job,new IteratorSetting(2,"Versions","org.apache.accumulo.core.iterators.VersioningIterator"));
  AccumuloInputFormat.addIterator(job,new IteratorSetting(3,"Count","org.apache.accumulo.core.iterators.CountingIterator"));
  List<IteratorSetting> list=AccumuloInputFormat.getIterators(job);
  assertTrue(list.size() == 3);
  IteratorSetting setting=list.get(0);
  assertEquals(1,setting.getPriority());
  assertEquals("org.apache.accumulo.core.iterators.WholeRowIterator",setting.getIteratorClass());
  assertEquals("WholeRow",setting.getName());
  setting=list.get(1);
  assertEquals(2,setting.getPriority());
  assertEquals("org.apache.accumulo.core.iterators.VersioningIterator",setting.getIteratorClass());
  assertEquals("Versions",setting.getName());
  setting=list.get(2);
  assertEquals(3,setting.getPriority());
  assertEquals("org.apache.accumulo.core.iterators.CountingIterator",setting.getIteratorClass());
  assertEquals("Count",setting.getName());
}

</code></pre>

<br>
<pre class="type-9 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testEmptyColumnFamily() throws IOException {
  Job job=Job.getInstance();
  Set<Pair<Text,Text>> cols=new HashSet<Pair<Text,Text>>();
  cols.add(new Pair<Text,Text>(new Text(""),null));
  cols.add(new Pair<Text,Text>(new Text("foo"),new Text("bar")));
  cols.add(new Pair<Text,Text>(new Text(""),new Text("bar")));
  cols.add(new Pair<Text,Text>(new Text(""),new Text("")));
  cols.add(new Pair<Text,Text>(new Text("foo"),new Text("")));
  AccumuloInputFormat.fetchColumns(job,cols);
  Set<Pair<Text,Text>> setCols=AccumuloInputFormat.getFetchedColumns(job);
  assertEquals(cols,setCols);
}

</code></pre>

<br>
<pre class="type-9 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test adding iterator options where the keys and values contain both the FIELD_SEPARATOR character (':') and ITERATOR_SEPARATOR (',') characters. There
 * should be no exceptions thrown when trying to parse these types of option entries.
 * This test makes sure that the expected raw values, as appears in the Job, are equal to what's expected.
 */
@Test public void testIteratorOptionEncoding() throws Throwable {
  String key="colon:delimited:key";
  String value="comma,delimited,value";
  IteratorSetting someSetting=new IteratorSetting(1,"iterator","Iterator.class");
  someSetting.addOption(key,value);
  Job job=Job.getInstance();
  AccumuloInputFormat.addIterator(job,someSetting);
  List<IteratorSetting> list=AccumuloInputFormat.getIterators(job);
  assertEquals(1,list.size());
  assertEquals(1,list.get(0).getOptions().size());
  assertEquals(list.get(0).getOptions().get(key),value);
  someSetting.addOption(key + "2",value);
  someSetting.setPriority(2);
  someSetting.setName("it2");
  AccumuloInputFormat.addIterator(job,someSetting);
  list=AccumuloInputFormat.getIterators(job);
  assertEquals(2,list.size());
  assertEquals(1,list.get(0).getOptions().size());
  assertEquals(list.get(0).getOptions().get(key),value);
  assertEquals(2,list.get(1).getOptions().size());
  assertEquals(list.get(1).getOptions().get(key),value);
  assertEquals(list.get(1).getOptions().get(key + "2"),value);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.client.mapreduce.AccumuloOutputFormatTest </h4><pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBWSettings() throws IOException {
  Job job=Job.getInstance();
  final BatchWriterConfig bwDefaults=new BatchWriterConfig();
  assertNotEquals(7654321l,bwDefaults.getMaxLatency(TimeUnit.MILLISECONDS));
  assertNotEquals(9898989l,bwDefaults.getTimeout(TimeUnit.MILLISECONDS));
  assertNotEquals(42,bwDefaults.getMaxWriteThreads());
  assertNotEquals(1123581321l,bwDefaults.getMaxMemory());
  final BatchWriterConfig bwConfig=new BatchWriterConfig();
  bwConfig.setMaxLatency(7654321l,TimeUnit.MILLISECONDS);
  bwConfig.setTimeout(9898989l,TimeUnit.MILLISECONDS);
  bwConfig.setMaxWriteThreads(42);
  bwConfig.setMaxMemory(1123581321l);
  AccumuloOutputFormat.setBatchWriterOptions(job,bwConfig);
  AccumuloOutputFormat myAOF=new AccumuloOutputFormat(){
    @Override public void checkOutputSpecs(    JobContext job) throws IOException {
      BatchWriterConfig bwOpts=getBatchWriterOptions(job);
      assertEquals(bwConfig.getMaxLatency(TimeUnit.MILLISECONDS),bwOpts.getMaxLatency(TimeUnit.MILLISECONDS));
      assertEquals(bwConfig.getTimeout(TimeUnit.MILLISECONDS),bwOpts.getTimeout(TimeUnit.MILLISECONDS));
      assertEquals(bwConfig.getMaxWriteThreads(),bwOpts.getMaxWriteThreads());
      assertEquals(bwConfig.getMaxMemory(),bwOpts.getMaxMemory());
      assertEquals(7654321l,bwOpts.getMaxLatency(TimeUnit.MILLISECONDS));
      assertEquals(9898989l,bwOpts.getTimeout(TimeUnit.MILLISECONDS));
      assertEquals(42,bwOpts.getMaxWriteThreads());
      assertEquals(1123581321l,bwOpts.getMaxMemory());
    }
  }
;
  myAOF.checkOutputSpecs(job);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.client.mapreduce.InputTableConfigTest </h4><pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSerialization_ranges() throws IOException {
  List<Range> ranges=new ArrayList<Range>();
  ranges.add(new Range("a","b"));
  ranges.add(new Range("c","d"));
  tableQueryConfig.setRanges(ranges);
  byte[] serialized=serialize(tableQueryConfig);
  InputTableConfig actualConfig=deserialize(serialized);
  assertEquals(ranges,actualConfig.getRanges());
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSerialization_columns() throws IOException {
  Set<Pair<Text,Text>> columns=new HashSet<Pair<Text,Text>>();
  columns.add(new Pair<Text,Text>(new Text("cf1"),new Text("cq1")));
  columns.add(new Pair<Text,Text>(new Text("cf2"),null));
  tableQueryConfig.fetchColumns(columns);
  byte[] serialized=serialize(tableQueryConfig);
  InputTableConfig actualConfig=deserialize(serialized);
  assertEquals(actualConfig.getFetchedColumns(),columns);
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSerialization_iterators() throws IOException {
  List<IteratorSetting> settings=new ArrayList<IteratorSetting>();
  settings.add(new IteratorSetting(50,"iter","iterclass"));
  settings.add(new IteratorSetting(55,"iter2","iterclass2"));
  tableQueryConfig.setIterators(settings);
  byte[] serialized=serialize(tableQueryConfig);
  InputTableConfig actualConfig=deserialize(serialized);
  assertEquals(actualConfig.getIterators(),settings);
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSerialization_allBooleans() throws IOException {
  tableQueryConfig.setAutoAdjustRanges(false);
  tableQueryConfig.setOfflineScan(true);
  tableQueryConfig.setUseIsolatedScanners(true);
  tableQueryConfig.setUseLocalIterators(true);
  byte[] serialized=serialize(tableQueryConfig);
  InputTableConfig actualConfig=deserialize(serialized);
  assertEquals(tableQueryConfig,actualConfig);
}

</code></pre>

<br>
<pre class="type-9 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSerialization_OnlyTable() throws IOException {
  byte[] serialized=serialize(tableQueryConfig);
  InputTableConfig actualConfig=deserialize(serialized);
  assertEquals(tableQueryConfig,actualConfig);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.client.mapreduce.impl.BatchInputSplitTest </h4><pre class="type-9 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSimpleWritable() throws IOException {
  Range[] ranges=new Range[]{new Range(new Key("a"),new Key("b"))};
  BatchInputSplit split=new BatchInputSplit("table","1",Arrays.asList(ranges),new String[]{"localhost"});
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  DataOutputStream dos=new DataOutputStream(baos);
  split.write(dos);
  BatchInputSplit newSplit=new BatchInputSplit();
  ByteArrayInputStream bais=new ByteArrayInputStream(baos.toByteArray());
  DataInputStream dis=new DataInputStream(bais);
  newSplit.readFields(dis);
  Assert.assertEquals(split.getTableName(),newSplit.getTableName());
  Assert.assertEquals(split.getTableId(),newSplit.getTableId());
  Assert.assertEquals(split.getRanges(),newSplit.getRanges());
  Assert.assertTrue(Arrays.equals(split.getLocations(),newSplit.getLocations()));
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAllFieldsWritable() throws IOException {
  Range[] ranges=new Range[]{new Range(new Key("a"),new Key("b"))};
  BatchInputSplit split=new BatchInputSplit("table","1",Arrays.asList(ranges),new String[]{"localhost"});
  Set<Pair<Text,Text>> fetchedColumns=new HashSet<Pair<Text,Text>>();
  fetchedColumns.add(new Pair<Text,Text>(new Text("colf1"),new Text("colq1")));
  fetchedColumns.add(new Pair<Text,Text>(new Text("colf2"),new Text("colq2")));
  ArrayList<IteratorSetting> iterators=new ArrayList<IteratorSetting>();
  IteratorSetting setting=new IteratorSetting(50,SummingCombiner.class);
  setting.addOption("foo","bar");
  iterators.add(setting);
  setting=new IteratorSetting(100,WholeRowIterator.class);
  setting.addOption("bar","foo");
  iterators.add(setting);
  split.setTableName("table");
  split.setAuths(new Authorizations("foo"));
  split.setFetchedColumns(fetchedColumns);
  split.setToken(new PasswordToken("password"));
  split.setPrincipal("root");
  DeprecationUtil.setMockInstance(split,true);
  split.setInstanceName("instance");
  split.setZooKeepers("localhost");
  split.setIterators(iterators);
  split.setLogLevel(Level.WARN);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  DataOutputStream dos=new DataOutputStream(baos);
  split.write(dos);
  BatchInputSplit newSplit=new BatchInputSplit();
  ByteArrayInputStream bais=new ByteArrayInputStream(baos.toByteArray());
  DataInputStream dis=new DataInputStream(bais);
  newSplit.readFields(dis);
  Assert.assertEquals(split.getRanges(),newSplit.getRanges());
  Assert.assertArrayEquals(split.getLocations(),newSplit.getLocations());
  Assert.assertEquals(split.getTableName(),newSplit.getTableName());
  Assert.assertEquals(split.getAuths(),newSplit.getAuths());
  Assert.assertEquals(split.getFetchedColumns(),newSplit.getFetchedColumns());
  Assert.assertEquals(split.getToken(),newSplit.getToken());
  Assert.assertEquals(split.getPrincipal(),newSplit.getPrincipal());
  Assert.assertEquals(split.getInstanceName(),newSplit.getInstanceName());
  Assert.assertEquals(DeprecationUtil.isMockInstanceSet(split),DeprecationUtil.isMockInstanceSet(newSplit));
  Assert.assertEquals(split.getZooKeepers(),newSplit.getZooKeepers());
  Assert.assertEquals(split.getIterators(),newSplit.getIterators());
  Assert.assertEquals(split.getLogLevel(),newSplit.getLogLevel());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.client.mapreduce.lib.impl.ConfiguratorBaseTest </h4><pre class="type-9 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSetConnectorInfoClassOfQConfigurationStringAuthenticationToken() throws AccumuloSecurityException {
  Configuration conf=new Configuration();
  assertFalse(ConfiguratorBase.isConnectorInfoSet(this.getClass(),conf));
  ConfiguratorBase.setConnectorInfo(this.getClass(),conf,"testUser",new PasswordToken("testPassword"));
  assertTrue(ConfiguratorBase.isConnectorInfoSet(this.getClass(),conf));
  assertEquals("testUser",ConfiguratorBase.getPrincipal(this.getClass(),conf));
  AuthenticationToken token=ConfiguratorBase.getAuthenticationToken(this.getClass(),conf);
  assertEquals(PasswordToken.class,token.getClass());
  assertEquals(new PasswordToken("testPassword"),token);
  assertEquals("inline:" + PasswordToken.class.getName() + ":"+ Base64.encodeBase64String(AuthenticationTokenSerializer.serialize(new PasswordToken("testPassword"))),conf.get(ConfiguratorBase.enumToConfKey(this.getClass(),ConfiguratorBase.ConnectorInfo.TOKEN)));
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@SuppressWarnings("deprecation") @Test public void testSetMockInstance(){
  Class<?> mockClass=org.apache.accumulo.core.client.mock.MockInstance.class;
  Configuration conf=new Configuration();
  ConfiguratorBase.setMockInstance(this.getClass(),conf,"testInstanceName");
  assertEquals("testInstanceName",conf.get(ConfiguratorBase.enumToConfKey(this.getClass(),ConfiguratorBase.InstanceOpts.NAME)));
  assertEquals(null,conf.get(ConfiguratorBase.enumToConfKey(this.getClass(),ConfiguratorBase.InstanceOpts.ZOO_KEEPERS)));
  assertEquals(mockClass.getSimpleName(),conf.get(ConfiguratorBase.enumToConfKey(this.getClass(),ConfiguratorBase.InstanceOpts.TYPE)));
  Instance instance=ConfiguratorBase.getInstance(this.getClass(),conf);
  assertEquals(mockClass.getName(),instance.getClass().getName());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.client.mock.MockTableOperationsTest </h4><pre class="type-9 type-13 type-5 type-3 type-2 type-14 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testImport() throws Throwable {
  ImportTestFilesAndData dataAndFiles=prepareTestFiles();
  TableOperations tableOperations=conn.tableOperations();
  tableOperations.create("a_table");
  tableOperations.importDirectory("a_table",dataAndFiles.importPath.toString(),dataAndFiles.failurePath.toString(),false);
  Scanner scanner=conn.createScanner("a_table",new Authorizations());
  Iterator<Entry<Key,Value>> iterator=scanner.iterator();
  for (int i=0; i < 5; i++) {
    Assert.assertTrue(iterator.hasNext());
    Entry<Key,Value> kv=iterator.next();
    Pair<Key,Value> expected=dataAndFiles.keyVals.get(i);
    Assert.assertEquals(expected.getFirst(),kv.getKey());
    Assert.assertEquals(expected.getSecond(),kv.getValue());
  }
  Assert.assertFalse(iterator.hasNext());
}

</code></pre>

<br>
<pre class="type-9 type-5 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteRows() throws Exception {
  TableOperations to=conn.tableOperations();
  to.create("test");
  BatchWriter bw=conn.createBatchWriter("test",new BatchWriterConfig());
  for (int r=0; r < 20; r++) {
    Mutation m=new Mutation("" + r);
    for (int c=0; c < 5; c++) {
      m.put(new Text("cf"),new Text("" + c),new Value(("" + c).getBytes()));
    }
    bw.addMutation(m);
  }
  bw.flush();
  to.deleteRows("test",new Text("1"),new Text("2"));
  Scanner s=conn.createScanner("test",Authorizations.EMPTY);
  int oneCnt=0;
  for (  Entry<Key,Value> entry : s) {
    char rowStart=entry.getKey().getRow().toString().charAt(0);
    Assert.assertTrue(rowStart != '2');
    oneCnt+=rowStart == '1' ? 1 : 0;
  }
  Assert.assertEquals(5,oneCnt);
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteRowsWithNullKeys() throws Exception {
  TableOperations to=conn.tableOperations();
  to.create("test2");
  BatchWriter bw=conn.createBatchWriter("test2",new BatchWriterConfig());
  for (int r=0; r < 30; r++) {
    Mutation m=new Mutation(Integer.toString(r));
    for (int c=0; c < 5; c++) {
      m.put(new Text("cf"),new Text(Integer.toString(c)),new Value(Integer.toString(c).getBytes()));
    }
    bw.addMutation(m);
  }
  bw.flush();
  to.deleteRows("test2",new Text("30"),null);
  Scanner s=conn.createScanner("test2",Authorizations.EMPTY);
  int rowCnt=0;
  for (  Entry<Key,Value> entry : s) {
    String rowId=entry.getKey().getRow().toString();
    Assert.assertFalse(rowId.startsWith("30"));
    rowCnt++;
  }
  s.close();
  Assert.assertEquals(120,rowCnt);
  to.deleteRows("test2",null,new Text("2"));
  s=conn.createScanner("test2",Authorizations.EMPTY);
  rowCnt=0;
  for (  Entry<Key,Value> entry : s) {
    char rowStart=entry.getKey().getRow().toString().charAt(0);
    Assert.assertTrue(rowStart >= '2');
    rowCnt++;
  }
  s.close();
  Assert.assertEquals(55,rowCnt);
  to.deleteRows("test2",null,null);
  s=conn.createScanner("test2",Authorizations.EMPTY);
  rowCnt=Iterators.size(s.iterator());
  s.close();
  to.delete("test2");
  Assert.assertEquals(0,rowCnt);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.conf.CredentialProviderFactoryShimTest </h4><pre class="type-9 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNonExistentClassesDoesntFail() throws IOException {
  Configuration conf=new Configuration();
  conf.set(CredentialProviderFactoryShim.CREDENTIAL_PROVIDER_PATH,"jceks://file/foo/bar.jceks");
  List<String> keys=CredentialProviderFactoryShim.getKeys(conf);
  Assert.assertNotNull(keys);
  Assert.assertEquals(Collections.emptyList(),keys);
  Assert.assertNull(CredentialProviderFactoryShim.getValueFromCredentialProvider(conf,"key1"));
}

</code></pre>

<br>
<pre class="type-9 type-3 type-15 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void existingConfigurationReturned(){
  Configuration conf=new Configuration(false);
  conf.set("foo","bar");
  Configuration conf2=CredentialProviderFactoryShim.getConfiguration(conf,"jceks:///file/accumulo.jceks");
  Assert.assertSame(conf,conf2);
  Assert.assertEquals("bar",conf.get("foo"));
}

</code></pre>

<br>
<pre class="type-9 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConfigurationCreation() throws IOException {
  final String path="jceks://file/tmp/foo.jks";
  final Configuration actualConf=CredentialProviderFactoryShim.getConfiguration(path);
  Assert.assertNotNull(actualConf);
  Assert.assertEquals(path,actualConf.get(CredentialProviderFactoryShim.CREDENTIAL_PROVIDER_PATH));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.conf.PropertyTypeTest </h4><pre class="type-9 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFullCoverage(){
  Iterable<String> types=Iterables.transform(Arrays.asList(PropertyType.values()),new Function<PropertyType,String>(){
    @Override public String apply(    final PropertyType input){
      return input.name();
    }
  }
);
  Iterable<String> typesTested=Iterables.transform(Iterables.filter(Iterables.transform(Arrays.asList(this.getClass().getMethods()),new Function<Method,String>(){
    @Override public String apply(    final Method input){
      return input.getName();
    }
  }
),new Predicate<String>(){
    @Override public boolean apply(    final String input){
      return input.startsWith("testType");
    }
  }
),new Function<String,String>(){
    @Override public String apply(    final String input){
      return input.substring(8);
    }
  }
);
  for (  String t : types) {
    assertTrue(PropertyType.class.getSimpleName() + "." + t+ " does not have a test.",Iterables.contains(typesTested,t));
  }
  assertEquals(Iterables.size(types),Iterables.size(typesTested));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.data.ArrayByteSequenceTest </h4><pre class="type-9 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFromByteBuffer(){
  ByteBuffer bb=ByteBuffer.wrap(data,1,4);
  abs=new ArrayByteSequence(bb);
  assertEquals("mile",abs.toString());
  bb=bb.asReadOnlyBuffer();
  abs=new ArrayByteSequence(bb);
  assertEquals("mile",abs.toString());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.data.ConditionTest </h4><pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testConstruction_ByteSequence(){
  c=new Condition(new ArrayByteSequence(FAMILY.getBytes(UTF_8)),new ArrayByteSequence(QUALIFIER.getBytes(UTF_8)));
  assertEquals(FAMILY,toString(c.getFamily()));
  assertEquals(QUALIFIER,toString(c.getQualifier()));
  assertEquals(EMPTY,c.getVisibility());
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testConstruction_ByteArray(){
  c=new Condition(FAMILY.getBytes(UTF_8),QUALIFIER.getBytes(UTF_8));
  assertEquals(FAMILY,toString(c.getFamily()));
  assertEquals(QUALIFIER,toString(c.getQualifier()));
  assertEquals(EMPTY,c.getVisibility());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.data.ConditionalMutationTest </h4><pre class="type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testEquals(){
  assertTrue(cm.equals(cm));
  assertFalse(cm.equals((Object)null));
  ConditionalMutation cm2=new ConditionalMutation(ROW,c1,c2);
  assertTrue(cm.equals(cm2));
  assertTrue(cm2.equals(cm));
  ConditionalMutation cm3=new ConditionalMutation("row2".getBytes(UTF_8),c1,c2);
  assertFalse(cm.equals(cm3));
  cm3=new ConditionalMutation(ROW,c2,c1);
  assertFalse(cm.getConditions().equals(cm3.getConditions()));
  assertFalse(cm.equals(cm3));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.data.KeyExtentTest </h4><pre class="type-9 type-16 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies logic rules using matcher-style statements
"></span><br>
@SuppressWarnings("deprecation") @Test public void testKeyExtentsForRange(){
  KeyExtent b=nke("t","b",null);
  KeyExtent e=nke("t","e","b");
  KeyExtent h=nke("t","h","e");
  KeyExtent m=nke("t","m","h");
  KeyExtent z=nke("t",null,"m");
  set0.addAll(Arrays.asList(b,e,h,m,z));
  Collection<KeyExtent> results;
  results=KeyExtent.getKeyExtentsForRange(null,null,set0);
  assertThat("infinite range should return full set",results.size(),is(5));
  assertThat("infinite range should return full set",results,hasItems(b,e,h,m,z));
  results=KeyExtent.getKeyExtentsForRange(new Text("a"),new Text("z"),set0);
  assertThat("full overlap should return full set",results.size(),is(5));
  assertThat("full overlap should return full set",results,hasItems(b,e,h,m,z));
  results=KeyExtent.getKeyExtentsForRange(null,new Text("f"),set0);
  assertThat("end row should return head set",results.size(),is(3));
  assertThat("end row should return head set",results,hasItems(b,e,h));
  results=KeyExtent.getKeyExtentsForRange(new Text("f"),null,set0);
  assertThat("start row should return tail set",results.size(),is(3));
  assertThat("start row should return tail set",results,hasItems(h,m,z));
  results=KeyExtent.getKeyExtentsForRange(new Text("f"),new Text("g"),set0);
  assertThat("slice should return correct subset",results.size(),is(1));
  assertThat("slice should return correct subset",results,hasItem(h));
}

</code></pre>

<br>
<pre class="type-9 type-5 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("deprecation") @Test public void testKeyExtentsForSimpleRange(){
  Collection<KeyExtent> results;
  results=KeyExtent.getKeyExtentsForRange(null,null,null);
  assertTrue("Non-empty set returned from no extents",results.isEmpty());
  results=KeyExtent.getKeyExtentsForRange(null,null,Collections.<KeyExtent>emptySet());
  assertTrue("Non-empty set returned from no extents",results.isEmpty());
  KeyExtent t=nke("t",null,null);
  results=KeyExtent.getKeyExtentsForRange(null,null,Collections.<KeyExtent>singleton(t));
  assertEquals("Single tablet should always be returned",1,results.size());
  assertEquals(t,results.iterator().next());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.data.KeyTest </h4><pre class="type-9 type-13 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCompressDecompress(){
  List<KeyValue> kvs=new ArrayList<KeyValue>();
  kvs.add(new KeyValue(new Key(),new byte[]{}));
  kvs.add(new KeyValue(new Key("r"),new byte[]{}));
  kvs.add(new KeyValue(new Key("r","cf"),new byte[]{}));
  kvs.add(new KeyValue(new Key("r2","cf"),new byte[]{}));
  kvs.add(new KeyValue(new Key("r","cf","cq"),new byte[]{}));
  kvs.add(new KeyValue(new Key("r2","cf2","cq"),new byte[]{}));
  kvs.add(new KeyValue(new Key("r","cf","cq","cv"),new byte[]{}));
  kvs.add(new KeyValue(new Key("r2","cf2","cq2","cv"),new byte[]{}));
  kvs.add(new KeyValue(new Key("r2","cf2","cq2","cv"),new byte[]{}));
  kvs.add(new KeyValue(new Key(),new byte[]{}));
  List<TKeyValue> tkvs=Key.compress(kvs);
  Key.decompress(tkvs);
  assertEquals(kvs.size(),tkvs.size());
  Iterator<KeyValue> kvi=kvs.iterator();
  Iterator<TKeyValue> tkvi=tkvs.iterator();
  while (kvi.hasNext()) {
    KeyValue kv=kvi.next();
    TKeyValue tkv=tkvi.next();
    assertEquals(kv.getKey(),new Key(tkv.getKey()));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.data.MutationTest </h4><pre class="type-9 type-13 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test3() throws IOException {
  Mutation m=new Mutation(new Text("r1"));
  for (int i=0; i < 5; i++) {
    int len=Mutation.VALUE_SIZE_COPY_CUTOFF - 2 + i;
    byte val[]=new byte[len];
    for (int j=0; j < len; j++)     val[j]=(byte)i;
    m.put(new Text("cf" + i),new Text("cq" + i),new Value(val));
  }
  for (int r=0; r < 3; r++) {
    assertEquals("r1",new String(m.getRow()));
    List<ColumnUpdate> updates=m.getUpdates();
    assertEquals(5,updates.size());
    for (int i=0; i < 5; i++) {
      ColumnUpdate cu=updates.get(i);
      assertEquals("cf" + i,new String(cu.getColumnFamily()));
      assertEquals("cq" + i,new String(cu.getColumnQualifier()));
      assertEquals("",new String(cu.getColumnVisibility()));
      assertFalse(cu.hasTimestamp());
      byte[] val=cu.getValue();
      int len=Mutation.VALUE_SIZE_COPY_CUTOFF - 2 + i;
      assertEquals(len,val.length);
      for (int j=0; j < len; j++)       assertEquals(i,val[j]);
    }
    m=cloneMutation(m);
  }
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReserialize() throws Exception {
  OldMutation om=new OldMutation("r1");
  om.put("cf1","cq1","v1");
  om.put("cf2","cq2",new ColumnVisibility("cv2"),"v2");
  om.putDelete("cf3","cq3");
  StringBuilder bigVal=new StringBuilder();
  for (int i=0; i < 100000; i++) {
    bigVal.append('a');
  }
  om.put("cf2","big",bigVal);
  Mutation m1=convert(om);
  ByteArrayOutputStream bos=new ByteArrayOutputStream();
  DataOutputStream dos=new DataOutputStream(bos);
  m1.write(dos);
  dos.close();
  Mutation m2=new Mutation();
  ByteArrayInputStream bis=new ByteArrayInputStream(bos.toByteArray());
  DataInputStream dis=new DataInputStream(bis);
  m2.readFields(dis);
  assertEquals("r1",new String(m1.getRow()));
  assertEquals(4,m2.getUpdates().size());
  assertEquals(4,m2.size());
  verifyColumnUpdate(m2.getUpdates().get(0),"cf1","cq1","",0l,false,false,"v1");
  verifyColumnUpdate(m2.getUpdates().get(1),"cf2","cq2","cv2",0l,false,false,"v2");
  verifyColumnUpdate(m2.getUpdates().get(2),"cf3","cq3","",0l,false,true,"");
  verifyColumnUpdate(m2.getUpdates().get(3),"cf2","big","",0l,false,false,bigVal.toString());
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNewSerialization() throws Exception {
  OldMutation m2=new OldMutation("r1");
  m2.put("cf1","cq1","v1");
  m2.put("cf2","cq2",new ColumnVisibility("cv2"),"v2");
  m2.putDelete("cf3","cq3");
  ByteArrayOutputStream bos=new ByteArrayOutputStream();
  DataOutputStream dos=new DataOutputStream(bos);
  m2.write(dos);
  dos.close();
  long oldSize=dos.size();
  ByteArrayInputStream bis=new ByteArrayInputStream(bos.toByteArray());
  DataInputStream dis=new DataInputStream(bis);
  m2.readFields(dis);
  dis.close();
  assertEquals("r1",new String(m2.getRow()));
  assertEquals(3,m2.getUpdates().size());
  assertEquals(3,m2.size());
  verifyColumnUpdate(m2.getUpdates().get(0),"cf1","cq1","",0l,false,false,"v1");
  verifyColumnUpdate(m2.getUpdates().get(1),"cf2","cq2","cv2",0l,false,false,"v2");
  verifyColumnUpdate(m2.getUpdates().get(2),"cf3","cq3","",0l,false,true,"");
  Mutation m1=convert(m2);
  assertEquals("r1",new String(m1.getRow()));
  assertEquals(3,m1.getUpdates().size());
  assertEquals(3,m1.size());
  verifyColumnUpdate(m1.getUpdates().get(0),"cf1","cq1","",0l,false,false,"v1");
  verifyColumnUpdate(m1.getUpdates().get(1),"cf2","cq2","cv2",0l,false,false,"v2");
  verifyColumnUpdate(m1.getUpdates().get(2),"cf3","cq3","",0l,false,true,"");
  Text exampleRow=new Text(" 123456789 123456789 123456789 123456789 123456789");
  int exampleLen=exampleRow.getLength();
  m1=new Mutation(exampleRow);
  m1.put("","","");
  bos=new ByteArrayOutputStream();
  dos=new DataOutputStream(bos);
  m1.write(dos);
  dos.close();
  long newSize=dos.size();
  assertTrue(newSize < oldSize);
  assertEquals(10,newSize - exampleLen);
  assertEquals(68,oldSize - exampleLen);
  assertEquals(14705,(int)(((newSize - exampleLen) * 100. / (oldSize - exampleLen)) * 1000));
  StringBuilder sb=new StringBuilder();
  byte[] ba=bos.toByteArray();
  for (int i=0; i < bos.size(); i+=4) {
    for (int j=i; j < bos.size() && j < i + 4; j++) {
      sb.append(String.format("%02x",ba[j]));
    }
    sb.append(" ");
  }
  assertEquals("80322031 32333435 36373839 20313233 34353637 38392031 32333435 36373839 20313233 34353637 38392031 32333435 36373839 06000000 00000001 ",sb.toString());
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test1(){
  Mutation m=new Mutation(new Text("r1"));
  m.put(new Text("cf1"),new Text("cq1"),new Value("v1".getBytes()));
  List<ColumnUpdate> updates=m.getUpdates();
  assertEquals(1,updates.size());
  ColumnUpdate cu=updates.get(0);
  assertEquals("cf1",new String(cu.getColumnFamily()));
  assertEquals("cq1",new String(cu.getColumnQualifier()));
  assertEquals("",new String(cu.getColumnVisibility()));
  assertFalse(cu.hasTimestamp());
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test2() throws IOException {
  Mutation m=new Mutation(new Text("r1"));
  m.put(new Text("cf1"),new Text("cq1"),new Value("v1".getBytes()));
  m.put(new Text("cf2"),new Text("cq2"),56,new Value("v2".getBytes()));
  List<ColumnUpdate> updates=m.getUpdates();
  assertEquals(2,updates.size());
  assertEquals("r1",new String(m.getRow()));
  ColumnUpdate cu=updates.get(0);
  assertEquals("cf1",new String(cu.getColumnFamily()));
  assertEquals("cq1",new String(cu.getColumnQualifier()));
  assertEquals("",new String(cu.getColumnVisibility()));
  assertFalse(cu.hasTimestamp());
  cu=updates.get(1);
  assertEquals("cf2",new String(cu.getColumnFamily()));
  assertEquals("cq2",new String(cu.getColumnQualifier()));
  assertEquals("",new String(cu.getColumnVisibility()));
  assertTrue(cu.hasTimestamp());
  assertEquals(56,cu.getTimestamp());
  m=cloneMutation(m);
  assertEquals("r1",new String(m.getRow()));
  updates=m.getUpdates();
  assertEquals(2,updates.size());
  cu=updates.get(0);
  assertEquals("cf1",new String(cu.getColumnFamily()));
  assertEquals("cq1",new String(cu.getColumnQualifier()));
  assertEquals("",new String(cu.getColumnVisibility()));
  assertFalse(cu.hasTimestamp());
  cu=updates.get(1);
  assertEquals("cf2",new String(cu.getColumnFamily()));
  assertEquals("cq2",new String(cu.getColumnQualifier()));
  assertEquals("",new String(cu.getColumnVisibility()));
  assertTrue(cu.hasTimestamp());
  assertEquals(56,cu.getTimestamp());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.data.ValueTest </h4><pre class="type-9 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test @Deprecated public void testToArray(){
  List<byte[]> l=new java.util.ArrayList<byte[]>();
  byte[] one=toBytes("one");
  byte[] two=toBytes("two");
  byte[] three=toBytes("three");
  l.add(one);
  l.add(two);
  l.add(three);
  byte[][] a=Value.toArray(l);
  assertEquals(3,a.length);
  assertArrayEquals(one,a[0]);
  assertArrayEquals(two,a[1]);
  assertArrayEquals(three,a[2]);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.file.BloomFilterLayerLookupTest </h4><pre class="type-9 type-13 type-11 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void test() throws IOException {
  HashSet<Integer> valsSet=new HashSet<Integer>();
  for (int i=0; i < 100000; i++) {
    valsSet.add(random.nextInt(Integer.MAX_VALUE));
  }
  ArrayList<Integer> vals=new ArrayList<Integer>(valsSet);
  Collections.sort(vals);
  ConfigurationCopy acuconf=new ConfigurationCopy(AccumuloConfiguration.getDefaultConfiguration());
  acuconf.set(Property.TABLE_BLOOM_ENABLED,"true");
  acuconf.set(Property.TABLE_BLOOM_KEY_FUNCTOR,ColumnFamilyFunctor.class.getName());
  acuconf.set(Property.TABLE_FILE_TYPE,RFile.EXTENSION);
  acuconf.set(Property.TABLE_BLOOM_LOAD_THRESHOLD,"1");
  acuconf.set(Property.TSERV_BLOOM_LOAD_MAXCONCURRENT,"1");
  Configuration conf=CachedConfiguration.getInstance();
  FileSystem fs=FileSystem.get(conf);
  String suffix=FileOperations.getNewFileExtension(acuconf);
  String fname=new File(tempDir.getRoot(),testName + "." + suffix).getAbsolutePath();
  FileSKVWriter bmfw=FileOperations.getInstance().openWriter(fname,fs,conf,acuconf);
  long t1=System.currentTimeMillis();
  bmfw.startDefaultLocalityGroup();
  for (  Integer i : vals) {
    String fi=String.format("%010d",i);
    bmfw.append(new Key(new Text("r" + fi),new Text("cf1")),new Value(("v" + fi).getBytes()));
    bmfw.append(new Key(new Text("r" + fi),new Text("cf2")),new Value(("v" + fi).getBytes()));
  }
  long t2=System.currentTimeMillis();
  LOG.debug(String.format("write rate %6.2f%n",vals.size() / ((t2 - t1) / 1000.0)));
  bmfw.close();
  t1=System.currentTimeMillis();
  FileSKVIterator bmfr=FileOperations.getInstance().openReader(fname,false,fs,conf,acuconf);
  t2=System.currentTimeMillis();
  LOG.debug("Opened " + fname + " in "+ (t2 - t1));
  int hits=0;
  t1=System.currentTimeMillis();
  for (int i=0; i < 5000; i++) {
    int row=random.nextInt(Integer.MAX_VALUE);
    seek(bmfr,row);
    if (valsSet.contains(row)) {
      hits++;
      assertTrue(bmfr.hasTop());
    }
  }
  t2=System.currentTimeMillis();
  double rate1=5000 / ((t2 - t1) / 1000.0);
  LOG.debug(String.format("random lookup rate : %6.2f%n",rate1));
  LOG.debug("hits = " + hits);
  int count=0;
  t1=System.currentTimeMillis();
  for (  Integer row : valsSet) {
    seek(bmfr,row);
    assertTrue(bmfr.hasTop());
    count++;
    if (count >= 500) {
      break;
    }
  }
  t2=System.currentTimeMillis();
  double rate2=500 / ((t2 - t1) / 1000.0);
  LOG.debug(String.format("existant lookup rate %6.2f%n",rate2));
  LOG.debug("expected hits 500.  Receive hits: " + count);
  bmfr.close();
  assertTrue(rate1 > rate2);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.file.rfile.BlockIndexTest </h4><pre class="type-9 type-13 type-5 type-3 type-15 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSame() throws IOException {
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  DataOutputStream out=new DataOutputStream(baos);
  Key prevKey=null;
  int num=1000;
  for (int i=0; i < num; i++) {
    Key key=new Key(RFileTest.nf("",1),"cf1","cq1");
    new RelativeKey(prevKey,key).write(out);
    new Value(new byte[0]).write(out);
    prevKey=key;
  }
  for (int i=0; i < num; i++) {
    Key key=new Key(RFileTest.nf("",3),"cf1","cq1");
    new RelativeKey(prevKey,key).write(out);
    new Value(new byte[0]).write(out);
    prevKey=key;
  }
  for (int i=0; i < num; i++) {
    Key key=new Key(RFileTest.nf("",5),"cf1","cq1");
    new RelativeKey(prevKey,key).write(out);
    new Value(new byte[0]).write(out);
    prevKey=key;
  }
  out.close();
  final byte[] data=baos.toByteArray();
  CacheEntry ce=new MyCacheEntry(data);
  ABlockReader cacheBlock=new CachableBlockFile.CachedBlockRead(ce,data);
  BlockIndex blockIndex=null;
  for (int i=0; i < 257; i++)   blockIndex=BlockIndex.getIndex(cacheBlock,new IndexEntry(prevKey,num,0,0,0));
  Assert.assertSame(null,blockIndex.seekBlock(new Key(RFileTest.nf("",0),"cf1","cq1"),cacheBlock));
  Assert.assertSame(null,blockIndex.seekBlock(new Key(RFileTest.nf("",1),"cf1","cq1"),cacheBlock));
  for (int i=2; i < 6; i++) {
    Key seekKey=new Key(RFileTest.nf("",i),"cf1","cq1");
    BlockIndexEntry bie=blockIndex.seekBlock(seekKey,cacheBlock);
    Assert.assertTrue(bie.getPrevKey().compareTo(seekKey) < 0);
    RelativeKey rk=new RelativeKey();
    rk.setPrevKey(bie.getPrevKey());
    rk.readFields(cacheBlock);
    Assert.assertTrue(rk.getKey().compareTo(seekKey) <= 0);
  }
  cacheBlock.close();
}

</code></pre>

<br>
<pre class="type-9 type-13 type-11 type-3 type-15 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test1() throws IOException {
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  DataOutputStream out=new DataOutputStream(baos);
  Key prevKey=null;
  int num=1000;
  for (int i=0; i < num; i++) {
    Key key=new Key(RFileTest.nf("",i),"cf1","cq1");
    new RelativeKey(prevKey,key).write(out);
    new Value(new byte[0]).write(out);
    prevKey=key;
  }
  out.close();
  final byte[] data=baos.toByteArray();
  CacheEntry ce=new MyCacheEntry(data);
  ABlockReader cacheBlock=new CachableBlockFile.CachedBlockRead(ce,data);
  BlockIndex blockIndex=null;
  for (int i=0; i < 129; i++)   blockIndex=BlockIndex.getIndex(cacheBlock,new IndexEntry(prevKey,num,0,0,0));
  BlockIndexEntry[] indexEntries=blockIndex.getIndexEntries();
  for (int i=0; i < indexEntries.length; i++) {
    int row=Integer.parseInt(indexEntries[i].getPrevKey().getRowData().toString());
    BlockIndexEntry bie;
    bie=blockIndex.seekBlock(new Key(RFileTest.nf("",row),"cf1","cq1"),cacheBlock);
    if (i == 0)     Assert.assertSame(null,bie);
 else     Assert.assertSame(indexEntries[i - 1],bie);
    Assert.assertSame(bie,blockIndex.seekBlock(new Key(RFileTest.nf("",row - 1),"cf1","cq1"),cacheBlock));
    bie=blockIndex.seekBlock(new Key(RFileTest.nf("",row + 1),"cf1","cq1"),cacheBlock);
    Assert.assertSame(indexEntries[i],bie);
    RelativeKey rk=new RelativeKey();
    rk.setPrevKey(bie.getPrevKey());
    rk.readFields(cacheBlock);
    Assert.assertEquals(rk.getKey(),new Key(RFileTest.nf("",row + 1),"cf1","cq1"));
  }
  cacheBlock.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.file.rfile.RFileTest </h4><pre class="type-9 type-13 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test3() throws IOException {
  TestRFile trf=new TestRFile(conf);
  trf.openWriter();
  int val=0;
  ArrayList<Key> expectedKeys=new ArrayList<Key>(10000);
  ArrayList<Value> expectedValues=new ArrayList<Value>(10000);
  for (int row=0; row < 4; row++) {
    String rowS=nf("r_",row);
    for (int cf=0; cf < 4; cf++) {
      String cfS=nf("cf_",cf);
      for (int cq=0; cq < 4; cq++) {
        String cqS=nf("cq_",cq);
        for (int cv='A'; cv < 'A' + 4; cv++) {
          String cvS="" + (char)cv;
          for (int ts=4; ts > 0; ts--) {
            Key k=nk(rowS,cfS,cqS,cvS,ts);
            k.setDeleted(true);
            Value v=nv("" + val);
            trf.writer.append(k,v);
            expectedKeys.add(k);
            expectedValues.add(v);
            k=nk(rowS,cfS,cqS,cvS,ts);
            v=nv("" + val);
            trf.writer.append(k,v);
            expectedKeys.add(k);
            expectedValues.add(v);
            val++;
          }
        }
      }
    }
  }
  trf.closeWriter();
  trf.openReader();
  trf.iter.seek(new Range((Key)null,null),EMPTY_COL_FAMS,false);
  verify(trf,expectedKeys.iterator(),expectedValues.iterator());
  int index=expectedKeys.size() / 2;
  trf.seek(expectedKeys.get(index));
  verify(trf,expectedKeys.subList(index,expectedKeys.size()).iterator(),expectedValues.subList(index,expectedKeys.size()).iterator());
  index=0;
  trf.seek(expectedKeys.get(index));
  verify(trf,expectedKeys.subList(index,expectedKeys.size()).iterator(),expectedValues.subList(index,expectedKeys.size()).iterator());
  index=expectedKeys.size() - 1;
  trf.seek(expectedKeys.get(index));
  verify(trf,expectedKeys.subList(index,expectedKeys.size()).iterator(),expectedValues.subList(index,expectedKeys.size()).iterator());
  index=expectedKeys.size();
  trf.seek(new Key(new Text("z")));
  verify(trf,expectedKeys.subList(index,expectedKeys.size()).iterator(),expectedValues.subList(index,expectedKeys.size()).iterator());
  index=expectedKeys.size() / 2;
  trf.seek(expectedKeys.get(index));
  assertTrue(trf.iter.hasTop());
  assertEquals(expectedKeys.get(index),trf.iter.getTopKey());
  assertEquals(expectedValues.get(index),trf.iter.getTopValue());
  trf.iter.next();
  index++;
  assertTrue(trf.iter.hasTop());
  assertEquals(expectedKeys.get(index),trf.iter.getTopKey());
  assertEquals(expectedValues.get(index),trf.iter.getTopValue());
  trf.seek(expectedKeys.get(index));
  assertTrue(trf.iter.hasTop());
  assertEquals(expectedKeys.get(index),trf.iter.getTopKey());
  assertEquals(expectedValues.get(index),trf.iter.getTopValue());
  index=0;
  for (  Key key : expectedKeys) {
    trf.seek(key);
    assertTrue(trf.iter.hasTop());
    assertEquals(key,trf.iter.getTopKey());
    assertEquals(expectedValues.get(index),trf.iter.getTopValue());
    if (index > 0) {
      expectedKeys.get(index - 1);
    }
    index++;
  }
  for (int i=expectedKeys.size() - 1; i >= 0; i--) {
    Key key=expectedKeys.get(i);
    trf.seek(key);
    assertTrue(trf.iter.hasTop());
    assertEquals(key,trf.iter.getTopKey());
    assertEquals(expectedValues.get(i),trf.iter.getTopValue());
    if (i - 1 > 0) {
      expectedKeys.get(i - 1);
    }
  }
  assertEquals(expectedKeys.get(expectedKeys.size() - 1),trf.reader.getLastKey());
  Random rand=new Random();
  for (int i=0; i < 12; i++) {
    index=rand.nextInt(expectedKeys.size());
    trf.seek(expectedKeys.get(index));
    for (; index < expectedKeys.size(); index++) {
      assertTrue(trf.iter.hasTop());
      assertEquals(expectedKeys.get(index),trf.iter.getTopKey());
      assertEquals(expectedValues.get(index),trf.iter.getTopValue());
      trf.iter.next();
    }
  }
  trf.closeReader();
}

</code></pre>

<br>
<pre class="type-9 type-13 type-3 type-2 type-14 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testSample() throws IOException {
  int num=10000;
  for (  int sampleBufferSize : new int[]{1 << 10,1 << 20}) {
    RFile.setSampleBufferSize(sampleBufferSize);
    for (    int modulus : new int[]{19,103,1019}) {
      Hasher dataHasher=Hashing.md5().newHasher();
      List<Entry<Key,Value>> sampleData=new ArrayList<Entry<Key,Value>>();
      ConfigurationCopy sampleConf=new ConfigurationCopy(conf == null ? AccumuloConfiguration.getDefaultConfiguration() : conf);
      sampleConf.set(Property.TABLE_SAMPLER,RowSampler.class.getName());
      sampleConf.set(Property.TABLE_SAMPLER_OPTS + "hasher","murmur3_32");
      sampleConf.set(Property.TABLE_SAMPLER_OPTS + "modulus",modulus + "");
      Sampler sampler=SamplerFactory.newSampler(SamplerConfigurationImpl.newSamplerConfig(sampleConf),sampleConf);
      TestRFile trf=new TestRFile(sampleConf);
      trf.openWriter();
      for (int i=0; i < num; i++) {
        add(trf,nk(i,0),nv(i,0),dataHasher,sampleData,sampler);
        add(trf,nk(i,1),nv(i,1),dataHasher,sampleData,sampler);
      }
      HashCode expectedDataHash=dataHasher.hash();
      trf.closeWriter();
      trf.openReader();
      FileSKVIterator sample=trf.reader.getSample(SamplerConfigurationImpl.newSamplerConfig(sampleConf));
      checkSample(sample,sampleData);
      Assert.assertEquals(expectedDataHash,hash(trf.reader));
      SampleIE ie=new SampleIE(SamplerConfigurationImpl.newSamplerConfig(sampleConf).toSamplerConfiguration());
      for (int i=0; i < 3; i++) {
        trf.reader.closeDeepCopies();
        sample=trf.reader.getSample(SamplerConfigurationImpl.newSamplerConfig(sampleConf));
        SortedKeyValueIterator<Key,Value> sampleDC1=sample.deepCopy(ie);
        SortedKeyValueIterator<Key,Value> sampleDC2=sample.deepCopy(ie);
        SortedKeyValueIterator<Key,Value> sampleDC3=trf.reader.deepCopy(ie);
        SortedKeyValueIterator<Key,Value> allDC1=sampleDC1.deepCopy(new SampleIE(null));
        SortedKeyValueIterator<Key,Value> allDC2=sample.deepCopy(new SampleIE(null));
        Assert.assertEquals(expectedDataHash,hash(allDC1));
        Assert.assertEquals(expectedDataHash,hash(allDC2));
        checkSample(sample,sampleData);
        checkSample(sampleDC1,sampleData);
        checkSample(sampleDC2,sampleData);
        checkSample(sampleDC3,sampleData);
      }
      trf.reader.closeDeepCopies();
      trf.closeReader();
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-13 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReseekUnconsumed() throws Exception {
  TestRFile trf=new TestRFile(conf);
  trf.openWriter();
  for (int i=0; i < 2500; i++) {
    trf.writer.append(nk(nf("r_",i),"cf1","cq1","L1",42),nv("foo" + i));
  }
  trf.closeWriter();
  trf.openReader();
  Set<ByteSequence> cfs=Collections.emptySet();
  Random rand=new Random();
  for (int count=0; count < 100; count++) {
    int start=rand.nextInt(2300);
    Range range=new Range(nk(nf("r_",start),"cf1","cq1","L1",42),nk(nf("r_",start + 100),"cf1","cq1","L1",42));
    trf.reader.seek(range,cfs,false);
    int numToScan=rand.nextInt(100);
    for (int j=0; j < numToScan; j++) {
      assertTrue(trf.reader.hasTop());
      assertEquals(nk(nf("r_",start + j),"cf1","cq1","L1",42),trf.reader.getTopKey());
      trf.reader.next();
    }
    assertTrue(trf.reader.hasTop());
    assertEquals(nk(nf("r_",start + numToScan),"cf1","cq1","L1",42),trf.reader.getTopKey());
    int start2=start + numToScan + rand.nextInt(3);
    int end2=start2 + rand.nextInt(3);
    range=new Range(nk(nf("r_",start2),"cf1","cq1","L1",42),nk(nf("r_",end2),"cf1","cq1","L1",42));
    trf.reader.seek(range,cfs,false);
    for (int j=start2; j <= end2; j++) {
      assertTrue(trf.reader.hasTop());
      assertEquals(nk(nf("r_",j),"cf1","cq1","L1",42),trf.reader.getTopKey());
      trf.reader.next();
    }
    assertFalse(trf.reader.hasTop());
  }
  trf.closeReader();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.file.rfile.RelativeKeyTest </h4><pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSeekMiddle() throws IOException {
  int seekIndex=expectedKeys.size() / 2;
  Key seekKey=expectedKeys.get(seekIndex);
  Key prevKey=new Key();
  Key currKey=null;
  MutableByteSequence value=new MutableByteSequence(new byte[64],0,0);
  RelativeKey.SkippR skippr=RelativeKey.fastSkip(in,seekKey,value,prevKey,currKey);
  assertEquals(seekIndex + 1,skippr.skipped);
  assertEquals(expectedKeys.get(seekIndex - 1),skippr.prevKey);
  assertEquals(expectedKeys.get(seekIndex),skippr.rk.getKey());
  assertEquals(expectedValues.get(seekIndex).toString(),value.toString());
  skippr.rk.readFields(in);
  assertEquals(expectedValues.get(seekIndex + 1).toString(),value.toString());
  in.reset();
  Key fKey=expectedKeys.get(seekIndex).followingKey(PartialKey.ROW_COLFAM_COLQUAL);
  int i;
  for (i=seekIndex; expectedKeys.get(i).compareTo(fKey) < 0; i++) {
  }
  skippr=RelativeKey.fastSkip(in,expectedKeys.get(i),value,prevKey,currKey);
  assertEquals(i + 1,skippr.skipped);
  assertEquals(expectedKeys.get(i - 1),skippr.prevKey);
  assertEquals(expectedKeys.get(i),skippr.rk.getKey());
  assertEquals(expectedValues.get(i).toString(),value.toString());
  skippr=RelativeKey.fastSkip(in,expectedKeys.get(i),value,expectedKeys.get(i - 1),expectedKeys.get(i));
  assertEquals(0,skippr.skipped);
  assertEquals(expectedKeys.get(i - 1),skippr.prevKey);
  assertEquals(expectedKeys.get(i),skippr.rk.getKey());
  assertEquals(expectedValues.get(i).toString(),value.toString());
  fKey=expectedKeys.get(i).followingKey(PartialKey.ROW_COLFAM);
  int j;
  for (j=i; expectedKeys.get(j).compareTo(fKey) < 0; j++) {
  }
  skippr=RelativeKey.fastSkip(in,fKey,value,expectedKeys.get(i - 1),expectedKeys.get(i));
  assertEquals(j - i,skippr.skipped);
  assertEquals(expectedKeys.get(j - 1),skippr.prevKey);
  assertEquals(expectedKeys.get(j),skippr.rk.getKey());
  assertEquals(expectedValues.get(j).toString(),value.toString());
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSeekBeforeEverything() throws IOException {
  Key seekKey=new Key();
  Key prevKey=new Key();
  Key currKey=null;
  MutableByteSequence value=new MutableByteSequence(new byte[64],0,0);
  RelativeKey.SkippR skippr=RelativeKey.fastSkip(in,seekKey,value,prevKey,currKey);
  assertEquals(1,skippr.skipped);
  assertEquals(new Key(),skippr.prevKey);
  assertEquals(expectedKeys.get(0),skippr.rk.getKey());
  assertEquals(expectedValues.get(0).toString(),value.toString());
  skippr.rk.readFields(in);
  assertEquals(expectedKeys.get(1),skippr.rk.getKey());
  in.reset();
  seekKey=new Key("a","b","c","d",1);
  seekKey.setDeleted(true);
  skippr=RelativeKey.fastSkip(in,seekKey,value,prevKey,currKey);
  assertEquals(1,skippr.skipped);
  assertEquals(new Key(),skippr.prevKey);
  assertEquals(expectedKeys.get(0),skippr.rk.getKey());
  assertEquals(expectedValues.get(0).toString(),value.toString());
  skippr.rk.readFields(in);
  assertEquals(expectedKeys.get(1),skippr.rk.getKey());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.iterators.FirstEntryInRowIteratorTest </h4><pre class="type-9 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test() throws IOException {
  TreeMap<Key,Value> sourceMap=new TreeMap<Key,Value>();
  Value emptyValue=new Value("".getBytes());
  sourceMap.put(new Key("r1","cf","cq"),emptyValue);
  sourceMap.put(new Key("r2","cf","cq"),emptyValue);
  sourceMap.put(new Key("r3","cf","cq"),emptyValue);
  TreeMap<Key,Value> resultMap=new TreeMap<Key,Value>();
  long numSourceEntries=sourceMap.size();
  long numNexts=process(sourceMap,resultMap,new Range(),10);
  assertEquals(numNexts,numSourceEntries);
  assertEquals(sourceMap.size(),resultMap.size());
  for (int i=0; i < 20; i++) {
    sourceMap.put(new Key("r2","cf","cq" + i),emptyValue);
  }
  resultMap.clear();
  numNexts=process(sourceMap,resultMap,new Range(new Key("r1"),(new Key("r2")).followingKey(PartialKey.ROW)),10);
  assertEquals(numNexts,resultMap.size() + 10);
  assertEquals(resultMap.size(),2);
  resultMap.clear();
  numNexts=process(sourceMap,resultMap,new Range(new Key("r1"),new Key("r2","cf2")),10);
  assertEquals(numNexts,resultMap.size() + 10);
  assertEquals(resultMap.size(),2);
  resultMap.clear();
  numNexts=process(sourceMap,resultMap,new Range(new Key("r1"),new Key("r4")),10);
  assertEquals(numNexts,resultMap.size() + 10);
  assertEquals(resultMap.size(),3);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.iterators.IteratorUtilTest </h4><pre class="type-9 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void onlyReadsRelevantIteratorScopeConfigurations() throws Exception {
  Map<String,String> data=new HashMap<String,String>();
  data.put(Property.TABLE_ITERATOR_SCAN_PREFIX + "foo","50," + SummingCombiner.class.getName());
  data.put(Property.TABLE_ITERATOR_SCAN_PREFIX + "foo.opt." + SummingCombiner.ALL_OPTION,"true");
  data.put(Property.TABLE_ITERATOR_PREFIX + ".fakescope.bar","50," + SummingCombiner.class.getName());
  data.put(Property.TABLE_ITERATOR_SCAN_PREFIX + "foo.opt.fakeopt","fakevalue");
  AccumuloConfiguration conf=new ConfigurationCopy(data);
  List<IterInfo> iterators=new ArrayList<IterInfo>();
  Map<String,Map<String,String>> options=new HashMap<String,Map<String,String>>();
  IteratorUtil.parseIterConf(IteratorScope.scan,iterators,options,conf);
  Assert.assertEquals(1,iterators.size());
  IterInfo ii=iterators.get(0);
  Assert.assertEquals(new IterInfo(50,SummingCombiner.class.getName(),"foo"),ii);
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void test4() throws IOException {
  AccumuloConfiguration conf=new ConfigurationCopy();
  TreeMap<Key,Value> tm=new TreeMap<Key,Value>();
  MultiIteratorTest.nkv(tm,1,0,false,"1");
  MultiIteratorTest.nkv(tm,2,0,false,"2");
  SortedMapIterator source=new SortedMapIterator(tm);
  SortedKeyValueIterator<Key,Value> iter=IteratorUtil.loadIterators(IteratorScope.majc,source,new KeyExtent(new Text("tab"),null,null),conf,new DefaultIteratorEnvironment(conf));
  iter.seek(new Range(),EMPTY_COL_FAMS,false);
  assertTrue(iter.hasTop());
  assertTrue(iter.getTopKey().equals(MultiIteratorTest.nk(1,0)));
  assertTrue(iter.getTopValue().toString().equals("1"));
  iter.next();
  assertTrue(iter.hasTop());
  assertTrue(iter.getTopKey().equals(MultiIteratorTest.nk(2,0)));
  assertTrue(iter.getTopValue().toString().equals("2"));
  iter.next();
  assertFalse(iter.hasTop());
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void test5() throws IOException {
  ConfigurationCopy conf=new ConfigurationCopy();
  conf.set(Property.TABLE_ITERATOR_PREFIX + IteratorScope.minc.name() + ".filter","1," + AgeOffFilter.class.getName());
  conf.set(Property.TABLE_ITERATOR_PREFIX + IteratorScope.minc.name() + ".filter.opt.ttl","100");
  conf.set(Property.TABLE_ITERATOR_PREFIX + IteratorScope.minc.name() + ".filter.opt.currentTime","1000");
  TreeMap<Key,Value> tm=new TreeMap<Key,Value>();
  MultiIteratorTest.nkv(tm,1,850,false,"1");
  MultiIteratorTest.nkv(tm,2,950,false,"2");
  SortedMapIterator source=new SortedMapIterator(tm);
  SortedKeyValueIterator<Key,Value> iter=IteratorUtil.loadIterators(IteratorScope.minc,source,new KeyExtent(new Text("tab"),null,null),conf,new DefaultIteratorEnvironment(conf));
  iter.seek(new Range(),EMPTY_COL_FAMS,false);
  assertTrue(iter.hasTop());
  assertTrue(iter.getTopKey().equals(MultiIteratorTest.nk(2,950)));
  iter.next();
  assertFalse(iter.hasTop());
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void test1() throws IOException {
  ConfigurationCopy conf=new ConfigurationCopy();
  conf.set(Property.TABLE_ITERATOR_PREFIX + IteratorScope.minc.name() + ".addIter","1," + AddingIter.class.getName());
  conf.set(Property.TABLE_ITERATOR_PREFIX + IteratorScope.minc.name() + ".sqIter","2," + SquaringIter.class.getName());
  TreeMap<Key,Value> tm=new TreeMap<Key,Value>();
  MultiIteratorTest.nkv(tm,1,0,false,"1");
  MultiIteratorTest.nkv(tm,2,0,false,"2");
  SortedMapIterator source=new SortedMapIterator(tm);
  SortedKeyValueIterator<Key,Value> iter=IteratorUtil.loadIterators(IteratorScope.minc,source,new KeyExtent(new Text("tab"),null,null),conf,new DefaultIteratorEnvironment(conf));
  iter.seek(new Range(),EMPTY_COL_FAMS,false);
  assertTrue(iter.hasTop());
  assertTrue(iter.getTopKey().equals(MultiIteratorTest.nk(1,0)));
  assertTrue(iter.getTopValue().toString().equals("4"));
  iter.next();
  assertTrue(iter.hasTop());
  assertTrue(iter.getTopKey().equals(MultiIteratorTest.nk(2,0)));
  assertTrue(iter.getTopValue().toString().equals("9"));
  iter.next();
  assertFalse(iter.hasTop());
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void test2() throws IOException {
  ConfigurationCopy conf=new ConfigurationCopy();
  conf.set(Property.TABLE_ITERATOR_PREFIX + IteratorScope.minc.name() + ".addIter","1," + AddingIter.class.getName());
  conf.set(Property.TABLE_ITERATOR_PREFIX + IteratorScope.minc.name() + ".addIter.opt.amount","7");
  conf.set(Property.TABLE_ITERATOR_PREFIX + IteratorScope.minc.name() + ".sqIter","2," + SquaringIter.class.getName());
  TreeMap<Key,Value> tm=new TreeMap<Key,Value>();
  MultiIteratorTest.nkv(tm,1,0,false,"1");
  MultiIteratorTest.nkv(tm,2,0,false,"2");
  SortedMapIterator source=new SortedMapIterator(tm);
  SortedKeyValueIterator<Key,Value> iter=IteratorUtil.loadIterators(IteratorScope.minc,source,new KeyExtent(new Text("tab"),null,null),conf,new DefaultIteratorEnvironment(conf));
  iter.seek(new Range(),EMPTY_COL_FAMS,false);
  assertTrue(iter.hasTop());
  assertTrue(iter.getTopKey().equals(MultiIteratorTest.nk(1,0)));
  assertTrue(iter.getTopValue().toString().equals("64"));
  iter.next();
  assertTrue(iter.hasTop());
  assertTrue(iter.getTopKey().equals(MultiIteratorTest.nk(2,0)));
  assertTrue(iter.getTopValue().toString().equals("81"));
  iter.next();
  assertFalse(iter.hasTop());
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void test3() throws IOException {
  ConfigurationCopy conf=new ConfigurationCopy();
  TreeMap<Key,Value> tm=new TreeMap<Key,Value>();
  MultiIteratorTest.nkv(tm,1,0,false,"1");
  MultiIteratorTest.nkv(tm,2,0,false,"2");
  SortedMapIterator source=new SortedMapIterator(tm);
  conf.set(Property.TABLE_ITERATOR_PREFIX + IteratorScope.minc.name() + ".addIter","2," + AddingIter.class.getName());
  conf.set(Property.TABLE_ITERATOR_PREFIX + IteratorScope.minc.name() + ".sqIter","1," + SquaringIter.class.getName());
  SortedKeyValueIterator<Key,Value> iter=IteratorUtil.loadIterators(IteratorScope.minc,source,new KeyExtent(new Text("tab"),null,null),conf,new DefaultIteratorEnvironment(conf));
  iter.seek(new Range(),EMPTY_COL_FAMS,false);
  assertTrue(iter.hasTop());
  assertTrue(iter.getTopKey().equals(MultiIteratorTest.nk(1,0)));
  assertTrue(iter.getTopValue().toString().equals("2"));
  iter.next();
  assertTrue(iter.hasTop());
  assertTrue(iter.getTopKey().equals(MultiIteratorTest.nk(2,0)));
  assertTrue(iter.getTopValue().toString().equals("5"));
  iter.next();
  assertFalse(iter.hasTop());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.iterators.aggregation.NumSummationTest </h4><pre class="type-9 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void test4(){
  try {
    long l=5l;
    byte[] b=NumSummation.longToBytes(l);
    long l2=NumSummation.bytesToLong(b);
    assertTrue(l == l2);
  }
 catch (  Exception e) {
    assertTrue(false);
  }
}

</code></pre>

<br>
<pre class="type-9 type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
"></span><br>
@Test public void test1(){
  try {
    long[] la={1l,2l,3l};
    byte[] b=NumArraySummation.longArrayToBytes(la);
    long[] la2=NumArraySummation.bytesToLongArray(b);
    assertTrue(la.length == la2.length);
    for (int i=0; i < la.length; i++) {
      assertTrue(i + ": " + la[i]+ " does not equal "+ la2[i],la[i] == la2[i]);
    }
  }
 catch (  Exception e) {
    assertTrue(false);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.iterators.user.FilterTest </h4><pre class="type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void test4() throws IOException {
  Value dv=new Value();
  TreeMap<Key,Value> tm=new TreeMap<Key,Value>();
  ColumnVisibility le1=new ColumnVisibility("L1");
  ColumnVisibility le2=new ColumnVisibility("L0&OFFICIAL");
  ColumnVisibility le3=new ColumnVisibility("L1&L2");
  ColumnVisibility le4=new ColumnVisibility("L1&L2&G1");
  ColumnVisibility[] lea={le1,le2,le3,le4};
  Authorizations auths=new Authorizations("L1","L2","L0","OFFICIAL");
  for (int i=0; i < 1000; i++) {
    Key k=new Key(new Text(String.format("%03d",i)),new Text("a"),new Text("b"),new Text(lea[i % 4].getExpression()));
    tm.put(k,dv);
  }
  assertTrue(tm.size() == 1000);
  VisibilityFilter a=new VisibilityFilter(new SortedMapIterator(tm),auths,le2.getExpression());
  a.seek(new Range(),EMPTY_COL_FAMS,false);
  int size=size(a);
  assertTrue("size was " + size,size == 750);
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testNoVisFilter() throws IOException {
  TreeMap<Key,Value> tm=new TreeMap<Key,Value>();
  Value v=new Value();
  for (int i=0; i < 1000; i++) {
    Key k=new Key(String.format("%03d",i),"a","b",i % 10 == 0 ? "vis" : "");
    tm.put(k,v);
  }
  assertTrue(tm.size() == 1000);
  Filter filter=new ReqVisFilter();
  filter.init(new SortedMapIterator(tm),EMPTY_OPTS,null);
  filter.seek(new Range(),EMPTY_COL_FAMS,false);
  int size=size(filter);
  assertTrue("size = " + size,size == 100);
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test3() throws IOException {
  Value dv=new Value();
  TreeMap<Key,Value> tm=new TreeMap<Key,Value>();
  HashSet<Column> hsc=new HashSet<Column>();
  hsc.add(new Column("c".getBytes(),null,null));
  Text colf1=new Text("a");
  Text colq1=new Text("b");
  Text colf2=new Text("c");
  Text colq2=new Text("d");
  Text colf;
  Text colq;
  for (int i=0; i < 1000; i++) {
    if (Math.abs(Math.ceil(i / 2.0) - i / 2.0) < .001) {
      colf=colf1;
      colq=colq1;
    }
 else {
      colf=colf2;
      colq=colq2;
    }
    Key k=new Key(new Text(String.format("%03d",i)),colf,colq);
    k.setTimestamp(157l);
    tm.put(k,dv);
  }
  assertTrue(tm.size() == 1000);
  ColumnQualifierFilter a=new ColumnQualifierFilter(new SortedMapIterator(tm),hsc);
  a.seek(new Range(),EMPTY_COL_FAMS,false);
  assertEquals(size(a),1000);
  hsc=new HashSet<Column>();
  hsc.add(new Column("a".getBytes(),"b".getBytes(),null));
  a=new ColumnQualifierFilter(new SortedMapIterator(tm),hsc);
  a.seek(new Range(),EMPTY_COL_FAMS,false);
  int size=size(a);
  assertTrue("size was " + size,size == 500);
  hsc=new HashSet<Column>();
  a=new ColumnQualifierFilter(new SortedMapIterator(tm),hsc);
  a.seek(new Range(),EMPTY_COL_FAMS,false);
  size=size(a);
  assertTrue("size was " + size,size == 1000);
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void test1() throws IOException {
  Text colf=new Text("a");
  Text colq=new Text("b");
  Value dv=new Value();
  TreeMap<Key,Value> tm=new TreeMap<Key,Value>();
  for (int i=0; i < 1000; i++) {
    Key k=new Key(new Text(String.format("%03d",i)),colf,colq);
    tm.put(k,dv);
  }
  assertTrue(tm.size() == 1000);
  Filter filter1=new SimpleFilter();
  filter1.init(new SortedMapIterator(tm),EMPTY_OPTS,null);
  filter1.seek(new Range(),EMPTY_COL_FAMS,false);
  int size=size(filter1);
  assertTrue("size = " + size,size == 100);
  Filter fi=new SimpleFilter();
  fi.init(new SortedMapIterator(tm),EMPTY_OPTS,null);
  Key k=new Key(new Text("500"));
  fi.seek(new Range(k,null),EMPTY_COL_FAMS,false);
  size=size(fi);
  assertTrue("size = " + size,size == 50);
  filter1=new SimpleFilter();
  filter1.init(new SortedMapIterator(tm),EMPTY_OPTS,null);
  Filter filter2=new SimpleFilter2();
  filter2.init(filter1,EMPTY_OPTS,null);
  filter2.seek(new Range(),EMPTY_COL_FAMS,false);
  size=size(filter2);
  assertTrue("size = " + size,size == 0);
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testDeepCopy() throws IOException {
  Text colf=new Text("a");
  Text colq=new Text("b");
  Value dv=new Value();
  TreeMap<Key,Value> tm=new TreeMap<Key,Value>();
  for (int i=0; i < 1000; i++) {
    Key k=new Key(new Text(String.format("%03d",i)),colf,colq);
    tm.put(k,dv);
  }
  assertTrue(tm.size() == 1000);
  SimpleFilter filter=new SimpleFilter();
  IteratorSetting is=new IteratorSetting(1,SimpleFilter.class);
  Filter.setNegate(is,true);
  filter.init(new SortedMapIterator(tm),is.getOptions(),null);
  SortedKeyValueIterator<Key,Value> copy=filter.deepCopy(null);
  filter.seek(new Range(),EMPTY_COL_FAMS,false);
  int size=size(filter);
  assertTrue("size = " + size,size == 900);
  copy.seek(new Range(),EMPTY_COL_FAMS,false);
  size=size(copy);
  assertTrue("size = " + size,size == 900);
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void test1neg() throws IOException {
  Text colf=new Text("a");
  Text colq=new Text("b");
  Value dv=new Value();
  TreeMap<Key,Value> tm=new TreeMap<Key,Value>();
  for (int i=0; i < 1000; i++) {
    Key k=new Key(new Text(String.format("%03d",i)),colf,colq);
    tm.put(k,dv);
  }
  assertTrue(tm.size() == 1000);
  Filter filter=new SimpleFilter();
  IteratorSetting is=new IteratorSetting(1,SimpleFilter.class);
  Filter.setNegate(is,true);
  filter.init(new SortedMapIterator(tm),is.getOptions(),null);
  filter.seek(new Range(),EMPTY_COL_FAMS,false);
  int size=size(filter);
  assertTrue("size = " + size,size == 900);
  filter.init(new SortedMapIterator(tm),is.getOptions(),null);
  Key k=new Key(new Text("500"));
  filter.seek(new Range(k,null),EMPTY_COL_FAMS,false);
  size=size(filter);
  assertTrue("size = " + size,size == 450);
  filter.init(new SortedMapIterator(tm),EMPTY_OPTS,null);
  Filter filter2=new SimpleFilter2();
  filter2.init(filter,is.getOptions(),null);
  filter2.seek(new Range(),EMPTY_COL_FAMS,false);
  size=size(filter2);
  assertTrue("size = " + size,size == 100);
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testDeletes() throws IOException {
  Text colf=new Text("a");
  Text colq=new Text("b");
  Value dv=new Value();
  TreeMap<Key,Value> tm=new TreeMap<Key,Value>();
  Key k=new Key(new Text("0"),colf,colq);
  tm.put(k,dv);
  k=new Key(new Text("1"),colf,colq,10);
  k.setDeleted(true);
  tm.put(k,dv);
  k=new Key(new Text("1"),colf,colq,5);
  tm.put(k,dv);
  k=new Key(new Text("10"),colf,colq);
  tm.put(k,dv);
  assertTrue(tm.size() == 4);
  Filter filter=new SimpleFilter();
  filter.init(new SortedMapIterator(tm),EMPTY_OPTS,null);
  filter.seek(new Range(),EMPTY_COL_FAMS,false);
  int size=size(filter);
  assertTrue("size = " + size,size == 3);
}

</code></pre>

<br>
<pre class="type-9 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void test5() throws IOException {
  Value dv=new Value();
  TreeMap<Key,Value> tm=new TreeMap<Key,Value>();
  tm.put(new Key(new Text(String.format("%03d",1)),new Text("a"),new Text("x")),dv);
  tm.put(new Key(new Text(String.format("%03d",2)),new Text("a"),new Text("y")),dv);
  tm.put(new Key(new Text(String.format("%03d",3)),new Text("a"),new Text("z")),dv);
  tm.put(new Key(new Text(String.format("%03d",4)),new Text("b"),new Text("x")),dv);
  tm.put(new Key(new Text(String.format("%03d",5)),new Text("b"),new Text("y")),dv);
  assertTrue(tm.size() == 5);
  int size=size(ncqf(tm,new Column("c".getBytes(),null,null)));
  assertTrue(size == 5);
  size=size(ncqf(tm,new Column("a".getBytes(),null,null)));
  assertTrue(size == 5);
  size=size(ncqf(tm,new Column("a".getBytes(),"x".getBytes(),null)));
  assertTrue(size == 1);
  size=size(ncqf(tm,new Column("a".getBytes(),"x".getBytes(),null),new Column("b".getBytes(),"x".getBytes(),null)));
  assertTrue(size == 2);
  size=size(ncqf(tm,new Column("a".getBytes(),"x".getBytes(),null),new Column("b".getBytes(),"y".getBytes(),null)));
  assertTrue(size == 2);
  size=size(ncqf(tm,new Column("a".getBytes(),"x".getBytes(),null),new Column("b".getBytes(),null,null)));
  assertTrue(size == 3);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.iterators.user.RegExFilterTest </h4><pre class="type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void test1() throws IOException {
  TreeMap<Key,Value> tm=new TreeMap<Key,Value>();
  Key k1=nkv(tm,"boo1","yup","20080201","dog");
  Key k2=nkv(tm,"boo1","yap","20080202","cat");
  Key k3=nkv(tm,"boo2","yip","20080203","hamster");
  RegExFilter rei=new RegExFilter();
  rei.describeOptions();
  IteratorSetting is=new IteratorSetting(1,RegExFilter.class);
  RegExFilter.setRegexs(is,".*2",null,null,null,false);
  assertTrue(rei.validateOptions(is.getOptions()));
  rei.init(new SortedMapIterator(tm),is.getOptions(),new DefaultIteratorEnvironment());
  rei.seek(new Range(),EMPTY_COL_FAMS,false);
  assertTrue(rei.hasTop());
  assertTrue(rei.getTopKey().equals(k3));
  rei.next();
  assertFalse(rei.hasTop());
  is.clearOptions();
  RegExFilter.setRegexs(is,null,null,null,"amst",false,true);
  rei.validateOptions(is.getOptions());
  rei.init(new SortedMapIterator(tm),is.getOptions(),new DefaultIteratorEnvironment());
  rei.seek(new Range(),EMPTY_COL_FAMS,false);
  assertTrue(rei.hasTop());
  assertTrue(rei.getTopKey().equals(k3));
  rei.next();
  assertFalse(rei.hasTop());
  is.clearOptions();
  RegExFilter.setRegexs(is,null,"ya.*",null,null,false);
  assertTrue(rei.validateOptions(is.getOptions()));
  rei.init(new SortedMapIterator(tm),is.getOptions(),new DefaultIteratorEnvironment());
  rei.seek(new Range(),EMPTY_COL_FAMS,false);
  assertTrue(rei.hasTop());
  assertTrue(rei.getTopKey().equals(k2));
  rei.next();
  assertFalse(rei.hasTop());
  is.clearOptions();
  RegExFilter.setRegexs(is,null,null,".*01",null,false);
  assertTrue(rei.validateOptions(is.getOptions()));
  rei.init(new SortedMapIterator(tm),is.getOptions(),new DefaultIteratorEnvironment());
  rei.seek(new Range(),EMPTY_COL_FAMS,false);
  assertTrue(rei.hasTop());
  assertTrue(rei.getTopKey().equals(k1));
  rei.next();
  assertFalse(rei.hasTop());
  is.clearOptions();
  RegExFilter.setRegexs(is,null,null,null,".*at",false);
  assertTrue(rei.validateOptions(is.getOptions()));
  rei.init(new SortedMapIterator(tm),is.getOptions(),new DefaultIteratorEnvironment());
  rei.seek(new Range(),EMPTY_COL_FAMS,false);
  assertTrue(rei.hasTop());
  assertTrue(rei.getTopKey().equals(k2));
  rei.next();
  assertFalse(rei.hasTop());
  is.clearOptions();
  RegExFilter.setRegexs(is,null,null,null,".*ap",false);
  rei.init(new SortedMapIterator(tm),is.getOptions(),new DefaultIteratorEnvironment());
  rei.seek(new Range(),EMPTY_COL_FAMS,false);
  assertFalse(rei.hasTop());
  is.clearOptions();
  RegExFilter.setRegexs(is,null,"ya.*",null,".*at",false);
  rei.init(new SortedMapIterator(tm),is.getOptions(),new DefaultIteratorEnvironment());
  rei.seek(new Range(),EMPTY_COL_FAMS,false);
  assertTrue(rei.hasTop());
  assertTrue(rei.getTopKey().equals(k2));
  rei.next();
  assertFalse(rei.hasTop());
  is.clearOptions();
  RegExFilter.setRegexs(is,null,"ya.*",null,".*ap",false);
  rei.init(new SortedMapIterator(tm),is.getOptions(),new DefaultIteratorEnvironment());
  rei.seek(new Range(),EMPTY_COL_FAMS,false);
  assertFalse(rei.hasTop());
  is.clearOptions();
  RegExFilter.setRegexs(is,"boo1",null,null,null,false);
  rei.init(new SortedMapIterator(tm),is.getOptions(),new DefaultIteratorEnvironment());
  rei.seek(new Range(),EMPTY_COL_FAMS,false);
  assertTrue(rei.hasTop());
  assertTrue(rei.getTopKey().equals(k2));
  rei.next();
  assertTrue(rei.hasTop());
  assertTrue(rei.getTopKey().equals(k1));
  rei.next();
  assertFalse(rei.hasTop());
  is.clearOptions();
  rei.init(new SortedMapIterator(tm),is.getOptions(),new DefaultIteratorEnvironment());
  rei.seek(new Range(),EMPTY_COL_FAMS,false);
  assertTrue(rei.hasTop());
  assertTrue(rei.getTopKey().equals(k2));
  rei.next();
  assertTrue(rei.hasTop());
  assertTrue(rei.getTopKey().equals(k1));
  rei.next();
  assertTrue(rei.hasTop());
  assertTrue(rei.getTopKey().equals(k3));
  rei.next();
  assertFalse(rei.hasTop());
  is.clearOptions();
  RegExFilter.setRegexs(is,"hamster",null,"hamster","hamster",true);
  rei.init(new SortedMapIterator(tm),is.getOptions(),new DefaultIteratorEnvironment());
  rei.seek(new Range(),EMPTY_COL_FAMS,false);
  assertTrue(rei.hasTop());
  assertTrue(rei.getTopKey().equals(k3));
  rei.next();
  assertFalse(rei.hasTop());
  is.clearOptions();
  RegExFilter.setRegexs(is,null,"ya.*","hamster",null,true);
  rei.init(new SortedMapIterator(tm),is.getOptions(),new DefaultIteratorEnvironment());
  rei.seek(new Range(),EMPTY_COL_FAMS,false);
  assertTrue(rei.hasTop());
  assertTrue(rei.getTopKey().equals(k2));
  rei.next();
  assertFalse(rei.hasTop());
  is.clearOptions();
  RegExFilter.setRegexs(is,null,"ya.*","hamster",null,true);
  rei.init(new SortedMapIterator(tm),is.getOptions(),new DefaultIteratorEnvironment());
  rei.seek(new Range(),EMPTY_COL_FAMS,false);
  rei.deepCopy(new DefaultIteratorEnvironment());
  String multiByteText=new String("\u6d67" + "\u6F68" + "\u7067");
  String multiByteRegex=new String(".*" + "\u6F68" + ".*");
  Key k4=new Key("boo4".getBytes(),"hoo".getBytes(),"20080203".getBytes(),"".getBytes(),1l);
  Value inVal=new Value(multiByteText.getBytes(UTF_8));
  tm.put(k4,inVal);
  is.clearOptions();
  RegExFilter.setRegexs(is,null,null,null,multiByteRegex,true);
  rei.init(new SortedMapIterator(tm),is.getOptions(),new DefaultIteratorEnvironment());
  rei.seek(new Range(),EMPTY_COL_FAMS,false);
  assertTrue(rei.hasTop());
  Value outValue=rei.getTopValue();
  String outVal=new String(outValue.get(),UTF_8);
  assertTrue(outVal.equals(multiByteText));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.iterators.user.VersioningIteratorTest </h4><pre class="type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void test1(){
  Text colf=new Text("a");
  Text colq=new Text("b");
  TreeMap<Key,Value> tm=new TreeMap<Key,Value>();
  createTestData(tm,colf,colq);
  try {
    VersioningIterator it=new VersioningIterator();
    IteratorSetting is=new IteratorSetting(1,VersioningIterator.class);
    VersioningIterator.setMaxVersions(is,3);
    it.init(new SortedMapIterator(tm),is.getOptions(),null);
    it.seek(new Range(),EMPTY_COL_FAMS,false);
    TreeMap<Key,Value> tmOut=iteratorOverTestData(it);
    for (    Entry<Key,Value> e : tmOut.entrySet()) {
      assertTrue(e.getValue().get().length == 8);
      assertTrue(16 < encoder.decode(e.getValue().get()));
    }
    assertTrue("size after keeping 3 versions was " + tmOut.size(),tmOut.size() == 6);
  }
 catch (  IOException e) {
    assertFalse(true);
  }
catch (  Exception e) {
    log.error("{}",e.getMessage(),e);
    assertFalse(true);
  }
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void test2(){
  Text colf=new Text("a");
  Text colq=new Text("b");
  TreeMap<Key,Value> tm=new TreeMap<Key,Value>();
  createTestData(tm,colf,colq);
  try {
    VersioningIterator it=new VersioningIterator();
    IteratorSetting is=new IteratorSetting(1,VersioningIterator.class);
    VersioningIterator.setMaxVersions(is,3);
    it.init(new SortedMapIterator(tm),is.getOptions(),null);
    Key seekKey=new Key(new Text(String.format("%03d",1)),colf,colq,18);
    it.seek(new Range(seekKey,null),EMPTY_COL_FAMS,false);
    TreeMap<Key,Value> tmOut=iteratorOverTestData(it);
    for (    Entry<Key,Value> e : tmOut.entrySet()) {
      assertTrue(e.getValue().get().length == 8);
      assertTrue(16 < encoder.decode(e.getValue().get()));
    }
    assertTrue("size after keeping 2 versions was " + tmOut.size(),tmOut.size() == 2);
  }
 catch (  IOException e) {
    assertFalse(true);
  }
catch (  Exception e) {
    log.error("{}",e.getMessage(),e);
    assertFalse(true);
  }
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void test3(){
  Text colf=new Text("a");
  Text colq=new Text("b");
  TreeMap<Key,Value> tm=new TreeMap<Key,Value>();
  createTestData(tm,colf,colq);
  try {
    VersioningIterator it=new VersioningIterator();
    IteratorSetting is=new IteratorSetting(1,VersioningIterator.class);
    VersioningIterator.setMaxVersions(is,3);
    it.init(new SortedMapIterator(tm),is.getOptions(),null);
    Key seekKey=new Key(new Text(String.format("%03d",1)),colf,colq,15);
    it.seek(new Range(seekKey,null),EMPTY_COL_FAMS,false);
    TreeMap<Key,Value> tmOut=iteratorOverTestData(it);
    for (    Entry<Key,Value> e : tmOut.entrySet()) {
      assertTrue(e.getValue().get().length == 8);
      assertTrue(16 < encoder.decode(e.getValue().get()));
    }
    assertTrue("size after seeking past versions was " + tmOut.size(),tmOut.size() == 0);
    seekKey=new Key(new Text(String.format("%03d",0)),colf,colq,15);
    it.seek(new Range(seekKey,null),EMPTY_COL_FAMS,false);
    tmOut=iteratorOverTestData(it);
    for (    Entry<Key,Value> e : tmOut.entrySet()) {
      assertTrue(e.getValue().get().length == 8);
      assertTrue(16 < encoder.decode(e.getValue().get()));
    }
    assertTrue("size after seeking past versions was " + tmOut.size(),tmOut.size() == 3);
  }
 catch (  IOException e) {
    assertFalse(true);
  }
catch (  Exception e) {
    log.error("{}",e.getMessage(),e);
    assertFalse(true);
  }
}

</code></pre>

<br>
<pre class="type-9 type-13 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void test4(){
  Text colf=new Text("a");
  Text colq=new Text("b");
  TreeMap<Key,Value> tm=new TreeMap<Key,Value>();
  createTestData(tm,colf,colq);
  for (int i=1; i <= 30; i++) {
    try {
      VersioningIterator it=new VersioningIterator();
      IteratorSetting is=new IteratorSetting(1,VersioningIterator.class);
      VersioningIterator.setMaxVersions(is,i);
      it.init(new SortedMapIterator(tm),is.getOptions(),null);
      it.seek(new Range(),EMPTY_COL_FAMS,false);
      TreeMap<Key,Value> tmOut=iteratorOverTestData(it);
      assertTrue("size after keeping " + i + " versions was "+ tmOut.size(),tmOut.size() == Math.min(40,2 * i));
    }
 catch (    IOException e) {
      assertFalse(true);
    }
catch (    Exception e) {
      log.error("{}",e.getMessage(),e);
      assertFalse(true);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.metadata.MetadataServicerTest </h4><pre class="type-9 type-5 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetCorrectServicer() throws AccumuloException, AccumuloSecurityException, TableExistsException, TableNotFoundException {
  MetadataServicer ms=MetadataServicer.forTableId(context,RootTable.ID);
  assertTrue(ms instanceof ServicerForRootTable);
  assertFalse(ms instanceof TableMetadataServicer);
  assertEquals(RootTable.ID,ms.getServicedTableId());
  ms=MetadataServicer.forTableId(context,MetadataTable.ID);
  assertTrue(ms instanceof ServicerForMetadataTable);
  assertTrue(ms instanceof TableMetadataServicer);
  assertEquals(RootTable.NAME,((TableMetadataServicer)ms).getServicingTableName());
  assertEquals(MetadataTable.ID,ms.getServicedTableId());
  ms=MetadataServicer.forTableId(context,ReplicationTable.ID);
  assertTrue(ms instanceof ServicerForUserTables);
  assertTrue(ms instanceof TableMetadataServicer);
  assertEquals(MetadataTable.NAME,((TableMetadataServicer)ms).getServicingTableName());
  assertEquals(ReplicationTable.ID,ms.getServicedTableId());
  ms=MetadataServicer.forTableId(context,userTableId);
  assertTrue(ms instanceof ServicerForUserTables);
  assertTrue(ms instanceof TableMetadataServicer);
  assertEquals(MetadataTable.NAME,((TableMetadataServicer)ms).getServicingTableName());
  assertEquals(userTableId,ms.getServicedTableId());
  ms=MetadataServicer.forTableName(context,RootTable.NAME);
  assertTrue(ms instanceof ServicerForRootTable);
  assertFalse(ms instanceof TableMetadataServicer);
  assertEquals(RootTable.ID,ms.getServicedTableId());
  ms=MetadataServicer.forTableName(context,MetadataTable.NAME);
  assertTrue(ms instanceof ServicerForMetadataTable);
  assertTrue(ms instanceof TableMetadataServicer);
  assertEquals(RootTable.NAME,((TableMetadataServicer)ms).getServicingTableName());
  assertEquals(MetadataTable.ID,ms.getServicedTableId());
  ms=MetadataServicer.forTableName(context,ReplicationTable.NAME);
  assertTrue(ms instanceof ServicerForUserTables);
  assertTrue(ms instanceof TableMetadataServicer);
  assertEquals(MetadataTable.NAME,((TableMetadataServicer)ms).getServicingTableName());
  assertEquals(ReplicationTable.ID,ms.getServicedTableId());
  ms=MetadataServicer.forTableName(context,userTableName);
  assertTrue(ms instanceof ServicerForUserTables);
  assertTrue(ms instanceof TableMetadataServicer);
  assertEquals(MetadataTable.NAME,((TableMetadataServicer)ms).getServicingTableName());
  assertEquals(userTableId,ms.getServicedTableId());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.replication.ReplicationSchemaTest </h4><pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void orderSerialization(){
  long now=System.currentTimeMillis();
  Mutation m=OrderSection.createMutation("/accumulo/file",now);
  Key k=new Key(new Text(m.getRow()));
  Assert.assertEquals("/accumulo/file",OrderSection.getFile(k));
  Assert.assertEquals(now,OrderSection.getTimeClosed(k));
}

</code></pre>

<br>
<pre class="type-9 type-13 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void separatorDoesntInterferWithSplit(){
  Text buff=new Text();
  for (long i=1; i < 258; i++) {
    Mutation m=OrderSection.createMutation("/accumulo/file",i);
    Key k=new Key(new Text(m.getRow()));
    Assert.assertEquals("/accumulo/file",OrderSection.getFile(k,buff));
    Assert.assertEquals(i,OrderSection.getTimeClosed(k,buff));
  }
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void orderSerializationWithBuffer(){
  Text buff=new Text();
  long now=System.currentTimeMillis();
  Mutation m=OrderSection.createMutation("/accumulo/file",now);
  Key k=new Key(new Text(m.getRow()));
  Assert.assertEquals("/accumulo/file",OrderSection.getFile(k,buff));
  Assert.assertEquals(now,OrderSection.getTimeClosed(k,buff));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.rpc.SaslConnectionParamsTest </h4><pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testEquality() throws Exception {
  final KerberosToken token=EasyMock.createMock(KerberosToken.class);
  SaslConnectionParams params1=testUser.doAs(new PrivilegedExceptionAction<SaslConnectionParams>(){
    @Override public SaslConnectionParams run() throws Exception {
      final ClientConfiguration clientConf=ClientConfiguration.loadDefault();
      final String primary="accumulo";
      clientConf.withSasl(true,primary);
      final AccumuloConfiguration rpcConf=ClientContext.convertClientConfig(clientConf);
      assertEquals("true",clientConf.get(ClientProperty.INSTANCE_RPC_SASL_ENABLED));
      return new SaslConnectionParams(rpcConf,token);
    }
  }
);
  SaslConnectionParams params2=testUser.doAs(new PrivilegedExceptionAction<SaslConnectionParams>(){
    @Override public SaslConnectionParams run() throws Exception {
      final ClientConfiguration clientConf=ClientConfiguration.loadDefault();
      final String primary="accumulo";
      clientConf.withSasl(true,primary);
      final AccumuloConfiguration rpcConf=ClientContext.convertClientConfig(clientConf);
      assertEquals("true",clientConf.get(ClientProperty.INSTANCE_RPC_SASL_ENABLED));
      return new SaslConnectionParams(rpcConf,token);
    }
  }
);
  assertEquals(params1,params2);
  assertEquals(params1.hashCode(),params2.hashCode());
  final DelegationTokenImpl delToken1=new DelegationTokenImpl(new byte[0],new AuthenticationTokenIdentifier("user",1,10l,20l,"instanceid"));
  SaslConnectionParams params3=testUser.doAs(new PrivilegedExceptionAction<SaslConnectionParams>(){
    @Override public SaslConnectionParams run() throws Exception {
      final ClientConfiguration clientConf=ClientConfiguration.loadDefault();
      final String primary="accumulo";
      clientConf.withSasl(true,primary);
      final AccumuloConfiguration rpcConf=ClientContext.convertClientConfig(clientConf);
      assertEquals("true",clientConf.get(ClientProperty.INSTANCE_RPC_SASL_ENABLED));
      return new SaslConnectionParams(rpcConf,delToken1);
    }
  }
);
  assertNotEquals(params1,params3);
  assertNotEquals(params1.hashCode(),params3.hashCode());
  assertNotEquals(params2,params3);
  assertNotEquals(params2.hashCode(),params3.hashCode());
  final DelegationTokenImpl delToken2=new DelegationTokenImpl(new byte[0],new AuthenticationTokenIdentifier("user",1,10l,20l,"instanceid"));
  SaslConnectionParams params4=testUser.doAs(new PrivilegedExceptionAction<SaslConnectionParams>(){
    @Override public SaslConnectionParams run() throws Exception {
      final ClientConfiguration clientConf=ClientConfiguration.loadDefault();
      final String primary="accumulo";
      clientConf.withSasl(true,primary);
      final AccumuloConfiguration rpcConf=ClientContext.convertClientConfig(clientConf);
      assertEquals("true",clientConf.get(ClientProperty.INSTANCE_RPC_SASL_ENABLED));
      return new SaslConnectionParams(rpcConf,delToken2);
    }
  }
);
  assertNotEquals(params1,params4);
  assertNotEquals(params1.hashCode(),params4.hashCode());
  assertNotEquals(params2,params4);
  assertNotEquals(params2.hashCode(),params4.hashCode());
  assertEquals(params3,params4);
  assertEquals(params3.hashCode(),params4.hashCode());
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDefaultParams() throws Exception {
  final KerberosToken token=EasyMock.createMock(KerberosToken.class);
  testUser.doAs(new PrivilegedExceptionAction<Void>(){
    @Override public Void run() throws Exception {
      final ClientConfiguration clientConf=ClientConfiguration.loadDefault();
      final String primary="accumulo";
      clientConf.withSasl(true,primary);
      final AccumuloConfiguration rpcConf=ClientContext.convertClientConfig(clientConf);
      assertEquals("true",clientConf.get(ClientProperty.INSTANCE_RPC_SASL_ENABLED));
      final SaslConnectionParams saslParams=new SaslConnectionParams(rpcConf,token);
      assertEquals(primary,saslParams.getKerberosServerPrimary());
      final QualityOfProtection defaultQop=QualityOfProtection.get(Property.RPC_SASL_QOP.getDefaultValue());
      assertEquals(defaultQop,saslParams.getQualityOfProtection());
      Map<String,String> properties=saslParams.getSaslProperties();
      assertEquals(1,properties.size());
      assertEquals(defaultQop.getQuality(),properties.get(Sasl.QOP));
      assertEquals(username,saslParams.getPrincipal());
      return null;
    }
  }
);
}

</code></pre>

<br>
<pre class="type-9 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDelegationTokenImpl() throws Exception {
  final DelegationTokenImpl token=new DelegationTokenImpl(new byte[0],new AuthenticationTokenIdentifier("user",1,10l,20l,"instanceid"));
  testUser.doAs(new PrivilegedExceptionAction<Void>(){
    @Override public Void run() throws Exception {
      final ClientConfiguration clientConf=ClientConfiguration.loadDefault();
      final String primary="accumulo";
      clientConf.withSasl(true,primary);
      final AccumuloConfiguration rpcConf=ClientContext.convertClientConfig(clientConf);
      assertEquals("true",clientConf.get(ClientProperty.INSTANCE_RPC_SASL_ENABLED));
      final SaslConnectionParams saslParams=new SaslConnectionParams(rpcConf,token);
      assertEquals(primary,saslParams.getKerberosServerPrimary());
      final QualityOfProtection defaultQop=QualityOfProtection.get(Property.RPC_SASL_QOP.getDefaultValue());
      assertEquals(defaultQop,saslParams.getQualityOfProtection());
      assertEquals(SaslMechanism.DIGEST_MD5,saslParams.getMechanism());
      assertNotNull(saslParams.getCallbackHandler());
      assertEquals(SaslClientDigestCallbackHandler.class,saslParams.getCallbackHandler().getClass());
      Map<String,String> properties=saslParams.getSaslProperties();
      assertEquals(1,properties.size());
      assertEquals(defaultQop.getQuality(),properties.get(Sasl.QOP));
      assertEquals(username,saslParams.getPrincipal());
      return null;
    }
  }
);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.security.AuthenticationTokenIdentifierTest </h4><pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUgi(){
  String principal="user";
  AuthenticationTokenIdentifier token=new AuthenticationTokenIdentifier(principal);
  UserGroupInformation actual=token.getUser(), expected=UserGroupInformation.createRemoteUser(principal);
  assertEquals(expected.getAuthenticationMethod(),actual.getAuthenticationMethod());
  assertEquals(expected.getUserName(),expected.getUserName());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.security.AuthenticationTokenTest </h4><pre class="type-9 type-5 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSerializeDeserializeToken() throws AccumuloSecurityException, IOException {
  Random random=new Random();
  byte[] randomBytes=new byte[12];
  random.nextBytes(randomBytes);
  boolean allZero=true;
  for (  byte b : randomBytes)   allZero=allZero && b == 0;
  assertFalse(allZero);
  byte[] serialized=AuthenticationTokenSerializer.serialize(new PasswordToken(randomBytes));
  PasswordToken passwordToken=AuthenticationTokenSerializer.deserialize(PasswordToken.class,serialized);
  assertArrayEquals(randomBytes,passwordToken.getPassword());
  serialized=AuthenticationTokenSerializer.serialize(new NullToken());
  AuthenticationToken nullToken=AuthenticationTokenSerializer.deserialize(NullToken.class,serialized);
  assertEquals(new NullToken(),nullToken);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.security.ColumnVisibilityTest </h4><pre class="type-9 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testParseTreesOrdering(){
  byte[] expression="(b&c&d)|((a|m)&y&z)|(e&f)".getBytes(UTF_8);
  byte[] flattened=new ColumnVisibility(expression).flatten();
  String flat=new String(flattened,UTF_8);
  assertTrue("shortest expressions sort first",flat.indexOf('e') < flat.indexOf('|'));
  assertTrue("shortest children sort first",flat.indexOf('b') < flat.indexOf('a'));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.security.CredentialsTest </h4><pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void roundtripThrift() throws DestroyFailedException {
  Credentials creds=new Credentials("test",new PasswordToken("testing"));
  TCredentials tCreds=creds.toThrift(inst);
  Credentials roundtrip=Credentials.fromThrift(tCreds);
  assertEquals("Roundtrip through thirft changed credentials equality",creds,roundtrip);
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCredentialsSerialization() throws AccumuloSecurityException {
  Credentials creds=new Credentials("a:b-c",new PasswordToken("d-e-f".getBytes(UTF_8)));
  String serialized=creds.serialize();
  Credentials result=Credentials.deserialize(serialized);
  assertEquals(creds,result);
  assertEquals("a:b-c",result.getPrincipal());
  assertEquals(new PasswordToken("d-e-f"),result.getToken());
  Credentials nullNullCreds=new Credentials(null,null);
  serialized=nullNullCreds.serialize();
  result=Credentials.deserialize(serialized);
  assertEquals(null,result.getPrincipal());
  assertEquals(null,result.getToken());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.security.crypto.BlockedIOStreamTest </h4><pre class="type-9 type-13 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGiantWrite() throws IOException {
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  int blockSize=16;
  BlockedOutputStream blockOut=new BlockedOutputStream(baos,blockSize,blockSize);
  Random r=new Random(22);
  int size=1024 * 1024 * 128;
  byte[] giant=new byte[size];
  byte[] pattern=new byte[1024];
  r.nextBytes(pattern);
  for (int i=0; i < size / 1024; i++) {
    System.arraycopy(pattern,0,giant,i * 1024,1024);
  }
  blockOut.write(giant);
  blockOut.flush();
  blockOut.close();
  baos.close();
  int blocks=(int)Math.ceil(size / (blockSize - 4.0));
  byte[] byteStream=baos.toByteArray();
  assertEquals(blocks * 16,byteStream.length);
  DataInputStream blockIn=new DataInputStream(new BlockedInputStream(new ByteArrayInputStream(byteStream),blockSize,blockSize));
  Arrays.fill(giant,(byte)0);
  blockIn.readFully(giant,0,size);
  blockIn.close();
  for (int i=0; i < size / 1024; i++) {
    byte[] readChunk=new byte[1024];
    System.arraycopy(giant,i * 1024,readChunk,0,1024);
    assertArrayEquals(pattern,readChunk);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.security.crypto.CryptoTest </h4><pre class="type-9 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCryptoModuleParamsParsing(){
  AccumuloConfiguration conf=setAndGetAccumuloConfig(CRYPTO_ON_CONF);
  CryptoModuleParameters params=CryptoModuleFactory.createParamsObjectFromAccumuloConfiguration(conf);
  assertNotNull(params);
  assertEquals("AES",params.getAlgorithmName());
  assertEquals("CFB",params.getEncryptionMode());
  assertEquals("NoPadding",params.getPadding());
  assertEquals(128,params.getKeyLength());
  assertEquals("SHA1PRNG",params.getRandomNumberGenerator());
  assertEquals("SUN",params.getRandomNumberGeneratorProvider());
  assertEquals("org.apache.accumulo.core.security.crypto.CachingHDFSSecretKeyEncryptionStrategy",params.getKeyEncryptionStrategyClass());
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCryptoModuleBasicReadWrite() throws IOException {
  AccumuloConfiguration conf=setAndGetAccumuloConfig(CRYPTO_ON_KEK_OFF_CONF);
  CryptoModule cryptoModule=CryptoModuleFactory.getCryptoModule(conf);
  CryptoModuleParameters params=CryptoModuleFactory.createParamsObjectFromAccumuloConfiguration(conf);
  assertTrue(cryptoModule instanceof DefaultCryptoModule);
  byte[] resultingBytes=setUpSampleEncryptedBytes(cryptoModule,params);
  ByteArrayInputStream in=new ByteArrayInputStream(resultingBytes);
  params=CryptoModuleFactory.createParamsObjectFromAccumuloConfiguration(conf);
  params.setEncryptedInputStream(in);
  params=cryptoModule.getDecryptingInputStream(params);
  InputStream plaintextIn=params.getPlaintextInputStream();
  assertNotNull(plaintextIn);
  assertTrue(plaintextIn != in);
  DataInputStream dataIn=new DataInputStream(plaintextIn);
  String markerString=dataIn.readUTF();
  int markerInt=dataIn.readInt();
  assertEquals(MARKER_STRING,markerString);
  assertEquals(MARKER_INT,markerInt);
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNoCryptoStream() throws IOException {
  AccumuloConfiguration conf=setAndGetAccumuloConfig(CRYPTO_OFF_CONF);
  CryptoModuleParameters params=CryptoModuleFactory.createParamsObjectFromAccumuloConfiguration(conf);
  assertNotNull(params);
  assertEquals("NullCipher",params.getAlgorithmName());
  assertNull(params.getEncryptionMode());
  assertNull(params.getPadding());
  CryptoModule cryptoModule=CryptoModuleFactory.getCryptoModule(conf);
  assertNotNull(cryptoModule);
  assertTrue(cryptoModule instanceof CryptoModuleFactory.NullCryptoModule);
  ByteArrayOutputStream out=new ByteArrayOutputStream();
  params.setPlaintextOutputStream(out);
  params=cryptoModule.getEncryptingOutputStream(params);
  assertNotNull(params.getEncryptedOutputStream());
  assertEquals(out,params.getEncryptedOutputStream());
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testKeyEncryptionNormalPath() throws IOException {
  AccumuloConfiguration conf=setAndGetAccumuloConfig(CRYPTO_ON_CONF);
  CryptoModule cryptoModule=CryptoModuleFactory.getCryptoModule(conf);
  CryptoModuleParameters params=CryptoModuleFactory.createParamsObjectFromAccumuloConfiguration(conf);
  assertTrue(cryptoModule instanceof DefaultCryptoModule);
  assertNotNull(params.getKeyEncryptionStrategyClass());
  assertEquals("org.apache.accumulo.core.security.crypto.CachingHDFSSecretKeyEncryptionStrategy",params.getKeyEncryptionStrategyClass());
  byte[] resultingBytes=setUpSampleEncryptedBytes(cryptoModule,params);
  params=CryptoModuleFactory.createParamsObjectFromAccumuloConfiguration(conf);
  params.setOverrideStreamsSecretKeyEncryptionStrategy(true);
  ByteArrayInputStream in=new ByteArrayInputStream(resultingBytes);
  params.setEncryptedInputStream(in);
  params=cryptoModule.getDecryptingInputStream(params);
  assertNotNull(params.getPlaintextInputStream());
  DataInputStream dataIn=new DataInputStream(params.getPlaintextInputStream());
  String markerString=dataIn.readUTF();
  int markerInt=dataIn.readInt();
  assertEquals(MARKER_STRING,markerString);
  assertEquals(MARKER_INT,markerInt);
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testKeyEncryptionAndCheckThatFileCannotBeReadWithoutKEK() throws IOException {
  AccumuloConfiguration conf=setAndGetAccumuloConfig(CRYPTO_ON_CONF);
  CryptoModule cryptoModule=CryptoModuleFactory.getCryptoModule(conf);
  CryptoModuleParameters params=CryptoModuleFactory.createParamsObjectFromAccumuloConfiguration(conf);
  assertTrue(cryptoModule instanceof DefaultCryptoModule);
  assertNotNull(params.getKeyEncryptionStrategyClass());
  assertEquals("org.apache.accumulo.core.security.crypto.CachingHDFSSecretKeyEncryptionStrategy",params.getKeyEncryptionStrategyClass());
  byte[] resultingBytes=setUpSampleEncryptedBytes(cryptoModule,params);
  conf=setAndGetAccumuloConfig(CRYPTO_ON_KEK_OFF_CONF);
  params=CryptoModuleFactory.createParamsObjectFromAccumuloConfiguration(conf);
  params.setOverrideStreamsSecretKeyEncryptionStrategy(true);
  ByteArrayInputStream in=new ByteArrayInputStream(resultingBytes);
  params.setEncryptedInputStream(in);
  params=cryptoModule.getDecryptingInputStream(params);
  assertNotNull(params.getPlaintextInputStream());
  DataInputStream dataIn=new DataInputStream(params.getPlaintextInputStream());
  exception.expect(IOException.class);
  @SuppressWarnings("unused") String markerString=dataIn.readUTF();
}

</code></pre>

<br>
<pre class="type-9 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testCryptoModuleParamsValidation1() throws IOException {
  AccumuloConfiguration conf=setAndGetAccumuloConfig(CRYPTO_ON_CONF);
  CryptoModuleParameters params=CryptoModuleFactory.createParamsObjectFromAccumuloConfiguration(conf);
  CryptoModule cryptoModule=CryptoModuleFactory.getCryptoModule(conf);
  assertTrue(cryptoModule instanceof DefaultCryptoModule);
  exception.expect(RuntimeException.class);
  cryptoModule.getEncryptingOutputStream(params);
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testChangingCryptoParamsAndCanStillDecryptPreviouslyEncryptedFiles() throws IOException {
  AccumuloConfiguration conf=setAndGetAccumuloConfig(CRYPTO_ON_CONF);
  CryptoModule cryptoModule=CryptoModuleFactory.getCryptoModule(conf);
  CryptoModuleParameters params=CryptoModuleFactory.createParamsObjectFromAccumuloConfiguration(conf);
  assertTrue(cryptoModule instanceof DefaultCryptoModule);
  assertNotNull(params.getKeyEncryptionStrategyClass());
  assertEquals("org.apache.accumulo.core.security.crypto.CachingHDFSSecretKeyEncryptionStrategy",params.getKeyEncryptionStrategyClass());
  byte[] resultingBytes=setUpSampleEncryptedBytes(cryptoModule,params);
  params=CryptoModuleFactory.createParamsObjectFromAccumuloConfiguration(conf);
  params.setAlgorithmName("DESede");
  params.setKeyLength(24 * 8);
  ByteArrayInputStream in=new ByteArrayInputStream(resultingBytes);
  params.setEncryptedInputStream(in);
  params=cryptoModule.getDecryptingInputStream(params);
  assertNotNull(params.getPlaintextInputStream());
  DataInputStream dataIn=new DataInputStream(params.getPlaintextInputStream());
  String markerString=dataIn.readUTF();
  int markerInt=dataIn.readInt();
  assertEquals(MARKER_STRING,markerString);
  assertEquals(MARKER_INT,markerInt);
}

</code></pre>

<br>
<pre class="type-9 type-11 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCryptoModuleDoesntLeakSensitive() throws IOException {
  AccumuloConfiguration conf=setAndGetAccumuloConfig(CRYPTO_ON_CONF);
  CryptoModuleParameters params=CryptoModuleFactory.createParamsObjectFromAccumuloConfiguration(conf);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  params.setPlaintextOutputStream(baos);
  CryptoModule cryptoModule=CryptoModuleFactory.getCryptoModule(conf);
  cryptoModule.getEncryptingOutputStream(params);
  params.getEncryptedOutputStream().close();
  byte[] streamBytes=baos.toByteArray();
  for (  Property prop : Property.values()) {
    if (prop.isSensitive()) {
      byte[] toCheck=prop.getKey().getBytes();
      assertEquals(-1,Bytes.indexOf(streamBytes,toCheck));
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testCryptoModuleParamsValidation2() throws IOException {
  AccumuloConfiguration conf=setAndGetAccumuloConfig(CRYPTO_ON_CONF);
  CryptoModuleParameters params=CryptoModuleFactory.createParamsObjectFromAccumuloConfiguration(conf);
  CryptoModule cryptoModule=CryptoModuleFactory.getCryptoModule(conf);
  assertTrue(cryptoModule instanceof DefaultCryptoModule);
  exception.expect(RuntimeException.class);
  cryptoModule.getDecryptingInputStream(params);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.util.ByteBufferUtilTest </h4><pre class="type-9 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testZeroArrayOffsetAndPosition(){
  byte[] data="0123456789".getBytes(UTF_8);
  ByteBuffer bb1=ByteBuffer.wrap(data,0,4);
  assertEquals("0123",bb1);
}

</code></pre>

<br>
<pre class="type-9 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testZeroArrayOffsetAndNonZeroPosition(){
  byte[] data="0123456789".getBytes(UTF_8);
  ByteBuffer bb1=ByteBuffer.wrap(data,3,4);
  assertEquals("3456",bb1);
}

</code></pre>

<br>
<pre class="type-9 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNonZeroArrayOffset(){
  byte[] data="0123456789".getBytes(UTF_8);
  ByteBuffer bb1=ByteBuffer.wrap(data,3,4);
  ByteBuffer bb2=bb1.slice();
  Assert.assertEquals(3,bb2.arrayOffset());
  Assert.assertEquals(0,bb2.position());
  Assert.assertEquals(4,bb2.limit());
  assertEquals("3456",bb2);
  bb2.get();
  assertEquals("456",bb2);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.util.LocalityGroupUtilTest </h4><pre class="type-9 type-8 type-5 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testColumnFamilySet(){
  ConfigurationCopy conf=new ConfigurationCopy();
  conf.set("table.group.lg1","cf1,cf2");
  conf.set("table.groups.enabled","lg1");
  try {
    Map<String,Set<ByteSequence>> groups=LocalityGroupUtil.getLocalityGroups(conf);
    assertEquals(1,groups.size());
    assertNotNull(groups.get("lg1"));
    assertEquals(2,groups.get("lg1").size());
    assertTrue(groups.get("lg1").contains(new ArrayByteSequence("cf1")));
  }
 catch (  LocalityGroupConfigurationError err) {
    fail();
  }
  try {
    conf.set("table.group.lg2","cf1");
    conf.set("table.groups.enabled","lg1,lg2");
    LocalityGroupUtil.getLocalityGroups(conf);
    fail();
  }
 catch (  LocalityGroupConfigurationError err) {
  }
}

</code></pre>

<br>
<pre class="type-9 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testEncoding() throws Exception {
  byte test1[]=new byte[256];
  byte test2[]=new byte[256];
  for (int i=0; i < 256; i++) {
    test1[i]=(byte)(0xff & i);
    test2[i]=(byte)(0xff & (255 - i));
  }
  ArrayByteSequence bs1=new ArrayByteSequence(test1);
  String ecf=LocalityGroupUtil.encodeColumnFamily(bs1);
  ByteSequence bs2=LocalityGroupUtil.decodeColumnFamily(ecf);
  assertEquals(bs1,bs2);
  assertEquals(ecf,LocalityGroupUtil.encodeColumnFamily(bs2));
  HashSet<Text> in=new HashSet<Text>();
  HashSet<ByteSequence> in2=new HashSet<ByteSequence>();
  in.add(new Text(test1));
  in2.add(new ArrayByteSequence(test1));
  in.add(new Text(test2));
  in2.add(new ArrayByteSequence(test2));
  Set<ByteSequence> out=LocalityGroupUtil.decodeColumnFamilies(LocalityGroupUtil.encodeColumnFamilies(in));
  assertEquals(in2,out);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.util.PairTest </h4><pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test method for {@link org.apache.accumulo.core.util.Pair#fromEntry(java.util.Map.Entry)}.
 */
@Test public void testFromEntry(){
  Entry<Integer,String> entry=new SimpleImmutableEntry<Integer,String>(10,"IO");
  Pair<Integer,String> pair0=Pair.fromEntry(entry);
  assertEquals(entry.getKey(),pair0.getFirst());
  assertEquals(entry.getValue(),pair0.getSecond());
  Pair<Object,Object> pair=Pair.<Object,Object,Integer,String>fromEntry(entry);
  assertEquals(entry.getKey(),pair.getFirst());
  assertEquals(entry.getValue(),pair.getSecond());
  Pair<Number,CharSequence> pair2=Pair.<Number,CharSequence,Integer,String>fromEntry(entry);
  assertEquals(entry.getKey(),pair2.getFirst());
  assertEquals(entry.getValue(),pair2.getSecond());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.util.format.DateFormatSupplierTest </h4><pre class="type-9 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateSimpleFormatSupplier() throws Exception {
  final String format=DateFormatSupplier.HUMAN_READABLE_FORMAT;
  DateFormatSupplier supplierA=DateFormatSupplier.createSimpleFormatSupplier(format);
  DateFormatSupplier supplierB=DateFormatSupplier.createSimpleFormatSupplier(format);
  assertSuppliersIndependent(supplierA,supplierB);
  supplierA.setTimeZone(TimeZone.getTimeZone("UTC"));
  final DateFormat dfA=supplierA.get();
  supplierB.setTimeZone(TimeZone.getTimeZone("EST"));
  final DateFormat dfB=supplierB.get();
  final String resultA=dfA.format(new Date(0));
  assertEquals("1970/01/01 00:00:00.000",resultA);
  final String resultB=dfB.format(new Date(0));
  assertEquals("1969/12/31 19:00:00.000",resultB);
  assertTrue(!resultA.equals(resultB));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.util.format.FormatterFactoryTest </h4><pre class="type-9 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetDefaultFormatter(){
  final FormatterConfig timestampConfig=new FormatterConfig().setPrintTimestamps(true);
  Formatter defaultFormatter=FormatterFactory.getDefaultFormatter(scanner,timestampConfig);
  Formatter bogusFormatter=FormatterFactory.getFormatter(Formatter.class,scanner,timestampConfig);
  assertEquals(defaultFormatter.getClass(),bogusFormatter.getClass());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.core.util.format.ShardedTableDistributionFormatterTest </h4><pre class="type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testAggregate(){
  data.put(new Key("t","~tab","loc"),new Value("srv1".getBytes(UTF_8)));
  data.put(new Key("t;19700101","~tab","loc",0),new Value("srv1".getBytes(UTF_8)));
  data.put(new Key("t;19700101","~tab","loc",1),new Value("srv2".getBytes(UTF_8)));
  formatter.initialize(data.entrySet(),new FormatterConfig());
  String[] resultLines=formatter.next().split("\n");
  List<String> results=Arrays.asList(resultLines).subList(2,4);
  assertTrue(CollectionUtils.exists(results,new AggregateReportChecker("NULL",1)));
  assertTrue(CollectionUtils.exists(results,new AggregateReportChecker("19700101",2)));
  assertFalse(formatter.hasNext());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.examples.simple.filedata.ChunkInputStreamTest </h4><pre class="type-9 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadIntoBufferLargerThanChunks() throws IOException {
  ChunkInputStream cis=new ChunkInputStream();
  byte[] b=new byte[20];
  int read;
  PeekingIterator<Entry<Key,Value>> pi=new PeekingIterator<Entry<Key,Value>>(data.iterator());
  cis.setSource(pi);
  assertEquals(read=cis.read(b),8);
  assertEquals(new String(b,0,read),"asdfjkl;");
  assertEquals(read=cis.read(b),-1);
  cis.setSource(pi);
  assertEquals(read=cis.read(b),10);
  assertEquals(new String(b,0,read),"qwertyuiop");
  assertEquals(read=cis.read(b),-1);
  assertEquals(cis.getVisibilities().toString(),"[A&B, B&C, D]");
  cis.close();
  cis.setSource(pi);
  assertEquals(read=cis.read(b),16);
  assertEquals(new String(b,0,read),"asdfjkl;asdfjkl;");
  assertEquals(read=cis.read(b),-1);
  assertEquals(cis.getVisibilities().toString(),"[A&B]");
  cis.close();
  cis.setSource(pi);
  assertEquals(read=cis.read(b),-1);
  cis.close();
  cis.setSource(pi);
  assertEquals(read=cis.read(b),8);
  assertEquals(new String(b,0,read),"asdfjkl;");
  assertEquals(read=cis.read(b),-1);
  cis.close();
  assertFalse(pi.hasNext());
}

</code></pre>

<br>
<pre class="type-9 type-8 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBadData() throws IOException {
  ChunkInputStream cis=new ChunkInputStream();
  byte[] b=new byte[20];
  int read;
  PeekingIterator<Entry<Key,Value>> pi=new PeekingIterator<Entry<Key,Value>>(baddata.iterator());
  cis.setSource(pi);
  assumeExceptionOnRead(cis,b);
  assumeExceptionOnClose(cis);
  assertEquals(cis.getVisibilities().toString(),"[A]");
  cis.setSource(pi);
  assumeExceptionOnRead(cis,b);
  assumeExceptionOnClose(cis);
  assertEquals(cis.getVisibilities().toString(),"[B, C]");
  cis.setSource(pi);
  assumeExceptionOnRead(cis,b);
  assumeExceptionOnClose(cis);
  assertEquals(cis.getVisibilities().toString(),"[D, E]");
  cis.setSource(pi);
  assertEquals(read=cis.read(b),8);
  assertEquals(new String(b,0,read),"asdfjkl;");
  assertEquals(read=cis.read(b),-1);
  assertEquals(cis.getVisibilities().toString(),"[F, G]");
  cis.close();
  cis.setSource(pi);
  assumeExceptionOnRead(cis,b);
  cis.close();
  assertEquals(cis.getVisibilities().toString(),"[I, J]");
  try {
    cis.setSource(pi);
    fail();
  }
 catch (  IOException e) {
  }
  assumeExceptionOnClose(cis);
  assertEquals(cis.getVisibilities().toString(),"[K]");
  cis.setSource(pi);
  assertEquals(read=cis.read(b),-1);
  assertEquals(cis.getVisibilities().toString(),"[L]");
  cis.close();
  assertFalse(pi.hasNext());
  pi=new PeekingIterator<Entry<Key,Value>>(baddata.iterator());
  cis.setSource(pi);
  assumeExceptionOnClose(cis);
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadIntoBufferSmallerThanChunks() throws IOException {
  ChunkInputStream cis=new ChunkInputStream();
  byte[] b=new byte[5];
  PeekingIterator<Entry<Key,Value>> pi=new PeekingIterator<Entry<Key,Value>>(data.iterator());
  cis.setSource(pi);
  int read;
  assertEquals(read=cis.read(b),5);
  assertEquals(new String(b,0,read),"asdfj");
  assertEquals(read=cis.read(b),3);
  assertEquals(new String(b,0,read),"kl;");
  assertEquals(read=cis.read(b),-1);
  cis.setSource(pi);
  assertEquals(read=cis.read(b),5);
  assertEquals(new String(b,0,read),"qwert");
  assertEquals(read=cis.read(b),5);
  assertEquals(new String(b,0,read),"yuiop");
  assertEquals(read=cis.read(b),-1);
  assertEquals(cis.getVisibilities().toString(),"[A&B, B&C, D]");
  cis.close();
  cis.setSource(pi);
  assertEquals(read=cis.read(b),5);
  assertEquals(new String(b,0,read),"asdfj");
  assertEquals(read=cis.read(b),5);
  assertEquals(new String(b,0,read),"kl;as");
  assertEquals(read=cis.read(b),5);
  assertEquals(new String(b,0,read),"dfjkl");
  assertEquals(read=cis.read(b),1);
  assertEquals(new String(b,0,read),";");
  assertEquals(read=cis.read(b),-1);
  assertEquals(cis.getVisibilities().toString(),"[A&B]");
  cis.close();
  cis.setSource(pi);
  assertEquals(read=cis.read(b),-1);
  cis.close();
  cis.setSource(pi);
  assertEquals(read=cis.read(b),5);
  assertEquals(new String(b,0,read),"asdfj");
  assertEquals(read=cis.read(b),3);
  assertEquals(new String(b,0,read),"kl;");
  assertEquals(read=cis.read(b),-1);
  cis.close();
  assertFalse(pi.hasNext());
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultipleChunkSizes() throws IOException {
  ChunkInputStream cis=new ChunkInputStream();
  byte[] b=new byte[20];
  int read;
  PeekingIterator<Entry<Key,Value>> pi=new PeekingIterator<Entry<Key,Value>>(multidata.iterator());
  b=new byte[20];
  cis.setSource(pi);
  assertEquals(read=cis.read(b),8);
  assertEquals(read=cis.read(b),-1);
  cis.close();
  assertEquals(cis.getVisibilities().toString(),"[A&B]");
  cis.setSource(pi);
  assumeExceptionOnRead(cis,b);
  assertEquals(cis.getVisibilities().toString(),"[A&B]");
  cis.setSource(pi);
  assertEquals(read=cis.read(b),8);
  assertEquals(new String(b,0,read),"asdfjkl;");
  assertEquals(read=cis.read(b),-1);
  cis.close();
  assertEquals(cis.getVisibilities().toString(),"[A&B, B&C]");
  assertFalse(pi.hasNext());
}

</code></pre>

<br>
<pre class="type-9 type-8 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBadDataWithoutClosing() throws IOException {
  ChunkInputStream cis=new ChunkInputStream();
  byte[] b=new byte[20];
  int read;
  PeekingIterator<Entry<Key,Value>> pi=new PeekingIterator<Entry<Key,Value>>(baddata.iterator());
  cis.setSource(pi);
  assumeExceptionOnRead(cis,b);
  assertEquals(cis.getVisibilities().toString(),"[A]");
  cis.setSource(pi);
  assumeExceptionOnRead(cis,b);
  assertEquals(cis.getVisibilities().toString(),"[B, C]");
  cis.setSource(pi);
  assumeExceptionOnRead(cis,b);
  assertEquals(cis.getVisibilities().toString(),"[D, E]");
  cis.setSource(pi);
  assertEquals(read=cis.read(b),8);
  assertEquals(new String(b,0,read),"asdfjkl;");
  assertEquals(read=cis.read(b),-1);
  assertEquals(cis.getVisibilities().toString(),"[F, G]");
  cis.close();
  cis.setSource(pi);
  assumeExceptionOnRead(cis,b);
  assertEquals(cis.getVisibilities().toString(),"[I, J]");
  try {
    cis.setSource(pi);
    fail();
  }
 catch (  IOException e) {
  }
  assertEquals(cis.getVisibilities().toString(),"[K]");
  cis.setSource(pi);
  assertEquals(read=cis.read(b),-1);
  assertEquals(cis.getVisibilities().toString(),"[L]");
  cis.close();
  assertFalse(pi.hasNext());
  pi=new PeekingIterator<Entry<Key,Value>>(baddata.iterator());
  cis.setSource(pi);
  assumeExceptionOnClose(cis);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.fate.zookeeper.ZooReaderWriterTest </h4><pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMutateWithBadVersion() throws Exception {
  final String path="/foo";
  final byte[] value=new byte[]{0};
  final List<ACL> acls=Collections.<ACL>emptyList();
  final byte[] mutatedBytes=new byte[]{1};
  Mutator mutator=new Mutator(){
    @Override public byte[] mutate(    byte[] currentValue) throws Exception {
      return mutatedBytes;
    }
  }
;
  Method getDataMethod=ZooReaderWriter.class.getMethod("getData",String.class,boolean.class,Stat.class);
  zrw=EasyMock.createMockBuilder(ZooReaderWriter.class).addMockedMethods("getRetryFactory","getZooKeeper").addMockedMethod(getDataMethod).createMock();
  EasyMock.expect(zrw.getRetryFactory()).andReturn(retryFactory).anyTimes();
  EasyMock.expect(zrw.getZooKeeper()).andReturn(zk).anyTimes();
  Stat stat=new Stat();
  zk.create(path,value,acls,CreateMode.PERSISTENT);
  EasyMock.expectLastCall().andThrow(new NodeExistsException()).once();
  EasyMock.expect(zrw.getData(path,false,stat)).andReturn(new byte[]{3}).times(2);
  EasyMock.expect(zk.setData(path,mutatedBytes,0)).andThrow(new BadVersionException());
  EasyMock.expect(zk.setData(path,mutatedBytes,0)).andReturn(null);
  EasyMock.replay(zk,zrw,retryFactory,retry);
  Assert.assertArrayEquals(new byte[]{1},zrw.mutate(path,value,acls,mutator));
  EasyMock.verify(zk,zrw,retryFactory,retry);
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMutateWithRetryOnSetData() throws Exception {
  final String path="/foo";
  final byte[] value=new byte[]{0};
  final List<ACL> acls=Collections.<ACL>emptyList();
  final byte[] mutatedBytes=new byte[]{1};
  Mutator mutator=new Mutator(){
    @Override public byte[] mutate(    byte[] currentValue) throws Exception {
      return mutatedBytes;
    }
  }
;
  Method getDataMethod=ZooReaderWriter.class.getMethod("getData",String.class,boolean.class,Stat.class);
  zrw=EasyMock.createMockBuilder(ZooReaderWriter.class).addMockedMethods("getRetryFactory","getZooKeeper").addMockedMethod(getDataMethod).createMock();
  EasyMock.expect(zrw.getRetryFactory()).andReturn(retryFactory).anyTimes();
  EasyMock.expect(zrw.getZooKeeper()).andReturn(zk).anyTimes();
  Stat stat=new Stat();
  zk.create(path,value,acls,CreateMode.PERSISTENT);
  EasyMock.expectLastCall().andThrow(new NodeExistsException()).once();
  EasyMock.expect(zrw.getData(path,false,stat)).andReturn(new byte[]{3}).times(2);
  EasyMock.expect(zk.setData(path,mutatedBytes,0)).andThrow(new ConnectionLossException());
  EasyMock.expect(retry.canRetry()).andReturn(true);
  retry.useRetry();
  EasyMock.expectLastCall();
  retry.waitForNextAttempt();
  EasyMock.expectLastCall();
  EasyMock.expect(zk.setData(path,mutatedBytes,0)).andReturn(null);
  EasyMock.replay(zk,zrw,retryFactory,retry);
  Assert.assertArrayEquals(new byte[]{1},zrw.mutate(path,value,acls,mutator));
  EasyMock.verify(zk,zrw,retryFactory,retry);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.iteratortest.junit4.BaseJUnit4IteratorTest </h4><pre class="type-9 type-5 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIterator(){
  List<IteratorTestReport> reports=runner.runTests();
  assertEquals(1,reports.size());
  IteratorTestReport report=reports.get(0);
  assertNotNull(report);
  assertTrue(report.getSummary(),report.didTestSucceed());
  log.trace("Expected: {}, Actual: {}",report.getExpectedOutput(),report.getActualOutput());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.master.replication.DistributedWorkQueueWorkAssignerHelperTest </h4><pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void queueKeySerialization(){
  Path p=new Path("/accumulo/wals/tserver+port/" + UUID.randomUUID().toString());
  ReplicationTarget target=new ReplicationTarget("cluster1","table1","1");
  String key=DistributedWorkQueueWorkAssignerHelper.getQueueKey(p.toString(),target);
  Entry<String,ReplicationTarget> result=DistributedWorkQueueWorkAssignerHelper.fromQueueKey(key);
  Assert.assertEquals(p.toString(),result.getKey());
  Assert.assertEquals(target,result.getValue());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.minicluster.MiniAccumuloClusterExistingZooKeepersTest </h4><pre class="type-9 type-5 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void canConnectViaExistingZooKeeper() throws Exception {
  Connector conn=accumulo.getConnector("root",SECRET);
  Instance instance=conn.getInstance();
  assertEquals(zooKeeper.getConnectString(),instance.getZooKeepers());
  String tableName="foo";
  conn.tableOperations().create(tableName);
  Map<String,String> tableIds=conn.tableOperations().tableIdMap();
  assertTrue(tableIds.containsKey(tableName));
  String zkTablePath=String.format("/accumulo/%s/tables/%s/name",instance.getInstanceID(),tableIds.get(tableName));
  try (CuratorFramework client=CuratorFrameworkFactory.newClient(zooKeeper.getConnectString(),new RetryOneTime(1))){
    client.start();
    assertNotNull(client.checkExists().forPath(zkTablePath));
    assertEquals(tableName,new String(client.getData().forPath(zkTablePath)));
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.minicluster.impl.MiniAccumuloClusterImplTest </h4><pre class="type-9 type-5 type-3 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=10000) public void testAccurateProcessListReturned() throws Exception {
  Map<ServerType,Collection<ProcessReference>> procs=accumulo.getProcesses();
  Assert.assertTrue(procs.containsKey(ServerType.GARBAGE_COLLECTOR));
  for (  ServerType t : new ServerType[]{ServerType.MASTER,ServerType.TABLET_SERVER,ServerType.ZOOKEEPER}) {
    Assert.assertTrue(procs.containsKey(t));
    Collection<ProcessReference> procRefs=procs.get(t);
    Assert.assertTrue(1 <= procRefs.size());
    for (    ProcessReference procRef : procRefs) {
      Assert.assertNotNull(procRef);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.server.AccumuloServerContextTest </h4><pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSasl() throws Exception {
  testUser.doAs(new PrivilegedExceptionAction<Void>(){
    @Override public Void run() throws Exception {
      Instance instance=EasyMock.createMock(Instance.class);
      ClientConfiguration clientConf=ClientConfiguration.loadDefault();
      clientConf.setProperty(ClientProperty.INSTANCE_RPC_SASL_ENABLED,"true");
      clientConf.setProperty(ClientProperty.KERBEROS_SERVER_PRIMARY,"accumulo");
      final AccumuloConfiguration conf=ClientContext.convertClientConfig(clientConf);
      SiteConfiguration siteConfig=EasyMock.createMock(SiteConfiguration.class);
      EasyMock.expect(siteConfig.getBoolean(Property.INSTANCE_RPC_SASL_ENABLED)).andReturn(true);
      PasswordToken pw=new PasswordToken("fake");
      ByteArrayOutputStream baos=new ByteArrayOutputStream();
      pw.write(new DataOutputStream(baos));
      SystemToken token=new SystemToken();
      token.readFields(new DataInputStream(new ByteArrayInputStream(baos.toByteArray())));
      ServerConfigurationFactory factory=EasyMock.createMock(ServerConfigurationFactory.class);
      EasyMock.expect(factory.getConfiguration()).andReturn(conf).anyTimes();
      EasyMock.expect(factory.getSiteConfiguration()).andReturn(siteConfig).anyTimes();
      EasyMock.expect(factory.getInstance()).andReturn(instance).anyTimes();
      AccumuloServerContext context=EasyMock.createMockBuilder(AccumuloServerContext.class).addMockedMethod("enforceKerberosLogin").addMockedMethod("getConfiguration").addMockedMethod("getServerConfigurationFactory").addMockedMethod("getCredentials").createMock();
      context.enforceKerberosLogin();
      EasyMock.expectLastCall().anyTimes();
      EasyMock.expect(context.getConfiguration()).andReturn(conf).anyTimes();
      EasyMock.expect(context.getServerConfigurationFactory()).andReturn(factory).anyTimes();
      EasyMock.expect(context.getCredentials()).andReturn(new Credentials("accumulo/hostname@FAKE.COM",token)).once();
      EasyMock.expect(siteConfig.get(EasyMock.anyObject(Property.class))).andAnswer(new IAnswer<String>(){
        @Override public String answer(){
          Object[] args=EasyMock.getCurrentArguments();
          return conf.get((Property)args[0]);
        }
      }
).anyTimes();
      EasyMock.expect(siteConfig.iterator()).andAnswer(new IAnswer<Iterator<Entry<String,String>>>(){
        @Override public Iterator<Entry<String,String>> answer(){
          return conf.iterator();
        }
      }
).anyTimes();
      EasyMock.replay(factory,context,siteConfig);
      Assert.assertEquals(ThriftServerType.SASL,context.getThriftServerType());
      SaslServerConnectionParams saslParams=context.getSaslParams();
      Assert.assertEquals(new SaslServerConnectionParams(conf,token),saslParams);
      Assert.assertEquals(username,saslParams.getPrincipal());
      EasyMock.verify(factory,context,siteConfig);
      return null;
    }
  }
);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.server.AccumuloTest </h4><pre class="type-9 type-5 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLocateLogConfig() throws Exception {
  File confDir=new File(FileUtils.getTempDirectory(),"AccumuloTest" + System.currentTimeMillis());
  String confDirName=confDir.getAbsolutePath();
  assertTrue("Failed to make test configuration directory",confDir.mkdir());
  try {
    File appProps=new File(confDir,"flogger_logger.properties");
    String appPropsName=String.format("%s/flogger_logger.properties",confDirName);
    FileUtils.touch(appProps);
    File genericXml=new File(confDir,"generic_logger.xml");
    String genericXmlName=String.format("%s/generic_logger.xml",confDirName);
    FileUtils.touch(genericXml);
    assertEquals(appPropsName,Accumulo.locateLogConfig(confDirName,"flogger"));
    assertEquals(genericXmlName,Accumulo.locateLogConfig(confDirName,"flagger"));
    assertTrue("Failed to delete log configuration file",appProps.delete());
    assertEquals(genericXmlName,Accumulo.locateLogConfig(confDirName,"flogger"));
  }
  finally {
    FileUtils.deleteDirectory(confDir);
  }
}

</code></pre>

<br>
<pre class="type-9 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testLocateLogConfig_Explicit() throws Exception {
  File confDir=new File(FileUtils.getTempDirectory(),"AccumuloTest" + System.currentTimeMillis());
  String confDirName=confDir.getAbsolutePath();
  System.setProperty("log4j.configuration","myconfig.xml");
  try {
    assertEquals("myconfig.xml",Accumulo.locateLogConfig(confDirName,"flogger"));
  }
  finally {
    FileUtils.deleteDirectory(confDir);
    System.clearProperty("log4j.configuration");
  }
}

</code></pre>

<br>
<pre class="type-9 type-5 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLocateLogConfig_Default() throws Exception {
  File confDir=new File(FileUtils.getTempDirectory(),"AccumuloTest" + System.currentTimeMillis());
  String confDirName=confDir.getAbsolutePath();
  assertTrue("Failed to make test configuration directory",confDir.mkdir());
  try {
    String genericXmlName=String.format("%s/generic_logger.xml",confDirName);
    assertEquals(genericXmlName,Accumulo.locateLogConfig(confDirName,"flogger"));
  }
  finally {
    FileUtils.deleteDirectory(confDir);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.server.client.BulkImporterTest </h4><pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFindOverlappingTablets() throws Exception {
  MockTabletLocator locator=new MockTabletLocator();
  FileSystem fs=FileSystem.getLocal(CachedConfiguration.getInstance());
  ClientContext context=EasyMock.createMock(ClientContext.class);
  EasyMock.expect(context.getConfiguration()).andReturn(DefaultConfiguration.getInstance()).anyTimes();
  EasyMock.replay(context);
  String file="target/testFile.rf";
  fs.delete(new Path(file),true);
  FileSKVWriter writer=FileOperations.getInstance().openWriter(file,fs,fs.getConf(),context.getConfiguration());
  writer.startDefaultLocalityGroup();
  Value empty=new Value(new byte[]{});
  writer.append(new Key("a","cf","cq"),empty);
  writer.append(new Key("a","cf","cq1"),empty);
  writer.append(new Key("a","cf","cq2"),empty);
  writer.append(new Key("a","cf","cq3"),empty);
  writer.append(new Key("a","cf","cq4"),empty);
  writer.append(new Key("a","cf","cq5"),empty);
  writer.append(new Key("d","cf","cq"),empty);
  writer.append(new Key("d","cf","cq1"),empty);
  writer.append(new Key("d","cf","cq2"),empty);
  writer.append(new Key("d","cf","cq3"),empty);
  writer.append(new Key("d","cf","cq4"),empty);
  writer.append(new Key("d","cf","cq5"),empty);
  writer.append(new Key("dd","cf","cq1"),empty);
  writer.append(new Key("ichabod","cf","cq"),empty);
  writer.append(new Key("icky","cf","cq1"),empty);
  writer.append(new Key("iffy","cf","cq2"),empty);
  writer.append(new Key("internal","cf","cq3"),empty);
  writer.append(new Key("is","cf","cq4"),empty);
  writer.append(new Key("iterator","cf","cq5"),empty);
  writer.append(new Key("xyzzy","cf","cq"),empty);
  writer.close();
  VolumeManager vm=VolumeManagerImpl.get(context.getConfiguration());
  List<TabletLocation> overlaps=BulkImporter.findOverlappingTablets(context,vm,locator,new Path(file));
  Assert.assertEquals(5,overlaps.size());
  Collections.sort(overlaps);
  Assert.assertEquals(new KeyExtent(tableId,new Text("a"),null),overlaps.get(0).tablet_extent);
  Assert.assertEquals(new KeyExtent(tableId,new Text("d"),new Text("cm")),overlaps.get(1).tablet_extent);
  Assert.assertEquals(new KeyExtent(tableId,new Text("dm"),new Text("d")),overlaps.get(2).tablet_extent);
  Assert.assertEquals(new KeyExtent(tableId,new Text("j"),new Text("i")),overlaps.get(3).tablet_extent);
  Assert.assertEquals(new KeyExtent(tableId,null,new Text("l")),overlaps.get(4).tablet_extent);
  List<TabletLocation> overlaps2=BulkImporter.findOverlappingTablets(context,vm,locator,new Path(file),new KeyExtent(tableId,new Text("h"),new Text("b")));
  Assert.assertEquals(3,overlaps2.size());
  Assert.assertEquals(new KeyExtent(tableId,new Text("d"),new Text("cm")),overlaps2.get(0).tablet_extent);
  Assert.assertEquals(new KeyExtent(tableId,new Text("dm"),new Text("d")),overlaps2.get(1).tablet_extent);
  Assert.assertEquals(new KeyExtent(tableId,new Text("j"),new Text("i")),overlaps2.get(2).tablet_extent);
  Assert.assertEquals(locator.invalidated,1);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.server.data.ServerMutationTest </h4><pre class="type-9 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test() throws Exception {
  ServerMutation m=new ServerMutation(new Text("r1"));
  m.put(new Text("cf1"),new Text("cq1"),new Value("v1".getBytes()));
  m.put(new Text("cf2"),new Text("cq2"),56,new Value("v2".getBytes()));
  m.setSystemTimestamp(42);
  List<ColumnUpdate> updates=m.getUpdates();
  assertEquals(2,updates.size());
  assertEquals("r1",new String(m.getRow()));
  ColumnUpdate cu=updates.get(0);
  assertEquals("cf1",new String(cu.getColumnFamily()));
  assertEquals("cq1",new String(cu.getColumnQualifier()));
  assertEquals("",new String(cu.getColumnVisibility()));
  assertFalse(cu.hasTimestamp());
  assertEquals(42l,cu.getTimestamp());
  ServerMutation m2=new ServerMutation();
  ReflectionUtils.copy(CachedConfiguration.getInstance(),m,m2);
  updates=m2.getUpdates();
  assertEquals(2,updates.size());
  assertEquals("r1",new String(m2.getRow()));
  cu=updates.get(0);
  assertEquals("cf1",new String(cu.getColumnFamily()));
  assertEquals("cq1",new String(cu.getColumnQualifier()));
  assertFalse(cu.hasTimestamp());
  assertEquals(42l,cu.getTimestamp());
  cu=updates.get(1);
  assertEquals("r1",new String(m2.getRow()));
  assertEquals("cf2",new String(cu.getColumnFamily()));
  assertEquals("cq2",new String(cu.getColumnQualifier()));
  assertTrue(cu.hasTimestamp());
  assertEquals(56,cu.getTimestamp());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.server.fs.ViewFSUtilsTest </h4><pre class="type-9 type-11 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testOverlappingMountPoints() throws IllegalArgumentException, IOException {
  if (ViewFSUtils.isViewFSSupported()) {
    Configuration conf=new Configuration(false);
    conf.set("fs.viewfs.mounttable.default.link./","file:///tmp/0");
    conf.set("fs.viewfs.mounttable.default.link./ns1","file:///tmp/1");
    conf.set("fs.viewfs.mounttable.default.link./ns1/A","file:///tmp/2");
    conf.set("fs.viewfs.mounttable.default.link./ns1/AA","file:///tmp/3");
    conf.set("fs.viewfs.mounttable.default.link./ns1/C","file:///tmp/3");
    conf.set("fs.viewfs.mounttable.default.link./ns2","file:///tmp/3");
    String[] tablesDirs1=shuffle("viewfs:///ns1/accumulo/tables","viewfs:///ns1/A/accumulo/tables","viewfs:///ns1/AA/accumulo/tables","viewfs:///ns1/C/accumulo/tables","viewfs:///ns2/accumulo/tables","viewfs:///accumulo/tables");
    String[] tablesDirs2=shuffle("viewfs:/ns1/accumulo/tables","viewfs:/ns1/A/accumulo/tables","viewfs:/ns1/AA/accumulo/tables","viewfs:/ns1/C/accumulo/tables","viewfs:/ns2/accumulo/tables","viewfs:/accumulo/tables");
    for (    String ns : Arrays.asList("","/ns1","/ns1/A","/ns1/AA","/ns1/C","/ns2")) {
      Path match=ViewFSUtils.matchingFileSystem(new Path("viewfs:" + ns + "/bulk_import_01"),tablesDirs2,conf);
      Assert.assertEquals(new Path("viewfs:" + ns + "/accumulo/tables"),match);
      match=ViewFSUtils.matchingFileSystem(new Path("viewfs://" + ns + "/bulk_import_01"),tablesDirs1,conf);
      Assert.assertEquals(new Path("viewfs:" + ns + "/accumulo/tables"),match);
      match=ViewFSUtils.matchingFileSystem(new Path("viewfs:" + ns + "/bulk_import_01"),tablesDirs2,conf);
      Assert.assertEquals(new Path("viewfs:" + ns + "/accumulo/tables"),match);
      match=ViewFSUtils.matchingFileSystem(new Path("viewfs://" + ns + "/bulk_import_01"),tablesDirs1,conf);
      Assert.assertEquals(new Path("viewfs:" + ns + "/accumulo/tables"),match);
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-11 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDisjointMountPoints() throws IllegalArgumentException, IOException {
  if (ViewFSUtils.isViewFSSupported()) {
    Configuration conf=new Configuration(false);
    conf.set("fs.viewfs.mounttable.default.link./ns","file:///tmp/ns");
    conf.set("fs.viewfs.mounttable.default.link./ns1","file:///tmp/ns1");
    conf.set("fs.viewfs.mounttable.default.link./ns2","file:///tmp/ns2");
    conf.set("fs.viewfs.mounttable.default.link./ns22","file:///tmp/ns22");
    String[] tablesDirs1=shuffle("viewfs:///ns1/accumulo/tables","viewfs:///ns2/accumulo/tables","viewfs:///ns22/accumulo/tables","viewfs:///ns/accumulo/tables");
    String[] tablesDirs2=shuffle("viewfs:/ns1/accumulo/tables","viewfs:/ns2/accumulo/tables","viewfs:/ns22/accumulo/tables","viewfs:/ns/accumulo/tables");
    for (    String ns : Arrays.asList("ns1","ns2","ns22","ns")) {
      Path match=ViewFSUtils.matchingFileSystem(new Path("viewfs:/" + ns + "/bulk_import_01"),tablesDirs2,conf);
      Assert.assertEquals(new Path("viewfs:/" + ns + "/accumulo/tables"),match);
      match=ViewFSUtils.matchingFileSystem(new Path("viewfs:///" + ns + "/bulk_import_01"),tablesDirs1,conf);
      Assert.assertEquals(new Path("viewfs:/" + ns + "/accumulo/tables"),match);
      match=ViewFSUtils.matchingFileSystem(new Path("viewfs:/" + ns + "/bulk_import_01"),tablesDirs2,conf);
      Assert.assertEquals(new Path("viewfs:/" + ns + "/accumulo/tables"),match);
      match=ViewFSUtils.matchingFileSystem(new Path("viewfs:///" + ns + "/bulk_import_01"),tablesDirs1,conf);
      Assert.assertEquals(new Path("viewfs:/" + ns + "/accumulo/tables"),match);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.server.fs.VolumeManagerImplTest </h4><pre class="type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void chooseFromOptions() throws Exception {
  List<String> volumes=Arrays.asList("file://one/","file://two/","file://three/");
  ConfigurationCopy conf=new ConfigurationCopy();
  conf.set(INSTANCE_DFS_URI,volumes.get(0));
  conf.set(Property.INSTANCE_VOLUMES,StringUtils.join(volumes,","));
  conf.set(Property.GENERAL_VOLUME_CHOOSER,WrongVolumeChooser.class.getName());
  VolumeManager vm=VolumeManagerImpl.get(conf);
  String choice=vm.choose(Optional.of("sometable"),volumes.toArray(new String[0]));
  Assert.assertTrue("shouldn't see invalid options from misbehaving chooser.",volumes.contains(choice));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.server.problems.ProblemReportTest </h4><pre class="type-9 type-3 type-15 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDecodeZooKeeperEntry() throws Exception {
  byte[] zpathFileName=makeZPathFileName(TABLE,ProblemType.FILE_READ,RESOURCE);
  String node=Encoding.encodeAsBase64FileName(new Text(zpathFileName));
  long now=System.currentTimeMillis();
  byte[] encoded=encodeReportData(now,SERVER,"excmsg");
  expect(zoorw.getData(ZooUtil.getRoot("instance") + Constants.ZPROBLEMS + "/"+ node,null)).andReturn(encoded);
  replay(zoorw);
  r=ProblemReport.decodeZooKeeperEntry(node,zoorw,instance);
  assertEquals(TABLE,r.getTableName());
  assertSame(ProblemType.FILE_READ,r.getProblemType());
  assertEquals(RESOURCE,r.getResource());
  assertEquals(SERVER,r.getServer());
  assertEquals(now,r.getTime());
  assertEquals("excmsg",r.getException());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.server.replication.ReplicationUtilTest </h4><pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUserNameKeytab(){
  final String peerName="peer";
  final String systemImpl="my.replica.system.impl";
  final String config="accumulo_peer,remote_host:2181";
  final String peerDefinition=systemImpl + "," + config;
  confEntries.put(Property.REPLICATION_PEER_USER.getKey() + peerName,"user");
  confEntries.put(Property.REPLICATION_PEER_KEYTAB.getKey() + peerName,"/path/to/keytab");
  confEntries.put(Property.REPLICATION_PEERS.getKey() + peerName,peerDefinition);
  ReplicaSystem system=EasyMock.createMock(ReplicaSystem.class);
  EasyMock.expect(conf.getAllPropertiesWithPrefix(Property.REPLICATION_PEERS)).andReturn(confEntries);
  EasyMock.replay(context,conf,system);
  Map<String,String> peers=util.getPeers();
  EasyMock.verify(context,conf,system);
  assertEquals(1,peers.size());
  Entry<String,String> peer=peers.entrySet().iterator().next();
  assertEquals(peerName,peer.getKey());
  assertEquals(systemImpl,peer.getValue());
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUserNamePassword(){
  final String peerName="peer";
  final String systemImpl="my.replica.system.impl";
  final String config="accumulo_peer,remote_host:2181";
  final String peerDefinition=systemImpl + "," + config;
  confEntries.put(Property.REPLICATION_PEER_USER.getKey() + peerName,"user");
  confEntries.put(Property.REPLICATION_PEER_PASSWORD.getKey() + peerName,"password");
  confEntries.put(Property.REPLICATION_PEERS.getKey() + peerName,peerDefinition);
  ReplicaSystem system=EasyMock.createMock(ReplicaSystem.class);
  EasyMock.expect(conf.getAllPropertiesWithPrefix(Property.REPLICATION_PEERS)).andReturn(confEntries);
  EasyMock.replay(context,conf,system);
  Map<String,String> peers=util.getPeers();
  EasyMock.verify(context,conf,system);
  assertEquals(1,peers.size());
  Entry<String,String> peer=peers.entrySet().iterator().next();
  assertEquals(peerName,peer.getKey());
  assertEquals(systemImpl,peer.getValue());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.server.replication.StatusCombinerTest </h4><pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void commutativeWithMultipleUpdatesSingleBuilder(){
  Status newFile=StatusUtil.fileCreated(100), update1=StatusUtil.ingestedUntil(builder,100), update2=StatusUtil.ingestedUntil(builder,200), repl1=StatusUtil.replicated(builder,50), repl2=StatusUtil.replicated(builder,150);
  Status order1=combiner.typedReduce(key,Arrays.asList(newFile,update1,repl1,update2,repl2).iterator());
  Status permutation=combiner.typedReduce(key,Arrays.asList(newFile,repl1,update1,repl2,update2).iterator());
  Assert.assertEquals(order1,permutation);
  permutation=combiner.typedReduce(key,Arrays.asList(newFile,repl1,repl2,update1,update2).iterator());
  Assert.assertEquals(order1,permutation);
  permutation=combiner.typedReduce(key,Arrays.asList(newFile,update1,update2,repl1,repl2).iterator());
  Assert.assertEquals(order1,permutation);
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void newStatusWithNewIngestSingleBuilder(){
  Status orig=StatusUtil.fileCreated(100);
  Status status=StatusUtil.replicatedAndIngested(builder,10,20);
  Status ret=combiner.typedReduce(key,Arrays.asList(orig,status).iterator());
  Assert.assertEquals(10l,ret.getBegin());
  Assert.assertEquals(20l,ret.getEnd());
  Assert.assertEquals(100l,ret.getCreatedTime());
  Assert.assertEquals(false,ret.getClosed());
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void commutativeWithCloseSingleBuilder(){
  Status newFile=StatusUtil.fileCreated(100), closed=StatusUtil.fileClosed(), secondSync=StatusUtil.ingestedUntil(builder,200);
  Status order1=combiner.typedReduce(key,Arrays.asList(newFile,closed,secondSync).iterator()), order2=combiner.typedReduce(key,Arrays.asList(newFile,secondSync,closed).iterator());
  Assert.assertEquals(order1,order2);
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void commutativeNewFileSingleBuilder(){
  Status newFile=StatusUtil.fileCreated(100), firstSync=StatusUtil.ingestedUntil(builder,100), secondSync=StatusUtil.ingestedUntil(builder,200);
  Status order1=combiner.typedReduce(key,Arrays.asList(newFile,firstSync,secondSync).iterator()), order2=combiner.typedReduce(key,Arrays.asList(secondSync,firstSync,newFile).iterator());
  Assert.assertEquals(order1,order2);
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void commutativeNewUpdatesSingleBuilder(){
  Status newFile=StatusUtil.fileCreated(100), firstSync=StatusUtil.ingestedUntil(builder,100), secondSync=StatusUtil.ingestedUntil(builder,200);
  Status order1=combiner.typedReduce(key,Arrays.asList(newFile,firstSync,secondSync).iterator()), order2=combiner.typedReduce(key,Arrays.asList(newFile,secondSync,firstSync).iterator());
  Assert.assertEquals(order1,order2);
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void commutativeNewUpdates(){
  Status newFile=StatusUtil.fileCreated(100), firstSync=StatusUtil.ingestedUntil(100), secondSync=StatusUtil.ingestedUntil(200);
  Status order1=combiner.typedReduce(key,Arrays.asList(newFile,firstSync,secondSync).iterator()), order2=combiner.typedReduce(key,Arrays.asList(newFile,secondSync,firstSync).iterator());
  Assert.assertEquals(order1,order2);
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void commutativeWithClose(){
  Status newFile=StatusUtil.fileCreated(100), closed=StatusUtil.fileClosed(), secondSync=StatusUtil.ingestedUntil(200);
  Status order1=combiner.typedReduce(key,Arrays.asList(newFile,closed,secondSync).iterator()), order2=combiner.typedReduce(key,Arrays.asList(newFile,secondSync,closed).iterator());
  Assert.assertEquals(order1,order2);
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void commutativeNewFile(){
  Status newFile=StatusUtil.fileCreated(100), firstSync=StatusUtil.ingestedUntil(100), secondSync=StatusUtil.ingestedUntil(200);
  Status order1=combiner.typedReduce(key,Arrays.asList(newFile,firstSync,secondSync).iterator()), order2=combiner.typedReduce(key,Arrays.asList(secondSync,firstSync,newFile).iterator());
  Assert.assertEquals(order1,order2);
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCombination(){
  List<Status> status=new ArrayList<>();
  long time=System.currentTimeMillis();
  status.add(StatusUtil.fileCreated(time));
  status.add(StatusUtil.openWithUnknownLength());
  status.add(StatusUtil.fileClosed());
  Status combined=combiner.typedReduce(new Key("row"),status.iterator());
  Assert.assertEquals(time,combined.getCreatedTime());
  Assert.assertTrue(combined.getInfiniteEnd());
  Assert.assertTrue(combined.getClosed());
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void fileClosedTimeChoosesEarliestIgnoringDefault(){
  Status stat1=Status.newBuilder().setBegin(10).setEnd(20).setClosed(true).setInfiniteEnd(false).setCreatedTime(50).build();
  Status stat2=Status.newBuilder().setBegin(10).setEnd(20).setClosed(true).setInfiniteEnd(false).setCreatedTime(100).build();
  Status combined=combiner.typedReduce(key,Arrays.asList(stat1,stat2).iterator());
  Assert.assertEquals(stat1,combined);
  Status stat3=Status.newBuilder().setBegin(10).setEnd(20).setClosed(true).setInfiniteEnd(false).setCreatedTime(100).build();
  Status combined2=combiner.typedReduce(key,Arrays.asList(combined,stat3).iterator());
  Assert.assertEquals(combined,combined2);
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void returnsSameObject(){
  Status status=StatusUtil.ingestedUntil(10);
  Status ret=combiner.typedReduce(key,Collections.singleton(status).iterator());
  Assert.assertEquals(status,ret);
  Assert.assertTrue(status == ret);
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void commutativeWithMultipleUpdates(){
  Status newFile=StatusUtil.fileCreated(100), update1=StatusUtil.ingestedUntil(100), update2=StatusUtil.ingestedUntil(200), repl1=StatusUtil.replicated(50), repl2=StatusUtil.replicated(150);
  Status order1=combiner.typedReduce(key,Arrays.asList(newFile,update1,repl1,update2,repl2).iterator());
  Status permutation=combiner.typedReduce(key,Arrays.asList(newFile,repl1,update1,repl2,update2).iterator());
  Assert.assertEquals(order1,permutation);
  permutation=combiner.typedReduce(key,Arrays.asList(newFile,repl1,repl2,update1,update2).iterator());
  Assert.assertEquals(order1,permutation);
  permutation=combiner.typedReduce(key,Arrays.asList(newFile,update1,update2,repl1,repl2,update1,update2).iterator());
  Assert.assertEquals(order1,permutation);
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void duplicateStatuses(){
  Status newFile=StatusUtil.fileCreated(100), update1=StatusUtil.ingestedUntil(builder,100), update2=StatusUtil.ingestedUntil(builder,200), repl1=StatusUtil.replicated(builder,50), repl2=StatusUtil.replicated(builder,150);
  Status order1=combiner.typedReduce(key,Arrays.asList(newFile,update1,repl1,update2,repl2).iterator());
  Status permutation=combiner.typedReduce(key,Arrays.asList(newFile,repl1,update1,update1,repl2,update2,update2).iterator());
  Assert.assertEquals(order1,permutation);
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void fileClosedTimePropagated(){
  Status stat1=Status.newBuilder().setBegin(10).setEnd(20).setClosed(true).setInfiniteEnd(false).setCreatedTime(50).build();
  Status stat2=Status.newBuilder().setBegin(10).setEnd(20).setClosed(true).setInfiniteEnd(false).build();
  Status combined=combiner.typedReduce(key,Arrays.asList(stat1,stat2).iterator());
  Assert.assertEquals(stat1,combined);
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void newStatusWithNewIngest(){
  Status orig=StatusUtil.fileCreated(100);
  Status status=StatusUtil.replicatedAndIngested(10,20);
  Status ret=combiner.typedReduce(key,Arrays.asList(orig,status).iterator());
  Assert.assertEquals(10l,ret.getBegin());
  Assert.assertEquals(20l,ret.getEnd());
  Assert.assertEquals(100l,ret.getCreatedTime());
  Assert.assertEquals(false,ret.getClosed());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.server.rpc.RpcWrapperTest </h4><pre class="type-9 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNoOnewayMethods(){
  Map<String,ProcessFunction<FakeService,?>> procs=new HashMap<String,ProcessFunction<FakeService,?>>();
  procs.put("foo",createProcessFunction("foo",false));
  procs.put("foobar",createProcessFunction("foobar",false));
  procs.put("bar",createProcessFunction("bar",false));
  procs.put("barfoo",createProcessFunction("barfoo",false));
  Set<String> onewayMethods=RpcWrapper.getOnewayMethods(procs);
  Assert.assertEquals(Collections.<String>emptySet(),onewayMethods);
}

</code></pre>

<br>
<pre class="type-9 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAllOnewayMethods(){
  Map<String,ProcessFunction<FakeService,?>> procs=new HashMap<String,ProcessFunction<FakeService,?>>();
  procs.put("foo",createProcessFunction("foo",true));
  procs.put("foobar",createProcessFunction("foobar",true));
  procs.put("bar",createProcessFunction("bar",true));
  procs.put("barfoo",createProcessFunction("barfoo",true));
  Set<String> onewayMethods=RpcWrapper.getOnewayMethods(procs);
  Assert.assertEquals(Sets.newHashSet("foo","foobar","bar","barfoo"),onewayMethods);
}

</code></pre>

<br>
<pre class="type-9 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSomeOnewayMethods(){
  Map<String,ProcessFunction<FakeService,?>> procs=new HashMap<String,ProcessFunction<FakeService,?>>();
  procs.put("foo",createProcessFunction("foo",true));
  procs.put("foobar",createProcessFunction("foobar",false));
  procs.put("bar",createProcessFunction("bar",true));
  procs.put("barfoo",createProcessFunction("barfoo",false));
  Set<String> onewayMethods=RpcWrapper.getOnewayMethods(procs);
  Assert.assertEquals(Sets.newHashSet("foo","bar"),onewayMethods);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.server.rpc.SaslDigestCallbackHandlerTest </h4><pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTokenAndIdentifierSerialization() throws Exception {
  Instance instance=createMock(Instance.class);
  AuthenticationTokenSecretManager secretManager=new AuthenticationTokenSecretManager(instance,1000l);
  expect(instance.getInstanceID()).andReturn("instanceid");
  replay(instance);
  secretManager.addKey(new AuthenticationKey(1,0l,1000 * 100l,keyGen.generateKey()));
  Entry<Token<AuthenticationTokenIdentifier>,AuthenticationTokenIdentifier> entry=secretManager.generateToken("user",cfg);
  byte[] password=entry.getKey().getPassword();
  char[] encodedPassword=handler.encodePassword(password);
  String name=handler.encodeIdentifier(entry.getValue().getBytes());
  byte[] decodedIdentifier=handler.decodeIdentifier(name);
  AuthenticationTokenIdentifier identifier=new AuthenticationTokenIdentifier();
  identifier.readFields(new DataInputStream(new ByteArrayInputStream(decodedIdentifier)));
  char[] computedPassword=handler.getPassword(secretManager,identifier);
  verify(instance);
  assertArrayEquals(computedPassword,encodedPassword);
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testTokenSerialization() throws Exception {
  Instance instance=createMock(Instance.class);
  AuthenticationTokenSecretManager secretManager=new AuthenticationTokenSecretManager(instance,1000l);
  expect(instance.getInstanceID()).andReturn("instanceid");
  replay(instance);
  secretManager.addKey(new AuthenticationKey(1,0l,100l,keyGen.generateKey()));
  Entry<Token<AuthenticationTokenIdentifier>,AuthenticationTokenIdentifier> entry=secretManager.generateToken("user",cfg);
  byte[] password=entry.getKey().getPassword();
  char[] encodedPassword=handler.encodePassword(password);
  char[] computedPassword=handler.getPassword(secretManager,entry.getValue());
  verify(instance);
  assertArrayEquals(computedPassword,encodedPassword);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.server.rpc.SaslServerConnectionParamsTest </h4><pre class="type-9 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDefaultParamsAsServer() throws Exception {
  testUser.doAs(new PrivilegedExceptionAction<Void>(){
    @Override public Void run() throws Exception {
      final ClientConfiguration clientConf=ClientConfiguration.loadDefault();
      final String primary="accumulo";
      clientConf.withSasl(true,primary);
      final AccumuloConfiguration rpcConf=ClientContext.convertClientConfig(clientConf);
      assertEquals("true",clientConf.get(ClientProperty.INSTANCE_RPC_SASL_ENABLED));
      PasswordToken pw=new PasswordToken("fake");
      ByteArrayOutputStream baos=new ByteArrayOutputStream();
      pw.write(new DataOutputStream(baos));
      SystemToken token=new SystemToken();
      token.readFields(new DataInputStream(new ByteArrayInputStream(baos.toByteArray())));
      final SaslConnectionParams saslParams=new SaslServerConnectionParams(rpcConf,token);
      assertEquals(primary,saslParams.getKerberosServerPrimary());
      assertEquals(SaslMechanism.GSSAPI,saslParams.getMechanism());
      assertNull(saslParams.getCallbackHandler());
      final QualityOfProtection defaultQop=QualityOfProtection.get(Property.RPC_SASL_QOP.getDefaultValue());
      assertEquals(defaultQop,saslParams.getQualityOfProtection());
      Map<String,String> properties=saslParams.getSaslProperties();
      assertEquals(1,properties.size());
      assertEquals(defaultQop.getQuality(),properties.get(Sasl.QOP));
      assertEquals(username,saslParams.getPrincipal());
      return null;
    }
  }
);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.server.security.SystemCredentialsTest </h4><pre class="type-9 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testSystemCredentials(){
  Credentials a=SystemCredentials.get(inst);
  Credentials b=SystemCredentials.get(inst);
  assertTrue(a.equals(b));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.server.security.delegation.AuthenticationKeyTest </h4><pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAuthKey(){
  SecretKey secretKey=keyGen.generateKey();
  int keyId=20;
  long creationDate=38383838l, expirationDate=83838383l;
  AuthenticationKey authKey=new AuthenticationKey(keyId,creationDate,expirationDate,secretKey);
  assertEquals(secretKey,authKey.getKey());
  assertEquals(keyId,authKey.getKeyId());
  assertEquals(expirationDate,authKey.getExpirationDate());
  AuthenticationKey badCopy=new AuthenticationKey();
  assertNotEquals(badCopy,authKey);
  assertNotEquals(badCopy.hashCode(),authKey.hashCode());
  AuthenticationKey goodCopy=new AuthenticationKey(keyId,creationDate,expirationDate,secretKey);
  assertEquals(authKey,goodCopy);
  assertEquals(authKey.hashCode(),goodCopy.hashCode());
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testWritable() throws IOException {
  SecretKey secretKey=keyGen.generateKey();
  int keyId=20;
  long creationDate=38383838l, expirationDate=83838383l;
  AuthenticationKey authKey=new AuthenticationKey(keyId,creationDate,expirationDate,secretKey);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  DataOutputStream out=new DataOutputStream(baos);
  authKey.write(out);
  byte[] serialized=baos.toByteArray();
  DataInputStream in=new DataInputStream(new ByteArrayInputStream(serialized));
  AuthenticationKey copy=new AuthenticationKey();
  copy.readFields(in);
  assertEquals(authKey,copy);
  assertEquals(authKey.hashCode(),copy.hashCode());
  assertEquals(secretKey,copy.getKey());
  assertEquals(keyId,copy.getKeyId());
  assertEquals(expirationDate,copy.getExpirationDate());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.server.security.delegation.AuthenticationTokenKeyManagerTest </h4><pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testIntervalHasPassed() throws Exception {
  long updateInterval=0 * 1000l;
  long tokenLifetime=100 * 1000l;
  long runTime=10l;
  SecretKey secretKey=keyGen.generateKey();
  AuthenticationKey authKey=new AuthenticationKey(1,runTime,runTime + tokenLifetime,secretKey);
  AuthenticationTokenKeyManager keyManager=new AuthenticationTokenKeyManager(secretManager,zooDistributor,updateInterval,tokenLifetime);
  assertEquals(0l,keyManager.getLastKeyUpdate());
  expect(secretManager.removeExpiredKeys(zooDistributor)).andReturn(0);
  expect(secretManager.generateSecret()).andReturn(secretKey);
  secretManager.addKey(authKey);
  expectLastCall().once();
  zooDistributor.advertise(authKey);
  expectLastCall().once();
  replay(secretManager,zooDistributor);
  keyManager._run(runTime);
  verify(secretManager,zooDistributor);
  assertEquals(runTime,keyManager.getLastKeyUpdate());
  assertEquals(authKey.getKeyId(),keyManager.getIdSeq());
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testExistingKeysAreAddedAtStartup() throws Exception {
  long updateInterval=0 * 1000l;
  long tokenLifetime=100 * 1000l;
  SecretKey secretKey1=keyGen.generateKey(), secretKey2=keyGen.generateKey();
  AuthenticationKey authKey1=new AuthenticationKey(1,0,tokenLifetime,secretKey1), authKey2=new AuthenticationKey(2,tokenLifetime,tokenLifetime * 2,secretKey2);
  AuthenticationTokenKeyManager keyManager=new AuthenticationTokenKeyManager(secretManager,zooDistributor,updateInterval,tokenLifetime);
  assertEquals(0l,keyManager.getLastKeyUpdate());
  expect(zooDistributor.getCurrentKeys()).andReturn(Arrays.asList(authKey1,authKey2));
  secretManager.addKey(authKey1);
  expectLastCall().once();
  secretManager.addKey(authKey2);
  expectLastCall().once();
  expect(secretManager.getCurrentKey()).andReturn(authKey2).once();
  replay(secretManager,zooDistributor);
  keyManager.updateStateFromCurrentKeys();
  verify(secretManager,zooDistributor);
  assertEquals(authKey2.getKeyId(),keyManager.getIdSeq());
  assertEquals(authKey2.getCreationDate(),keyManager.getLastKeyUpdate());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.server.security.delegation.AuthenticationTokenSecretManagerTest </h4><pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test(timeout=20 * 1000) public void testMasterKeyExpiration() throws Exception {
  ZooAuthenticationKeyDistributor keyDistributor=createMock(ZooAuthenticationKeyDistributor.class);
  long then=System.currentTimeMillis();
  long tokenLifetime=10 * 1000l;
  AuthenticationTokenSecretManager secretManager=new AuthenticationTokenSecretManager(instance,tokenLifetime);
  AuthenticationKey authKey1=new AuthenticationKey(1,then,then + tokenLifetime,keyGen.generateKey()), authKey2=new AuthenticationKey(2,then + tokenLifetime,then + tokenLifetime * 2,keyGen.generateKey());
  secretManager.addKey(authKey1);
  keyDistributor.remove(authKey1);
  expectLastCall().once();
  replay(keyDistributor);
  assertEquals(0,secretManager.removeExpiredKeys(keyDistributor));
  assertEquals(1,secretManager.getKeys().size());
  secretManager.addKey(authKey2);
  assertEquals(0,secretManager.removeExpiredKeys(keyDistributor));
  assertEquals(2,secretManager.getKeys().size());
  assertEquals(authKey2,secretManager.getCurrentKey());
  long now=System.currentTimeMillis();
  while (now - (then + tokenLifetime) < 0) {
    Thread.sleep(500);
    now=System.currentTimeMillis();
  }
  assertEquals(1,secretManager.removeExpiredKeys(keyDistributor));
  assertEquals(1,secretManager.getKeys().size());
  assertEquals(authKey2,Iterables.getOnlyElement(secretManager.getKeys().values()));
  assertEquals(authKey2,secretManager.getCurrentKey());
  verify(keyDistributor);
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRemoveKey(){
  long tokenLifetime=60 * 1000;
  AuthenticationTokenSecretManager secretManager=new AuthenticationTokenSecretManager(instance,tokenLifetime);
  AuthenticationKey authKey=new AuthenticationKey(1,0,tokenLifetime,keyGen.generateKey());
  secretManager.addKey(authKey);
  Map<Integer,AuthenticationKey> keys=secretManager.getKeys();
  assertNotNull(keys);
  assertEquals(1,keys.size());
  assertEquals(authKey,Iterables.getOnlyElement(keys.values()));
  assertTrue(secretManager.removeKey(authKey.getKeyId()));
  assertEquals(0,secretManager.getKeys().size());
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRestrictExpirationDate() throws Exception {
  long then=System.currentTimeMillis();
  long tokenLifetime=60 * 60 * 1000;
  AuthenticationTokenSecretManager secretManager=new AuthenticationTokenSecretManager(instance,tokenLifetime);
  secretManager.addKey(new AuthenticationKey(1,then,then + tokenLifetime,keyGen.generateKey()));
  cfg.setTokenLifetime(1,TimeUnit.MINUTES);
  String principal="user@EXAMPLE.COM";
  Entry<Token<AuthenticationTokenIdentifier>,AuthenticationTokenIdentifier> pair=secretManager.generateToken(principal,cfg);
  assertNotNull(pair);
  long now=System.currentTimeMillis();
  long actualExpiration=pair.getValue().getExpirationDate();
  long approximateLifetime=actualExpiration - now;
  log.info("actualExpiration={}, approximateLifetime={}",actualExpiration,approximateLifetime);
  assertTrue("Expected lifetime to be on thet order of the token lifetime, but was " + approximateLifetime,approximateLifetime <= cfg.getTokenLifetime(TimeUnit.MILLISECONDS));
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGenerateToken() throws Exception {
  long then=System.currentTimeMillis();
  long tokenLifetime=60 * 1000;
  AuthenticationTokenSecretManager secretManager=new AuthenticationTokenSecretManager(instance,tokenLifetime);
  secretManager.addKey(new AuthenticationKey(1,then,then + tokenLifetime,keyGen.generateKey()));
  String principal="user@EXAMPLE.COM";
  Entry<Token<AuthenticationTokenIdentifier>,AuthenticationTokenIdentifier> pair=secretManager.generateToken(principal,cfg);
  assertNotNull(pair);
  Token<AuthenticationTokenIdentifier> token=pair.getKey();
  assertNotNull(token);
  assertEquals(AuthenticationTokenIdentifier.TOKEN_KIND,token.getKind());
  AuthenticationTokenIdentifier id=new AuthenticationTokenIdentifier();
  id.readFields(new DataInputStream(new ByteArrayInputStream(token.getIdentifier())));
  long now=System.currentTimeMillis();
  assertTrue("Issue date did not fall within the expected upper bound. Expected less than " + now + ", but was "+ id.getIssueDate(),id.getIssueDate() <= now);
  assertTrue("Issue date did not fall within the expected lower bound. Expected greater than " + then + ", but was "+ id.getIssueDate(),id.getIssueDate() >= then);
  assertEquals(id.getIssueDate() + tokenLifetime,id.getExpirationDate());
  assertEquals(instanceId,id.getInstanceId());
  assertEquals(pair.getValue(),id);
}

</code></pre>

<br>
<pre class="type-9 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddKey(){
  long tokenLifetime=60 * 1000;
  AuthenticationTokenSecretManager secretManager=new AuthenticationTokenSecretManager(instance,tokenLifetime);
  AuthenticationKey authKey=new AuthenticationKey(1,0,tokenLifetime,keyGen.generateKey());
  secretManager.addKey(authKey);
  Map<Integer,AuthenticationKey> keys=secretManager.getKeys();
  assertNotNull(keys);
  assertEquals(1,keys.size());
  assertEquals(authKey,Iterables.getOnlyElement(keys.values()));
  secretManager.addKey(authKey);
  keys=secretManager.getKeys();
  assertNotNull(keys);
  assertEquals(1,keys.size());
  assertEquals(authKey,Iterables.getOnlyElement(keys.values()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.server.security.delegation.ZooAuthenticationKeyWatcherTest </h4><pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBaseNodeChildrenChanged() throws Exception {
  WatchedEvent event=new WatchedEvent(EventType.NodeChildrenChanged,null,baseNode);
  AuthenticationKey key1=new AuthenticationKey(1,0l,10000l,keyGen.generateKey()), key2=new AuthenticationKey(2,key1.getExpirationDate(),20000l,keyGen.generateKey());
  byte[] serializedKey1=serialize(key1), serializedKey2=serialize(key2);
  List<String> children=Arrays.asList("1","2");
  expect(zk.getChildren(baseNode,keyWatcher)).andReturn(children);
  expect(zk.getData(baseNode + "/1",keyWatcher,null)).andReturn(serializedKey1);
  expect(zk.getData(baseNode + "/2",keyWatcher,null)).andReturn(serializedKey2);
  replay(instance,zk);
  keyWatcher.process(event);
  verify(instance,zk);
  assertEquals(2,secretManager.getKeys().size());
  assertEquals(key1,secretManager.getKeys().get(key1.getKeyId()));
  assertEquals(key2,secretManager.getKeys().get(key2.getKeyId()));
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testChildChildrenChanged() throws Exception {
  WatchedEvent event=new WatchedEvent(EventType.NodeChildrenChanged,null,baseNode + "/2");
  AuthenticationKey key1=new AuthenticationKey(1,0l,10000l,keyGen.generateKey()), key2=new AuthenticationKey(2,key1.getExpirationDate(),20000l,keyGen.generateKey());
  secretManager.addKey(key1);
  secretManager.addKey(key2);
  assertEquals(2,secretManager.getKeys().size());
  replay(instance,zk);
  keyWatcher.process(event);
  verify(instance,zk);
  assertEquals(2,secretManager.getKeys().size());
  assertEquals(key1,secretManager.getKeys().get(key1.getKeyId()));
  assertEquals(key2,secretManager.getKeys().get(key2.getKeyId()));
  assertEquals(key2,secretManager.getCurrentKey());
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBaseNodeCreatedWithChildren() throws Exception {
  WatchedEvent event=new WatchedEvent(EventType.NodeCreated,null,baseNode);
  AuthenticationKey key1=new AuthenticationKey(1,0l,10000l,keyGen.generateKey()), key2=new AuthenticationKey(2,key1.getExpirationDate(),20000l,keyGen.generateKey());
  byte[] serializedKey1=serialize(key1), serializedKey2=serialize(key2);
  List<String> children=Arrays.asList("1","2");
  expect(zk.getChildren(baseNode,keyWatcher)).andReturn(children);
  expect(zk.getData(baseNode + "/1",keyWatcher,null)).andReturn(serializedKey1);
  expect(zk.getData(baseNode + "/2",keyWatcher,null)).andReturn(serializedKey2);
  replay(instance,zk);
  keyWatcher.process(event);
  verify(instance,zk);
  assertEquals(2,secretManager.getKeys().size());
  assertEquals(key1,secretManager.getKeys().get(key1.getKeyId()));
  assertEquals(key2,secretManager.getKeys().get(key2.getKeyId()));
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testChildDeleted() throws Exception {
  WatchedEvent event=new WatchedEvent(EventType.NodeDeleted,null,baseNode + "/1");
  AuthenticationKey key1=new AuthenticationKey(1,0l,10000l,keyGen.generateKey()), key2=new AuthenticationKey(2,key1.getExpirationDate(),20000l,keyGen.generateKey());
  secretManager.addKey(key1);
  secretManager.addKey(key2);
  assertEquals(2,secretManager.getKeys().size());
  replay(instance,zk);
  keyWatcher.process(event);
  verify(instance,zk);
  assertEquals(1,secretManager.getKeys().size());
  assertEquals(key2,secretManager.getKeys().get(key2.getKeyId()));
  assertEquals(key2,secretManager.getCurrentKey());
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testInitialUpdateWithKeys() throws Exception {
  List<String> children=Arrays.asList("1","5");
  AuthenticationKey key1=new AuthenticationKey(1,0l,10000l,keyGen.generateKey()), key2=new AuthenticationKey(5,key1.getExpirationDate(),20000l,keyGen.generateKey());
  expect(zk.exists(baseNode,keyWatcher)).andReturn(true);
  expect(zk.getChildren(baseNode,keyWatcher)).andReturn(children);
  expect(zk.getData(baseNode + "/" + key1.getKeyId(),keyWatcher,null)).andReturn(serialize(key1));
  expect(zk.getData(baseNode + "/" + key2.getKeyId(),keyWatcher,null)).andReturn(serialize(key2));
  replay(zk,instance);
  keyWatcher.updateAuthKeys();
  verify(zk,instance);
  assertEquals(2,secretManager.getKeys().size());
  assertEquals(key1,secretManager.getKeys().get(key1.getKeyId()));
  assertEquals(key2,secretManager.getKeys().get(key2.getKeyId()));
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testChildChanged() throws Exception {
  WatchedEvent event=new WatchedEvent(EventType.NodeCreated,null,baseNode + "/2");
  AuthenticationKey key1=new AuthenticationKey(1,0l,10000l,keyGen.generateKey()), key2=new AuthenticationKey(2,key1.getExpirationDate(),20000l,keyGen.generateKey());
  secretManager.addKey(key1);
  assertEquals(1,secretManager.getKeys().size());
  byte[] serializedKey2=serialize(key2);
  expect(zk.getData(event.getPath(),keyWatcher,null)).andReturn(serializedKey2);
  replay(instance,zk);
  keyWatcher.process(event);
  verify(instance,zk);
  assertEquals(2,secretManager.getKeys().size());
  assertEquals(key1,secretManager.getKeys().get(key1.getKeyId()));
  assertEquals(key2,secretManager.getKeys().get(key2.getKeyId()));
  assertEquals(key2,secretManager.getCurrentKey());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.server.util.FileSystemMonitorTest </h4><pre class="type-9 type-5 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFilteredMountEntries() throws Exception {
  String[] mountEntries=new String[]{"rootfs / rootfs rw 0 0","proc /proc proc rw,nosuid,nodev,noexec,relatime 0 0","sysfs /sys sysfs rw,seclabel,nosuid,nodev,noexec,relatime 0 0","devtmpfs /dev devtmpfs rw,seclabel,nosuid,size=8119336k,nr_inodes=2029834,mode=755 0 0","securityfs /sys/kernel/security securityfs rw,nosuid,nodev,noexec,relatime 0 0","tmpfs /dev/shm tmpfs rw,seclabel,nosuid,nodev 0 0","devpts /dev/pts devpts rw,seclabel,nosuid,noexec,relatime,gid=5,mode=620,ptmxmode=000 0 0","tmpfs /run tmpfs rw,seclabel,nosuid,nodev,mode=755 0 0","tmpfs /sys/fs/cgroup tmpfs ro,seclabel,nosuid,nodev,noexec,mode=755 0 0","cgroup /sys/fs/cgroup/systemd cgroup rw,nosuid,nodev,noexec,relatime,xattr,release_agent=/usr/lib/systemd/systemd-cgroups-agent,name=systemd 0 0","pstore /sys/fs/pstore pstore rw,nosuid,nodev,noexec,relatime 0 0","cgroup /sys/fs/cgroup/cpuset cgroup rw,nosuid,nodev,noexec,relatime,cpuset 0 0","cgroup /sys/fs/cgroup/cpu,cpuacct cgroup rw,nosuid,nodev,noexec,relatime,cpuacct,cpu 0 0","cgroup /sys/fs/cgroup/memory cgroup rw,nosuid,nodev,noexec,relatime,memory 0 0","cgroup /sys/fs/cgroup/devices cgroup rw,nosuid,nodev,noexec,relatime,devices 0 0","cgroup /sys/fs/cgroup/freezer cgroup rw,nosuid,nodev,noexec,relatime,freezer 0 0","cgroup /sys/fs/cgroup/net_cls cgroup rw,nosuid,nodev,noexec,relatime,net_cls 0 0","cgroup /sys/fs/cgroup/blkio cgroup rw,nosuid,nodev,noexec,relatime,blkio 0 0","cgroup /sys/fs/cgroup/perf_event cgroup rw,nosuid,nodev,noexec,relatime,perf_event 0 0","cgroup /sys/fs/cgroup/hugetlb cgroup rw,nosuid,nodev,noexec,relatime,hugetlb 0 0","configfs /sys/kernel/config configfs rw,relatime 0 0","/dev/vda1 / xfs rw,seclabel,relatime,attr2,inode64,noquota 0 0","/dev/vda2 /ignoreme reiserfs rw 0 0","rpc_pipefs /var/lib/nfs/rpc_pipefs rpc_pipefs rw,relatime 0 0","selinuxfs /sys/fs/selinux selinuxfs rw,relatime 0 0","systemd-1 /proc/sys/fs/binfmt_misc autofs rw,relatime,fd=32,pgrp=1,timeout=300,minproto=5,maxproto=5,direct 0 0","debugfs /sys/kernel/debug debugfs rw,relatime 0 0","mqueue /dev/mqueue mqueue rw,seclabel,relatime 0 0","hugetlbfs /dev/hugepages hugetlbfs rw,seclabel,relatime 0 0","sunrpc /proc/fs/nfsd nfsd rw,relatime 0 0","/dev/vdb /grid/0 ext4 rw,seclabel,relatime,data=ordered 0 0"};
  StringBuilder sb=new StringBuilder(256);
  for (  String mountEntry : mountEntries) {
    if (sb.length() > 0) {
      sb.append("\n");
    }
    sb.append(mountEntry);
  }
  ByteArrayInputStream is=new ByteArrayInputStream(sb.toString().getBytes(UTF_8));
  BufferedReader reader=new BufferedReader(new InputStreamReader(is));
  List<Mount> mounts=FileSystemMonitor.getMountsFromFile(reader);
  log.info("Filtered mount points: " + mounts);
  assertEquals(2,mounts.size());
  Set<String> expectedCheckedMountPoints=new HashSet<String>();
  expectedCheckedMountPoints.add("/");
  expectedCheckedMountPoints.add("/grid/0");
  for (  Mount mount : mounts) {
    assertTrue("Did not expect to find " + mount,expectedCheckedMountPoints.remove(mount.mountPoint));
  }
  assertEquals("Should not have any extra mount points: " + expectedCheckedMountPoints,0,expectedCheckedMountPoints.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.server.util.FileUtilTest </h4><pre class="type-9 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testToPathStrings(){
  Collection<FileRef> c=new java.util.ArrayList<FileRef>();
  FileRef r1=createMock(FileRef.class);
  expect(r1.path()).andReturn(new Path("/foo"));
  replay(r1);
  c.add(r1);
  FileRef r2=createMock(FileRef.class);
  expect(r2.path()).andReturn(new Path("/bar"));
  replay(r2);
  c.add(r2);
  Collection<String> cs=FileUtil.toPathStrings(c);
  Assert.assertEquals(2,cs.size());
  Iterator<String> iter=cs.iterator();
  Assert.assertEquals("/foo",iter.next());
  Assert.assertEquals("/bar",iter.next());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.server.util.ReplicationTableUtilTest </h4><pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void properPathInRow() throws Exception {
  Writer writer=EasyMock.createNiceMock(Writer.class);
  writer.update(EasyMock.anyObject(Mutation.class));
  final List<Mutation> mutations=new ArrayList<Mutation>();
  EasyMock.expectLastCall().andAnswer(new IAnswer(){
    @Override public Object answer(){
      mutations.add(((Mutation)EasyMock.getCurrentArguments()[0]));
      return null;
    }
  }
);
  EasyMock.replay(writer);
  Credentials creds=new Credentials("root",new PasswordToken(""));
  ClientContext context=EasyMock.createMock(ClientContext.class);
  EasyMock.expect(context.getCredentials()).andReturn(creds).anyTimes();
  EasyMock.replay(context);
  ReplicationTableUtil.addWriter(creds,writer);
  UUID uuid=UUID.randomUUID();
  String myFile="file:////home/user/accumulo/wal/server+port/" + uuid;
  long createdTime=System.currentTimeMillis();
  ReplicationTableUtil.updateFiles(context,new KeyExtent(new Text("1"),null,null),myFile,StatusUtil.fileCreated(createdTime));
  verify(writer);
  Assert.assertEquals(1,mutations.size());
  Mutation m=mutations.get(0);
  Assert.assertEquals(MetadataSchema.ReplicationSection.getRowPrefix() + "file:/home/user/accumulo/wal/server+port/" + uuid,new Text(m.getRow()).toString());
  List<ColumnUpdate> updates=m.getUpdates();
  Assert.assertEquals(1,updates.size());
  ColumnUpdate update=updates.get(0);
  Assert.assertEquals(MetadataSchema.ReplicationSection.COLF,new Text(update.getColumnFamily()));
  Assert.assertEquals("1",new Text(update.getColumnQualifier()).toString());
  Assert.assertEquals(StatusUtil.fileCreatedValue(createdTime),new Value(update.getValue()));
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void replEntryMutation(){
  Status stat=Status.newBuilder().setBegin(0).setEnd(0).setInfiniteEnd(true).setCreatedTime(System.currentTimeMillis()).build();
  String file="file:///accumulo/wal/127.0.0.1+9997" + UUID.randomUUID();
  Path filePath=new Path(file);
  Text row=new Text(filePath.toString());
  KeyExtent extent=new KeyExtent(new Text("1"),new Text("b"),new Text("a"));
  Mutation m=ReplicationTableUtil.createUpdateMutation(filePath,ProtobufUtil.toValue(stat),extent);
  Assert.assertEquals(new Text(MetadataSchema.ReplicationSection.getRowPrefix() + row),new Text(m.getRow()));
  Assert.assertEquals(1,m.getUpdates().size());
  ColumnUpdate col=m.getUpdates().get(0);
  Assert.assertEquals(MetadataSchema.ReplicationSection.COLF,new Text(col.getColumnFamily()));
  Assert.assertEquals(extent.getTableId(),new Text(col.getColumnQualifier()));
  Assert.assertEquals(0,col.getColumnVisibility().length);
  Assert.assertArrayEquals(stat.toByteArray(),col.getValue());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.shell.PasswordConverterTest </h4><pre class="type-9 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFile() throws FileNotFoundException {
  argv[1]="file:pom.xml";
  Scanner scan=new Scanner(new File("pom.xml"));
  String expected=scan.nextLine();
  scan.close();
  new JCommander(password,argv);
  assertEquals(expected,password.password);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.shell.ShellUtilTest </h4><pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testWithoutDecode() throws IOException {
  File testFile=new File(folder.getRoot(),"testFileNoDecode.txt");
  FileUtils.writeStringToFile(testFile,FILEDATA);
  List<Text> output=ShellUtil.scanFile(testFile.getAbsolutePath(),false);
  assertEquals(ImmutableList.of(new Text("line1"),new Text("line2")),output);
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testWithDecode() throws IOException {
  File testFile=new File(folder.getRoot(),"testFileWithDecode.txt");
  FileUtils.writeStringToFile(testFile,FILEDATA);
  List<Text> output=ShellUtil.scanFile(testFile.getAbsolutePath(),true);
  assertEquals(ImmutableList.of(new Text(Base64.decodeBase64("line1".getBytes(UTF_8))),new Text(Base64.decodeBase64("line2".getBytes(UTF_8)))),output);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.shell.format.DeleterFormatterTest </h4><pre class="type-9 type-5 type-3 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testYes() throws IOException {
  input.set("y\nyes\n");
  data.put(new Key("z"),new Value("v2".getBytes(UTF_8)));
  formatter=new DeleterFormatter(writer,data.entrySet(),new FormatterConfig().setPrintTimestamps(true),shellState,false);
  assertTrue(formatter.hasNext());
  assertNull(formatter.next());
  verify("[DELETED]"," r ","cf","cq","value");
  assertTrue(formatter.hasNext());
  assertNull(formatter.next());
  verify("[DELETED]"," z ","v2");
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNo() throws IOException {
  input.set("no\n");
  data.put(new Key("z"),new Value("v2".getBytes(UTF_8)));
  formatter=new DeleterFormatter(writer,data.entrySet(),new FormatterConfig().setPrintTimestamps(true),shellState,false);
  assertTrue(formatter.hasNext());
  assertNull(formatter.next());
  verify("[SKIPPED]"," r ","cf","cq","value");
  assertTrue(formatter.hasNext());
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNoConfirmation() throws IOException {
  input.set("");
  data.put(new Key("z"),new Value("v2".getBytes(UTF_8)));
  formatter=new DeleterFormatter(writer,data.entrySet(),new FormatterConfig().setPrintTimestamps(true),shellState,false);
  assertTrue(formatter.hasNext());
  assertNull(formatter.next());
  verify("[SKIPPED]"," r ","cf","cq","value");
  assertFalse(formatter.hasNext());
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMutationException(){
  formatter=new DeleterFormatter(exceptionWriter,data.entrySet(),new FormatterConfig().setPrintTimestamps(true),shellState,true);
  assertTrue(formatter.hasNext());
  assertNull(formatter.next());
  assertFalse(formatter.hasNext());
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSingle() throws IOException {
  formatter=new DeleterFormatter(writer,data.entrySet(),new FormatterConfig().setPrintTimestamps(true),shellState,true);
  assertTrue(formatter.hasNext());
  assertNull(formatter.next());
  verify("[DELETED]"," r ","cf","cq","value");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.start.classloader.vfs.AccumuloReloadingVFSClassLoaderTest </h4><pre class="type-9 type-5 type-3 type-2 type-18 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Is not executed with the test suite
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @Ignore public void testFastDeleteAndReAdd() throws Exception {
  FileObject testDir=vfs.resolveFile(folder1.getRoot().toURI().toString());
  FileObject[] dirContents=testDir.getChildren();
  AccumuloReloadingVFSClassLoader arvcl=new AccumuloReloadingVFSClassLoader(folderPath,vfs,new ReloadingClassLoader(){
    @Override public ClassLoader getClassLoader(){
      return ClassLoader.getSystemClassLoader();
    }
  }
,1000,true);
  FileObject[] files=((VFSClassLoader)arvcl.getClassLoader()).getFileObjects();
  Assert.assertArrayEquals(createFileSystems(dirContents),files);
  Class<?> clazz1=arvcl.getClassLoader().loadClass("test.HelloWorld");
  Object o1=clazz1.newInstance();
  Assert.assertEquals("Hello World!",o1.toString());
  Class<?> clazz1_5=arvcl.getClassLoader().loadClass("test.HelloWorld");
  Assert.assertEquals(clazz1,clazz1_5);
  assertTrue(new File(folder1.getRoot(),"HelloWorld.jar").delete());
  FileUtils.copyURLToFile(this.getClass().getResource("/HelloWorld.jar"),folder1.newFile("HelloWorld.jar"));
  Thread.sleep(7000);
  Class<?> clazz2=arvcl.getClassLoader().loadClass("test.HelloWorld");
  Object o2=clazz2.newInstance();
  Assert.assertEquals("Hello World!",o2.toString());
  Assert.assertFalse(clazz1.equals(clazz2));
  Assert.assertFalse(o1.equals(o2));
  arvcl.close();
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testModifiedClass() throws Exception {
  FileObject testDir=vfs.resolveFile(folder1.getRoot().toURI().toString());
  FileObject[] dirContents=testDir.getChildren();
  AccumuloReloadingVFSClassLoader arvcl=new AccumuloReloadingVFSClassLoader(folderPath,vfs,new ReloadingClassLoader(){
    @Override public ClassLoader getClassLoader(){
      return ClassLoader.getSystemClassLoader();
    }
  }
,1000,true);
  FileObject[] files=((VFSClassLoader)arvcl.getClassLoader()).getFileObjects();
  Assert.assertArrayEquals(createFileSystems(dirContents),files);
  ClassLoader loader1=arvcl.getClassLoader();
  Class<?> clazz1=loader1.loadClass("test.HelloWorld");
  Object o1=clazz1.newInstance();
  Assert.assertEquals("Hello World!",o1.toString());
  Class<?> clazz1_5=arvcl.getClassLoader().loadClass("test.HelloWorld");
  Assert.assertEquals(clazz1,clazz1_5);
  Thread.sleep(1000);
  assertTrue(new File(folder1.getRoot(),"HelloWorld.jar").delete());
  FileUtils.copyURLToFile(this.getClass().getResource("/HelloWorld2.jar"),folder1.newFile("HelloWorld.jar"));
  Thread.sleep(7000);
  Class<?> clazz2=arvcl.getClassLoader().loadClass("test.HelloWorld");
  Object o2=clazz2.newInstance();
  Assert.assertEquals("Hallo Welt",o2.toString());
  Assert.assertFalse(clazz1.equals(clazz2));
  Assert.assertFalse(o1.equals(o2));
  Class<?> clazz3=loader1.loadClass("test.HelloWorld");
  Object o3=clazz3.newInstance();
  Assert.assertEquals("Hello World!",o3.toString());
  arvcl.close();
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReloading() throws Exception {
  FileObject testDir=vfs.resolveFile(folder1.getRoot().toURI().toString());
  FileObject[] dirContents=testDir.getChildren();
  AccumuloReloadingVFSClassLoader arvcl=new AccumuloReloadingVFSClassLoader(folderPath,vfs,new ReloadingClassLoader(){
    @Override public ClassLoader getClassLoader(){
      return ClassLoader.getSystemClassLoader();
    }
  }
,1000,true);
  FileObject[] files=((VFSClassLoader)arvcl.getClassLoader()).getFileObjects();
  Assert.assertArrayEquals(createFileSystems(dirContents),files);
  Class<?> clazz1=arvcl.getClassLoader().loadClass("test.HelloWorld");
  Object o1=clazz1.newInstance();
  Assert.assertEquals("Hello World!",o1.toString());
  Class<?> clazz1_5=arvcl.getClassLoader().loadClass("test.HelloWorld");
  Assert.assertEquals(clazz1,clazz1_5);
  assertTrue(new File(folder1.getRoot(),"HelloWorld.jar").delete());
  Thread.sleep(7000);
  FileUtils.copyURLToFile(this.getClass().getResource("/HelloWorld.jar"),folder1.newFile("HelloWorld2.jar"));
  Thread.sleep(7000);
  Class<?> clazz2=arvcl.getClassLoader().loadClass("test.HelloWorld");
  Object o2=clazz2.newInstance();
  Assert.assertEquals("Hello World!",o2.toString());
  Assert.assertFalse(clazz1.equals(clazz2));
  Assert.assertFalse(o1.equals(o2));
  arvcl.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.start.classloader.vfs.AccumuloVFSClassLoaderTest </h4><pre class="type-9 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testCacheDirectoryConfigured() throws Exception {
  Whitebox.setInternalState(AccumuloVFSClassLoader.class,"loader",(AccumuloReloadingVFSClassLoader)null);
  String cacheDir="/some/random/cache/dir";
  File conf=folder1.newFile("accumulo-site.xml");
  FileWriter out=new FileWriter(conf);
  out.append("<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n");
  out.append("<configuration>\n");
  out.append("<property>\n");
  out.append("<name>general.classpaths</name>\n");
  out.append("<value></value>\n");
  out.append("</property>\n");
  out.append("<property>\n");
  out.append("<name>" + AccumuloVFSClassLoader.VFS_CACHE_DIR + "</name>\n");
  out.append("<value>" + cacheDir + "</value>\n");
  out.append("</property>\n");
  out.append("</configuration>\n");
  out.close();
  Whitebox.setInternalState(AccumuloClassLoader.class,"SITE_CONF",conf.toURI().toURL().toString());
  Whitebox.setInternalState(AccumuloVFSClassLoader.class,"lock",new Object());
  AccumuloVFSClassLoader.getClassLoader();
  FileSystemManager manager=AccumuloVFSClassLoader.generateVfs();
  UniqueFileReplicator replicator=Whitebox.getInternalState(manager,"fileReplicator");
  File tempDir=Whitebox.getInternalState(replicator,"tempDir");
  String tempDirParent=tempDir.getParent();
  String tempDirName=tempDir.getName();
  Assert.assertTrue(cacheDir.equals(tempDirParent));
  Assert.assertTrue(tempDirName.startsWith("accumulo-vfs-cache-"));
  Assert.assertTrue(tempDirName.endsWith(System.getProperty("user.name","nouser")));
  Whitebox.setInternalState(AccumuloVFSClassLoader.class,"loader",(AccumuloReloadingVFSClassLoader)null);
}

</code></pre>

<br>
<pre class="type-9 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testDefaultCacheDirectory() throws Exception {
  Whitebox.setInternalState(AccumuloVFSClassLoader.class,"loader",(AccumuloReloadingVFSClassLoader)null);
  File conf=folder1.newFile("accumulo-site.xml");
  FileWriter out=new FileWriter(conf);
  out.append("<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n");
  out.append("<configuration>\n");
  out.append("<property>\n");
  out.append("<name>general.classpaths</name>\n");
  out.append("<value></value>\n");
  out.append("</property>\n");
  out.append("<property>\n");
  out.append("<name>general.vfs.classpaths</name>\n");
  out.append("<value></value>\n");
  out.append("</property>\n");
  out.append("</configuration>\n");
  out.close();
  Whitebox.setInternalState(AccumuloClassLoader.class,"SITE_CONF",conf.toURI().toURL().toString());
  Whitebox.setInternalState(AccumuloVFSClassLoader.class,"lock",new Object());
  AccumuloVFSClassLoader.getClassLoader();
  FileSystemManager manager=AccumuloVFSClassLoader.generateVfs();
  UniqueFileReplicator replicator=Whitebox.getInternalState(manager,"fileReplicator");
  File tempDir=Whitebox.getInternalState(replicator,"tempDir");
  String tempDirParent=tempDir.getParent();
  String tempDirName=tempDir.getName();
  String javaIoTmpDir=System.getProperty("java.io.tmpdir");
  if (javaIoTmpDir.endsWith(File.separator)) {
    javaIoTmpDir=javaIoTmpDir.substring(0,javaIoTmpDir.length() - File.separator.length());
  }
  Assert.assertTrue(javaIoTmpDir.equals(tempDirParent));
  Assert.assertTrue(tempDirName.startsWith("accumulo-vfs-cache-"));
  Assert.assertTrue(tempDirName.endsWith(System.getProperty("user.name","nouser")));
  Whitebox.setInternalState(AccumuloVFSClassLoader.class,"loader",(AccumuloReloadingVFSClassLoader)null);
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDefaultContextConfigured() throws Exception {
  Whitebox.setInternalState(AccumuloVFSClassLoader.class,"loader",(AccumuloReloadingVFSClassLoader)null);
  FileUtils.copyURLToFile(this.getClass().getResource("/HelloWorld.jar"),folder1.newFile("HelloWorld.jar"));
  File conf=folder1.newFile("accumulo-site.xml");
  FileWriter out=new FileWriter(conf);
  out.append("<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n");
  out.append("<configuration>\n");
  out.append("<property>\n");
  out.append("<name>general.classpaths</name>\n");
  out.append("<value></value>\n");
  out.append("</property>\n");
  out.append("<property>\n");
  out.append("<name>general.vfs.classpaths</name>\n");
  out.append("<value>" + new File(folder1.getRoot(),"HelloWorld.jar").toURI() + "</value>\n");
  out.append("</property>\n");
  out.append("</configuration>\n");
  out.close();
  Whitebox.setInternalState(AccumuloClassLoader.class,"SITE_CONF",conf.toURI().toURL().toString());
  Whitebox.setInternalState(AccumuloVFSClassLoader.class,"lock",new Object());
  ClassLoader acl=AccumuloVFSClassLoader.getClassLoader();
  Assert.assertTrue((acl instanceof VFSClassLoader));
  Assert.assertTrue((acl.getParent() instanceof VFSClassLoader));
  VFSClassLoader arvcl=(VFSClassLoader)acl.getParent();
  Assert.assertEquals(1,arvcl.getFileObjects().length);
  Assert.assertTrue(arvcl.getFileObjects()[0].getURL().toString().contains("HelloWorld.jar"));
  Class<?> clazz1=arvcl.loadClass("test.HelloWorld");
  Object o1=clazz1.newInstance();
  Assert.assertEquals("Hello World!",o1.toString());
  Whitebox.setInternalState(AccumuloVFSClassLoader.class,"loader",(AccumuloReloadingVFSClassLoader)null);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.start.classloader.vfs.ContextManagerTest </h4><pre class="type-9 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void differentContexts() throws Exception {
  ContextManager cm=new ContextManager(vfs,new ReloadingClassLoader(){
    @Override public ClassLoader getClassLoader(){
      return ClassLoader.getSystemClassLoader();
    }
  }
);
  cm.setContextConfig(new ContextsConfig(){
    @Override public ContextConfig getContextConfig(    String context){
      if (context.equals("CX1")) {
        return new ContextConfig(uri1,true);
      }
 else       if (context.equals("CX2")) {
        return new ContextConfig(uri2,true);
      }
      return null;
    }
  }
);
  FileObject testDir=vfs.resolveFile(folder1.getRoot().toURI().toString());
  FileObject[] dirContents=testDir.getChildren();
  ClassLoader cl1=cm.getClassLoader("CX1");
  FileObject[] files=((VFSClassLoader)cl1).getFileObjects();
  Assert.assertArrayEquals(createFileSystems(dirContents),files);
  FileObject testDir2=vfs.resolveFile(folder2.getRoot().toURI().toString());
  FileObject[] dirContents2=testDir2.getChildren();
  ClassLoader cl2=cm.getClassLoader("CX2");
  FileObject[] files2=((VFSClassLoader)cl2).getFileObjects();
  Assert.assertArrayEquals(createFileSystems(dirContents2),files2);
  Class<?> defaultContextClass=cl1.loadClass("test.HelloWorld");
  Object o1=defaultContextClass.newInstance();
  Assert.assertEquals("Hello World!",o1.toString());
  Class<?> myContextClass=cl2.loadClass("test.HelloWorld");
  Object o2=myContextClass.newInstance();
  Assert.assertEquals("Hello World!",o2.toString());
  Assert.assertFalse(defaultContextClass.equals(myContextClass));
  cm.removeUnusedContexts(new HashSet<String>());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.start.classloader.vfs.providers.ReadOnlyHdfsFileProviderTest </h4><pre class="type-9 type-5 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEquals() throws Exception {
  FileObject fo=manager.resolveFile(TEST_DIR1);
  Assert.assertNotNull(fo);
  Assert.assertFalse(fo.exists());
  FileObject file=createTestFile(hdfs);
  FileObject file2=manager.resolveFile(TEST_FILE1);
  Assert.assertEquals(file,file2);
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIsReadable() throws Exception {
  FileObject fo=manager.resolveFile(TEST_DIR1);
  Assert.assertNotNull(fo);
  Assert.assertFalse(fo.exists());
  FileObject file=createTestFile(hdfs);
  Assert.assertTrue(file.isReadable());
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetAttributes() throws Exception {
  FileObject fo=manager.resolveFile(TEST_DIR1);
  Assert.assertNotNull(fo);
  Assert.assertFalse(fo.exists());
  FileObject file=createTestFile(hdfs);
  Map<String,Object> attributes=file.getContent().getAttributes();
  Assert.assertTrue(attributes.containsKey(HdfsFileAttributes.BLOCK_SIZE.toString()));
  Assert.assertTrue(attributes.containsKey(HdfsFileAttributes.GROUP.toString()));
  Assert.assertTrue(attributes.containsKey(HdfsFileAttributes.LAST_ACCESS_TIME.toString()));
  Assert.assertTrue(attributes.containsKey(HdfsFileAttributes.LENGTH.toString()));
  Assert.assertTrue(attributes.containsKey(HdfsFileAttributes.MODIFICATION_TIME.toString()));
  Assert.assertTrue(attributes.containsKey(HdfsFileAttributes.OWNER.toString()));
  Assert.assertTrue(attributes.containsKey(HdfsFileAttributes.PERMISSIONS.toString()));
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetContentSize() throws Exception {
  FileObject fo=manager.resolveFile(TEST_DIR1);
  Assert.assertNotNull(fo);
  Assert.assertFalse(fo.exists());
  FileObject file=createTestFile(hdfs);
  Assert.assertEquals(0,file.getContent().getSize());
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIsWritable() throws Exception {
  FileObject fo=manager.resolveFile(TEST_DIR1);
  Assert.assertNotNull(fo);
  Assert.assertFalse(fo.exists());
  FileObject file=createTestFile(hdfs);
  Assert.assertFalse(file.isWriteable());
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIsHidden() throws Exception {
  FileObject fo=manager.resolveFile(TEST_DIR1);
  Assert.assertNotNull(fo);
  Assert.assertFalse(fo.exists());
  FileObject file=createTestFile(hdfs);
  Assert.assertFalse(file.isHidden());
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLastModificationTime() throws Exception {
  FileObject fo=manager.resolveFile(TEST_DIR1);
  Assert.assertNotNull(fo);
  Assert.assertFalse(fo.exists());
  FileObject file=createTestFile(hdfs);
  Assert.assertFalse(-1 == file.getContent().getLastModifiedTime());
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDoListChildren() throws Exception {
  FileObject fo=manager.resolveFile(TEST_DIR1);
  Assert.assertNotNull(fo);
  Assert.assertFalse(fo.exists());
  FileObject file=createTestFile(hdfs);
  FileObject dir=file.getParent();
  FileObject[] children=dir.getChildren();
  Assert.assertTrue(children.length == 1);
  Assert.assertTrue(children[0].getName().equals(file.getName()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.start.classloader.vfs.providers.VfsClassLoaderTest </h4><pre class="type-9 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetClass() throws Exception {
  Class<?> helloWorldClass=this.cl.loadClass("test.HelloWorld");
  Object o=helloWorldClass.newInstance();
  Assert.assertEquals("Hello World!",o.toString());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.BadDeleteMarkersCreatedIT </h4><pre class="type-9 type-8 type-3 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test() throws Exception {
  String tableName=getUniqueNames(1)[0];
  Connector c=getConnector();
  log.info("Creating table to be deleted");
  c.tableOperations().create(tableName);
  final String tableId=c.tableOperations().tableIdMap().get(tableName);
  Assert.assertNotNull("Expected to find a tableId",tableId);
  SortedSet<Text> splits=new TreeSet<Text>();
  for (int i=0; i < 10; i++) {
    splits.add(new Text("" + i));
  }
  c.tableOperations().addSplits(tableName,splits);
  c.tableOperations().deleteRows(tableName,null,null);
  c.tableOperations().delete(tableName);
  log.info("Sleeping to let garbage collector run");
  sleepUninterruptibly(timeoutFactor * 15,TimeUnit.SECONDS);
  log.info("Verifying that delete markers were deleted");
  Scanner scanner=c.createScanner(MetadataTable.NAME,Authorizations.EMPTY);
  scanner.setRange(MetadataSchema.DeletesSection.getRange());
  for (  Entry<Key,Value> entry : scanner) {
    String row=entry.getKey().getRow().toString();
    if (!row.contains("/" + tableId + "/")) {
      log.info("Ignoring delete entry for a table other than the one we deleted");
      continue;
    }
    Assert.fail("Delete entry should have been deleted by the garbage collector: " + entry.getKey().getRow().toString());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.BalanceFasterIT </h4><pre class="type-9 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test(timeout=90 * 1000) public void test() throws Exception {
  String tableName=getUniqueNames(1)[0];
  Connector conn=getConnector();
  conn.tableOperations().create(tableName);
  SortedSet<Text> splits=new TreeSet<Text>();
  for (int i=0; i < 1000; i++) {
    splits.add(new Text("" + i));
  }
  conn.tableOperations().addSplits(tableName,splits);
  sleepUninterruptibly(10,TimeUnit.SECONDS);
  Scanner s=conn.createScanner(MetadataTable.NAME,Authorizations.EMPTY);
  s.fetchColumnFamily(MetadataSchema.TabletsSection.CurrentLocationColumnFamily.NAME);
  s.setRange(MetadataSchema.TabletsSection.getRange());
  Map<String,Integer> counts=new HashMap<String,Integer>();
  while (true) {
    int total=0;
    counts.clear();
    for (    Entry<Key,Value> kv : s) {
      String host=kv.getValue().toString();
      if (!counts.containsKey(host))       counts.put(host,0);
      counts.put(host,counts.get(host) + 1);
      total++;
    }
    if (total > 1000)     break;
  }
  assertTrue(counts.size() == 3);
  Iterator<Integer> i=counts.values().iterator();
  int a=i.next();
  int b=i.next();
  int c=i.next();
  assertTrue(Math.abs(a - b) < 3);
  assertTrue(Math.abs(a - c) < 3);
  assertTrue(a > 330);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.CloneIT </h4><pre class="type-9 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSplit3() throws Exception {
  Connector conn=getConnector();
  String tableName=getUniqueNames(1)[0];
  conn.tableOperations().create(tableName);
  BatchWriter bw1=conn.createBatchWriter(tableName,new BatchWriterConfig());
  bw1.addMutation(createTablet("0","m",null,"/d1","/d1/file1"));
  bw1.addMutation(createTablet("0",null,"m","/d2","/d2/file2"));
  bw1.flush();
  BatchWriter bw2=conn.createBatchWriter(tableName,new BatchWriterConfig());
  MetadataTableUtil.initializeClone(tableName,"0","1",conn,bw2);
  bw1.addMutation(createTablet("0","f",null,"/d1","/d1/file3"));
  bw1.addMutation(createTablet("0","m","f","/d3","/d1/file1"));
  bw1.addMutation(createTablet("0","s","m","/d2","/d2/file2"));
  bw1.addMutation(createTablet("0",null,"s","/d4","/d2/file2"));
  bw1.flush();
  int rc=MetadataTableUtil.checkClone(tableName,"0","1",conn,bw2);
  assertEquals(0,rc);
  Scanner scanner=conn.createScanner(tableName,Authorizations.EMPTY);
  scanner.setRange(new KeyExtent(new Text("1"),null,null).toMetadataRange());
  HashSet<String> files=new HashSet<String>();
  int count=0;
  for (  Entry<Key,Value> entry : scanner) {
    if (entry.getKey().getColumnFamily().equals(DataFileColumnFamily.NAME)) {
      files.add(entry.getKey().getColumnQualifier().toString());
      count++;
    }
  }
  assertEquals(2,count);
  assertEquals(2,files.size());
  assertTrue(files.contains("../0/d1/file1"));
  assertTrue(files.contains("../0/d2/file2"));
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFilesChange() throws Exception {
  Connector conn=getConnector();
  String tableName=getUniqueNames(1)[0];
  conn.tableOperations().create(tableName);
  KeyExtent ke=new KeyExtent(new Text("0"),null,null);
  Mutation mut=ke.getPrevRowUpdateMutation();
  TabletsSection.ServerColumnFamily.TIME_COLUMN.put(mut,new Value("M0".getBytes()));
  TabletsSection.ServerColumnFamily.DIRECTORY_COLUMN.put(mut,new Value("/default_tablet".getBytes()));
  mut.put(DataFileColumnFamily.NAME.toString(),"/default_tablet/0_0.rf",new DataFileValue(1,200).encodeAsString());
  BatchWriter bw1=conn.createBatchWriter(tableName,new BatchWriterConfig());
  bw1.addMutation(mut);
  bw1.flush();
  BatchWriter bw2=conn.createBatchWriter(tableName,new BatchWriterConfig());
  MetadataTableUtil.initializeClone(tableName,"0","1",conn,bw2);
  Mutation mut2=new Mutation(ke.getMetadataEntry());
  mut2.putDelete(DataFileColumnFamily.NAME.toString(),"/default_tablet/0_0.rf");
  mut2.put(DataFileColumnFamily.NAME.toString(),"/default_tablet/1_0.rf",new DataFileValue(2,300).encodeAsString());
  bw1.addMutation(mut2);
  bw1.flush();
  int rc=MetadataTableUtil.checkClone(tableName,"0","1",conn,bw2);
  assertEquals(1,rc);
  rc=MetadataTableUtil.checkClone(tableName,"0","1",conn,bw2);
  assertEquals(0,rc);
  Scanner scanner=conn.createScanner(tableName,Authorizations.EMPTY);
  scanner.setRange(new KeyExtent(new Text("1"),null,null).toMetadataRange());
  HashSet<String> files=new HashSet<String>();
  for (  Entry<Key,Value> entry : scanner) {
    if (entry.getKey().getColumnFamily().equals(DataFileColumnFamily.NAME))     files.add(entry.getKey().getColumnQualifier().toString());
  }
  assertEquals(1,files.size());
  assertTrue(files.contains("../0/default_tablet/1_0.rf"));
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testClonedMarker() throws Exception {
  Connector conn=getConnector();
  String tableName=getUniqueNames(1)[0];
  conn.tableOperations().create(tableName);
  BatchWriter bw1=conn.createBatchWriter(tableName,new BatchWriterConfig());
  bw1.addMutation(createTablet("0","m",null,"/d1","/d1/file1"));
  bw1.addMutation(createTablet("0",null,"m","/d2","/d2/file2"));
  bw1.flush();
  BatchWriter bw2=conn.createBatchWriter(tableName,new BatchWriterConfig());
  MetadataTableUtil.initializeClone(tableName,"0","1",conn,bw2);
  bw1.addMutation(deleteTablet("0","m",null,"/d1","/d1/file1"));
  bw1.addMutation(deleteTablet("0",null,"m","/d2","/d2/file2"));
  bw1.flush();
  bw1.addMutation(createTablet("0","f",null,"/d1","/d1/file3"));
  bw1.addMutation(createTablet("0","m","f","/d3","/d1/file1"));
  bw1.addMutation(createTablet("0","s","m","/d2","/d2/file3"));
  bw1.addMutation(createTablet("0",null,"s","/d4","/d4/file3"));
  bw1.flush();
  int rc=MetadataTableUtil.checkClone(tableName,"0","1",conn,bw2);
  assertEquals(1,rc);
  bw1.addMutation(deleteTablet("0","m","f","/d3","/d1/file1"));
  bw1.flush();
  bw1.addMutation(createTablet("0","m","f","/d3","/d1/file3"));
  bw1.flush();
  rc=MetadataTableUtil.checkClone(tableName,"0","1",conn,bw2);
  assertEquals(0,rc);
  Scanner scanner=conn.createScanner(tableName,Authorizations.EMPTY);
  scanner.setRange(new KeyExtent(new Text("1"),null,null).toMetadataRange());
  HashSet<String> files=new HashSet<String>();
  int count=0;
  for (  Entry<Key,Value> entry : scanner) {
    if (entry.getKey().getColumnFamily().equals(DataFileColumnFamily.NAME)) {
      files.add(entry.getKey().getColumnQualifier().toString());
      count++;
    }
  }
  assertEquals(3,count);
  assertEquals(3,files.size());
  assertTrue(files.contains("../0/d1/file1"));
  assertTrue(files.contains("../0/d2/file3"));
  assertTrue(files.contains("../0/d4/file3"));
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSplit2() throws Exception {
  Connector conn=getConnector();
  String tableName=getUniqueNames(1)[0];
  conn.tableOperations().create(tableName);
  BatchWriter bw1=conn.createBatchWriter(tableName,new BatchWriterConfig());
  bw1.addMutation(createTablet("0",null,null,"/default_tablet","/default_tablet/0_0.rf"));
  bw1.flush();
  BatchWriter bw2=conn.createBatchWriter(tableName,new BatchWriterConfig());
  MetadataTableUtil.initializeClone(tableName,"0","1",conn,bw2);
  bw1.addMutation(createTablet("0","m",null,"/default_tablet","/default_tablet/1_0.rf"));
  Mutation mut3=createTablet("0",null,"m","/t-1","/default_tablet/1_0.rf");
  mut3.putDelete(DataFileColumnFamily.NAME.toString(),"/default_tablet/0_0.rf");
  bw1.addMutation(mut3);
  bw1.flush();
  int rc=MetadataTableUtil.checkClone(tableName,"0","1",conn,bw2);
  assertEquals(1,rc);
  rc=MetadataTableUtil.checkClone(tableName,"0","1",conn,bw2);
  assertEquals(0,rc);
  Scanner scanner=conn.createScanner(tableName,Authorizations.EMPTY);
  scanner.setRange(new KeyExtent(new Text("1"),null,null).toMetadataRange());
  HashSet<String> files=new HashSet<String>();
  int count=0;
  for (  Entry<Key,Value> entry : scanner) {
    if (entry.getKey().getColumnFamily().equals(DataFileColumnFamily.NAME)) {
      files.add(entry.getKey().getColumnQualifier().toString());
      count++;
    }
  }
  assertEquals(1,files.size());
  assertEquals(2,count);
  assertTrue(files.contains("../0/default_tablet/1_0.rf"));
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNoFiles() throws Exception {
  Connector conn=getConnector();
  String tableName=getUniqueNames(1)[0];
  conn.tableOperations().create(tableName);
  KeyExtent ke=new KeyExtent(new Text("0"),null,null);
  Mutation mut=ke.getPrevRowUpdateMutation();
  TabletsSection.ServerColumnFamily.TIME_COLUMN.put(mut,new Value("M0".getBytes()));
  TabletsSection.ServerColumnFamily.DIRECTORY_COLUMN.put(mut,new Value("/default_tablet".getBytes()));
  BatchWriter bw1=conn.createBatchWriter(tableName,new BatchWriterConfig());
  bw1.addMutation(mut);
  bw1.close();
  BatchWriter bw2=conn.createBatchWriter(tableName,new BatchWriterConfig());
  MetadataTableUtil.initializeClone(tableName,"0","1",conn,bw2);
  int rc=MetadataTableUtil.checkClone(tableName,"0","1",conn,bw2);
  assertEquals(0,rc);
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSplit1() throws Exception {
  Connector conn=getConnector();
  String tableName=getUniqueNames(1)[0];
  conn.tableOperations().create(tableName);
  BatchWriter bw1=conn.createBatchWriter(tableName,new BatchWriterConfig());
  bw1.addMutation(createTablet("0",null,null,"/default_tablet","/default_tablet/0_0.rf"));
  bw1.flush();
  BatchWriter bw2=conn.createBatchWriter(tableName,new BatchWriterConfig());
  MetadataTableUtil.initializeClone(tableName,"0","1",conn,bw2);
  bw1.addMutation(createTablet("0","m",null,"/default_tablet","/default_tablet/0_0.rf"));
  bw1.addMutation(createTablet("0",null,"m","/t-1","/default_tablet/0_0.rf"));
  bw1.flush();
  int rc=MetadataTableUtil.checkClone(tableName,"0","1",conn,bw2);
  assertEquals(0,rc);
  Scanner scanner=conn.createScanner(tableName,Authorizations.EMPTY);
  scanner.setRange(new KeyExtent(new Text("1"),null,null).toMetadataRange());
  HashSet<String> files=new HashSet<String>();
  int count=0;
  for (  Entry<Key,Value> entry : scanner) {
    if (entry.getKey().getColumnFamily().equals(DataFileColumnFamily.NAME)) {
      files.add(entry.getKey().getColumnQualifier().toString());
      count++;
    }
  }
  assertEquals(1,count);
  assertEquals(1,files.size());
  assertTrue(files.contains("../0/default_tablet/0_0.rf"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.ConditionalWriterIT </h4><pre class="type-9 type-13 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testThreads() throws Exception {
  String table=getUniqueNames(1)[0];
  Connector conn=getConnector();
  conn.tableOperations().create(table);
  Random rand=new Random();
switch (rand.nextInt(3)) {
case 1:
    conn.tableOperations().addSplits(table,nss("4"));
  break;
case 2:
conn.tableOperations().addSplits(table,nss("3","5"));
break;
}
ConditionalWriter cw=conn.createConditionalWriter(table,new ConditionalWriterConfig());
ArrayList<ByteSequence> rows=new ArrayList<ByteSequence>();
for (int i=0; i < 1000; i++) {
rows.add(new ArrayByteSequence(FastFormat.toZeroPaddedString(abs(rand.nextLong()),16,16,new byte[0])));
}
ArrayList<ConditionalMutation> mutations=new ArrayList<ConditionalMutation>();
for (ByteSequence row : rows) mutations.add(new Stats(row).toMutation());
ArrayList<ByteSequence> rows2=new ArrayList<ByteSequence>();
Iterator<Result> results=cw.write(mutations.iterator());
while (results.hasNext()) {
Result result=results.next();
Assert.assertEquals(Status.ACCEPTED,result.getStatus());
rows2.add(new ArrayByteSequence(result.getMutation().getRow()));
}
Collections.sort(rows);
Collections.sort(rows2);
Assert.assertEquals(rows,rows2);
AtomicBoolean failed=new AtomicBoolean(false);
ExecutorService tp=Executors.newFixedThreadPool(5);
for (int i=0; i < 5; i++) {
tp.submit(new MutatorTask(table,conn,rows,cw,failed));
}
tp.shutdown();
while (!tp.isTerminated()) {
tp.awaitTermination(1,TimeUnit.MINUTES);
}
Assert.assertFalse("A MutatorTask failed with an exception",failed.get());
Scanner scanner=conn.createScanner(table,Authorizations.EMPTY);
RowIterator rowIter=new RowIterator(scanner);
while (rowIter.hasNext()) {
Iterator<Entry<Key,Value>> row=rowIter.next();
new Stats(row);
}
}

</code></pre>

<br>
<pre class="type-9 type-8 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSecurity() throws Exception {
  Connector conn=getConnector();
  String user=null;
  ClientConfiguration clientConf=cluster.getClientConfig();
  final boolean saslEnabled=clientConf.getBoolean(ClientProperty.INSTANCE_RPC_SASL_ENABLED.getKey(),false);
  ClusterUser user1=getUser(0);
  user=user1.getPrincipal();
  if (saslEnabled) {
    conn.securityOperations().createLocalUser(user,null);
  }
 else {
    conn.securityOperations().createLocalUser(user,new PasswordToken(user1.getPassword()));
  }
  String[] tables=getUniqueNames(3);
  String table1=tables[0], table2=tables[1], table3=tables[2];
  conn.tableOperations().create(table1);
  conn.tableOperations().create(table2);
  conn.tableOperations().create(table3);
  conn.securityOperations().grantTablePermission(user,table1,TablePermission.READ);
  conn.securityOperations().grantTablePermission(user,table2,TablePermission.WRITE);
  conn.securityOperations().grantTablePermission(user,table3,TablePermission.READ);
  conn.securityOperations().grantTablePermission(user,table3,TablePermission.WRITE);
  Connector conn2=conn.getInstance().getConnector(user,user1.getToken());
  ConditionalMutation cm1=new ConditionalMutation("r1",new Condition("tx","seq"));
  cm1.put("tx","seq","1");
  cm1.put("data","x","a");
  ConditionalWriter cw1=conn2.createConditionalWriter(table1,new ConditionalWriterConfig());
  ConditionalWriter cw2=conn2.createConditionalWriter(table2,new ConditionalWriterConfig());
  ConditionalWriter cw3=conn2.createConditionalWriter(table3,new ConditionalWriterConfig());
  Assert.assertEquals(Status.ACCEPTED,cw3.write(cm1).getStatus());
  try {
    Status status=cw1.write(cm1).getStatus();
    Assert.fail("Expected exception writing conditional mutation to table the user doesn't have write access to, Got status: " + status);
  }
 catch (  AccumuloSecurityException ase) {
  }
  try {
    Status status=cw2.write(cm1).getStatus();
    Assert.fail("Expected exception writing conditional mutation to table the user doesn't have read access to. Got status: " + status);
  }
 catch (  AccumuloSecurityException ase) {
  }
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFields() throws Exception {
  Connector conn=getConnector();
  String tableName=getUniqueNames(1)[0];
  String user=null;
  ClientConfiguration clientConf=cluster.getClientConfig();
  final boolean saslEnabled=clientConf.getBoolean(ClientProperty.INSTANCE_RPC_SASL_ENABLED.getKey(),false);
  ClusterUser user1=getUser(0);
  user=user1.getPrincipal();
  if (saslEnabled) {
    conn.securityOperations().createLocalUser(user,null);
  }
 else {
    conn.securityOperations().createLocalUser(user,new PasswordToken(user1.getPassword()));
  }
  Authorizations auths=new Authorizations("A","B");
  conn.securityOperations().changeUserAuthorizations(user,auths);
  conn.securityOperations().grantSystemPermission(user,SystemPermission.CREATE_TABLE);
  conn=conn.getInstance().getConnector(user,user1.getToken());
  conn.tableOperations().create(tableName);
  ConditionalWriter cw=conn.createConditionalWriter(tableName,new ConditionalWriterConfig().setAuthorizations(auths));
  ColumnVisibility cva=new ColumnVisibility("A");
  ColumnVisibility cvb=new ColumnVisibility("B");
  ConditionalMutation cm0=new ConditionalMutation("99006",new Condition("tx","seq").setVisibility(cva));
  cm0.put("name","last",cva,"doe");
  cm0.put("name","first",cva,"john");
  cm0.put("tx","seq",cva,"1");
  Assert.assertEquals(Status.ACCEPTED,cw.write(cm0).getStatus());
  Scanner scanner=conn.createScanner(tableName,auths);
  scanner.setRange(new Range("99006"));
  scanner.fetchColumn(new Text("tx"),new Text("seq"));
  Entry<Key,Value> entry=Iterables.getOnlyElement(scanner);
  Assert.assertEquals("1",entry.getValue().toString());
  long ts=entry.getKey().getTimestamp();
  ConditionalMutation cm1=new ConditionalMutation("99006",new Condition("txA","seq").setVisibility(cva).setValue("1"));
  cm1.put("name","last",cva,"Doe");
  cm1.put("name","first",cva,"John");
  cm1.put("tx","seq",cva,"2");
  Assert.assertEquals(Status.REJECTED,cw.write(cm1).getStatus());
  ConditionalMutation cm2=new ConditionalMutation("99006",new Condition("tx","seqA").setVisibility(cva).setValue("1"));
  cm2.put("name","last",cva,"Doe");
  cm2.put("name","first",cva,"John");
  cm2.put("tx","seq",cva,"2");
  Assert.assertEquals(Status.REJECTED,cw.write(cm2).getStatus());
  ConditionalMutation cm3=new ConditionalMutation("99006",new Condition("tx","seq").setVisibility(cvb).setValue("1"));
  cm3.put("name","last",cva,"Doe");
  cm3.put("name","first",cva,"John");
  cm3.put("tx","seq",cva,"2");
  Assert.assertEquals(Status.REJECTED,cw.write(cm3).getStatus());
  ConditionalMutation cm4=new ConditionalMutation("99006",new Condition("tx","seq").setVisibility(cva).setTimestamp(ts + 1).setValue("1"));
  cm4.put("name","last",cva,"Doe");
  cm4.put("name","first",cva,"John");
  cm4.put("tx","seq",cva,"2");
  Assert.assertEquals(Status.REJECTED,cw.write(cm4).getStatus());
  ConditionalMutation cm5=new ConditionalMutation("99006",new Condition("tx","seq").setVisibility(cva).setTimestamp(ts - 1).setValue("1"));
  cm5.put("name","last",cva,"Doe");
  cm5.put("name","first",cva,"John");
  cm5.put("tx","seq",cva,"2");
  Assert.assertEquals(Status.REJECTED,cw.write(cm5).getStatus());
  entry=Iterables.getOnlyElement(scanner);
  Assert.assertEquals("1",entry.getValue().toString());
  ConditionalMutation cm6=new ConditionalMutation("99006",new Condition("tx","seq").setVisibility(cva).setTimestamp(ts).setValue("1"));
  cm6.put("name","last",cva,"Doe");
  cm6.put("name","first",cva,"John");
  cm6.put("tx","seq",cva,"2");
  Assert.assertEquals(Status.ACCEPTED,cw.write(cm6).getStatus());
  entry=Iterables.getOnlyElement(scanner);
  Assert.assertEquals("2",entry.getValue().toString());
}

</code></pre>

<br>
<pre class="type-9 type-13 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBigBatch() throws Exception {
  Connector conn=getConnector();
  String tableName=getUniqueNames(1)[0];
  conn.tableOperations().create(tableName);
  conn.tableOperations().addSplits(tableName,nss("2","4","6"));
  sleepUninterruptibly(2,TimeUnit.SECONDS);
  int num=100;
  ArrayList<byte[]> rows=new ArrayList<byte[]>(num);
  ArrayList<ConditionalMutation> cml=new ArrayList<ConditionalMutation>(num);
  Random r=new Random();
  byte[] e=new byte[0];
  for (int i=0; i < num; i++) {
    rows.add(FastFormat.toZeroPaddedString(abs(r.nextLong()),16,16,e));
  }
  for (int i=0; i < num; i++) {
    ConditionalMutation cm=new ConditionalMutation(rows.get(i),new Condition("meta","seq"));
    cm.put("meta","seq","1");
    cm.put("meta","tx",UUID.randomUUID().toString());
    cml.add(cm);
  }
  ConditionalWriter cw=conn.createConditionalWriter(tableName,new ConditionalWriterConfig());
  Iterator<Result> results=cw.write(cml.iterator());
  int count=0;
  while (results.hasNext()) {
    Result result=results.next();
    Assert.assertEquals(Status.ACCEPTED,result.getStatus());
    count++;
  }
  Assert.assertEquals("Did not receive the expected number of results",num,count);
  ArrayList<ConditionalMutation> cml2=new ArrayList<ConditionalMutation>(num);
  for (int i=0; i < num; i++) {
    ConditionalMutation cm=new ConditionalMutation(rows.get(i),new Condition("meta","seq").setValue("1"));
    cm.put("meta","seq","2");
    cm.put("meta","tx",UUID.randomUUID().toString());
    cml2.add(cm);
  }
  count=0;
  results=cw.write(cml2.iterator());
  while (results.hasNext()) {
    Result result=results.next();
    Assert.assertEquals(Status.ACCEPTED,result.getStatus());
    count++;
  }
  Assert.assertEquals("Did not receive the expected number of results",num,count);
  cw.close();
}

</code></pre>

<br>
<pre class="type-9 type-13 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTableAndConditionIterators() throws Exception {
  Connector conn=getConnector();
  String tableName=getUniqueNames(1)[0];
  IteratorSetting aiConfig1=new IteratorSetting(30,"AI1",AddingIterator.class);
  aiConfig1.addOption("amount","2");
  IteratorSetting aiConfig2=new IteratorSetting(35,"MI1",MultiplyingIterator.class);
  aiConfig2.addOption("amount","3");
  IteratorSetting aiConfig3=new IteratorSetting(40,"AI2",AddingIterator.class);
  aiConfig3.addOption("amount","5");
  conn.tableOperations().create(tableName);
  BatchWriter bw=conn.createBatchWriter(tableName,new BatchWriterConfig());
  Mutation m=new Mutation("ACCUMULO-1000");
  m.put("count","comments","6");
  bw.addMutation(m);
  m=new Mutation("ACCUMULO-1001");
  m.put("count","comments","7");
  bw.addMutation(m);
  m=new Mutation("ACCUMULO-1002");
  m.put("count","comments","8");
  bw.addMutation(m);
  bw.close();
  conn.tableOperations().attachIterator(tableName,aiConfig1,EnumSet.of(IteratorScope.scan));
  conn.tableOperations().offline(tableName,true);
  conn.tableOperations().online(tableName,true);
  ConditionalWriter cw=conn.createConditionalWriter(tableName,new ConditionalWriterConfig());
  ConditionalMutation cm6=new ConditionalMutation("ACCUMULO-1000",new Condition("count","comments").setValue("8"));
  cm6.put("count","comments","7");
  Assert.assertEquals(Status.ACCEPTED,cw.write(cm6).getStatus());
  Scanner scanner=conn.createScanner(tableName,new Authorizations());
  scanner.setRange(new Range("ACCUMULO-1000"));
  scanner.fetchColumn(new Text("count"),new Text("comments"));
  Entry<Key,Value> entry=Iterables.getOnlyElement(scanner);
  Assert.assertEquals("9",entry.getValue().toString());
  ConditionalMutation cm7=new ConditionalMutation("ACCUMULO-1000",new Condition("count","comments").setIterators(aiConfig2).setValue("27"));
  cm7.put("count","comments","8");
  Assert.assertEquals(Status.ACCEPTED,cw.write(cm7).getStatus());
  entry=Iterables.getOnlyElement(scanner);
  Assert.assertEquals("10",entry.getValue().toString());
  ConditionalMutation cm8=new ConditionalMutation("ACCUMULO-1000",new Condition("count","comments").setIterators(aiConfig2,aiConfig3).setValue("35"));
  cm8.put("count","comments","9");
  Assert.assertEquals(Status.ACCEPTED,cw.write(cm8).getStatus());
  entry=Iterables.getOnlyElement(scanner);
  Assert.assertEquals("11",entry.getValue().toString());
  ConditionalMutation cm3=new ConditionalMutation("ACCUMULO-1000",new Condition("count","comments").setIterators(aiConfig2).setValue("33"));
  cm3.put("count","comments","3");
  ConditionalMutation cm4=new ConditionalMutation("ACCUMULO-1001",new Condition("count","comments").setIterators(aiConfig3).setValue("14"));
  cm4.put("count","comments","3");
  ConditionalMutation cm5=new ConditionalMutation("ACCUMULO-1002",new Condition("count","comments").setIterators(aiConfig3).setValue("10"));
  cm5.put("count","comments","3");
  Iterator<Result> results=cw.write(Arrays.asList(cm3,cm4,cm5).iterator());
  Map<String,Status> actual=new HashMap<String,Status>();
  while (results.hasNext()) {
    Result result=results.next();
    String k=new String(result.getMutation().getRow());
    Assert.assertFalse("Did not expect to see multiple resultus for the row: " + k,actual.containsKey(k));
    actual.put(k,result.getStatus());
  }
  cw.close();
  Map<String,Status> expected=new HashMap<String,Status>();
  expected.put("ACCUMULO-1000",Status.ACCEPTED);
  expected.put("ACCUMULO-1001",Status.ACCEPTED);
  expected.put("ACCUMULO-1002",Status.REJECTED);
  Assert.assertEquals(expected,actual);
  cw.close();
}

</code></pre>

<br>
<pre class="type-9 type-13 type-11 type-5 type-3 type-21 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTrace() throws Exception {
  Assume.assumeTrue(getClusterType() == ClusterType.MINI);
  Process tracer=null;
  Connector conn=getConnector();
  AccumuloCluster cluster=getCluster();
  MiniAccumuloClusterImpl mac=(MiniAccumuloClusterImpl)cluster;
  if (!conn.tableOperations().exists("trace")) {
    tracer=mac.exec(TraceServer.class);
    while (!conn.tableOperations().exists("trace")) {
      sleepUninterruptibly(1,TimeUnit.SECONDS);
    }
  }
  String tableName=getUniqueNames(1)[0];
  conn.tableOperations().create(tableName);
  DistributedTrace.enable("localhost","testTrace",mac.getClientConfig());
  sleepUninterruptibly(1,TimeUnit.SECONDS);
  Span root=Trace.on("traceTest");
  ConditionalWriter cw=conn.createConditionalWriter(tableName,new ConditionalWriterConfig());
  ConditionalMutation cm0=new ConditionalMutation("99006",new Condition("tx","seq"));
  cm0.put("name","last","doe");
  cm0.put("name","first","john");
  cm0.put("tx","seq","1");
  Assert.assertEquals(Status.ACCEPTED,cw.write(cm0).getStatus());
  root.stop();
  final Scanner scanner=conn.createScanner("trace",Authorizations.EMPTY);
  scanner.setRange(new Range(new Text(Long.toHexString(root.traceId()))));
  loop:   while (true) {
    final StringBuilder finalBuffer=new StringBuilder();
    int traceCount=TraceDump.printTrace(scanner,new Printer(){
      @Override public void print(      final String line){
        try {
          finalBuffer.append(line).append("\n");
        }
 catch (        Exception ex) {
          throw new RuntimeException(ex);
        }
      }
    }
);
    String traceOutput=finalBuffer.toString();
    log.info("Trace output:" + traceOutput);
    if (traceCount > 0) {
      int lastPos=0;
      for (      String part : "traceTest, startScan,startConditionalUpdate,conditionalUpdate,Check conditions,apply conditional mutations".split(",")) {
        log.info("Looking in trace output for '" + part + "'");
        int pos=traceOutput.indexOf(part);
        if (-1 == pos) {
          log.info("Trace output doesn't contain '" + part + "'");
          Thread.sleep(1000);
          break loop;
        }
        assertTrue("Did not find '" + part + "' in output",pos > 0);
        assertTrue("'" + part + "' occurred earlier than the previous element unexpectedly",pos > lastPos);
        lastPos=pos;
      }
      break;
    }
 else {
      log.info("Ignoring trace output as traceCount not greater than zero: " + traceCount);
      Thread.sleep(1000);
    }
  }
  if (tracer != null) {
    tracer.destroy();
  }
}

</code></pre>

<br>
<pre class="type-9 type-13 type-11 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBatchErrors() throws Exception {
  Connector conn=getConnector();
  String tableName=getUniqueNames(1)[0];
  conn.tableOperations().create(tableName);
  conn.tableOperations().addConstraint(tableName,AlphaNumKeyConstraint.class.getName());
  conn.tableOperations().clone(tableName,tableName + "_clone",true,new HashMap<String,String>(),new HashSet<String>());
  conn.securityOperations().changeUserAuthorizations(getAdminPrincipal(),new Authorizations("A","B"));
  ColumnVisibility cvaob=new ColumnVisibility("A|B");
  ColumnVisibility cvaab=new ColumnVisibility("A&B");
switch ((new Random()).nextInt(3)) {
case 1:
    conn.tableOperations().addSplits(tableName,nss("6"));
  break;
case 2:
conn.tableOperations().addSplits(tableName,nss("2","95"));
break;
}
ArrayList<ConditionalMutation> mutations=new ArrayList<ConditionalMutation>();
ConditionalMutation cm0=new ConditionalMutation("99006",new Condition("tx","seq").setVisibility(cvaob));
cm0.put("name+","last",cvaob,"doe");
cm0.put("name","first",cvaob,"john");
cm0.put("tx","seq",cvaob,"1");
mutations.add(cm0);
ConditionalMutation cm1=new ConditionalMutation("59056",new Condition("tx","seq").setVisibility(cvaab));
cm1.put("name","last",cvaab,"doe");
cm1.put("name","first",cvaab,"jane");
cm1.put("tx","seq",cvaab,"1");
mutations.add(cm1);
ConditionalMutation cm2=new ConditionalMutation("19059",new Condition("tx","seq").setVisibility(cvaob));
cm2.put("name","last",cvaob,"doe");
cm2.put("name","first",cvaob,"jack");
cm2.put("tx","seq",cvaob,"1");
mutations.add(cm2);
ConditionalMutation cm3=new ConditionalMutation("90909",new Condition("tx","seq").setVisibility(cvaob).setValue("1"));
cm3.put("name","last",cvaob,"doe");
cm3.put("name","first",cvaob,"john");
cm3.put("tx","seq",cvaob,"2");
mutations.add(cm3);
ConditionalWriter cw=conn.createConditionalWriter(tableName,new ConditionalWriterConfig().setAuthorizations(new Authorizations("A")));
Iterator<Result> results=cw.write(mutations.iterator());
HashSet<String> rows=new HashSet<String>();
while (results.hasNext()) {
Result result=results.next();
String row=new String(result.getMutation().getRow());
if (row.equals("19059")) {
Assert.assertEquals(Status.ACCEPTED,result.getStatus());
}
 else if (row.equals("59056")) {
Assert.assertEquals(Status.INVISIBLE_VISIBILITY,result.getStatus());
}
 else if (row.equals("99006")) {
Assert.assertEquals(Status.VIOLATED,result.getStatus());
}
 else if (row.equals("90909")) {
Assert.assertEquals(Status.REJECTED,result.getStatus());
}
rows.add(row);
}
Assert.assertEquals(4,rows.size());
Scanner scanner=conn.createScanner(tableName,new Authorizations("A"));
scanner.fetchColumn(new Text("tx"),new Text("seq"));
Entry<Key,Value> entry=Iterables.getOnlyElement(scanner);
Assert.assertEquals("1",entry.getValue().toString());
cw.close();
}

</code></pre>

<br>
<pre class="type-9 type-13 type-11 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBatch() throws Exception {
  Connector conn=getConnector();
  String tableName=getUniqueNames(1)[0];
  conn.tableOperations().create(tableName);
  conn.securityOperations().changeUserAuthorizations(getAdminPrincipal(),new Authorizations("A","B"));
  ColumnVisibility cvab=new ColumnVisibility("A|B");
  ArrayList<ConditionalMutation> mutations=new ArrayList<ConditionalMutation>();
  ConditionalMutation cm0=new ConditionalMutation("99006",new Condition("tx","seq").setVisibility(cvab));
  cm0.put("name","last",cvab,"doe");
  cm0.put("name","first",cvab,"john");
  cm0.put("tx","seq",cvab,"1");
  mutations.add(cm0);
  ConditionalMutation cm1=new ConditionalMutation("59056",new Condition("tx","seq").setVisibility(cvab));
  cm1.put("name","last",cvab,"doe");
  cm1.put("name","first",cvab,"jane");
  cm1.put("tx","seq",cvab,"1");
  mutations.add(cm1);
  ConditionalMutation cm2=new ConditionalMutation("19059",new Condition("tx","seq").setVisibility(cvab));
  cm2.put("name","last",cvab,"doe");
  cm2.put("name","first",cvab,"jack");
  cm2.put("tx","seq",cvab,"1");
  mutations.add(cm2);
  ConditionalWriter cw=conn.createConditionalWriter(tableName,new ConditionalWriterConfig().setAuthorizations(new Authorizations("A")));
  Iterator<Result> results=cw.write(mutations.iterator());
  int count=0;
  while (results.hasNext()) {
    Result result=results.next();
    Assert.assertEquals(Status.ACCEPTED,result.getStatus());
    count++;
  }
  Assert.assertEquals(3,count);
  Scanner scanner=conn.createScanner(tableName,new Authorizations("A"));
  scanner.fetchColumn(new Text("tx"),new Text("seq"));
  for (  String row : new String[]{"99006","59056","19059"}) {
    scanner.setRange(new Range(row));
    Entry<Key,Value> entry=Iterables.getOnlyElement(scanner);
    Assert.assertEquals("1",entry.getValue().toString());
  }
  TreeSet<Text> splits=new TreeSet<Text>();
  splits.add(new Text("7"));
  splits.add(new Text("3"));
  conn.tableOperations().addSplits(tableName,splits);
  mutations.clear();
  ConditionalMutation cm3=new ConditionalMutation("99006",new Condition("tx","seq").setVisibility(cvab).setValue("1"));
  cm3.put("name","last",cvab,"Doe");
  cm3.put("tx","seq",cvab,"2");
  mutations.add(cm3);
  ConditionalMutation cm4=new ConditionalMutation("59056",new Condition("tx","seq").setVisibility(cvab));
  cm4.put("name","last",cvab,"Doe");
  cm4.put("tx","seq",cvab,"1");
  mutations.add(cm4);
  ConditionalMutation cm5=new ConditionalMutation("19059",new Condition("tx","seq").setVisibility(cvab).setValue("2"));
  cm5.put("name","last",cvab,"Doe");
  cm5.put("tx","seq",cvab,"3");
  mutations.add(cm5);
  results=cw.write(mutations.iterator());
  int accepted=0;
  int rejected=0;
  while (results.hasNext()) {
    Result result=results.next();
    if (new String(result.getMutation().getRow()).equals("99006")) {
      Assert.assertEquals(Status.ACCEPTED,result.getStatus());
      accepted++;
    }
 else {
      Assert.assertEquals(Status.REJECTED,result.getStatus());
      rejected++;
    }
  }
  Assert.assertEquals("Expected only one accepted conditional mutation",1,accepted);
  Assert.assertEquals("Expected two rejected conditional mutations",2,rejected);
  for (  String row : new String[]{"59056","19059"}) {
    scanner.setRange(new Range(row));
    Entry<Key,Value> entry=Iterables.getOnlyElement(scanner);
    Assert.assertEquals("1",entry.getValue().toString());
  }
  scanner.setRange(new Range("99006"));
  Entry<Key,Value> entry=Iterables.getOnlyElement(scanner);
  Assert.assertEquals("2",entry.getValue().toString());
  scanner.clearColumns();
  scanner.fetchColumn(new Text("name"),new Text("last"));
  entry=Iterables.getOnlyElement(scanner);
  Assert.assertEquals("Doe",entry.getValue().toString());
  cw.close();
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBasic() throws Exception {
  Connector conn=getConnector();
  String tableName=getUniqueNames(1)[0];
  conn.tableOperations().create(tableName);
  ConditionalWriter cw=conn.createConditionalWriter(tableName,new ConditionalWriterConfig());
  ConditionalMutation cm0=new ConditionalMutation("99006",new Condition("tx","seq"));
  cm0.put("name","last","doe");
  cm0.put("name","first","john");
  cm0.put("tx","seq","1");
  Assert.assertEquals(Status.ACCEPTED,cw.write(cm0).getStatus());
  Assert.assertEquals(Status.REJECTED,cw.write(cm0).getStatus());
  ConditionalMutation cm1=new ConditionalMutation("99006",new Condition("tx","seq").setValue("1"));
  cm1.put("name","last","Doe");
  cm1.put("tx","seq","2");
  Assert.assertEquals(Status.ACCEPTED,cw.write(cm1).getStatus());
  ConditionalMutation cm2=new ConditionalMutation("99006",new Condition("tx","seq").setValue("1"));
  cm2.put("name","last","DOE");
  cm2.put("tx","seq","2");
  Assert.assertEquals(Status.REJECTED,cw.write(cm2).getStatus());
  ConditionalMutation cm3=new ConditionalMutation("99006",new Condition("txtypo","seq").setValue("1"));
  cm3.put("name","last","deo");
  cm3.put("tx","seq","2");
  Assert.assertEquals(Status.REJECTED,cw.write(cm3).getStatus());
  ConditionalMutation cm4=new ConditionalMutation("99006",new Condition("tx","seq").setValue("2"),new Condition("name","last").setValue("doe"));
  cm4.put("name","last","deo");
  cm4.put("tx","seq","3");
  Assert.assertEquals(Status.REJECTED,cw.write(cm4).getStatus());
  ConditionalMutation cm5=new ConditionalMutation("99006",new Condition("tx","seq").setValue("1"),new Condition("name","last").setValue("Doe"));
  cm5.put("name","last","deo");
  cm5.put("tx","seq","3");
  Assert.assertEquals(Status.REJECTED,cw.write(cm5).getStatus());
  Scanner scanner=conn.createScanner(tableName,Authorizations.EMPTY);
  scanner.fetchColumn(new Text("name"),new Text("last"));
  scanner.setRange(new Range("99006"));
  Entry<Key,Value> entry=Iterables.getOnlyElement(scanner);
  Assert.assertEquals("Doe",entry.getValue().toString());
  ConditionalMutation cm6=new ConditionalMutation("99006",new Condition("tx","seq").setValue("2"),new Condition("name","last").setValue("Doe"));
  cm6.put("name","last","DOE");
  cm6.put("tx","seq","3");
  Assert.assertEquals(Status.ACCEPTED,cw.write(cm6).getStatus());
  entry=Iterables.getOnlyElement(scanner);
  Assert.assertEquals("DOE",entry.getValue().toString());
  ConditionalMutation cm7=new ConditionalMutation("99006",new Condition("tx","seq").setValue("3"));
  cm7.putDelete("name","last");
  cm7.putDelete("name","first");
  cm7.putDelete("tx","seq");
  Assert.assertEquals(Status.ACCEPTED,cw.write(cm7).getStatus());
  Assert.assertFalse("Did not expect to find any results",scanner.iterator().hasNext());
  Assert.assertEquals(Status.ACCEPTED,cw.write(cm0).getStatus());
  Assert.assertEquals(Status.REJECTED,cw.write(cm0).getStatus());
  entry=Iterables.getOnlyElement(scanner);
  Assert.assertEquals("doe",entry.getValue().toString());
}

</code></pre>

<br>
<pre class="type-9 type-13 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIterators() throws Exception {
  Connector conn=getConnector();
  String tableName=getUniqueNames(1)[0];
  conn.tableOperations().create(tableName,new NewTableConfiguration().withoutDefaultIterators());
  BatchWriter bw=conn.createBatchWriter(tableName,new BatchWriterConfig());
  Mutation m=new Mutation("ACCUMULO-1000");
  m.put("count","comments","1");
  bw.addMutation(m);
  bw.addMutation(m);
  bw.addMutation(m);
  m=new Mutation("ACCUMULO-1001");
  m.put("count2","comments","1");
  bw.addMutation(m);
  bw.addMutation(m);
  m=new Mutation("ACCUMULO-1002");
  m.put("count2","comments","1");
  bw.addMutation(m);
  bw.addMutation(m);
  bw.close();
  IteratorSetting iterConfig=new IteratorSetting(10,SummingCombiner.class);
  SummingCombiner.setEncodingType(iterConfig,Type.STRING);
  SummingCombiner.setColumns(iterConfig,Collections.singletonList(new IteratorSetting.Column("count")));
  IteratorSetting iterConfig2=new IteratorSetting(10,SummingCombiner.class);
  SummingCombiner.setEncodingType(iterConfig2,Type.STRING);
  SummingCombiner.setColumns(iterConfig2,Collections.singletonList(new IteratorSetting.Column("count2","comments")));
  IteratorSetting iterConfig3=new IteratorSetting(5,VersioningIterator.class);
  VersioningIterator.setMaxVersions(iterConfig3,1);
  Scanner scanner=conn.createScanner(tableName,new Authorizations());
  scanner.addScanIterator(iterConfig);
  scanner.setRange(new Range("ACCUMULO-1000"));
  scanner.fetchColumn(new Text("count"),new Text("comments"));
  Entry<Key,Value> entry=Iterables.getOnlyElement(scanner);
  Assert.assertEquals("3",entry.getValue().toString());
  ConditionalWriter cw=conn.createConditionalWriter(tableName,new ConditionalWriterConfig());
  ConditionalMutation cm0=new ConditionalMutation("ACCUMULO-1000",new Condition("count","comments").setValue("3"));
  cm0.put("count","comments","1");
  Assert.assertEquals(Status.REJECTED,cw.write(cm0).getStatus());
  entry=Iterables.getOnlyElement(scanner);
  Assert.assertEquals("3",entry.getValue().toString());
  ConditionalMutation cm1=new ConditionalMutation("ACCUMULO-1000",new Condition("count","comments").setIterators(iterConfig).setValue("3"));
  cm1.put("count","comments","1");
  Assert.assertEquals(Status.ACCEPTED,cw.write(cm1).getStatus());
  entry=Iterables.getOnlyElement(scanner);
  Assert.assertEquals("4",entry.getValue().toString());
  ConditionalMutation cm2=new ConditionalMutation("ACCUMULO-1000",new Condition("count","comments").setValue("4"));
  cm2.put("count","comments","1");
  Assert.assertEquals(Status.REJECTED,cw.write(cm1).getStatus());
  entry=Iterables.getOnlyElement(scanner);
  Assert.assertEquals("4",entry.getValue().toString());
  ConditionalMutation cm3=new ConditionalMutation("ACCUMULO-1000",new Condition("count","comments").setIterators(iterConfig).setValue("4"));
  cm3.put("count","comments","1");
  ConditionalMutation cm4=new ConditionalMutation("ACCUMULO-1001",new Condition("count2","comments").setIterators(iterConfig2).setValue("2"));
  cm4.put("count2","comments","1");
  ConditionalMutation cm5=new ConditionalMutation("ACCUMULO-1002",new Condition("count2","comments").setIterators(iterConfig2,iterConfig3).setValue("2"));
  cm5.put("count2","comments","1");
  Iterator<Result> results=cw.write(Arrays.asList(cm3,cm4,cm5).iterator());
  Map<String,Status> actual=new HashMap<String,Status>();
  while (results.hasNext()) {
    Result result=results.next();
    String k=new String(result.getMutation().getRow());
    Assert.assertFalse("Did not expect to see multiple resultus for the row: " + k,actual.containsKey(k));
    actual.put(k,result.getStatus());
  }
  Map<String,Status> expected=new HashMap<String,Status>();
  expected.put("ACCUMULO-1000",Status.ACCEPTED);
  expected.put("ACCUMULO-1001",Status.ACCEPTED);
  expected.put("ACCUMULO-1002",Status.REJECTED);
  Assert.assertEquals(expected,actual);
  cw.close();
}

</code></pre>

<br>
<pre class="type-9 type-11 type-8 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTimeout() throws Exception {
  Connector conn=getConnector();
  String table=getUniqueNames(1)[0];
  conn.tableOperations().create(table);
  ConditionalWriter cw=conn.createConditionalWriter(table,new ConditionalWriterConfig().setTimeout(3,TimeUnit.SECONDS));
  ConditionalMutation cm1=new ConditionalMutation("r1",new Condition("tx","seq"));
  cm1.put("tx","seq","1");
  cm1.put("data","x","a");
  Assert.assertEquals(cw.write(cm1).getStatus(),Status.ACCEPTED);
  IteratorSetting is=new IteratorSetting(5,SlowIterator.class);
  SlowIterator.setSeekSleepTime(is,5000);
  ConditionalMutation cm2=new ConditionalMutation("r1",new Condition("tx","seq").setValue("1").setIterators(is));
  cm2.put("tx","seq","2");
  cm2.put("data","x","b");
  Assert.assertEquals(cw.write(cm2).getStatus(),Status.UNKNOWN);
  Scanner scanner=conn.createScanner(table,Authorizations.EMPTY);
  for (  Entry<Key,Value> entry : scanner) {
    String cf=entry.getKey().getColumnFamilyData().toString();
    String cq=entry.getKey().getColumnQualifierData().toString();
    String val=entry.getValue().toString();
    if (cf.equals("tx") && cq.equals("seq"))     Assert.assertEquals("Unexpected value in tx:seq","1",val);
 else     if (cf.equals("data") && cq.equals("x"))     Assert.assertEquals("Unexpected value in data:x","a",val);
 else     Assert.fail("Saw unexpected column family and qualifier: " + entry);
  }
  ConditionalMutation cm3=new ConditionalMutation("r1",new Condition("tx","seq").setValue("1"));
  cm3.put("tx","seq","2");
  cm3.put("data","x","b");
  Assert.assertEquals(cw.write(cm3).getStatus(),Status.ACCEPTED);
  cw.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.ConfigurableMajorCompactionIT </h4><pre class="type-9 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test() throws Exception {
  Connector conn=getConnector();
  String tableName=getUniqueNames(1)[0];
  conn.tableOperations().create(tableName);
  conn.tableOperations().setProperty(tableName,Property.TABLE_COMPACTION_STRATEGY.getKey(),TestCompactionStrategy.class.getName());
  writeFile(conn,tableName);
  writeFile(conn,tableName);
  writeFile(conn,tableName);
  writeFile(conn,tableName);
  UtilWaitThread.sleep(2 * 1000);
  assertEquals(4,countFiles(conn));
  writeFile(conn,tableName);
  int count=countFiles(conn);
  assertTrue(count == 1 || count == 5);
  while (count != 1) {
    UtilWaitThread.sleep(250);
    count=countFiles(conn);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.CreateTableWithNewTableConfigIT </h4><pre class="type-9 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("deprecation") @Test public void tableNameLimitVersionAndTimeType() throws Exception {
  log.info("Starting tableNameLimitVersionAndTimeType");
  Connector connector=getConnector();
  String tableName=getUniqueNames(2)[0];
  boolean limitVersion=false;
  TimeType tt=TimeType.LOGICAL;
  connector.tableOperations().create(tableName,new NewTableConfiguration().withoutDefaultIterators().setTimeType(tt));
  String tableNameOrig="originalWithLimitVersionAndTimeType";
  connector.tableOperations().create(tableNameOrig,limitVersion,tt);
  int countNew=numProperties(connector,tableName);
  int countOrig=compareProperties(connector,tableNameOrig,tableName,null);
  Assert.assertEquals("Extra properties using the new create method",countOrig,countNew);
  Assert.assertTrue("Wrong TimeType",checkTimeType(connector,tableName,tt));
}

</code></pre>

<br>
<pre class="type-9 type-11 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("deprecation") @Test public void addCustomPropAndChangeExisting() throws Exception {
  log.info("Starting addCustomPropAndChangeExisting");
  Map<String,String> properties=new HashMap<String,String>();
  String propertyName=Property.TABLE_SPLIT_THRESHOLD.getKey();
  String volume="10K";
  properties.put(propertyName,volume);
  String propertyName2="table.custom.testProp";
  String volume2="Test property";
  properties.put(propertyName2,volume2);
  Connector connector=getConnector();
  String tableName=getUniqueNames(2)[0];
  connector.tableOperations().create(tableName,new NewTableConfiguration().setProperties(properties));
  String tableNameOrig="originalWithTableName";
  connector.tableOperations().create(tableNameOrig,true);
  int countNew=numProperties(connector,tableName);
  int countOrig=compareProperties(connector,tableNameOrig,tableName,propertyName);
  for (  Entry<String,String> entry : connector.tableOperations().getProperties(tableName)) {
    if (entry.getKey().equals(Property.TABLE_SPLIT_THRESHOLD.getKey()))     Assert.assertTrue("TABLE_SPLIT_THRESHOLD has been changed",entry.getValue().equals("10K"));
    if (entry.getKey().equals("table.custom.testProp"))     Assert.assertTrue("table.custom.testProp has been changed",entry.getValue().equals("Test property"));
  }
  Assert.assertEquals("Extra properties using the new create method",countOrig + 1,countNew);
  Assert.assertTrue("Wrong TimeType",checkTimeType(connector,tableName,TimeType.MILLIS));
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("deprecation") @Test public void tableNameAndLimitVersion() throws Exception {
  log.info("Starting tableNameAndLimitVersion");
  Connector connector=getConnector();
  String tableName=getUniqueNames(2)[0];
  boolean limitVersion=false;
  connector.tableOperations().create(tableName,new NewTableConfiguration().withoutDefaultIterators());
  String tableNameOrig="originalWithLimitVersion";
  connector.tableOperations().create(tableNameOrig,limitVersion);
  int countNew=numProperties(connector,tableName);
  int countOrig=compareProperties(connector,tableNameOrig,tableName,null);
  Assert.assertEquals("Extra properties using the new create method",countOrig,countNew);
  Assert.assertTrue("Wrong TimeType",checkTimeType(connector,tableName,TimeType.MILLIS));
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("deprecation") @Test public void tableNameOnly() throws Exception {
  log.info("Starting tableNameOnly");
  Connector connector=getConnector();
  String tableName=getUniqueNames(2)[0];
  connector.tableOperations().create(tableName,new NewTableConfiguration());
  String tableNameOrig="original";
  connector.tableOperations().create(tableNameOrig,true);
  int countNew=numProperties(connector,tableName);
  int countOrig=compareProperties(connector,tableNameOrig,tableName,null);
  Assert.assertEquals("Extra properties using the new create method",countOrig,countNew);
  Assert.assertTrue("Wrong TimeType",checkTimeType(connector,tableName,TimeType.MILLIS));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.DetectDeadTabletServersIT </h4><pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test() throws Exception {
  Connector c=getConnector();
  log.info("verifying that everything is up");
  Iterators.size(c.createScanner(MetadataTable.NAME,Authorizations.EMPTY).iterator());
  MasterMonitorInfo stats=getStats(c);
  assertEquals(2,stats.tServerInfo.size());
  assertEquals(0,stats.badTServers.size());
  assertEquals(0,stats.deadTabletServers.size());
  log.info("Killing a tablet server");
  getCluster().killProcess(TABLET_SERVER,getCluster().getProcesses().get(TABLET_SERVER).iterator().next());
  while (true) {
    stats=getStats(c);
    if (2 != stats.tServerInfo.size()) {
      break;
    }
    UtilWaitThread.sleep(500);
  }
  assertEquals(1,stats.tServerInfo.size());
  assertEquals(1,stats.badTServers.size() + stats.deadTabletServers.size());
  while (true) {
    stats=getStats(c);
    if (0 != stats.deadTabletServers.size()) {
      break;
    }
    UtilWaitThread.sleep(500);
  }
  assertEquals(1,stats.tServerInfo.size());
  assertEquals(0,stats.badTServers.size());
  assertEquals(1,stats.deadTabletServers.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.ExistingMacIT </h4><pre class="type-9 type-5 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExistingInstance() throws Exception {
  Connector conn=getCluster().getConnector("root",new PasswordToken(ROOT_PASSWORD));
  conn.tableOperations().create("table1");
  BatchWriter bw=conn.createBatchWriter("table1",new BatchWriterConfig());
  Mutation m1=new Mutation("00081");
  m1.put("math","sqroot","9");
  m1.put("math","sq","6560");
  bw.addMutation(m1);
  bw.close();
  conn.tableOperations().flush("table1",null,null,true);
  conn.tableOperations().flush(MetadataTable.NAME,null,null,true);
  conn.tableOperations().flush(RootTable.NAME,null,null,true);
  Set<Entry<ServerType,Collection<ProcessReference>>> procs=getCluster().getProcesses().entrySet();
  for (  Entry<ServerType,Collection<ProcessReference>> entry : procs) {
    if (entry.getKey() == ServerType.ZOOKEEPER)     continue;
    for (    ProcessReference pr : entry.getValue())     getCluster().killProcess(entry.getKey(),pr);
  }
  sleepUninterruptibly(10,TimeUnit.SECONDS);
  File hadoopConfDir=createTestDir(ExistingMacIT.class.getSimpleName() + "_hadoop_conf");
  FileUtils.deleteQuietly(hadoopConfDir);
  assertTrue(hadoopConfDir.mkdirs());
  createEmptyConfig(new File(hadoopConfDir,"core-site.xml"));
  createEmptyConfig(new File(hadoopConfDir,"hdfs-site.xml"));
  File testDir2=createTestDir(ExistingMacIT.class.getSimpleName() + "_2");
  FileUtils.deleteQuietly(testDir2);
  MiniAccumuloConfigImpl macConfig2=new MiniAccumuloConfigImpl(testDir2,"notused");
  macConfig2.useExistingInstance(new File(getCluster().getConfig().getConfDir(),"accumulo-site.xml"),hadoopConfDir);
  MiniAccumuloClusterImpl accumulo2=new MiniAccumuloClusterImpl(macConfig2);
  accumulo2.start();
  conn=accumulo2.getConnector("root",new PasswordToken(ROOT_PASSWORD));
  Scanner scanner=conn.createScanner("table1",Authorizations.EMPTY);
  int sum=0;
  for (  Entry<Key,Value> entry : scanner) {
    sum+=Integer.parseInt(entry.getValue().toString());
  }
  Assert.assertEquals(6569,sum);
  accumulo2.stop();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.FileArchiveIT </h4><pre class="type-9 type-5 type-3 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUnusuedFilesAreArchived() throws Exception {
  final Connector conn=getConnector();
  final String tableName=getUniqueNames(1)[0];
  conn.tableOperations().create(tableName);
  final String tableId=conn.tableOperations().tableIdMap().get(tableName);
  Assert.assertNotNull("Could not get table ID",tableId);
  BatchWriter bw=conn.createBatchWriter(tableName,new BatchWriterConfig());
  Mutation m=new Mutation("row");
  m.put("","","value");
  bw.addMutation(m);
  bw.close();
  conn.tableOperations().compact(tableName,null,null,true,true);
  Scanner s=conn.createScanner(MetadataTable.NAME,Authorizations.EMPTY);
  s.setRange(MetadataSchema.TabletsSection.getRange(tableId));
  s.fetchColumnFamily(MetadataSchema.TabletsSection.DataFileColumnFamily.NAME);
  Entry<Key,Value> entry=Iterables.getOnlyElement(s);
  final String file=entry.getKey().getColumnQualifier().toString();
  final Path p=new Path(file);
  conn.tableOperations().compact(tableName,null,null,true,true);
  log.info("File for table: " + file);
  FileSystem fs=getCluster().getFileSystem();
  int i=0;
  while (fs.exists(p)) {
    i++;
    Thread.sleep(1000);
    if (0 == i % 10) {
      log.info("Waited " + i + " iterations, file still exists");
    }
  }
  log.info("File was removed");
  String filePath=p.toUri().getPath().substring(getCluster().getConfig().getAccumuloDir().toString().length());
  log.info("File relative to accumulo dir: " + filePath);
  Path fileArchiveDir=new Path(getCluster().getConfig().getAccumuloDir().toString(),ServerConstants.FILE_ARCHIVE_DIR);
  Assert.assertTrue("File archive directory didn't exist",fs.exists(fileArchiveDir));
  Path archivedFile=new Path(fileArchiveDir,filePath.substring(1));
  Assert.assertTrue("File doesn't exists in archive directory: " + archivedFile,fs.exists(archivedFile));
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUnusuedFilesAndDeletedTable() throws Exception {
  final Connector conn=getConnector();
  final String tableName=getUniqueNames(1)[0];
  conn.tableOperations().create(tableName);
  final String tableId=conn.tableOperations().tableIdMap().get(tableName);
  Assert.assertNotNull("Could not get table ID",tableId);
  BatchWriter bw=conn.createBatchWriter(tableName,new BatchWriterConfig());
  Mutation m=new Mutation("row");
  m.put("","","value");
  bw.addMutation(m);
  bw.close();
  conn.tableOperations().compact(tableName,null,null,true,true);
  Scanner s=conn.createScanner(MetadataTable.NAME,Authorizations.EMPTY);
  s.setRange(MetadataSchema.TabletsSection.getRange(tableId));
  s.fetchColumnFamily(MetadataSchema.TabletsSection.DataFileColumnFamily.NAME);
  Entry<Key,Value> entry=Iterables.getOnlyElement(s);
  final String file=entry.getKey().getColumnQualifier().toString();
  final Path p=new Path(file);
  conn.tableOperations().compact(tableName,null,null,true,true);
  log.info("File for table: " + file);
  FileSystem fs=getCluster().getFileSystem();
  int i=0;
  while (fs.exists(p)) {
    i++;
    Thread.sleep(1000);
    if (0 == i % 10) {
      log.info("Waited " + i + " iterations, file still exists");
    }
  }
  log.info("File was removed");
  String filePath=p.toUri().getPath().substring(getCluster().getConfig().getAccumuloDir().toString().length());
  log.info("File relative to accumulo dir: " + filePath);
  Path fileArchiveDir=new Path(getCluster().getConfig().getAccumuloDir().toString(),ServerConstants.FILE_ARCHIVE_DIR);
  Assert.assertTrue("File archive directory didn't exist",fs.exists(fileArchiveDir));
  Path archivedFile=new Path(fileArchiveDir,filePath.substring(1));
  Assert.assertTrue("File doesn't exists in archive directory: " + archivedFile,fs.exists(archivedFile));
  conn.tableOperations().offline(tableName,true);
  s=conn.createScanner(MetadataTable.NAME,Authorizations.EMPTY);
  s.setRange(MetadataSchema.TabletsSection.getRange(tableId));
  s.fetchColumnFamily(MetadataSchema.TabletsSection.DataFileColumnFamily.NAME);
  entry=Iterables.getOnlyElement(s);
  final String finalFile=entry.getKey().getColumnQualifier().toString();
  final Path finalPath=new Path(finalFile);
  conn.tableOperations().delete(tableName);
  log.info("File for table: " + finalPath);
  i=0;
  while (fs.exists(finalPath)) {
    i++;
    Thread.sleep(1000);
    if (0 == i % 10) {
      log.info("Waited " + i + " iterations, file still exists");
    }
  }
  log.info("File was removed");
  String finalFilePath=finalPath.toUri().getPath().substring(getCluster().getConfig().getAccumuloDir().toString().length());
  log.info("File relative to accumulo dir: " + finalFilePath);
  Assert.assertTrue("File archive directory didn't exist",fs.exists(fileArchiveDir));
  Path finalArchivedFile=new Path(fileArchiveDir,finalFilePath.substring(1));
  Assert.assertTrue("File doesn't exists in archive directory: " + finalArchivedFile,fs.exists(finalArchivedFile));
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeletedTableIsArchived() throws Exception {
  final Connector conn=getConnector();
  final String tableName=getUniqueNames(1)[0];
  conn.tableOperations().create(tableName);
  final String tableId=conn.tableOperations().tableIdMap().get(tableName);
  Assert.assertNotNull("Could not get table ID",tableId);
  BatchWriter bw=conn.createBatchWriter(tableName,new BatchWriterConfig());
  Mutation m=new Mutation("row");
  m.put("","","value");
  bw.addMutation(m);
  bw.close();
  conn.tableOperations().compact(tableName,null,null,true,true);
  Scanner s=conn.createScanner(MetadataTable.NAME,Authorizations.EMPTY);
  s.setRange(MetadataSchema.TabletsSection.getRange(tableId));
  s.fetchColumnFamily(MetadataSchema.TabletsSection.DataFileColumnFamily.NAME);
  Entry<Key,Value> entry=Iterables.getOnlyElement(s);
  final String file=entry.getKey().getColumnQualifier().toString();
  final Path p=new Path(file);
  conn.tableOperations().delete(tableName);
  log.info("File for table: " + file);
  FileSystem fs=getCluster().getFileSystem();
  int i=0;
  while (fs.exists(p)) {
    i++;
    Thread.sleep(1000);
    if (0 == i % 10) {
      log.info("Waited " + i + " iterations, file still exists");
    }
  }
  log.info("File was removed");
  String filePath=p.toUri().getPath().substring(getCluster().getConfig().getAccumuloDir().toString().length());
  log.info("File relative to accumulo dir: " + filePath);
  Path fileArchiveDir=new Path(getCluster().getConfig().getAccumuloDir().toString(),ServerConstants.FILE_ARCHIVE_DIR);
  Assert.assertTrue("File archive directory didn't exist",fs.exists(fileArchiveDir));
  Path archivedFile=new Path(fileArchiveDir,filePath.substring(1));
  Assert.assertTrue("File doesn't exists in archive directory: " + archivedFile,fs.exists(archivedFile));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.FindMaxIT </h4><pre class="type-9 type-13 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test1() throws Exception {
  Connector conn=getConnector();
  String tableName=getUniqueNames(1)[0];
  conn.tableOperations().create(tableName);
  BatchWriter bw=conn.createBatchWriter(tableName,new BatchWriterConfig());
  bw.addMutation(nm(new byte[]{0}));
  bw.addMutation(nm(new byte[]{0,0}));
  bw.addMutation(nm(new byte[]{0,1}));
  bw.addMutation(nm(new byte[]{0,1,0}));
  bw.addMutation(nm(new byte[]{1,0}));
  bw.addMutation(nm(new byte[]{'a','b','c'}));
  bw.addMutation(nm(new byte[]{(byte)0xff}));
  bw.addMutation(nm(new byte[]{(byte)0xff,(byte)0xff,(byte)0xff,(byte)0xff,(byte)0xff,(byte)0xff}));
  for (int i=0; i < 1000; i+=5) {
    bw.addMutation(nm(String.format("r%05d",i)));
  }
  bw.close();
  Scanner scanner=conn.createScanner(tableName,Authorizations.EMPTY);
  ArrayList<Text> rows=new ArrayList<Text>();
  for (  Entry<Key,Value> entry : scanner) {
    rows.add(entry.getKey().getRow());
  }
  for (int i=rows.size() - 1; i > 0; i--) {
    Text max=conn.tableOperations().getMaxRow(tableName,Authorizations.EMPTY,null,true,rows.get(i),false);
    assertEquals(rows.get(i - 1),max);
    max=conn.tableOperations().getMaxRow(tableName,Authorizations.EMPTY,rows.get(i - 1),true,rows.get(i),false);
    assertEquals(rows.get(i - 1),max);
    max=conn.tableOperations().getMaxRow(tableName,Authorizations.EMPTY,rows.get(i - 1),false,rows.get(i),false);
    assertNull(max);
    max=conn.tableOperations().getMaxRow(tableName,Authorizations.EMPTY,null,true,rows.get(i),true);
    assertEquals(rows.get(i),max);
    max=conn.tableOperations().getMaxRow(tableName,Authorizations.EMPTY,rows.get(i),true,rows.get(i),true);
    assertEquals(rows.get(i),max);
    max=conn.tableOperations().getMaxRow(tableName,Authorizations.EMPTY,rows.get(i - 1),false,rows.get(i),true);
    assertEquals(rows.get(i),max);
  }
  Text max=conn.tableOperations().getMaxRow(tableName,Authorizations.EMPTY,null,true,null,true);
  assertEquals(rows.get(rows.size() - 1),max);
  max=conn.tableOperations().getMaxRow(tableName,Authorizations.EMPTY,null,true,new Text(new byte[]{0}),false);
  assertNull(max);
  max=conn.tableOperations().getMaxRow(tableName,Authorizations.EMPTY,null,true,new Text(new byte[]{0}),true);
  assertEquals(rows.get(0),max);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.ImportExportIT </h4><pre class="type-9 type-13 type-11 type-8 type-5 type-3 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExportImportThenScan() throws Exception {
  Connector conn=getConnector();
  String[] tableNames=getUniqueNames(2);
  String srcTable=tableNames[0], destTable=tableNames[1];
  conn.tableOperations().create(srcTable);
  BatchWriter bw=conn.createBatchWriter(srcTable,new BatchWriterConfig());
  for (int row=0; row < 1000; row++) {
    Mutation m=new Mutation(Integer.toString(row));
    for (int col=0; col < 100; col++) {
      m.put(Integer.toString(col),"",Integer.toString(col * 2));
    }
    bw.addMutation(m);
  }
  bw.close();
  conn.tableOperations().compact(srcTable,null,null,true,true);
  FileSystem fs=cluster.getFileSystem();
  Path tmp=cluster.getTemporaryPath();
  log.info("Using FileSystem: " + fs);
  Path baseDir=new Path(tmp,getClass().getName());
  if (fs.exists(baseDir)) {
    log.info("{} exists on filesystem, deleting",baseDir);
    assertTrue("Failed to deleted " + baseDir,fs.delete(baseDir,true));
  }
  log.info("Creating {}",baseDir);
  assertTrue("Failed to create " + baseDir,fs.mkdirs(baseDir));
  Path exportDir=new Path(baseDir,"export");
  Path importDir=new Path(baseDir,"import");
  for (  Path p : new Path[]{exportDir,importDir}) {
    assertTrue("Failed to create " + baseDir,fs.mkdirs(p));
  }
  log.info("Exporting table to {}",exportDir);
  log.info("Importing table from {}",importDir);
  conn.tableOperations().offline(srcTable,true);
  conn.tableOperations().exportTable(srcTable,exportDir.toString());
  Path distcp=new Path(exportDir,"distcp.txt");
  Assert.assertTrue("Distcp file doesn't exist",fs.exists(distcp));
  FSDataInputStream is=fs.open(distcp);
  BufferedReader reader=new BufferedReader(new InputStreamReader(is));
  String line;
  while (null != (line=reader.readLine())) {
    Path p=new Path(line.substring(5));
    Assert.assertTrue("File doesn't exist: " + p,fs.exists(p));
    Path dest=new Path(importDir,p.getName());
    Assert.assertFalse("Did not expect " + dest + " to exist",fs.exists(dest));
    FileUtil.copy(fs,p,fs,dest,false,fs.getConf());
  }
  reader.close();
  log.info("Import dir: {}",Arrays.toString(fs.listStatus(importDir)));
  conn.tableOperations().importTable(destTable,importDir.toString());
  final String tableId=conn.tableOperations().tableIdMap().get(destTable);
  Assert.assertNotNull(tableId);
  log.info("Imported into table with ID: {}",tableId);
  Scanner s=conn.createScanner(MetadataTable.NAME,Authorizations.EMPTY);
  s.setRange(MetadataSchema.TabletsSection.getRange(tableId));
  s.fetchColumnFamily(MetadataSchema.TabletsSection.DataFileColumnFamily.NAME);
  MetadataSchema.TabletsSection.ServerColumnFamily.DIRECTORY_COLUMN.fetch(s);
  for (  Entry<Key,Value> fileEntry : s) {
    Key k=fileEntry.getKey();
    String value=fileEntry.getValue().toString();
    if (k.getColumnFamily().equals(MetadataSchema.TabletsSection.DataFileColumnFamily.NAME)) {
      String fileUri=k.getColumnQualifier().toString();
      Assert.assertFalse("Imported files should have absolute URIs, not relative: " + fileUri,looksLikeRelativePath(fileUri));
    }
 else     if (k.getColumnFamily().equals(MetadataSchema.TabletsSection.ServerColumnFamily.NAME)) {
      Assert.assertFalse("Server directory should have absolute URI, not relative: " + value,looksLikeRelativePath(value));
    }
 else {
      Assert.fail("Got expected pair: " + k + "="+ fileEntry.getValue());
    }
  }
  conn.tableOperations().online(srcTable,true);
  verifyTableEquality(conn,srcTable,destTable);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.KeyValueEqualityIT </h4><pre class="type-9 type-13 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEquality() throws Exception {
  Connector conn=this.getConnector();
  final BatchWriterConfig config=new BatchWriterConfig();
  final String[] tables=getUniqueNames(2);
  final String table1=tables[0], table2=tables[1];
  final TableOperations tops=conn.tableOperations();
  tops.create(table1);
  tops.create(table2);
  final BatchWriter bw1=conn.createBatchWriter(table1,config), bw2=conn.createBatchWriter(table2,config);
  for (int row=0; row < 100; row++) {
    Mutation m=new Mutation(Integer.toString(row));
    for (int col=0; col < 10; col++) {
      m.put(Integer.toString(col),"",System.currentTimeMillis(),Integer.toString(col * 2));
    }
    bw1.addMutation(m);
    bw2.addMutation(m);
  }
  bw1.close();
  bw2.close();
  Iterator<Entry<Key,Value>> t1=conn.createScanner(table1,Authorizations.EMPTY).iterator(), t2=conn.createScanner(table2,Authorizations.EMPTY).iterator();
  while (t1.hasNext() && t2.hasNext()) {
    Entry<Key,Value> e1=t1.next(), e2=t2.next();
    Assert.assertEquals(e1,e2);
    Assert.assertEquals(e1.hashCode(),e2.hashCode());
  }
  Assert.assertFalse("table1 had more data to read",t1.hasNext());
  Assert.assertFalse("table2 had more data to read",t2.hasNext());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.LargeSplitRowIT </h4><pre class="type-9 type-8 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=60 * 1000) public void userAddedSplit() throws Exception {
  log.info("User added split");
  final String tableName=getUniqueNames(1)[0];
  final Connector conn=getConnector();
  conn.tableOperations().create(tableName);
  conn.tableOperations().setProperty(tableName,Property.TABLE_MAX_END_ROW_SIZE.getKey(),"1000");
  BatchWriter batchWriter=conn.createBatchWriter(tableName,new BatchWriterConfig());
  Mutation m=new Mutation("Row");
  m.put("cf","cq","value");
  batchWriter.addMutation(m);
  batchWriter.close();
  SortedSet<Text> partitionKeys=new TreeSet<Text>();
  byte data[]=new byte[(int)(TableConfiguration.getMemoryInBytes(Property.TABLE_MAX_END_ROW_SIZE.getDefaultValue()) + 2)];
  for (int i=0; i < data.length; i++) {
    data[i]='m';
  }
  partitionKeys.add(new Text(data));
  try {
    conn.tableOperations().addSplits(tableName,partitionKeys);
    Assert.fail();
  }
 catch (  AccumuloServerException e) {
  }
  int counter=0;
  final Scanner scanner=conn.createScanner(tableName,Authorizations.EMPTY);
  for (  Entry<Key,Value> entry : scanner) {
    counter++;
    Key k=entry.getKey();
    Assert.assertEquals("Row",k.getRow().toString());
    Assert.assertEquals("cf",k.getColumnFamily().toString());
    Assert.assertEquals("cq",k.getColumnQualifier().toString());
    Assert.assertEquals("value",entry.getValue().toString());
  }
  Assert.assertEquals(1,counter);
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test(timeout=60 * 1000) public void automaticSplitLater() throws Exception {
  log.info("Split later");
  automaticSplit(15,1);
  final Connector conn=getConnector();
  String tableName=new String();
  java.util.Iterator<String> iterator=conn.tableOperations().list().iterator();
  while (iterator.hasNext()) {
    String curr=iterator.next();
    if (!curr.startsWith(Namespaces.ACCUMULO_NAMESPACE + ".")) {
      tableName=curr;
    }
  }
  BatchWriter batchWriter=conn.createBatchWriter(tableName,new BatchWriterConfig());
  byte data[]=new byte[10];
  for (int j=15; j < 150; j+=1) {
    for (int i=0; i < data.length - 1; i++) {
      data[i]=(byte)j;
    }
    for (int i=0; i < 25; i++) {
      data[data.length - 1]=(byte)i;
      Mutation m=new Mutation(data);
      m.put("cf","cq","value");
      batchWriter.addMutation(m);
    }
  }
  batchWriter.close();
  conn.tableOperations().flush(tableName,new Text(),new Text("z"),true);
  while (conn.tableOperations().listSplits(tableName).size() == 0) {
    Thread.sleep(250);
  }
  Assert.assertTrue(0 < conn.tableOperations().listSplits(tableName).size());
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test(timeout=60 * 1000) public void automaticSplitWith250Same() throws Exception {
  log.info("Automatic with 250 with same prefix");
  final String tableName=getUniqueNames(1)[0];
  final Connector conn=getConnector();
  conn.tableOperations().create(tableName);
  conn.tableOperations().setProperty(tableName,Property.TABLE_SPLIT_THRESHOLD.getKey(),"10K");
  conn.tableOperations().setProperty(tableName,Property.TABLE_FILE_COMPRESSION_TYPE.getKey(),"none");
  conn.tableOperations().setProperty(tableName,Property.TABLE_FILE_COMPRESSED_BLOCK_SIZE.getKey(),"64");
  conn.tableOperations().setProperty(tableName,Property.TABLE_MAX_END_ROW_SIZE.getKey(),"1000");
  BatchWriter batchWriter=conn.createBatchWriter(tableName,new BatchWriterConfig());
  byte data[]=new byte[(int)(TableConfiguration.getMemoryInBytes(Property.TABLE_MAX_END_ROW_SIZE.getDefaultValue()) + 2)];
  for (int i=0; i < data.length - 1; i++) {
    data[i]=(byte)'m';
  }
  for (int i=0; i < 250; i++) {
    data[data.length - 1]=(byte)i;
    Mutation m=new Mutation(data);
    m.put("cf","cq","value");
    batchWriter.addMutation(m);
  }
  batchWriter.close();
  conn.tableOperations().flush(tableName,new Text(),new Text("z"),true);
  Thread.sleep(500);
  int count=0;
  final Scanner scanner=conn.createScanner(tableName,Authorizations.EMPTY);
  for (  Entry<Key,Value> entry : scanner) {
    Key k=entry.getKey();
    data[data.length - 1]=(byte)count;
    String expected=new String(data,UTF_8);
    Assert.assertEquals(expected,k.getRow().toString());
    Assert.assertEquals("cf",k.getColumnFamily().toString());
    Assert.assertEquals("cq",k.getColumnQualifier().toString());
    Assert.assertEquals("value",entry.getValue().toString());
    count++;
  }
  Assert.assertEquals(250,count);
  Assert.assertEquals(0,conn.tableOperations().listSplits(tableName).size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.MissingWalHeaderCompletesRecoveryIT </h4><pre class="type-9 type-5 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPartialHeaderWalRecoveryCompletes() throws Exception {
  Connector conn=getConnector();
  MiniAccumuloClusterImpl cluster=getCluster();
  FileSystem fs=getCluster().getFileSystem();
  String fakeServer="127.0.0.1:12345";
  File walogs=new File(cluster.getConfig().getAccumuloDir(),ServerConstants.WAL_DIR);
  File walogServerDir=new File(walogs,fakeServer.replace(':','+'));
  File partialHeaderWalog=new File(walogServerDir,UUID.randomUUID().toString());
  log.info("Created WAL with malformed header at " + partialHeaderWalog.toURI());
  FSDataOutputStream wal=fs.create(new Path(partialHeaderWalog.toURI()));
  wal.write(DfsLogger.LOG_FILE_HEADER_V3.getBytes(UTF_8),0,DfsLogger.LOG_FILE_HEADER_V3.length() / 2);
  wal.close();
  Assert.assertTrue("root user did not have write permission to metadata table",conn.securityOperations().hasTablePermission("root",MetadataTable.NAME,TablePermission.WRITE));
  String tableName=getUniqueNames(1)[0];
  conn.tableOperations().create(tableName);
  String tableId=conn.tableOperations().tableIdMap().get(tableName);
  Assert.assertNotNull("Table ID was null",tableId);
  LogEntry logEntry=new LogEntry(null,0,"127.0.0.1:12345",partialHeaderWalog.toURI().toString());
  log.info("Taking {} offline",tableName);
  conn.tableOperations().offline(tableName,true);
  log.info("{} is offline",tableName);
  Text row=MetadataSchema.TabletsSection.getRow(new Text(tableId),null);
  Mutation m=new Mutation(row);
  m.put(logEntry.getColumnFamily(),logEntry.getColumnQualifier(),logEntry.getValue());
  BatchWriter bw=conn.createBatchWriter(MetadataTable.NAME,new BatchWriterConfig());
  bw.addMutation(m);
  bw.close();
  log.info("Bringing {} online",tableName);
  conn.tableOperations().online(tableName,true);
  log.info("{} is online",tableName);
  Scanner s=conn.createScanner(tableName,Authorizations.EMPTY);
  Assert.assertEquals(0,Iterables.size(s));
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEmptyWalRecoveryCompletes() throws Exception {
  Connector conn=getConnector();
  MiniAccumuloClusterImpl cluster=getCluster();
  FileSystem fs=cluster.getFileSystem();
  String fakeServer="127.0.0.1:12345";
  File walogs=new File(cluster.getConfig().getAccumuloDir(),ServerConstants.WAL_DIR);
  File walogServerDir=new File(walogs,fakeServer.replace(':','+'));
  File emptyWalog=new File(walogServerDir,UUID.randomUUID().toString());
  log.info("Created empty WAL at " + emptyWalog.toURI());
  fs.create(new Path(emptyWalog.toURI())).close();
  Assert.assertTrue("root user did not have write permission to metadata table",conn.securityOperations().hasTablePermission("root",MetadataTable.NAME,TablePermission.WRITE));
  String tableName=getUniqueNames(1)[0];
  conn.tableOperations().create(tableName);
  String tableId=conn.tableOperations().tableIdMap().get(tableName);
  Assert.assertNotNull("Table ID was null",tableId);
  LogEntry logEntry=new LogEntry(new KeyExtent(new Text(tableId),null,null),0,"127.0.0.1:12345",emptyWalog.toURI().toString());
  log.info("Taking {} offline",tableName);
  conn.tableOperations().offline(tableName,true);
  log.info("{} is offline",tableName);
  Text row=MetadataSchema.TabletsSection.getRow(new Text(tableId),null);
  Mutation m=new Mutation(row);
  m.put(logEntry.getColumnFamily(),logEntry.getColumnQualifier(),logEntry.getValue());
  BatchWriter bw=conn.createBatchWriter(MetadataTable.NAME,new BatchWriterConfig());
  bw.addMutation(m);
  bw.close();
  log.info("Bringing {} online",tableName);
  conn.tableOperations().online(tableName,true);
  log.info("{} is online",tableName);
  Scanner s=conn.createScanner(tableName,Authorizations.EMPTY);
  Assert.assertEquals(0,Iterables.size(s));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.NamespacesIT </h4><pre class="type-9 type-8 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void verifyIteratorInheritance() throws Exception {
  String t1=namespace + ".1";
  c.namespaceOperations().create(namespace);
  c.tableOperations().create(t1);
  String iterName=namespace + "_iter";
  BatchWriter bw=c.createBatchWriter(t1,new BatchWriterConfig());
  Mutation m=new Mutation("r");
  m.put("a","b",new Value("abcde".getBytes()));
  bw.addMutation(m);
  bw.flush();
  bw.close();
  IteratorSetting setting=new IteratorSetting(250,iterName,SimpleFilter.class.getName());
  Scanner s=c.createScanner(t1,Authorizations.EMPTY);
  assertTrue(s.iterator().hasNext());
  assertFalse(c.namespaceOperations().listIterators(namespace).containsKey(iterName));
  assertFalse(c.tableOperations().listIterators(t1).containsKey(iterName));
  c.namespaceOperations().checkIteratorConflicts(namespace,setting,EnumSet.allOf(IteratorScope.class));
  c.namespaceOperations().attachIterator(namespace,setting);
  sleepUninterruptibly(2,TimeUnit.SECONDS);
  try {
    c.namespaceOperations().checkIteratorConflicts(namespace,setting,EnumSet.allOf(IteratorScope.class));
    fail();
  }
 catch (  AccumuloException e) {
    assertEquals(IllegalArgumentException.class.getName(),e.getCause().getClass().getName());
  }
  IteratorSetting setting2=c.namespaceOperations().getIteratorSetting(namespace,setting.getName(),IteratorScope.scan);
  assertEquals(setting,setting2);
  assertTrue(c.namespaceOperations().listIterators(namespace).containsKey(iterName));
  assertTrue(c.tableOperations().listIterators(t1).containsKey(iterName));
  s=c.createScanner(t1,Authorizations.EMPTY);
  assertFalse(s.iterator().hasNext());
  c.namespaceOperations().removeIterator(namespace,setting.getName(),EnumSet.allOf(IteratorScope.class));
  sleepUninterruptibly(2,TimeUnit.SECONDS);
  assertFalse(c.namespaceOperations().listIterators(namespace).containsKey(iterName));
  assertFalse(c.tableOperations().listIterators(t1).containsKey(iterName));
  s=c.createScanner(t1,Authorizations.EMPTY);
  assertTrue(s.iterator().hasNext());
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void renameNamespaceWithTable() throws Exception {
  String namespace2=namespace + "_renamed";
  String t1=namespace + ".t";
  String t2=namespace2 + ".t";
  c.namespaceOperations().create(namespace);
  c.tableOperations().create(t1);
  assertTrue(c.namespaceOperations().exists(namespace));
  assertTrue(c.tableOperations().exists(t1));
  assertFalse(c.namespaceOperations().exists(namespace2));
  assertFalse(c.tableOperations().exists(t2));
  String namespaceId=c.namespaceOperations().namespaceIdMap().get(namespace);
  String tableId=c.tableOperations().tableIdMap().get(t1);
  c.namespaceOperations().rename(namespace,namespace2);
  assertFalse(c.namespaceOperations().exists(namespace));
  assertFalse(c.tableOperations().exists(t1));
  assertTrue(c.namespaceOperations().exists(namespace2));
  assertTrue(c.tableOperations().exists(t2));
  String namespaceId2=c.namespaceOperations().namespaceIdMap().get(namespace2);
  String tableId2=c.tableOperations().tableIdMap().get(t2);
  assertEquals(namespaceId,namespaceId2);
  assertEquals(tableId,tableId2);
}

</code></pre>

<br>
<pre class="type-9 type-11 type-8 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests new Namespace permissions as well as modifications to Table permissions because of namespaces. Checks each permission to first make sure the user
 * doesn't have permission to perform the action, then root grants them the permission and we check to make sure they could perform the action.
 */
@Test public void testPermissions() throws Exception {
  ClusterUser user1=getUser(0), user2=getUser(1), root=getAdminUser();
  String u1=user1.getPrincipal();
  String u2=user2.getPrincipal();
  PasswordToken pass=(null != user1.getPassword() ? new PasswordToken(user1.getPassword()) : null);
  String n1=namespace;
  String t1=n1 + ".1";
  String t2=n1 + ".2";
  String t3=n1 + ".3";
  String n2=namespace + "_2";
  loginAs(root);
  c.namespaceOperations().create(n1);
  c.tableOperations().create(t1);
  c.securityOperations().createLocalUser(u1,pass);
  loginAs(user1);
  Connector user1Con=c.getInstance().getConnector(u1,user1.getToken());
  try {
    user1Con.tableOperations().create(t2);
    fail();
  }
 catch (  AccumuloSecurityException e) {
    expectPermissionDenied(e);
  }
  loginAs(root);
  c.securityOperations().grantNamespacePermission(u1,n1,NamespacePermission.CREATE_TABLE);
  loginAs(user1);
  user1Con.tableOperations().create(t2);
  loginAs(root);
  assertTrue(c.tableOperations().list().contains(t2));
  c.securityOperations().revokeNamespacePermission(u1,n1,NamespacePermission.CREATE_TABLE);
  loginAs(user1);
  try {
    user1Con.tableOperations().delete(t1);
    fail();
  }
 catch (  AccumuloSecurityException e) {
    expectPermissionDenied(e);
  }
  loginAs(root);
  c.securityOperations().grantNamespacePermission(u1,n1,NamespacePermission.DROP_TABLE);
  loginAs(user1);
  user1Con.tableOperations().delete(t1);
  loginAs(root);
  assertTrue(!c.tableOperations().list().contains(t1));
  c.securityOperations().revokeNamespacePermission(u1,n1,NamespacePermission.DROP_TABLE);
  c.tableOperations().create(t3);
  BatchWriter bw=c.createBatchWriter(t3,null);
  Mutation m=new Mutation("row");
  m.put("cf","cq","value");
  bw.addMutation(m);
  bw.close();
  loginAs(user1);
  Iterator<Entry<Key,Value>> i=user1Con.createScanner(t3,new Authorizations()).iterator();
  try {
    i.next();
    fail();
  }
 catch (  RuntimeException e) {
    assertEquals(AccumuloSecurityException.class.getName(),e.getCause().getClass().getName());
    expectPermissionDenied((AccumuloSecurityException)e.getCause());
  }
  loginAs(user1);
  m=new Mutation(u1);
  m.put("cf","cq","turtles");
  bw=user1Con.createBatchWriter(t3,null);
  try {
    bw.addMutation(m);
    bw.close();
    fail();
  }
 catch (  MutationsRejectedException e) {
    assertEquals(1,e.getSecurityErrorCodes().size());
    assertEquals(1,e.getSecurityErrorCodes().entrySet().iterator().next().getValue().size());
switch (e.getSecurityErrorCodes().entrySet().iterator().next().getValue().iterator().next()) {
case PERMISSION_DENIED:
      break;
default :
    fail();
}
}
loginAs(root);
c.securityOperations().grantNamespacePermission(u1,n1,NamespacePermission.READ);
loginAs(user1);
i=user1Con.createScanner(t3,new Authorizations()).iterator();
assertTrue(i.hasNext());
loginAs(root);
c.securityOperations().revokeNamespacePermission(u1,n1,NamespacePermission.READ);
c.securityOperations().grantNamespacePermission(u1,n1,NamespacePermission.WRITE);
loginAs(user1);
m=new Mutation(u1);
m.put("cf","cq","turtles");
bw=user1Con.createBatchWriter(t3,null);
bw.addMutation(m);
bw.close();
loginAs(root);
c.securityOperations().revokeNamespacePermission(u1,n1,NamespacePermission.WRITE);
loginAs(user1);
try {
user1Con.tableOperations().setProperty(t3,Property.TABLE_FILE_MAX.getKey(),"42");
fail();
}
 catch (AccumuloSecurityException e) {
expectPermissionDenied(e);
}
loginAs(root);
c.securityOperations().grantNamespacePermission(u1,n1,NamespacePermission.ALTER_TABLE);
loginAs(user1);
user1Con.tableOperations().setProperty(t3,Property.TABLE_FILE_MAX.getKey(),"42");
user1Con.tableOperations().removeProperty(t3,Property.TABLE_FILE_MAX.getKey());
loginAs(root);
c.securityOperations().revokeNamespacePermission(u1,n1,NamespacePermission.ALTER_TABLE);
loginAs(user1);
try {
user1Con.namespaceOperations().setProperty(n1,Property.TABLE_FILE_MAX.getKey(),"55");
fail();
}
 catch (AccumuloSecurityException e) {
expectPermissionDenied(e);
}
loginAs(root);
c.securityOperations().grantNamespacePermission(u1,n1,NamespacePermission.ALTER_NAMESPACE);
loginAs(user1);
user1Con.namespaceOperations().setProperty(n1,Property.TABLE_FILE_MAX.getKey(),"42");
user1Con.namespaceOperations().removeProperty(n1,Property.TABLE_FILE_MAX.getKey());
loginAs(root);
c.securityOperations().revokeNamespacePermission(u1,n1,NamespacePermission.ALTER_NAMESPACE);
loginAs(root);
c.securityOperations().createLocalUser(u2,(root.getPassword() == null ? null : new PasswordToken(user2.getPassword())));
loginAs(user1);
try {
user1Con.securityOperations().grantNamespacePermission(u2,n1,NamespacePermission.ALTER_NAMESPACE);
fail();
}
 catch (AccumuloSecurityException e) {
expectPermissionDenied(e);
}
loginAs(root);
c.securityOperations().grantNamespacePermission(u1,n1,NamespacePermission.GRANT);
loginAs(user1);
user1Con.securityOperations().grantNamespacePermission(u2,n1,NamespacePermission.ALTER_NAMESPACE);
user1Con.securityOperations().revokeNamespacePermission(u2,n1,NamespacePermission.ALTER_NAMESPACE);
loginAs(root);
c.securityOperations().revokeNamespacePermission(u1,n1,NamespacePermission.GRANT);
loginAs(user1);
try {
user1Con.namespaceOperations().create(n2);
fail();
}
 catch (AccumuloSecurityException e) {
expectPermissionDenied(e);
}
loginAs(root);
c.securityOperations().grantSystemPermission(u1,SystemPermission.CREATE_NAMESPACE);
loginAs(user1);
user1Con.namespaceOperations().create(n2);
loginAs(root);
c.securityOperations().revokeSystemPermission(u1,SystemPermission.CREATE_NAMESPACE);
c.securityOperations().revokeNamespacePermission(u1,n2,NamespacePermission.DROP_NAMESPACE);
loginAs(user1);
try {
user1Con.namespaceOperations().delete(n2);
fail();
}
 catch (AccumuloSecurityException e) {
expectPermissionDenied(e);
}
loginAs(root);
c.securityOperations().grantSystemPermission(u1,SystemPermission.DROP_NAMESPACE);
loginAs(user1);
user1Con.namespaceOperations().delete(n2);
loginAs(root);
c.securityOperations().revokeSystemPermission(u1,SystemPermission.DROP_NAMESPACE);
loginAs(user1);
try {
user1Con.namespaceOperations().setProperty(n1,Property.TABLE_FILE_MAX.getKey(),"33");
fail();
}
 catch (AccumuloSecurityException e) {
expectPermissionDenied(e);
}
loginAs(root);
c.securityOperations().grantSystemPermission(u1,SystemPermission.ALTER_NAMESPACE);
loginAs(user1);
user1Con.namespaceOperations().setProperty(n1,Property.TABLE_FILE_MAX.getKey(),"33");
user1Con.namespaceOperations().removeProperty(n1,Property.TABLE_FILE_MAX.getKey());
loginAs(root);
c.securityOperations().revokeSystemPermission(u1,SystemPermission.ALTER_NAMESPACE);
}

</code></pre>

<br>
<pre class="type-9 type-13 type-5 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void verifyConstraintInheritance() throws Exception {
  String t1=namespace + ".1";
  c.namespaceOperations().create(namespace);
  c.tableOperations().create(t1,new NewTableConfiguration().withoutDefaultIterators());
  String constraintClassName=NumericValueConstraint.class.getName();
  assertFalse(c.namespaceOperations().listConstraints(namespace).containsKey(constraintClassName));
  assertFalse(c.tableOperations().listConstraints(t1).containsKey(constraintClassName));
  c.namespaceOperations().addConstraint(namespace,constraintClassName);
  boolean passed=false;
  for (int i=0; i < 5; i++) {
    if (!c.namespaceOperations().listConstraints(namespace).containsKey(constraintClassName)) {
      Thread.sleep(500);
      continue;
    }
    if (!c.tableOperations().listConstraints(t1).containsKey(constraintClassName)) {
      Thread.sleep(500);
      continue;
    }
    passed=true;
    break;
  }
  assertTrue("Failed to observe newly-added constraint",passed);
  passed=false;
  Integer namespaceNum=null;
  for (int i=0; i < 5; i++) {
    namespaceNum=c.namespaceOperations().listConstraints(namespace).get(constraintClassName);
    if (null == namespaceNum) {
      Thread.sleep(500);
      continue;
    }
    Integer tableNum=c.tableOperations().listConstraints(t1).get(constraintClassName);
    if (null == tableNum) {
      Thread.sleep(500);
      continue;
    }
    assertEquals(namespaceNum,tableNum);
    passed=true;
  }
  assertTrue("Failed to observe constraint in both table and namespace",passed);
  Mutation m1=new Mutation("r1");
  Mutation m2=new Mutation("r2");
  Mutation m3=new Mutation("r3");
  m1.put("a","b",new Value("abcde".getBytes(UTF_8)));
  m2.put("e","f",new Value("123".getBytes(UTF_8)));
  m3.put("c","d",new Value("zyxwv".getBytes(UTF_8)));
  passed=false;
  for (int i=0; i < 5; i++) {
    BatchWriter bw=c.createBatchWriter(t1,new BatchWriterConfig());
    bw.addMutations(Arrays.asList(m1,m2,m3));
    try {
      bw.close();
      Thread.sleep(500);
    }
 catch (    MutationsRejectedException e) {
      passed=true;
      assertEquals(1,e.getConstraintViolationSummaries().size());
      assertEquals(2,e.getConstraintViolationSummaries().get(0).getNumberOfViolatingMutations());
      break;
    }
  }
  assertTrue("Failed to see mutations rejected after constraint was added",passed);
  assertNotNull("Namespace constraint ID should not be null",namespaceNum);
  c.namespaceOperations().removeConstraint(namespace,namespaceNum);
  passed=false;
  for (int i=0; i < 5; i++) {
    if (c.namespaceOperations().listConstraints(namespace).containsKey(constraintClassName)) {
      Thread.sleep(500);
      continue;
    }
    if (c.tableOperations().listConstraints(t1).containsKey(constraintClassName)) {
      Thread.sleep(500);
      continue;
    }
    passed=true;
  }
  assertTrue("Failed to verify that constraint was removed from namespace and table",passed);
  passed=false;
  for (int i=0; i < 5; i++) {
    BatchWriter bw=c.createBatchWriter(t1,new BatchWriterConfig());
    try {
      bw.addMutations(Arrays.asList(m1,m2,m3));
      bw.close();
    }
 catch (    MutationsRejectedException e) {
      Thread.sleep(500);
      continue;
    }
    passed=true;
  }
  assertTrue("Failed to add mutations that should be allowed",passed);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.RecoveryCompactionsAreFlushesIT </h4><pre class="type-9 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void test() throws Exception {
  String tableName=getUniqueNames(1)[0];
  Connector c=getConnector();
  c.tableOperations().create(tableName);
  c.tableOperations().setProperty(tableName,Property.TABLE_MAJC_RATIO.getKey(),"100");
  c.tableOperations().setProperty(tableName,Property.TABLE_FILE_MAX.getKey(),"3");
  BatchWriter bw=c.createBatchWriter(tableName,new BatchWriterConfig());
  Mutation m=new Mutation("a");
  m.put("b","c",new Value("v".getBytes()));
  for (int i=0; i < 3; i++) {
    bw.addMutation(m);
    bw.flush();
    c.tableOperations().flush(tableName,null,null,true);
  }
  bw.addMutation(m);
  bw.close();
  ClusterControl control=cluster.getClusterControl();
  control.stopAllServers(ServerType.TABLET_SERVER);
  control.startAllServers(ServerType.TABLET_SERVER);
  Iterators.size(c.createScanner(tableName,Authorizations.EMPTY).iterator());
  Scanner s=c.createScanner(MetadataTable.NAME,Authorizations.EMPTY);
  s.fetchColumnFamily(MetadataSchema.TabletsSection.DataFileColumnFamily.NAME);
  for (  Entry<Key,Value> entry : s) {
    String filename=entry.getKey().getColumnQualifier().toString();
    String parts[]=filename.split("/");
    Assert.assertFalse(parts[parts.length - 1].startsWith("M"));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.RewriteTabletDirectoriesIT </h4><pre class="type-9 type-5 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test() throws Exception {
  Connector c=getConnector();
  c.securityOperations().grantTablePermission(c.whoami(),MetadataTable.NAME,TablePermission.WRITE);
  final String tableName=getUniqueNames(1)[0];
  c.tableOperations().create(tableName);
  BatchWriter bw=c.createBatchWriter(tableName,null);
  final SortedSet<Text> splits=new TreeSet<Text>();
  for (  String split : "a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z".split(",")) {
    splits.add(new Text(split));
    Mutation m=new Mutation(new Text(split));
    m.put(new byte[]{},new byte[]{},new byte[]{});
    bw.addMutation(m);
  }
  bw.close();
  c.tableOperations().addSplits(tableName,splits);
  BatchScanner scanner=c.createBatchScanner(MetadataTable.NAME,Authorizations.EMPTY,1);
  DIRECTORY_COLUMN.fetch(scanner);
  String tableId=c.tableOperations().tableIdMap().get(tableName);
  assertNotNull("TableID for " + tableName + " was null",tableId);
  scanner.setRanges(Collections.singletonList(TabletsSection.getRange(tableId)));
  bw=c.createBatchWriter(MetadataTable.NAME,null);
  int count=0;
  for (  Entry<Key,Value> entry : scanner) {
    assertTrue("Expected " + entry.getValue() + " to contain "+ v1,entry.getValue().toString().contains(v1.toString()));
    count++;
    if (count % 2 == 0) {
      String parts[]=entry.getValue().toString().split("/");
      Key key=entry.getKey();
      Mutation m=new Mutation(key.getRow());
      m.put(key.getColumnFamily(),key.getColumnQualifier(),new Value((Path.SEPARATOR + parts[parts.length - 1]).getBytes()));
      bw.addMutation(m);
    }
  }
  bw.close();
  assertEquals(splits.size() + 1,count);
  assertEquals(1,cluster.exec(RandomizeVolumes.class,"-z",cluster.getZooKeepers(),"-i",c.getInstance().getInstanceName(),"-t",tableName).waitFor());
  cluster.stop();
  Configuration conf=new Configuration(false);
  conf.addResource(new Path(cluster.getConfig().getConfDir().toURI().toString(),"accumulo-site.xml"));
  conf.set(Property.INSTANCE_VOLUMES.getKey(),v1.toString() + "," + v2.toString());
  BufferedOutputStream fos=new BufferedOutputStream(new FileOutputStream(new File(cluster.getConfig().getConfDir(),"accumulo-site.xml")));
  conf.writeXml(fos);
  fos.close();
  assertEquals(0,cluster.exec(Initialize.class,"--add-volumes").waitFor());
  cluster.start();
  c=getConnector();
  assertEquals(0,cluster.exec(Admin.class,"randomizeVolumes","-t",tableName).waitFor());
  int v1Count=0, v2Count=0;
  for (  Entry<Key,Value> entry : scanner) {
    if (entry.getValue().toString().contains(v1.toString())) {
      v1Count++;
    }
    if (entry.getValue().toString().contains(v2.toString())) {
      v2Count++;
    }
  }
  log.info("Count for volume1: " + v1Count);
  log.info("Count for volume2: " + v2Count);
  assertEquals(splits.size() + 1,v1Count + v2Count);
  assertTrue("Expected the number of files to differ between volumes by less than 10. " + v1Count + " "+ v2Count,Math.abs(v1Count - v2Count) < 2);
  count=0;
  for (  Entry<Key,Value> entry : c.createScanner(tableName,Authorizations.EMPTY)) {
    assertTrue("Found unexpected entry in table: " + entry,splits.contains(entry.getKey().getRow()));
    count++;
  }
  assertEquals(splits.size(),count);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.ShellServerIT </h4><pre class="type-9 type-2 type-14 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void listcompactions() throws Exception {
  final String table=name.getMethodName();
  ts.exec("createtable " + table,true);
  ts.exec("config -t " + table + " -s table.iterator.minc.slow=30,org.apache.accumulo.test.functional.SlowIterator",true);
  ts.exec("config -t " + table + " -s table.iterator.minc.slow.opt.sleepTime=1000",true);
  ts.exec("insert a cf cq value",true);
  ts.exec("insert b cf cq value",true);
  ts.exec("insert c cf cq value",true);
  ts.exec("insert d cf cq value",true);
  ts.exec("flush -t " + table,true);
  ts.exec("sleep 0.2",true);
  ts.exec("listcompactions",true,"default_tablet");
  String[] lines=ts.output.get().split("\n");
  String last=lines[lines.length - 1];
  String[] parts=last.split("\\|");
  assertEquals(12,parts.length);
  ts.exec("deletetable -f " + table,true);
}

</code></pre>

<br>
<pre class="type-9 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void egrep() throws Exception {
  final String table=name.getMethodName();
  ts.exec("createtable " + table);
  make10();
  String lines=ts.exec("egrep row[123]",true);
  assertTrue(lines.split("\n").length - 1 == 3);
  ts.exec("deletetable -f " + table);
}

</code></pre>

<br>
<pre class="type-9 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void ping() throws Exception {
  for (int i=0; i < 10; i++) {
    ts.exec("ping",true,"OK",true);
    if (ts.output.get().split("\n").length == 3)     break;
    sleepUninterruptibly(1,TimeUnit.SECONDS);
  }
  assertEquals(3,ts.output.get().split("\n").length);
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void tables() throws Exception {
  final String table=name.getMethodName(), table1=table + "_z", table2=table + "_a";
  ts.exec("createtable " + table1);
  ts.exec("createtable " + table2);
  ts.exec("notable");
  String lst=ts.exec("tables -l");
  assertTrue(lst.indexOf(table2) < lst.indexOf(table1));
  lst=ts.exec("tables -l -s");
  assertTrue(lst.indexOf(table1) < lst.indexOf(table2));
}

</code></pre>

<br>
<pre class="type-9 type-11 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
"></span><br>
@Test public void whoami() throws Exception {
  AuthenticationToken token=getToken();
  assertTrue(ts.exec("whoami",true).contains(getPrincipal()));
  if (token instanceof PasswordToken) {
    ts.input.set("secret\nsecret\n");
  }
  ts.exec("createuser test_user");
  ts.exec("setauths -u test_user -s 12,3,4");
  String auths=ts.exec("getauths -u test_user");
  assertTrue(auths.contains("3") && auths.contains("12") && auths.contains("4"));
  if (token instanceof PasswordToken) {
    ts.input.set("secret\n");
    ts.exec("user test_user",true);
    assertTrue(ts.exec("whoami",true).contains("test_user"));
    ts.input.set(getRootPassword() + "\n");
    ts.exec("user root",true);
  }
}

</code></pre>

<br>
<pre class="type-9 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void trace() throws Exception {
  final String table=name.getMethodName() + "Test";
  ts.exec("trace on",true);
  ts.exec("createtable " + table,true);
  ts.exec("insert a b c value",true);
  ts.exec("scan -np",true,"value",true);
  ts.exec("deletetable -f " + table);
  ts.exec("sleep 1");
  String trace=ts.exec("trace off");
  System.out.println(trace);
  assertTrue(trace.contains("sendMutations"));
  assertTrue(trace.contains("startScan"));
  assertTrue(trace.contains("DeleteTable"));
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void notable() throws Exception {
  final String table=name.getMethodName();
  ts.exec("createtable " + table,true);
  ts.exec("scan",true," " + table + ">",true);
  assertTrue(ts.output.get().contains(" " + table + ">"));
  ts.exec("notable",true);
  ts.exec("scan",false,"Not in a table context.",true);
  assertFalse(ts.output.get().contains(" " + table + ">"));
  ts.exec("deletetable -f " + table);
}

</code></pre>

<br>
<pre class="type-9 type-11 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void deleterows() throws Exception {
  final String table=name.getMethodName();
  ts.exec("createtable " + table);
  final String tableId=getTableId(table);
  int base=countFiles(tableId);
  assertEquals(0,base);
  log.info("Adding 2 splits");
  ts.exec("addsplits row5 row7");
  log.info("Writing 10 records");
  make10();
  log.info("Flushing table");
  ts.exec("flush -w -t " + table);
  log.info("Table flush completed");
  List<String> files=getFiles(tableId);
  if (3 < files.size()) {
    log.info("More than 3 files were found, compacting before proceeding");
    ts.exec("compact -w -t " + table);
    files=getFiles(tableId);
    assertEquals("Expected to only find 3 files after compaction: " + files,3,files.size());
  }
  assertNotNull(files);
  assertEquals("Found the following files: " + files,3,files.size());
  ts.exec("deleterows -t " + table + " -b row5 -e row7");
  assertEquals(2,countFiles(tableId));
  ts.exec("deletetable -f " + table);
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void listscans() throws Exception {
  final String table=name.getMethodName();
  ts.exec("createtable " + table,true);
  for (int i=0; i < 6; i++) {
    ts.exec("insert " + i + " cf cq value",true);
  }
  Connector connector=getConnector();
  final Scanner s=connector.createScanner(table,Authorizations.EMPTY);
  IteratorSetting cfg=new IteratorSetting(30,SlowIterator.class);
  SlowIterator.setSleepTime(cfg,500);
  s.addScanIterator(cfg);
  Thread thread=new Thread(){
    @Override public void run(){
      try {
        Iterators.size(s.iterator());
      }
 catch (      Exception ex) {
        throw new RuntimeException(ex);
      }
    }
  }
;
  thread.start();
  List<String> scans=new ArrayList<String>();
  for (int i=0; i < 50 && scans.isEmpty(); i++) {
    String currentScans=ts.exec("listscans",true);
    log.info("Got output from listscans:\n" + currentScans);
    String[] lines=currentScans.split("\n");
    for (int scanOffset=2; scanOffset < lines.length; scanOffset++) {
      String currentScan=lines[scanOffset];
      if (currentScan.contains(table)) {
        log.info("Retaining scan: " + currentScan);
        scans.add(currentScan);
      }
 else {
        log.info("Ignoring scan because of wrong table: " + currentScan);
      }
    }
    sleepUninterruptibly(300,TimeUnit.MILLISECONDS);
  }
  thread.join();
  assertFalse("Could not find any active scans over table " + table,scans.isEmpty());
  for (  String scan : scans) {
    if (!scan.contains("RUNNING")) {
      log.info("Ignoring scan because it doesn't contain 'RUNNING': " + scan);
      continue;
    }
    String parts[]=scan.split("\\|");
    assertEquals("Expected 14 colums, but found " + parts.length + " instead for '"+ Arrays.toString(parts)+ "'",14,parts.length);
    String tserver=parts[0].trim();
    String hostPortPattern=".+:\\d+";
    assertTrue(tserver.matches(hostPortPattern));
    assertTrue(getConnector().instanceOperations().getTabletServers().contains(tserver));
    String client=parts[1].trim();
    assertTrue(client + " does not match " + hostPortPattern,client.matches(hostPortPattern));
    Long.parseLong(parts[11].trim());
  }
  ts.exec("deletetable -f " + table,true);
}

</code></pre>

<br>
<pre class="type-9 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void byeQuitExit() throws Exception {
  for (  String cmd : "bye quit exit".split(" ")) {
    assertFalse(ts.shell.getExit());
    ts.exec(cmd);
    assertTrue(ts.shell.getExit());
    ts.shell.setExit(false);
  }
}

</code></pre>

<br>
<pre class="type-9 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void systempermission() throws Exception {
  ts.exec("systempermissions");
  assertEquals(12,ts.output.get().split("\n").length - 1);
  ts.exec("tablepermissions",true);
  assertEquals(6,ts.output.get().split("\n").length - 1);
}

</code></pre>

<br>
<pre class="type-9 type-5 type-21 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Sets implicit assumptions 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void badLogin() throws Exception {
  Assume.assumeTrue(getToken() instanceof PasswordToken);
  ts.input.set(getRootPassword() + "\n");
  String err=ts.exec("user NoSuchUser",false);
  assertTrue(err.contains("BAD_CREDENTIALS for user NoSuchUser"));
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompactions() throws Exception {
  final String table=name.getMethodName();
  ts.exec("createtable " + table);
  String tableId=getTableId(table);
  ts.exec("insert a b c d");
  ts.exec("flush -w");
  ts.exec("insert x y z v");
  ts.exec("flush -w");
  int oldCount=countFiles(tableId);
  ts.exec("compact -t " + table + " -w");
  assertTrue(countFiles(tableId) < oldCount);
  ts.exec("addsplits -t " + table + " f");
  ts.exec("insert m 1 2 3");
  ts.exec("flush -w");
  ts.exec("insert n 1 2 v901");
  ts.exec("flush -w");
  List<String> oldFiles=getFiles(tableId);
  assertEquals("Files that were found: " + oldFiles,4,oldFiles.size());
  ts.exec("compact -b g -e z -w");
  assertEquals(2,countFiles(tableId));
  ts.exec("compact -w");
  assertEquals(2,countFiles(tableId));
  ts.exec("merge --all -t " + table);
  ts.exec("compact -w");
  assertEquals(1,countFiles(tableId));
  ts.exec("insert z 1 2 v900");
  ts.exec("compact -w -s " + TestCompactionStrategy.class.getName() + " -sc inputPrefix=F,dropPrefix=A");
  assertEquals(1,countFiles(tableId));
  ts.exec("scan",true,"v900",true);
  ts.exec("scan",true,"v901",false);
  ts.exec("deletetable -f " + table);
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCompactionSelection() throws Exception {
  final String table=name.getMethodName();
  final String clone=table + "_clone";
  ts.exec("createtable " + table);
  ts.exec("insert a b c d");
  ts.exec("flush -w");
  ts.exec("insert x y z v");
  ts.exec("flush -w");
  ts.exec("clonetable -s " + Property.TABLE_MAJC_RATIO.getKey() + "=10 "+ table+ " "+ clone);
  ts.exec("table " + clone);
  ts.exec("insert m n l o");
  ts.exec("flush -w");
  String tableId=getTableId(table);
  String cloneId=getTableId(clone);
  assertEquals(3,countFiles(cloneId));
  ts.exec("compact -t " + clone + " -w --sf-epath .*tables/"+ tableId+ ".*");
  assertEquals(2,countFiles(cloneId));
  ts.exec("insert r s t u");
  ts.exec("flush -w");
  assertEquals(3,countFiles(cloneId));
  ts.exec("compact -t " + clone + " -w --sf-ename F.*");
  assertEquals(2,countFiles(cloneId));
  Random rand=new Random();
  StringBuilder sb=new StringBuilder("insert b v q ");
  for (int i=0; i < 10000; i++) {
    sb.append('a' + rand.nextInt(26));
  }
  ts.exec(sb.toString());
  ts.exec("flush -w");
  ts.exec(sb.toString());
  ts.exec("flush -w");
  assertEquals(4,countFiles(cloneId));
  ts.exec("compact -t " + clone + " -w --sf-lt-esize 1000");
  assertEquals(3,countFiles(cloneId));
  ts.exec("compact -t " + clone + " -w --sf-gt-esize 1K --min-files 3");
  assertEquals(3,countFiles(cloneId));
  ts.exec("compact -t " + clone + " -w --sf-gt-esize 1K --min-files 2");
  assertEquals(2,countFiles(cloneId));
  ts.exec("compact -t " + clone + " -w --min-files 3");
  assertEquals(2,countFiles(cloneId));
  ts.exec("compact -t " + clone + " -w --min-files 2");
  assertEquals(1,countFiles(cloneId));
  ts.exec(sb.toString());
  ts.exec("flush -w");
  ts.exec("insert m n l o");
  ts.exec("flush -w");
  ts.exec("insert m n l o");
  ts.exec("flush -w");
  assertEquals(4,countFiles(cloneId));
  ts.exec("compact -t " + clone + " -w --sf-ename F.* --sf-lt-esize 1K");
  assertEquals(3,countFiles(cloneId));
  String clone2=table + "_clone_2";
  ts.exec("clonetable -s table.sampler.opt.hasher=murmur3_32,table.sampler.opt.modulus=7,table.sampler=org.apache.accumulo.core.sample.RowSampler " + clone + " "+ clone2);
  String clone2Id=getTableId(clone2);
  assertEquals(3,countFiles(clone2Id));
  ts.exec("table " + clone2);
  ts.exec("insert v n l o");
  ts.exec("flush -w");
  ts.exec("insert x n l o");
  ts.exec("flush -w");
  assertEquals(5,countFiles(clone2Id));
  ts.exec("compact -t " + clone2 + " -w --sf-no-sample");
  assertEquals(3,countFiles(clone2Id));
}

</code></pre>

<br>
<pre class="type-9 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void namespaces() throws Exception {
  ts.exec("namespaces",true,"\"\"",true);
  ts.exec("namespaces",true,Namespaces.ACCUMULO_NAMESPACE,true);
  ts.exec("createnamespace thing1",true);
  String namespaces=ts.exec("namespaces");
  assertTrue(namespaces.contains("thing1"));
  ts.exec("renamenamespace thing1 thing2");
  namespaces=ts.exec("namespaces");
  assertTrue(namespaces.contains("thing2"));
  assertTrue(!namespaces.contains("thing1"));
  ts.exec("createtable thing2.thingy",true);
  ts.exec("deletenamespace thing2");
  ts.exec("y");
  ts.exec("namespaces",true,"thing2",true);
  ts.exec("du -ns thing2",true,"thing2.thingy",true);
  ts.exec("offline -ns thing2",true);
  ts.exec("online -ns thing2",true);
  ts.exec("flush -ns thing2",true);
  ts.exec("compact -ns thing2",true);
  ts.exec("createnamespace testers3",true);
  ts.exec("createtable testers3.1",true);
  ts.exec("createtable testers3.2",true);
  ts.exec("deletetable -ns testers3 -f",true);
  ts.exec("tables",true,"testers3.1",false);
  ts.exec("namespaces",true,"testers3",true);
  ts.exec("deletenamespace testers3 -f",true);
  ts.input.set("true\n\n\n\nSTRING\n");
  ts.exec("setiter -ns thing2 -scan -class org.apache.accumulo.core.iterators.user.SummingCombiner -p 10 -n name",true);
  ts.exec("listiter -ns thing2 -scan",true,"Summing",true);
  ts.exec("deleteiter -ns thing2 -n name -scan",true);
  ts.exec("createuser dude");
  ts.exec("pass");
  ts.exec("pass");
  ts.exec("grant Namespace.CREATE_TABLE -ns thing2 -u dude",true);
  ts.exec("revoke Namespace.CREATE_TABLE -ns thing2 -u dude",true);
  ts.exec("config -ns thing2 -s table.file.max=44444",true);
  ts.exec("config -ns thing2",true,"44444",true);
  ts.exec("config -t thing2.thingy",true,"44444",true);
  ts.exec("config -t thing2.thingy -s table.file.max=55555",true);
  ts.exec("config -t thing2.thingy",true,"55555",true);
  ts.exec("createnamespace thing3 -cc thing2",true);
  ts.exec("config -ns thing3",true,"44444",true);
  ts.exec("deletenamespace -f thing2",true);
  ts.exec("namespaces",true,"thing2",false);
  ts.exec("tables",true,"thing2.thingy",false);
  ts.exec("constraint -ns thing3 -a org.apache.accumulo.examples.simple.constraints.NumericValueConstraint",true);
  ts.exec("createtable thing3.constrained",true);
  ts.exec("table thing3.constrained",true);
  ts.exec("constraint -d 1");
  ts.exec("constraint -l",true,"NumericValueConstraint",true);
  ts.exec("insert r cf cq abc",false);
  ts.exec("constraint -ns thing3 -d 1");
  ts.exec("sleep 1");
  ts.exec("insert r cf cq abc",true);
}

</code></pre>

<br>
<pre class="type-9 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void user() throws Exception {
  final String table=name.getMethodName();
  final boolean kerberosEnabled=getToken() instanceof KerberosToken;
  if (!kerberosEnabled) {
    ts.input.set("secret\nsecret\n");
  }
  ts.exec("createuser xyzzy",true);
  ts.exec("users",true,"xyzzy",true);
  String perms=ts.exec("userpermissions -u xyzzy",true);
  assertTrue(perms.contains("Table permissions (" + MetadataTable.NAME + "): Table.READ"));
  ts.exec("grant -u xyzzy -s System.CREATE_TABLE",true);
  perms=ts.exec("userpermissions -u xyzzy",true);
  assertTrue(perms.contains(""));
  ts.exec("grant -u " + getPrincipal() + " -t "+ MetadataTable.NAME+ " Table.WRITE",true);
  ts.exec("grant -u " + getPrincipal() + " -t "+ MetadataTable.NAME+ " Table.GOOFY",false);
  ts.exec("grant -u " + getPrincipal() + " -s foo",false);
  ts.exec("grant -u xyzzy -t " + MetadataTable.NAME + " foo",false);
  if (!kerberosEnabled) {
    ts.input.set("secret\nsecret\n");
    ts.exec("user xyzzy",true);
    ts.exec("createtable " + table,true,"xyzzy@",true);
    ts.exec("insert row1 cf cq 1",true);
    ts.exec("scan",true,"row1",true);
    ts.exec("droptable -f " + table,true);
    ts.input.set(getRootPassword() + "\n" + getRootPassword()+ "\n");
    ts.exec("user root",true);
  }
  ts.exec("deleteuser " + getPrincipal(),false,"delete yourself",true);
  ts.exec("revoke -u xyzzy -s System.CREATE_TABLE",true);
  ts.exec("revoke -u xyzzy -s System.GOOFY",false);
  ts.exec("revoke -u xyzzy -s foo",false);
  ts.exec("revoke -u xyzzy -t " + MetadataTable.NAME + " Table.WRITE",true);
  ts.exec("revoke -u xyzzy -t " + MetadataTable.NAME + " Table.GOOFY",false);
  ts.exec("revoke -u xyzzy -t " + MetadataTable.NAME + " foo",false);
  ts.exec("deleteuser xyzzy",true,"deleteuser { xyzzy } (yes|no)?",true);
  ts.exec("deleteuser -f xyzzy",true);
  ts.exec("users",true,"xyzzy",false);
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-14 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies values related to public fields.
"></span><br>
@Test public void du() throws Exception {
  final String table=name.getMethodName();
  ts.exec("notable",true);
  ts.output.clear();
  ts.exec("du",true,"",true);
  ts.output.clear();
  ts.exec("createtable " + table);
  make10();
  ts.exec("flush -t " + table + " -w");
  ts.exec("du " + table,true," [" + table + "]",true);
  ts.output.clear();
  ts.shell.execCommand("du -h",false,false);
  String o=ts.output.get();
  assertTrue("Output did not match regex: '" + o + "'",o.matches(".*[1-9][0-9][0-9]\\s\\[" + table + "\\]\\n"));
  ts.exec("deletetable -f " + table);
}

</code></pre>

<br>
<pre class="type-9 type-8 type-5 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void scansWithClassLoaderContext() throws Exception {
  try {
    Class.forName("org.apache.accumulo.test.functional.ValueReversingIterator");
    fail("ValueReversingIterator already on the classpath");
  }
 catch (  Exception e) {
    assertTrue(true);
  }
  ts.exec("createtable t");
  make10();
  setupFakeContextPath();
  ts.exec("config -s " + Property.VFS_CONTEXT_CLASSPATH_PROPERTY + FAKE_CONTEXT+ "="+ FAKE_CONTEXT_CLASSPATH);
  ts.exec("config -t t -s table.classpath.context=" + FAKE_CONTEXT);
  ts.exec("setscaniter -n reverse -t t -p 21 -class org.apache.accumulo.test.functional.ValueReversingIterator");
  String result=ts.exec("scan -np -b row1 -e row1");
  assertEquals(2,result.split("\n").length);
  log.error(result);
  assertTrue(result.contains("value"));
  result=ts.exec("scan -np -b row3 -e row5");
  assertEquals(4,result.split("\n").length);
  assertTrue(result.contains("value"));
  result=ts.exec("scan -np -r row3");
  assertEquals(2,result.split("\n").length);
  assertTrue(result.contains("value"));
  result=ts.exec("scan -np -b row:");
  assertEquals(1,result.split("\n").length);
  result=ts.exec("scan -np -b row");
  assertEquals(11,result.split("\n").length);
  assertTrue(result.contains("value"));
  result=ts.exec("scan -np -e row:");
  assertEquals(11,result.split("\n").length);
  assertTrue(result.contains("value"));
  setupRealContextPath();
  ts.exec("config -s " + Property.VFS_CONTEXT_CLASSPATH_PROPERTY + REAL_CONTEXT+ "="+ REAL_CONTEXT_CLASSPATH);
  result=ts.exec("scan -np -b row1 -e row1 -cc " + REAL_CONTEXT);
  log.error(result);
  assertEquals(2,result.split("\n").length);
  assertTrue(result.contains("eulav"));
  assertFalse(result.contains("value"));
  result=ts.exec("scan -np -b row3 -e row5 -cc " + REAL_CONTEXT);
  assertEquals(4,result.split("\n").length);
  assertTrue(result.contains("eulav"));
  assertFalse(result.contains("value"));
  result=ts.exec("scan -np -r row3 -cc " + REAL_CONTEXT);
  assertEquals(2,result.split("\n").length);
  assertTrue(result.contains("eulav"));
  assertFalse(result.contains("value"));
  result=ts.exec("scan -np -b row: -cc " + REAL_CONTEXT);
  assertEquals(1,result.split("\n").length);
  result=ts.exec("scan -np -b row -cc " + REAL_CONTEXT);
  assertEquals(11,result.split("\n").length);
  assertTrue(result.contains("eulav"));
  assertFalse(result.contains("value"));
  result=ts.exec("scan -np -e row: -cc " + REAL_CONTEXT);
  assertEquals(11,result.split("\n").length);
  assertTrue(result.contains("eulav"));
  assertFalse(result.contains("value"));
  ts.exec("deletetable -f t");
}

</code></pre>

<br>
<pre class="type-9 type-11 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void exporttableImporttable() throws Exception {
  final String table=name.getMethodName(), table2=table + "2";
  ts.exec("createtable " + table + " -evc",true);
  make10();
  ts.exec("addsplits row5",true);
  ts.exec("config -t " + table + " -s table.split.threshold=345M",true);
  ts.exec("offline " + table,true);
  File exportDir=new File(rootPath,"ShellServerIT.export");
  String exportUri="file://" + exportDir.toString();
  String localTmp="file://" + new File(rootPath,"ShellServerIT.tmp").toString();
  ts.exec("exporttable -t " + table + " "+ exportUri,true);
  DistCp cp=newDistCp(new Configuration(false));
  String import_="file://" + new File(rootPath,"ShellServerIT.import").toString();
  if (getCluster().getClientConfig().getBoolean(ClientProperty.INSTANCE_RPC_SASL_ENABLED.getKey(),false)) {
    FileSystem fs=getCluster().getFileSystem();
    FileSystem localFs=FileSystem.getLocal(new Configuration(false));
    Path localTmpPath=new Path(localTmp);
    localFs.mkdirs(localTmpPath);
    Path importDir=new Path(import_);
    fs.mkdirs(importDir);
    try (BufferedReader reader=new BufferedReader(new FileReader(new File(exportDir,"distcp.txt")))){
      for (String line; (line=reader.readLine()) != null; ) {
        Path exportedFile=new Path(line);
        log.info("Copying " + line + " to "+ localTmpPath);
        fs.copyToLocalFile(exportedFile,localTmpPath);
        Path tmpFile=new Path(localTmpPath,exportedFile.getName());
        log.info("Moving " + tmpFile + " to the import directory "+ importDir);
        fs.moveFromLocalFile(tmpFile,importDir);
      }
    }
   }
 else {
    String[] distCpArgs=new String[]{"-f",exportUri + "/distcp.txt",import_};
    assertEquals("Failed to run distcp: " + Arrays.toString(distCpArgs),0,cp.run(distCpArgs));
  }
  ts.exec("importtable " + table2 + " "+ import_,true);
  ts.exec("config -t " + table2 + " -np",true,"345M",true);
  ts.exec("getsplits -t " + table2,true,"row5",true);
  ts.exec("constraint --list -t " + table2,true,"VisibilityConstraint=2",true);
  ts.exec("online " + table,true);
  ts.exec("deletetable -f " + table,true);
  ts.exec("deletetable -f " + table2,true);
}

</code></pre>

<br>
<pre class="type-9 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void merge() throws Exception {
  final String table=name.getMethodName();
  ts.exec("createtable " + table);
  ts.exec("addsplits a m z");
  ts.exec("getsplits",true,"z",true);
  ts.exec("merge --all",true);
  ts.exec("getsplits",true,"z",false);
  ts.exec("deletetable -f " + table);
  ts.exec("getsplits -t " + MetadataTable.NAME + "",true);
  assertEquals(2,ts.output.get().split("\n").length);
  ts.exec("getsplits -t accumulo.root",true);
  assertEquals(1,ts.output.get().split("\n").length);
  ts.exec("merge --all -t " + MetadataTable.NAME + "");
  ts.exec("getsplits -t " + MetadataTable.NAME + "",true);
  assertEquals(1,ts.output.get().split("\n").length);
}

</code></pre>

<br>
<pre class="type-9 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void scans() throws Exception {
  ts.exec("createtable t");
  make10();
  String result=ts.exec("scan -np -b row1 -e row1");
  assertEquals(2,result.split("\n").length);
  result=ts.exec("scan -np -b row3 -e row5");
  assertEquals(4,result.split("\n").length);
  result=ts.exec("scan -np -r row3");
  assertEquals(2,result.split("\n").length);
  result=ts.exec("scan -np -b row:");
  assertEquals(1,result.split("\n").length);
  result=ts.exec("scan -np -b row");
  assertEquals(11,result.split("\n").length);
  result=ts.exec("scan -np -e row:");
  assertEquals(11,result.split("\n").length);
  ts.exec("deletetable -f t");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.TableConfigurationUpdateIT </h4><pre class="type-9 type-11 type-8 type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test() throws Exception {
  Connector conn=getConnector();
  Instance inst=conn.getInstance();
  String table=getUniqueNames(1)[0];
  conn.tableOperations().create(table);
  final NamespaceConfiguration defaultConf=new NamespaceConfiguration(Namespaces.DEFAULT_NAMESPACE_ID,inst,AccumuloConfiguration.getDefaultConfiguration());
  int randomMax=4;
  int numThreads=2;
  int iterations=100000;
  AccumuloConfiguration tableConf=new TableConfiguration(inst,table,defaultConf);
  long start=System.currentTimeMillis();
  ExecutorService svc=Executors.newFixedThreadPool(numThreads);
  CountDownLatch countDown=new CountDownLatch(numThreads);
  ArrayList<Future<Exception>> futures=new ArrayList<Future<Exception>>(numThreads);
  for (int i=0; i < numThreads; i++) {
    futures.add(svc.submit(new TableConfRunner(randomMax,iterations,tableConf,countDown)));
  }
  svc.shutdown();
  Assert.assertTrue(svc.awaitTermination(60,TimeUnit.MINUTES));
  for (  Future<Exception> fut : futures) {
    Exception e=fut.get();
    if (null != e) {
      Assert.fail("Thread failed with exception " + e);
    }
  }
  long end=System.currentTimeMillis();
  log.debug(tableConf + " with " + iterations+ " iterations and "+ numThreads+ " threads and cache invalidates "+ ((1. / randomMax) * 100.)+ "% took "+ (end - start) / 1000 + " second(s)");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.TableOperationsIT </h4><pre class="type-9 type-8 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void getDiskUsageErrors() throws TableExistsException, AccumuloException, AccumuloSecurityException, TableNotFoundException, TException {
  String tableName=getUniqueNames(1)[0];
  connector.tableOperations().create(tableName);
  List<DiskUsage> diskUsage=connector.tableOperations().getDiskUsage(Collections.singleton(tableName));
  assertEquals(1,diskUsage.size());
  assertEquals(0,(long)diskUsage.get(0).getUsage());
  assertEquals(tableName,diskUsage.get(0).getTables().iterator().next());
  connector.securityOperations().revokeTablePermission(getAdminPrincipal(),tableName,TablePermission.READ);
  try {
    connector.tableOperations().getDiskUsage(Collections.singleton(tableName));
    fail("Should throw securityexception");
  }
 catch (  AccumuloSecurityException e) {
  }
  connector.tableOperations().delete(tableName);
  try {
    connector.tableOperations().getDiskUsage(Collections.singleton(tableName));
    fail("Should throw tablenotfound");
  }
 catch (  TableNotFoundException e) {
  }
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void createMergeClonedTable() throws Exception {
  String[] names=getUniqueNames(2);
  String originalTable=names[0];
  TableOperations tops=connector.tableOperations();
  TreeSet<Text> splits=Sets.newTreeSet(Arrays.asList(new Text("a"),new Text("b"),new Text("c"),new Text("d")));
  tops.create(originalTable);
  tops.addSplits(originalTable,splits);
  BatchWriter bw=connector.createBatchWriter(originalTable,new BatchWriterConfig());
  for (  Text row : splits) {
    Mutation m=new Mutation(row);
    for (int i=0; i < 10; i++) {
      for (int j=0; j < 10; j++) {
        m.put(Integer.toString(i),Integer.toString(j),Integer.toString(i + j));
      }
    }
    bw.addMutation(m);
  }
  bw.close();
  String clonedTable=names[1];
  tops.clone(originalTable,clonedTable,true,null,null);
  tops.merge(clonedTable,null,new Text("b"));
  Map<String,Integer> rowCounts=new HashMap<>();
  Scanner s=connector.createScanner(clonedTable,new Authorizations());
  for (  Entry<Key,Value> entry : s) {
    final Key key=entry.getKey();
    String row=key.getRow().toString();
    String cf=key.getColumnFamily().toString(), cq=key.getColumnQualifier().toString();
    String value=entry.getValue().toString();
    if (rowCounts.containsKey(row)) {
      rowCounts.put(row,rowCounts.get(row) + 1);
    }
 else {
      rowCounts.put(row,1);
    }
    Assert.assertEquals(Integer.parseInt(cf) + Integer.parseInt(cq),Integer.parseInt(value));
  }
  Collection<Text> clonedSplits=tops.listSplits(clonedTable);
  Set<Text> expectedSplits=Sets.newHashSet(new Text("b"),new Text("c"),new Text("d"));
  for (  Text clonedSplit : clonedSplits) {
    Assert.assertTrue("Encountered unexpected split on the cloned table: " + clonedSplit,expectedSplits.remove(clonedSplit));
  }
  Assert.assertTrue("Did not find all expected splits on the cloned table: " + expectedSplits,expectedSplits.isEmpty());
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void createTable() throws TableExistsException, AccumuloException, AccumuloSecurityException, TableNotFoundException {
  String tableName=getUniqueNames(1)[0];
  connector.tableOperations().create(tableName);
  Iterable<Map.Entry<String,String>> itrProps=connector.tableOperations().getProperties(tableName);
  Map<String,String> props=propsToMap(itrProps);
  assertEquals(DefaultKeySizeConstraint.class.getName(),props.get(Property.TABLE_CONSTRAINT_PREFIX.toString() + "1"));
  connector.tableOperations().delete(tableName);
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void getDiskUsage() throws TableExistsException, AccumuloException, AccumuloSecurityException, TableNotFoundException, TException {
  final String[] names=getUniqueNames(2);
  String tableName=names[0];
  connector.tableOperations().create(tableName);
  List<DiskUsage> diskUsages=connector.tableOperations().getDiskUsage(Collections.singleton(tableName));
  assertEquals(1,diskUsages.size());
  assertEquals(1,diskUsages.get(0).getTables().size());
  assertEquals(Long.valueOf(0),diskUsages.get(0).getUsage());
  assertEquals(tableName,diskUsages.get(0).getTables().first());
  BatchWriter bw=connector.createBatchWriter(tableName,new BatchWriterConfig());
  Mutation m=new Mutation("a");
  m.put("b","c",new Value("abcde".getBytes()));
  bw.addMutation(m);
  bw.flush();
  bw.close();
  connector.tableOperations().compact(tableName,new Text("A"),new Text("z"),true,true);
  diskUsages=connector.tableOperations().getDiskUsage(Collections.singleton(tableName));
  assertEquals(1,diskUsages.size());
  assertEquals(1,diskUsages.get(0).getTables().size());
  assertTrue(diskUsages.get(0).getUsage() > 0);
  assertEquals(tableName,diskUsages.get(0).getTables().first());
  String newTable=names[1];
  connector.tableOperations().clone(tableName,newTable,false,null,null);
  Set<String> tables=new HashSet<String>();
  tables.add(tableName);
  tables.add(newTable);
  diskUsages=connector.tableOperations().getDiskUsage(tables);
  assertEquals(1,diskUsages.size());
  assertEquals(2,diskUsages.get(0).getTables().size());
  assertTrue(diskUsages.get(0).getUsage() > 0);
  connector.tableOperations().compact(tableName,new Text("A"),new Text("z"),true,true);
  connector.tableOperations().compact(newTable,new Text("A"),new Text("z"),true,true);
  diskUsages=connector.tableOperations().getDiskUsage(tables);
  assertEquals(2,diskUsages.size());
  assertEquals(1,diskUsages.get(0).getTables().size());
  assertEquals(1,diskUsages.get(1).getTables().size());
  assertTrue(diskUsages.get(0).getUsage() > 0);
  assertTrue(diskUsages.get(1).getUsage() > 0);
  connector.tableOperations().delete(tableName);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.TracerRecoversAfterOfflineTableIT </h4><pre class="type-9 type-13 type-11 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
"></span><br>
@Test public void test() throws Exception {
  Process tracer=null;
  Connector conn=getConnector();
  if (!conn.tableOperations().exists("trace")) {
    MiniAccumuloClusterImpl mac=cluster;
    tracer=mac.exec(TraceServer.class);
    while (!conn.tableOperations().exists("trace")) {
      sleepUninterruptibly(1,TimeUnit.SECONDS);
    }
    sleepUninterruptibly(5,TimeUnit.SECONDS);
  }
  log.info("Taking table offline");
  conn.tableOperations().offline("trace",true);
  String tableName=getUniqueNames(1)[0];
  conn.tableOperations().create(tableName);
  log.info("Start a distributed trace span");
  DistributedTrace.enable("localhost","testTrace",getClientConfig());
  Span root=Trace.on("traceTest");
  BatchWriter bw=conn.createBatchWriter(tableName,null);
  Mutation m=new Mutation("m");
  m.put("a","b","c");
  bw.addMutation(m);
  bw.close();
  root.stop();
  log.info("Bringing trace table back online");
  conn.tableOperations().online("trace",true);
  log.info("Trace table is online, should be able to find trace");
  final Scanner scanner=conn.createScanner("trace",Authorizations.EMPTY);
  scanner.setRange(new Range(new Text(Long.toHexString(root.traceId()))));
  while (true) {
    final StringBuilder finalBuffer=new StringBuilder();
    int traceCount=TraceDump.printTrace(scanner,new Printer(){
      @Override public void print(      final String line){
        try {
          finalBuffer.append(line).append("\n");
        }
 catch (        Exception ex) {
          throw new RuntimeException(ex);
        }
      }
    }
);
    String traceOutput=finalBuffer.toString();
    log.info("Trace output:" + traceOutput);
    if (traceCount > 0) {
      int lastPos=0;
      for (      String part : "traceTest,close,binMutations".split(",")) {
        log.info("Looking in trace output for '" + part + "'");
        int pos=traceOutput.indexOf(part);
        assertTrue("Did not find '" + part + "' in output",pos > 0);
        assertTrue("'" + part + "' occurred earlier than the previous element unexpectedly",pos > lastPos);
        lastPos=pos;
      }
      break;
    }
 else {
      log.info("Ignoring trace output as traceCount not greater than zero: " + traceCount);
      Thread.sleep(1000);
    }
  }
  if (tracer != null) {
    tracer.destroy();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.VolumeIT </h4><pre class="type-9 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test() throws Exception {
  Connector connector=getConnector();
  String tableName=getUniqueNames(1)[0];
  connector.tableOperations().create(tableName);
  SortedSet<Text> partitions=new TreeSet<Text>();
  for (  String s : "d,m,t".split(","))   partitions.add(new Text(s));
  connector.tableOperations().addSplits(tableName,partitions);
  BatchWriter bw=connector.createBatchWriter(tableName,new BatchWriterConfig());
  String[] rows="a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z".split(",");
  for (  String s : rows) {
    Mutation m=new Mutation(new Text(s));
    m.put(EMPTY,EMPTY,EMPTY_VALUE);
    bw.addMutation(m);
  }
  bw.close();
  connector.tableOperations().flush(tableName,null,null,true);
  Scanner scanner=connector.createScanner(tableName,Authorizations.EMPTY);
  int i=0;
  for (  Entry<Key,Value> entry : scanner) {
    assertEquals(rows[i++],entry.getKey().getRow().toString());
  }
  scanner=connector.createScanner(MetadataTable.NAME,Authorizations.EMPTY);
  scanner.setRange(new Range("1","1<"));
  scanner.fetchColumnFamily(DataFileColumnFamily.NAME);
  int fileCount=0;
  for (  Entry<Key,Value> entry : scanner) {
    boolean inV1=entry.getKey().getColumnQualifier().toString().contains(v1.toString());
    boolean inV2=entry.getKey().getColumnQualifier().toString().contains(v2.toString());
    assertTrue(inV1 || inV2);
    fileCount++;
  }
  assertEquals(4,fileCount);
  List<DiskUsage> diskUsage=connector.tableOperations().getDiskUsage(Collections.singleton(tableName));
  assertEquals(1,diskUsage.size());
  long usage=diskUsage.get(0).getUsage().longValue();
  log.debug("usage {}",usage);
  assertTrue(usage > 700 && usage < 800);
}

</code></pre>

<br>
<pre class="type-9 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testRelativePaths() throws Exception {
  List<String> expected=new ArrayList<String>();
  Connector connector=getConnector();
  String tableName=getUniqueNames(1)[0];
  connector.tableOperations().create(tableName,new NewTableConfiguration().withoutDefaultIterators());
  String tableId=connector.tableOperations().tableIdMap().get(tableName);
  SortedSet<Text> partitions=new TreeSet<Text>();
  for (  String s : "c,g,k,p,s,v".split(","))   partitions.add(new Text(s));
  connector.tableOperations().addSplits(tableName,partitions);
  BatchWriter bw=connector.createBatchWriter(tableName,new BatchWriterConfig());
  String[] rows="a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z".split(",");
  for (  String s : rows) {
    Mutation m=new Mutation(s);
    m.put("cf1","cq1","1");
    bw.addMutation(m);
    expected.add(s + ":cf1:cq1:1");
  }
  bw.flush();
  connector.tableOperations().flush(tableName,null,null,true);
  for (  String s : rows) {
    Mutation m=new Mutation(s);
    m.put("cf1","cq1","2");
    bw.addMutation(m);
    expected.add(s + ":cf1:cq1:2");
  }
  bw.close();
  connector.tableOperations().flush(tableName,null,null,true);
  verifyData(expected,connector.createScanner(tableName,Authorizations.EMPTY));
  connector.tableOperations().offline(tableName,true);
  connector.securityOperations().grantTablePermission("root",MetadataTable.NAME,TablePermission.WRITE);
  Scanner metaScanner=connector.createScanner(MetadataTable.NAME,Authorizations.EMPTY);
  metaScanner.fetchColumnFamily(MetadataSchema.TabletsSection.DataFileColumnFamily.NAME);
  metaScanner.setRange(new KeyExtent(new Text(tableId),null,null).toMetadataRange());
  BatchWriter mbw=connector.createBatchWriter(MetadataTable.NAME,new BatchWriterConfig());
  for (  Entry<Key,Value> entry : metaScanner) {
    String cq=entry.getKey().getColumnQualifier().toString();
    if (cq.startsWith(v1.toString())) {
      Path path=new Path(cq);
      String relPath="/" + path.getParent().getName() + "/"+ path.getName();
      Mutation fileMut=new Mutation(entry.getKey().getRow());
      fileMut.putDelete(entry.getKey().getColumnFamily(),entry.getKey().getColumnQualifier());
      fileMut.put(entry.getKey().getColumnFamily().toString(),relPath,entry.getValue().toString());
      mbw.addMutation(fileMut);
    }
  }
  mbw.close();
  connector.tableOperations().online(tableName,true);
  verifyData(expected,connector.createScanner(tableName,Authorizations.EMPTY));
  connector.tableOperations().compact(tableName,null,null,true,true);
  verifyData(expected,connector.createScanner(tableName,Authorizations.EMPTY));
  for (  Entry<Key,Value> entry : metaScanner) {
    String cq=entry.getKey().getColumnQualifier().toString();
    Path path=new Path(cq);
    Assert.assertTrue("relative path not deleted " + path.toString(),path.depth() > 2);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.fate.zookeeper.ZooLockTest </h4><pre class="type-9 type-5 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=10000) public void testDeleteWaiting() throws Exception {
  String parent="/zltest-" + this.hashCode() + "-l"+ pdCount.incrementAndGet();
  ZooReaderWriter zk=ZooReaderWriter.getInstance(accumulo.getZooKeepers(),30000,"digest","secret".getBytes());
  zk.mkdirs(parent);
  ZooLock zl=new ZooLock(accumulo.getZooKeepers(),30000,"digest","secret".getBytes(),parent);
  Assert.assertFalse(zl.isLocked());
  TestALW lw=new TestALW();
  zl.lockAsync(lw,"test1".getBytes());
  lw.waitForChanges(1);
  Assert.assertTrue(lw.locked);
  Assert.assertTrue(zl.isLocked());
  Assert.assertNull(lw.exception);
  Assert.assertNull(lw.reason);
  ZooLock zl2=new ZooLock(accumulo.getZooKeepers(),30000,"digest","secret".getBytes(),parent);
  TestALW lw2=new TestALW();
  zl2.lockAsync(lw2,"test2".getBytes());
  Assert.assertFalse(lw2.locked);
  Assert.assertFalse(zl2.isLocked());
  ZooLock zl3=new ZooLock(accumulo.getZooKeepers(),30000,"digest","secret".getBytes(),parent);
  TestALW lw3=new TestALW();
  zl3.lockAsync(lw3,"test3".getBytes());
  List<String> children=zk.getChildren(parent);
  Collections.sort(children);
  zk.delete(parent + "/" + children.get(1),-1);
  lw2.waitForChanges(1);
  Assert.assertFalse(lw2.locked);
  Assert.assertNotNull(lw2.exception);
  Assert.assertNull(lw2.reason);
  zk.delete(parent + "/" + children.get(0),-1);
  lw.waitForChanges(2);
  Assert.assertEquals(LockLossReason.LOCK_DELETED,lw.reason);
  Assert.assertNull(lw.exception);
  lw3.waitForChanges(1);
  Assert.assertTrue(lw3.locked);
  Assert.assertTrue(zl3.isLocked());
  Assert.assertNull(lw3.exception);
  Assert.assertNull(lw3.reason);
  zl3.unlock();
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test(timeout=10000) public void testTryLock() throws Exception {
  String parent="/zltest-" + this.hashCode() + "-l"+ pdCount.incrementAndGet();
  ZooLock zl=new ZooLock(accumulo.getZooKeepers(),1000,"digest","secret".getBytes(),parent);
  ConnectedWatcher watcher=new ConnectedWatcher();
  ZooKeeper zk=new ZooKeeper(accumulo.getZooKeepers(),1000,watcher);
  zk.addAuthInfo("digest","secret".getBytes());
  while (!watcher.isConnected()) {
    Thread.sleep(200);
  }
  for (int i=0; i < 10; i++) {
    zk.create(parent,new byte[0],ZooDefs.Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
    zk.delete(parent,-1);
  }
  zk.create(parent,new byte[0],ZooDefs.Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  TestALW lw=new TestALW();
  boolean ret=zl.tryLock(lw,"test1".getBytes());
  Assert.assertTrue(ret);
synchronized (zl) {
    Field field=zl.getClass().getDeclaredField("watchingParent");
    field.setAccessible(true);
    Assert.assertTrue((Boolean)field.get(zl));
  }
  zl.unlock();
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=10000) public void testNoParent() throws Exception {
  String parent="/zltest-" + this.hashCode() + "-l"+ pdCount.incrementAndGet();
  ZooLock zl=new ZooLock(accumulo.getZooKeepers(),30000,"digest","secret".getBytes(),parent);
  Assert.assertFalse(zl.isLocked());
  TestALW lw=new TestALW();
  zl.lockAsync(lw,"test1".getBytes());
  lw.waitForChanges(1);
  Assert.assertFalse(lw.locked);
  Assert.assertFalse(zl.isLocked());
  Assert.assertNotNull(lw.exception);
  Assert.assertNull(lw.reason);
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=10000) public void testUnexpectedEvent() throws Exception {
  String parent="/zltest-" + this.hashCode() + "-l"+ pdCount.incrementAndGet();
  ConnectedWatcher watcher=new ConnectedWatcher();
  ZooKeeper zk=new ZooKeeper(accumulo.getZooKeepers(),30000,watcher);
  zk.addAuthInfo("digest","secret".getBytes());
  while (!watcher.isConnected()) {
    Thread.sleep(200);
  }
  zk.create(parent,new byte[0],ZooDefs.Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  ZooLock zl=new ZooLock(accumulo.getZooKeepers(),30000,"digest","secret".getBytes(),parent);
  Assert.assertFalse(zl.isLocked());
  zk.setData(parent,"foo".getBytes(),-1);
  TestALW lw=new TestALW();
  zl.lockAsync(lw,"test1".getBytes());
  lw.waitForChanges(1);
  Assert.assertTrue(lw.locked);
  Assert.assertTrue(zl.isLocked());
  Assert.assertNull(lw.exception);
  Assert.assertNull(lw.reason);
  zk.setData(zl.getLockPath(),"bar".getBytes(),-1);
  zk.delete(zl.getLockPath(),-1);
  lw.waitForChanges(2);
  Assert.assertEquals(LockLossReason.LOCK_DELETED,lw.reason);
  Assert.assertNull(lw.exception);
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=10000) public void testDeleteParent() throws Exception {
  String parent="/zltest-" + this.hashCode() + "-l"+ pdCount.incrementAndGet();
  ZooLock zl=new ZooLock(accumulo.getZooKeepers(),30000,"digest","secret".getBytes(),parent);
  Assert.assertFalse(zl.isLocked());
  ZooReaderWriter zk=ZooReaderWriter.getInstance(accumulo.getZooKeepers(),30000,"digest","secret".getBytes());
  zk.mkdirs(parent);
  zk.delete(parent,-1);
  zk.mkdirs(parent);
  TestALW lw=new TestALW();
  zl.lockAsync(lw,"test1".getBytes());
  lw.waitForChanges(1);
  Assert.assertTrue(lw.locked);
  Assert.assertTrue(zl.isLocked());
  Assert.assertNull(lw.exception);
  Assert.assertNull(lw.reason);
  zl.unlock();
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=10000) public void testDeleteLock() throws Exception {
  String parent="/zltest-" + this.hashCode() + "-l"+ pdCount.incrementAndGet();
  ZooReaderWriter zk=ZooReaderWriter.getInstance(accumulo.getZooKeepers(),30000,"digest","secret".getBytes());
  zk.mkdirs(parent);
  ZooLock zl=new ZooLock(accumulo.getZooKeepers(),30000,"digest","secret".getBytes(),parent);
  Assert.assertFalse(zl.isLocked());
  TestALW lw=new TestALW();
  zl.lockAsync(lw,"test1".getBytes());
  lw.waitForChanges(1);
  Assert.assertTrue(lw.locked);
  Assert.assertTrue(zl.isLocked());
  Assert.assertNull(lw.exception);
  Assert.assertNull(lw.reason);
  zk.delete(zl.getLockPath(),-1);
  lw.waitForChanges(2);
  Assert.assertEquals(LockLossReason.LOCK_DELETED,lw.reason);
  Assert.assertNull(lw.exception);
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test(timeout=10000) public void testChangeData() throws Exception {
  String parent="/zltest-" + this.hashCode() + "-l"+ pdCount.incrementAndGet();
  ConnectedWatcher watcher=new ConnectedWatcher();
  ZooKeeper zk=new ZooKeeper(accumulo.getZooKeepers(),1000,watcher);
  zk.addAuthInfo("digest","secret".getBytes());
  while (!watcher.isConnected()) {
    Thread.sleep(200);
  }
  zk.create(parent,new byte[0],ZooDefs.Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  ZooLock zl=new ZooLock(accumulo.getZooKeepers(),1000,"digest","secret".getBytes(),parent);
  TestALW lw=new TestALW();
  zl.lockAsync(lw,"test1".getBytes());
  Assert.assertEquals("test1",new String(zk.getData(zl.getLockPath(),null,null)));
  zl.replaceLockData("test2".getBytes());
  Assert.assertEquals("test2",new String(zk.getData(zl.getLockPath(),null,null)));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.functional.CleanTmpIT </h4><pre class="type-9 type-5 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test() throws Exception {
  Connector c=getConnector();
  String tableName=getUniqueNames(1)[0];
  c.tableOperations().create(tableName);
  BatchWriter bw=c.createBatchWriter(tableName,new BatchWriterConfig());
  Mutation m=new Mutation("row");
  m.put("cf","cq","value");
  bw.addMutation(m);
  bw.flush();
  c.tableOperations().compact(tableName,null,null,true,true);
  m=new Mutation("row2");
  m.put("cf","cq","value");
  bw.addMutation(m);
  bw.close();
  String id=c.tableOperations().tableIdMap().get(tableName);
  Scanner s=c.createScanner(MetadataTable.NAME,Authorizations.EMPTY);
  s.setRange(Range.prefix(id));
  s.fetchColumnFamily(MetadataSchema.TabletsSection.DataFileColumnFamily.NAME);
  Entry<Key,Value> entry=Iterables.getOnlyElement(s);
  Path file=new Path(entry.getKey().getColumnQualifier().toString());
  FileSystem fs=getCluster().getFileSystem();
  assertTrue("Could not find file: " + file,fs.exists(file));
  Path tabletDir=file.getParent();
  assertNotNull("Tablet dir should not be null",tabletDir);
  Path tmp=new Path(tabletDir,"junk.rf_tmp");
  fs.create(tmp).close();
  log.info("Created tmp file {}",tmp.toString());
  getCluster().stop();
  getCluster().start();
  Scanner scanner=c.createScanner(tableName,Authorizations.EMPTY);
  assertEquals(2,Iterators.size(scanner.iterator()));
  assertFalse("File still exists: " + tmp,fs.exists(tmp));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.functional.CloneTestIT </h4><pre class="type-9 type-11 type-5 type-3 type-21 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeleteClone() throws Exception {
  String[] tableNames=getUniqueNames(3);
  String table1=tableNames[0];
  String table2=tableNames[1];
  String table3=tableNames[2];
  Connector c=getConnector();
  AccumuloCluster cluster=getCluster();
  Assume.assumeTrue(cluster instanceof MiniAccumuloClusterImpl);
  MiniAccumuloClusterImpl mac=(MiniAccumuloClusterImpl)cluster;
  String rootPath=mac.getConfig().getDir().getAbsolutePath();
  c.tableOperations().create(table3);
  writeData(table3,c).close();
  c.tableOperations().flush(table3,null,null,true);
  FileSystem fs=getCluster().getFileSystem();
  String id=c.tableOperations().tableIdMap().get(table3);
  FileStatus[] status=fs.listStatus(new Path(rootPath + "/accumulo/tables/" + id));
  assertTrue(status.length > 0);
  List<DiskUsage> diskUsage=c.tableOperations().getDiskUsage(Collections.singleton(table3));
  assertEquals(1,diskUsage.size());
  assertTrue(diskUsage.get(0).getUsage() > 100);
  c.tableOperations().delete(table3);
  Path tablePath=new Path(rootPath + "/accumulo/tables/" + id);
  if (fs.exists(tablePath)) {
    status=fs.listStatus(tablePath);
    assertTrue(status == null || status.length == 0);
  }
  c.tableOperations().create(table1);
  BatchWriter bw=writeData(table1,c);
  Map<String,String> props=new HashMap<String,String>();
  props.put(Property.TABLE_FILE_COMPRESSED_BLOCK_SIZE.getKey(),"500K");
  Set<String> exclude=new HashSet<String>();
  exclude.add(Property.TABLE_FILE_MAX.getKey());
  c.tableOperations().clone(table1,table2,true,props,exclude);
  Mutation m3=new Mutation("009");
  m3.put("data","x","1");
  m3.put("data","y","2");
  bw.addMutation(m3);
  bw.close();
  c.tableOperations().delete(table1);
  checkData(table2,c);
  c.tableOperations().compact(table2,null,null,true,true);
  checkData(table2,c);
  c.tableOperations().delete(table2);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.functional.CompactionIT </h4><pre class="type-9 type-13 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void test() throws Exception {
  final Connector c=getConnector();
  final String tableName=getUniqueNames(1)[0];
  c.tableOperations().create(tableName);
  c.tableOperations().setProperty(tableName,Property.TABLE_MAJC_RATIO.getKey(),"1.0");
  FileSystem fs=getFileSystem();
  Path root=new Path(cluster.getTemporaryPath(),getClass().getName());
  Path testrf=new Path(root,"testrf");
  FunctionalTestUtils.createRFiles(c,fs,testrf.toString(),500000,59,4);
  FunctionalTestUtils.bulkImport(c,fs,tableName,testrf.toString());
  int beforeCount=countFiles(c);
  final AtomicBoolean fail=new AtomicBoolean(false);
  final ClientConfiguration clientConf=cluster.getClientConfig();
  final int THREADS=5;
  for (int count=0; count < THREADS; count++) {
    ExecutorService executor=Executors.newFixedThreadPool(THREADS);
    final int span=500000 / 59;
    for (int i=0; i < 500000; i+=500000 / 59) {
      final int finalI=i;
      Runnable r=new Runnable(){
        @Override public void run(){
          try {
            VerifyIngest.Opts opts=new VerifyIngest.Opts();
            opts.startRow=finalI;
            opts.rows=span;
            opts.random=56;
            opts.dataSize=50;
            opts.cols=1;
            opts.setTableName(tableName);
            if (clientConf.getBoolean(ClientProperty.INSTANCE_RPC_SASL_ENABLED.getKey(),false)) {
              opts.updateKerberosCredentials(clientConf);
            }
 else {
              opts.setPrincipal(getAdminPrincipal());
              PasswordToken passwordToken=(PasswordToken)getAdminToken();
              opts.setPassword(new Password(new String(passwordToken.getPassword(),UTF_8)));
            }
            VerifyIngest.verifyIngest(c,opts,new ScannerOpts());
          }
 catch (          Exception ex) {
            log.warn("Got exception verifying data",ex);
            fail.set(true);
          }
        }
      }
;
      executor.execute(r);
    }
    executor.shutdown();
    executor.awaitTermination(defaultTimeoutSeconds(),TimeUnit.SECONDS);
    assertFalse("Failed to successfully run all threads, Check the test output for error",fail.get());
  }
  int finalCount=countFiles(c);
  assertTrue(finalCount < beforeCount);
  try {
    getClusterControl().adminStopAll();
  }
  finally {
    getCluster().stop();
    if (ClusterType.STANDALONE == getClusterType()) {
      getCluster().start();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.functional.CreateAndUseIT </h4><pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void createTableAndBatchScan() throws Exception {
  ArrayList<Range> ranges=new ArrayList<Range>();
  for (int i=1; i < 257; i++) {
    ranges.add(new Range(new Text(String.format("%08x",(i << 8) - 16))));
  }
  String table3=getUniqueNames(1)[0];
  getConnector().tableOperations().create(table3);
  getConnector().tableOperations().addSplits(table3,splits);
  BatchScanner bs=getConnector().createBatchScanner(table3,Authorizations.EMPTY,3);
  bs.setRanges(ranges);
  Iterator<Entry<Key,Value>> iter=bs.iterator();
  int count=Iterators.size(iter);
  bs.close();
  Assert.assertEquals("Did not expect to find any entries",0,count);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.functional.DeleteEverythingIT </h4><pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void run() throws Exception {
  Connector c=getConnector();
  String tableName=getUniqueNames(1)[0];
  c.tableOperations().create(tableName);
  BatchWriter bw=getConnector().createBatchWriter(tableName,new BatchWriterConfig());
  Mutation m=new Mutation(new Text("foo"));
  m.put(new Text("bar"),new Text("1910"),new Value("5".getBytes(UTF_8)));
  bw.addMutation(m);
  bw.flush();
  getConnector().tableOperations().flush(tableName,null,null,true);
  FunctionalTestUtils.checkRFiles(c,tableName,1,1,1,1);
  m=new Mutation(new Text("foo"));
  m.putDelete(new Text("bar"),new Text("1910"));
  bw.addMutation(m);
  bw.flush();
  Scanner scanner=getConnector().createScanner(tableName,Authorizations.EMPTY);
  scanner.setRange(new Range());
  int count=Iterators.size(scanner.iterator());
  assertEquals("count == " + count,0,count);
  getConnector().tableOperations().flush(tableName,null,null,true);
  getConnector().tableOperations().setProperty(tableName,Property.TABLE_MAJC_RATIO.getKey(),"1.0");
  sleepUninterruptibly(4,TimeUnit.SECONDS);
  FunctionalTestUtils.checkRFiles(c,tableName,1,1,0,0);
  bw.close();
  count=Iterables.size(scanner);
  if (count != 0)   throw new Exception("count == " + count);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.functional.DeleteRowsSplitIT </h4><pre class="type-9 type-13 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void run() throws Exception {
  final String tableName=getUniqueNames(1)[0];
  final Connector conn=getConnector();
  for (int test=0; test < 10; test++) {
    log.info("Test " + test);
    conn.tableOperations().create(tableName);
    fillTable(conn,tableName);
    final Text start=new Text();
    final Text end=new Text();
    generateRandomRange(start,end);
    final boolean fail[]={false};
    Thread t=new Thread(){
      @Override public void run(){
        try {
          final SortedSet<Text> afterEnd=SPLITS.tailSet(new Text(end.toString() + "\0"));
          conn.tableOperations().addSplits(tableName,afterEnd);
        }
 catch (        Exception ex) {
          log.error("Exception",ex);
synchronized (fail) {
            fail[0]=true;
          }
        }
      }
    }
;
    t.start();
    sleepUninterruptibly(test * 2,TimeUnit.MILLISECONDS);
    conn.tableOperations().deleteRows(tableName,start,end);
    t.join();
synchronized (fail) {
      assertTrue(!fail[0]);
    }
    Scanner scanner=conn.createScanner(tableName,Authorizations.EMPTY);
    for (    Entry<Key,Value> entry : scanner) {
      Text row=entry.getKey().getRow();
      assertTrue(row.compareTo(start) <= 0 || row.compareTo(end) > 0);
    }
    conn.tableOperations().delete(tableName);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.functional.DeleteTableDuringSplitIT </h4><pre class="type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void test() throws Exception {
  int batches=12, batchSize=8;
  String[] tableNames=getUniqueNames(batches * batchSize);
  for (  String tableName : tableNames) {
    getConnector().tableOperations().create(tableName);
  }
  final SortedSet<Text> splits=new TreeSet<Text>();
  for (byte i=0; i < 100; i++) {
    splits.add(new Text(new byte[]{0,0,i}));
  }
  List<Future<?>> results=new ArrayList<Future<?>>();
  List<Runnable> tasks=new ArrayList<Runnable>();
  SimpleThreadPool es=new SimpleThreadPool(batchSize * 2,"concurrent-api-requests");
  for (  String tableName : tableNames) {
    final String finalName=tableName;
    tasks.add(new Runnable(){
      @Override public void run(){
        try {
          getConnector().tableOperations().addSplits(finalName,splits);
        }
 catch (        TableNotFoundException ex) {
        }
catch (        Exception ex) {
          throw new RuntimeException(finalName,ex);
        }
      }
    }
);
    tasks.add(new Runnable(){
      @Override public void run(){
        try {
          UtilWaitThread.sleep(500);
          getConnector().tableOperations().delete(finalName);
        }
 catch (        Exception ex) {
          throw new RuntimeException(ex);
        }
      }
    }
);
  }
  Iterator<Runnable> itr=tasks.iterator();
  for (int batch=0; batch < batches; batch++) {
    for (int i=0; i < batchSize; i++) {
      Future<?> f=es.submit(itr.next());
      results.add(f);
      f=es.submit(itr.next());
      results.add(f);
    }
    for (    Future<?> f : results) {
      f.get();
    }
    results.clear();
  }
  List<Runnable> queued=es.shutdownNow();
  Assert.assertTrue("Had more tasks to run",queued.isEmpty());
  Assert.assertFalse("Had more tasks that needed to be submitted",itr.hasNext());
  for (  String tableName : tableNames) {
    assertFalse(getConnector().tableOperations().exists(tableName));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.functional.DurabilityIT </h4><pre class="type-9 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test(timeout=2 * 60 * 1000) public void testWriteSpeed() throws Exception {
  TableOperations tableOps=getConnector().tableOperations();
  String tableNames[]=init();
  long t0=writeSome(tableNames[0],N);
  tableOps.delete(tableNames[0]);
  long t1=writeSome(tableNames[1],N);
  tableOps.delete(tableNames[1]);
  long t2=writeSome(tableNames[2],N);
  tableOps.delete(tableNames[2]);
  long t3=writeSome(tableNames[3],N);
  tableOps.delete(tableNames[3]);
  System.out.println(String.format("sync %d flush %d log %d none %d",t0,t1,t2,t3));
  assertTrue("flush should be faster than sync",t0 > t1);
  assertTrue("log should be faster than flush",t1 > t2);
  assertTrue("no durability should be faster than log",t2 > t3);
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=4 * 60 * 1000) public void testMetaDurability() throws Exception {
  Connector c=getConnector();
  String tableName=getUniqueNames(1)[0];
  c.instanceOperations().setProperty(Property.TABLE_DURABILITY.getKey(),"none");
  Map<String,String> props=map(c.tableOperations().getProperties(MetadataTable.NAME));
  assertEquals("sync",props.get(Property.TABLE_DURABILITY.getKey()));
  c.tableOperations().create(tableName);
  props=map(c.tableOperations().getProperties(tableName));
  assertEquals("none",props.get(Property.TABLE_DURABILITY.getKey()));
  restartTServer();
  assertTrue(c.tableOperations().exists(tableName));
}

</code></pre>

<br>
<pre class="type-9 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test(timeout=4 * 60 * 1000) public void testIncreaseDurability() throws Exception {
  Connector c=getConnector();
  String tableName=getUniqueNames(1)[0];
  c.tableOperations().create(tableName);
  c.tableOperations().setProperty(tableName,Property.TABLE_DURABILITY.getKey(),"none");
  writeSome(tableName,N);
  restartTServer();
  long numResults=readSome(tableName);
  assertTrue("Expected " + N + " >= "+ numResults,N >= numResults);
  c.tableOperations().setProperty(tableName,Property.TABLE_DURABILITY.getKey(),"sync");
  writeSome(tableName,N);
  restartTServer();
  assertTrue(N == readSome(tableName));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.functional.ExamplesIT </h4><pre class="type-9 type-5 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testClasspath() throws Exception {
  Entry<Integer,String> entry=getCluster().getClusterControl().execWithStdout(Main.class,new String[]{"classpath"});
  assertEquals(0,entry.getKey().intValue());
  String result=entry.getValue();
  int level1=result.indexOf("Level 1");
  int level2=result.indexOf("Level 2");
  int level3=result.indexOf("Level 3");
  int level4=result.indexOf("Level 4");
  assertTrue("Level 1 classloader not present.",level1 >= 0);
  assertTrue("Level 2 classloader not present.",level2 > 0);
  assertTrue("Level 3 classloader not present.",level3 > 0);
  assertTrue("Level 4 classloader not present.",level4 > 0);
  assertTrue(level1 < level2);
  assertTrue(level2 < level3);
  assertTrue(level3 < level4);
}

</code></pre>

<br>
<pre class="type-9 type-5 type-21 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDirList() throws Exception {
  String[] names=getUniqueNames(3);
  String dirTable=names[0], indexTable=names[1], dataTable=names[2];
  String[] args;
  String dirListDirectory;
switch (getClusterType()) {
case MINI:
    dirListDirectory=((MiniAccumuloClusterImpl)getCluster()).getConfig().getDir().getAbsolutePath();
  break;
case STANDALONE:
dirListDirectory=((StandaloneAccumuloCluster)getCluster()).getAccumuloHome();
break;
default :
throw new RuntimeException("Unknown cluster type");
}
assumeTrue(new File(dirListDirectory).exists());
if (saslEnabled) {
args=new String[]{"-i",instance,"-z",keepers,"-u",user,"--keytab",keytab,"--dirTable",dirTable,"--indexTable",indexTable,"--dataTable",dataTable,"--vis",visibility,"--chunkSize",Integer.toString(10000),dirListDirectory};
}
 else {
args=new String[]{"-i",instance,"-z",keepers,"-u",user,"-p",passwd,"--dirTable",dirTable,"--indexTable",indexTable,"--dataTable",dataTable,"--vis",visibility,"--chunkSize",Integer.toString(10000),dirListDirectory};
}
Entry<Integer,String> entry=getClusterControl().execWithStdout(Ingest.class,args);
assertEquals("Got non-zero return code. Stdout=" + entry.getValue(),0,entry.getKey().intValue());
String expectedFile;
switch (getClusterType()) {
case MINI:
expectedFile="accumulo-site.xml";
break;
case STANDALONE:
expectedFile="LICENSE";
break;
default :
throw new RuntimeException("Unknown cluster type");
}
if (saslEnabled) {
args=new String[]{"-i",instance,"-z",keepers,"--keytab",keytab,"-u",user,"-t",indexTable,"--auths",auths,"--search","--path",expectedFile};
}
 else {
args=new String[]{"-i",instance,"-z",keepers,"-p",passwd,"-u",user,"-t",indexTable,"--auths",auths,"--search","--path",expectedFile};
}
entry=getClusterControl().execWithStdout(QueryUtil.class,args);
if (ClusterType.MINI == getClusterType()) {
MiniAccumuloClusterImpl impl=(MiniAccumuloClusterImpl)cluster;
for (LogWriter writer : impl.getLogWriters()) {
writer.flush();
}
}
log.info("result " + entry.getValue());
assertEquals(0,entry.getKey().intValue());
assertTrue(entry.getValue().contains(expectedFile));
}

</code></pre>

<br>
<pre class="type-9 type-13 type-5 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBloomFilters() throws Exception {
  String tableName=getUniqueNames(1)[0];
  c.tableOperations().create(tableName);
  c.tableOperations().setProperty(tableName,Property.TABLE_BLOOM_ENABLED.getKey(),"true");
  String[] args;
  if (saslEnabled) {
    args=new String[]{"--seed","7","-i",instance,"-z",keepers,"-u",user,"--keytab",keytab,"--num","100000","--min","0","--max","1000000000","--size","50","--batchMemory","2M","--batchLatency","60s","--batchThreads","3","-t",tableName};
  }
 else {
    args=new String[]{"--seed","7","-i",instance,"-z",keepers,"-u",user,"-p",passwd,"--num","100000","--min","0","--max","1000000000","--size","50","--batchMemory","2M","--batchLatency","60s","--batchThreads","3","-t",tableName};
  }
  goodExec(RandomBatchWriter.class,args);
  c.tableOperations().flush(tableName,null,null,true);
  long diff=0, diff2=0;
  for (int i=0; i < 2; i++) {
    long now=System.currentTimeMillis();
    if (saslEnabled) {
      args=new String[]{"--seed","7","-i",instance,"-z",keepers,"-u",user,"--keytab",keytab,"--num","10000","--min","0","--max","1000000000","--size","50","--scanThreads","4","-t",tableName};
    }
 else {
      args=new String[]{"--seed","7","-i",instance,"-z",keepers,"-u",user,"-p",passwd,"--num","10000","--min","0","--max","1000000000","--size","50","--scanThreads","4","-t",tableName};
    }
    goodExec(RandomBatchScanner.class,args);
    diff=System.currentTimeMillis() - now;
    now=System.currentTimeMillis();
    if (saslEnabled) {
      args=new String[]{"--seed","8","-i",instance,"-z",keepers,"-u",user,"--keytab",keytab,"--num","10000","--min","0","--max","1000000000","--size","50","--scanThreads","4","-t",tableName};
    }
 else {
      args=new String[]{"--seed","8","-i",instance,"-z",keepers,"-u",user,"-p",passwd,"--num","10000","--min","0","--max","1000000000","--size","50","--scanThreads","4","-t",tableName};
    }
    int retCode=getClusterControl().exec(RandomBatchScanner.class,args);
    assertEquals(1,retCode);
    diff2=System.currentTimeMillis() - now;
    if (diff2 < diff)     break;
  }
  assertTrue(diff2 < diff);
}

</code></pre>

<br>
<pre class="type-9 type-5 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTrace() throws Exception {
  Process trace=null;
  if (ClusterType.MINI == getClusterType()) {
    MiniAccumuloClusterImpl impl=(MiniAccumuloClusterImpl)cluster;
    trace=impl.exec(TraceServer.class);
    while (!c.tableOperations().exists("trace"))     sleepUninterruptibly(500,TimeUnit.MILLISECONDS);
  }
  String[] args;
  if (saslEnabled) {
    args=new String[]{"-i",instance,"-z",keepers,"-u",user,"--keytab",keytab,"-C","-D","-c"};
  }
 else {
    args=new String[]{"-i",instance,"-z",keepers,"-u",user,"-p",passwd,"-C","-D","-c"};
  }
  Entry<Integer,String> pair=cluster.getClusterControl().execWithStdout(TracingExample.class,args);
  Assert.assertEquals("Expected return code of zero. STDOUT=" + pair.getValue(),0,pair.getKey().intValue());
  String result=pair.getValue();
  Pattern pattern=Pattern.compile("TraceID: ([0-9a-f]+)");
  Matcher matcher=pattern.matcher(result);
  int count=0;
  while (matcher.find()) {
    if (saslEnabled) {
      args=new String[]{"-i",instance,"-z",keepers,"-u",user,"--keytab",keytab,"--traceid",matcher.group(1)};
    }
 else {
      args=new String[]{"-i",instance,"-z",keepers,"-u",user,"-p",passwd,"--traceid",matcher.group(1)};
    }
    pair=cluster.getClusterControl().execWithStdout(TraceDumpExample.class,args);
    count++;
  }
  assertTrue(count > 0);
  assertTrue("Output did not contain myApp@myHost",pair.getValue().contains("myApp@myHost"));
  if (ClusterType.MINI == getClusterType() && null != trace) {
    trace.destroy();
  }
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStatsCombiner() throws Exception {
  String table=getUniqueNames(1)[0];
  c.tableOperations().create(table);
  is=new IteratorSetting(10,StatsCombiner.class);
  StatsCombiner.setCombineAllColumns(is,true);
  c.tableOperations().attachIterator(table,is);
  bw=c.createBatchWriter(table,bwc);
  Mutation m=new Mutation("foo");
  m.put("a","b","1");
  bw.addMutation(m);
  m=new Mutation("foo");
  m.put("a","b","3");
  bw.addMutation(m);
  bw.flush();
  Iterator<Entry<Key,Value>> iter=c.createScanner(table,Authorizations.EMPTY).iterator();
  assertTrue("Iterator had no results",iter.hasNext());
  Entry<Key,Value> e=iter.next();
  assertEquals("Results ","1,3,4,2",e.getValue().toString());
  assertFalse("Iterator had additional results",iter.hasNext());
  m=new Mutation("foo");
  m.put("a","b","0,20,20,2");
  bw.addMutation(m);
  bw.close();
  iter=c.createScanner(table,Authorizations.EMPTY).iterator();
  assertTrue("Iterator had no results",iter.hasNext());
  e=iter.next();
  assertEquals("Results ","0,20,24,4",e.getValue().toString());
  assertFalse("Iterator had additional results",iter.hasNext());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.functional.GarbageCollectorIT </h4><pre class="type-9 type-13 type-11 type-8 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testProperPortAdvertisement() throws Exception {
  Connector conn=getConnector();
  Instance instance=conn.getInstance();
  ZooReaderWriter zk=new ZooReaderWriter(cluster.getZooKeepers(),30000,OUR_SECRET);
  String path=ZooUtil.getRoot(instance) + Constants.ZGC_LOCK;
  for (int i=0; i < 5; i++) {
    List<String> locks;
    try {
      locks=zk.getChildren(path,null);
    }
 catch (    NoNodeException e) {
      Thread.sleep(5000);
      continue;
    }
    if (locks != null && locks.size() > 0) {
      Collections.sort(locks);
      String lockPath=path + "/" + locks.get(0);
      String gcLoc=new String(zk.getData(lockPath,null));
      Assert.assertTrue("Found unexpected data in zookeeper for GC location: " + gcLoc,gcLoc.startsWith(Service.GC_CLIENT.name()));
      int loc=gcLoc.indexOf(ServerServices.SEPARATOR_CHAR);
      Assert.assertNotEquals("Could not find split point of GC location for: " + gcLoc,-1,loc);
      String addr=gcLoc.substring(loc + 1);
      int addrSplit=addr.indexOf(':');
      Assert.assertNotEquals("Could not find split of GC host:port for: " + addr,-1,addrSplit);
      String host=addr.substring(0,addrSplit), port=addr.substring(addrSplit + 1);
      Assert.assertNotEquals("0.0.0.0",host);
      Assert.assertNotEquals(0,Integer.parseInt(port));
      return;
    }
    Thread.sleep(5000);
  }
  Assert.fail("Could not find advertised GC address");
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testInvalidDelete() throws Exception {
  killMacGc();
  String table=getUniqueNames(1)[0];
  getConnector().tableOperations().create(table);
  BatchWriter bw2=getConnector().createBatchWriter(table,new BatchWriterConfig());
  Mutation m1=new Mutation("r1");
  m1.put("cf1","cq1","v1");
  bw2.addMutation(m1);
  bw2.close();
  getConnector().tableOperations().flush(table,null,null,true);
  getConnector().securityOperations().grantTablePermission(getConnector().whoami(),MetadataTable.NAME,TablePermission.WRITE);
  BatchWriter bw3=getConnector().createBatchWriter(MetadataTable.NAME,new BatchWriterConfig());
  bw3.addMutation(createDelMutation("","","",""));
  bw3.addMutation(createDelMutation("","testDel","test","valueTest"));
  bw3.addMutation(createDelMutation("/","","",""));
  bw3.close();
  Process gc=cluster.exec(SimpleGarbageCollector.class);
  try {
    String output="";
    while (!output.contains("Ignoring invalid deletion candidate")) {
      sleepUninterruptibly(250,TimeUnit.MILLISECONDS);
      try {
        output=FunctionalTestUtils.readAll(cluster,SimpleGarbageCollector.class,gc);
      }
 catch (      IOException ioe) {
        log.error("Could not read all from cluster.",ioe);
      }
    }
  }
  finally {
    gc.destroy();
  }
  Scanner scanner=getConnector().createScanner(table,Authorizations.EMPTY);
  Iterator<Entry<Key,Value>> iter=scanner.iterator();
  assertTrue(iter.hasNext());
  Entry<Key,Value> entry=iter.next();
  Assert.assertEquals("r1",entry.getKey().getRow().toString());
  Assert.assertEquals("cf1",entry.getKey().getColumnFamily().toString());
  Assert.assertEquals("cq1",entry.getKey().getColumnQualifier().toString());
  Assert.assertEquals("v1",entry.getValue().toString());
  Assert.assertFalse(iter.hasNext());
}

</code></pre>

<br>
<pre class="type-9 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void gcLotsOfCandidatesIT() throws Exception {
  killMacGc();
  log.info("Filling metadata table with bogus delete flags");
  Connector c=getConnector();
  addEntries(c,new BatchWriterOpts());
  cluster.getConfig().setDefaultMemory(10,MemoryUnit.MEGABYTE);
  Process gc=cluster.exec(SimpleGarbageCollector.class);
  sleepUninterruptibly(20,TimeUnit.SECONDS);
  String output="";
  while (!output.contains("delete candidates has exceeded")) {
    byte buffer[]=new byte[10 * 1024];
    try {
      int n=gc.getInputStream().read(buffer);
      output=new String(buffer,0,n,UTF_8);
    }
 catch (    IOException ex) {
      break;
    }
  }
  gc.destroy();
  assertTrue(output.contains("delete candidates has exceeded"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.functional.KerberosIT </h4><pre class="type-9 type-8 type-5 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDelegationTokenAsDifferentUser() throws Exception {
  UserGroupInformation ugi=UserGroupInformation.loginUserFromKeytabAndReturnUGI(rootUser.getPrincipal(),rootUser.getKeytab().getAbsolutePath());
  log.info("Logged in as {}",rootUser.getPrincipal());
  final AuthenticationToken delegationToken;
  try {
    delegationToken=ugi.doAs(new PrivilegedExceptionAction<AuthenticationToken>(){
      @Override public AuthenticationToken run() throws Exception {
        Connector conn=mac.getConnector(rootUser.getPrincipal(),new KerberosToken());
        log.info("Created connector as {}",rootUser.getPrincipal());
        assertEquals(rootUser.getPrincipal(),conn.whoami());
        return conn.securityOperations().getDelegationToken(new DelegationTokenConfig());
      }
    }
);
  }
 catch (  UndeclaredThrowableException ex) {
    throw ex;
  }
  UserGroupInformation userWithoutPrivs=UserGroupInformation.createUserForTesting("fake_user",new String[0]);
  try {
    userWithoutPrivs.doAs(new PrivilegedExceptionAction<Void>(){
      @Override public Void run() throws Exception {
        mac.getConnector("some_other_user",delegationToken);
        return null;
      }
    }
);
    fail("Using a delegation token as a different user should throw an exception");
  }
 catch (  UndeclaredThrowableException e) {
    Throwable cause=e.getCause();
    assertNotNull(cause);
    assertTrue("Expected cause to be AccumuloSecurityException, but was " + cause.getClass(),cause instanceof AccumuloSecurityException);
  }
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDelegationToken() throws Exception {
  final String tableName=getUniqueNames(1)[0];
  UserGroupInformation root=UserGroupInformation.loginUserFromKeytabAndReturnUGI(rootUser.getPrincipal(),rootUser.getKeytab().getAbsolutePath());
  log.info("Logged in as {}",rootUser.getPrincipal());
  final int numRows=100, numColumns=10;
  final AuthenticationToken delegationToken=root.doAs(new PrivilegedExceptionAction<AuthenticationToken>(){
    @Override public AuthenticationToken run() throws Exception {
      Connector conn=mac.getConnector(rootUser.getPrincipal(),new KerberosToken());
      log.info("Created connector as {}",rootUser.getPrincipal());
      assertEquals(rootUser.getPrincipal(),conn.whoami());
      conn.tableOperations().create(tableName);
      BatchWriter bw=conn.createBatchWriter(tableName,new BatchWriterConfig());
      for (int r=0; r < numRows; r++) {
        Mutation m=new Mutation(Integer.toString(r));
        for (int c=0; c < numColumns; c++) {
          String col=Integer.toString(c);
          m.put(col,col,col);
        }
        bw.addMutation(m);
      }
      bw.close();
      return conn.securityOperations().getDelegationToken(new DelegationTokenConfig());
    }
  }
);
  UserGroupInformation userWithoutPrivs=UserGroupInformation.createUserForTesting("fake_user",new String[0]);
  int recordsSeen=userWithoutPrivs.doAs(new PrivilegedExceptionAction<Integer>(){
    @Override public Integer run() throws Exception {
      Connector conn=mac.getConnector(rootUser.getPrincipal(),delegationToken);
      BatchScanner bs=conn.createBatchScanner(tableName,Authorizations.EMPTY,2);
      bs.setRanges(Collections.singleton(new Range()));
      int recordsSeen=Iterables.size(bs);
      bs.close();
      return recordsSeen;
    }
  }
);
  assertEquals(numRows * numColumns,recordsSeen);
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUserPrivilegesForTable() throws Exception {
  String user1=testName.getMethodName();
  final File user1Keytab=new File(kdc.getKeytabDir(),user1 + ".keytab");
  if (user1Keytab.exists() && !user1Keytab.delete()) {
    log.warn("Unable to delete {}",user1Keytab);
  }
  kdc.createPrincipal(user1Keytab,user1);
  final String qualifiedUser1=kdc.qualifyUser(user1);
  UserGroupInformation ugi=UserGroupInformation.loginUserFromKeytabAndReturnUGI(qualifiedUser1,user1Keytab.getAbsolutePath());
  log.info("Logged in as {}",user1);
  ugi.doAs(new PrivilegedExceptionAction<Void>(){
    @Override public Void run() throws Exception {
      Connector conn=mac.getConnector(qualifiedUser1,new KerberosToken());
      log.info("Created connector as {}",qualifiedUser1);
      for (      SystemPermission perm : SystemPermission.values()) {
        assertFalse(conn.securityOperations().hasSystemPermission(qualifiedUser1,perm));
      }
      return null;
    }
  }
);
  final String table=testName.getMethodName() + "_user_table";
  final String viz="viz";
  ugi=UserGroupInformation.loginUserFromKeytabAndReturnUGI(rootUser.getPrincipal(),rootUser.getKeytab().getAbsolutePath());
  ugi.doAs(new PrivilegedExceptionAction<Void>(){
    @Override public Void run() throws Exception {
      Connector conn=mac.getConnector(rootUser.getPrincipal(),new KerberosToken());
      conn.tableOperations().create(table);
      conn.securityOperations().grantTablePermission(qualifiedUser1,table,TablePermission.READ);
      conn.securityOperations().grantTablePermission(qualifiedUser1,table,TablePermission.WRITE);
      conn.securityOperations().grantTablePermission(qualifiedUser1,table,TablePermission.ALTER_TABLE);
      conn.securityOperations().grantTablePermission(qualifiedUser1,table,TablePermission.DROP_TABLE);
      conn.securityOperations().changeUserAuthorizations(qualifiedUser1,new Authorizations(viz));
      return null;
    }
  }
);
  ugi=UserGroupInformation.loginUserFromKeytabAndReturnUGI(qualifiedUser1,user1Keytab.getAbsolutePath());
  ugi.doAs(new PrivilegedExceptionAction<Void>(){
    @Override public Void run() throws Exception {
      Connector conn=mac.getConnector(qualifiedUser1,new KerberosToken());
      final long ts=1000l;
      BatchWriter bw=conn.createBatchWriter(table,new BatchWriterConfig());
      Mutation m=new Mutation("a");
      m.put("b","c",new ColumnVisibility(viz.getBytes()),ts,"d");
      bw.addMutation(m);
      bw.close();
      conn.tableOperations().compact(table,new CompactionConfig().setWait(true).setFlush(true));
      conn.tableOperations().setProperty(table,Property.TABLE_BLOOM_ENABLED.getKey(),"true");
      Scanner s=conn.createScanner(table,new Authorizations(viz));
      Iterator<Entry<Key,Value>> iter=s.iterator();
      assertTrue("No results from iterator",iter.hasNext());
      Entry<Key,Value> entry=iter.next();
      assertEquals(new Key("a","b","c",viz,ts),entry.getKey());
      assertEquals(new Value("d".getBytes()),entry.getValue());
      assertFalse("Had more results from iterator",iter.hasNext());
      return null;
    }
  }
);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.functional.MasterAssignmentIT </h4><pre class="type-9 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test() throws Exception {
  Connector c=getConnector();
  String tableName=super.getUniqueNames(1)[0];
  c.tableOperations().create(tableName);
  String tableId=c.tableOperations().tableIdMap().get(tableName);
  TabletLocationState newTablet;
  do {
    UtilWaitThread.sleep(250);
    newTablet=getTabletLocationState(c,tableId);
  }
 while (newTablet.current == null);
  assertNull(newTablet.last);
  assertNull(newTablet.future);
  BatchWriter bw=c.createBatchWriter(tableName,new BatchWriterConfig());
  Mutation m=new Mutation("a");
  m.put("b","c","d");
  bw.addMutation(m);
  bw.close();
  c.tableOperations().flush(tableName,null,null,true);
  TabletLocationState flushed=getTabletLocationState(c,tableId);
  assertEquals(newTablet.current,flushed.current);
  assertEquals(flushed.current,flushed.last);
  assertNull(newTablet.future);
  c.tableOperations().offline(tableName,true);
  TabletLocationState offline=getTabletLocationState(c,tableId);
  assertNull(offline.future);
  assertNull(offline.current);
  assertEquals(flushed.current,offline.last);
  c.tableOperations().online(tableName,true);
  TabletLocationState online=getTabletLocationState(c,tableId);
  assertNull(online.future);
  assertNotNull(online.current);
  assertEquals(online.current,online.last);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.functional.MonitorLoggingIT </h4><pre class="type-9 type-5 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void logToMonitor() throws Exception {
  log.debug("Starting Monitor");
  Process monitor=cluster.exec(Monitor.class);
  String monitorLocation=null;
  for (int i=0; i < NUM_LOCATION_PASSES; i++) {
    Thread.sleep(LOCATION_DELAY_SECS * 1000);
    try {
      monitorLocation=getMonitor();
      break;
    }
 catch (    KeeperException e) {
      log.debug("Monitor not up yet, trying again in " + LOCATION_DELAY_SECS + " secs");
    }
  }
  assertNotNull("Monitor failed to start within " + (LOCATION_DELAY_SECS * NUM_LOCATION_PASSES) + " secs",monitorLocation);
  log.debug("Monitor running at " + monitorLocation);
  Thread.sleep(10000);
  try {
    Connector c=getConnector();
    Scanner s=c.createScanner("accumulo.root",new Authorizations());
    IteratorSetting cfg=new IteratorSetting(100,"incorrect","java.lang.String");
    s.addScanIterator(cfg);
    s.iterator().next();
  }
 catch (  RuntimeException e) {
  }
  String result="";
  while (true) {
    Thread.sleep(LOCATION_DELAY_SECS * 1000);
    URL url=new URL("http://" + monitorLocation + "/log");
    log.debug("Fetching web page " + url);
    result=FunctionalTestUtils.readAll(url.openStream());
    if (result.contains("<pre class='logevent'>")) {
      break;
    }
    log.debug("No messages found, waiting a little longer...");
  }
  assertTrue("No log messages found",result.contains("<pre class='logevent'>"));
  log.debug("Stopping mini accumulo cluster");
  Process shutdown=cluster.exec(Admin.class,"stopAll");
  shutdown.waitFor();
  assertTrue(shutdown.exitValue() == 0);
  log.debug("success!");
  monitor.destroy();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.functional.MonitorSslIT </h4><pre class="type-9 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void test() throws Exception {
  log.debug("Starting Monitor");
  cluster.getClusterControl().startAllServers(ServerType.MONITOR);
  String monitorLocation=null;
  while (null == monitorLocation) {
    try {
      monitorLocation=MonitorUtil.getLocation(getConnector().getInstance());
    }
 catch (    Exception e) {
    }
    if (null == monitorLocation) {
      log.debug("Could not fetch monitor HTTP address from zookeeper");
      Thread.sleep(2000);
    }
  }
  URL url=new URL("https://" + monitorLocation);
  log.debug("Fetching web page " + url);
  String result=FunctionalTestUtils.readAll(url.openStream());
  assertTrue(result.length() > 100);
  assertTrue(result.indexOf("Accumulo Overview") >= 0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.functional.NativeMapIT </h4><pre class="type-9 type-13 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBinary(){
  NativeMap nm=new NativeMap();
  byte emptyBytes[]=new byte[0];
  for (int i=0; i < 256; i++) {
    for (int j=0; j < 256; j++) {
      byte row[]=new byte[]{'r',(byte)(0xff & i),(byte)(0xff & j)};
      byte data[]=new byte[]{'v',(byte)(0xff & i),(byte)(0xff & j)};
      Key k=new Key(row,emptyBytes,emptyBytes,emptyBytes,1);
      Value v=new Value(data);
      nm.put(k,v);
    }
  }
  Iterator<Entry<Key,Value>> iter=nm.iterator();
  for (int i=0; i < 256; i++) {
    for (int j=0; j < 256; j++) {
      byte row[]=new byte[]{'r',(byte)(0xff & i),(byte)(0xff & j)};
      byte data[]=new byte[]{'v',(byte)(0xff & i),(byte)(0xff & j)};
      Key k=new Key(row,emptyBytes,emptyBytes,emptyBytes,1);
      Value v=new Value(data);
      assertTrue(iter.hasNext());
      Entry<Key,Value> entry=iter.next();
      assertEquals(k,entry.getKey());
      assertEquals(v,entry.getValue());
    }
  }
  assertFalse(iter.hasNext());
  for (int i=0; i < 256; i++) {
    for (int j=0; j < 256; j++) {
      byte row[]=new byte[]{'r',(byte)(0xff & i),(byte)(0xff & j)};
      byte data[]=new byte[]{'v',(byte)(0xff & i),(byte)(0xff & j)};
      Key k=new Key(row,emptyBytes,emptyBytes,emptyBytes,1);
      Value v=new Value(data);
      Value v2=nm.get(k);
      assertEquals(v,v2);
    }
  }
  nm.delete();
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test8(){
  NativeMap nm=new NativeMap();
  TreeMap<Key,Value> tm=new TreeMap<Key,Value>();
  tm.put(new Key(new Text("fo")),new Value(new byte[]{'0'}));
  tm.put(new Key(new Text("foo")),new Value(new byte[]{'1'}));
  tm.put(new Key(new Text("foo1")),new Value(new byte[]{'2'}));
  tm.put(new Key(new Text("foo2")),new Value(new byte[]{'3'}));
  for (  Entry<Key,Value> entry : tm.entrySet()) {
    nm.put(entry.getKey(),entry.getValue());
  }
  Iterator<Entry<Key,Value>> iter=nm.iterator();
  for (  Entry<Key,Value> entry : tm.entrySet()) {
    assertTrue(iter.hasNext());
    Entry<Key,Value> entry2=iter.next();
    assertEquals(entry.getKey(),entry2.getKey());
    assertEquals(entry.getValue(),entry2.getValue());
  }
  assertFalse(iter.hasNext());
  nm.delete();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.functional.ReadWriteIT </h4><pre class="type-9 type-11 type-5 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void multiTableTest() throws Exception {
  final String instance=cluster.getInstanceName();
  final String keepers=cluster.getZooKeepers();
  final ClusterControl control=cluster.getClusterControl();
  final String prefix=getClass().getSimpleName() + "_" + testName.getMethodName();
  ExecutorService svc=Executors.newFixedThreadPool(2);
  Future<Integer> p1=svc.submit(new Callable<Integer>(){
    @Override public Integer call(){
      try {
        ClientConfiguration clientConf=cluster.getClientConfig();
        if (clientConf.getBoolean(ClientProperty.INSTANCE_RPC_SASL_ENABLED.getKey(),false)) {
          String principal=getAdminPrincipal();
          AuthenticationToken token=getAdminToken();
          assertTrue("Expected KerberosToken, but was " + token.getClass(),token instanceof KerberosToken);
          KerberosToken kt=(KerberosToken)token;
          assertNotNull("Expected keytab in token",kt.getKeytab());
          return control.exec(TestMultiTableIngest.class,args("--count",Integer.toString(ROWS),"-i",instance,"-z",keepers,"--tablePrefix",prefix,"--keytab",kt.getKeytab().getAbsolutePath(),"-u",principal));
        }
        return control.exec(TestMultiTableIngest.class,args("--count",Integer.toString(ROWS),"-u",getAdminPrincipal(),"-i",instance,"-z",keepers,"-p",new String(((PasswordToken)getAdminToken()).getPassword(),UTF_8),"--tablePrefix",prefix));
      }
 catch (      IOException e) {
        log.error("Error running MultiTableIngest",e);
        return -1;
      }
    }
  }
);
  Future<Integer> p2=svc.submit(new Callable<Integer>(){
    @Override public Integer call(){
      try {
        ClientConfiguration clientConf=cluster.getClientConfig();
        if (clientConf.getBoolean(ClientProperty.INSTANCE_RPC_SASL_ENABLED.getKey(),false)) {
          String principal=getAdminPrincipal();
          AuthenticationToken token=getAdminToken();
          assertTrue("Expected KerberosToken, but was " + token.getClass(),token instanceof KerberosToken);
          KerberosToken kt=(KerberosToken)token;
          assertNotNull("Expected keytab in token",kt.getKeytab());
          return control.exec(TestMultiTableIngest.class,args("--count",Integer.toString(ROWS),"--readonly","-i",instance,"-z",keepers,"--tablePrefix",prefix,"--keytab",kt.getKeytab().getAbsolutePath(),"-u",principal));
        }
        return control.exec(TestMultiTableIngest.class,args("--count",Integer.toString(ROWS),"--readonly","-u",getAdminPrincipal(),"-i",instance,"-z",keepers,"-p",new String(((PasswordToken)getAdminToken()).getPassword(),UTF_8),"--tablePrefix",prefix));
      }
 catch (      IOException e) {
        log.error("Error running MultiTableIngest",e);
        return -1;
      }
    }
  }
);
  svc.shutdown();
  while (!svc.isTerminated()) {
    svc.awaitTermination(15,TimeUnit.SECONDS);
  }
  assertEquals(0,p1.get().intValue());
  assertEquals(0,p2.get().intValue());
}

</code></pre>

<br>
<pre class="type-9 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void sunnyDay() throws Exception {
  log.debug("Starting Monitor");
  cluster.getClusterControl().startAllServers(ServerType.MONITOR);
  Connector connector=getConnector();
  String tableName=getUniqueNames(1)[0];
  ingest(connector,getCluster().getClientConfig(),getAdminPrincipal(),ROWS,COLS,50,0,tableName);
  verify(connector,getCluster().getClientConfig(),getAdminPrincipal(),ROWS,COLS,50,0,tableName);
  String monitorLocation=null;
  while (null == monitorLocation) {
    monitorLocation=MonitorUtil.getLocation(getConnector().getInstance());
    if (null == monitorLocation) {
      log.debug("Could not fetch monitor HTTP address from zookeeper");
      Thread.sleep(2000);
    }
  }
  String scheme="http://";
  if (getCluster() instanceof StandaloneAccumuloCluster) {
    StandaloneAccumuloCluster standaloneCluster=(StandaloneAccumuloCluster)getCluster();
    File accumuloSite=new File(standaloneCluster.getServerAccumuloConfDir(),"accumulo-site.xml");
    if (accumuloSite.isFile()) {
      Configuration conf=new Configuration(false);
      conf.addResource(new Path(accumuloSite.toURI()));
      String monitorSslKeystore=conf.get(Property.MONITOR_SSL_KEYSTORE.getKey());
      if (null != monitorSslKeystore) {
        log.info("Setting scheme to HTTPS since monitor ssl keystore configuration was observed in {}",accumuloSite);
        scheme="https://";
        SSLContext ctx=SSLContext.getInstance("SSL");
        TrustManager[] tm=new TrustManager[]{new TestTrustManager()};
        ctx.init(new KeyManager[0],tm,new SecureRandom());
        SSLContext.setDefault(ctx);
        HttpsURLConnection.setDefaultSSLSocketFactory(ctx.getSocketFactory());
        HttpsURLConnection.setDefaultHostnameVerifier(new TestHostnameVerifier());
      }
    }
 else {
      log.info("{} is not a normal file, not checking for monitor running with SSL",accumuloSite);
    }
  }
  URL url=new URL(scheme + monitorLocation);
  log.debug("Fetching web page " + url);
  String result=FunctionalTestUtils.readAll(url.openStream());
  assertTrue(result.length() > 100);
  log.debug("Stopping accumulo cluster");
  ClusterControl control=cluster.getClusterControl();
  control.adminStopAll();
  ZooReader zreader=new ZooReader(connector.getInstance().getZooKeepers(),connector.getInstance().getZooKeepersSessionTimeOut());
  ZooCache zcache=new ZooCache(zreader,null);
  byte[] masterLockData;
  do {
    masterLockData=ZooLock.getLockData(zcache,ZooUtil.getRoot(connector.getInstance()) + Constants.ZMASTER_LOCK,null);
    if (null != masterLockData) {
      log.info("Master lock is still held");
      Thread.sleep(1000);
    }
  }
 while (null != masterLockData);
  control.stopAllServers(ServerType.GARBAGE_COLLECTOR);
  control.stopAllServers(ServerType.MONITOR);
  control.stopAllServers(ServerType.TRACER);
  log.debug("success!");
  cluster.start();
}

</code></pre>

<br>
<pre class="type-9 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void sunnyLG() throws Exception {
  final Connector connector=getConnector();
  final String tableName=getUniqueNames(1)[0];
  connector.tableOperations().create(tableName);
  Map<String,Set<Text>> groups=new TreeMap<String,Set<Text>>();
  groups.put("g1",Collections.singleton(t("colf")));
  connector.tableOperations().setLocalityGroups(tableName,groups);
  ingest(connector,getCluster().getClientConfig(),getAdminPrincipal(),2000,1,50,0,tableName);
  verify(connector,getCluster().getClientConfig(),getAdminPrincipal(),2000,1,50,0,tableName);
  connector.tableOperations().flush(tableName,null,null,true);
  BatchScanner bscanner=connector.createBatchScanner(MetadataTable.NAME,Authorizations.EMPTY,1);
  String tableId=connector.tableOperations().tableIdMap().get(tableName);
  bscanner.setRanges(Collections.singletonList(new Range(new Text(tableId + ";"),new Text(tableId + "<"))));
  bscanner.fetchColumnFamily(DataFileColumnFamily.NAME);
  boolean foundFile=false;
  for (  Entry<Key,Value> entry : bscanner) {
    foundFile=true;
    ByteArrayOutputStream baos=new ByteArrayOutputStream();
    PrintStream newOut=new PrintStream(baos);
    PrintStream oldOut=System.out;
    try {
      System.setOut(newOut);
      List<String> args=new ArrayList<>();
      args.add(entry.getKey().getColumnQualifier().toString());
      if (ClusterType.STANDALONE == getClusterType() && cluster.getClientConfig().getBoolean(ClientProperty.INSTANCE_RPC_SASL_ENABLED.getKey(),false)) {
        args.add("--config");
        StandaloneAccumuloCluster sac=(StandaloneAccumuloCluster)cluster;
        String hadoopConfDir=sac.getHadoopConfDir();
        args.add(new Path(hadoopConfDir,"core-site.xml").toString());
        args.add(new Path(hadoopConfDir,"hdfs-site.xml").toString());
      }
      log.info("Invoking PrintInfo with " + args);
      PrintInfo.main(args.toArray(new String[args.size()]));
      newOut.flush();
      String stdout=baos.toString();
      assertTrue(stdout.contains("Locality group           : g1"));
      assertTrue(stdout.contains("families        : [colf]"));
    }
  finally {
      newOut.close();
      System.setOut(oldOut);
    }
  }
  bscanner.close();
  assertTrue(foundFile);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.functional.RecoveryWithEmptyRFileIT </h4><pre class="type-9 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void replaceMissingRFile() throws Exception {
  log.info("Ingest some data, verify it was stored properly, replace an underlying rfile with an empty one and verify we can scan.");
  Connector connector=getConnector();
  String tableName=getUniqueNames(1)[0];
  ReadWriteIT.ingest(connector,cluster.getClientConfig(),"root",ROWS,COLS,50,0,tableName);
  ReadWriteIT.verify(connector,cluster.getClientConfig(),"root",ROWS,COLS,50,0,tableName);
  connector.tableOperations().flush(tableName,null,null,true);
  connector.tableOperations().offline(tableName,true);
  log.debug("Replacing rfile(s) with empty");
  Scanner meta=connector.createScanner(MetadataTable.NAME,Authorizations.EMPTY);
  String tableId=connector.tableOperations().tableIdMap().get(tableName);
  meta.setRange(new Range(new Text(tableId + ";"),new Text(tableId + "<")));
  meta.fetchColumnFamily(DataFileColumnFamily.NAME);
  boolean foundFile=false;
  for (  Entry<Key,Value> entry : meta) {
    foundFile=true;
    Path rfile=new Path(entry.getKey().getColumnQualifier().toString());
    log.debug("Removing rfile '" + rfile + "'");
    cluster.getFileSystem().delete(rfile,false);
    Process info=cluster.exec(CreateEmpty.class,rfile.toString());
    assertEquals(0,info.waitFor());
  }
  meta.close();
  assertTrue(foundFile);
  log.trace("invalidate cached file handles by issuing a compaction");
  connector.tableOperations().online(tableName,true);
  connector.tableOperations().compact(tableName,null,null,false,true);
  log.debug("make sure we can still scan");
  Scanner scan=connector.createScanner(tableName,Authorizations.EMPTY);
  scan.setRange(new Range());
  long cells=0l;
  for (  Entry<Key,Value> entry : scan) {
    if (entry != null)     cells++;
  }
  scan.close();
  assertEquals(0l,cells);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.functional.RestartIT </h4><pre class="type-9 type-3 type-2 type-14 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void restartMasterSplit() throws Exception {
  Connector c=getConnector();
  final String tableName=getUniqueNames(1)[0];
  final AuthenticationToken token=getAdminToken();
  final ClusterControl control=getCluster().getClusterControl();
  VOPTS.setTableName(tableName);
  c.tableOperations().create(tableName);
  c.tableOperations().setProperty(tableName,Property.TABLE_SPLIT_THRESHOLD.getKey(),"5K");
  final String[] args;
  if (token instanceof PasswordToken) {
    byte[] password=((PasswordToken)token).getPassword();
    args=new String[]{"-u",getAdminPrincipal(),"-p",new String(password,UTF_8),"-i",cluster.getInstanceName(),"-z",cluster.getZooKeepers(),"--rows",Integer.toString(VOPTS.rows),"--table",tableName};
    OPTS.setPrincipal(getAdminPrincipal());
    VOPTS.setPrincipal(getAdminPrincipal());
  }
 else   if (token instanceof KerberosToken) {
    ClusterUser rootUser=getAdminUser();
    args=new String[]{"-u",getAdminPrincipal(),"--keytab",rootUser.getKeytab().getAbsolutePath(),"-i",cluster.getInstanceName(),"-z",cluster.getZooKeepers(),"--rows",Integer.toString(VOPTS.rows),"--table",tableName};
    ClientConfiguration clientConfig=cluster.getClientConfig();
    OPTS.updateKerberosCredentials(clientConfig);
    VOPTS.updateKerberosCredentials(clientConfig);
  }
 else {
    throw new RuntimeException("Unknown token");
  }
  Future<Integer> ret=svc.submit(new Callable<Integer>(){
    @Override public Integer call(){
      try {
        return control.exec(TestIngest.class,args);
      }
 catch (      Exception e) {
        log.error("Error running TestIngest",e);
        return -1;
      }
    }
  }
);
  control.stopAllServers(ServerType.MASTER);
  ZooReader zreader=new ZooReader(c.getInstance().getZooKeepers(),c.getInstance().getZooKeepersSessionTimeOut());
  ZooCache zcache=new ZooCache(zreader,null);
  byte[] masterLockData;
  do {
    masterLockData=ZooLock.getLockData(zcache,ZooUtil.getRoot(c.getInstance()) + Constants.ZMASTER_LOCK,null);
    if (null != masterLockData) {
      log.info("Master lock is still held");
      Thread.sleep(1000);
    }
  }
 while (null != masterLockData);
  cluster.start();
  assertEquals(0,ret.get().intValue());
  VerifyIngest.verifyIngest(c,VOPTS,SOPTS);
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 type-14 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void restartMaster() throws Exception {
  Connector c=getConnector();
  final String tableName=getUniqueNames(1)[0];
  OPTS.setTableName(tableName);
  VOPTS.setTableName(tableName);
  c.tableOperations().create(tableName);
  final AuthenticationToken token=getAdminToken();
  final ClusterControl control=getCluster().getClusterControl();
  final String[] args;
  if (token instanceof PasswordToken) {
    byte[] password=((PasswordToken)token).getPassword();
    args=new String[]{"-u",getAdminPrincipal(),"-p",new String(password,UTF_8),"-i",cluster.getInstanceName(),"-z",cluster.getZooKeepers(),"--rows","" + OPTS.rows,"--table",tableName};
    OPTS.setPrincipal(getAdminPrincipal());
    VOPTS.setPrincipal(getAdminPrincipal());
  }
 else   if (token instanceof KerberosToken) {
    ClusterUser rootUser=getAdminUser();
    args=new String[]{"-u",getAdminPrincipal(),"--keytab",rootUser.getKeytab().getAbsolutePath(),"-i",cluster.getInstanceName(),"-z",cluster.getZooKeepers(),"--rows","" + OPTS.rows,"--table",tableName};
    ClientConfiguration clientConfig=cluster.getClientConfig();
    OPTS.updateKerberosCredentials(clientConfig);
    VOPTS.updateKerberosCredentials(clientConfig);
  }
 else {
    throw new RuntimeException("Unknown token");
  }
  Future<Integer> ret=svc.submit(new Callable<Integer>(){
    @Override public Integer call(){
      try {
        return control.exec(TestIngest.class,args);
      }
 catch (      IOException e) {
        log.error("Error running TestIngest",e);
        return -1;
      }
    }
  }
);
  control.stopAllServers(ServerType.MASTER);
  control.startAllServers(ServerType.MASTER);
  assertEquals(0,ret.get().intValue());
  VerifyIngest.verifyIngest(c,VOPTS,SOPTS);
}

</code></pre>

<br>
<pre class="type-9 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects are null
"></span><br>
@Test public void shutdownDuringCompactingSplitting() throws Exception {
  Connector c=getConnector();
  String tableName=getUniqueNames(1)[0];
  VOPTS.setTableName(tableName);
  ClientConfiguration clientConfig=cluster.getClientConfig();
  if (clientConfig.getBoolean(ClientProperty.INSTANCE_RPC_SASL_ENABLED.getKey(),false)) {
    OPTS.updateKerberosCredentials(clientConfig);
    VOPTS.updateKerberosCredentials(clientConfig);
  }
 else {
    OPTS.setPrincipal(getAdminPrincipal());
    VOPTS.setPrincipal(getAdminPrincipal());
  }
  c.tableOperations().create(tableName);
  c.tableOperations().setProperty(tableName,Property.TABLE_SPLIT_THRESHOLD.getKey(),"10K");
  String splitThreshold=null;
  for (  Entry<String,String> entry : c.tableOperations().getProperties(tableName)) {
    if (entry.getKey().equals(Property.TABLE_SPLIT_THRESHOLD.getKey())) {
      splitThreshold=entry.getValue();
      break;
    }
  }
  Assert.assertNotNull(splitThreshold);
  try {
    c.tableOperations().setProperty(MetadataTable.NAME,Property.TABLE_SPLIT_THRESHOLD.getKey(),"20K");
    TestIngest.Opts opts=new TestIngest.Opts();
    opts.setTableName(tableName);
    if (clientConfig.getBoolean(ClientProperty.INSTANCE_RPC_SASL_ENABLED.getKey(),false)) {
      opts.updateKerberosCredentials(clientConfig);
    }
 else {
      opts.setPrincipal(getAdminPrincipal());
    }
    TestIngest.ingest(c,opts,BWOPTS);
    c.tableOperations().flush(tableName,null,null,false);
    VerifyIngest.verifyIngest(c,VOPTS,SOPTS);
    getCluster().stop();
  }
  finally {
    if (getClusterType() == ClusterType.STANDALONE) {
      getCluster().start();
      c.tableOperations().setProperty(MetadataTable.NAME,Property.TABLE_SPLIT_THRESHOLD.getKey(),splitThreshold);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.functional.RestartStressIT </h4><pre class="type-9 type-3 type-2 type-14 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void test() throws Exception {
  final Connector c=getConnector();
  final String tableName=getUniqueNames(1)[0];
  final AuthenticationToken token=getAdminToken();
  c.tableOperations().create(tableName);
  c.tableOperations().setProperty(tableName,Property.TABLE_SPLIT_THRESHOLD.getKey(),"500K");
  final ClusterControl control=getCluster().getClusterControl();
  final String[] args;
  if (token instanceof PasswordToken) {
    byte[] password=((PasswordToken)token).getPassword();
    args=new String[]{"-u",getAdminPrincipal(),"-p",new String(password,UTF_8),"-i",cluster.getInstanceName(),"-z",cluster.getZooKeepers(),"--rows","" + VOPTS.rows,"--table",tableName};
  }
 else   if (token instanceof KerberosToken) {
    ClusterUser rootUser=getAdminUser();
    args=new String[]{"-u",getAdminPrincipal(),"--keytab",rootUser.getKeytab().getAbsolutePath(),"-i",cluster.getInstanceName(),"-z",cluster.getZooKeepers(),"--rows","" + VOPTS.rows,"--table",tableName};
  }
 else {
    throw new RuntimeException("Unrecognized token");
  }
  Future<Integer> retCode=svc.submit(new Callable<Integer>(){
    @Override public Integer call(){
      try {
        return control.exec(TestIngest.class,args);
      }
 catch (      Exception e) {
        log.error("Error running TestIngest",e);
        return -1;
      }
    }
  }
);
  for (int i=0; i < 2; i++) {
    sleepUninterruptibly(10,TimeUnit.SECONDS);
    control.stopAllServers(ServerType.TABLET_SERVER);
    control.startAllServers(ServerType.TABLET_SERVER);
  }
  assertEquals(0,retCode.get().intValue());
  VOPTS.setTableName(tableName);
  if (token instanceof PasswordToken) {
    VOPTS.setPrincipal(getAdminPrincipal());
  }
 else   if (token instanceof KerberosToken) {
    VOPTS.updateKerberosCredentials(cluster.getClientConfig());
  }
 else {
    throw new RuntimeException("Unrecognized token");
  }
  VerifyIngest.verifyIngest(c,VOPTS,SOPTS);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.functional.ScanIdIT </h4><pre class="type-9 type-5 type-3 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @throws Exceptionany exception is a test failure.
 */
@Test public void testScanId() throws Exception {
  final String tableName=getUniqueNames(1)[0];
  Connector conn=getConnector();
  conn.tableOperations().create(tableName);
  addSplits(conn,tableName);
  log.info("Splits added");
  generateSampleData(conn,tableName);
  log.info("Generated data for {}",tableName);
  attachSlowIterator(conn,tableName);
  CountDownLatch latch=new CountDownLatch(NUM_SCANNERS);
  for (int scannerIndex=0; scannerIndex < NUM_SCANNERS; scannerIndex++) {
    ScannerThread st=new ScannerThread(conn,scannerIndex,tableName,latch);
    pool.submit(st);
  }
  while (testInProgress.get()) {
    if (resultsByWorker.size() < NUM_SCANNERS) {
      log.trace("Results reported {}",resultsByWorker.size());
      sleepUninterruptibly(750,TimeUnit.MILLISECONDS);
    }
 else {
      testInProgress.set(false);
      log.debug("Final result count {}",resultsByWorker.size());
      sleepUninterruptibly(1,TimeUnit.SECONDS);
    }
  }
  Set<Long> scanIds=new HashSet<Long>();
  List<String> tservers=conn.instanceOperations().getTabletServers();
  log.debug("tablet servers {}",tservers.toString());
  for (  String tserver : tservers) {
    List<ActiveScan> activeScans=null;
    for (int i=0; i < 10; i++) {
      try {
        activeScans=conn.instanceOperations().getActiveScans(tserver);
        break;
      }
 catch (      AccumuloException e) {
        if (e.getCause() instanceof TableNotFoundException) {
          log.debug("Got TableNotFoundException, will retry");
          Thread.sleep(200);
          continue;
        }
        throw e;
      }
    }
    assertNotNull("Repeatedly got exception trying to active scans",activeScans);
    log.debug("TServer {} has {} active scans",tserver,activeScans.size());
    for (    ActiveScan scan : activeScans) {
      log.debug("Tserver {} scan id {}",tserver,scan.getScanid());
      scanIds.add(scan.getScanid());
    }
  }
  assertTrue("Expected at least " + NUM_SCANNERS + " scanIds, but saw "+ scanIds.size(),NUM_SCANNERS <= scanIds.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.functional.ScannerContextIT </h4><pre class="type-9 type-13 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testClearContext() throws Exception {
  Path baseDir=new Path(System.getProperty("user.dir"));
  Path targetDir=new Path(baseDir,"target");
  Path jarPath=new Path(targetDir,"TestIterators-tests.jar");
  Path dstPath=new Path(CONTEXT_DIR + "/Test.jar");
  fs.copyFromLocalFile(jarPath,dstPath);
  UtilWaitThread.sleep(WAIT);
  try {
    Connector c=getConnector();
    c.instanceOperations().setProperty(CONTEXT_PROPERTY,CONTEXT_CLASSPATH);
    String tableName=getUniqueNames(1)[0];
    c.tableOperations().create(tableName);
    BatchWriter bw=c.createBatchWriter(tableName,new BatchWriterConfig());
    for (int i=0; i < ITERATIONS; i++) {
      Mutation m=new Mutation("row" + i);
      m.put("cf","col1","Test");
      bw.addMutation(m);
    }
    bw.close();
    Scanner one=c.createScanner(tableName,Authorizations.EMPTY);
    IteratorSetting cfg=new IteratorSetting(21,"reverse","org.apache.accumulo.test.functional.ValueReversingIterator");
    one.addScanIterator(cfg);
    one.setClassLoaderContext(CONTEXT);
    Iterator<Entry<Key,Value>> iterator=one.iterator();
    for (int i=0; i < ITERATIONS; i++) {
      assertTrue(iterator.hasNext());
      Entry<Key,Value> next=iterator.next();
      assertEquals("tseT",next.getValue().toString());
    }
    one.removeScanIterator("reverse");
    one.clearClassLoaderContext();
    iterator=one.iterator();
    for (int i=0; i < ITERATIONS; i++) {
      assertTrue(iterator.hasNext());
      Entry<Key,Value> next=iterator.next();
      assertEquals("Test",next.getValue().toString());
    }
  }
  finally {
    fs.delete(dstPath,true);
  }
}

</code></pre>

<br>
<pre class="type-9 type-13 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOneScannerDoesntInterfereWithAnother() throws Exception {
  Path baseDir=new Path(System.getProperty("user.dir"));
  Path targetDir=new Path(baseDir,"target");
  Path jarPath=new Path(targetDir,"TestIterators-tests.jar");
  Path dstPath=new Path(CONTEXT_DIR + "/Test.jar");
  fs.copyFromLocalFile(jarPath,dstPath);
  UtilWaitThread.sleep(WAIT);
  try {
    Connector c=getConnector();
    c.instanceOperations().setProperty(CONTEXT_PROPERTY,CONTEXT_CLASSPATH);
    String tableName=getUniqueNames(1)[0];
    c.tableOperations().create(tableName);
    BatchWriter bw=c.createBatchWriter(tableName,new BatchWriterConfig());
    for (int i=0; i < ITERATIONS; i++) {
      Mutation m=new Mutation("row" + i);
      m.put("cf","col1","Test");
      bw.addMutation(m);
    }
    bw.close();
    Scanner one=c.createScanner(tableName,Authorizations.EMPTY);
    Scanner two=c.createScanner(tableName,Authorizations.EMPTY);
    IteratorSetting cfg=new IteratorSetting(21,"reverse","org.apache.accumulo.test.functional.ValueReversingIterator");
    one.addScanIterator(cfg);
    one.setClassLoaderContext(CONTEXT);
    Iterator<Entry<Key,Value>> iterator=one.iterator();
    for (int i=0; i < ITERATIONS; i++) {
      assertTrue(iterator.hasNext());
      Entry<Key,Value> next=iterator.next();
      assertEquals("tseT",next.getValue().toString());
    }
    Iterator<Entry<Key,Value>> iterator2=two.iterator();
    for (int i=0; i < ITERATIONS; i++) {
      assertTrue(iterator2.hasNext());
      Entry<Key,Value> next=iterator2.next();
      assertEquals("Test",next.getValue().toString());
    }
  }
  finally {
    fs.delete(dstPath,true);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.functional.SimpleBalancerFairnessIT </h4><pre class="type-9 type-13 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void simpleBalancerFairness() throws Exception {
  Connector c=getConnector();
  c.tableOperations().create("test_ingest");
  c.tableOperations().setProperty("test_ingest",Property.TABLE_SPLIT_THRESHOLD.getKey(),"10K");
  c.tableOperations().create("unused");
  TreeSet<Text> splits=TestIngest.getSplitPoints(0,10000000,500);
  log.info("Creating " + splits.size() + " splits");
  c.tableOperations().addSplits("unused",splits);
  List<String> tservers=c.instanceOperations().getTabletServers();
  TestIngest.Opts opts=new TestIngest.Opts();
  opts.rows=50000;
  opts.setPrincipal("root");
  TestIngest.ingest(c,opts,new BatchWriterOpts());
  c.tableOperations().flush("test_ingest",null,null,false);
  sleepUninterruptibly(45,TimeUnit.SECONDS);
  Credentials creds=new Credentials("root",new PasswordToken(ROOT_PASSWORD));
  ClientContext context=new ClientContext(c.getInstance(),creds,getClientConfig());
  MasterMonitorInfo stats=null;
  int unassignedTablets=1;
  for (int i=0; unassignedTablets > 0 && i < 10; i++) {
    MasterClientService.Iface client=null;
    try {
      client=MasterClient.getConnectionWithRetry(context);
      stats=client.getMasterStats(Tracer.traceInfo(),creds.toThrift(c.getInstance()));
    }
  finally {
      if (client != null)       MasterClient.close(client);
    }
    unassignedTablets=stats.getUnassignedTablets();
    if (unassignedTablets > 0) {
      log.info("Found " + unassignedTablets + " unassigned tablets, sleeping 3 seconds for tablet assignment");
      Thread.sleep(3000);
    }
  }
  assertEquals("Unassigned tablets were not assigned within 30 seconds",0,unassignedTablets);
  List<Integer> counts=new ArrayList<Integer>();
  for (  TabletServerStatus server : stats.tServerInfo) {
    int count=0;
    for (    TableInfo table : server.tableMap.values()) {
      count+=table.onlineTablets;
    }
    counts.add(count);
  }
  assertTrue("Expected to have at least two TabletServers",counts.size() > 1);
  for (int i=1; i < counts.size(); i++) {
    int diff=Math.abs(counts.get(0) - counts.get(i));
    assertTrue("Expected difference in tablets to be less than or equal to " + counts.size() + " but was "+ diff+ ". Counts "+ counts,diff <= tservers.size());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.functional.SplitIT </h4><pre class="type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void interleaveSplit() throws Exception {
  Connector c=getConnector();
  String tableName=getUniqueNames(1)[0];
  c.tableOperations().create(tableName);
  c.tableOperations().setProperty(tableName,Property.TABLE_SPLIT_THRESHOLD.getKey(),"10K");
  c.tableOperations().setProperty(tableName,Property.TABLE_FILE_COMPRESSION_TYPE.getKey(),"none");
  sleepUninterruptibly(5,TimeUnit.SECONDS);
  ReadWriteIT.interleaveTest(c,tableName);
  sleepUninterruptibly(5,TimeUnit.SECONDS);
  int numSplits=c.tableOperations().listSplits(tableName).size();
  while (numSplits <= 20) {
    log.info("Waiting for splits to happen");
    Thread.sleep(2000);
    numSplits=c.tableOperations().listSplits(tableName).size();
  }
  assertTrue("Expected at least 20 splits, saw " + numSplits,numSplits > 20);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.functional.TableIT </h4><pre class="type-9 type-5 type-3 type-21 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test() throws Exception {
  Assume.assumeThat(getClusterType(),CoreMatchers.is(ClusterType.MINI));
  AccumuloCluster cluster=getCluster();
  MiniAccumuloClusterImpl mac=(MiniAccumuloClusterImpl)cluster;
  String rootPath=mac.getConfig().getDir().getAbsolutePath();
  Connector c=getConnector();
  TableOperations to=c.tableOperations();
  String tableName=getUniqueNames(1)[0];
  to.create(tableName);
  TestIngest.Opts opts=new TestIngest.Opts();
  VerifyIngest.Opts vopts=new VerifyIngest.Opts();
  ClientConfiguration clientConfig=getCluster().getClientConfig();
  if (clientConfig.getBoolean(ClientProperty.INSTANCE_RPC_SASL_ENABLED.getKey(),false)) {
    opts.updateKerberosCredentials(clientConfig);
    vopts.updateKerberosCredentials(clientConfig);
  }
 else {
    opts.setPrincipal(getAdminPrincipal());
    vopts.setPrincipal(getAdminPrincipal());
  }
  opts.setTableName(tableName);
  TestIngest.ingest(c,opts,new BatchWriterOpts());
  to.flush(tableName,null,null,true);
  vopts.setTableName(tableName);
  VerifyIngest.verifyIngest(c,vopts,new ScannerOpts());
  String id=to.tableIdMap().get(tableName);
  Scanner s=c.createScanner(MetadataTable.NAME,Authorizations.EMPTY);
  s.setRange(new KeyExtent(new Text(id),null,null).toMetadataRange());
  s.fetchColumnFamily(MetadataSchema.TabletsSection.DataFileColumnFamily.NAME);
  assertTrue(Iterators.size(s.iterator()) > 0);
  FileSystem fs=getCluster().getFileSystem();
  assertTrue(fs.listStatus(new Path(rootPath + "/accumulo/tables/" + id)).length > 0);
  to.delete(tableName);
  assertEquals(0,Iterators.size(s.iterator()));
  try {
    assertEquals(0,fs.listStatus(new Path(rootPath + "/accumulo/tables/" + id)).length);
  }
 catch (  FileNotFoundException ex) {
  }
  assertNull(to.tableIdMap().get(tableName));
  to.create(tableName);
  TestIngest.ingest(c,opts,new BatchWriterOpts());
  VerifyIngest.verifyIngest(c,vopts,new ScannerOpts());
  to.delete(tableName);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.functional.TabletStateChangeIteratorIT </h4><pre class="type-9 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test() throws AccumuloException, AccumuloSecurityException, TableExistsException, TableNotFoundException {
  String[] tables=getUniqueNames(4);
  final String t1=tables[0];
  final String t2=tables[1];
  final String t3=tables[2];
  final String cloned=tables[3];
  createTable(t1,true);
  createTable(t2,false);
  createTable(t3,true);
  cloneMetadataTable(cloned);
  State state=new State();
  assertEquals("No tables should need attention",0,findTabletsNeedingAttention(cloned,state));
  removeLocation(cloned,t3);
  assertEquals("Should have two tablets without a loc",2,findTabletsNeedingAttention(cloned,state));
  getConnector().tableOperations().delete(cloned);
  cloneMetadataTable(cloned);
  reassignLocation(cloned,t3);
  assertEquals("Should have one tablet that needs to be unassigned",1,findTabletsNeedingAttention(cloned,state));
  state=new State(){
    @Override public Collection<MergeInfo> merges(){
      String tableIdToModify=getConnector().tableOperations().tableIdMap().get(t3);
      return Collections.singletonList(new MergeInfo(new KeyExtent(new Text(tableIdToModify),null,null),MergeInfo.Operation.MERGE));
    }
  }
;
  assertEquals("Should have 2 tablets that need to be chopped or unassigned",1,findTabletsNeedingAttention(cloned,state));
  state=new State();
  cloneMetadataTable(cloned);
  addDuplicateLocation(cloned,t3);
  assertEquals("Should have 1 tablet that needs a metadata repair",1,findTabletsNeedingAttention(cloned,state));
  dropTables(t1,t2,t3,cloned);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.functional.WALSunnyDayIT </h4><pre class="type-9 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test() throws Exception {
  MiniAccumuloClusterImpl mac=getCluster();
  MiniAccumuloClusterControl control=mac.getClusterControl();
  control.stop(GARBAGE_COLLECTOR);
  Connector c=getConnector();
  String tableName=getUniqueNames(1)[0];
  c.tableOperations().create(tableName);
  writeSomeData(c,tableName,1,1);
  Map<String,Boolean> wals=getWals(c);
  assertEquals(wals.toString(),2,wals.size());
  for (  Boolean b : wals.values()) {
    assertTrue("logs should be in use",b.booleanValue());
  }
  writeSomeData(c,tableName,1001,50);
  Map<String,Boolean> walsAfterRoll=getWals(c);
  assertEquals("should have 3 WALs after roll",3,walsAfterRoll.size());
  assertTrue("new WALs should be a superset of the old WALs",walsAfterRoll.keySet().containsAll(wals.keySet()));
  assertEquals("all WALs should be in use",3,countTrue(walsAfterRoll.values()));
  for (  String table : new String[]{tableName,MetadataTable.NAME,RootTable.NAME}) {
    c.tableOperations().flush(table,null,null,true);
  }
  sleepUninterruptibly(1,TimeUnit.SECONDS);
  Map<String,Boolean> walsAfterflush=getWals(c);
  assertEquals(walsAfterflush.toString(),3,walsAfterflush.size());
  assertEquals("inUse should be 2",2,countTrue(walsAfterflush.values()));
  control.start(GARBAGE_COLLECTOR);
  sleepUninterruptibly(5,TimeUnit.SECONDS);
  Map<String,Boolean> walsAfterGC=getWals(c);
  assertEquals(walsAfterGC.toString(),2,walsAfterGC.size());
  control.stop(GARBAGE_COLLECTOR);
  control.stop(TABLET_SERVER);
  assertEquals(0,cluster.exec(SetGoalState.class,"SAFE_MODE").waitFor());
  control.start(TABLET_SERVER);
  getRecoveryMarkers(c);
  sleepUninterruptibly(5,TimeUnit.SECONDS);
  Map<KeyExtent,List<String>> markers=getRecoveryMarkers(c);
  assertEquals("one tablet should have markers",1,markers.keySet().size());
  assertEquals("tableId of the keyExtent should be 1",markers.keySet().iterator().next().getTableId(),new Text("1"));
  assertEquals(0,cluster.exec(SetGoalState.class,"NORMAL").waitFor());
  verifySomeData(c,tableName,1001 * 50 + 1);
  writeSomeData(c,tableName,100,100);
  Map<String,Boolean> walsAfterRestart=getWals(c);
  assertEquals("used WALs after restart should be 4",4,countTrue(walsAfterRestart.values()));
  control.start(GARBAGE_COLLECTOR);
  sleepUninterruptibly(5,TimeUnit.SECONDS);
  Map<String,Boolean> walsAfterRestartAndGC=getWals(c);
  assertEquals("wals left should be 2",2,walsAfterRestartAndGC.size());
  assertEquals("logs in use should be 2",2,countTrue(walsAfterRestartAndGC.values()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.functional.WatchTheWatchCountIT </h4><pre class="type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void test() throws Exception {
  Connector c=getConnector();
  String[] tableNames=getUniqueNames(3);
  for (  String tableName : tableNames) {
    c.tableOperations().create(tableName);
  }
  c.tableOperations().list();
  String zooKeepers=c.getInstance().getZooKeepers();
  final long MIN=475L;
  final long MAX=700L;
  long total=0;
  final HostAndPort hostAndPort=HostAndPort.fromString(zooKeepers);
  for (int i=0; i < 5; i++) {
    Socket socket=new Socket(hostAndPort.getHostText(),hostAndPort.getPort());
    try {
      socket.getOutputStream().write("wchs\n".getBytes(),0,5);
      byte[] buffer=new byte[1024];
      int n=socket.getInputStream().read(buffer);
      String response=new String(buffer,0,n);
      total=Long.parseLong(response.split(":")[1].trim());
      log.info("Total: {}",total);
      if (total > MIN && total < MAX) {
        break;
      }
      log.debug("Expected number of watchers to be contained in ({}, {}), but actually was {}. Sleeping and retrying",MIN,MAX,total);
      Thread.sleep(5000);
    }
  finally {
      socket.close();
    }
  }
  assertTrue("Expected number of watchers to be contained in (" + MIN + ", "+ MAX+ "), but actually was "+ total,total > MIN && total < MAX);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.gc.replication.CloseWriteAheadLogReferencesIT </h4><pre class="type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void unclosedWalsLeaveStatusOpen() throws Exception {
  Set<String> wals=Collections.emptySet();
  BatchWriter bw=conn.createBatchWriter(MetadataTable.NAME,new BatchWriterConfig());
  Mutation m=new Mutation(ReplicationSection.getRowPrefix() + "file:/accumulo/wal/tserver+port/12345");
  m.put(ReplicationSection.COLF,new Text("1"),StatusUtil.fileCreatedValue(System.currentTimeMillis()));
  bw.addMutation(m);
  bw.close();
  refs.updateReplicationEntries(conn,wals);
  Scanner s=conn.createScanner(MetadataTable.NAME,Authorizations.EMPTY);
  s.fetchColumnFamily(ReplicationSection.COLF);
  Entry<Key,Value> entry=Iterables.getOnlyElement(s);
  Status status=Status.parseFrom(entry.getValue().get());
  Assert.assertFalse(status.getClosed());
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void closedWalsUpdateStatus() throws Exception {
  String file="file:/accumulo/wal/tserver+port/12345";
  Set<String> wals=Collections.singleton(file);
  BatchWriter bw=conn.createBatchWriter(MetadataTable.NAME,new BatchWriterConfig());
  Mutation m=new Mutation(ReplicationSection.getRowPrefix() + file);
  m.put(ReplicationSection.COLF,new Text("1"),StatusUtil.fileCreatedValue(System.currentTimeMillis()));
  bw.addMutation(m);
  bw.close();
  refs.updateReplicationEntries(conn,wals);
  Scanner s=conn.createScanner(MetadataTable.NAME,Authorizations.EMPTY);
  s.fetchColumnFamily(ReplicationSection.COLF);
  Entry<Key,Value> entry=Iterables.getOnlyElement(s);
  Status status=Status.parseFrom(entry.getValue().get());
  Assert.assertTrue(status.getClosed());
}

</code></pre>

<br>
<pre class="type-9 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void partiallyReplicatedReferencedWalsAreNotClosed() throws Exception {
  String file="file:/accumulo/wal/tserver+port/12345";
  Set<String> wals=Collections.singleton(file);
  BatchWriter bw=ReplicationTable.getBatchWriter(conn);
  Mutation m=new Mutation(file);
  StatusSection.add(m,new Text("1"),ProtobufUtil.toValue(StatusUtil.ingestedUntil(1000)));
  bw.addMutation(m);
  bw.close();
  refs.updateReplicationEntries(conn,wals);
  Scanner s=ReplicationTable.getScanner(conn);
  Entry<Key,Value> entry=Iterables.getOnlyElement(s);
  Status status=Status.parseFrom(entry.getValue().get());
  Assert.assertFalse(status.getClosed());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.mapred.AccumuloOutputFormatIT </h4><pre class="type-9 type-5 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMR() throws Exception {
  Connector c=getConnector();
  String instanceName=getCluster().getInstanceName();
  String table1=instanceName + "_t1";
  String table2=instanceName + "_t2";
  c.tableOperations().create(table1);
  c.tableOperations().create(table2);
  BatchWriter bw=c.createBatchWriter(table1,new BatchWriterConfig());
  for (int i=0; i < 100; i++) {
    Mutation m=new Mutation(new Text(String.format("%09x",i + 1)));
    m.put(new Text(),new Text(),new Value(String.format("%09x",i).getBytes()));
    bw.addMutation(m);
  }
  bw.close();
  MRTester.main(new String[]{"root",ROOT_PASSWORD,table1,table2,instanceName,getCluster().getZooKeepers()});
  assertNull(e1);
  Scanner scanner=c.createScanner(table2,new Authorizations());
  Iterator<Entry<Key,Value>> iter=scanner.iterator();
  assertTrue(iter.hasNext());
  Entry<Key,Value> entry=iter.next();
  assertEquals(Integer.parseInt(new String(entry.getValue().get())),100);
  assertFalse(iter.hasNext());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.mapred.TokenFileIT </h4><pre class="type-9 type-5 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMR() throws Exception {
  String[] tableNames=getUniqueNames(2);
  String table1=tableNames[0];
  String table2=tableNames[1];
  Connector c=getConnector();
  c.tableOperations().create(table1);
  c.tableOperations().create(table2);
  BatchWriter bw=c.createBatchWriter(table1,new BatchWriterConfig());
  for (int i=0; i < 100; i++) {
    Mutation m=new Mutation(new Text(String.format("%09x",i + 1)));
    m.put(new Text(),new Text(),new Value(String.format("%09x",i).getBytes()));
    bw.addMutation(m);
  }
  bw.close();
  File tf=folder.newFile("root_test.pw");
  PrintStream out=new PrintStream(tf);
  String outString=new Credentials(getAdminPrincipal(),getAdminToken()).serialize();
  out.println(outString);
  out.close();
  MRTokenFileTester.main(new String[]{tf.getAbsolutePath(),table1,table2});
  assertNull(e1);
  Scanner scanner=c.createScanner(table2,new Authorizations());
  Iterator<Entry<Key,Value>> iter=scanner.iterator();
  assertTrue(iter.hasNext());
  Entry<Key,Value> entry=iter.next();
  assertEquals(Integer.parseInt(new String(entry.getValue().get())),100);
  assertFalse(iter.hasNext());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.mapreduce.AccumuloInputFormatIT </h4><pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCorrectRangeInputSplits() throws Exception {
  Job job=Job.getInstance();
  String table=getUniqueNames(1)[0];
  Authorizations auths=new Authorizations("foo");
  Collection<Pair<Text,Text>> fetchColumns=Collections.singleton(new Pair<Text,Text>(new Text("foo"),new Text("bar")));
  boolean isolated=true, localIters=true;
  Level level=Level.WARN;
  Connector connector=getConnector();
  connector.tableOperations().create(table);
  AccumuloInputFormat.setZooKeeperInstance(job,cluster.getClientConfig());
  AccumuloInputFormat.setConnectorInfo(job,getAdminPrincipal(),getAdminToken());
  AccumuloInputFormat.setInputTableName(job,table);
  AccumuloInputFormat.setScanAuthorizations(job,auths);
  AccumuloInputFormat.setScanIsolation(job,isolated);
  AccumuloInputFormat.setLocalIterators(job,localIters);
  AccumuloInputFormat.fetchColumns(job,fetchColumns);
  AccumuloInputFormat.setLogLevel(job,level);
  AccumuloInputFormat aif=new AccumuloInputFormat();
  List<InputSplit> splits=aif.getSplits(job);
  Assert.assertEquals(1,splits.size());
  InputSplit split=splits.get(0);
  Assert.assertEquals(RangeInputSplit.class,split.getClass());
  RangeInputSplit risplit=(RangeInputSplit)split;
  Assert.assertEquals(getAdminPrincipal(),risplit.getPrincipal());
  Assert.assertEquals(table,risplit.getTableName());
  Assert.assertEquals(getAdminToken(),risplit.getToken());
  Assert.assertEquals(auths,risplit.getAuths());
  Assert.assertEquals(getConnector().getInstance().getInstanceName(),risplit.getInstanceName());
  Assert.assertEquals(isolated,risplit.isIsolatedScan());
  Assert.assertEquals(localIters,risplit.usesLocalIterators());
  Assert.assertEquals(fetchColumns,risplit.getFetchedColumns());
  Assert.assertEquals(level,risplit.getLogLevel());
}

</code></pre>

<br>
<pre class="type-9 type-8 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests several different paths through the getSplits() method by setting different properties and verifying the results.
 */
@Test public void testGetSplits() throws Exception {
  Connector conn=getConnector();
  String table=getUniqueNames(1)[0];
  conn.tableOperations().create(table);
  insertData(table,currentTimeMillis());
  ClientConfiguration clientConf=cluster.getClientConfig();
  AccumuloConfiguration clusterClientConf=new ConfigurationCopy(new DefaultConfiguration());
  boolean sslEnabled=Boolean.valueOf(clusterClientConf.get(Property.INSTANCE_RPC_SSL_ENABLED));
  if (sslEnabled) {
    ClientProperty[] sslProperties=new ClientProperty[]{ClientProperty.INSTANCE_RPC_SSL_ENABLED,ClientProperty.INSTANCE_RPC_SSL_CLIENT_AUTH,ClientProperty.RPC_SSL_KEYSTORE_PATH,ClientProperty.RPC_SSL_KEYSTORE_TYPE,ClientProperty.RPC_SSL_KEYSTORE_PASSWORD,ClientProperty.RPC_SSL_TRUSTSTORE_PATH,ClientProperty.RPC_SSL_TRUSTSTORE_TYPE,ClientProperty.RPC_SSL_TRUSTSTORE_PASSWORD,ClientProperty.RPC_USE_JSSE,ClientProperty.GENERAL_SECURITY_CREDENTIAL_PROVIDER_PATHS};
    for (    ClientProperty prop : sslProperties) {
      clientConf.setProperty(prop,clusterClientConf.get(prop.getKey()));
    }
  }
  Job job=Job.getInstance();
  AccumuloInputFormat.setInputTableName(job,table);
  AccumuloInputFormat.setZooKeeperInstance(job,clientConf);
  AccumuloInputFormat.setConnectorInfo(job,getAdminPrincipal(),getAdminToken());
  TreeSet<Text> splitsToAdd=new TreeSet<Text>();
  for (int i=0; i < 10000; i+=1000)   splitsToAdd.add(new Text(String.format("%09d",i)));
  conn.tableOperations().addSplits(table,splitsToAdd);
  sleepUninterruptibly(500,TimeUnit.MILLISECONDS);
  Collection<Text> actualSplits=conn.tableOperations().listSplits(table);
  List<InputSplit> splits=inputFormat.getSplits(job);
  assertEquals(actualSplits.size() + 1,splits.size());
  List<Range> ranges=new ArrayList<Range>();
  for (  Text text : actualSplits)   ranges.add(new Range(text));
  AccumuloInputFormat.setRanges(job,ranges);
  splits=inputFormat.getSplits(job);
  assertEquals(actualSplits.size(),splits.size());
  AccumuloInputFormat.setOfflineTableScan(job,true);
  try {
    inputFormat.getSplits(job);
    fail("An exception should have been thrown");
  }
 catch (  IOException e) {
  }
  conn.tableOperations().offline(table,true);
  splits=inputFormat.getSplits(job);
  assertEquals(actualSplits.size(),splits.size());
  ranges=new ArrayList<Range>();
  for (int i=0; i < 5; i++)   ranges.add(new Range(String.format("%09d",i),String.format("%09d",i + 2)));
  AccumuloInputFormat.setRanges(job,ranges);
  splits=inputFormat.getSplits(job);
  assertEquals(2,splits.size());
  AccumuloInputFormat.setAutoAdjustRanges(job,false);
  splits=inputFormat.getSplits(job);
  assertEquals(ranges.size(),splits.size());
  AccumuloInputFormat.setBatchScan(job,true);
  AccumuloInputFormat.setAutoAdjustRanges(job,true);
  AccumuloInputFormat.setOfflineTableScan(job,true);
  try {
    inputFormat.getSplits(job);
    fail("An exception should have been thrown");
  }
 catch (  IllegalArgumentException e) {
  }
  conn.tableOperations().online(table,true);
  AccumuloInputFormat.setOfflineTableScan(job,false);
  splits=inputFormat.getSplits(job);
  assertEquals(2,splits.size());
  AccumuloInputFormat.setScanIsolation(job,true);
  try {
    inputFormat.getSplits(job);
    fail("An exception should have been thrown");
  }
 catch (  IllegalArgumentException e) {
  }
  AccumuloInputFormat.setScanIsolation(job,false);
  splits=inputFormat.getSplits(job);
  assertEquals(2,splits.size());
  AccumuloInputFormat.setLocalIterators(job,true);
  try {
    inputFormat.getSplits(job);
    fail("An exception should have been thrown");
  }
 catch (  IllegalArgumentException e) {
  }
  AccumuloInputFormat.setLocalIterators(job,false);
  conn.tableOperations().online(table);
  splits=inputFormat.getSplits(job);
  for (  InputSplit split : splits)   assert (split instanceof BatchInputSplit);
  assertEquals(2,splits.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.mapreduce.AccumuloOutputFormatIT </h4><pre class="type-9 type-5 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMR() throws Exception {
  String[] tableNames=getUniqueNames(2);
  String table1=tableNames[0];
  String table2=tableNames[1];
  Connector c=getConnector();
  c.tableOperations().create(table1);
  c.tableOperations().create(table2);
  BatchWriter bw=c.createBatchWriter(table1,new BatchWriterConfig());
  for (int i=0; i < 100; i++) {
    Mutation m=new Mutation(new Text(String.format("%09x",i + 1)));
    m.put(new Text(),new Text(),new Value(String.format("%09x",i).getBytes()));
    bw.addMutation(m);
  }
  bw.close();
  MRTester.main(new String[]{table1,table2});
  assertNull(e1);
  Scanner scanner=c.createScanner(table2,new Authorizations());
  Iterator<Entry<Key,Value>> iter=scanner.iterator();
  assertTrue(iter.hasNext());
  Entry<Key,Value> entry=iter.next();
  assertEquals(Integer.parseInt(new String(entry.getValue().get())),100);
  assertFalse(iter.hasNext());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.mapreduce.TokenFileIT </h4><pre class="type-9 type-5 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMR() throws Exception {
  String[] tableNames=getUniqueNames(2);
  String table1=tableNames[0];
  String table2=tableNames[1];
  Connector c=getConnector();
  c.tableOperations().create(table1);
  c.tableOperations().create(table2);
  BatchWriter bw=c.createBatchWriter(table1,new BatchWriterConfig());
  for (int i=0; i < 100; i++) {
    Mutation m=new Mutation(new Text(String.format("%09x",i + 1)));
    m.put(new Text(),new Text(),new Value(String.format("%09x",i).getBytes()));
    bw.addMutation(m);
  }
  bw.close();
  File tf=folder.newFile("root_test.pw");
  PrintStream out=new PrintStream(tf);
  String outString=new Credentials(getAdminPrincipal(),getAdminToken()).serialize();
  out.println(outString);
  out.close();
  MRTokenFileTester.main(new String[]{tf.getAbsolutePath(),table1,table2});
  assertNull(e1);
  Scanner scanner=c.createScanner(table2,new Authorizations());
  Iterator<Entry<Key,Value>> iter=scanner.iterator();
  assertTrue(iter.hasNext());
  Entry<Key,Value> entry=iter.next();
  assertEquals(Integer.parseInt(new String(entry.getValue().get())),100);
  assertFalse(iter.hasNext());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.master.MergeStateIT </h4><pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test() throws Exception {
  AccumuloServerContext context=EasyMock.createMock(AccumuloServerContext.class);
  Connector connector=getConnector();
  EasyMock.expect(context.getConnector()).andReturn(connector).anyTimes();
  EasyMock.replay(context);
  connector.securityOperations().grantTablePermission(connector.whoami(),MetadataTable.NAME,TablePermission.WRITE);
  BatchWriter bw=connector.createBatchWriter(MetadataTable.NAME,new BatchWriterConfig());
  String splits[]={"a","e","j","o","t","z"};
  Text tableId=new Text("t");
  Text pr=null;
  for (  String s : splits) {
    Text split=new Text(s);
    Mutation prevRow=KeyExtent.getPrevRowUpdateMutation(new KeyExtent(tableId,split,pr));
    prevRow.put(TabletsSection.CurrentLocationColumnFamily.NAME,new Text("123456"),new Value("127.0.0.1:1234".getBytes()));
    ChoppedColumnFamily.CHOPPED_COLUMN.put(prevRow,new Value("junk".getBytes()));
    bw.addMutation(prevRow);
    pr=split;
  }
  Mutation defaultTablet=KeyExtent.getPrevRowUpdateMutation(new KeyExtent(tableId,null,pr));
  defaultTablet.put(TabletsSection.CurrentLocationColumnFamily.NAME,new Text("123456"),new Value("127.0.0.1:1234".getBytes()));
  bw.addMutation(defaultTablet);
  bw.close();
  MockCurrentState state=new MockCurrentState(new MergeInfo(new KeyExtent(tableId,new Text("p"),new Text("e")),MergeInfo.Operation.MERGE));
  MetaDataStateStore metaDataStateStore=new MetaDataStateStore(context,state);
  int count=0;
  for (  TabletLocationState tss : metaDataStateStore) {
    if (tss != null)     count++;
  }
  Assert.assertEquals(0,count);
  Mutation m=new KeyExtent(tableId,new Text("t"),new Text("p")).getPrevRowUpdateMutation();
  TabletsSection.TabletColumnFamily.SPLIT_RATIO_COLUMN.put(m,new Value("0.5".getBytes()));
  TabletsSection.TabletColumnFamily.OLD_PREV_ROW_COLUMN.put(m,KeyExtent.encodePrevEndRow(new Text("o")));
  update(connector,m);
  MergeStats stats=scan(state,metaDataStateStore);
  MergeState newState=stats.nextMergeState(connector,state);
  Assert.assertEquals(MergeState.WAITING_FOR_OFFLINE,newState);
  BatchDeleter deleter=connector.createBatchDeleter(MetadataTable.NAME,Authorizations.EMPTY,1000,new BatchWriterConfig());
  deleter.fetchColumnFamily(TabletsSection.CurrentLocationColumnFamily.NAME);
  deleter.setRanges(Collections.singletonList(new Range()));
  deleter.delete();
  stats=scan(state,metaDataStateStore);
  Assert.assertEquals(MergeState.WAITING_FOR_OFFLINE,stats.nextMergeState(connector,state));
  KeyExtent tablet=new KeyExtent(tableId,new Text("p"),new Text("o"));
  m=tablet.getPrevRowUpdateMutation();
  TabletsSection.TabletColumnFamily.SPLIT_RATIO_COLUMN.put(m,new Value("0.5".getBytes()));
  update(connector,m);
  metaDataStateStore.setLocations(Collections.singletonList(new Assignment(tablet,state.someTServer)));
  stats=scan(state,metaDataStateStore);
  Assert.assertEquals(MergeState.WAITING_FOR_CHOPPED,stats.nextMergeState(connector,state));
  m=tablet.getPrevRowUpdateMutation();
  ChoppedColumnFamily.CHOPPED_COLUMN.put(m,new Value("junk".getBytes()));
  update(connector,m);
  stats=scan(state,metaDataStateStore);
  Assert.assertEquals(MergeState.WAITING_FOR_OFFLINE,stats.nextMergeState(connector,state));
  m=tablet.getPrevRowUpdateMutation();
  Collection<Collection<String>> walogs=Collections.emptyList();
  metaDataStateStore.unassign(Collections.singletonList(new TabletLocationState(tablet,null,state.someTServer,null,walogs,false)),null);
  stats=scan(state,metaDataStateStore);
  Assert.assertEquals(MergeState.MERGING,stats.nextMergeState(connector,state));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.proxy.ProxyDurabilityIT </h4><pre class="type-9 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDurability() throws Exception {
  Connector c=getConnector();
  Properties props=new Properties();
  File emptyFile=Files.createTempFile(null,null).toFile();
  emptyFile.deleteOnExit();
  props.put("instance",c.getInstance().getInstanceName());
  props.put("zookeepers",c.getInstance().getZooKeepers());
  props.put("tokenClass",PasswordToken.class.getName());
  props.put("clientConfigurationFile",emptyFile.toString());
  TJSONProtocol.Factory protocol=new TJSONProtocol.Factory();
  int proxyPort=PortUtils.getRandomFreePort();
  final TServer proxyServer=Proxy.createProxyServer(HostAndPort.fromParts("localhost",proxyPort),protocol,props).server;
  while (!proxyServer.isServing())   sleepUninterruptibly(100,TimeUnit.MILLISECONDS);
  Client client=new TestProxyClient("localhost",proxyPort,protocol).proxy();
  Map<String,String> properties=new TreeMap<String,String>();
  properties.put("password",ROOT_PASSWORD);
  ByteBuffer login=client.login("root",properties);
  String tableName=getUniqueNames(1)[0];
  client.createTable(login,tableName,true,TimeType.MILLIS);
  assertTrue(c.tableOperations().exists(tableName));
  WriterOptions options=new WriterOptions();
  options.setDurability(Durability.NONE);
  String writer=client.createWriter(login,tableName,options);
  Map<ByteBuffer,List<ColumnUpdate>> cells=new TreeMap<ByteBuffer,List<ColumnUpdate>>();
  ColumnUpdate column=new ColumnUpdate(bytes("cf"),bytes("cq"));
  column.setValue("value".getBytes());
  cells.put(bytes("row"),Collections.singletonList(column));
  client.update(writer,cells);
  client.closeWriter(writer);
  assertEquals(1,count(tableName));
  restartTServer();
  assertEquals(0,count(tableName));
  ConditionalWriterOptions cfg=new ConditionalWriterOptions();
  cfg.setDurability(Durability.SYNC);
  String cwriter=client.createConditionalWriter(login,tableName,cfg);
  ConditionalUpdates updates=new ConditionalUpdates();
  updates.addToConditions(new Condition(new Column(bytes("cf"),bytes("cq"),bytes(""))));
  updates.addToUpdates(column);
  Map<ByteBuffer,ConditionalStatus> status=client.updateRowsConditionally(cwriter,Collections.singletonMap(bytes("row"),updates));
  assertEquals(ConditionalStatus.ACCEPTED,status.get(bytes("row")));
  assertEquals(1,count(tableName));
  restartTServer();
  assertEquals(1,count(tableName));
  proxyServer.stop();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.proxy.SimpleProxyBase </h4><pre class="type-9 type-13 type-8 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConditionalWriter() throws Exception {
  log.debug("Adding constraint {} to {}",table,NumericValueConstraint.class.getName());
  client.addConstraint(creds,table,NumericValueConstraint.class.getName());
  sleepUninterruptibly(ZOOKEEPER_PROPAGATION_TIME,TimeUnit.MILLISECONDS);
  while (!client.listConstraints(creds,table).containsKey(NumericValueConstraint.class.getName())) {
    log.info("Failed to see constraint");
    Thread.sleep(1000);
  }
  String cwid=client.createConditionalWriter(creds,table,new ConditionalWriterOptions());
  Map<ByteBuffer,ConditionalUpdates> updates=new HashMap<ByteBuffer,ConditionalUpdates>();
  updates.put(s2bb("00345"),new ConditionalUpdates(Arrays.asList(newCondition("meta","seq")),Arrays.asList(newColUpdate("meta","seq",10,"1"),newColUpdate("data","img","73435435"))));
  Map<ByteBuffer,ConditionalStatus> results=client.updateRowsConditionally(cwid,updates);
  assertEquals(1,results.size());
  assertEquals(ConditionalStatus.ACCEPTED,results.get(s2bb("00345")));
  assertScan(new String[][]{{"00345","data","img","73435435"},{"00345","meta","seq","1"}},table);
  updates.clear();
  updates.put(s2bb("00345"),new ConditionalUpdates(Arrays.asList(newCondition("meta","seq")),Arrays.asList(newColUpdate("meta","seq","2"))));
  updates.put(s2bb("00346"),new ConditionalUpdates(Arrays.asList(newCondition("meta","seq")),Arrays.asList(newColUpdate("meta","seq","1"))));
  results=client.updateRowsConditionally(cwid,updates);
  assertEquals(2,results.size());
  assertEquals(ConditionalStatus.REJECTED,results.get(s2bb("00345")));
  assertEquals(ConditionalStatus.ACCEPTED,results.get(s2bb("00346")));
  assertScan(new String[][]{{"00345","data","img","73435435"},{"00345","meta","seq","1"},{"00346","meta","seq","1"}},table);
  updates.clear();
  updates.put(s2bb("00345"),new ConditionalUpdates(Arrays.asList(newCondition("meta","seq","1")),Arrays.asList(newColUpdate("meta","seq",20,"2"),newColUpdate("data","img","567890"))));
  updates.put(s2bb("00346"),new ConditionalUpdates(Arrays.asList(newCondition("meta","seq","2")),Arrays.asList(newColUpdate("meta","seq","3"))));
  results=client.updateRowsConditionally(cwid,updates);
  assertEquals(2,results.size());
  assertEquals(ConditionalStatus.ACCEPTED,results.get(s2bb("00345")));
  assertEquals(ConditionalStatus.REJECTED,results.get(s2bb("00346")));
  assertScan(new String[][]{{"00345","data","img","567890"},{"00345","meta","seq","2"},{"00346","meta","seq","1"}},table);
  updates.clear();
  updates.put(s2bb("00345"),new ConditionalUpdates(Arrays.asList(newCondition("meta","seq",10,"2")),Arrays.asList(newColUpdate("meta","seq",30,"3"),newColUpdate("data","img","1234567890"))));
  results=client.updateRowsConditionally(cwid,updates);
  assertEquals(1,results.size());
  assertEquals(ConditionalStatus.REJECTED,results.get(s2bb("00345")));
  assertScan(new String[][]{{"00345","data","img","567890"},{"00345","meta","seq","2"},{"00346","meta","seq","1"}},table);
  updates.clear();
  updates.put(s2bb("00345"),new ConditionalUpdates(Arrays.asList(newCondition("meta","seq",20,"2")),Arrays.asList(newColUpdate("meta","seq",30,"3"),newColUpdate("data","img","1234567890"))));
  results=client.updateRowsConditionally(cwid,updates);
  assertEquals(1,results.size());
  assertEquals(ConditionalStatus.ACCEPTED,results.get(s2bb("00345")));
  assertScan(new String[][]{{"00345","data","img","1234567890"},{"00345","meta","seq","3"},{"00346","meta","seq","1"}},table);
  client.updateAndFlush(creds,table,Collections.singletonMap(s2bb("00347"),Arrays.asList(newColUpdate("data","count","1"))));
  client.updateAndFlush(creds,table,Collections.singletonMap(s2bb("00347"),Arrays.asList(newColUpdate("data","count","1"))));
  client.updateAndFlush(creds,table,Collections.singletonMap(s2bb("00347"),Arrays.asList(newColUpdate("data","count","1"))));
  updates.clear();
  updates.put(s2bb("00347"),new ConditionalUpdates(Arrays.asList(newCondition("data","count","3")),Arrays.asList(newColUpdate("data","img","1234567890"))));
  results=client.updateRowsConditionally(cwid,updates);
  assertEquals(1,results.size());
  assertEquals(ConditionalStatus.REJECTED,results.get(s2bb("00347")));
  assertScan(new String[][]{{"00345","data","img","1234567890"},{"00345","meta","seq","3"},{"00346","meta","seq","1"},{"00347","data","count","1"}},table);
  Condition iterCond=newCondition("data","count","3");
  Map<String,String> props=new HashMap<String,String>();
  props.put("type","STRING");
  props.put("columns","data:count");
  IteratorSetting is=new IteratorSetting(1,"sumc",SummingCombiner.class.getName(),props);
  iterCond.setIterators(Arrays.asList(is));
  updates.clear();
  updates.put(s2bb("00347"),new ConditionalUpdates(Arrays.asList(iterCond),Arrays.asList(newColUpdate("data","img","1234567890"))));
  results=client.updateRowsConditionally(cwid,updates);
  assertEquals(1,results.size());
  assertEquals(ConditionalStatus.ACCEPTED,results.get(s2bb("00347")));
  assertScan(new String[][]{{"00345","data","img","1234567890"},{"00345","meta","seq","3"},{"00346","meta","seq","1"},{"00347","data","count","1"},{"00347","data","img","1234567890"}},table);
  ConditionalStatus status=null;
  for (int i=0; i < 30; i++) {
    updates.clear();
    updates.put(s2bb("00347"),new ConditionalUpdates(Arrays.asList(newCondition("data","img","1234567890")),Arrays.asList(newColUpdate("data","count","A"))));
    results=client.updateRowsConditionally(cwid,updates);
    assertEquals(1,results.size());
    status=results.get(s2bb("00347"));
    if (ConditionalStatus.VIOLATED != status) {
      log.info("ConditionalUpdate was not rejected by server due to table constraint. Sleeping and retrying");
      Thread.sleep(5000);
      continue;
    }
    assertEquals(ConditionalStatus.VIOLATED,status);
    break;
  }
  assertEquals(ConditionalStatus.VIOLATED,status);
  assertScan(new String[][]{{"00345","data","img","1234567890"},{"00345","meta","seq","3"},{"00346","meta","seq","1"},{"00347","data","count","1"},{"00347","data","img","1234567890"}},table);
  updates.clear();
  updates.put(s2bb("00347"),new ConditionalUpdates(Arrays.asList(newCondition("data","img","565"),newCondition("data","count","2")),Arrays.asList(newColUpdate("data","count","3"),newColUpdate("data","img","0987654321"))));
  results=client.updateRowsConditionally(cwid,updates);
  assertEquals(1,results.size());
  assertEquals(ConditionalStatus.REJECTED,results.get(s2bb("00347")));
  assertScan(new String[][]{{"00345","data","img","1234567890"},{"00345","meta","seq","3"},{"00346","meta","seq","1"},{"00347","data","count","1"},{"00347","data","img","1234567890"}},table);
  updates.clear();
  updates.put(s2bb("00347"),new ConditionalUpdates(Arrays.asList(newCondition("data","img","1234567890"),newCondition("data","count","2")),Arrays.asList(newColUpdate("data","count","3"),newColUpdate("data","img","0987654321"))));
  results=client.updateRowsConditionally(cwid,updates);
  assertEquals(1,results.size());
  assertEquals(ConditionalStatus.REJECTED,results.get(s2bb("00347")));
  assertScan(new String[][]{{"00345","data","img","1234567890"},{"00345","meta","seq","3"},{"00346","meta","seq","1"},{"00347","data","count","1"},{"00347","data","img","1234567890"}},table);
  updates.clear();
  updates.put(s2bb("00347"),new ConditionalUpdates(Arrays.asList(newCondition("data","img","565"),newCondition("data","count","1")),Arrays.asList(newColUpdate("data","count","3"),newColUpdate("data","img","0987654321"))));
  results=client.updateRowsConditionally(cwid,updates);
  assertEquals(1,results.size());
  assertEquals(ConditionalStatus.REJECTED,results.get(s2bb("00347")));
  assertScan(new String[][]{{"00345","data","img","1234567890"},{"00345","meta","seq","3"},{"00346","meta","seq","1"},{"00347","data","count","1"},{"00347","data","img","1234567890"}},table);
  ConditionalStatus result=client.updateRowConditionally(creds,table,s2bb("00347"),new ConditionalUpdates(Arrays.asList(newCondition("data","img","1234567890"),newCondition("data","count","1")),Arrays.asList(newColUpdate("data","count","3"),newColUpdate("data","img","0987654321"))));
  assertEquals(ConditionalStatus.ACCEPTED,result);
  assertScan(new String[][]{{"00345","data","img","1234567890"},{"00345","meta","seq","3"},{"00346","meta","seq","1"},{"00347","data","count","3"},{"00347","data","img","0987654321"}},table);
  client.closeConditionalWriter(cwid);
  try {
    client.updateRowsConditionally(cwid,updates);
    fail("conditional writer not closed");
  }
 catch (  UnknownWriter uk) {
  }
  String principal;
  ClusterUser cwuser=null;
  if (isKerberosEnabled()) {
    cwuser=getKdc().getClientPrincipal(1);
    principal=cwuser.getPrincipal();
    client.createLocalUser(creds,principal,s2bb("unused"));
  }
 else {
    principal="cwuser";
    client.createLocalUser(creds,principal,s2bb("bestpasswordever"));
  }
  client.changeUserAuthorizations(creds,principal,Collections.singleton(s2bb("A")));
  client.grantTablePermission(creds,principal,table,TablePermission.WRITE);
  client.grantTablePermission(creds,principal,table,TablePermission.READ);
  TestProxyClient cwuserProxyClient=null;
  Client origClient=null;
  Map<String,String> cwProperties;
  if (isKerberosEnabled()) {
    UserGroupInformation.loginUserFromKeytab(cwuser.getPrincipal(),cwuser.getKeytab().getAbsolutePath());
    final UserGroupInformation cwuserUgi=UserGroupInformation.getCurrentUser();
    cwuserProxyClient=new TestProxyClient(hostname,proxyPort,factory,proxyPrimary,cwuserUgi);
    origClient=client;
    client=cwuserProxyClient.proxy();
    cwProperties=Collections.emptyMap();
  }
 else {
    cwProperties=Collections.singletonMap("password","bestpasswordever");
  }
  try {
    ByteBuffer cwCreds=client.login(principal,cwProperties);
    cwid=client.createConditionalWriter(cwCreds,table,new ConditionalWriterOptions().setAuthorizations(Collections.singleton(s2bb("A"))));
    updates.clear();
    updates.put(s2bb("00348"),new ConditionalUpdates(Arrays.asList(new Condition(new Column(s2bb("data"),s2bb("c"),s2bb("A")))),Arrays.asList(newColUpdate("data","seq","1"),newColUpdate("data","c","1").setColVisibility(s2bb("A")))));
    updates.put(s2bb("00349"),new ConditionalUpdates(Arrays.asList(new Condition(new Column(s2bb("data"),s2bb("c"),s2bb("B")))),Arrays.asList(newColUpdate("data","seq","1"))));
    results=client.updateRowsConditionally(cwid,updates);
    assertEquals(2,results.size());
    assertEquals(ConditionalStatus.ACCEPTED,results.get(s2bb("00348")));
    assertEquals(ConditionalStatus.INVISIBLE_VISIBILITY,results.get(s2bb("00349")));
    if (isKerberosEnabled()) {
      UserGroupInformation.loginUserFromKeytab(clientPrincipal,clientKeytab.getAbsolutePath());
      client=origClient;
    }
    assertScan(new String[][]{{"00345","data","img","1234567890"},{"00345","meta","seq","3"},{"00346","meta","seq","1"},{"00347","data","count","3"},{"00347","data","img","0987654321"},{"00348","data","seq","1"}},table);
    if (isKerberosEnabled()) {
      UserGroupInformation.loginUserFromKeytab(cwuser.getPrincipal(),cwuser.getKeytab().getAbsolutePath());
      client=cwuserProxyClient.proxy();
    }
    updates.clear();
    updates.clear();
    updates.put(s2bb("00348"),new ConditionalUpdates(Arrays.asList(new Condition(new Column(s2bb("data"),s2bb("c"),s2bb("A"))).setValue(s2bb("0"))),Arrays.asList(newColUpdate("data","seq","2"),newColUpdate("data","c","2").setColVisibility(s2bb("A")))));
    results=client.updateRowsConditionally(cwid,updates);
    assertEquals(1,results.size());
    assertEquals(ConditionalStatus.REJECTED,results.get(s2bb("00348")));
    if (isKerberosEnabled()) {
      UserGroupInformation.loginUserFromKeytab(clientPrincipal,clientKeytab.getAbsolutePath());
      client=origClient;
    }
    assertScan(new String[][]{{"00345","data","img","1234567890"},{"00345","meta","seq","3"},{"00346","meta","seq","1"},{"00347","data","count","3"},{"00347","data","img","0987654321"},{"00348","data","seq","1"}},table);
    if (isKerberosEnabled()) {
      UserGroupInformation.loginUserFromKeytab(cwuser.getPrincipal(),cwuser.getKeytab().getAbsolutePath());
      client=cwuserProxyClient.proxy();
    }
    updates.clear();
    updates.put(s2bb("00348"),new ConditionalUpdates(Arrays.asList(new Condition(new Column(s2bb("data"),s2bb("c"),s2bb("A"))).setValue(s2bb("1"))),Arrays.asList(newColUpdate("data","seq","2"),newColUpdate("data","c","2").setColVisibility(s2bb("A")))));
    results=client.updateRowsConditionally(cwid,updates);
    assertEquals(1,results.size());
    assertEquals(ConditionalStatus.ACCEPTED,results.get(s2bb("00348")));
    if (isKerberosEnabled()) {
      UserGroupInformation.loginUserFromKeytab(clientPrincipal,clientKeytab.getAbsolutePath());
      client=origClient;
    }
    assertScan(new String[][]{{"00345","data","img","1234567890"},{"00345","meta","seq","3"},{"00346","meta","seq","1"},{"00347","data","count","3"},{"00347","data","img","0987654321"},{"00348","data","seq","2"}},table);
    if (isKerberosEnabled()) {
      UserGroupInformation.loginUserFromKeytab(cwuser.getPrincipal(),cwuser.getKeytab().getAbsolutePath());
      client=cwuserProxyClient.proxy();
    }
    client.closeConditionalWriter(cwid);
    try {
      client.updateRowsConditionally(cwid,updates);
      fail("conditional writer not closed");
    }
 catch (    UnknownWriter uk) {
    }
  }
  finally {
    if (isKerberosEnabled()) {
      if (null != cwuserProxyClient) {
        cwuserProxyClient.close();
      }
      UserGroupInformation.loginUserFromKeytab(clientPrincipal,clientKeytab.getAbsolutePath());
      client=origClient;
    }
    client.dropLocalUser(creds,principal);
  }
}

</code></pre>

<br>
<pre class="type-9 type-11 type-8 type-5 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void attachIteratorWithCompactions() throws Exception {
  if (client.tableExists(creds,"slow")) {
    client.deleteTable(creds,"slow");
  }
  client.createTable(creds,"slow",true,TimeType.MILLIS);
  IteratorSetting setting=new IteratorSetting(100,"slow",SlowIterator.class.getName(),Collections.singletonMap("sleepTime","250"));
  client.attachIterator(creds,"slow",setting,EnumSet.allOf(IteratorScope.class));
  for (int i=0; i < 40; i++) {
    client.updateAndFlush(creds,"slow",mutation("row" + i,"cf","cq","value"));
  }
  Map<String,String> map=client.tableIdMap(creds);
  Thread t=new Thread(){
    @Override public void run(){
      TestProxyClient proxyClient2=null;
      try {
        if (isKerberosEnabled()) {
          UserGroupInformation.loginUserFromKeytab(clientPrincipal,clientKeytab.getAbsolutePath());
          proxyClient2=new TestProxyClient(hostname,proxyPort,factory,proxyPrimary,UserGroupInformation.getCurrentUser());
        }
 else {
          proxyClient2=new TestProxyClient(hostname,proxyPort,factory);
        }
        Client client2=proxyClient2.proxy();
        client2.compactTable(creds,"slow",null,null,null,true,true,null);
      }
 catch (      Exception e) {
        throw new RuntimeException(e);
      }
 finally {
        if (null != proxyClient2) {
          proxyClient2.close();
        }
      }
    }
  }
;
  t.start();
  final String desiredTableId=map.get("slow");
  assertNotNull(desiredTableId);
  List<ActiveCompaction> compactions=new ArrayList<ActiveCompaction>();
  for (int i=0; i < 100 && compactions.isEmpty(); i++) {
    for (    String tserver : client.getTabletServers(creds)) {
      List<ActiveCompaction> compactionsOnServer=client.getActiveCompactions(creds,tserver);
      for (      ActiveCompaction compact : compactionsOnServer) {
        if (desiredTableId.equals(compact.getExtent().tableId)) {
          compactions.add(compact);
        }
      }
      if (!compactions.isEmpty())       break;
    }
    sleepUninterruptibly(10,TimeUnit.MILLISECONDS);
  }
  t.join();
  assertFalse(compactions.isEmpty());
  for (  ActiveCompaction c : compactions) {
    if (desiredTableId.equals(c.getExtent().tableId)) {
      assertTrue(c.inputFiles.isEmpty());
      assertEquals(CompactionType.MINOR,c.getType());
      assertEquals(CompactionReason.USER,c.getReason());
      assertEquals("",c.localityGroup);
      assertTrue(c.outputFile.contains("default_tablet"));
      return;
    }
  }
  fail("Expection to find running compaction for table 'slow' but did not find one");
}

</code></pre>

<br>
<pre class="type-9 type-11 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void userManagement() throws Exception {
  String user;
  ClusterUser otherClient=null;
  ByteBuffer password=s2bb("password");
  if (isKerberosEnabled()) {
    otherClient=getKdc().getClientPrincipal(1);
    user=otherClient.getPrincipal();
  }
 else {
    user=getUniqueNames(1)[0];
  }
  client.createLocalUser(creds,user,password);
  Set<String> users=client.listLocalUsers(creds);
  Set<String> expectedUsers=new HashSet<String>(Arrays.asList(clientPrincipal,user));
  assertTrue("Did not find all expected users: " + expectedUsers,users.containsAll(expectedUsers));
  HashSet<ByteBuffer> auths=new HashSet<ByteBuffer>(Arrays.asList(s2bb("A"),s2bb("B")));
  client.changeUserAuthorizations(creds,user,auths);
  List<ByteBuffer> update=client.getUserAuthorizations(creds,user);
  assertEquals(auths,new HashSet<ByteBuffer>(update));
  if (!isKerberosEnabled()) {
    password=s2bb("");
    client.changeLocalUserPassword(creds,user,password);
    assertTrue(client.authenticateUser(creds,user,s2pp(ByteBufferUtil.toString(password))));
  }
  if (isKerberosEnabled()) {
    UserGroupInformation.loginUserFromKeytab(otherClient.getPrincipal(),otherClient.getKeytab().getAbsolutePath());
    final UserGroupInformation ugi=UserGroupInformation.getCurrentUser();
    TestProxyClient otherProxyClient=null;
    try {
      otherProxyClient=new TestProxyClient(hostname,proxyPort,factory,proxyPrimary,ugi);
      otherProxyClient.proxy().login(user,Collections.<String,String>emptyMap());
    }
  finally {
      if (null != otherProxyClient) {
        otherProxyClient.close();
      }
    }
  }
 else {
    client.login(user,s2pp(ByteBufferUtil.toString(password)));
  }
}

</code></pre>

<br>
<pre class="type-9 type-13 type-11 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void attachIteratorsWithScans() throws Exception {
  if (client.tableExists(creds,"slow")) {
    client.deleteTable(creds,"slow");
  }
  client.createTable(creds,"slow",true,TimeType.MILLIS);
  IteratorSetting setting=new IteratorSetting(100,"slow",SlowIterator.class.getName(),Collections.singletonMap("sleepTime","250"));
  client.attachIterator(creds,"slow",setting,EnumSet.allOf(IteratorScope.class));
  for (int i=0; i < 40; i++) {
    client.updateAndFlush(creds,"slow",mutation("row" + i,"cf","cq","value"));
  }
  Thread t=new Thread(){
    @Override public void run(){
      String scanner;
      TestProxyClient proxyClient2=null;
      try {
        if (isKerberosEnabled()) {
          UserGroupInformation.loginUserFromKeytab(clientPrincipal,clientKeytab.getAbsolutePath());
          proxyClient2=new TestProxyClient(hostname,proxyPort,factory,proxyPrimary,UserGroupInformation.getCurrentUser());
        }
 else {
          proxyClient2=new TestProxyClient(hostname,proxyPort,factory);
        }
        Client client2=proxyClient2.proxy();
        scanner=client2.createScanner(creds,"slow",null);
        client2.nextK(scanner,10);
        client2.closeScanner(scanner);
      }
 catch (      Exception e) {
        throw new RuntimeException(e);
      }
 finally {
        if (null != proxyClient2) {
          proxyClient2.close();
        }
      }
    }
  }
;
  t.start();
  List<ActiveScan> scans=new ArrayList<ActiveScan>();
  for (int i=0; i < 100 && scans.isEmpty(); i++) {
    for (    String tserver : client.getTabletServers(creds)) {
      List<ActiveScan> scansForServer=client.getActiveScans(creds,tserver);
      for (      ActiveScan scan : scansForServer) {
        if (clientPrincipal.equals(scan.getUser())) {
          scans.add(scan);
        }
      }
      if (!scans.isEmpty())       break;
      sleepUninterruptibly(100,TimeUnit.MILLISECONDS);
    }
  }
  t.join();
  assertFalse("Expected to find scans, but found none",scans.isEmpty());
  boolean found=false;
  Map<String,String> map=null;
  for (int i=0; i < scans.size() && !found; i++) {
    ActiveScan scan=scans.get(i);
    if (clientPrincipal.equals(scan.getUser())) {
      assertTrue(ScanState.RUNNING.equals(scan.getState()) || ScanState.QUEUED.equals(scan.getState()));
      assertEquals(ScanType.SINGLE,scan.getType());
      assertEquals("slow",scan.getTable());
      map=client.tableIdMap(creds);
      assertEquals(map.get("slow"),scan.getExtent().tableId);
      assertTrue(scan.getExtent().endRow == null);
      assertTrue(scan.getExtent().prevEndRow == null);
      found=true;
    }
  }
  assertTrue("Could not find a scan against the 'slow' table",found);
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void tableProperties() throws Exception {
  Map<String,String> systemProps=client.getSystemConfiguration(creds);
  String systemTableSplitThreshold=systemProps.get("table.split.threshold");
  Map<String,String> orig=client.getTableProperties(creds,table);
  client.setTableProperty(creds,table,"table.split.threshold","500M");
  Map<String,String> update=client.getTableProperties(creds,table);
  assertEquals(update.get("table.split.threshold"),"500M");
  assertEquals(systemTableSplitThreshold,client.getSystemConfiguration(creds).get("table.split.threshold"));
  client.removeTableProperty(creds,table,"table.split.threshold");
  update=client.getTableProperties(creds,table);
  assertEquals(orig,update);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.proxy.TestProxyReadWrite </h4><pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Insert 100000 cells which have as the row [0..99999] (padded with zeros). Set a columnFamily so only the entries with specified column family come back
 * (there should be 50,000)
 */
@Test public void readWriteBatchOneShotWithColumnFamilyOnly() throws Exception {
  int maxInserts=100000;
  Map<ByteBuffer,List<ColumnUpdate>> mutations=new HashMap<ByteBuffer,List<ColumnUpdate>>();
  String format="%1$05d";
  for (int i=0; i < maxInserts; i++) {
    addMutation(mutations,String.format(format,i),"cf" + (i % 2),"cq" + (i % 2),Util.randString(10));
    if (i % 1000 == 0 || i == maxInserts - 1) {
      tpc.proxy().updateAndFlush(userpass,testtable,mutations);
      mutations.clear();
    }
  }
  BatchScanOptions options=new BatchScanOptions();
  ScanColumn sc=new ScanColumn();
  sc.colFamily=ByteBuffer.wrap("cf0".getBytes());
  options.columns=Collections.singletonList(sc);
  String cookie=tpc.proxy().createBatchScanner(userpass,testtable,options);
  int i=0;
  boolean hasNext=true;
  int k=1000;
  while (hasNext) {
    ScanResult kvList=tpc.proxy().nextK(cookie,k);
    i+=kvList.getResultsSize();
    hasNext=kvList.isMore();
  }
  assertEquals(i,50000);
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Insert 100000 cells which have as the row [0..99999] (padded with zeros). Set a columnFamily + columnQualififer so only the entries with specified column
 * come back (there should be 50,000)
 */
@Test public void readWriteBatchOneShotWithFullColumn() throws Exception {
  int maxInserts=100000;
  Map<ByteBuffer,List<ColumnUpdate>> mutations=new HashMap<ByteBuffer,List<ColumnUpdate>>();
  String format="%1$05d";
  for (int i=0; i < maxInserts; i++) {
    addMutation(mutations,String.format(format,i),"cf" + (i % 2),"cq" + (i % 2),Util.randString(10));
    if (i % 1000 == 0 || i == maxInserts - 1) {
      tpc.proxy().updateAndFlush(userpass,testtable,mutations);
      mutations.clear();
    }
  }
  BatchScanOptions options=new BatchScanOptions();
  ScanColumn sc=new ScanColumn();
  sc.colFamily=ByteBuffer.wrap("cf0".getBytes());
  sc.colQualifier=ByteBuffer.wrap("cq0".getBytes());
  options.columns=Collections.singletonList(sc);
  String cookie=tpc.proxy().createBatchScanner(userpass,testtable,options);
  int i=0;
  boolean hasNext=true;
  int k=1000;
  while (hasNext) {
    ScanResult kvList=tpc.proxy().nextK(cookie,k);
    i+=kvList.getResultsSize();
    hasNext=kvList.isMore();
  }
  assertEquals(i,50000);
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void readWriteOneShotWithRange() throws Exception {
  int maxInserts=100000;
  Map<ByteBuffer,List<ColumnUpdate>> mutations=new HashMap<ByteBuffer,List<ColumnUpdate>>();
  String format="%1$05d";
  for (int i=0; i < maxInserts; i++) {
    addMutation(mutations,String.format(format,i),"cf" + i,"cq" + i,Util.randString(10));
    if (i % 1000 == 0 || i == maxInserts - 1) {
      tpc.proxy().updateAndFlush(userpass,testtable,mutations);
      mutations.clear();
    }
  }
  Key stop=new Key();
  stop.setRow("5".getBytes());
  ScanOptions opts=new ScanOptions();
  opts.range=new Range(null,false,stop,false);
  String cookie=tpc.proxy().createScanner(userpass,testtable,opts);
  int i=0;
  boolean hasNext=true;
  int k=1000;
  while (hasNext) {
    ScanResult kvList=tpc.proxy().nextK(cookie,k);
    i+=kvList.getResultsSize();
    hasNext=kvList.isMore();
  }
  assertEquals(i,50000);
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Insert 100000 cells which have as the row [0..99999] (padded with zeros). Set a range so only the entries between -Inf...5 come back (there should be
 * 50,000)
 */
@Test public void readWriteBatchOneShotWithRange() throws Exception {
  int maxInserts=100000;
  Map<ByteBuffer,List<ColumnUpdate>> mutations=new HashMap<ByteBuffer,List<ColumnUpdate>>();
  String format="%1$05d";
  for (int i=0; i < maxInserts; i++) {
    addMutation(mutations,String.format(format,i),"cf" + i,"cq" + i,Util.randString(10));
    if (i % 1000 == 0 || i == maxInserts - 1) {
      tpc.proxy().updateAndFlush(userpass,testtable,mutations);
      mutations.clear();
    }
  }
  Key stop=new Key();
  stop.setRow("5".getBytes());
  BatchScanOptions options=new BatchScanOptions();
  options.ranges=Collections.singletonList(new Range(null,false,stop,false));
  String cookie=tpc.proxy().createBatchScanner(userpass,testtable,options);
  int i=0;
  boolean hasNext=true;
  int k=1000;
  while (hasNext) {
    ScanResult kvList=tpc.proxy().nextK(cookie,k);
    i+=kvList.getResultsSize();
    hasNext=kvList.isMore();
  }
  assertEquals(i,50000);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.proxy.TestProxySecurityOperations </h4><pre class="type-9 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void auths() throws TException {
  HashSet<ByteBuffer> newauths=new HashSet<ByteBuffer>();
  newauths.add(ByteBuffer.wrap("BBR".getBytes()));
  newauths.add(ByteBuffer.wrap("Barney".getBytes()));
  tpc.proxy().changeUserAuthorizations(userpass,testuser,newauths);
  List<ByteBuffer> actualauths=tpc.proxy().getUserAuthorizations(userpass,testuser);
  assertEquals(actualauths.size(),newauths.size());
  for (  ByteBuffer auth : actualauths) {
    assertTrue(newauths.contains(auth));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.proxy.TestProxyTableOperations </h4><pre class="type-9 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void constraints() throws TException {
  int cid=tpc.proxy().addConstraint(userpass,testtable,"org.apache.accumulo.TestConstraint");
  Map<String,Integer> constraints=tpc.proxy().listConstraints(userpass,testtable);
  assertEquals((int)constraints.get("org.apache.accumulo.TestConstraint"),cid);
  tpc.proxy().removeConstraint(userpass,testtable,cid);
  constraints=tpc.proxy().listConstraints(userpass,testtable);
  assertNull(constraints.get("org.apache.accumulo.TestConstraint"));
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void splits() throws TException {
  Set<ByteBuffer> splits=new HashSet<ByteBuffer>();
  splits.add(ByteBuffer.wrap("a".getBytes()));
  splits.add(ByteBuffer.wrap("b".getBytes()));
  splits.add(ByteBuffer.wrap("z".getBytes()));
  tpc.proxy().addSplits(userpass,testtable,splits);
  List<ByteBuffer> tableSplits=tpc.proxy().listSplits(userpass,testtable,10);
  for (  ByteBuffer split : tableSplits)   assertTrue(splits.contains(split));
  assertTrue(tableSplits.size() == splits.size());
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void merge() throws TException {
  Set<ByteBuffer> splits=new HashSet<ByteBuffer>();
  splits.add(ByteBuffer.wrap("a".getBytes()));
  splits.add(ByteBuffer.wrap("c".getBytes()));
  splits.add(ByteBuffer.wrap("z".getBytes()));
  tpc.proxy().addSplits(userpass,testtable,splits);
  tpc.proxy().mergeTablets(userpass,testtable,ByteBuffer.wrap("b".getBytes()),ByteBuffer.wrap("d".getBytes()));
  splits.remove(ByteBuffer.wrap("c".getBytes()));
  List<ByteBuffer> tableSplits=tpc.proxy().listSplits(userpass,testtable,10);
  for (  ByteBuffer split : tableSplits)   assertTrue(splits.contains(split));
  assertTrue(tableSplits.size() == splits.size());
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void localityGroups() throws TException {
  Map<String,Set<String>> groups=new HashMap<String,Set<String>>();
  Set<String> group1=new HashSet<String>();
  group1.add("cf1");
  groups.put("group1",group1);
  Set<String> group2=new HashSet<String>();
  group2.add("cf2");
  group2.add("cf3");
  groups.put("group2",group2);
  tpc.proxy().setLocalityGroups(userpass,testtable,groups);
  Map<String,Set<String>> actualGroups=tpc.proxy().getLocalityGroups(userpass,testtable);
  assertEquals(groups.size(),actualGroups.size());
  for (  String groupName : groups.keySet()) {
    assertTrue(actualGroups.containsKey(groupName));
    assertEquals(groups.get(groupName).size(),actualGroups.get(groupName).size());
    for (    String cf : groups.get(groupName)) {
      assertTrue(actualGroups.get(groupName).contains(cf));
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.replication.CyclicReplicationIT </h4><pre class="type-9 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void dataIsNotOverReplicated() throws Exception {
  File master1Dir=createTestDir("master1"), master2Dir=createTestDir("master2");
  String password="password";
  MiniAccumuloConfigImpl master1Cfg;
  MiniAccumuloClusterImpl master1Cluster;
  while (true) {
    master1Cfg=new MiniAccumuloConfigImpl(master1Dir,password);
    master1Cfg.setNumTservers(1);
    master1Cfg.setInstanceName("master1");
    ConfigurableMacBase.configureForEnvironment(master1Cfg,this.getClass(),ConfigurableMacBase.getSslDir(master1Dir));
    master1Cfg.setProperty(Property.REPLICATION_NAME,master1Cfg.getInstanceName());
    master1Cfg.setProperty(Property.TSERV_WALOG_MAX_SIZE,"5M");
    master1Cfg.setProperty(Property.REPLICATION_THREADCHECK,"5m");
    master1Cfg.setProperty(Property.REPLICATION_WORK_ASSIGNMENT_SLEEP,"1s");
    master1Cfg.setProperty(Property.MASTER_REPLICATION_SCAN_INTERVAL,"1s");
    master1Cluster=new MiniAccumuloClusterImpl(master1Cfg);
    setCoreSite(master1Cluster);
    try {
      master1Cluster.start();
      break;
    }
 catch (    ZooKeeperBindException e) {
      log.warn("Failed to start ZooKeeper on " + master1Cfg.getZooKeeperPort() + ", will retry");
    }
  }
  MiniAccumuloConfigImpl master2Cfg;
  MiniAccumuloClusterImpl master2Cluster;
  while (true) {
    master2Cfg=new MiniAccumuloConfigImpl(master2Dir,password);
    master2Cfg.setNumTservers(1);
    master2Cfg.setInstanceName("master2");
    this.updatePeerConfigFromPrimary(master1Cfg,master2Cfg);
    master2Cfg.setProperty(Property.REPLICATION_NAME,master2Cfg.getInstanceName());
    master2Cfg.setProperty(Property.TSERV_WALOG_MAX_SIZE,"5M");
    master2Cfg.setProperty(Property.REPLICATION_THREADCHECK,"5m");
    master2Cfg.setProperty(Property.REPLICATION_WORK_ASSIGNMENT_SLEEP,"1s");
    master2Cfg.setProperty(Property.MASTER_REPLICATION_SCAN_INTERVAL,"1s");
    master2Cluster=new MiniAccumuloClusterImpl(master2Cfg);
    setCoreSite(master2Cluster);
    try {
      master2Cluster.start();
      break;
    }
 catch (    ZooKeeperBindException e) {
      log.warn("Failed to start ZooKeeper on " + master2Cfg.getZooKeeperPort() + ", will retry");
    }
  }
  try {
    Connector connMaster1=master1Cluster.getConnector("root",new PasswordToken(password)), connMaster2=master2Cluster.getConnector("root",new PasswordToken(password));
    String master1UserName="master1", master1Password="foo";
    String master2UserName="master2", master2Password="bar";
    String master1Table=master1Cluster.getInstanceName(), master2Table=master2Cluster.getInstanceName();
    connMaster1.securityOperations().createLocalUser(master1UserName,new PasswordToken(master1Password));
    connMaster2.securityOperations().createLocalUser(master2UserName,new PasswordToken(master2Password));
    connMaster1.instanceOperations().setProperty(Property.REPLICATION_PEER_USER.getKey() + master2Cluster.getInstanceName(),master2UserName);
    connMaster1.instanceOperations().setProperty(Property.REPLICATION_PEER_PASSWORD.getKey() + master2Cluster.getInstanceName(),master2Password);
    connMaster2.instanceOperations().setProperty(Property.REPLICATION_PEER_USER.getKey() + master1Cluster.getInstanceName(),master1UserName);
    connMaster2.instanceOperations().setProperty(Property.REPLICATION_PEER_PASSWORD.getKey() + master1Cluster.getInstanceName(),master1Password);
    connMaster1.instanceOperations().setProperty(Property.REPLICATION_PEERS.getKey() + master2Cluster.getInstanceName(),ReplicaSystemFactory.getPeerConfigurationValue(AccumuloReplicaSystem.class,AccumuloReplicaSystem.buildConfiguration(master2Cluster.getInstanceName(),master2Cluster.getZooKeepers())));
    connMaster2.instanceOperations().setProperty(Property.REPLICATION_PEERS.getKey() + master1Cluster.getInstanceName(),ReplicaSystemFactory.getPeerConfigurationValue(AccumuloReplicaSystem.class,AccumuloReplicaSystem.buildConfiguration(master1Cluster.getInstanceName(),master1Cluster.getZooKeepers())));
    connMaster1.tableOperations().create(master1Table,new NewTableConfiguration().withoutDefaultIterators());
    String master1TableId=connMaster1.tableOperations().tableIdMap().get(master1Table);
    Assert.assertNotNull(master1TableId);
    connMaster2.tableOperations().create(master2Table,new NewTableConfiguration().withoutDefaultIterators());
    String master2TableId=connMaster2.tableOperations().tableIdMap().get(master2Table);
    Assert.assertNotNull(master2TableId);
    connMaster1.tableOperations().setProperty(master1Table,Property.TABLE_REPLICATION.getKey(),"true");
    connMaster1.tableOperations().setProperty(master1Table,Property.TABLE_REPLICATION_TARGET.getKey() + master2Cluster.getInstanceName(),master2TableId);
    connMaster2.tableOperations().setProperty(master2Table,Property.TABLE_REPLICATION.getKey(),"true");
    connMaster2.tableOperations().setProperty(master2Table,Property.TABLE_REPLICATION_TARGET.getKey() + master1Cluster.getInstanceName(),master1TableId);
    connMaster1.securityOperations().grantTablePermission(master1UserName,master1Table,TablePermission.WRITE);
    connMaster2.securityOperations().grantTablePermission(master2UserName,master2Table,TablePermission.WRITE);
    IteratorSetting summingCombiner=new IteratorSetting(50,SummingCombiner.class);
    SummingCombiner.setEncodingType(summingCombiner,Type.STRING);
    SummingCombiner.setCombineAllColumns(summingCombiner,true);
    connMaster1.tableOperations().attachIterator(master1Table,summingCombiner);
    connMaster2.tableOperations().attachIterator(master2Table,summingCombiner);
    BatchWriter bw=connMaster1.createBatchWriter(master1Table,new BatchWriterConfig());
    Mutation m=new Mutation("row");
    m.put("count","","1");
    bw.addMutation(m);
    bw.close();
    Set<String> files=connMaster1.replicationOperations().referencedFiles(master1Table);
    log.info("Found {} that need replication from master1",files);
    for (    ProcessReference proc : master1Cluster.getProcesses().get(ServerType.TABLET_SERVER)) {
      master1Cluster.killProcess(ServerType.TABLET_SERVER,proc);
    }
    master1Cluster.exec(TabletServer.class);
    log.info("Restarted tserver on master1");
    Thread.sleep(1000);
    Scanner s=connMaster1.createScanner(master1Table,Authorizations.EMPTY);
    Entry<Key,Value> entry=Iterables.getOnlyElement(s);
    Assert.assertEquals("1",entry.getValue().toString());
    connMaster1.replicationOperations().drain(master1Table,files);
    Thread.sleep(5000);
    s=connMaster2.createScanner(master2Table,Authorizations.EMPTY);
    entry=Iterables.getOnlyElement(s);
    Assert.assertEquals("1",entry.getValue().toString());
    files=connMaster2.replicationOperations().referencedFiles(master2Table);
    for (    ProcessReference proc : master2Cluster.getProcesses().get(ServerType.TABLET_SERVER)) {
      master2Cluster.killProcess(ServerType.TABLET_SERVER,proc);
    }
    master2Cluster.exec(TabletServer.class);
    Thread.sleep(1000);
    s=connMaster2.createScanner(master2Table,Authorizations.EMPTY);
    entry=Iterables.getOnlyElement(s);
    Assert.assertEquals("1",entry.getValue().toString());
    connMaster2.replicationOperations().drain(master2Table,files);
    Thread.sleep(5000);
    s=connMaster1.createScanner(master1Table,Authorizations.EMPTY);
    entry=Iterables.getOnlyElement(s);
    Assert.assertEquals("1",entry.getValue().toString());
  }
  finally {
    master1Cluster.stop();
    master2Cluster.stop();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.replication.FinishedWorkUpdaterIT </h4><pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void chooseMinimumBeginOffsetInfiniteEnd() throws Exception {
  conn.securityOperations().grantTablePermission(conn.whoami(),ReplicationTable.NAME,TablePermission.READ);
  conn.securityOperations().grantTablePermission(conn.whoami(),ReplicationTable.NAME,TablePermission.WRITE);
  ReplicationTable.setOnline(conn);
  String file="/accumulo/wals/tserver+port/" + UUID.randomUUID();
  Status stat1=Status.newBuilder().setBegin(100).setEnd(1000).setClosed(true).setInfiniteEnd(true).build(), stat2=Status.newBuilder().setBegin(1).setEnd(1000).setClosed(true).setInfiniteEnd(true).build(), stat3=Status.newBuilder().setBegin(500).setEnd(1000).setClosed(true).setInfiniteEnd(true).build();
  ReplicationTarget target1=new ReplicationTarget("peer1","table1","1"), target2=new ReplicationTarget("peer2","table2","1"), target3=new ReplicationTarget("peer3","table3","1");
  BatchWriter bw=ReplicationTable.getBatchWriter(conn);
  Mutation m=new Mutation(file);
  WorkSection.add(m,target1.toText(),ProtobufUtil.toValue(stat1));
  WorkSection.add(m,target2.toText(),ProtobufUtil.toValue(stat2));
  WorkSection.add(m,target3.toText(),ProtobufUtil.toValue(stat3));
  bw.addMutation(m);
  bw.close();
  updater.run();
  Scanner s=ReplicationTable.getScanner(conn);
  s.setRange(Range.exact(file));
  StatusSection.limit(s);
  Entry<Key,Value> entry=Iterables.getOnlyElement(s);
  Assert.assertEquals(entry.getKey().getColumnFamily(),StatusSection.NAME);
  Assert.assertEquals(entry.getKey().getColumnQualifier().toString(),target1.getSourceTableId());
  Status actual=Status.parseFrom(entry.getValue().get());
  Assert.assertEquals(1,actual.getBegin());
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void chooseMinimumBeginOffset() throws Exception {
  conn.securityOperations().grantTablePermission(conn.whoami(),ReplicationTable.NAME,TablePermission.READ);
  conn.securityOperations().grantTablePermission(conn.whoami(),ReplicationTable.NAME,TablePermission.WRITE);
  ReplicationTable.setOnline(conn);
  String file="/accumulo/wals/tserver+port/" + UUID.randomUUID();
  Status stat1=Status.newBuilder().setBegin(100).setEnd(1000).setClosed(true).setInfiniteEnd(false).build(), stat2=Status.newBuilder().setBegin(500).setEnd(1000).setClosed(true).setInfiniteEnd(false).build(), stat3=Status.newBuilder().setBegin(1).setEnd(1000).setClosed(true).setInfiniteEnd(false).build();
  ReplicationTarget target1=new ReplicationTarget("peer1","table1","1"), target2=new ReplicationTarget("peer2","table2","1"), target3=new ReplicationTarget("peer3","table3","1");
  BatchWriter bw=ReplicationTable.getBatchWriter(conn);
  Mutation m=new Mutation(file);
  WorkSection.add(m,target1.toText(),ProtobufUtil.toValue(stat1));
  WorkSection.add(m,target2.toText(),ProtobufUtil.toValue(stat2));
  WorkSection.add(m,target3.toText(),ProtobufUtil.toValue(stat3));
  bw.addMutation(m);
  bw.close();
  updater.run();
  Scanner s=ReplicationTable.getScanner(conn);
  s.setRange(Range.exact(file));
  StatusSection.limit(s);
  Entry<Key,Value> entry=Iterables.getOnlyElement(s);
  Assert.assertEquals(entry.getKey().getColumnFamily(),StatusSection.NAME);
  Assert.assertEquals(entry.getKey().getColumnQualifier().toString(),target1.getSourceTableId());
  Status actual=Status.parseFrom(entry.getValue().get());
  Assert.assertEquals(1,actual.getBegin());
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void recordsWithProgressUpdateBothTables() throws Exception {
  conn.securityOperations().grantTablePermission(conn.whoami(),ReplicationTable.NAME,TablePermission.READ);
  conn.securityOperations().grantTablePermission(conn.whoami(),ReplicationTable.NAME,TablePermission.WRITE);
  ReplicationTable.setOnline(conn);
  String file="/accumulo/wals/tserver+port/" + UUID.randomUUID();
  Status stat=Status.newBuilder().setBegin(100).setEnd(200).setClosed(true).setInfiniteEnd(false).build();
  ReplicationTarget target=new ReplicationTarget("peer","table1","1");
  BatchWriter bw=ReplicationTable.getBatchWriter(conn);
  Mutation m=new Mutation(file);
  WorkSection.add(m,target.toText(),ProtobufUtil.toValue(stat));
  bw.addMutation(m);
  bw.close();
  updater.run();
  Scanner s=ReplicationTable.getScanner(conn);
  s.setRange(Range.exact(file));
  StatusSection.limit(s);
  Entry<Key,Value> entry=Iterables.getOnlyElement(s);
  Assert.assertEquals(entry.getKey().getColumnFamily(),StatusSection.NAME);
  Assert.assertEquals(entry.getKey().getColumnQualifier().toString(),target.getSourceTableId());
  Status actual=Status.parseFrom(entry.getValue().get());
  Assert.assertEquals(stat.getBegin(),actual.getBegin());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.replication.GarbageCollectorCommunicatesWithTServersIT </h4><pre class="type-9 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testActiveWalPrecludesClosing() throws Exception {
  final String table=getUniqueNames(1)[0];
  final Connector conn=getConnector();
  ReplicationTable.setOnline(conn);
  log.info("Creating {}",table);
  conn.tableOperations().create(table);
  conn.tableOperations().setProperty(table,Property.TABLE_REPLICATION.getKey(),"true");
  log.info("Writing a few mutations to the table");
  BatchWriter bw=conn.createBatchWriter(table,null);
  byte[] empty=new byte[0];
  for (int i=0; i < 5; i++) {
    Mutation m=new Mutation(Integer.toString(i));
    m.put(empty,empty,empty);
    bw.addMutation(m);
  }
  log.info("Flushing mutations to the server");
  bw.flush();
  log.info("Checking that metadata only has two WALs recorded for this table (inUse, and opened)");
  Set<String> wals=getWalsForTable(table);
  Assert.assertEquals("Expected to only find two WALs for the table",2,wals.size());
  conn.tableOperations().flush(table,null,null,true);
  conn.tableOperations().flush(MetadataTable.NAME,null,null,true);
  log.info("Waiting for replication table to come online");
  log.info("Fetching replication statuses from metadata table");
  Map<String,Status> fileToStatus=getMetadataStatusForTable(table);
  Assert.assertEquals("Expected to only find one replication status message",1,fileToStatus.size());
  String walName=fileToStatus.keySet().iterator().next();
  wals.retainAll(fileToStatus.keySet());
  Assert.assertEquals(1,wals.size());
  Status status=fileToStatus.get(walName);
  Assert.assertEquals("Expected Status for file to not be closed",false,status.getClosed());
  Set<String> filesForTable=getFilesForTable(table);
  Assert.assertEquals("Expected to only find one rfile for table",1,filesForTable.size());
  log.info("Files for table before MajC: {}",filesForTable);
  conn.tableOperations().compact(table,null,null,false,true);
  Set<String> filesForTableAfterCompaction=getFilesForTable(table);
  log.info("Files for table after MajC: {}",filesForTableAfterCompaction);
  Assert.assertEquals("Expected to only find one rfile for table",1,filesForTableAfterCompaction.size());
  Assert.assertNotEquals("Expected the files before and after compaction to differ",filesForTableAfterCompaction,filesForTable);
  Path fileToBeDeleted=new Path(filesForTable.iterator().next());
  FileSystem fs=getCluster().getFileSystem();
  boolean fileExists=fs.exists(fileToBeDeleted);
  while (fileExists) {
    log.info("File which should get deleted still exists: {}",fileToBeDeleted);
    Thread.sleep(2000);
    fileExists=fs.exists(fileToBeDeleted);
  }
  Map<String,Status> fileToStatusAfterMinc=getMetadataStatusForTable(table);
  Assert.assertEquals("Expected to still find only one replication status message: " + fileToStatusAfterMinc,1,fileToStatusAfterMinc.size());
  Assert.assertEquals("Status before and after MinC should be identical",fileToStatus,fileToStatusAfterMinc);
}

</code></pre>

<br>
<pre class="type-9 type-13 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=2 * 60 * 1000) public void testUnreferencedWalInTserverIsClosed() throws Exception {
  final String[] names=getUniqueNames(2);
  final String table=names[0], otherTable=names[1];
  final Connector conn=getConnector();
  ReplicationTable.setOnline(conn);
  log.info("Creating {}",table);
  conn.tableOperations().create(table);
  conn.tableOperations().setProperty(table,Property.TABLE_REPLICATION.getKey(),"true");
  log.info("Writing a few mutations to the table");
  BatchWriter bw=conn.createBatchWriter(table,null);
  byte[] empty=new byte[0];
  for (int i=0; i < 5; i++) {
    Mutation m=new Mutation(Integer.toString(i));
    m.put(empty,empty,empty);
    bw.addMutation(m);
  }
  log.info("Flushing mutations to the server");
  bw.close();
  log.info("Checking that metadata only has one WAL recorded for this table");
  Set<String> wals=getWalsForTable(table);
  Assert.assertEquals("Expected to only find two WAL for the table",2,wals.size());
  log.info("Compacting the table which will remove all WALs from the tablets");
  conn.tableOperations().flush(table,null,null,true);
  conn.tableOperations().flush(MetadataTable.NAME,null,null,true);
  log.info("Fetching replication statuses from metadata table");
  Map<String,Status> fileToStatus=getMetadataStatusForTable(table);
  Assert.assertEquals("Expected to only find one replication status message",1,fileToStatus.size());
  String walName=fileToStatus.keySet().iterator().next();
  Assert.assertTrue("Expected log file name from tablet to equal replication entry",wals.contains(walName));
  Status status=fileToStatus.get(walName);
  Assert.assertEquals("Expected Status for file to not be closed",false,status.getClosed());
  Set<String> filesForTable=getFilesForTable(table);
  Assert.assertEquals("Expected to only find one rfile for table",1,filesForTable.size());
  log.info("Files for table before MajC: {}",filesForTable);
  conn.tableOperations().compact(table,null,null,false,true);
  Set<String> filesForTableAfterCompaction=getFilesForTable(table);
  log.info("Files for table after MajC: {}",filesForTableAfterCompaction);
  Assert.assertEquals("Expected to only find one rfile for table",1,filesForTableAfterCompaction.size());
  Assert.assertNotEquals("Expected the files before and after compaction to differ",filesForTableAfterCompaction,filesForTable);
  Path fileToBeDeleted=new Path(filesForTable.iterator().next());
  FileSystem fs=getCluster().getFileSystem();
  boolean fileExists=fs.exists(fileToBeDeleted);
  while (fileExists) {
    log.info("File which should get deleted still exists: {}",fileToBeDeleted);
    Thread.sleep(2000);
    fileExists=fs.exists(fileToBeDeleted);
  }
  Map<String,Status> fileToStatusAfterMinc=getMetadataStatusForTable(table);
  Assert.assertEquals("Expected to still find only one replication status message: " + fileToStatusAfterMinc,1,fileToStatusAfterMinc.size());
  conn.tableOperations().create(otherTable);
  bw=conn.createBatchWriter(otherTable,null);
  byte[] bigValue=new byte[1024 * 500];
  Arrays.fill(bigValue,(byte)1);
  for (int i=0; i < 50; i++) {
    Mutation m=new Mutation(Integer.toString(i));
    m.put(empty,empty,bigValue);
    bw.addMutation(m);
    if (i % 10 == 0) {
      bw.flush();
    }
  }
  bw.close();
  conn.tableOperations().flush(otherTable,null,null,true);
  final ClientContext context=new ClientContext(conn.getInstance(),new Credentials("root",new PasswordToken(ConfigurableMacBase.ROOT_PASSWORD)),getClientConfig());
  List<String> tservers=MasterClient.execute(context,new ClientExecReturn<List<String>,MasterClientService.Client>(){
    @Override public List<String> execute(    MasterClientService.Client client) throws Exception {
      return client.getActiveTservers(Tracer.traceInfo(),context.rpcCreds());
    }
  }
);
  Assert.assertEquals("Expected only one active tservers",1,tservers.size());
  HostAndPort tserver=HostAndPort.fromString(tservers.get(0));
  log.info("Fetching active WALs from {}",tserver);
  Client client=ThriftUtil.getTServerClient(tserver,context);
  List<String> activeWalsForTserver=client.getActiveLogs(Tracer.traceInfo(),context.rpcCreds());
  log.info("Active wals: {}",activeWalsForTserver);
  Assert.assertEquals("Expected to find only one active WAL",1,activeWalsForTserver.size());
  String activeWal=new Path(activeWalsForTserver.get(0)).toString();
  Assert.assertNotEquals("Current active WAL on tserver should not be the original WAL we saw",walName,activeWal);
  log.info("Ensuring that replication status does get closed after WAL is no longer in use by Tserver");
  do {
    Map<String,Status> replicationStatuses=getMetadataStatusForTable(table);
    log.info("Got replication status messages {}",replicationStatuses);
    Assert.assertEquals("Did not expect to find additional status records",1,replicationStatuses.size());
    status=replicationStatuses.values().iterator().next();
    log.info("Current status: {}",ProtobufUtil.toString(status));
    if (status.getClosed()) {
      return;
    }
    log.info("Status is not yet closed, waiting for garbage collector to close it");
    Thread.sleep(2000);
  }
 while (true);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.replication.KerberosReplicationIT </h4><pre class="type-9 type-5 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void dataReplicatedToCorrectTable() throws Exception {
  final UserGroupInformation ugi=UserGroupInformation.loginUserFromKeytabAndReturnUGI(rootUser.getPrincipal(),rootUser.getKeytab().toURI().toString());
  ugi.doAs(new PrivilegedExceptionAction<Void>(){
    @Override public Void run() throws Exception {
      log.info("testing {}",ugi);
      final KerberosToken token=new KerberosToken();
      final Connector primaryConn=primary.getConnector(rootUser.getPrincipal(),token);
      final Connector peerConn=peer.getConnector(rootUser.getPrincipal(),token);
      ClusterUser replicationUser=kdc.getClientPrincipal(0);
      peerConn.securityOperations().createLocalUser(replicationUser.getPrincipal(),null);
      primaryConn.instanceOperations().setProperty(Property.REPLICATION_PEER_USER.getKey() + PEER_NAME,replicationUser.getPrincipal());
      primaryConn.instanceOperations().setProperty(Property.REPLICATION_PEER_KEYTAB.getKey() + PEER_NAME,replicationUser.getKeytab().getAbsolutePath());
      primaryConn.instanceOperations().setProperty(Property.REPLICATION_PEERS.getKey() + PEER_NAME,ReplicaSystemFactory.getPeerConfigurationValue(AccumuloReplicaSystem.class,AccumuloReplicaSystem.buildConfiguration(peerConn.getInstance().getInstanceName(),peerConn.getInstance().getZooKeepers())));
      String primaryTable1="primary", peerTable1="peer";
      primaryConn.tableOperations().create(primaryTable1);
      String masterTableId1=primaryConn.tableOperations().tableIdMap().get(primaryTable1);
      Assert.assertNotNull(masterTableId1);
      peerConn.tableOperations().create(peerTable1);
      String peerTableId1=peerConn.tableOperations().tableIdMap().get(peerTable1);
      Assert.assertNotNull(peerTableId1);
      peerConn.securityOperations().grantTablePermission(replicationUser.getPrincipal(),peerTable1,TablePermission.WRITE);
      primaryConn.tableOperations().setProperty(primaryTable1,Property.TABLE_REPLICATION.getKey(),"true");
      primaryConn.tableOperations().setProperty(primaryTable1,Property.TABLE_REPLICATION_TARGET.getKey() + PEER_NAME,peerTableId1);
      BatchWriter bw=primaryConn.createBatchWriter(primaryTable1,new BatchWriterConfig());
      long masterTable1Records=0l;
      for (int rows=0; rows < 2500; rows++) {
        Mutation m=new Mutation(primaryTable1 + rows);
        for (int cols=0; cols < 100; cols++) {
          String value=Integer.toString(cols);
          m.put(value,"",value);
          masterTable1Records++;
        }
        bw.addMutation(m);
      }
      bw.close();
      log.info("Wrote all data to primary cluster");
      Set<String> filesFor1=primaryConn.replicationOperations().referencedFiles(primaryTable1);
      for (      ProcessReference proc : primary.getProcesses().get(ServerType.TABLET_SERVER)) {
        primary.killProcess(ServerType.TABLET_SERVER,proc);
      }
      primary.exec(TabletServer.class);
      log.info("Restarted the tserver");
      Iterators.size(primaryConn.createScanner(primaryTable1,Authorizations.EMPTY).iterator());
      log.info("Waiting for {} for {}",filesFor1,primaryTable1);
      primaryConn.replicationOperations().drain(primaryTable1,filesFor1);
      long countTable=0l;
      for (      Entry<Key,Value> entry : peerConn.createScanner(peerTable1,Authorizations.EMPTY)) {
        countTable++;
        Assert.assertTrue("Found unexpected key-value" + entry.getKey().toStringNoTruncate() + " "+ entry.getValue(),entry.getKey().getRow().toString().startsWith(primaryTable1));
      }
      log.info("Found {} records in {}",countTable,peerTable1);
      Assert.assertEquals(masterTable1Records,countTable);
      return null;
    }
  }
);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.replication.MultiInstanceReplicationIT </h4><pre class="type-9 type-13 type-8 type-5 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(timeout=10 * 60 * 1000) public void dataWasReplicatedToThePeer() throws Exception {
  MiniAccumuloConfigImpl peerCfg=new MiniAccumuloConfigImpl(createTestDir(this.getClass().getName() + "_" + this.testName.getMethodName()+ "_peer"),ROOT_PASSWORD);
  peerCfg.setNumTservers(1);
  peerCfg.setInstanceName("peer");
  peerCfg.setProperty(Property.REPLICATION_NAME,"peer");
  updatePeerConfigFromPrimary(getCluster().getConfig(),peerCfg);
  MiniAccumuloClusterImpl peerCluster=new MiniAccumuloClusterImpl(peerCfg);
  peerCluster.start();
  try {
    final Connector connMaster=getConnector();
    final Connector connPeer=peerCluster.getConnector("root",new PasswordToken(ROOT_PASSWORD));
    ReplicationTable.setOnline(connMaster);
    String peerUserName="peer", peerPassword="foo";
    String peerClusterName="peer";
    connPeer.securityOperations().createLocalUser(peerUserName,new PasswordToken(peerPassword));
    connMaster.instanceOperations().setProperty(Property.REPLICATION_PEER_USER.getKey() + peerClusterName,peerUserName);
    connMaster.instanceOperations().setProperty(Property.REPLICATION_PEER_PASSWORD.getKey() + peerClusterName,peerPassword);
    connMaster.instanceOperations().setProperty(Property.REPLICATION_PEERS.getKey() + peerClusterName,ReplicaSystemFactory.getPeerConfigurationValue(AccumuloReplicaSystem.class,AccumuloReplicaSystem.buildConfiguration(peerCluster.getInstanceName(),peerCluster.getZooKeepers())));
    final String masterTable="master", peerTable="peer";
    connMaster.tableOperations().create(masterTable);
    String masterTableId=connMaster.tableOperations().tableIdMap().get(masterTable);
    Assert.assertNotNull(masterTableId);
    connPeer.tableOperations().create(peerTable);
    String peerTableId=connPeer.tableOperations().tableIdMap().get(peerTable);
    Assert.assertNotNull(peerTableId);
    connPeer.securityOperations().grantTablePermission(peerUserName,peerTable,TablePermission.WRITE);
    connMaster.tableOperations().setProperty(masterTable,Property.TABLE_REPLICATION.getKey(),"true");
    connMaster.tableOperations().setProperty(masterTable,Property.TABLE_REPLICATION_TARGET.getKey() + peerClusterName,peerTableId);
    BatchWriter bw=connMaster.createBatchWriter(masterTable,new BatchWriterConfig());
    for (int rows=0; rows < 5000; rows++) {
      Mutation m=new Mutation(Integer.toString(rows));
      for (int cols=0; cols < 100; cols++) {
        String value=Integer.toString(cols);
        m.put(value,"",value);
      }
      bw.addMutation(m);
    }
    bw.close();
    log.info("Wrote all data to master cluster");
    final Set<String> filesNeedingReplication=connMaster.replicationOperations().referencedFiles(masterTable);
    log.info("Files to replicate: " + filesNeedingReplication);
    for (    ProcessReference proc : cluster.getProcesses().get(ServerType.TABLET_SERVER)) {
      cluster.killProcess(ServerType.TABLET_SERVER,proc);
    }
    cluster.exec(TabletServer.class);
    log.info("TabletServer restarted");
    Iterators.size(ReplicationTable.getScanner(connMaster).iterator());
    log.info("TabletServer is online");
    while (!ReplicationTable.isOnline(connMaster)) {
      log.info("Replication table still offline, waiting");
      Thread.sleep(5000);
    }
    log.info("");
    log.info("Fetching metadata records:");
    for (    Entry<Key,Value> kv : connMaster.createScanner(MetadataTable.NAME,Authorizations.EMPTY)) {
      if (ReplicationSection.COLF.equals(kv.getKey().getColumnFamily())) {
        log.info(kv.getKey().toStringNoTruncate() + " " + ProtobufUtil.toString(Status.parseFrom(kv.getValue().get())));
      }
 else {
        log.info(kv.getKey().toStringNoTruncate() + " " + kv.getValue());
      }
    }
    log.info("");
    log.info("Fetching replication records:");
    for (    Entry<Key,Value> kv : ReplicationTable.getScanner(connMaster)) {
      log.info(kv.getKey().toStringNoTruncate() + " " + ProtobufUtil.toString(Status.parseFrom(kv.getValue().get())));
    }
    Future<Boolean> future=executor.submit(new Callable<Boolean>(){
      @Override public Boolean call() throws Exception {
        long then=System.currentTimeMillis();
        connMaster.replicationOperations().drain(masterTable,filesNeedingReplication);
        long now=System.currentTimeMillis();
        log.info("Drain completed in " + (now - then) + "ms");
        return true;
      }
    }
);
    try {
      future.get(60,TimeUnit.SECONDS);
    }
 catch (    TimeoutException e) {
      future.cancel(true);
      Assert.fail("Drain did not finish within 60 seconds");
    }
 finally {
      executor.shutdownNow();
    }
    log.info("drain completed");
    log.info("");
    log.info("Fetching metadata records:");
    for (    Entry<Key,Value> kv : connMaster.createScanner(MetadataTable.NAME,Authorizations.EMPTY)) {
      if (ReplicationSection.COLF.equals(kv.getKey().getColumnFamily())) {
        log.info(kv.getKey().toStringNoTruncate() + " " + ProtobufUtil.toString(Status.parseFrom(kv.getValue().get())));
      }
 else {
        log.info(kv.getKey().toStringNoTruncate() + " " + kv.getValue());
      }
    }
    log.info("");
    log.info("Fetching replication records:");
    for (    Entry<Key,Value> kv : ReplicationTable.getScanner(connMaster)) {
      log.info(kv.getKey().toStringNoTruncate() + " " + ProtobufUtil.toString(Status.parseFrom(kv.getValue().get())));
    }
    Scanner master=connMaster.createScanner(masterTable,Authorizations.EMPTY), peer=connPeer.createScanner(peerTable,Authorizations.EMPTY);
    Iterator<Entry<Key,Value>> masterIter=master.iterator(), peerIter=peer.iterator();
    Entry<Key,Value> masterEntry=null, peerEntry=null;
    while (masterIter.hasNext() && peerIter.hasNext()) {
      masterEntry=masterIter.next();
      peerEntry=peerIter.next();
      Assert.assertEquals(masterEntry.getKey() + " was not equal to " + peerEntry.getKey(),0,masterEntry.getKey().compareTo(peerEntry.getKey(),PartialKey.ROW_COLFAM_COLQUAL_COLVIS));
      Assert.assertEquals(masterEntry.getValue(),peerEntry.getValue());
    }
    log.info("Last master entry: " + masterEntry);
    log.info("Last peer entry: " + peerEntry);
    Assert.assertFalse("Had more data to read from the master",masterIter.hasNext());
    Assert.assertFalse("Had more data to read from the peer",peerIter.hasNext());
  }
  finally {
    peerCluster.stop();
  }
}

</code></pre>

<br>
<pre class="type-9 type-13 type-5 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void dataWasReplicatedToThePeerWithoutDrain() throws Exception {
  MiniAccumuloConfigImpl peerCfg=new MiniAccumuloConfigImpl(createTestDir(this.getClass().getName() + "_" + this.testName.getMethodName()+ "_peer"),ROOT_PASSWORD);
  peerCfg.setNumTservers(1);
  peerCfg.setInstanceName("peer");
  peerCfg.setProperty(Property.REPLICATION_NAME,"peer");
  updatePeerConfigFromPrimary(getCluster().getConfig(),peerCfg);
  MiniAccumuloClusterImpl peerCluster=new MiniAccumuloClusterImpl(peerCfg);
  peerCluster.start();
  Connector connMaster=getConnector();
  Connector connPeer=peerCluster.getConnector("root",new PasswordToken(ROOT_PASSWORD));
  String peerUserName="repl";
  String peerPassword="passwd";
  connPeer.securityOperations().createLocalUser(peerUserName,new PasswordToken(peerPassword));
  String peerClusterName="peer";
  connMaster.instanceOperations().setProperty(Property.REPLICATION_PEERS.getKey() + peerClusterName,ReplicaSystemFactory.getPeerConfigurationValue(AccumuloReplicaSystem.class,AccumuloReplicaSystem.buildConfiguration(peerCluster.getInstanceName(),peerCluster.getZooKeepers())));
  connMaster.instanceOperations().setProperty(Property.REPLICATION_PEER_USER.getKey() + peerClusterName,peerUserName);
  connMaster.instanceOperations().setProperty(Property.REPLICATION_PEER_PASSWORD.getKey() + peerClusterName,peerPassword);
  String masterTable="master", peerTable="peer";
  connMaster.tableOperations().create(masterTable);
  String masterTableId=connMaster.tableOperations().tableIdMap().get(masterTable);
  Assert.assertNotNull(masterTableId);
  connPeer.tableOperations().create(peerTable);
  String peerTableId=connPeer.tableOperations().tableIdMap().get(peerTable);
  Assert.assertNotNull(peerTableId);
  connPeer.securityOperations().grantTablePermission(peerUserName,peerTable,TablePermission.WRITE);
  connMaster.tableOperations().setProperty(masterTable,Property.TABLE_REPLICATION.getKey(),"true");
  connMaster.tableOperations().setProperty(masterTable,Property.TABLE_REPLICATION_TARGET.getKey() + peerClusterName,peerTableId);
  BatchWriter bw=connMaster.createBatchWriter(masterTable,new BatchWriterConfig());
  for (int rows=0; rows < 5000; rows++) {
    Mutation m=new Mutation(Integer.toString(rows));
    for (int cols=0; cols < 100; cols++) {
      String value=Integer.toString(cols);
      m.put(value,"",value);
    }
    bw.addMutation(m);
  }
  bw.close();
  log.info("Wrote all data to master cluster");
  Set<String> files=connMaster.replicationOperations().referencedFiles(masterTable);
  log.info("Files to replicate:" + files);
  for (  ProcessReference proc : cluster.getProcesses().get(ServerType.TABLET_SERVER)) {
    cluster.killProcess(ServerType.TABLET_SERVER,proc);
  }
  cluster.exec(TabletServer.class);
  while (!ReplicationTable.isOnline(connMaster)) {
    log.info("Replication table still offline, waiting");
    Thread.sleep(5000);
  }
  Iterators.size(connMaster.createScanner(masterTable,Authorizations.EMPTY).iterator());
  for (  Entry<Key,Value> kv : ReplicationTable.getScanner(connMaster)) {
    log.debug(kv.getKey().toStringNoTruncate() + " " + ProtobufUtil.toString(Status.parseFrom(kv.getValue().get())));
  }
  connMaster.replicationOperations().drain(masterTable,files);
  Scanner master=connMaster.createScanner(masterTable,Authorizations.EMPTY), peer=connPeer.createScanner(peerTable,Authorizations.EMPTY);
  Iterator<Entry<Key,Value>> masterIter=master.iterator(), peerIter=peer.iterator();
  while (masterIter.hasNext() && peerIter.hasNext()) {
    Entry<Key,Value> masterEntry=masterIter.next(), peerEntry=peerIter.next();
    Assert.assertEquals(peerEntry.getKey() + " was not equal to " + peerEntry.getKey(),0,masterEntry.getKey().compareTo(peerEntry.getKey(),PartialKey.ROW_COLFAM_COLQUAL_COLVIS));
    Assert.assertEquals(masterEntry.getValue(),peerEntry.getValue());
  }
  Assert.assertFalse("Had more data to read from the master",masterIter.hasNext());
  Assert.assertFalse("Had more data to read from the peer",peerIter.hasNext());
  peerCluster.stop();
}

</code></pre>

<br>
<pre class="type-9 type-13 type-5 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void dataReplicatedToCorrectTableWithoutDrain() throws Exception {
  MiniAccumuloConfigImpl peerCfg=new MiniAccumuloConfigImpl(createTestDir(this.getClass().getName() + "_" + this.testName.getMethodName()+ "_peer"),ROOT_PASSWORD);
  peerCfg.setNumTservers(1);
  peerCfg.setInstanceName("peer");
  peerCfg.setProperty(Property.REPLICATION_NAME,"peer");
  updatePeerConfigFromPrimary(getCluster().getConfig(),peerCfg);
  MiniAccumuloClusterImpl peer1Cluster=new MiniAccumuloClusterImpl(peerCfg);
  peer1Cluster.start();
  try {
    Connector connMaster=getConnector();
    Connector connPeer=peer1Cluster.getConnector("root",new PasswordToken(ROOT_PASSWORD));
    String peerClusterName="peer";
    String peerUserName="repl";
    String peerPassword="passwd";
    connPeer.securityOperations().createLocalUser(peerUserName,new PasswordToken(peerPassword));
    connMaster.instanceOperations().setProperty(Property.REPLICATION_PEER_USER.getKey() + peerClusterName,peerUserName);
    connMaster.instanceOperations().setProperty(Property.REPLICATION_PEER_PASSWORD.getKey() + peerClusterName,peerPassword);
    connMaster.instanceOperations().setProperty(Property.REPLICATION_PEERS.getKey() + peerClusterName,ReplicaSystemFactory.getPeerConfigurationValue(AccumuloReplicaSystem.class,AccumuloReplicaSystem.buildConfiguration(peer1Cluster.getInstanceName(),peer1Cluster.getZooKeepers())));
    String masterTable1="master1", peerTable1="peer1", masterTable2="master2", peerTable2="peer2";
    connMaster.tableOperations().create(masterTable1);
    String masterTableId1=connMaster.tableOperations().tableIdMap().get(masterTable1);
    Assert.assertNotNull(masterTableId1);
    connMaster.tableOperations().create(masterTable2);
    String masterTableId2=connMaster.tableOperations().tableIdMap().get(masterTable2);
    Assert.assertNotNull(masterTableId2);
    connPeer.tableOperations().create(peerTable1);
    String peerTableId1=connPeer.tableOperations().tableIdMap().get(peerTable1);
    Assert.assertNotNull(peerTableId1);
    connPeer.tableOperations().create(peerTable2);
    String peerTableId2=connPeer.tableOperations().tableIdMap().get(peerTable2);
    Assert.assertNotNull(peerTableId2);
    connPeer.securityOperations().grantTablePermission(peerUserName,peerTable1,TablePermission.WRITE);
    connPeer.securityOperations().grantTablePermission(peerUserName,peerTable2,TablePermission.WRITE);
    connMaster.tableOperations().setProperty(masterTable1,Property.TABLE_REPLICATION.getKey(),"true");
    connMaster.tableOperations().setProperty(masterTable1,Property.TABLE_REPLICATION_TARGET.getKey() + peerClusterName,peerTableId1);
    connMaster.tableOperations().setProperty(masterTable2,Property.TABLE_REPLICATION.getKey(),"true");
    connMaster.tableOperations().setProperty(masterTable2,Property.TABLE_REPLICATION_TARGET.getKey() + peerClusterName,peerTableId2);
    BatchWriter bw=connMaster.createBatchWriter(masterTable1,new BatchWriterConfig());
    for (int rows=0; rows < 2500; rows++) {
      Mutation m=new Mutation(masterTable1 + rows);
      for (int cols=0; cols < 100; cols++) {
        String value=Integer.toString(cols);
        m.put(value,"",value);
      }
      bw.addMutation(m);
    }
    bw.close();
    bw=connMaster.createBatchWriter(masterTable2,new BatchWriterConfig());
    for (int rows=0; rows < 2500; rows++) {
      Mutation m=new Mutation(masterTable2 + rows);
      for (int cols=0; cols < 100; cols++) {
        String value=Integer.toString(cols);
        m.put(value,"",value);
      }
      bw.addMutation(m);
    }
    bw.close();
    log.info("Wrote all data to master cluster");
    for (    ProcessReference proc : cluster.getProcesses().get(ServerType.TABLET_SERVER)) {
      cluster.killProcess(ServerType.TABLET_SERVER,proc);
    }
    cluster.exec(TabletServer.class);
    while (!ReplicationTable.isOnline(connMaster)) {
      log.info("Replication table still offline, waiting");
      Thread.sleep(5000);
    }
    boolean fullyReplicated=false;
    for (int i=0; i < 10 && !fullyReplicated; i++) {
      sleepUninterruptibly(2,TimeUnit.SECONDS);
      Scanner s=ReplicationTable.getScanner(connMaster);
      WorkSection.limit(s);
      for (      Entry<Key,Value> entry : s) {
        Status status=Status.parseFrom(entry.getValue().get());
        if (StatusUtil.isFullyReplicated(status)) {
          fullyReplicated|=true;
        }
      }
    }
    Assert.assertNotEquals(0,fullyReplicated);
    long countTable=0l;
    for (int i=0; i < 10; i++) {
      for (      Entry<Key,Value> entry : connPeer.createScanner(peerTable1,Authorizations.EMPTY)) {
        countTable++;
        Assert.assertTrue("Found unexpected key-value" + entry.getKey().toStringNoTruncate() + " "+ entry.getValue(),entry.getKey().getRow().toString().startsWith(masterTable1));
      }
      log.info("Found {} records in {}",countTable,peerTable1);
      if (0l == countTable) {
        Thread.sleep(5000);
      }
 else {
        break;
      }
    }
    Assert.assertTrue("Found no records in " + peerTable1 + " in the peer cluster",countTable > 0);
    for (int i=0; i < 10; i++) {
      countTable=0l;
      for (      Entry<Key,Value> entry : connPeer.createScanner(peerTable2,Authorizations.EMPTY)) {
        countTable++;
        Assert.assertTrue("Found unexpected key-value" + entry.getKey().toStringNoTruncate() + " "+ entry.getValue(),entry.getKey().getRow().toString().startsWith(masterTable2));
      }
      log.info("Found {} records in {}",countTable,peerTable2);
      if (0l == countTable) {
        Thread.sleep(5000);
      }
 else {
        break;
      }
    }
    Assert.assertTrue("Found no records in " + peerTable2 + " in the peer cluster",countTable > 0);
  }
  finally {
    peer1Cluster.stop();
  }
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void dataReplicatedToCorrectTable() throws Exception {
  MiniAccumuloConfigImpl peerCfg=new MiniAccumuloConfigImpl(createTestDir(this.getClass().getName() + "_" + this.testName.getMethodName()+ "_peer"),ROOT_PASSWORD);
  peerCfg.setNumTservers(1);
  peerCfg.setInstanceName("peer");
  peerCfg.setProperty(Property.REPLICATION_NAME,"peer");
  updatePeerConfigFromPrimary(getCluster().getConfig(),peerCfg);
  MiniAccumuloClusterImpl peer1Cluster=new MiniAccumuloClusterImpl(peerCfg);
  peer1Cluster.start();
  try {
    Connector connMaster=getConnector();
    Connector connPeer=peer1Cluster.getConnector("root",new PasswordToken(ROOT_PASSWORD));
    String peerClusterName="peer";
    String peerUserName="peer", peerPassword="foo";
    connPeer.securityOperations().createLocalUser(peerUserName,new PasswordToken(peerPassword));
    connMaster.instanceOperations().setProperty(Property.REPLICATION_PEER_USER.getKey() + peerClusterName,peerUserName);
    connMaster.instanceOperations().setProperty(Property.REPLICATION_PEER_PASSWORD.getKey() + peerClusterName,peerPassword);
    connMaster.instanceOperations().setProperty(Property.REPLICATION_PEERS.getKey() + peerClusterName,ReplicaSystemFactory.getPeerConfigurationValue(AccumuloReplicaSystem.class,AccumuloReplicaSystem.buildConfiguration(peer1Cluster.getInstanceName(),peer1Cluster.getZooKeepers())));
    String masterTable1="master1", peerTable1="peer1", masterTable2="master2", peerTable2="peer2";
    connMaster.tableOperations().create(masterTable1);
    String masterTableId1=connMaster.tableOperations().tableIdMap().get(masterTable1);
    Assert.assertNotNull(masterTableId1);
    connMaster.tableOperations().create(masterTable2);
    String masterTableId2=connMaster.tableOperations().tableIdMap().get(masterTable2);
    Assert.assertNotNull(masterTableId2);
    connPeer.tableOperations().create(peerTable1);
    String peerTableId1=connPeer.tableOperations().tableIdMap().get(peerTable1);
    Assert.assertNotNull(peerTableId1);
    connPeer.tableOperations().create(peerTable2);
    String peerTableId2=connPeer.tableOperations().tableIdMap().get(peerTable2);
    Assert.assertNotNull(peerTableId2);
    connPeer.securityOperations().grantTablePermission(peerUserName,peerTable1,TablePermission.WRITE);
    connPeer.securityOperations().grantTablePermission(peerUserName,peerTable2,TablePermission.WRITE);
    connMaster.tableOperations().setProperty(masterTable1,Property.TABLE_REPLICATION.getKey(),"true");
    connMaster.tableOperations().setProperty(masterTable1,Property.TABLE_REPLICATION_TARGET.getKey() + peerClusterName,peerTableId1);
    connMaster.tableOperations().setProperty(masterTable2,Property.TABLE_REPLICATION.getKey(),"true");
    connMaster.tableOperations().setProperty(masterTable2,Property.TABLE_REPLICATION_TARGET.getKey() + peerClusterName,peerTableId2);
    BatchWriter bw=connMaster.createBatchWriter(masterTable1,new BatchWriterConfig());
    long masterTable1Records=0l;
    for (int rows=0; rows < 2500; rows++) {
      Mutation m=new Mutation(masterTable1 + rows);
      for (int cols=0; cols < 100; cols++) {
        String value=Integer.toString(cols);
        m.put(value,"",value);
        masterTable1Records++;
      }
      bw.addMutation(m);
    }
    bw.close();
    bw=connMaster.createBatchWriter(masterTable2,new BatchWriterConfig());
    long masterTable2Records=0l;
    for (int rows=0; rows < 2500; rows++) {
      Mutation m=new Mutation(masterTable2 + rows);
      for (int cols=0; cols < 100; cols++) {
        String value=Integer.toString(cols);
        m.put(value,"",value);
        masterTable2Records++;
      }
      bw.addMutation(m);
    }
    bw.close();
    log.info("Wrote all data to master cluster");
    Set<String> filesFor1=connMaster.replicationOperations().referencedFiles(masterTable1), filesFor2=connMaster.replicationOperations().referencedFiles(masterTable2);
    log.info("Files to replicate for table1: " + filesFor1);
    log.info("Files to replicate for table2: " + filesFor2);
    for (    ProcessReference proc : cluster.getProcesses().get(ServerType.TABLET_SERVER)) {
      cluster.killProcess(ServerType.TABLET_SERVER,proc);
    }
    cluster.exec(TabletServer.class);
    log.info("Restarted the tserver");
    Iterators.size(connMaster.createScanner(masterTable1,Authorizations.EMPTY).iterator());
    while (!ReplicationTable.isOnline(connMaster)) {
      log.info("Replication table still offline, waiting");
      Thread.sleep(5000);
    }
    log.info("Waiting for {} for {}",filesFor1,masterTable1);
    connMaster.replicationOperations().drain(masterTable1,filesFor1);
    log.info("Waiting for {} for {}",filesFor2,masterTable2);
    connMaster.replicationOperations().drain(masterTable2,filesFor2);
    long countTable=0l;
    for (    Entry<Key,Value> entry : connPeer.createScanner(peerTable1,Authorizations.EMPTY)) {
      countTable++;
      Assert.assertTrue("Found unexpected key-value" + entry.getKey().toStringNoTruncate() + " "+ entry.getValue(),entry.getKey().getRow().toString().startsWith(masterTable1));
    }
    log.info("Found {} records in {}",countTable,peerTable1);
    Assert.assertEquals(masterTable1Records,countTable);
    countTable=0l;
    for (    Entry<Key,Value> entry : connPeer.createScanner(peerTable2,Authorizations.EMPTY)) {
      countTable++;
      Assert.assertTrue("Found unexpected key-value" + entry.getKey().toStringNoTruncate() + " "+ entry.getValue(),entry.getKey().getRow().toString().startsWith(masterTable2));
    }
    log.info("Found {} records in {}",countTable,peerTable2);
    Assert.assertEquals(masterTable2Records,countTable);
  }
  finally {
    peer1Cluster.stop();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.replication.MultiTserverReplicationIT </h4><pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void masterReplicationServicePortsAreAdvertised() throws Exception {
  Connector conn=getConnector();
  Instance inst=conn.getInstance();
  conn.tableOperations().create("foo");
  Scanner s=conn.createScanner("foo",Authorizations.EMPTY);
  Assert.assertEquals(0,Iterables.size(s));
  ZooReader zreader=new ZooReader(inst.getZooKeepers(),inst.getZooKeepersSessionTimeOut());
  Assert.assertEquals(1,inst.getMasterLocations().size());
  String masterAddr=Iterables.getOnlyElement(inst.getMasterLocations());
  String replCoordAddr=new String(zreader.getData(ZooUtil.getRoot(inst) + Constants.ZMASTER_REPLICATION_COORDINATOR_ADDR,null),UTF_8);
  Assert.assertNotEquals(masterAddr,replCoordAddr);
  Assert.assertNotEquals(0,HostAndPort.fromString(masterAddr).getPort());
  Assert.assertNotEquals(0,HostAndPort.fromString(replCoordAddr).getPort());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.replication.RemoveCompleteReplicationRecordsIT </h4><pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void partiallyReplicatedEntriesPrecludeRowDeletion() throws Exception {
  BatchWriter replBw=ReplicationTable.getBatchWriter(conn);
  int numRecords=3;
  Status.Builder builder=Status.newBuilder();
  builder.setClosed(false);
  builder.setEnd(10000);
  builder.setInfiniteEnd(false);
  for (int i=0; i < numRecords; i++) {
    String file="/accumulo/wal/tserver+port/" + UUID.randomUUID();
    Mutation m=new Mutation(file);
    StatusSection.add(m,new Text(Integer.toString(i)),ProtobufUtil.toValue(builder.setBegin(1000 * (i + 1)).build()));
    replBw.addMutation(m);
  }
  String fileToRemove="/accumulo/wal/tserver+port/" + UUID.randomUUID();
  Mutation m=new Mutation(fileToRemove);
  ReplicationTarget target=new ReplicationTarget("peer1","5","5");
  Value value=ProtobufUtil.toValue(builder.setBegin(10000).setEnd(10000).setClosed(true).build());
  StatusSection.add(m,new Text("5"),value);
  WorkSection.add(m,target.toText(),value);
  target=new ReplicationTarget("peer2","5","5");
  WorkSection.add(m,target.toText(),value);
  target=new ReplicationTarget("peer3","5","5");
  WorkSection.add(m,target.toText(),ProtobufUtil.toValue(builder.setClosed(false).build()));
  replBw.addMutation(m);
  numRecords+=4;
  replBw.flush();
  Assert.assertEquals(numRecords,Iterables.size(ReplicationTable.getScanner(conn)));
  BatchScanner bs=ReplicationTable.getBatchScanner(conn,1);
  bs.setRanges(Collections.singleton(new Range()));
  IteratorSetting cfg=new IteratorSetting(50,WholeRowIterator.class);
  bs.addScanIterator(cfg);
  try {
    Assert.assertEquals(0l,rcrr.removeCompleteRecords(conn,bs,replBw));
  }
  finally {
    bs.close();
    replBw.close();
  }
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void replicatedClosedWorkRecordsAreNotRemovedWithoutClosedStatusRecords() throws Exception {
  BatchWriter replBw=ReplicationTable.getBatchWriter(conn);
  int numRecords=3;
  Status.Builder builder=Status.newBuilder();
  builder.setClosed(false);
  builder.setEnd(10000);
  builder.setInfiniteEnd(false);
  for (int i=0; i < numRecords; i++) {
    String file="/accumulo/wal/tserver+port/" + UUID.randomUUID();
    Mutation m=new Mutation(file);
    StatusSection.add(m,new Text(Integer.toString(i)),ProtobufUtil.toValue(builder.setBegin(1000 * (i + 1)).build()));
    replBw.addMutation(m);
  }
  String fileToRemove="/accumulo/wal/tserver+port/" + UUID.randomUUID();
  Mutation m=new Mutation(fileToRemove);
  StatusSection.add(m,new Text("5"),ProtobufUtil.toValue(builder.setBegin(10000).setEnd(10000).setClosed(false).build()));
  replBw.addMutation(m);
  numRecords++;
  fileToRemove="/accumulo/wal/tserver+port/" + UUID.randomUUID();
  m=new Mutation(fileToRemove);
  StatusSection.add(m,new Text("6"),ProtobufUtil.toValue(builder.setBegin(10000).setEnd(10000).setClosed(false).build()));
  replBw.addMutation(m);
  numRecords++;
  replBw.flush();
  Assert.assertEquals(numRecords,Iterables.size(ReplicationTable.getScanner(conn)));
  BatchScanner bs=ReplicationTable.getBatchScanner(conn,1);
  bs.setRanges(Collections.singleton(new Range()));
  IteratorSetting cfg=new IteratorSetting(50,WholeRowIterator.class);
  bs.addScanIterator(cfg);
  try {
    Assert.assertEquals(0l,rcrr.removeCompleteRecords(conn,bs,replBw));
  }
  finally {
    bs.close();
    replBw.close();
  }
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void replicatedClosedRowsAreRemoved() throws Exception {
  BatchWriter replBw=ReplicationTable.getBatchWriter(conn);
  int numRecords=3;
  Status.Builder builder=Status.newBuilder();
  builder.setClosed(false);
  builder.setEnd(10000);
  builder.setInfiniteEnd(false);
  long time=System.currentTimeMillis();
  for (int i=0; i < numRecords; i++) {
    builder.setCreatedTime(time++);
    String file="/accumulo/wal/tserver+port/" + UUID.randomUUID();
    Mutation m=new Mutation(file);
    Value v=ProtobufUtil.toValue(builder.setBegin(1000 * (i + 1)).build());
    StatusSection.add(m,new Text(Integer.toString(i)),v);
    replBw.addMutation(m);
    m=OrderSection.createMutation(file,time);
    OrderSection.add(m,new Text(Integer.toString(i)),v);
    replBw.addMutation(m);
  }
  Set<String> filesToRemove=new HashSet<>();
  numRecords*=2;
  int finalNumRecords=numRecords;
  String fileToRemove="/accumulo/wal/tserver+port/" + UUID.randomUUID();
  filesToRemove.add(fileToRemove);
  Mutation m=new Mutation(fileToRemove);
  ReplicationTarget target=new ReplicationTarget("peer1","5","5");
  Value value=ProtobufUtil.toValue(builder.setBegin(10000).setEnd(10000).setClosed(true).setCreatedTime(time).build());
  StatusSection.add(m,new Text("5"),value);
  WorkSection.add(m,target.toText(),value);
  replBw.addMutation(m);
  m=OrderSection.createMutation(fileToRemove,time);
  OrderSection.add(m,new Text("5"),value);
  replBw.addMutation(m);
  time++;
  numRecords+=3;
  fileToRemove="/accumulo/wal/tserver+port/" + UUID.randomUUID();
  filesToRemove.add(fileToRemove);
  m=new Mutation(fileToRemove);
  value=ProtobufUtil.toValue(builder.setBegin(10000).setEnd(10000).setClosed(true).setCreatedTime(time).build());
  target=new ReplicationTarget("peer1","6","6");
  StatusSection.add(m,new Text("6"),value);
  WorkSection.add(m,target.toText(),value);
  replBw.addMutation(m);
  m=OrderSection.createMutation(fileToRemove,time);
  OrderSection.add(m,new Text("6"),value);
  replBw.addMutation(m);
  time++;
  numRecords+=3;
  replBw.flush();
  Assert.assertEquals(numRecords,Iterables.size(ReplicationTable.getScanner(conn)));
  BatchScanner bs=ReplicationTable.getBatchScanner(conn,1);
  bs.setRanges(Collections.singleton(new Range()));
  StatusSection.limit(bs);
  WorkSection.limit(bs);
  IteratorSetting cfg=new IteratorSetting(50,WholeRowIterator.class);
  bs.addScanIterator(cfg);
  try {
    Assert.assertEquals(4l,rcrr.removeCompleteRecords(conn,bs,replBw));
  }
  finally {
    bs.close();
    replBw.close();
  }
  int actualRecords=0;
  for (  Entry<Key,Value> entry : ReplicationTable.getScanner(conn)) {
    Assert.assertFalse(filesToRemove.contains(entry.getKey().getRow().toString()));
    actualRecords++;
  }
  Assert.assertEquals(finalNumRecords,actualRecords);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.replication.ReplicationIT </h4><pre class="type-9 type-13 type-8 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void correctRecordsCompleteFile() throws Exception {
  Connector conn=getConnector();
  String table="table1";
  conn.tableOperations().create(table);
  conn.tableOperations().setProperty(table,Property.TABLE_REPLICATION.getKey(),"true");
  BatchWriter bw=conn.createBatchWriter(table,new BatchWriterConfig());
  for (int i=0; i < 10; i++) {
    Mutation m=new Mutation(Integer.toString(i));
    m.put(new byte[0],new byte[0],new byte[0]);
    bw.addMutation(m);
  }
  bw.close();
  boolean online=ReplicationTable.isOnline(conn);
  int attempts=10;
  do {
    if (!online) {
      sleepUninterruptibly(2,TimeUnit.SECONDS);
      online=ReplicationTable.isOnline(conn);
      attempts--;
    }
  }
 while (!online && attempts > 0);
  Assert.assertTrue("Replication table was not online",online);
  for (int i=0; i < 5; i++) {
    if (conn.securityOperations().hasTablePermission("root",ReplicationTable.NAME,TablePermission.READ)) {
      break;
    }
    log.info("Could not read replication table, waiting and will retry");
    Thread.sleep(2000);
  }
  Assert.assertTrue("'root' user could not read the replication table",conn.securityOperations().hasTablePermission("root",ReplicationTable.NAME,TablePermission.READ));
  Set<String> replRows=new HashSet<>();
  Scanner scanner;
  attempts=5;
  while (replRows.isEmpty() && attempts > 0) {
    scanner=ReplicationTable.getScanner(conn);
    StatusSection.limit(scanner);
    for (    Entry<Key,Value> entry : scanner) {
      Key k=entry.getKey();
      String fileUri=k.getRow().toString();
      try {
        new URI(fileUri);
      }
 catch (      URISyntaxException e) {
        Assert.fail("Expected a valid URI: " + fileUri);
      }
      replRows.add(fileUri);
    }
  }
  Set<String> wals=new HashSet<>();
  attempts=5;
  Instance i=conn.getInstance();
  ZooReaderWriter zk=new ZooReaderWriter(i.getZooKeepers(),i.getZooKeepersSessionTimeOut(),"");
  while (wals.isEmpty() && attempts > 0) {
    WalStateManager markers=new WalStateManager(i,zk);
    for (    Entry<Path,WalState> entry : markers.getAllState().entrySet()) {
      wals.add(entry.getKey().toString());
    }
    attempts--;
  }
  Assert.assertEquals("Rows found: " + replRows,1,replRows.size());
  replRows.removeAll(wals);
  Assert.assertEquals(2,wals.size());
  Assert.assertEquals(0,replRows.size());
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void combinerWorksOnMetadata() throws Exception {
  Connector conn=getConnector();
  conn.securityOperations().grantTablePermission("root",MetadataTable.NAME,TablePermission.WRITE);
  ReplicationTableUtil.configureMetadataTable(conn,MetadataTable.NAME);
  Status stat1=StatusUtil.fileCreated(100);
  Status stat2=StatusUtil.fileClosed();
  BatchWriter bw=conn.createBatchWriter(MetadataTable.NAME,new BatchWriterConfig());
  Mutation m=new Mutation(ReplicationSection.getRowPrefix() + "file:/accumulo/wals/tserver+port/uuid");
  m.put(ReplicationSection.COLF,new Text("1"),ProtobufUtil.toValue(stat1));
  bw.addMutation(m);
  bw.close();
  Scanner s=conn.createScanner(MetadataTable.NAME,Authorizations.EMPTY);
  s.setRange(ReplicationSection.getRange());
  Status actual=Status.parseFrom(Iterables.getOnlyElement(s).getValue().get());
  Assert.assertEquals(stat1,actual);
  bw=conn.createBatchWriter(MetadataTable.NAME,new BatchWriterConfig());
  m=new Mutation(ReplicationSection.getRowPrefix() + "file:/accumulo/wals/tserver+port/uuid");
  m.put(ReplicationSection.COLF,new Text("1"),ProtobufUtil.toValue(stat2));
  bw.addMutation(m);
  bw.close();
  s=conn.createScanner(MetadataTable.NAME,Authorizations.EMPTY);
  s.setRange(ReplicationSection.getRange());
  actual=Status.parseFrom(Iterables.getOnlyElement(s).getValue().get());
  Status expected=Status.newBuilder().setBegin(0).setEnd(0).setClosed(true).setInfiniteEnd(true).setCreatedTime(100).build();
  Assert.assertEquals(expected,actual);
}

</code></pre>

<br>
<pre class="type-9 type-11 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void replicationEntriesPrecludeWalDeletion() throws Exception {
  final Connector conn=getConnector();
  String table1="table1", table2="table2", table3="table3";
  final Multimap<String,String> logs=HashMultimap.create();
  final AtomicBoolean keepRunning=new AtomicBoolean(true);
  Thread t=new Thread(new Runnable(){
    @Override public void run(){
      while (keepRunning.get()) {
        try {
          logs.putAll(getAllLogs(conn));
        }
 catch (        Exception e) {
          log.error("Error getting logs",e);
        }
      }
    }
  }
);
  t.start();
  conn.tableOperations().create(table1);
  conn.tableOperations().setProperty(table1,Property.TABLE_REPLICATION.getKey(),"true");
  conn.tableOperations().setProperty(table1,Property.TABLE_REPLICATION_TARGET.getKey() + "cluster1","1");
  Thread.sleep(2000);
  writeSomeData(conn,table1,200,500);
  conn.tableOperations().create(table2);
  conn.tableOperations().setProperty(table2,Property.TABLE_REPLICATION.getKey(),"true");
  conn.tableOperations().setProperty(table2,Property.TABLE_REPLICATION_TARGET.getKey() + "cluster1","1");
  Thread.sleep(2000);
  writeSomeData(conn,table2,200,500);
  conn.tableOperations().create(table3);
  conn.tableOperations().setProperty(table3,Property.TABLE_REPLICATION.getKey(),"true");
  conn.tableOperations().setProperty(table3,Property.TABLE_REPLICATION_TARGET.getKey() + "cluster1","1");
  Thread.sleep(2000);
  writeSomeData(conn,table3,200,500);
  for (  String table : Arrays.asList(table1,table2,table3)) {
    conn.tableOperations().flush(table,null,null,true);
  }
  keepRunning.set(false);
  t.join(5000);
  Thread.sleep(5000);
  Set<String> replFiles=getReferencesToFilesToBeReplicated(conn);
  String replicationTableId=conn.tableOperations().tableIdMap().get(ReplicationTable.NAME);
  Iterator<Entry<String,String>> observedLogs=logs.entries().iterator();
  while (observedLogs.hasNext()) {
    Entry<String,String> observedLog=observedLogs.next();
    if (replicationTableId.equals(observedLog.getValue())) {
      log.info("Removing {} because its tableId is for the replication table",observedLog);
      observedLogs.remove();
    }
  }
  Assert.assertTrue("Metadata log distribution: " + logs + "replFiles "+ replFiles,logs.keySet().containsAll(replFiles));
  Assert.assertTrue("Difference between replication entries and current logs is bigger than one",logs.keySet().size() - replFiles.size() <= 1);
  final Configuration conf=new Configuration();
  for (  String replFile : replFiles) {
    Path p=new Path(replFile);
    FileSystem fs=p.getFileSystem(conf);
    if (!fs.exists(p)) {
      Set<String> currentSet=getReferencesToFilesToBeReplicated(conn);
      log.info("Current references {}",currentSet);
      log.info("Looking for reference to {}",replFile);
      log.info("Contains? {}",currentSet.contains(replFile));
      Assert.assertTrue("File does not exist anymore, it was likely incorrectly garbage collected: " + p,!currentSet.contains(replFile));
    }
  }
}

</code></pre>

<br>
<pre class="type-9 type-8 type-3 type-7 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void filesClosedAfterUnused() throws Exception {
  Connector conn=getConnector();
  String table="table";
  conn.tableOperations().create(table);
  String tableId=conn.tableOperations().tableIdMap().get(table);
  Assert.assertNotNull(tableId);
  conn.tableOperations().setProperty(table,Property.TABLE_REPLICATION.getKey(),"true");
  conn.tableOperations().setProperty(table,Property.TABLE_REPLICATION_TARGET.getKey() + "cluster1","1");
  conn.instanceOperations().setProperty(Property.REPLICATION_PEERS.getKey() + "cluster1",ReplicaSystemFactory.getPeerConfigurationValue(MockReplicaSystem.class,"50000"));
  BatchWriter bw=conn.createBatchWriter(table,new BatchWriterConfig());
  Mutation m=new Mutation("one");
  m.put("","","");
  bw.addMutation(m);
  bw.close();
  bw=conn.createBatchWriter(table,new BatchWriterConfig());
  m=new Mutation("three");
  m.put("","","");
  bw.addMutation(m);
  bw.close();
  Scanner s=conn.createScanner(MetadataTable.NAME,Authorizations.EMPTY);
  s.fetchColumnFamily(TabletsSection.LogColumnFamily.NAME);
  s.setRange(TabletsSection.getRange(tableId));
  Set<String> wals=new HashSet<>();
  for (  Entry<Key,Value> entry : s) {
    LogEntry logEntry=LogEntry.fromKeyValue(entry.getKey(),entry.getValue());
    wals.add(new Path(logEntry.filename).toString());
  }
  log.warn("Found wals {}",wals);
  bw=conn.createBatchWriter(table,new BatchWriterConfig());
  m=new Mutation("three");
  byte[] bytes=new byte[1024 * 1024];
  m.put("1".getBytes(),new byte[0],bytes);
  m.put("2".getBytes(),new byte[0],bytes);
  m.put("3".getBytes(),new byte[0],bytes);
  m.put("4".getBytes(),new byte[0],bytes);
  m.put("5".getBytes(),new byte[0],bytes);
  bw.addMutation(m);
  bw.close();
  conn.tableOperations().flush(table,null,null,true);
  while (!ReplicationTable.isOnline(conn)) {
    sleepUninterruptibly(2,TimeUnit.SECONDS);
  }
  for (int i=0; i < 10; i++) {
    s=conn.createScanner(MetadataTable.NAME,Authorizations.EMPTY);
    s.fetchColumnFamily(LogColumnFamily.NAME);
    s.setRange(TabletsSection.getRange(tableId));
    for (    Entry<Key,Value> entry : s) {
      log.info(entry.getKey().toStringNoTruncate() + "=" + entry.getValue());
    }
    try {
      s=ReplicationTable.getScanner(conn);
      StatusSection.limit(s);
      Text buff=new Text();
      boolean allReferencedLogsClosed=true;
      int recordsFound=0;
      for (      Entry<Key,Value> e : s) {
        recordsFound++;
        allReferencedLogsClosed=true;
        StatusSection.getFile(e.getKey(),buff);
        String file=buff.toString();
        if (wals.contains(file)) {
          Status stat=Status.parseFrom(e.getValue().get());
          if (!stat.getClosed()) {
            log.info("{} wasn't closed",file);
            allReferencedLogsClosed=false;
          }
        }
      }
      if (recordsFound > 0 && allReferencedLogsClosed) {
        return;
      }
      Thread.sleep(2000);
    }
 catch (    RuntimeException e) {
      Throwable cause=e.getCause();
      if (cause instanceof AccumuloSecurityException) {
        AccumuloSecurityException ase=(AccumuloSecurityException)cause;
switch (ase.getSecurityErrorCode()) {
case PERMISSION_DENIED:
          Thread.sleep(2000);
        break;
default :
      throw e;
  }
}
}
}
Assert.fail("We had a file that was referenced but didn't get closed");
}

</code></pre>

<br>
<pre class="type-9 type-13 type-11 type-8 type-5 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void replicatedStatusEntriesAreDeleted() throws Exception {
  getCluster().getClusterControl().stop(ServerType.GARBAGE_COLLECTOR);
  final Connector conn=getConnector();
  log.info("Got connector to MAC");
  String table1="table1";
  Assert.assertFalse(ReplicationTable.isOnline(conn));
  conn.tableOperations().create(table1);
  int attempts=5;
  while (attempts > 0) {
    try {
      conn.tableOperations().setProperty(table1,Property.TABLE_REPLICATION.getKey(),"true");
      conn.tableOperations().setProperty(table1,Property.TABLE_REPLICATION_TARGET.getKey() + "cluster1","4");
      conn.instanceOperations().setProperty(Property.REPLICATION_PEERS.getKey() + "cluster1",ReplicaSystemFactory.getPeerConfigurationValue(MockReplicaSystem.class,"1000"));
      attempts=0;
    }
 catch (    Exception e) {
      attempts--;
      if (attempts <= 0) {
        throw e;
      }
      sleepUninterruptibly(500,TimeUnit.MILLISECONDS);
    }
  }
  String tableId=conn.tableOperations().tableIdMap().get(table1);
  Assert.assertNotNull("Could not determine table id for " + table1,tableId);
  writeSomeData(conn,table1,2000,50);
  conn.tableOperations().flush(table1,null,null,true);
  boolean online=ReplicationTable.isOnline(conn);
  attempts=10;
  do {
    if (!online) {
      sleepUninterruptibly(1,TimeUnit.SECONDS);
      online=ReplicationTable.isOnline(conn);
      attempts--;
    }
  }
 while (!online && attempts > 0);
  Assert.assertTrue("Replication table did not exist",online);
  conn.securityOperations().grantTablePermission("root",ReplicationTable.NAME,TablePermission.WRITE);
  log.info("Checking for replication entries in replication");
  Scanner s;
  Set<String> entries=new HashSet<>();
  for (int i=0; i < 5; i++) {
    s=conn.createScanner(MetadataTable.NAME,Authorizations.EMPTY);
    s.setRange(ReplicationSection.getRange());
    entries.clear();
    for (    Entry<Key,Value> entry : s) {
      entries.add(entry.getKey().getRow().toString());
      log.info("{}={}",entry.getKey().toStringNoTruncate(),entry.getValue());
    }
    if (!entries.isEmpty()) {
      log.info("Replication entries {}",entries);
      break;
    }
    Thread.sleep(1000);
  }
  Assert.assertFalse("Did not find any replication entries in the replication table",entries.isEmpty());
  boolean notFound=true;
  for (int i=0; i < 10 && notFound; i++) {
    try {
      s=ReplicationTable.getScanner(conn);
      WorkSection.limit(s);
      Entry<Key,Value> e=Iterables.getOnlyElement(s);
      log.info("Found entry: " + e.getKey().toStringNoTruncate());
      Text expectedColqual=new ReplicationTarget("cluster1","4",tableId).toText();
      Assert.assertEquals(expectedColqual,e.getKey().getColumnQualifier());
      notFound=false;
    }
 catch (    NoSuchElementException e) {
    }
catch (    IllegalArgumentException e) {
      s=ReplicationTable.getScanner(conn);
      for (      Entry<Key,Value> content : s) {
        log.info(content.getKey().toStringNoTruncate() + " => " + content.getValue());
      }
      Assert.fail("Found more than one work section entry");
    }
catch (    RuntimeException e) {
      Throwable cause=e.getCause();
      if (cause instanceof AccumuloSecurityException) {
        AccumuloSecurityException sec=(AccumuloSecurityException)cause;
switch (sec.getSecurityErrorCode()) {
case PERMISSION_DENIED:
          log.warn("Sleeping because permission was denied");
        break;
default :
      throw e;
  }
}
 else {
  throw e;
}
}
Thread.sleep(2000);
}
if (notFound) {
s=ReplicationTable.getScanner(conn);
for (Entry<Key,Value> content : s) {
log.info(content.getKey().toStringNoTruncate() + " => " + ProtobufUtil.toString(Status.parseFrom(content.getValue().get())));
}
Assert.assertFalse("Did not find the work entry for the status entry",notFound);
}
log.info("Killing tserver");
cluster.getClusterControl().stop(ServerType.TABLET_SERVER);
log.info("Starting tserver");
cluster.getClusterControl().start(ServerType.TABLET_SERVER);
log.info("Waiting to read tables");
sleepUninterruptibly(2 * 3,TimeUnit.SECONDS);
for (String table : new String[]{MetadataTable.NAME,table1}) {
Iterators.size(conn.createScanner(table,Authorizations.EMPTY).iterator());
}
log.info("Recovered metadata:");
s=conn.createScanner(MetadataTable.NAME,Authorizations.EMPTY);
for (Entry<Key,Value> entry : s) {
log.info("{}={}",entry.getKey().toStringNoTruncate(),entry.getValue());
}
cluster.getClusterControl().start(ServerType.GARBAGE_COLLECTOR);
waitForGCLock(conn);
Thread.sleep(1000);
log.info("After GC");
s=conn.createScanner(MetadataTable.NAME,Authorizations.EMPTY);
for (Entry<Key,Value> entry : s) {
log.info("{}={}",entry.getKey().toStringNoTruncate(),entry.getValue());
}
log.info("Checking metadata table for replication entries");
Set<String> remaining=new HashSet<>();
for (int i=0; i < 10; i++) {
s=conn.createScanner(MetadataTable.NAME,Authorizations.EMPTY);
s.setRange(ReplicationSection.getRange());
remaining.clear();
for (Entry<Key,Value> e : s) {
remaining.add(e.getKey().getRow().toString());
}
remaining.retainAll(entries);
if (remaining.isEmpty()) {
break;
}
log.info("remaining {}",remaining);
Thread.sleep(2000);
log.info("");
}
Assert.assertTrue("Replication status messages were not cleaned up from metadata table",remaining.isEmpty());
int recordsFound=0;
for (int i=0; i < 30; i++) {
s=ReplicationTable.getScanner(conn);
recordsFound=0;
for (Entry<Key,Value> entry : s) {
recordsFound++;
log.info("{} {}",entry.getKey().toStringNoTruncate(),ProtobufUtil.toString(Status.parseFrom(entry.getValue().get())));
}
if (recordsFound <= 2) {
break;
}
 else {
Thread.sleep(1000);
log.info("");
}
}
Assert.assertTrue("Found unexpected replication records in the replication table",recordsFound <= 2);
}

</code></pre>

<br>
<pre class="type-9 type-11 type-8 type-5 type-3 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void replicationRecordsAreClosedAfterGarbageCollection() throws Exception {
  getCluster().getClusterControl().stop(ServerType.GARBAGE_COLLECTOR);
  final Connector conn=getConnector();
  ReplicationTable.setOnline(conn);
  conn.securityOperations().grantTablePermission("root",ReplicationTable.NAME,TablePermission.WRITE);
  conn.tableOperations().deleteRows(ReplicationTable.NAME,null,null);
  final AtomicBoolean keepRunning=new AtomicBoolean(true);
  final Set<String> metadataWals=new HashSet<>();
  Thread t=new Thread(new Runnable(){
    @Override public void run(){
      while (keepRunning.get()) {
        try {
          metadataWals.addAll(getLogs(conn).keySet());
        }
 catch (        Exception e) {
          log.error("Metadata table doesn't exist");
        }
      }
    }
  }
);
  t.start();
  String table1="table1", table2="table2", table3="table3";
  try {
    conn.tableOperations().create(table1);
    conn.tableOperations().setProperty(table1,Property.TABLE_REPLICATION.getKey(),"true");
    conn.tableOperations().setProperty(table1,Property.TABLE_REPLICATION_TARGET.getKey() + "cluster1","1");
    conn.instanceOperations().setProperty(Property.REPLICATION_PEERS.getKey() + "cluster1",ReplicaSystemFactory.getPeerConfigurationValue(MockReplicaSystem.class,null));
    writeSomeData(conn,table1,200,500);
    conn.tableOperations().create(table2);
    conn.tableOperations().setProperty(table2,Property.TABLE_REPLICATION.getKey(),"true");
    conn.tableOperations().setProperty(table2,Property.TABLE_REPLICATION_TARGET.getKey() + "cluster1","1");
    writeSomeData(conn,table2,200,500);
    conn.tableOperations().create(table3);
    conn.tableOperations().setProperty(table3,Property.TABLE_REPLICATION.getKey(),"true");
    conn.tableOperations().setProperty(table3,Property.TABLE_REPLICATION_TARGET.getKey() + "cluster1","1");
    writeSomeData(conn,table3,200,500);
    for (    String table : Arrays.asList(table1,table2,table3)) {
      conn.tableOperations().compact(table,null,null,true,true);
    }
  }
  finally {
    keepRunning.set(false);
    t.join(5000);
    Assert.assertFalse(t.isAlive());
  }
  cluster.getClusterControl().stop(ServerType.TABLET_SERVER);
  cluster.getClusterControl().start(ServerType.TABLET_SERVER);
  for (  String table : Arrays.asList(table1,table2,table3)) {
    Iterators.size(conn.createScanner(table,Authorizations.EMPTY).iterator());
  }
  Process gc=cluster.exec(SimpleGarbageCollector.class);
  waitForGCLock(conn);
  Thread.sleep(1000);
  log.info("GC is up and should have had time to run at least once by now");
  try {
    boolean allClosed=true;
    for (int i=0; i < 10; i++) {
      Scanner s=conn.createScanner(MetadataTable.NAME,Authorizations.EMPTY);
      s.setRange(Range.prefix(ReplicationSection.getRowPrefix()));
      Iterator<Entry<Key,Value>> iter=s.iterator();
      long recordsFound=0l;
      while (allClosed && iter.hasNext()) {
        Entry<Key,Value> entry=iter.next();
        String wal=entry.getKey().getRow().toString();
        if (metadataWals.contains(wal)) {
          Status status=Status.parseFrom(entry.getValue().get());
          log.info("{}={}",entry.getKey().toStringNoTruncate(),ProtobufUtil.toString(status));
          allClosed&=status.getClosed();
          recordsFound++;
        }
      }
      log.info("Found {} records from the metadata table",recordsFound);
      if (allClosed) {
        break;
      }
      sleepUninterruptibly(2,TimeUnit.SECONDS);
    }
    if (!allClosed) {
      Scanner s=conn.createScanner(MetadataTable.NAME,Authorizations.EMPTY);
      s.setRange(Range.prefix(ReplicationSection.getRowPrefix()));
      for (      Entry<Key,Value> entry : s) {
        log.info(entry.getKey().toStringNoTruncate() + " " + ProtobufUtil.toString(Status.parseFrom(entry.getValue().get())));
      }
      Assert.fail("Expected all replication records in the metadata table to be closed");
    }
    for (int i=0; i < 10; i++) {
      allClosed=true;
      Scanner s=ReplicationTable.getScanner(conn);
      Iterator<Entry<Key,Value>> iter=s.iterator();
      long recordsFound=0l;
      while (allClosed && iter.hasNext()) {
        Entry<Key,Value> entry=iter.next();
        String wal=entry.getKey().getRow().toString();
        if (metadataWals.contains(wal)) {
          Status status=Status.parseFrom(entry.getValue().get());
          log.info("{}={}",entry.getKey().toStringNoTruncate(),ProtobufUtil.toString(status));
          allClosed&=status.getClosed();
          recordsFound++;
        }
      }
      log.info("Found {} records from the replication table",recordsFound);
      if (allClosed) {
        break;
      }
      sleepUninterruptibly(3,TimeUnit.SECONDS);
    }
    if (!allClosed) {
      Scanner s=ReplicationTable.getScanner(conn);
      StatusSection.limit(s);
      for (      Entry<Key,Value> entry : s) {
        log.info(entry.getKey().toStringNoTruncate() + " " + TextFormat.shortDebugString(Status.parseFrom(entry.getValue().get())));
      }
      Assert.fail("Expected all replication records in the replication table to be closed");
    }
  }
  finally {
    gc.destroy();
    gc.waitFor();
  }
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void twoEntriesForTwoTables() throws Exception {
  Connector conn=getConnector();
  String table1="table1", table2="table2";
  Assert.assertFalse("Replication table already online at the beginning of the test",ReplicationTable.isOnline(conn));
  conn.tableOperations().create(table1);
  conn.tableOperations().create(table2);
  conn.securityOperations().grantTablePermission("root",ReplicationTable.NAME,TablePermission.READ);
  Thread.sleep(5000);
  conn.tableOperations().setProperty(table1,Property.TABLE_REPLICATION.getKey(),"true");
  Assert.assertFalse(ReplicationTable.isOnline(conn));
  writeSomeData(conn,table1,50,50);
  boolean online=ReplicationTable.isOnline(conn);
  int attempts=10;
  do {
    if (!online) {
      sleepUninterruptibly(5,TimeUnit.SECONDS);
      online=ReplicationTable.isOnline(conn);
      attempts--;
    }
  }
 while (!online && attempts > 0);
  Assert.assertTrue("Replication table did not exist",online);
  Assert.assertTrue(ReplicationTable.isOnline(conn));
  Scanner s=ReplicationTable.getScanner(conn);
  StatusSection.limit(s);
  for (int i=0; i < 5; i++) {
    if (Iterators.size(s.iterator()) == 1) {
      break;
    }
    Thread.sleep(1000);
  }
  Entry<Key,Value> entry=Iterators.getOnlyElement(s.iterator());
  Assert.assertEquals("Expected to find replication entry for " + table1,conn.tableOperations().tableIdMap().get(table1),entry.getKey().getColumnQualifier().toString());
  s.close();
  conn.tableOperations().setProperty(table2,Property.TABLE_REPLICATION.getKey(),"true");
  writeSomeData(conn,table2,50,50);
  Set<String> tableIds=Sets.newHashSet(conn.tableOperations().tableIdMap().get(table1),conn.tableOperations().tableIdMap().get(table2));
  Set<String> tableIdsForMetadata=Sets.newHashSet(tableIds);
  List<Entry<Key,Value>> records=new ArrayList<>();
  s=conn.createScanner(MetadataTable.NAME,Authorizations.EMPTY);
  s.setRange(MetadataSchema.ReplicationSection.getRange());
  for (  Entry<Key,Value> metadata : s) {
    records.add(metadata);
    log.debug("Meta: {} => {}",metadata.getKey().toStringNoTruncate(),metadata.getValue().toString());
  }
  Assert.assertEquals("Expected to find 2 records, but actually found " + records,2,records.size());
  for (  Entry<Key,Value> metadata : records) {
    Assert.assertTrue("Expected record to be in metadata but wasn't " + metadata.getKey().toStringNoTruncate() + ", tableIds remaining "+ tableIdsForMetadata,tableIdsForMetadata.remove(metadata.getKey().getColumnQualifier().toString()));
  }
  Assert.assertTrue("Expected that we had removed all metadata entries " + tableIdsForMetadata,tableIdsForMetadata.isEmpty());
  Thread.sleep(5000);
  s=ReplicationTable.getScanner(conn);
  StatusSection.limit(s);
  Iterator<Entry<Key,Value>> iter=s.iterator();
  Assert.assertTrue("Found no records in replication table",iter.hasNext());
  entry=iter.next();
  Assert.assertTrue("Expected to find element in replication table",tableIds.remove(entry.getKey().getColumnQualifier().toString()));
  Assert.assertTrue("Expected to find two elements in replication table, only found one ",iter.hasNext());
  entry=iter.next();
  Assert.assertTrue("Expected to find element in replication table",tableIds.remove(entry.getKey().getColumnQualifier().toString()));
  Assert.assertFalse("Expected to only find two elements in replication table",iter.hasNext());
}

</code></pre>

<br>
<pre class="type-9 type-13 type-11 type-8 type-5 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void correctClusterNameInWorkEntry() throws Exception {
  Connector conn=getConnector();
  String table1="table1";
  Assert.assertFalse(ReplicationTable.isOnline(conn));
  conn.tableOperations().create(table1);
  int attempts=5;
  while (attempts > 0) {
    try {
      conn.tableOperations().setProperty(table1,Property.TABLE_REPLICATION.getKey(),"true");
      conn.tableOperations().setProperty(table1,Property.TABLE_REPLICATION_TARGET.getKey() + "cluster1","4");
      attempts=0;
    }
 catch (    Exception e) {
      attempts--;
      if (attempts <= 0) {
        throw e;
      }
      sleepUninterruptibly(500,TimeUnit.MILLISECONDS);
    }
  }
  writeSomeData(conn,table1,2000,50);
  conn.tableOperations().flush(table1,null,null,true);
  String tableId=conn.tableOperations().tableIdMap().get(table1);
  Assert.assertNotNull("Table ID was null",tableId);
  boolean online=ReplicationTable.isOnline(conn);
  attempts=5;
  do {
    if (!online) {
      sleepUninterruptibly(500,TimeUnit.MILLISECONDS);
      online=ReplicationTable.isOnline(conn);
      attempts--;
    }
  }
 while (!online && attempts > 0);
  Assert.assertTrue("Replication table did not exist",online);
  for (int i=0; i < 5 && !conn.securityOperations().hasTablePermission("root",ReplicationTable.NAME,TablePermission.READ); i++) {
    Thread.sleep(1000);
  }
  Assert.assertTrue(conn.securityOperations().hasTablePermission("root",ReplicationTable.NAME,TablePermission.READ));
  boolean notFound=true;
  Scanner s;
  for (int i=0; i < 10 && notFound; i++) {
    s=ReplicationTable.getScanner(conn);
    WorkSection.limit(s);
    try {
      Entry<Key,Value> e=Iterables.getOnlyElement(s);
      Text expectedColqual=new ReplicationTarget("cluster1","4",tableId).toText();
      Assert.assertEquals(expectedColqual,e.getKey().getColumnQualifier());
      notFound=false;
    }
 catch (    NoSuchElementException e) {
    }
catch (    IllegalArgumentException e) {
      s=ReplicationTable.getScanner(conn);
      for (      Entry<Key,Value> content : s) {
        log.info(content.getKey().toStringNoTruncate() + " => " + content.getValue());
      }
      Assert.fail("Found more than one work section entry");
    }
    Thread.sleep(500);
  }
  if (notFound) {
    s=ReplicationTable.getScanner(conn);
    for (    Entry<Key,Value> content : s) {
      log.info(content.getKey().toStringNoTruncate() + " => " + content.getValue());
    }
    Assert.assertFalse("Did not find the work entry for the status entry",notFound);
  }
}

</code></pre>

<br>
<pre class="type-9 type-13 type-11 type-5 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void singleTableWithSingleTarget() throws Exception {
  getCluster().getClusterControl().stop(ServerType.GARBAGE_COLLECTOR);
  Connector conn=getConnector();
  String table1="table1";
  Assert.assertFalse(ReplicationTable.isOnline(conn));
  conn.tableOperations().create(table1);
  int attempts=10;
  while (attempts > 0) {
    try {
      conn.tableOperations().setProperty(table1,Property.TABLE_REPLICATION.getKey(),"true");
      conn.tableOperations().setProperty(table1,Property.TABLE_REPLICATION_TARGET.getKey() + "cluster1","4");
      conn.instanceOperations().setProperty(Property.REPLICATION_PEERS.getKey() + "cluster1",ReplicaSystemFactory.getPeerConfigurationValue(MockReplicaSystem.class,"100000"));
      break;
    }
 catch (    Exception e) {
      attempts--;
      if (attempts <= 0) {
        throw e;
      }
      sleepUninterruptibly(2,TimeUnit.SECONDS);
    }
  }
  writeSomeData(conn,table1,2000,50);
  boolean online=ReplicationTable.isOnline(conn);
  attempts=10;
  do {
    if (!online) {
      sleepUninterruptibly(2,TimeUnit.SECONDS);
      online=ReplicationTable.isOnline(conn);
      attempts--;
    }
  }
 while (!online && attempts > 0);
  Assert.assertTrue("Replication table was never created",online);
  for (int i=0; i < 10 && !conn.tableOperations().listIterators(ReplicationTable.NAME).keySet().contains(ReplicationTable.COMBINER_NAME); i++) {
    sleepUninterruptibly(2,TimeUnit.SECONDS);
  }
  Assert.assertTrue("Combiner was never set on replication table",conn.tableOperations().listIterators(ReplicationTable.NAME).keySet().contains(ReplicationTable.COMBINER_NAME));
  conn.tableOperations().flush(table1,null,null,true);
  Scanner s=ReplicationTable.getScanner(conn);
  StatusSection.limit(s);
  Entry<Key,Value> entry=null;
  Status expectedStatus=StatusUtil.openWithUnknownLength();
  attempts=10;
  while (null == entry && attempts > 0) {
    try {
      entry=Iterables.getOnlyElement(s);
      Status actual=Status.parseFrom(entry.getValue().get());
      if (actual.getInfiniteEnd() != expectedStatus.getInfiniteEnd()) {
        entry=null;
        Thread.sleep(1000);
      }
    }
 catch (    NoSuchElementException e) {
      entry=null;
      Thread.sleep(500);
    }
catch (    IllegalArgumentException e) {
      s=ReplicationTable.getScanner(conn);
      StatusSection.limit(s);
      for (      Entry<Key,Value> content : s) {
        log.info(content.getKey().toStringNoTruncate() + " => " + content.getValue());
      }
      throw e;
    }
 finally {
      attempts--;
    }
  }
  Assert.assertNotNull("Could not find expected entry in replication table",entry);
  Status actual=Status.parseFrom(entry.getValue().get());
  Assert.assertTrue("Expected to find a replication entry that is open with infinite length: " + ProtobufUtil.toString(actual),!actual.getClosed() && actual.getInfiniteEnd());
  boolean notFound=true;
  for (int i=0; i < 10 && notFound; i++) {
    s=ReplicationTable.getScanner(conn);
    WorkSection.limit(s);
    int elementsFound=Iterables.size(s);
    if (0 < elementsFound) {
      Assert.assertEquals(1,elementsFound);
      notFound=false;
    }
    Thread.sleep(500);
  }
  if (notFound) {
    s=ReplicationTable.getScanner(conn);
    for (    Entry<Key,Value> content : s) {
      log.info(content.getKey().toStringNoTruncate() + " => " + content.getValue());
    }
    Assert.assertFalse("Did not find the work entry for the status entry",notFound);
  }
  writeSomeData(conn,table1,3000,50);
  log.info("Issued compaction for table");
  conn.tableOperations().compact(table1,null,null,true,true);
  log.info("Compaction completed");
  Thread.sleep(5000);
  s=ReplicationTable.getScanner(conn);
  StatusSection.limit(s);
  int numRecords=0;
  for (  Entry<Key,Value> e : s) {
    numRecords++;
    log.info("Found status record {}\t{}",e.getKey().toStringNoTruncate(),ProtobufUtil.toString(Status.parseFrom(e.getValue().get())));
  }
  Assert.assertEquals(2,numRecords);
  notFound=true;
  for (int i=0; i < 10 && notFound; i++) {
    s=ReplicationTable.getScanner(conn);
    WorkSection.limit(s);
    int elementsFound=Iterables.size(s);
    if (2 == elementsFound) {
      notFound=false;
    }
    Thread.sleep(500);
  }
  if (notFound) {
    s=ReplicationTable.getScanner(conn);
    for (    Entry<Key,Value> content : s) {
      log.info(content.getKey().toStringNoTruncate() + " => " + content.getValue());
    }
    Assert.assertFalse("Did not find the work entries for the status entries",notFound);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.replication.SequentialWorkAssignerIT </h4><pre class="type-9 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void workAcrossPeersHappensConcurrently() throws Exception {
  ReplicationTarget target1=new ReplicationTarget("cluster1","table1","1");
  Text serializedTarget1=target1.toText();
  ReplicationTarget target2=new ReplicationTarget("cluster2","table1","1");
  Text serializedTarget2=target2.toText();
  BatchWriter bw=ReplicationTable.getBatchWriter(conn);
  String filename1="z_file1", filename2="a_file1";
  String file1="/accumulo/wal/tserver+port/" + filename1, file2="/accumulo/wal/tserver+port/" + filename2;
  Status stat1=Status.newBuilder().setBegin(0).setEnd(100).setClosed(true).setInfiniteEnd(false).setCreatedTime(250).build();
  Status stat2=Status.newBuilder().setBegin(0).setEnd(100).setClosed(true).setInfiniteEnd(false).setCreatedTime(500).build();
  Mutation m=new Mutation(file1);
  WorkSection.add(m,serializedTarget1,ProtobufUtil.toValue(stat1));
  bw.addMutation(m);
  m=new Mutation(file2);
  WorkSection.add(m,serializedTarget2,ProtobufUtil.toValue(stat2));
  bw.addMutation(m);
  m=OrderSection.createMutation(file1,stat1.getCreatedTime());
  OrderSection.add(m,new Text(target1.getSourceTableId()),ProtobufUtil.toValue(stat1));
  bw.addMutation(m);
  m=OrderSection.createMutation(file2,stat2.getCreatedTime());
  OrderSection.add(m,new Text(target2.getSourceTableId()),ProtobufUtil.toValue(stat2));
  bw.addMutation(m);
  bw.close();
  DistributedWorkQueue workQueue=createMock(DistributedWorkQueue.class);
  Map<String,Map<String,String>> queuedWork=new HashMap<>();
  assigner.setQueuedWork(queuedWork);
  assigner.setWorkQueue(workQueue);
  assigner.setMaxQueueSize(Integer.MAX_VALUE);
  workQueue.addWork(DistributedWorkQueueWorkAssignerHelper.getQueueKey(filename1,target1),file1);
  expectLastCall().once();
  workQueue.addWork(DistributedWorkQueueWorkAssignerHelper.getQueueKey(filename2,target2),file2);
  expectLastCall().once();
  replay(workQueue);
  assigner.createWork();
  verify(workQueue);
  Assert.assertEquals(2,queuedWork.size());
  Assert.assertTrue(queuedWork.containsKey("cluster1"));
  Map<String,String> cluster1Work=queuedWork.get("cluster1");
  Assert.assertEquals(1,cluster1Work.size());
  Assert.assertTrue(cluster1Work.containsKey(target1.getSourceTableId()));
  Assert.assertEquals(DistributedWorkQueueWorkAssignerHelper.getQueueKey(filename1,target1),cluster1Work.get(target1.getSourceTableId()));
  Map<String,String> cluster2Work=queuedWork.get("cluster2");
  Assert.assertEquals(1,cluster2Work.size());
  Assert.assertTrue(cluster2Work.containsKey(target2.getSourceTableId()));
  Assert.assertEquals(DistributedWorkQueueWorkAssignerHelper.getQueueKey(filename2,target2),cluster2Work.get(target2.getSourceTableId()));
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void createWorkForFilesInCorrectOrder() throws Exception {
  ReplicationTarget target=new ReplicationTarget("cluster1","table1","1");
  Text serializedTarget=target.toText();
  BatchWriter bw=ReplicationTable.getBatchWriter(conn);
  String filename1="z_file1", filename2="a_file1";
  String file1="/accumulo/wal/tserver+port/" + filename1, file2="/accumulo/wal/tserver+port/" + filename2;
  Status stat1=Status.newBuilder().setBegin(0).setEnd(100).setClosed(true).setInfiniteEnd(false).setCreatedTime(250).build();
  Status stat2=Status.newBuilder().setBegin(0).setEnd(100).setClosed(true).setInfiniteEnd(false).setCreatedTime(500).build();
  Mutation m=new Mutation(file1);
  WorkSection.add(m,serializedTarget,ProtobufUtil.toValue(stat1));
  bw.addMutation(m);
  m=new Mutation(file2);
  WorkSection.add(m,serializedTarget,ProtobufUtil.toValue(stat2));
  bw.addMutation(m);
  m=OrderSection.createMutation(file1,stat1.getCreatedTime());
  OrderSection.add(m,new Text(target.getSourceTableId()),ProtobufUtil.toValue(stat1));
  bw.addMutation(m);
  m=OrderSection.createMutation(file2,stat2.getCreatedTime());
  OrderSection.add(m,new Text(target.getSourceTableId()),ProtobufUtil.toValue(stat2));
  bw.addMutation(m);
  bw.close();
  DistributedWorkQueue workQueue=createMock(DistributedWorkQueue.class);
  Map<String,Map<String,String>> queuedWork=new HashMap<>();
  assigner.setQueuedWork(queuedWork);
  assigner.setWorkQueue(workQueue);
  assigner.setMaxQueueSize(Integer.MAX_VALUE);
  workQueue.addWork(DistributedWorkQueueWorkAssignerHelper.getQueueKey(filename1,target),file1);
  expectLastCall().once();
  replay(workQueue);
  assigner.createWork();
  verify(workQueue);
  Assert.assertEquals(1,queuedWork.size());
  Assert.assertTrue(queuedWork.containsKey("cluster1"));
  Map<String,String> cluster1Work=queuedWork.get("cluster1");
  Assert.assertEquals(1,cluster1Work.size());
  Assert.assertTrue(cluster1Work.containsKey(target.getSourceTableId()));
  Assert.assertEquals(DistributedWorkQueueWorkAssignerHelper.getQueueKey(filename1,target),cluster1Work.get(target.getSourceTableId()));
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void workAcrossTablesHappensConcurrently() throws Exception {
  ReplicationTarget target1=new ReplicationTarget("cluster1","table1","1");
  Text serializedTarget1=target1.toText();
  ReplicationTarget target2=new ReplicationTarget("cluster1","table2","2");
  Text serializedTarget2=target2.toText();
  BatchWriter bw=ReplicationTable.getBatchWriter(conn);
  String filename1="z_file1", filename2="a_file1";
  String file1="/accumulo/wal/tserver+port/" + filename1, file2="/accumulo/wal/tserver+port/" + filename2;
  Status stat1=Status.newBuilder().setBegin(0).setEnd(100).setClosed(true).setInfiniteEnd(false).setCreatedTime(250).build();
  Status stat2=Status.newBuilder().setBegin(0).setEnd(100).setClosed(true).setInfiniteEnd(false).setCreatedTime(500).build();
  Mutation m=new Mutation(file1);
  WorkSection.add(m,serializedTarget1,ProtobufUtil.toValue(stat1));
  bw.addMutation(m);
  m=new Mutation(file2);
  WorkSection.add(m,serializedTarget2,ProtobufUtil.toValue(stat2));
  bw.addMutation(m);
  m=OrderSection.createMutation(file1,stat1.getCreatedTime());
  OrderSection.add(m,new Text(target1.getSourceTableId()),ProtobufUtil.toValue(stat1));
  bw.addMutation(m);
  m=OrderSection.createMutation(file2,stat2.getCreatedTime());
  OrderSection.add(m,new Text(target2.getSourceTableId()),ProtobufUtil.toValue(stat2));
  bw.addMutation(m);
  bw.close();
  DistributedWorkQueue workQueue=createMock(DistributedWorkQueue.class);
  Map<String,Map<String,String>> queuedWork=new HashMap<>();
  assigner.setQueuedWork(queuedWork);
  assigner.setWorkQueue(workQueue);
  assigner.setMaxQueueSize(Integer.MAX_VALUE);
  workQueue.addWork(DistributedWorkQueueWorkAssignerHelper.getQueueKey(filename1,target1),file1);
  expectLastCall().once();
  workQueue.addWork(DistributedWorkQueueWorkAssignerHelper.getQueueKey(filename2,target2),file2);
  expectLastCall().once();
  replay(workQueue);
  assigner.createWork();
  verify(workQueue);
  Assert.assertEquals(1,queuedWork.size());
  Assert.assertTrue(queuedWork.containsKey("cluster1"));
  Map<String,String> cluster1Work=queuedWork.get("cluster1");
  Assert.assertEquals(2,cluster1Work.size());
  Assert.assertTrue(cluster1Work.containsKey(target1.getSourceTableId()));
  Assert.assertEquals(DistributedWorkQueueWorkAssignerHelper.getQueueKey(filename1,target1),cluster1Work.get(target1.getSourceTableId()));
  Assert.assertTrue(cluster1Work.containsKey(target2.getSourceTableId()));
  Assert.assertEquals(DistributedWorkQueueWorkAssignerHelper.getQueueKey(filename2,target2),cluster1Work.get(target2.getSourceTableId()));
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void reprocessingOfCompletedWorkRemovesWork() throws Exception {
  ReplicationTarget target=new ReplicationTarget("cluster1","table1","1");
  Text serializedTarget=target.toText();
  BatchWriter bw=ReplicationTable.getBatchWriter(conn);
  String filename1="z_file1", filename2="a_file1";
  String file1="/accumulo/wal/tserver+port/" + filename1, file2="/accumulo/wal/tserver+port/" + filename2;
  Status stat1=Status.newBuilder().setBegin(100).setEnd(100).setClosed(true).setInfiniteEnd(false).setCreatedTime(250).build();
  Status stat2=Status.newBuilder().setBegin(0).setEnd(100).setClosed(true).setInfiniteEnd(false).setCreatedTime(500).build();
  Mutation m=new Mutation(file1);
  WorkSection.add(m,serializedTarget,ProtobufUtil.toValue(stat1));
  bw.addMutation(m);
  m=new Mutation(file2);
  WorkSection.add(m,serializedTarget,ProtobufUtil.toValue(stat2));
  bw.addMutation(m);
  m=OrderSection.createMutation(file1,stat1.getCreatedTime());
  OrderSection.add(m,new Text(target.getSourceTableId()),ProtobufUtil.toValue(stat1));
  bw.addMutation(m);
  m=OrderSection.createMutation(file2,stat2.getCreatedTime());
  OrderSection.add(m,new Text(target.getSourceTableId()),ProtobufUtil.toValue(stat2));
  bw.addMutation(m);
  bw.close();
  DistributedWorkQueue workQueue=createMock(DistributedWorkQueue.class);
  Map<String,Map<String,String>> queuedWork=new HashMap<>();
  Map<String,String> queuedWorkForCluster=new HashMap<>();
  queuedWorkForCluster.put(target.getSourceTableId(),DistributedWorkQueueWorkAssignerHelper.getQueueKey(filename1,target));
  queuedWork.put("cluster1",queuedWorkForCluster);
  assigner.setQueuedWork(queuedWork);
  assigner.setWorkQueue(workQueue);
  assigner.setMaxQueueSize(Integer.MAX_VALUE);
  workQueue.addWork(DistributedWorkQueueWorkAssignerHelper.getQueueKey(filename2,target),file2);
  expectLastCall().once();
  replay(workQueue);
  assigner.createWork();
  verify(workQueue);
  Assert.assertEquals(1,queuedWork.size());
  Assert.assertTrue(queuedWork.containsKey("cluster1"));
  Map<String,String> cluster1Work=queuedWork.get("cluster1");
  Assert.assertEquals(1,cluster1Work.size());
  Assert.assertTrue(cluster1Work.containsKey(target.getSourceTableId()));
  Assert.assertEquals(DistributedWorkQueueWorkAssignerHelper.getQueueKey(filename2,target),cluster1Work.get(target.getSourceTableId()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.replication.StatusCombinerMacIT </h4><pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test() throws Exception {
  Connector conn=getConnector();
  ClusterUser user=getAdminUser();
  ReplicationTable.setOnline(conn);
  conn.securityOperations().grantTablePermission(user.getPrincipal(),ReplicationTable.NAME,TablePermission.WRITE);
  BatchWriter bw=ReplicationTable.getBatchWriter(conn);
  long createTime=System.currentTimeMillis();
  try {
    Mutation m=new Mutation("file:/accumulo/wal/HW10447.local+56808/93cdc17e-7521-44fa-87b5-37f45bcb92d3");
    StatusSection.add(m,new Text("1"),StatusUtil.fileCreatedValue(createTime));
    bw.addMutation(m);
  }
  finally {
    bw.close();
  }
  Scanner s=ReplicationTable.getScanner(conn);
  Entry<Key,Value> entry=Iterables.getOnlyElement(s);
  Assert.assertEquals(StatusUtil.fileCreatedValue(createTime),entry.getValue());
  bw=ReplicationTable.getBatchWriter(conn);
  try {
    Mutation m=new Mutation("file:/accumulo/wal/HW10447.local+56808/93cdc17e-7521-44fa-87b5-37f45bcb92d3");
    StatusSection.add(m,new Text("1"),ProtobufUtil.toValue(StatusUtil.replicated(Long.MAX_VALUE)));
    bw.addMutation(m);
  }
  finally {
    bw.close();
  }
  s=ReplicationTable.getScanner(conn);
  entry=Iterables.getOnlyElement(s);
  Status stat=Status.parseFrom(entry.getValue().get());
  Assert.assertEquals(Long.MAX_VALUE,stat.getBegin());
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCombinerSetOnMetadata() throws Exception {
  TableOperations tops=getConnector().tableOperations();
  Map<String,EnumSet<IteratorScope>> iterators=tops.listIterators(MetadataTable.NAME);
  Assert.assertTrue(iterators.containsKey(ReplicationTableUtil.COMBINER_NAME));
  EnumSet<IteratorScope> scopes=iterators.get(ReplicationTableUtil.COMBINER_NAME);
  Assert.assertEquals(3,scopes.size());
  Assert.assertTrue(scopes.contains(IteratorScope.scan));
  Assert.assertTrue(scopes.contains(IteratorScope.minc));
  Assert.assertTrue(scopes.contains(IteratorScope.majc));
  Iterable<Entry<String,String>> propIter=tops.getProperties(MetadataTable.NAME);
  HashMap<String,String> properties=new HashMap<String,String>();
  for (  Entry<String,String> entry : propIter) {
    properties.put(entry.getKey(),entry.getValue());
  }
  for (  IteratorScope scope : scopes) {
    String key=Property.TABLE_ITERATOR_PREFIX.getKey() + scope.name() + "."+ ReplicationTableUtil.COMBINER_NAME+ ".opt.columns";
    Assert.assertTrue("Properties did not contain key : " + key,properties.containsKey(key));
    Assert.assertEquals(MetadataSchema.ReplicationSection.COLF.toString(),properties.get(key));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.replication.StatusMakerIT </h4><pre class="type-9 type-13 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void closedMessagesCreateOrderRecords() throws Exception {
  String sourceTable=testName.getMethodName();
  conn.tableOperations().create(sourceTable);
  ReplicationTableUtil.configureMetadataTable(conn,sourceTable);
  BatchWriter bw=conn.createBatchWriter(sourceTable,new BatchWriterConfig());
  String walPrefix="hdfs://localhost:8020/accumulo/wals/tserver+port/";
  List<String> files=Arrays.asList(walPrefix + UUID.randomUUID(),walPrefix + UUID.randomUUID(),walPrefix + UUID.randomUUID(),walPrefix + UUID.randomUUID());
  Map<String,Integer> fileToTableId=new HashMap<>();
  Status.Builder statBuilder=Status.newBuilder().setBegin(0).setEnd(0).setInfiniteEnd(true).setClosed(true);
  int index=1;
  long time=System.currentTimeMillis();
  for (  String file : files) {
    statBuilder.setCreatedTime(time++);
    Mutation m=new Mutation(ReplicationSection.getRowPrefix() + file);
    m.put(ReplicationSection.COLF,new Text(Integer.toString(index)),ProtobufUtil.toValue(statBuilder.build()));
    bw.addMutation(m);
    fileToTableId.put(file,index);
    index++;
  }
  bw.close();
  StatusMaker statusMaker=new StatusMaker(conn);
  statusMaker.setSourceTableName(sourceTable);
  statusMaker.run();
  Scanner s=conn.createScanner(sourceTable,Authorizations.EMPTY);
  s.setRange(ReplicationSection.getRange());
  s.fetchColumnFamily(ReplicationSection.COLF);
  Assert.assertEquals(0,Iterables.size(s));
  s=ReplicationTable.getScanner(conn);
  OrderSection.limit(s);
  Iterator<Entry<Key,Value>> iter=s.iterator();
  Assert.assertTrue("Found no order records in replication table",iter.hasNext());
  Iterator<String> expectedFiles=files.iterator();
  Text buff=new Text();
  while (expectedFiles.hasNext() && iter.hasNext()) {
    String file=expectedFiles.next();
    Entry<Key,Value> entry=iter.next();
    Assert.assertEquals(file,OrderSection.getFile(entry.getKey(),buff));
    OrderSection.getTableId(entry.getKey(),buff);
    Assert.assertEquals(fileToTableId.get(file).intValue(),Integer.parseInt(buff.toString()));
  }
  Assert.assertFalse("Found more files unexpectedly",expectedFiles.hasNext());
  Assert.assertFalse("Found more entries in replication table unexpectedly",iter.hasNext());
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void statusRecordsCreated() throws Exception {
  String sourceTable=testName.getMethodName();
  conn.tableOperations().create(sourceTable);
  ReplicationTableUtil.configureMetadataTable(conn,sourceTable);
  BatchWriter bw=conn.createBatchWriter(sourceTable,new BatchWriterConfig());
  String walPrefix="hdfs://localhost:8020/accumulo/wals/tserver+port/";
  Set<String> files=Sets.newHashSet(walPrefix + UUID.randomUUID(),walPrefix + UUID.randomUUID(),walPrefix + UUID.randomUUID(),walPrefix + UUID.randomUUID());
  Map<String,Integer> fileToTableId=new HashMap<>();
  int index=1;
  long timeCreated=0;
  Map<String,Long> fileToTimeCreated=new HashMap<>();
  for (  String file : files) {
    Mutation m=new Mutation(ReplicationSection.getRowPrefix() + file);
    m.put(ReplicationSection.COLF,new Text(Integer.toString(index)),StatusUtil.fileCreatedValue(timeCreated));
    fileToTimeCreated.put(file,timeCreated);
    bw.addMutation(m);
    fileToTableId.put(file,index);
    index++;
    timeCreated++;
  }
  bw.close();
  StatusMaker statusMaker=new StatusMaker(conn);
  statusMaker.setSourceTableName(sourceTable);
  statusMaker.run();
  Scanner s=ReplicationTable.getScanner(conn);
  StatusSection.limit(s);
  Text file=new Text(), tableId=new Text();
  for (  Entry<Key,Value> entry : s) {
    StatusSection.getFile(entry.getKey(),file);
    StatusSection.getTableId(entry.getKey(),tableId);
    Assert.assertTrue("Found unexpected file: " + file,files.contains(file.toString()));
    Assert.assertEquals(fileToTableId.get(file.toString()),new Integer(tableId.toString()));
    timeCreated=fileToTimeCreated.get(file.toString());
    Assert.assertNotNull(timeCreated);
    Assert.assertEquals(StatusUtil.fileCreated(timeCreated),Status.parseFrom(entry.getValue().get()));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.replication.UnorderedWorkAssignerReplicationIT </h4><pre class="type-9 type-13 type-5 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void dataReplicatedToCorrectTableWithoutDrain() throws Exception {
  MiniAccumuloConfigImpl peerCfg=new MiniAccumuloConfigImpl(createTestDir(this.getClass().getName() + "_" + this.testName.getMethodName()+ "_peer"),ROOT_PASSWORD);
  peerCfg.setNumTservers(1);
  peerCfg.setInstanceName("peer");
  updatePeerConfigFromPrimary(getCluster().getConfig(),peerCfg);
  peerCfg.setProperty(Property.REPLICATION_NAME,"peer");
  MiniAccumuloClusterImpl peer1Cluster=new MiniAccumuloClusterImpl(peerCfg);
  peer1Cluster.start();
  try {
    Connector connMaster=getConnector();
    Connector connPeer=peer1Cluster.getConnector("root",new PasswordToken(ROOT_PASSWORD));
    String peerClusterName="peer";
    String peerUserName="repl";
    String peerPassword="passwd";
    connPeer.securityOperations().createLocalUser(peerUserName,new PasswordToken(peerPassword));
    connMaster.instanceOperations().setProperty(Property.REPLICATION_PEER_USER.getKey() + peerClusterName,peerUserName);
    connMaster.instanceOperations().setProperty(Property.REPLICATION_PEER_PASSWORD.getKey() + peerClusterName,peerPassword);
    connMaster.instanceOperations().setProperty(Property.REPLICATION_PEERS.getKey() + peerClusterName,ReplicaSystemFactory.getPeerConfigurationValue(AccumuloReplicaSystem.class,AccumuloReplicaSystem.buildConfiguration(peer1Cluster.getInstanceName(),peer1Cluster.getZooKeepers())));
    String masterTable1="master1", peerTable1="peer1", masterTable2="master2", peerTable2="peer2";
    connMaster.tableOperations().create(masterTable1);
    String masterTableId1=connMaster.tableOperations().tableIdMap().get(masterTable1);
    Assert.assertNotNull(masterTableId1);
    connMaster.tableOperations().create(masterTable2);
    String masterTableId2=connMaster.tableOperations().tableIdMap().get(masterTable2);
    Assert.assertNotNull(masterTableId2);
    connPeer.tableOperations().create(peerTable1);
    String peerTableId1=connPeer.tableOperations().tableIdMap().get(peerTable1);
    Assert.assertNotNull(peerTableId1);
    connPeer.tableOperations().create(peerTable2);
    String peerTableId2=connPeer.tableOperations().tableIdMap().get(peerTable2);
    Assert.assertNotNull(peerTableId2);
    connPeer.securityOperations().grantTablePermission(peerUserName,peerTable1,TablePermission.WRITE);
    connPeer.securityOperations().grantTablePermission(peerUserName,peerTable2,TablePermission.WRITE);
    connMaster.tableOperations().setProperty(masterTable1,Property.TABLE_REPLICATION.getKey(),"true");
    connMaster.tableOperations().setProperty(masterTable1,Property.TABLE_REPLICATION_TARGET.getKey() + peerClusterName,peerTableId1);
    connMaster.tableOperations().setProperty(masterTable2,Property.TABLE_REPLICATION.getKey(),"true");
    connMaster.tableOperations().setProperty(masterTable2,Property.TABLE_REPLICATION_TARGET.getKey() + peerClusterName,peerTableId2);
    sleepUninterruptibly(3,TimeUnit.SECONDS);
    BatchWriter bw=connMaster.createBatchWriter(masterTable1,new BatchWriterConfig());
    for (int rows=0; rows < 2500; rows++) {
      Mutation m=new Mutation(masterTable1 + rows);
      for (int cols=0; cols < 100; cols++) {
        String value=Integer.toString(cols);
        m.put(value,"",value);
      }
      bw.addMutation(m);
    }
    bw.close();
    bw=connMaster.createBatchWriter(masterTable2,new BatchWriterConfig());
    for (int rows=0; rows < 2500; rows++) {
      Mutation m=new Mutation(masterTable2 + rows);
      for (int cols=0; cols < 100; cols++) {
        String value=Integer.toString(cols);
        m.put(value,"",value);
      }
      bw.addMutation(m);
    }
    bw.close();
    log.info("Wrote all data to master cluster");
    while (!ReplicationTable.isOnline(connMaster)) {
      Thread.sleep(500);
    }
    for (    ProcessReference proc : cluster.getProcesses().get(ServerType.TABLET_SERVER)) {
      cluster.killProcess(ServerType.TABLET_SERVER,proc);
    }
    cluster.exec(TabletServer.class);
    boolean fullyReplicated=false;
    for (int i=0; i < 10 && !fullyReplicated; i++) {
      sleepUninterruptibly(timeoutFactor * 2,TimeUnit.SECONDS);
      Scanner s=ReplicationTable.getScanner(connMaster);
      WorkSection.limit(s);
      for (      Entry<Key,Value> entry : s) {
        Status status=Status.parseFrom(entry.getValue().get());
        if (StatusUtil.isFullyReplicated(status)) {
          fullyReplicated|=true;
        }
      }
    }
    Assert.assertNotEquals(0,fullyReplicated);
    long countTable=0l;
    for (int i=0; i < 10; i++) {
      countTable=0l;
      for (      Entry<Key,Value> entry : connPeer.createScanner(peerTable1,Authorizations.EMPTY)) {
        countTable++;
        Assert.assertTrue("Found unexpected key-value" + entry.getKey().toStringNoTruncate() + " "+ entry.getValue(),entry.getKey().getRow().toString().startsWith(masterTable1));
      }
      log.info("Found {} records in {}",countTable,peerTable1);
      if (0 < countTable) {
        break;
      }
      Thread.sleep(2000);
    }
    Assert.assertTrue("Did not find any records in " + peerTable1 + " on peer",countTable > 0);
    for (int i=0; i < 10; i++) {
      countTable=0l;
      for (      Entry<Key,Value> entry : connPeer.createScanner(peerTable2,Authorizations.EMPTY)) {
        countTable++;
        Assert.assertTrue("Found unexpected key-value" + entry.getKey().toStringNoTruncate() + " "+ entry.getValue(),entry.getKey().getRow().toString().startsWith(masterTable2));
      }
      log.info("Found {} records in {}",countTable,peerTable2);
      if (0 < countTable) {
        break;
      }
      Thread.sleep(2000);
    }
    Assert.assertTrue("Did not find any records in " + peerTable2 + " on peer",countTable > 0);
  }
  finally {
    peer1Cluster.stop();
  }
}

</code></pre>

<br>
<pre class="type-9 type-13 type-5 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void dataWasReplicatedToThePeerWithoutDrain() throws Exception {
  MiniAccumuloConfigImpl peerCfg=new MiniAccumuloConfigImpl(createTestDir(this.getClass().getName() + "_" + this.testName.getMethodName()+ "_peer"),ROOT_PASSWORD);
  peerCfg.setNumTservers(1);
  peerCfg.setInstanceName("peer");
  updatePeerConfigFromPrimary(getCluster().getConfig(),peerCfg);
  peerCfg.setProperty(Property.REPLICATION_NAME,"peer");
  MiniAccumuloClusterImpl peerCluster=new MiniAccumuloClusterImpl(peerCfg);
  peerCluster.start();
  Connector connMaster=getConnector();
  Connector connPeer=peerCluster.getConnector("root",new PasswordToken(ROOT_PASSWORD));
  String peerUserName="repl";
  String peerPassword="passwd";
  connPeer.securityOperations().createLocalUser(peerUserName,new PasswordToken(peerPassword));
  String peerClusterName="peer";
  connMaster.instanceOperations().setProperty(Property.REPLICATION_PEERS.getKey() + peerClusterName,ReplicaSystemFactory.getPeerConfigurationValue(AccumuloReplicaSystem.class,AccumuloReplicaSystem.buildConfiguration(peerCluster.getInstanceName(),peerCluster.getZooKeepers())));
  connMaster.instanceOperations().setProperty(Property.REPLICATION_PEER_USER.getKey() + peerClusterName,peerUserName);
  connMaster.instanceOperations().setProperty(Property.REPLICATION_PEER_PASSWORD.getKey() + peerClusterName,peerPassword);
  String masterTable="master", peerTable="peer";
  connMaster.tableOperations().create(masterTable);
  String masterTableId=connMaster.tableOperations().tableIdMap().get(masterTable);
  Assert.assertNotNull(masterTableId);
  connPeer.tableOperations().create(peerTable);
  String peerTableId=connPeer.tableOperations().tableIdMap().get(peerTable);
  Assert.assertNotNull(peerTableId);
  connPeer.securityOperations().grantTablePermission(peerUserName,peerTable,TablePermission.WRITE);
  connMaster.tableOperations().setProperty(masterTable,Property.TABLE_REPLICATION.getKey(),"true");
  connMaster.tableOperations().setProperty(masterTable,Property.TABLE_REPLICATION_TARGET.getKey() + peerClusterName,peerTableId);
  BatchWriter bw=connMaster.createBatchWriter(masterTable,new BatchWriterConfig());
  for (int rows=0; rows < 5000; rows++) {
    Mutation m=new Mutation(Integer.toString(rows));
    for (int cols=0; cols < 100; cols++) {
      String value=Integer.toString(cols);
      m.put(value,"",value);
    }
    bw.addMutation(m);
  }
  bw.close();
  log.info("Wrote all data to master cluster");
  Set<String> files=connMaster.replicationOperations().referencedFiles(masterTable);
  for (  String s : files) {
    log.info("Found referenced file for " + masterTable + ": "+ s);
  }
  for (  ProcessReference proc : cluster.getProcesses().get(ServerType.TABLET_SERVER)) {
    cluster.killProcess(ServerType.TABLET_SERVER,proc);
  }
  cluster.exec(TabletServer.class);
  Iterators.size(connMaster.createScanner(masterTable,Authorizations.EMPTY).iterator());
  for (  Entry<Key,Value> kv : connMaster.createScanner(ReplicationTable.NAME,Authorizations.EMPTY)) {
    log.debug(kv.getKey().toStringNoTruncate() + " " + ProtobufUtil.toString(Status.parseFrom(kv.getValue().get())));
  }
  connMaster.replicationOperations().drain(masterTable,files);
  Scanner master=connMaster.createScanner(masterTable,Authorizations.EMPTY), peer=connPeer.createScanner(peerTable,Authorizations.EMPTY);
  Iterator<Entry<Key,Value>> masterIter=master.iterator(), peerIter=peer.iterator();
  Assert.assertTrue("No data in master table",masterIter.hasNext());
  Assert.assertTrue("No data in peer table",peerIter.hasNext());
  while (masterIter.hasNext() && peerIter.hasNext()) {
    Entry<Key,Value> masterEntry=masterIter.next(), peerEntry=peerIter.next();
    Assert.assertEquals(peerEntry.getKey() + " was not equal to " + peerEntry.getKey(),0,masterEntry.getKey().compareTo(peerEntry.getKey(),PartialKey.ROW_COLFAM_COLQUAL_COLVIS));
    Assert.assertEquals(masterEntry.getValue(),peerEntry.getValue());
  }
  Assert.assertFalse("Had more data to read from the master",masterIter.hasNext());
  Assert.assertFalse("Had more data to read from the peer",peerIter.hasNext());
  peerCluster.stop();
}

</code></pre>

<br>
<pre class="type-9 type-13 type-8 type-5 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void dataWasReplicatedToThePeer() throws Exception {
  MiniAccumuloConfigImpl peerCfg=new MiniAccumuloConfigImpl(createTestDir(this.getClass().getName() + "_" + this.testName.getMethodName()+ "_peer"),ROOT_PASSWORD);
  peerCfg.setNumTservers(1);
  peerCfg.setInstanceName("peer");
  updatePeerConfigFromPrimary(getCluster().getConfig(),peerCfg);
  peerCfg.setProperty(Property.REPLICATION_NAME,"peer");
  MiniAccumuloClusterImpl peerCluster=new MiniAccumuloClusterImpl(peerCfg);
  peerCluster.start();
  try {
    final Connector connMaster=getConnector();
    final Connector connPeer=peerCluster.getConnector("root",new PasswordToken(ROOT_PASSWORD));
    ReplicationTable.setOnline(connMaster);
    String peerUserName="peer", peerPassword="foo";
    String peerClusterName="peer";
    connPeer.securityOperations().createLocalUser(peerUserName,new PasswordToken(peerPassword));
    connMaster.instanceOperations().setProperty(Property.REPLICATION_PEER_USER.getKey() + peerClusterName,peerUserName);
    connMaster.instanceOperations().setProperty(Property.REPLICATION_PEER_PASSWORD.getKey() + peerClusterName,peerPassword);
    connMaster.instanceOperations().setProperty(Property.REPLICATION_PEERS.getKey() + peerClusterName,ReplicaSystemFactory.getPeerConfigurationValue(AccumuloReplicaSystem.class,AccumuloReplicaSystem.buildConfiguration(peerCluster.getInstanceName(),peerCluster.getZooKeepers())));
    final String masterTable="master", peerTable="peer";
    connMaster.tableOperations().create(masterTable);
    String masterTableId=connMaster.tableOperations().tableIdMap().get(masterTable);
    Assert.assertNotNull(masterTableId);
    connPeer.tableOperations().create(peerTable);
    String peerTableId=connPeer.tableOperations().tableIdMap().get(peerTable);
    Assert.assertNotNull(peerTableId);
    connPeer.securityOperations().grantTablePermission(peerUserName,peerTable,TablePermission.WRITE);
    connMaster.tableOperations().setProperty(masterTable,Property.TABLE_REPLICATION.getKey(),"true");
    connMaster.tableOperations().setProperty(masterTable,Property.TABLE_REPLICATION_TARGET.getKey() + peerClusterName,peerTableId);
    sleepUninterruptibly(3,TimeUnit.SECONDS);
    BatchWriter bw=connMaster.createBatchWriter(masterTable,new BatchWriterConfig());
    for (int rows=0; rows < 5000; rows++) {
      Mutation m=new Mutation(Integer.toString(rows));
      for (int cols=0; cols < 100; cols++) {
        String value=Integer.toString(cols);
        m.put(value,"",value);
      }
      bw.addMutation(m);
    }
    bw.close();
    log.info("Wrote all data to master cluster");
    final Set<String> filesNeedingReplication=connMaster.replicationOperations().referencedFiles(masterTable);
    for (    ProcessReference proc : cluster.getProcesses().get(ServerType.TABLET_SERVER)) {
      cluster.killProcess(ServerType.TABLET_SERVER,proc);
    }
    cluster.exec(TabletServer.class);
    log.info("TabletServer restarted");
    Iterators.size(ReplicationTable.getScanner(connMaster).iterator());
    log.info("TabletServer is online");
    log.info("");
    log.info("Fetching metadata records:");
    for (    Entry<Key,Value> kv : connMaster.createScanner(MetadataTable.NAME,Authorizations.EMPTY)) {
      if (ReplicationSection.COLF.equals(kv.getKey().getColumnFamily())) {
        log.info(kv.getKey().toStringNoTruncate() + " " + ProtobufUtil.toString(Status.parseFrom(kv.getValue().get())));
      }
 else {
        log.info(kv.getKey().toStringNoTruncate() + " " + kv.getValue());
      }
    }
    log.info("");
    log.info("Fetching replication records:");
    for (    Entry<Key,Value> kv : ReplicationTable.getScanner(connMaster)) {
      log.info(kv.getKey().toStringNoTruncate() + " " + ProtobufUtil.toString(Status.parseFrom(kv.getValue().get())));
    }
    Future<Boolean> future=executor.submit(new Callable<Boolean>(){
      @Override public Boolean call() throws Exception {
        connMaster.replicationOperations().drain(masterTable,filesNeedingReplication);
        log.info("Drain completed");
        return true;
      }
    }
);
    long timeoutSeconds=timeoutFactor * 30;
    try {
      future.get(timeoutSeconds,TimeUnit.SECONDS);
    }
 catch (    TimeoutException e) {
      future.cancel(true);
      Assert.fail("Drain did not finish within " + timeoutSeconds + " seconds");
    }
    log.info("drain completed");
    log.info("");
    log.info("Fetching metadata records:");
    for (    Entry<Key,Value> kv : connMaster.createScanner(MetadataTable.NAME,Authorizations.EMPTY)) {
      if (ReplicationSection.COLF.equals(kv.getKey().getColumnFamily())) {
        log.info(kv.getKey().toStringNoTruncate() + " " + ProtobufUtil.toString(Status.parseFrom(kv.getValue().get())));
      }
 else {
        log.info(kv.getKey().toStringNoTruncate() + " " + kv.getValue());
      }
    }
    log.info("");
    log.info("Fetching replication records:");
    for (    Entry<Key,Value> kv : ReplicationTable.getScanner(connMaster)) {
      log.info(kv.getKey().toStringNoTruncate() + " " + ProtobufUtil.toString(Status.parseFrom(kv.getValue().get())));
    }
    Scanner master=connMaster.createScanner(masterTable,Authorizations.EMPTY), peer=connPeer.createScanner(peerTable,Authorizations.EMPTY);
    Iterator<Entry<Key,Value>> masterIter=master.iterator(), peerIter=peer.iterator();
    Entry<Key,Value> masterEntry=null, peerEntry=null;
    while (masterIter.hasNext() && peerIter.hasNext()) {
      masterEntry=masterIter.next();
      peerEntry=peerIter.next();
      Assert.assertEquals(masterEntry.getKey() + " was not equal to " + peerEntry.getKey(),0,masterEntry.getKey().compareTo(peerEntry.getKey(),PartialKey.ROW_COLFAM_COLQUAL_COLVIS));
      Assert.assertEquals(masterEntry.getValue(),peerEntry.getValue());
    }
    log.info("Last master entry: " + masterEntry);
    log.info("Last peer entry: " + peerEntry);
    Assert.assertFalse("Had more data to read from the master",masterIter.hasNext());
    Assert.assertFalse("Had more data to read from the peer",peerIter.hasNext());
  }
  finally {
    peerCluster.stop();
  }
}

</code></pre>

<br>
<pre class="type-9 type-13 type-5 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void dataReplicatedToCorrectTable() throws Exception {
  MiniAccumuloConfigImpl peerCfg=new MiniAccumuloConfigImpl(createTestDir(this.getClass().getName() + "_" + this.testName.getMethodName()+ "_peer"),ROOT_PASSWORD);
  peerCfg.setNumTservers(1);
  peerCfg.setInstanceName("peer");
  updatePeerConfigFromPrimary(getCluster().getConfig(),peerCfg);
  peerCfg.setProperty(Property.REPLICATION_NAME,"peer");
  MiniAccumuloClusterImpl peer1Cluster=new MiniAccumuloClusterImpl(peerCfg);
  peer1Cluster.start();
  try {
    Connector connMaster=getConnector();
    Connector connPeer=peer1Cluster.getConnector("root",new PasswordToken(ROOT_PASSWORD));
    String peerClusterName="peer";
    String peerUserName="peer", peerPassword="foo";
    connPeer.securityOperations().createLocalUser(peerUserName,new PasswordToken(peerPassword));
    connMaster.instanceOperations().setProperty(Property.REPLICATION_PEER_USER.getKey() + peerClusterName,peerUserName);
    connMaster.instanceOperations().setProperty(Property.REPLICATION_PEER_PASSWORD.getKey() + peerClusterName,peerPassword);
    connMaster.instanceOperations().setProperty(Property.REPLICATION_PEERS.getKey() + peerClusterName,ReplicaSystemFactory.getPeerConfigurationValue(AccumuloReplicaSystem.class,AccumuloReplicaSystem.buildConfiguration(peer1Cluster.getInstanceName(),peer1Cluster.getZooKeepers())));
    String masterTable1="master1", peerTable1="peer1", masterTable2="master2", peerTable2="peer2";
    connMaster.tableOperations().create(masterTable1);
    String masterTableId1=connMaster.tableOperations().tableIdMap().get(masterTable1);
    Assert.assertNotNull(masterTableId1);
    connMaster.tableOperations().create(masterTable2);
    String masterTableId2=connMaster.tableOperations().tableIdMap().get(masterTable2);
    Assert.assertNotNull(masterTableId2);
    connPeer.tableOperations().create(peerTable1);
    String peerTableId1=connPeer.tableOperations().tableIdMap().get(peerTable1);
    Assert.assertNotNull(peerTableId1);
    connPeer.tableOperations().create(peerTable2);
    String peerTableId2=connPeer.tableOperations().tableIdMap().get(peerTable2);
    Assert.assertNotNull(peerTableId2);
    connPeer.securityOperations().grantTablePermission(peerUserName,peerTable1,TablePermission.WRITE);
    connPeer.securityOperations().grantTablePermission(peerUserName,peerTable2,TablePermission.WRITE);
    connMaster.tableOperations().setProperty(masterTable1,Property.TABLE_REPLICATION.getKey(),"true");
    connMaster.tableOperations().setProperty(masterTable1,Property.TABLE_REPLICATION_TARGET.getKey() + peerClusterName,peerTableId1);
    connMaster.tableOperations().setProperty(masterTable2,Property.TABLE_REPLICATION.getKey(),"true");
    connMaster.tableOperations().setProperty(masterTable2,Property.TABLE_REPLICATION_TARGET.getKey() + peerClusterName,peerTableId2);
    sleepUninterruptibly(3,TimeUnit.SECONDS);
    BatchWriter bw=connMaster.createBatchWriter(masterTable1,new BatchWriterConfig());
    long masterTable1Records=0l;
    for (int rows=0; rows < 2500; rows++) {
      Mutation m=new Mutation(masterTable1 + rows);
      for (int cols=0; cols < 100; cols++) {
        String value=Integer.toString(cols);
        m.put(value,"",value);
        masterTable1Records++;
      }
      bw.addMutation(m);
    }
    bw.close();
    bw=connMaster.createBatchWriter(masterTable2,new BatchWriterConfig());
    long masterTable2Records=0l;
    for (int rows=0; rows < 2500; rows++) {
      Mutation m=new Mutation(masterTable2 + rows);
      for (int cols=0; cols < 100; cols++) {
        String value=Integer.toString(cols);
        m.put(value,"",value);
        masterTable2Records++;
      }
      bw.addMutation(m);
    }
    bw.close();
    log.info("Wrote all data to master cluster");
    Set<String> filesFor1=connMaster.replicationOperations().referencedFiles(masterTable1), filesFor2=connMaster.replicationOperations().referencedFiles(masterTable2);
    while (!ReplicationTable.isOnline(connMaster)) {
      Thread.sleep(500);
    }
    for (    ProcessReference proc : cluster.getProcesses().get(ServerType.TABLET_SERVER)) {
      cluster.killProcess(ServerType.TABLET_SERVER,proc);
    }
    cluster.exec(TabletServer.class);
    log.info("Restarted the tserver");
    Iterators.size(connMaster.createScanner(masterTable1,Authorizations.EMPTY).iterator());
    log.info("Waiting for {} for {}",filesFor1,masterTable1);
    connMaster.replicationOperations().drain(masterTable1,filesFor1);
    log.info("Waiting for {} for {}",filesFor2,masterTable2);
    connMaster.replicationOperations().drain(masterTable2,filesFor2);
    long countTable=0l;
    for (int i=0; i < 5; i++) {
      countTable=0l;
      for (      Entry<Key,Value> entry : connPeer.createScanner(peerTable1,Authorizations.EMPTY)) {
        countTable++;
        Assert.assertTrue("Found unexpected key-value" + entry.getKey().toStringNoTruncate() + " "+ entry.getValue(),entry.getKey().getRow().toString().startsWith(masterTable1));
      }
      log.info("Found {} records in {}",countTable,peerTable1);
      if (masterTable1Records != countTable) {
        log.warn("Did not find {} expected records in {}, only found {}",masterTable1Records,peerTable1,countTable);
      }
    }
    Assert.assertEquals(masterTable1Records,countTable);
    for (int i=0; i < 5; i++) {
      countTable=0l;
      for (      Entry<Key,Value> entry : connPeer.createScanner(peerTable2,Authorizations.EMPTY)) {
        countTable++;
        Assert.assertTrue("Found unexpected key-value" + entry.getKey().toStringNoTruncate() + " "+ entry.getValue(),entry.getKey().getRow().toString().startsWith(masterTable2));
      }
      log.info("Found {} records in {}",countTable,peerTable2);
      if (masterTable2Records != countTable) {
        log.warn("Did not find {} expected records in {}, only found {}",masterTable2Records,peerTable2,countTable);
      }
    }
    Assert.assertEquals(masterTable2Records,countTable);
  }
  finally {
    peer1Cluster.stop();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.replication.UnusedWalDoesntCloseReplicationStatusIT </h4><pre class="type-9 type-5 type-3 type-7 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void test() throws Exception {
  File accumuloDir=this.getCluster().getConfig().getAccumuloDir();
  final Connector conn=getConnector();
  final String tableName=getUniqueNames(1)[0];
  conn.securityOperations().grantTablePermission("root",MetadataTable.NAME,TablePermission.WRITE);
  conn.tableOperations().create(tableName);
  final String tableId=conn.tableOperations().tableIdMap().get(tableName);
  final int numericTableId=Integer.parseInt(tableId);
  final int fakeTableId=numericTableId + 1;
  Assert.assertNotNull("Did not find table ID",tableId);
  conn.tableOperations().setProperty(tableName,Property.TABLE_REPLICATION.getKey(),"true");
  conn.tableOperations().setProperty(tableName,Property.TABLE_REPLICATION_TARGET.getKey() + "cluster1","1");
  conn.instanceOperations().setProperty(Property.REPLICATION_PEERS.getKey() + "cluster1",ReplicaSystemFactory.getPeerConfigurationValue(MockReplicaSystem.class,"50000"));
  FileSystem fs=FileSystem.getLocal(new Configuration());
  File tserverWalDir=new File(accumuloDir,ServerConstants.WAL_DIR + Path.SEPARATOR + "faketserver+port");
  File tserverWal=new File(tserverWalDir,UUID.randomUUID().toString());
  fs.mkdirs(new Path(tserverWalDir.getAbsolutePath()));
  FSDataOutputStream out=fs.create(new Path(tserverWal.getAbsolutePath()));
  out.write(DfsLogger.LOG_FILE_HEADER_V3.getBytes(UTF_8));
  DataOutputStream dos=new DataOutputStream(out);
  dos.writeUTF("NullCryptoModule");
  LogFileKey key=new LogFileKey();
  LogFileValue value=new LogFileValue();
  key.event=OPEN;
  key.tserverSession=tserverWal.getAbsolutePath();
  key.filename=tserverWal.getAbsolutePath();
  key.write(out);
  value.write(out);
  key.event=LogEvents.DEFINE_TABLET;
  key.tablet=new KeyExtent(new Text(Integer.toString(fakeTableId)),null,null);
  key.seq=1l;
  key.tid=1;
  key.write(dos);
  value.write(dos);
  key.tablet=null;
  key.event=LogEvents.MUTATION;
  key.filename=tserverWal.getAbsolutePath();
  value.mutations=Arrays.<Mutation>asList(new ServerMutation(new Text("row")));
  key.write(dos);
  value.write(dos);
  key.event=LogEvents.COMPACTION_START;
  key.filename=accumuloDir.getAbsolutePath() + "/tables/" + fakeTableId+ "/t-000001/A000001.rf";
  value.mutations=Collections.emptyList();
  key.write(dos);
  value.write(dos);
  key.event=LogEvents.COMPACTION_FINISH;
  value.mutations=Collections.emptyList();
  key.write(dos);
  value.write(dos);
  dos.close();
  BatchWriter bw=conn.createBatchWriter(tableName,new BatchWriterConfig());
  Mutation m=new Mutation("m");
  m.put("m","m","M");
  bw.addMutation(m);
  bw.close();
  log.info("State of metadata table after inserting a record");
  Scanner s=conn.createScanner(MetadataTable.NAME,Authorizations.EMPTY);
  s.setRange(MetadataSchema.TabletsSection.getRange(tableId));
  for (  Entry<Key,Value> entry : s) {
    System.out.println(entry.getKey().toStringNoTruncate() + " " + entry.getValue());
  }
  s=conn.createScanner(MetadataTable.NAME,Authorizations.EMPTY);
  s.setRange(MetadataSchema.ReplicationSection.getRange());
  for (  Entry<Key,Value> entry : s) {
    System.out.println(entry.getKey().toStringNoTruncate() + " " + ProtobufUtil.toString(Status.parseFrom(entry.getValue().get())));
  }
  log.info("Offline'ing table");
  conn.tableOperations().offline(tableName,true);
  String walUri=tserverWal.toURI().toString();
  KeyExtent extent=new KeyExtent(new Text(tableId),null,null);
  bw=conn.createBatchWriter(MetadataTable.NAME,new BatchWriterConfig());
  m=new Mutation(extent.getMetadataEntry());
  m.put(MetadataSchema.TabletsSection.LogColumnFamily.NAME,new Text("localhost:12345/" + walUri),new Value((walUri + "|1").getBytes(UTF_8)));
  bw.addMutation(m);
  m=new Mutation(MetadataSchema.ReplicationSection.getRowPrefix() + new Path(walUri).toString());
  m.put(MetadataSchema.ReplicationSection.COLF,new Text(tableId),new Value(StatusUtil.fileCreated(System.currentTimeMillis()).toByteArray()));
  bw.addMutation(m);
  bw.close();
  log.info("State of metadata after injecting WAL manually");
  s=conn.createScanner(MetadataTable.NAME,Authorizations.EMPTY);
  s.setRange(MetadataSchema.TabletsSection.getRange(tableId));
  for (  Entry<Key,Value> entry : s) {
    log.info(entry.getKey().toStringNoTruncate() + " " + entry.getValue());
  }
  s=conn.createScanner(MetadataTable.NAME,Authorizations.EMPTY);
  s.setRange(MetadataSchema.ReplicationSection.getRange());
  for (  Entry<Key,Value> entry : s) {
    log.info(entry.getKey().toStringNoTruncate() + " " + ProtobufUtil.toString(Status.parseFrom(entry.getValue().get())));
  }
  log.info("Bringing table online");
  conn.tableOperations().online(tableName,true);
  Assert.assertEquals(1,Iterables.size(conn.createScanner(tableName,Authorizations.EMPTY)));
  log.info("Table has performed recovery, state of metadata:");
  s=conn.createScanner(MetadataTable.NAME,Authorizations.EMPTY);
  s.setRange(MetadataSchema.TabletsSection.getRange(tableId));
  for (  Entry<Key,Value> entry : s) {
    log.info(entry.getKey().toStringNoTruncate() + " " + entry.getValue());
  }
  s=conn.createScanner(MetadataTable.NAME,Authorizations.EMPTY);
  s.setRange(MetadataSchema.ReplicationSection.getRange());
  for (  Entry<Key,Value> entry : s) {
    Status status=Status.parseFrom(entry.getValue().get());
    log.info(entry.getKey().toStringNoTruncate() + " " + ProtobufUtil.toString(status));
    Assert.assertFalse("Status record was closed and it should not be",status.getClosed());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.replication.WorkMakerIT </h4><pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void dontCreateWorkForEntriesWithNothingToReplicate() throws Exception {
  String table=testName.getMethodName();
  conn.tableOperations().create(table);
  String tableId=conn.tableOperations().tableIdMap().get(table);
  String file="hdfs://localhost:8020/accumulo/wal/123456-1234-1234-12345678";
  Mutation m=new Mutation(new Path(file).toString());
  m.put(StatusSection.NAME,new Text(tableId),StatusUtil.fileCreatedValue(System.currentTimeMillis()));
  BatchWriter bw=ReplicationTable.getBatchWriter(conn);
  bw.addMutation(m);
  bw.flush();
  Scanner s=ReplicationTable.getScanner(conn);
  StatusSection.limit(s);
  Assert.assertEquals(1,Iterables.size(s));
  MockWorkMaker workMaker=new MockWorkMaker(conn);
  conn.tableOperations().setProperty(ReplicationTable.NAME,Property.TABLE_REPLICATION_TARGET.getKey() + "remote_cluster_1","4");
  workMaker.setBatchWriter(bw);
  workMaker.run();
  s=ReplicationTable.getScanner(conn);
  WorkSection.limit(s);
  Assert.assertEquals(0,Iterables.size(s));
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void singleUnitMultipleTargets() throws Exception {
  String table=testName.getMethodName();
  conn.tableOperations().create(table);
  String tableId=conn.tableOperations().tableIdMap().get(table);
  String file="hdfs://localhost:8020/accumulo/wal/123456-1234-1234-12345678";
  Mutation m=new Mutation(new Path(file).toString());
  m.put(StatusSection.NAME,new Text(tableId),StatusUtil.fileCreatedValue(System.currentTimeMillis()));
  BatchWriter bw=ReplicationTable.getBatchWriter(conn);
  bw.addMutation(m);
  bw.flush();
  Scanner s=ReplicationTable.getScanner(conn);
  StatusSection.limit(s);
  Assert.assertEquals(1,Iterables.size(s));
  MockWorkMaker workMaker=new MockWorkMaker(conn);
  Map<String,String> targetClusters=ImmutableMap.of("remote_cluster_1","4","remote_cluster_2","6","remote_cluster_3","8");
  Set<ReplicationTarget> expectedTargets=new HashSet<>();
  for (  Entry<String,String> cluster : targetClusters.entrySet()) {
    expectedTargets.add(new ReplicationTarget(cluster.getKey(),cluster.getValue(),tableId));
  }
  workMaker.setBatchWriter(bw);
  workMaker.addWorkRecord(new Text(file),StatusUtil.fileCreatedValue(System.currentTimeMillis()),targetClusters,tableId);
  s=ReplicationTable.getScanner(conn);
  WorkSection.limit(s);
  Set<ReplicationTarget> actualTargets=new HashSet<>();
  for (  Entry<Key,Value> entry : s) {
    Assert.assertEquals(file,entry.getKey().getRow().toString());
    Assert.assertEquals(WorkSection.NAME,entry.getKey().getColumnFamily());
    ReplicationTarget target=ReplicationTarget.from(entry.getKey().getColumnQualifier());
    actualTargets.add(target);
  }
  for (  ReplicationTarget expected : expectedTargets) {
    Assert.assertTrue("Did not find expected target: " + expected,actualTargets.contains(expected));
    actualTargets.remove(expected);
  }
  Assert.assertTrue("Found extra replication work entries: " + actualTargets,actualTargets.isEmpty());
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void singleUnitSingleTarget() throws Exception {
  String table=testName.getMethodName();
  conn.tableOperations().create(table);
  String tableId=conn.tableOperations().tableIdMap().get(table);
  String file="hdfs://localhost:8020/accumulo/wal/123456-1234-1234-12345678";
  long timeCreated=System.currentTimeMillis();
  Mutation m=new Mutation(new Path(file).toString());
  m.put(StatusSection.NAME,new Text(tableId),StatusUtil.fileCreatedValue(timeCreated));
  BatchWriter bw=ReplicationTable.getBatchWriter(conn);
  bw.addMutation(m);
  bw.flush();
  Scanner s=ReplicationTable.getScanner(conn);
  StatusSection.limit(s);
  Assert.assertEquals(1,Iterables.size(s));
  MockWorkMaker workMaker=new MockWorkMaker(conn);
  ReplicationTarget expected=new ReplicationTarget("remote_cluster_1","4",tableId);
  workMaker.setBatchWriter(bw);
  workMaker.addWorkRecord(new Text(file),StatusUtil.fileCreatedValue(timeCreated),ImmutableMap.of("remote_cluster_1","4"),tableId);
  s=ReplicationTable.getScanner(conn);
  WorkSection.limit(s);
  Entry<Key,Value> workEntry=Iterables.getOnlyElement(s);
  Key workKey=workEntry.getKey();
  ReplicationTarget actual=ReplicationTarget.from(workKey.getColumnQualifier());
  Assert.assertEquals(file,workKey.getRow().toString());
  Assert.assertEquals(WorkSection.NAME,workKey.getColumnFamily());
  Assert.assertEquals(expected,actual);
  Assert.assertEquals(workEntry.getValue(),StatusUtil.fileCreatedValue(timeCreated));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.test.start.KeywordStartIT </h4><pre class="type-9 type-13 type-5 type-21 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExpectedClasses() throws IOException {
  assumeTrue(new File(System.getProperty("user.dir") + "/src").exists());
  TreeMap<String,Class<? extends KeywordExecutable>> expectSet=new TreeMap<>();
  expectSet.put("admin",Admin.class);
  expectSet.put("classpath",Classpath.class);
  expectSet.put("create-token",CreateToken.class);
  expectSet.put("gc",GCExecutable.class);
  expectSet.put("help",Help.class);
  expectSet.put("info",Info.class);
  expectSet.put("init",Initialize.class);
  expectSet.put("jar",Jar.class);
  expectSet.put("login-info",LoginProperties.class);
  expectSet.put("master",MasterExecutable.class);
  expectSet.put("minicluster",MiniClusterExecutable.class);
  expectSet.put("monitor",MonitorExecutable.class);
  expectSet.put("proxy",Proxy.class);
  expectSet.put("rfile-info",PrintInfo.class);
  expectSet.put("shell",Shell.class);
  expectSet.put("tracer",TracerExecutable.class);
  expectSet.put("tserver",TServerExecutable.class);
  expectSet.put("version",Version.class);
  expectSet.put("zookeeper",ZooKeeperMain.class);
  Iterator<Entry<String,Class<? extends KeywordExecutable>>> expectIter=expectSet.entrySet().iterator();
  TreeMap<String,KeywordExecutable> actualSet=new TreeMap<>(Main.getExecutables(getClass().getClassLoader()));
  Iterator<Entry<String,KeywordExecutable>> actualIter=actualSet.entrySet().iterator();
  Entry<String,Class<? extends KeywordExecutable>> expected;
  Entry<String,KeywordExecutable> actual;
  while (expectIter.hasNext() && actualIter.hasNext()) {
    expected=expectIter.next();
    actual=actualIter.next();
    assertEquals(expected.getKey(),actual.getKey());
    assertEquals(expected.getValue(),actual.getValue().getClass());
  }
  boolean moreExpected=expectIter.hasNext();
  if (moreExpected) {
    while (expectIter.hasNext()) {
      log.warn("Missing class for keyword '" + expectIter.next() + "'");
    }
  }
  assertFalse("Missing expected classes",moreExpected);
  boolean moreActual=actualIter.hasNext();
  if (moreActual) {
    while (actualIter.hasNext()) {
      log.warn("Extra class found with keyword '" + actualIter.next() + "'");
    }
  }
  assertFalse("Found additional unexpected classes",moreActual);
}

</code></pre>

<br>
<pre class="type-9 type-5 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCheckDuplicates(){
  NoOp one=new NoOp("one");
  NoOp anotherOne=new NoOp("another");
  NoOp two=new NoOp("two");
  NoOp three=new NoOp("three");
  List<NoOp> services=Arrays.asList(one,three,two,two,three,three,anotherOne);
  assertEquals(7,services.size());
  Map<String,KeywordExecutable> results=Main.checkDuplicates(services);
  assertTrue(results.containsKey(one.keyword()));
  assertTrue(results.containsKey(anotherOne.keyword()));
  assertFalse(results.containsKey(two.keyword()));
  assertFalse(results.containsKey(three.keyword()));
  assertEquals(2,results.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.tracer.AsyncSpanReceiverTest </h4><pre class="type-9 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testExcludeMore() throws InterruptedException {
  try (TestReceiver receiver=new TestReceiver(HTraceConfiguration.fromMap(Collections.singletonMap(AsyncSpanReceiver.SPAN_MIN_MS,"10")))){
    receiver.receiveSpan(createSpan(0));
    while (receiver.getQueueSize() > 0) {
      Thread.sleep(500);
    }
    assertEquals(0,receiver.getQueueSize());
    assertEquals(0,receiver.getSpansSent());
    receiver.receiveSpan(createSpan(9));
    while (receiver.getQueueSize() > 0) {
      Thread.sleep(500);
    }
    assertEquals(0,receiver.getQueueSize());
    assertEquals(0,receiver.getSpansSent());
    receiver.receiveSpan(createSpan(10));
    while (receiver.getQueueSize() > 0) {
      Thread.sleep(500);
    }
    assertEquals(0,receiver.getQueueSize());
    assertEquals(1,receiver.getSpansSent());
  }
 }

</code></pre>

<br>
<pre class="type-9 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testKeepAll() throws InterruptedException {
  try (TestReceiver receiver=new TestReceiver(HTraceConfiguration.fromMap(Collections.singletonMap(AsyncSpanReceiver.SPAN_MIN_MS,"0")))){
    receiver.receiveSpan(createSpan(0));
    while (receiver.getQueueSize() > 0) {
      Thread.sleep(500);
    }
    assertEquals(0,receiver.getQueueSize());
    assertEquals(1,receiver.getSpansSent());
  }
 }

</code></pre>

<br>
<pre class="type-9 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test() throws InterruptedException {
  try (TestReceiver receiver=new TestReceiver()){
    receiver.receiveSpan(createSpan(0));
    while (receiver.getQueueSize() > 0) {
      Thread.sleep(500);
    }
    assertEquals(0,receiver.getQueueSize());
    assertEquals(0,receiver.getSpansSent());
    receiver.receiveSpan(createSpan(1));
    while (receiver.getQueueSize() > 0) {
      Thread.sleep(500);
    }
    assertEquals(0,receiver.getQueueSize());
    assertEquals(1,receiver.getSpansSent());
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.tserver.InMemoryMapTest </h4><pre class="type-9 type-13 type-5 type-18 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Is not executed with the test suite">IgnoredMethod</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies boolean conditions
- Is not executed with the test suite
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test @Ignore public void parallelWriteSpeed() throws Exception {
  List<Double> timings=new ArrayList<Double>();
  for (  int threads : new int[]{1,2,16}) {
    final long now=System.currentTimeMillis();
    final long counts[]=new long[threads];
    final InMemoryMap imm=newInMemoryMap(false,tempFolder.newFolder().getAbsolutePath());
    ExecutorService e=Executors.newFixedThreadPool(threads);
    for (int j=0; j < threads; j++) {
      final int threadId=j;
      e.execute(new Runnable(){
        @Override public void run(){
          while (System.currentTimeMillis() - now < 1000) {
            for (int k=0; k < 1000; k++) {
              Mutation m=new Mutation("row");
              m.put("cf","cq",new Value("v".getBytes()));
              List<Mutation> mutations=Collections.singletonList(m);
              imm.mutate(mutations);
              counts[threadId]++;
            }
          }
        }
      }
);
    }
    e.shutdown();
    e.awaitTermination(10,TimeUnit.SECONDS);
    imm.delete(10000);
    double mutationsPerSecond=sum(counts) / ((System.currentTimeMillis() - now) / 1000.);
    timings.add(mutationsPerSecond);
    log.info(String.format("%.1f mutations per second with %d threads",mutationsPerSecond,threads));
  }
  for (int i=0; i < timings.size(); i++) {
    double ratioFirst=timings.get(0) / timings.get(i);
    assertTrue(ratioFirst < 3);
    assertTrue(ratioFirst > 0.3);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.tserver.LargestFirstMemoryManagerTest </h4><pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test() throws Exception {
  LargestFirstMemoryManagerUnderTest mgr=new LargestFirstMemoryManagerUnderTest();
  ServerConfiguration config=new ServerConfiguration(){
    ServerConfigurationFactory delegate=new ServerConfigurationFactory(inst);
    @Override public AccumuloConfiguration getConfiguration(){
      return DefaultConfiguration.getInstance();
    }
    @Override public TableConfiguration getTableConfiguration(    String tableId){
      return delegate.getTableConfiguration(tableId);
    }
    @Override public TableConfiguration getTableConfiguration(    KeyExtent extent){
      return delegate.getTableConfiguration(extent);
    }
    @Override public NamespaceConfiguration getNamespaceConfiguration(    String namespaceId){
      return delegate.getNamespaceConfiguration(namespaceId);
    }
    @Override public Instance getInstance(){
      return delegate.getInstance();
    }
  }
;
  mgr.init(config);
  MemoryManagementActions result;
  result=mgr.getMemoryManagementActions(tablets(t(k("x"),ZERO,1000,0),t(k("y"),ZERO,2000,0)));
  assertEquals(0,result.tabletsToMinorCompact.size());
  result=mgr.getMemoryManagementActions(tablets(t(k("x"),ZERO,ONE_GIG,0),t(k("y"),ZERO,2000,0)));
  assertEquals(1,result.tabletsToMinorCompact.size());
  assertEquals(k("x"),result.tabletsToMinorCompact.get(0));
  mgr.currentTime=LATER;
  result=mgr.getMemoryManagementActions(tablets(t(k("x"),ZERO,1001,0),t(k("y"),LATER,2000,0)));
  assertEquals(1,result.tabletsToMinorCompact.size());
  assertEquals(k("x"),result.tabletsToMinorCompact.get(0));
  result=mgr.getMemoryManagementActions(tablets(t(k("x"),ZERO,1001,0),t(k("y"),LATER,ONE_GIG,0)));
  assertEquals(1,result.tabletsToMinorCompact.size());
  assertEquals(k("y"),result.tabletsToMinorCompact.get(0));
  mgr=new LargestFirstMemoryManagerUnderTest();
  mgr.init(config);
  result=mgr.getMemoryManagementActions(tablets(t(k("a"),ZERO,HALF_GIG,0),t(k("b"),ZERO,HALF_GIG + 1,0),t(k("c"),ZERO,HALF_GIG + 2,0),t(k("d"),ZERO,HALF_GIG + 3,0),t(k("e"),ZERO,HALF_GIG + 4,0),t(k("f"),ZERO,HALF_GIG + 5,0),t(k("g"),ZERO,HALF_GIG + 6,0),t(k("h"),ZERO,HALF_GIG + 7,0),t(k("i"),ZERO,HALF_GIG + 8,0)));
  assertEquals(2,result.tabletsToMinorCompact.size());
  assertEquals(k("i"),result.tabletsToMinorCompact.get(0));
  assertEquals(k("h"),result.tabletsToMinorCompact.get(1));
  mgr=new LargestFirstMemoryManagerUnderTest();
  mgr.init(config);
  result=mgr.getMemoryManagementActions(tablets(t(k("a"),ZERO,HALF_GIG,0),t(k("b"),ZERO,HALF_GIG + 1,0),t(k("c"),ZERO,HALF_GIG + 2,0),t(k("d"),ZERO,HALF_GIG + 3,0),t(k("e"),ZERO,HALF_GIG + 4,0),t(k("f"),ZERO,HALF_GIG + 5,0),t(k("g"),ZERO,ONE_GIG,0),t(k("h"),ZERO,0,HALF_GIG + 7),t(k("i"),ZERO,0,0)));
  assertEquals(1,result.tabletsToMinorCompact.size());
  assertEquals(k("g"),result.tabletsToMinorCompact.get(0));
  result=mgr.getMemoryManagementActions(tablets(t(k("a"),ZERO,HALF_GIG,0),t(k("b"),ZERO,ONE_GIG + 1,0),t(k("c"),ZERO,ONE_GIG + 2,0),t(k("d"),ZERO,ONE_GIG + 3,0),t(k("e"),ZERO,ONE_GIG + 4,0),t(k("f"),ZERO,ONE_GIG + 5,0),t(k("g"),ZERO,ONE_GIG + 6,0),t(k("h"),ZERO,0,0),t(k("i"),ZERO,0,0)));
  assertEquals(2,result.tabletsToMinorCompact.size());
  assertEquals(k("g"),result.tabletsToMinorCompact.get(0));
  assertEquals(k("f"),result.tabletsToMinorCompact.get(1));
  result=mgr.getMemoryManagementActions(tablets(t(k("a"),ZERO,HALF_GIG,0),t(k("b"),ZERO,ONE_GIG + 1,0),t(k("c"),ZERO,ONE_GIG + 2,0),t(k("d"),ZERO,ONE_GIG + 3,0),t(k("e"),ZERO,ONE_GIG + 4,0),t(k("f"),ZERO,ONE_GIG,ONE_GIG + 5),t(k("g"),ZERO,ONE_GIG,ONE_GIG + 6),t(k("h"),ZERO,0,0),t(k("i"),ZERO,0,0)));
  assertEquals(0,result.tabletsToMinorCompact.size());
  result=mgr.getMemoryManagementActions(tablets(t(k("a"),ZERO,HALF_GIG,0),t(k("b"),ZERO,ONE_GIG + 1,0),t(k("c"),ZERO,ONE_GIG + 2,0),t(k("d"),ZERO,ONE_GIG + 3,0),t(k("e"),ZERO,ONE_GIG + 4,0),t(k("f"),ZERO,ONE_GIG,ONE_GIG + 5),t(k("g"),ZERO,ONE_GIG,0),t(k("h"),ZERO,0,0),t(k("i"),ZERO,0,0)));
  assertEquals(1,result.tabletsToMinorCompact.size());
  assertEquals(k("e"),result.tabletsToMinorCompact.get(0));
  mgr=new LargestFirstMemoryManagerUnderTest();
  mgr.init(config);
  result=mgr.getMemoryManagementActions(tablets(t(k("a"),ZERO,HALF_GIG,0),t(k("b"),ZERO,HALF_GIG + 1,0),t(k("c"),ZERO,HALF_GIG + 2,0),t(k("d"),ZERO,0,HALF_GIG),t(k("e"),ZERO,0,HALF_GIG),t(k("f"),ZERO,0,HALF_GIG),t(k("g"),ZERO,0,HALF_GIG),t(k("i"),ZERO,0,HALF_GIG),t(k("j"),ZERO,0,HALF_GIG),t(k("k"),ZERO,0,HALF_GIG),t(k("l"),ZERO,0,HALF_GIG),t(k("m"),ZERO,0,HALF_GIG)));
  assertEquals(0,result.tabletsToMinorCompact.size());
  mgr=new LargestFirstMemoryManagerUnderTest();
  mgr.init(config);
  result=mgr.getMemoryManagementActions(tablets(t(k("a"),ZERO,QGIG,0),t(k("b"),ZERO,QGIG + 1,0),t(k("c"),ZERO,QGIG + 2,0)));
  assertEquals(1,result.tabletsToMinorCompact.size());
  assertEquals(k("c"),result.tabletsToMinorCompact.get(0));
  result=mgr.getMemoryManagementActions(tablets(t(k("a"),ZERO,QGIG,0),t(k("b"),ZERO,QGIG + 1,0),t(k("c"),ZERO,0,QGIG + 2)));
  assertEquals(0,result.tabletsToMinorCompact.size());
  mgr.currentTime+=ONE_MINUTE;
  result=mgr.getMemoryManagementActions(tablets(t(k("a"),ZERO,QGIG,0),t(k("b"),ZERO,QGIG + 1,0),t(k("c"),ZERO,0,QGIG + 2)));
  assertEquals(0,result.tabletsToMinorCompact.size());
  mgr.currentTime+=ONE_MINUTE;
  result=mgr.getMemoryManagementActions(tablets(t(k("a"),ZERO,QGIG,0),t(k("b"),ZERO,0,0),t(k("c"),ZERO,0,0)));
  assertEquals(0,result.tabletsToMinorCompact.size());
  mgr.currentTime+=ONE_MINUTE;
  result=mgr.getMemoryManagementActions(tablets(t(k("a"),ZERO,QGIG,0),t(k("b"),ZERO,QGIG + 1,0),t(k("c"),ZERO,0,0)));
  assertEquals(1,result.tabletsToMinorCompact.size());
  assertEquals(k("b"),result.tabletsToMinorCompact.get(0));
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDeletedTable() throws Exception {
  final String deletedTableId="1";
  Function<String,Boolean> existenceCheck=new Function<String,Boolean>(){
    @Override public Boolean apply(    String tableId){
      return !deletedTableId.equals(tableId);
    }
  }
;
  LargestFirstMemoryManagerWithExistenceCheck mgr=new LargestFirstMemoryManagerWithExistenceCheck(existenceCheck);
  ServerConfiguration config=new ServerConfiguration(){
    ServerConfigurationFactory delegate=new ServerConfigurationFactory(inst);
    @Override public AccumuloConfiguration getConfiguration(){
      return DefaultConfiguration.getInstance();
    }
    @Override public TableConfiguration getTableConfiguration(    String tableId){
      return delegate.getTableConfiguration(tableId);
    }
    @Override public TableConfiguration getTableConfiguration(    KeyExtent extent){
      return delegate.getTableConfiguration(extent);
    }
    @Override public NamespaceConfiguration getNamespaceConfiguration(    String namespaceId){
      return delegate.getNamespaceConfiguration(namespaceId);
    }
    @Override public Instance getInstance(){
      return delegate.getInstance();
    }
  }
;
  mgr.init(config);
  MemoryManagementActions result;
  KeyExtent extent=new KeyExtent(new Text("2"),new Text("j"),null);
  result=mgr.getMemoryManagementActions(tablets(t(extent,ZERO,ONE_GIG,0),t(k("j"),ZERO,ONE_GIG,0)));
  assertEquals(1,result.tabletsToMinorCompact.size());
  assertEquals(extent,result.tabletsToMinorCompact.get(0));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.tserver.log.LocalWALRecoveryTest </h4><pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRecoverLocalWriteAheadLogs() throws IOException {
  Path targetPath=new Path(walTarget.toURI());
  FileSystem fs=FileSystem.get(targetPath.toUri(),new Configuration());
  recovery.recoverLocalWriteAheadLogs(fs);
  FileStatus[] recovered=fs.listStatus(targetPath);
  assertEquals("Wrong number of WAL files recovered.",1,recovered.length);
  final Path path=recovered[0].getPath();
  final VolumeManager volumeManager=VolumeManagerImpl.getLocal(folder.getRoot().getAbsolutePath());
  final DFSLoggerInputStreams streams=DfsLogger.readHeaderAndReturnStream(volumeManager,path,configuration);
  final DataInputStream input=streams.getDecryptingInputStream();
  final LogFileKey key=new LogFileKey();
  final LogFileValue value=new LogFileValue();
  int read=0;
  while (true) {
    try {
      key.readFields(input);
      value.readFields(input);
      read++;
    }
 catch (    EOFException ex) {
      break;
    }
  }
  assertEquals(104,read);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.tserver.log.LogEntryTest </h4><pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void test() throws Exception {
  KeyExtent extent=new KeyExtent(new Text("1"),null,new Text(""));
  long ts=12345678L;
  String server="localhost:1234";
  String filename="default/foo";
  LogEntry entry=new LogEntry(extent,ts,server,filename);
  assertEquals(extent,entry.extent);
  assertEquals(server,entry.server);
  assertEquals(filename,entry.filename);
  assertEquals(ts,entry.timestamp);
  assertEquals("1<; default/foo",entry.toString());
  assertEquals(new Text("log"),entry.getColumnFamily());
  assertEquals(new Text("localhost:1234/default/foo"),entry.getColumnQualifier());
  LogEntry copy=LogEntry.fromBytes(entry.toBytes());
  assertEquals(entry.toString(),copy.toString());
  Key key=new Key(new Text("1<"),new Text("log"),new Text("localhost:1234/default/foo"));
  key.setTimestamp(ts);
  LogEntry copy2=LogEntry.fromKeyValue(key,entry.getValue());
  assertEquals(entry.toString(),copy2.toString());
  assertEquals(entry.timestamp,copy2.timestamp);
  assertEquals("foo",entry.getUniqueID());
  assertEquals("localhost:1234/default/foo",entry.getName());
  assertEquals(new Value("default/foo".getBytes()),entry.getValue());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.tserver.log.SortedLogRecoveryTest </h4><pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetMutationsAfterCompactionStart() throws IOException {
  Mutation ignored=new ServerMutation(new Text("ignored"));
  ignored.put(cf,cq,value);
  Mutation m=new ServerMutation(new Text("row1"));
  m.put(cf,cq,value);
  Mutation m2=new ServerMutation(new Text("row2"));
  m2.put(cf,cq,new Value("123".getBytes()));
  KeyValue entries[]=new KeyValue[]{createKeyValue(OPEN,0,-1,"1"),createKeyValue(DEFINE_TABLET,1,1,extent),createKeyValue(COMPACTION_START,3,1,"/t1/f1"),createKeyValue(MUTATION,2,1,ignored),createKeyValue(MUTATION,4,1,m)};
  KeyValue entries2[]=new KeyValue[]{createKeyValue(OPEN,5,-1,"1"),createKeyValue(DEFINE_TABLET,6,1,extent),createKeyValue(COMPACTION_FINISH,7,1,null),createKeyValue(MUTATION,8,1,m2)};
  Map<String,KeyValue[]> logs=new TreeMap<String,KeyValue[]>();
  logs.put("entries",entries);
  logs.put("entries2",entries2);
  List<Mutation> mutations=recover(logs,extent);
  Assert.assertEquals(2,mutations.size());
  Assert.assertEquals(m,mutations.get(0));
  Assert.assertEquals(m2,mutations.get(1));
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCompactionCrossesLogs6() throws IOException {
  Mutation ignored=new ServerMutation(new Text("ignored"));
  ignored.put(cf,cq,value);
  Mutation m=new ServerMutation(new Text("row1"));
  m.put(cf,cq,value);
  Mutation m2=new ServerMutation(new Text("row2"));
  m2.put(cf,cq,value);
  Mutation m3=new ServerMutation(new Text("row3"));
  m3.put(cf,cq,value);
  Mutation m4=new ServerMutation(new Text("row4"));
  m4.put(cf,cq,value);
  Mutation m5=new ServerMutation(new Text("row5"));
  m5.put(cf,cq,value);
  KeyValue entries[]=new KeyValue[]{createKeyValue(OPEN,0,1,"2"),createKeyValue(DEFINE_TABLET,1,1,extent),createKeyValue(MUTATION,1,1,ignored),createKeyValue(MUTATION,3,1,m)};
  KeyValue entries2[]=new KeyValue[]{createKeyValue(OPEN,0,1,"2"),createKeyValue(DEFINE_TABLET,1,1,extent),createKeyValue(COMPACTION_START,2,1,"/t1/f1"),createKeyValue(COMPACTION_FINISH,3,1,"/t1/f1"),createKeyValue(MUTATION,3,1,m2)};
  Map<String,KeyValue[]> logs=new TreeMap<String,KeyValue[]>();
  logs.put("entries",entries);
  logs.put("entries2",entries2);
  List<Mutation> mutations=recover(logs,extent);
  Assert.assertEquals(2,mutations.size());
  Assert.assertEquals(m,mutations.get(0));
  Assert.assertEquals(m2,mutations.get(1));
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCompactionCrossesLogs2() throws IOException {
  Mutation ignored=new ServerMutation(new Text("ignored"));
  ignored.put(cf,cq,value);
  Mutation m=new ServerMutation(new Text("row1"));
  m.put(cf,cq,value);
  Mutation m2=new ServerMutation(new Text("row2"));
  m2.put(cf,cq,value);
  Mutation m3=new ServerMutation(new Text("row3"));
  m3.put(cf,cq,value);
  KeyValue entries[]=new KeyValue[]{createKeyValue(OPEN,0,-1,"1"),createKeyValue(DEFINE_TABLET,1,1,extent),createKeyValue(COMPACTION_START,3,1,"/t1/f1"),createKeyValue(MUTATION,2,1,ignored),createKeyValue(MUTATION,4,1,m)};
  KeyValue entries2[]=new KeyValue[]{createKeyValue(OPEN,5,-1,"1"),createKeyValue(DEFINE_TABLET,6,1,extent),createKeyValue(MUTATION,7,1,m2)};
  KeyValue entries3[]=new KeyValue[]{createKeyValue(OPEN,8,-1,"1"),createKeyValue(DEFINE_TABLET,9,1,extent),createKeyValue(COMPACTION_FINISH,10,1,null),createKeyValue(MUTATION,11,1,m3)};
  Map<String,KeyValue[]> logs=new TreeMap<String,KeyValue[]>();
  logs.put("entries",entries);
  logs.put("entries2",entries2);
  logs.put("entries3",entries3);
  List<Mutation> mutations=recover(logs,extent);
  Assert.assertEquals(3,mutations.size());
  Assert.assertEquals(m,mutations.get(0));
  Assert.assertEquals(m2,mutations.get(1));
  Assert.assertEquals(m3,mutations.get(2));
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSkipSuccessfulCompactionAcrossFiles() throws IOException {
  Mutation ignored=new ServerMutation(new Text("ignored"));
  ignored.put(cf,cq,value);
  Mutation m=new ServerMutation(new Text("row1"));
  m.put(cf,cq,value);
  KeyValue entries[]=new KeyValue[]{createKeyValue(OPEN,0,-1,"1"),createKeyValue(DEFINE_TABLET,1,1,extent),createKeyValue(COMPACTION_START,3,1,"/t1/f1"),createKeyValue(MUTATION,2,1,ignored)};
  KeyValue entries2[]=new KeyValue[]{createKeyValue(OPEN,4,-1,"1"),createKeyValue(DEFINE_TABLET,5,1,extent),createKeyValue(COMPACTION_FINISH,6,1,null),createKeyValue(MUTATION,7,1,m)};
  Map<String,KeyValue[]> logs=new TreeMap<String,KeyValue[]>();
  logs.put("entries",entries);
  logs.put("entries2",entries2);
  List<Mutation> mutations=recover(logs,extent);
  Assert.assertEquals(1,mutations.size());
  Assert.assertEquals(m,mutations.get(0));
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCompactionCrossesLogs5() throws IOException {
  Mutation ignored=new ServerMutation(new Text("ignored"));
  ignored.put(cf,cq,value);
  Mutation m=new ServerMutation(new Text("row1"));
  m.put(cf,cq,value);
  Mutation m2=new ServerMutation(new Text("row2"));
  m2.put(cf,cq,value);
  Mutation m3=new ServerMutation(new Text("row3"));
  m3.put(cf,cq,value);
  Mutation m4=new ServerMutation(new Text("row4"));
  m4.put(cf,cq,value);
  KeyValue entries[]=new KeyValue[]{createKeyValue(OPEN,0,-1,"1"),createKeyValue(DEFINE_TABLET,1,1,extent),createKeyValue(COMPACTION_START,3,1,"/t1/f1"),createKeyValue(MUTATION,2,1,ignored),createKeyValue(MUTATION,4,1,ignored)};
  KeyValue entries2[]=new KeyValue[]{createKeyValue(OPEN,5,-1,"2"),createKeyValue(DEFINE_TABLET,6,1,extent),createKeyValue(MUTATION,7,1,ignored)};
  KeyValue entries3[]=new KeyValue[]{createKeyValue(OPEN,8,-1,"3"),createKeyValue(DEFINE_TABLET,9,1,extent),createKeyValue(COMPACTION_FINISH,10,1,"/t1/f1"),createKeyValue(COMPACTION_START,12,1,"/t1/f2"),createKeyValue(COMPACTION_FINISH,13,1,"/t1/f2"),createKeyValue(MUTATION,11,1,ignored),createKeyValue(MUTATION,15,1,m),createKeyValue(MUTATION,16,1,m2)};
  KeyValue entries4[]=new KeyValue[]{createKeyValue(OPEN,17,-1,"4"),createKeyValue(DEFINE_TABLET,18,1,extent),createKeyValue(COMPACTION_START,20,1,"/t1/f3"),createKeyValue(MUTATION,19,1,m3),createKeyValue(MUTATION,21,1,m4)};
  Map<String,KeyValue[]> logs=new TreeMap<String,KeyValue[]>();
  logs.put("entries",entries);
  logs.put("entries2",entries2);
  logs.put("entries3",entries3);
  logs.put("entries4",entries4);
  List<Mutation> mutations=recover(logs,extent);
  Assert.assertEquals(4,mutations.size());
  Assert.assertEquals(m,mutations.get(0));
  Assert.assertEquals(m2,mutations.get(1));
  Assert.assertEquals(m3,mutations.get(2));
  Assert.assertEquals(m4,mutations.get(3));
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSkipSuccessfulCompaction() throws IOException {
  Mutation ignored=new ServerMutation(new Text("ignored"));
  ignored.put(cf,cq,value);
  Mutation m=new ServerMutation(new Text("row1"));
  m.put(cf,cq,value);
  KeyValue entries[]=new KeyValue[]{createKeyValue(OPEN,0,-1,"1"),createKeyValue(DEFINE_TABLET,1,1,extent),createKeyValue(COMPACTION_START,3,1,"/t1/f1"),createKeyValue(COMPACTION_FINISH,4,1,null),createKeyValue(MUTATION,2,1,ignored),createKeyValue(MUTATION,5,1,m)};
  Map<String,KeyValue[]> logs=new TreeMap<String,KeyValue[]>();
  logs.put("testlog",entries);
  List<Mutation> mutations=recover(logs,extent);
  Assert.assertEquals(1,mutations.size());
  Assert.assertEquals(m,mutations.get(0));
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testLookingForBug3() throws IOException {
  Mutation ignored=new ServerMutation(new Text("ignored"));
  ignored.put(cf,cq,value);
  Mutation m=new ServerMutation(new Text("row1"));
  m.put(cf,cq,value);
  Mutation m2=new ServerMutation(new Text("row2"));
  m2.put(cf,cq,value);
  Mutation m3=new ServerMutation(new Text("row3"));
  m3.put(cf,cq,value);
  Mutation m4=new ServerMutation(new Text("row4"));
  m4.put(cf,cq,value);
  Mutation m5=new ServerMutation(new Text("row5"));
  m5.put(cf,cq,value);
  KeyValue entries[]=new KeyValue[]{createKeyValue(OPEN,0,-1,"1"),createKeyValue(DEFINE_TABLET,1,1,extent),createKeyValue(COMPACTION_START,2,1,"/t1/f1"),createKeyValue(COMPACTION_FINISH,3,1,null),createKeyValue(MUTATION,1,1,ignored),createKeyValue(MUTATION,3,1,m),createKeyValue(MUTATION,3,1,m2),createKeyValue(MUTATION,3,1,m3)};
  KeyValue entries2[]=new KeyValue[]{createKeyValue(OPEN,0,-1,"2"),createKeyValue(DEFINE_TABLET,1,1,extent),createKeyValue(COMPACTION_START,2,1,"/t1/f12"),createKeyValue(MUTATION,3,1,m4),createKeyValue(MUTATION,3,1,m5)};
  Map<String,KeyValue[]> logs=new TreeMap<String,KeyValue[]>();
  logs.put("entries",entries);
  logs.put("entries2",entries2);
  List<Mutation> mutations=recover(logs,extent);
  Assert.assertEquals(5,mutations.size());
  Assert.assertEquals(m,mutations.get(0));
  Assert.assertEquals(m2,mutations.get(1));
  Assert.assertEquals(m3,mutations.get(2));
  Assert.assertEquals(m4,mutations.get(3));
  Assert.assertEquals(m5,mutations.get(4));
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBug2() throws IOException {
  Mutation ignored=new ServerMutation(new Text("ignored"));
  ignored.put(cf,cq,value);
  Mutation m=new ServerMutation(new Text("row1"));
  m.put(cf,cq,value);
  Mutation m2=new ServerMutation(new Text("row2"));
  m2.put(cf,cq,value);
  Mutation m3=new ServerMutation(new Text("row3"));
  m3.put(cf,cq,value);
  KeyValue entries[]=new KeyValue[]{createKeyValue(OPEN,0,-1,"1"),createKeyValue(DEFINE_TABLET,1,1,extent),createKeyValue(COMPACTION_START,2,1,"/t1/f1"),createKeyValue(COMPACTION_FINISH,4,1,null),createKeyValue(MUTATION,3,1,m)};
  KeyValue entries2[]=new KeyValue[]{createKeyValue(OPEN,5,-1,"1"),createKeyValue(DEFINE_TABLET,6,1,extent),createKeyValue(COMPACTION_START,8,1,"/t1/f1"),createKeyValue(MUTATION,7,1,m2),createKeyValue(MUTATION,9,1,m3)};
  Map<String,KeyValue[]> logs=new TreeMap<String,KeyValue[]>();
  logs.put("entries",entries);
  logs.put("entries2",entries2);
  List<Mutation> mutations=recover(logs,extent);
  Assert.assertEquals(3,mutations.size());
  Assert.assertEquals(m,mutations.get(0));
  Assert.assertEquals(m2,mutations.get(1));
  Assert.assertEquals(m3,mutations.get(2));
}

</code></pre>

<br>
<pre class="type-9 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNoFinish0() throws Exception {
  Mutation ignored=new ServerMutation(new Text("row1"));
  ignored.put("foo","bar","v1");
  KeyValue entries[]=new KeyValue[]{createKeyValue(OPEN,0,-1,"1"),createKeyValue(DEFINE_TABLET,1,2,extent),createKeyValue(MUTATION,2,2,ignored),createKeyValue(COMPACTION_START,3,2,"/t/f1")};
  Arrays.sort(entries);
  Map<String,KeyValue[]> logs=new TreeMap<String,KeyValue[]>();
  logs.put("entries",entries);
  List<Mutation> mutations=recover(logs,Collections.singleton("/t/f1"),extent);
  Assert.assertEquals(0,mutations.size());
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCompactionCrossesLogs() throws IOException {
  Mutation ignored=new ServerMutation(new Text("ignored"));
  ignored.put(cf,cq,value);
  Mutation m=new ServerMutation(new Text("row1"));
  m.put(cf,cq,value);
  Mutation m2=new ServerMutation(new Text("row2"));
  m2.put(cf,cq,value);
  KeyValue entries[]=new KeyValue[]{createKeyValue(OPEN,0,1,"2"),createKeyValue(DEFINE_TABLET,1,1,extent),createKeyValue(COMPACTION_START,3,1,"/t1/f1"),createKeyValue(MUTATION,2,1,ignored),createKeyValue(MUTATION,4,1,ignored)};
  KeyValue entries2[]=new KeyValue[]{createKeyValue(OPEN,0,1,"2"),createKeyValue(DEFINE_TABLET,1,1,extent),createKeyValue(COMPACTION_START,4,1,"/t1/f1"),createKeyValue(MUTATION,7,1,m)};
  KeyValue entries3[]=new KeyValue[]{createKeyValue(OPEN,0,2,"23"),createKeyValue(DEFINE_TABLET,1,2,extent),createKeyValue(COMPACTION_START,5,2,"/t1/f2"),createKeyValue(COMPACTION_FINISH,6,2,null),createKeyValue(MUTATION,3,2,ignored),createKeyValue(MUTATION,4,2,ignored)};
  KeyValue entries4[]=new KeyValue[]{createKeyValue(OPEN,0,3,"69"),createKeyValue(DEFINE_TABLET,1,3,extent),createKeyValue(MUTATION,2,3,ignored),createKeyValue(MUTATION,3,3,ignored),createKeyValue(MUTATION,4,3,ignored)};
  KeyValue entries5[]=new KeyValue[]{createKeyValue(OPEN,0,4,"70"),createKeyValue(DEFINE_TABLET,1,4,extent),createKeyValue(COMPACTION_START,3,4,"/t1/f3"),createKeyValue(MUTATION,2,4,ignored),createKeyValue(MUTATION,6,4,m2)};
  Map<String,KeyValue[]> logs=new TreeMap<String,KeyValue[]>();
  logs.put("entries",entries);
  logs.put("entries2",entries2);
  logs.put("entries3",entries3);
  logs.put("entries4",entries4);
  logs.put("entries5",entries5);
  List<Mutation> mutations=recover(logs,extent);
  Assert.assertEquals(2,mutations.size());
  Assert.assertEquals(m,mutations.get(0));
  Assert.assertEquals(m2,mutations.get(1));
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDoubleFinish() throws IOException {
  Mutation ignored=new ServerMutation(new Text("ignored"));
  ignored.put(cf,cq,value);
  Mutation m=new ServerMutation(new Text("row1"));
  m.put(cf,cq,value);
  Mutation m2=new ServerMutation(new Text("row2"));
  m2.put(cf,cq,new Value("123".getBytes()));
  KeyValue entries[]=new KeyValue[]{createKeyValue(OPEN,0,-1,"1"),createKeyValue(DEFINE_TABLET,1,1,extent),createKeyValue(COMPACTION_FINISH,2,1,null),createKeyValue(COMPACTION_START,4,1,"/t1/f1"),createKeyValue(COMPACTION_FINISH,6,1,null),createKeyValue(MUTATION,3,1,ignored),createKeyValue(MUTATION,5,1,m),createKeyValue(MUTATION,7,1,m2)};
  Map<String,KeyValue[]> logs=new TreeMap<String,KeyValue[]>();
  logs.put("entries",entries);
  List<Mutation> mutations=recover(logs,extent);
  Assert.assertEquals(2,mutations.size());
  Assert.assertEquals(m,mutations.get(0));
  Assert.assertEquals(m2,mutations.get(1));
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCompactionCrossesLogs4() throws IOException {
  Mutation ignored=new ServerMutation(new Text("ignored"));
  ignored.put(cf,cq,value);
  Mutation m=new ServerMutation(new Text("row1"));
  m.put(cf,cq,value);
  Mutation m2=new ServerMutation(new Text("row2"));
  m2.put(cf,cq,value);
  Mutation m3=new ServerMutation(new Text("row3"));
  m3.put(cf,cq,value);
  Mutation m4=new ServerMutation(new Text("row4"));
  m4.put(cf,cq,value);
  Mutation m5=new ServerMutation(new Text("row5"));
  m5.put(cf,cq,value);
  Mutation m6=new ServerMutation(new Text("row6"));
  m6.put(cf,cq,value);
  KeyValue entries[]=new KeyValue[]{createKeyValue(OPEN,0,-1,"1"),createKeyValue(DEFINE_TABLET,1,1,extent),createKeyValue(COMPACTION_START,4,1,"/t1/f1"),createKeyValue(MUTATION,2,1,m),createKeyValue(MUTATION,3,1,m2)};
  KeyValue entries2[]=new KeyValue[]{createKeyValue(OPEN,5,-1,"2"),createKeyValue(DEFINE_TABLET,6,1,extent),createKeyValue(MUTATION,7,1,m3),createKeyValue(MUTATION,8,1,m4)};
  KeyValue entries3[]=new KeyValue[]{createKeyValue(OPEN,9,-1,"3"),createKeyValue(DEFINE_TABLET,10,1,extent),createKeyValue(COMPACTION_START,12,1,"/t1/f1"),createKeyValue(MUTATION,8,1,m5),createKeyValue(MUTATION,20,1,m6)};
  Map<String,KeyValue[]> logs=new TreeMap<String,KeyValue[]>();
  logs.put("entries",entries);
  logs.put("entries2",entries2);
  logs.put("entries3",entries3);
  List<Mutation> mutations=recover(logs,extent);
  Assert.assertEquals(6,mutations.size());
  Assert.assertEquals(m,mutations.get(0));
  Assert.assertEquals(m2,mutations.get(1));
  Assert.assertEquals(m3,mutations.get(2));
  Assert.assertEquals(m4,mutations.get(3));
  Assert.assertEquals(m5,mutations.get(4));
  Assert.assertEquals(m6,mutations.get(5));
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMultipleTabletDefinition() throws Exception {
  Mutation ignored=new ServerMutation(new Text("row1"));
  ignored.put("foo","bar","v1");
  Mutation m=new ServerMutation(new Text("row1"));
  m.put("foo","bar","v1");
  KeyValue entries[]=new KeyValue[]{createKeyValue(OPEN,0,-1,"1"),createKeyValue(DEFINE_TABLET,1,1,extent),createKeyValue(DEFINE_TABLET,1,2,extent),createKeyValue(MUTATION,2,2,ignored),createKeyValue(COMPACTION_START,3,2,"/t1/f1"),createKeyValue(MUTATION,4,2,m),createKeyValue(COMPACTION_FINISH,6,2,null)};
  Arrays.sort(entries);
  Map<String,KeyValue[]> logs=new TreeMap<String,KeyValue[]>();
  logs.put("entries",entries);
  List<Mutation> mutations=recover(logs,extent);
  Assert.assertEquals(1,mutations.size());
  Assert.assertEquals(m,mutations.get(0));
}

</code></pre>

<br>
<pre class="type-9 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBug1() throws IOException {
  Mutation m1=new ServerMutation(new Text("row1"));
  m1.put(cf,cq,value);
  Mutation m2=new ServerMutation(new Text("row2"));
  m2.put(cf,cq,value);
  KeyValue entries[]=new KeyValue[]{createKeyValue(OPEN,0,-1,"1"),createKeyValue(DEFINE_TABLET,1,1,extent),createKeyValue(COMPACTION_START,30,1,"/t1/f1"),createKeyValue(COMPACTION_FINISH,32,1,"/t1/f1"),createKeyValue(MUTATION,29,1,m1),createKeyValue(MUTATION,30,1,m2)};
  Map<String,KeyValue[]> logs=new TreeMap<String,KeyValue[]>();
  logs.put("testlog",entries);
  List<Mutation> mutations=recover(logs,extent);
  Assert.assertEquals(0,mutations.size());
}

</code></pre>

<br>
<pre class="type-9 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testEmpty() throws IOException {
  KeyValue entries[]=new KeyValue[]{createKeyValue(OPEN,0,-1,"1"),createKeyValue(DEFINE_TABLET,1,1,extent)};
  Map<String,KeyValue[]> logs=new TreeMap<String,KeyValue[]>();
  logs.put("testlog",entries);
  List<Mutation> mutations=recover(logs,extent);
  Assert.assertEquals(0,mutations.size());
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSimple() throws IOException {
  Mutation m=new ServerMutation(new Text("row1"));
  m.put(cf,cq,value);
  KeyValue entries[]=new KeyValue[]{createKeyValue(OPEN,0,-1,"1"),createKeyValue(DEFINE_TABLET,1,1,extent),createKeyValue(MUTATION,2,1,m)};
  Map<String,KeyValue[]> logs=new TreeMap<String,KeyValue[]>();
  logs.put("testlog",entries);
  List<Mutation> mutations=recover(logs,extent);
  Assert.assertEquals(1,mutations.size());
  Assert.assertEquals(m,mutations.get(0));
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNoFinish1() throws Exception {
  Mutation ignored=new ServerMutation(new Text("row1"));
  ignored.put("foo","bar","v1");
  Mutation m=new ServerMutation(new Text("row1"));
  m.put("foo","bar","v2");
  KeyValue entries[]=new KeyValue[]{createKeyValue(OPEN,0,-1,"1"),createKeyValue(DEFINE_TABLET,1,2,extent),createKeyValue(MUTATION,2,2,ignored),createKeyValue(COMPACTION_START,3,2,"/t/f1"),createKeyValue(MUTATION,4,2,m)};
  Arrays.sort(entries);
  Map<String,KeyValue[]> logs=new TreeMap<String,KeyValue[]>();
  logs.put("entries",entries);
  List<Mutation> mutations=recover(logs,Collections.singleton("/t/f1"),extent);
  Assert.assertEquals(1,mutations.size());
  Assert.assertEquals(m,mutations.get(0));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.accumulo.tserver.replication.AccumuloReplicaSystemTest </h4><pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void restartInFileKnowsAboutPreviousTableDefines() throws Exception {
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  DataOutputStream dos=new DataOutputStream(baos);
  LogFileKey key=new LogFileKey();
  LogFileValue value=new LogFileValue();
  key.seq=1l;
  key.event=LogEvents.DEFINE_TABLET;
  key.tablet=new KeyExtent(new Text("1"),null,null);
  key.tid=1;
  key.write(dos);
  value.write(dos);
  key.tablet=null;
  key.event=LogEvents.MUTATION;
  key.filename="/accumulo/wals/tserver+port/" + UUID.randomUUID();
  value.mutations=Arrays.<Mutation>asList(new ServerMutation(new Text("row")));
  key.write(dos);
  value.write(dos);
  key.tablet=null;
  key.event=LogEvents.MUTATION;
  key.tid=1;
  key.filename="/accumulo/wals/tserver+port/" + UUID.randomUUID();
  value.mutations=Arrays.<Mutation>asList(new ServerMutation(new Text("row")));
  key.write(dos);
  value.write(dos);
  dos.close();
  Map<String,String> confMap=new HashMap<>();
  confMap.put(Property.REPLICATION_NAME.getKey(),"source");
  AccumuloConfiguration conf=new ConfigurationCopy(confMap);
  AccumuloReplicaSystem ars=new AccumuloReplicaSystem();
  ars.setConf(conf);
  Status status=Status.newBuilder().setBegin(0).setEnd(0).setInfiniteEnd(true).setClosed(false).build();
  DataInputStream dis=new DataInputStream(new ByteArrayInputStream(baos.toByteArray()));
  HashSet<Integer> tids=new HashSet<>();
  WalReplication repl=ars.getWalEdits(new ReplicationTarget("peer","1","1"),dis,new Path("/accumulo/wals/tserver+port/wal"),status,1l,tids);
  Assert.assertEquals(2,repl.entriesConsumed);
  Assert.assertEquals(1,repl.walEdits.getEditsSize());
  Assert.assertEquals(1,repl.sizeInRecords);
  Assert.assertNotEquals(0,repl.sizeInBytes);
  status=Status.newBuilder(status).setBegin(2).build();
  repl=ars.getWalEdits(new ReplicationTarget("peer","1","1"),dis,new Path("/accumulo/wals/tserver+port/wal"),status,1l,tids);
  Assert.assertEquals(1,repl.entriesConsumed);
  Assert.assertEquals(1,repl.walEdits.getEditsSize());
  Assert.assertEquals(1,repl.sizeInRecords);
  Assert.assertNotEquals(0,repl.sizeInBytes);
}

</code></pre>

<br>
<pre class="type-9 type-5 type-3 type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void mutationsNotReReplicatedToPeers() throws Exception {
  AccumuloReplicaSystem ars=new AccumuloReplicaSystem();
  Map<String,String> confMap=new HashMap<>();
  confMap.put(Property.REPLICATION_NAME.getKey(),"source");
  AccumuloConfiguration conf=new ConfigurationCopy(confMap);
  ars.setConf(conf);
  LogFileValue value=new LogFileValue();
  value.mutations=new ArrayList<>();
  Mutation m=new Mutation("row");
  m.put("","",new Value(new byte[0]));
  value.mutations.add(m);
  m=new Mutation("row2");
  m.put("","",new Value(new byte[0]));
  m.addReplicationSource("peer");
  value.mutations.add(m);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  DataOutputStream out=new DataOutputStream(baos);
  ars.writeValueAvoidingReplicationCycles(out,value,new ReplicationTarget("peer","1","1"));
  out.close();
  ByteArrayInputStream bais=new ByteArrayInputStream(baos.toByteArray());
  DataInputStream in=new DataInputStream(bais);
  int numMutations=in.readInt();
  Assert.assertEquals(1,numMutations);
  m=new Mutation();
  m.readFields(in);
  Assert.assertEquals("row",new String(m.getRow()));
  Assert.assertEquals(1,m.getReplicationSources().size());
  Assert.assertTrue("Expected source cluster to be listed in mutation replication source",m.getReplicationSources().contains("source"));
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void onlyChooseMutationsForDesiredTableWithClosedStatus() throws Exception {
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  DataOutputStream dos=new DataOutputStream(baos);
  LogFileKey key=new LogFileKey();
  LogFileValue value=new LogFileValue();
  key.seq=1l;
  key.event=LogEvents.DEFINE_TABLET;
  key.tablet=new KeyExtent(new Text("1"),null,null);
  key.tid=1;
  key.write(dos);
  value.write(dos);
  key.tablet=null;
  key.event=LogEvents.MUTATION;
  key.filename="/accumulo/wals/tserver+port/" + UUID.randomUUID();
  value.mutations=Arrays.<Mutation>asList(new ServerMutation(new Text("row")));
  key.write(dos);
  value.write(dos);
  key.event=LogEvents.DEFINE_TABLET;
  key.tablet=new KeyExtent(new Text("2"),null,null);
  key.tid=2;
  value.mutations=Collections.emptyList();
  key.write(dos);
  value.write(dos);
  key.event=LogEvents.OPEN;
  key.tid=LogFileKey.VERSION;
  key.tserverSession="foobar";
  key.write(dos);
  value.write(dos);
  key.tablet=null;
  key.event=LogEvents.MUTATION;
  key.filename="/accumulo/wals/tserver+port/" + UUID.randomUUID();
  value.mutations=Arrays.<Mutation>asList(new ServerMutation(new Text("badrow")));
  key.write(dos);
  value.write(dos);
  key.event=LogEvents.COMPACTION_START;
  key.tid=2;
  key.filename="/accumulo/tables/1/t-000001/A000001.rf";
  value.mutations=Collections.emptyList();
  key.write(dos);
  value.write(dos);
  key.event=LogEvents.DEFINE_TABLET;
  key.tablet=new KeyExtent(new Text("1"),null,null);
  key.tid=3;
  value.mutations=Collections.emptyList();
  key.write(dos);
  value.write(dos);
  key.event=LogEvents.COMPACTION_FINISH;
  key.tid=6;
  value.mutations=Collections.emptyList();
  key.write(dos);
  value.write(dos);
  key.tablet=null;
  key.event=LogEvents.MUTATION;
  key.tid=3;
  key.filename="/accumulo/wals/tserver+port/" + UUID.randomUUID();
  value.mutations=Arrays.<Mutation>asList(new ServerMutation(new Text("row")));
  key.write(dos);
  value.write(dos);
  dos.close();
  Map<String,String> confMap=new HashMap<>();
  confMap.put(Property.REPLICATION_NAME.getKey(),"source");
  AccumuloConfiguration conf=new ConfigurationCopy(confMap);
  AccumuloReplicaSystem ars=new AccumuloReplicaSystem();
  ars.setConf(conf);
  Status status=Status.newBuilder().setBegin(0).setEnd(0).setInfiniteEnd(true).setClosed(true).build();
  DataInputStream dis=new DataInputStream(new ByteArrayInputStream(baos.toByteArray()));
  WalReplication repl=ars.getWalEdits(new ReplicationTarget("peer","1","1"),dis,new Path("/accumulo/wals/tserver+port/wal"),status,Long.MAX_VALUE,new HashSet<Integer>());
  Assert.assertEquals(Long.MAX_VALUE,repl.entriesConsumed);
  Assert.assertEquals(2,repl.walEdits.getEditsSize());
  Assert.assertEquals(2,repl.sizeInRecords);
  Assert.assertNotEquals(0,repl.sizeInBytes);
}

</code></pre>

<br>
<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void onlyChooseMutationsForDesiredTableWithOpenStatus() throws Exception {
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  DataOutputStream dos=new DataOutputStream(baos);
  LogFileKey key=new LogFileKey();
  LogFileValue value=new LogFileValue();
  key.seq=1l;
  key.event=LogEvents.DEFINE_TABLET;
  key.tablet=new KeyExtent(new Text("1"),null,null);
  key.tid=1;
  key.write(dos);
  value.write(dos);
  key.tablet=null;
  key.event=LogEvents.MUTATION;
  key.filename="/accumulo/wals/tserver+port/" + UUID.randomUUID();
  value.mutations=Arrays.<Mutation>asList(new ServerMutation(new Text("row")));
  key.write(dos);
  value.write(dos);
  key.event=LogEvents.DEFINE_TABLET;
  key.tablet=new KeyExtent(new Text("2"),null,null);
  key.tid=2;
  value.mutations=Collections.emptyList();
  key.write(dos);
  value.write(dos);
  key.event=LogEvents.OPEN;
  key.tid=LogFileKey.VERSION;
  key.tserverSession="foobar";
  key.write(dos);
  value.write(dos);
  key.tablet=null;
  key.event=LogEvents.MUTATION;
  key.filename="/accumulo/wals/tserver+port/" + UUID.randomUUID();
  value.mutations=Arrays.<Mutation>asList(new ServerMutation(new Text("badrow")));
  key.write(dos);
  value.write(dos);
  key.event=LogEvents.COMPACTION_START;
  key.tid=2;
  key.filename="/accumulo/tables/1/t-000001/A000001.rf";
  value.mutations=Collections.emptyList();
  key.write(dos);
  value.write(dos);
  key.event=LogEvents.DEFINE_TABLET;
  key.tablet=new KeyExtent(new Text("1"),null,null);
  key.tid=3;
  value.mutations=Collections.emptyList();
  key.write(dos);
  value.write(dos);
  key.event=LogEvents.COMPACTION_FINISH;
  key.tid=6;
  value.mutations=Collections.emptyList();
  key.write(dos);
  value.write(dos);
  key.tablet=null;
  key.event=LogEvents.MUTATION;
  key.tid=3;
  key.filename="/accumulo/wals/tserver+port/" + UUID.randomUUID();
  value.mutations=Arrays.<Mutation>asList(new ServerMutation(new Text("row")));
  key.write(dos);
  value.write(dos);
  dos.close();
  Map<String,String> confMap=new HashMap<>();
  confMap.put(Property.REPLICATION_NAME.getKey(),"source");
  AccumuloConfiguration conf=new ConfigurationCopy(confMap);
  AccumuloReplicaSystem ars=new AccumuloReplicaSystem();
  ars.setConf(conf);
  Status status=Status.newBuilder().setBegin(0).setEnd(0).setInfiniteEnd(true).setClosed(false).build();
  DataInputStream dis=new DataInputStream(new ByteArrayInputStream(baos.toByteArray()));
  WalReplication repl=ars.getWalEdits(new ReplicationTarget("peer","1","1"),dis,new Path("/accumulo/wals/tserver+port/wal"),status,Long.MAX_VALUE,new HashSet<Integer>());
  Assert.assertEquals(9,repl.entriesConsumed);
  Assert.assertEquals(2,repl.walEdits.getEditsSize());
  Assert.assertEquals(2,repl.sizeInRecords);
  Assert.assertNotEquals(0,repl.sizeInBytes);
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
