<h3 style="margin:0px">Class: org.apache.accumulo.core.file.rfile.RelativeKeyTest (7 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="2"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('2')" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value "><kbd id="tag-2"class="label-info"style="display: inline-block;font-size:7pt" >EqualityVerifier&nbsp;(5)</kbd></button>&nbsp;<button id="3"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('3')" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls"><kbd id="tag-3"class="label-info"style="display: inline-block;font-size:7pt" >InternalCallVerifier&nbsp;(3)</kbd></button>&nbsp;<button id="9"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('9')" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) "><kbd id="tag-9"class="label-info"style="display: inline-block;font-size:7pt" >APIUtilityVerifier&nbsp;(2)</kbd></button>&nbsp;<button id="1"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('1')" data-toggle="tooltip" title="Executes methods or other tests from the same test unit"><kbd id="tag-1"class="label-info"style="display: inline-block;font-size:7pt" >ExecutionTester&nbsp;(1)</kbd></button>&nbsp;<button id="10"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('10')" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution"><kbd id="tag-10"class="label-info"style="display: inline-block;font-size:7pt" >ExceptionVerifier&nbsp;(1)</kbd></button>&nbsp;<button id="4"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('4')" data-toggle="tooltip" title="Allocates resources before the execution of the test cases"><kbd id="tag-4"class="label-info"style="display: inline-block;font-size:7pt" >TestInitializer&nbsp;(1)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReadWritePrefix() throws IOException {
  Key prevKey=new Key("row1","columnfamily1","columnqualifier1","columnvisibility1",1000);
  Key newKey=new Key("row2","columnfamily2","columnqualifier2","columnvisibility2",3000);
  RelativeKey expected=new RelativeKey(prevKey,newKey);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  DataOutputStream out=new DataOutputStream(baos);
  expected.write(out);
  RelativeKey actual=new RelativeKey();
  actual.setPrevKey(prevKey);
  actual.readFields(new DataInputStream(new ByteArrayInputStream(baos.toByteArray())));
  assertEquals(expected.getKey(),actual.getKey());
}

</code></pre>

<pre class="type-10 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=EOFException.class) public void testSeekAfterEverything() throws IOException {
  Key seekKey=new Key("s","t","u","v",1);
  Key prevKey=new Key();
  Key currKey=null;
  MutableByteSequence value=new MutableByteSequence(new byte[64],0,0);
  RelativeKey.fastSkip(in,seekKey,value,prevKey,currKey);
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBasicRelativeKey(){
  assertEquals(1,UnsynchronizedBuffer.nextArraySize(0));
  assertEquals(1,UnsynchronizedBuffer.nextArraySize(1));
  assertEquals(2,UnsynchronizedBuffer.nextArraySize(2));
  assertEquals(4,UnsynchronizedBuffer.nextArraySize(3));
  assertEquals(4,UnsynchronizedBuffer.nextArraySize(4));
  assertEquals(8,UnsynchronizedBuffer.nextArraySize(5));
  assertEquals(8,UnsynchronizedBuffer.nextArraySize(8));
  assertEquals(16,UnsynchronizedBuffer.nextArraySize(9));
  assertEquals(1 << 16,UnsynchronizedBuffer.nextArraySize((1 << 16) - 1));
  assertEquals(1 << 16,UnsynchronizedBuffer.nextArraySize(1 << 16));
  assertEquals(1 << 17,UnsynchronizedBuffer.nextArraySize((1 << 16) + 1));
  assertEquals(1 << 30,UnsynchronizedBuffer.nextArraySize((1 << 30) - 1));
  assertEquals(1 << 30,UnsynchronizedBuffer.nextArraySize(1 << 30));
  assertEquals(Integer.MAX_VALUE,UnsynchronizedBuffer.nextArraySize(Integer.MAX_VALUE - 1));
  assertEquals(Integer.MAX_VALUE,UnsynchronizedBuffer.nextArraySize(Integer.MAX_VALUE));
}

</code></pre>

<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSeekMiddle() throws IOException {
  int seekIndex=expectedKeys.size() / 2;
  Key seekKey=expectedKeys.get(seekIndex);
  Key prevKey=new Key();
  Key currKey=null;
  MutableByteSequence value=new MutableByteSequence(new byte[64],0,0);
  RelativeKey.SkippR skippr=RelativeKey.fastSkip(in,seekKey,value,prevKey,currKey);
  assertEquals(seekIndex + 1,skippr.skipped);
  assertEquals(expectedKeys.get(seekIndex - 1),skippr.prevKey);
  assertEquals(expectedKeys.get(seekIndex),skippr.rk.getKey());
  assertEquals(expectedValues.get(seekIndex).toString(),value.toString());
  skippr.rk.readFields(in);
  assertEquals(expectedValues.get(seekIndex + 1).toString(),value.toString());
  in.reset();
  Key fKey=expectedKeys.get(seekIndex).followingKey(PartialKey.ROW_COLFAM_COLQUAL);
  int i;
  for (i=seekIndex; expectedKeys.get(i).compareTo(fKey) < 0; i++) {
  }
  skippr=RelativeKey.fastSkip(in,expectedKeys.get(i),value,prevKey,currKey);
  assertEquals(i + 1,skippr.skipped);
  assertEquals(expectedKeys.get(i - 1),skippr.prevKey);
  assertEquals(expectedKeys.get(i),skippr.rk.getKey());
  assertEquals(expectedValues.get(i).toString(),value.toString());
  skippr=RelativeKey.fastSkip(in,expectedKeys.get(i),value,expectedKeys.get(i - 1),expectedKeys.get(i));
  assertEquals(0,skippr.skipped);
  assertEquals(expectedKeys.get(i - 1),skippr.prevKey);
  assertEquals(expectedKeys.get(i),skippr.rk.getKey());
  assertEquals(expectedValues.get(i).toString(),value.toString());
  fKey=expectedKeys.get(i).followingKey(PartialKey.ROW_COLFAM);
  int j;
  for (j=i; expectedKeys.get(j).compareTo(fKey) < 0; j++) {
  }
  skippr=RelativeKey.fastSkip(in,fKey,value,expectedKeys.get(i - 1),expectedKeys.get(i));
  assertEquals(j - i,skippr.skipped);
  assertEquals(expectedKeys.get(j - 1),skippr.prevKey);
  assertEquals(expectedKeys.get(j),skippr.rk.getKey());
  assertEquals(expectedValues.get(j).toString(),value.toString());
}

</code></pre>

<pre class="type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
"></span><br>
@Before public void setupDataInputStream(){
  in=new DataInputStream(new ByteArrayInputStream(baos.toByteArray()));
  in.mark(0);
}

</code></pre>

<pre class="type-9 type-3 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSeekBeforeEverything() throws IOException {
  Key seekKey=new Key();
  Key prevKey=new Key();
  Key currKey=null;
  MutableByteSequence value=new MutableByteSequence(new byte[64],0,0);
  RelativeKey.SkippR skippr=RelativeKey.fastSkip(in,seekKey,value,prevKey,currKey);
  assertEquals(1,skippr.skipped);
  assertEquals(new Key(),skippr.prevKey);
  assertEquals(expectedKeys.get(0),skippr.rk.getKey());
  assertEquals(expectedValues.get(0).toString(),value.toString());
  skippr.rk.readFields(in);
  assertEquals(expectedKeys.get(1),skippr.rk.getKey());
  in.reset();
  seekKey=new Key("a","b","c","d",1);
  seekKey.setDeleted(true);
  skippr=RelativeKey.fastSkip(in,seekKey,value,prevKey,currKey);
  assertEquals(1,skippr.skipped);
  assertEquals(new Key(),skippr.prevKey);
  assertEquals(expectedKeys.get(0),skippr.rk.getKey());
  assertEquals(expectedValues.get(0).toString(),value.toString());
  skippr.rk.readFields(in);
  assertEquals(expectedKeys.get(1),skippr.rk.getKey());
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCommonPrefix(){
  ArrayByteSequence exact=new ArrayByteSequence("abc");
  assertEquals(-1,RelativeKey.getCommonPrefix(exact,exact));
  assertEquals(-1,commonPrefixHelper("",""));
  assertEquals(-1,commonPrefixHelper("a","a"));
  assertEquals(-1,commonPrefixHelper("aa","aa"));
  assertEquals(-1,commonPrefixHelper("aaa","aaa"));
  assertEquals(-1,commonPrefixHelper("abab","abab"));
  assertEquals(-1,commonPrefixHelper(new String("aaa"),new ArrayByteSequence("aaa").toString()));
  assertEquals(-1,commonPrefixHelper("abababababab".substring(3,6),"ccababababcc".substring(3,6)));
  assertEquals(0,commonPrefixHelper("","a"));
  assertEquals(0,commonPrefixHelper("a",""));
  assertEquals(0,commonPrefixHelper("a","b"));
  assertEquals(0,commonPrefixHelper("aaaa","bbbb"));
  assertEquals(1,commonPrefixHelper("a","ab"));
  assertEquals(1,commonPrefixHelper("ab","ac"));
  assertEquals(1,commonPrefixHelper("ab","ac"));
  assertEquals(2,commonPrefixHelper("aa","aaaa"));
  assertEquals(4,commonPrefixHelper("aaaaa","aaaab"));
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
