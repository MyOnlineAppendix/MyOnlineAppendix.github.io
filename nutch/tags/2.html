<h3><span class=" glyphicon glyphicon-tag"/>&nbspUtilityVerifier</h3><kbd>Verifies (un)successful execution of the test case by reporting explicitly a failure</kbd><br><br><br><h4 style="margin:0px">Class: org.apache.nutch.analysis.lang.TestHTMLLanguageParser </h4><pre class="type-4 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test parsing of language identifiers from html
 */
@Test public void testMetaHTMLParsing(){
  try {
    ParseUtil parser=new ParseUtil(NutchConfiguration.create());
    for (int t=0; t < docs.length; t++) {
      Content content=getContent(docs[t]);
      Parse parse=parser.parse(content).get(content.getUrl());
      Assert.assertEquals(metalanguages[t],(String)parse.getData().getParseMeta().get(Metadata.LANGUAGE));
    }
  }
 catch (  Exception e) {
    e.printStackTrace(System.out);
    Assert.fail(e.toString());
  }
}

</code></pre>

<br>
<pre class="type-6 type-4 type-7 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLanguageIndentifier(){
  try {
    long total=0;
    LanguageIdentifier identifier;
    BufferedReader in=new BufferedReader(new InputStreamReader(this.getClass().getResourceAsStream("test-referencial.txt")));
    String line=null;
    while ((line=in.readLine()) != null) {
      String[] tokens=line.split(";");
      if (!tokens[0].equals("")) {
        StringBuilder content=new StringBuilder();
        BufferedReader testFile=new BufferedReader(new InputStreamReader(this.getClass().getResourceAsStream(tokens[0]),"UTF-8"));
        String testLine=null, lang=null;
        while ((testLine=testFile.readLine()) != null) {
          content.append(testLine + "\n");
          testLine=testLine.trim();
          if (testLine.length() > 256) {
            identifier=new LanguageIdentifier(testLine);
            lang=identifier.getLanguage();
            Assert.assertEquals(tokens[1],lang);
          }
        }
        testFile.close();
        long start=System.currentTimeMillis();
        System.out.println(content.toString());
        identifier=new LanguageIdentifier(content.toString());
        lang=identifier.getLanguage();
        System.out.println(lang);
        total+=System.currentTimeMillis() - start;
        Assert.assertEquals(tokens[1],lang);
      }
    }
    in.close();
    System.out.println("Total Time=" + total);
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail(e.toString());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.nutch.crawl.TODOTestCrawlDbStates </h4><pre class="type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * NUTCH-578: a fetch_retry should result in a db_gone if db.fetch.retry.max
 * is reached. Retry counter has to be reset appropriately.
 */
@Test public void testCrawlDbReducerPageRetrySchedule(){
  LOG.info("NUTCH-578: test long running continuous crawl with fetch_retry");
  ContinuousCrawlTestUtil crawlUtil=new ContinuousCrawlTestFetchRetry();
  if (!crawlUtil.run(150)) {
    fail("fetch_retry did not result in a db_gone if retry counter > maxRetries (NUTCH-578)");
  }
}

</code></pre>

<br>
<pre class="type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * NUTCH-1564 AdaptiveFetchSchedule: sync_delta forces immediate re-fetch for
 * documents not modified
 * <p>
 * Problem: documents not modified for a longer time are fetched in every
 * cycle because of an error in the SYNC_DELTA calculation of{@link AdaptiveFetchSchedule}. <br>
 * The next fetch time should always be in the future, never in the past.
 * </p>
 */
@Test public void testAdaptiveFetchScheduleSyncDelta(){
  LOG.info("NUTCH-1564 test SYNC_DELTA calculation of AdaptiveFetchSchedule");
  Configuration conf=CrawlDBTestUtil.createConfiguration();
  conf.setLong("db.fetch.interval.default",172800);
  conf.setLong("db.fetch.schedule.adaptive.min_interval",86400);
  conf.setLong("db.fetch.schedule.adaptive.max_interval",604800);
  conf.setLong("db.fetch.interval.max",604800);
  conf.set("db.fetch.schedule.class","org.apache.nutch.crawl.AdaptiveFetchSchedule");
  ContinuousCrawlTestUtil crawlUtil=new CrawlTestFetchScheduleNotModifiedFetchTime(conf);
  crawlUtil.setInterval(FetchSchedule.SECONDS_PER_DAY / 3);
  if (!crawlUtil.run(100)) {
    fail("failed: sync_delta calculation with AdaptiveFetchSchedule");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.nutch.crawl.TestCrawlDbStates </h4><pre class="type-6 type-4 type-7 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
"></span><br>
/** 
 * Test the matrix of state transitions:
 * <ul>
 * <li>for all available {@link FetchSchedule} implementations</li>
 * <li>for every possible status in CrawlDb (including "not in CrawlDb")</li>
 * <li>for every possible fetch status</li>
 * <li>and zero or more (0-3) additional in-links</li>
 * </ul>
 * call {@literal updatedb} and check whether the resulting CrawlDb status is
 * the expected one.
 */
@Test public void testCrawlDbStateTransitionMatrix(){
  LOG.info("Test CrawlDatum state transitions");
  Configuration conf=CrawlDBTestUtil.createConfiguration();
  CrawlDbUpdateUtil<CrawlDbReducer> updateDb=new CrawlDbUpdateUtil<CrawlDbReducer>(new CrawlDbReducer(),conf);
  int retryMax=conf.getInt("db.fetch.retry.max",3);
  for (  String sched : schedules) {
    LOG.info("Testing state transitions with " + sched);
    conf.set("db.fetch.schedule.class","org.apache.nutch.crawl." + sched);
    FetchSchedule schedule=FetchScheduleFactory.getFetchSchedule(new JobConf(conf));
    for (int i=0; i < fetchDbStatusPairs.length; i++) {
      byte fromDbStatus=fetchDbStatusPairs[i][1];
      for (int j=0; j < fetchDbStatusPairs.length; j++) {
        byte fetchStatus=fetchDbStatusPairs[j][0];
        CrawlDatum fromDb=null;
        if (fromDbStatus == -1) {
        }
 else {
          fromDb=new CrawlDatum();
          fromDb.setStatus(fromDbStatus);
          schedule.initializeSchedule(CrawlDbUpdateUtil.dummyURL,fromDb);
        }
        byte toDbStatus=fetchDbStatusPairs[j][1];
        if (fetchStatus == -1) {
          if (fromDbStatus == -1) {
            toDbStatus=STATUS_DB_UNFETCHED;
          }
 else {
            toDbStatus=fromDbStatus;
          }
        }
 else         if (fetchStatus == STATUS_FETCH_RETRY) {
          if (fromDb == null || fromDb.getRetriesSinceFetch() < retryMax) {
            toDbStatus=STATUS_DB_UNFETCHED;
          }
 else {
            toDbStatus=STATUS_DB_GONE;
          }
        }
        String fromDbStatusName=(fromDbStatus == -1 ? "<not in CrawlDb>" : getStatusName(fromDbStatus));
        String fetchStatusName=(fetchStatus == -1 ? "<only inlinks>" : CrawlDatum.getStatusName(fetchStatus));
        LOG.info(fromDbStatusName + " + " + fetchStatusName+ " => "+ getStatusName(toDbStatus));
        List<CrawlDatum> values=new ArrayList<CrawlDatum>();
        for (int l=0; l <= 2; l++) {
          CrawlDatum fetch=null;
          if (fetchStatus == -1) {
            if (l == 0)             continue;
          }
 else {
            fetch=new CrawlDatum();
            if (fromDb != null) {
              fetch.set(fromDb);
            }
 else {
              schedule.initializeSchedule(CrawlDbUpdateUtil.dummyURL,fetch);
            }
            fetch.setStatus(fetchStatus);
            fetch.setFetchTime(System.currentTimeMillis());
          }
          if (fromDb != null)           values.add(fromDb);
          if (fetch != null)           values.add(fetch);
          for (int n=0; n < l; n++) {
            values.add(linked);
          }
          List<CrawlDatum> res=updateDb.update(values);
          if (res.size() != 1) {
            fail("CrawlDb update didn't result in one single CrawlDatum per URL");
            continue;
          }
          byte status=res.get(0).getStatus();
          if (status != toDbStatus) {
            fail("CrawlDb update for " + fromDbStatusName + " and "+ fetchStatusName+ " and "+ l+ " inlinks results in "+ getStatusName(status)+ " (expected: "+ getStatusName(toDbStatus)+ ")");
          }
          values.clear();
        }
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * NUTCH-1245: a fetch_gone should always result in a db_gone.
 * <p>
 * As some kind of misconfiguration set db.fetch.interval.default to a value
 * &gt; (fetchIntervalMax * 1.5).
 * </p>
 */
@Test public void testCrawlDbReducerPageGoneSchedule2(){
  LOG.info("NUTCH-1245 (misconfiguration): test with db.fetch.interval.default > (1.5 * db.fetch.interval.max)");
  Configuration conf=CrawlDBTestUtil.createConfiguration();
  int fetchIntervalMax=conf.getInt("db.fetch.interval.max",0);
  conf.setInt("db.fetch.interval.default",3 + (int)(fetchIntervalMax * 1.5));
  ContinuousCrawlTestUtil crawlUtil=new ContinuousCrawlTestUtil(conf,STATUS_FETCH_GONE,STATUS_DB_GONE);
  if (!crawlUtil.run(0)) {
    fail("fetch_gone did not result in a db_gone (NUTCH-1245)");
  }
}

</code></pre>

<br>
<pre class="type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * NUTCH-1245: a fetch_gone should always result in a db_gone.
 * <p>
 * Even in a long-running continuous crawl, when a gone page is re-fetched
 * several times over time.
 * </p>
 */
@Test public void testCrawlDbReducerPageGoneSchedule1(){
  LOG.info("NUTCH-1245: test long running continuous crawl");
  ContinuousCrawlTestUtil crawlUtil=new ContinuousCrawlTestUtil(STATUS_FETCH_GONE,STATUS_DB_GONE);
  if (!crawlUtil.run(20)) {
    fail("fetch_gone did not result in a db_gone (NUTCH-1245)");
  }
}

</code></pre>

<br>
<pre class="type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * Test status db_notmodified detected by
 * <ul>
 * <li>signature comparison</li>
 * <li>or HTTP 304</li>
 * </ul>
 * In addition, test for all available {@link FetchSchedule} implementations
 * whether
 * <ul>
 * <li>modified time is set</li>
 * <li>re-fetch is triggered after a certain time to force the fetched content
 * to be in a recent segment (old segments are deleted, see comments in{@link CrawlDbReducer#reduce(Text,Iterator,OutputCollector,Reporter)}</li>
 * </ul>
 */
@Test public void testCrawlDbReducerNotModified(){
  LOG.info("Test state notmodified");
  Configuration conf=CrawlDBTestUtil.createConfiguration();
  for (  String sched : schedules) {
    String desc="test notmodified by signature comparison + " + sched;
    LOG.info(desc);
    conf.set("db.fetch.schedule.class","org.apache.nutch.crawl." + sched);
    ContinuousCrawlTestUtil crawlUtil=new CrawlTestFetchNotModified(conf);
    if (!crawlUtil.run(20)) {
      fail("failed: " + desc);
    }
  }
  for (  String sched : schedules) {
    String desc="test notmodified by HTTP 304 + " + sched;
    LOG.info(desc);
    conf.set("db.fetch.schedule.class","org.apache.nutch.crawl." + sched);
    ContinuousCrawlTestUtil crawlUtil=new CrawlTestFetchNotModifiedHttp304(conf);
    if (!crawlUtil.run(20)) {
      fail("failed: " + desc);
    }
  }
}

</code></pre>

<br>
<pre class="type-7 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
/** 
 * Test whether signatures are reset for "content-less" states (gone,
 * redirect, etc.): otherwise, if this state is temporary and the document
 * appears again with the old content, it may get marked as not_modified in
 * CrawlDb just after the redirect state. In this case we cannot expect
 * content in segments. Cf. NUTCH-1422: reset signature for redirects.
 */
@Test public void testSignatureReset(){
  LOG.info("NUTCH-1422 must reset signature for redirects and similar states");
  Configuration conf=CrawlDBTestUtil.createConfiguration();
  for (  String sched : schedules) {
    LOG.info("Testing reset signature with " + sched);
    conf.set("db.fetch.schedule.class","org.apache.nutch.crawl." + sched);
    ContinuousCrawlTestUtil crawlUtil=new CrawlTestSignatureReset(conf);
    if (!crawlUtil.run(20)) {
      fail("failed: signature not reset");
    }
  }
}

</code></pre>

<br>
<pre class="type-6 type-4 type-7 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
"></span><br>
/** 
 * Test states after inject: inject must not modify the status of CrawlDatums
 * already in CrawlDb. Newly injected elements have status "db_unfetched".
 * Inject is simulated by calling {@link Injector.InjectReducer#reduce()}.
 */
@Test public void testCrawlDbStatTransitionInject(){
  LOG.info("Test CrawlDatum states in Injector after inject");
  Configuration conf=CrawlDBTestUtil.createConfiguration();
  CrawlDbUpdateUtil<Injector.InjectReducer> inject=new CrawlDbUpdateUtil<Injector.InjectReducer>(new Injector.InjectReducer(),conf);
  ScoringFilters scfilters=new ScoringFilters(conf);
  for (  String sched : schedules) {
    LOG.info("Testing inject with " + sched);
    conf.set("db.fetch.schedule.class","org.apache.nutch.crawl." + sched);
    FetchSchedule schedule=FetchScheduleFactory.getFetchSchedule(new JobConf(conf));
    List<CrawlDatum> values=new ArrayList<CrawlDatum>();
    for (int i=0; i < fetchDbStatusPairs.length; i++) {
      byte fromDbStatus=fetchDbStatusPairs[i][1];
      byte toDbStatus=fromDbStatus;
      if (fromDbStatus == -1) {
        toDbStatus=STATUS_DB_UNFETCHED;
      }
 else {
        CrawlDatum fromDb=new CrawlDatum();
        fromDb.setStatus(fromDbStatus);
        schedule.initializeSchedule(CrawlDbUpdateUtil.dummyURL,fromDb);
        values.add(fromDb);
      }
      LOG.info("inject " + (fromDbStatus == -1 ? "<not in CrawlDb>" : CrawlDatum.getStatusName(fromDbStatus)) + " + "+ getStatusName(STATUS_INJECTED)+ " => "+ getStatusName(toDbStatus));
      CrawlDatum injected=new CrawlDatum(STATUS_INJECTED,conf.getInt("db.fetch.interval.default",2592000),0.1f);
      schedule.initializeSchedule(CrawlDbUpdateUtil.dummyURL,injected);
      try {
        scfilters.injectedScore(CrawlDbUpdateUtil.dummyURL,injected);
      }
 catch (      ScoringFilterException e) {
        LOG.error(StringUtils.stringifyException(e));
      }
      values.add(injected);
      List<CrawlDatum> res=inject.update(values);
      if (res.size() != 1) {
        fail("Inject didn't result in one single CrawlDatum per URL");
        continue;
      }
      byte status=res.get(0).getStatus();
      if (status != toDbStatus) {
        fail("Inject for " + (fromDbStatus == -1 ? "" : getStatusName(fromDbStatus) + " and ") + getStatusName(STATUS_INJECTED)+ " results in "+ getStatusName(status)+ " (expected: "+ getStatusName(toDbStatus)+ ")");
      }
      values.clear();
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.nutch.indexer.anchor.TestAnchorIndexingFilter </h4><pre class="type-2 type-12 type-5 type-1 type-13 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDeduplicateAnchor() throws Exception {
  Configuration conf=NutchConfiguration.create();
  conf.setBoolean("anchorIndexingFilter.deduplicate",true);
  AnchorIndexingFilter filter=new AnchorIndexingFilter();
  filter.setConf(conf);
  Assert.assertNotNull(filter);
  NutchDocument doc=new NutchDocument();
  ParseImpl parse=new ParseImpl("foo bar",new ParseData());
  Inlinks inlinks=new Inlinks();
  inlinks.add(new Inlink("http://test1.com/","text1"));
  inlinks.add(new Inlink("http://test2.com/","text2"));
  inlinks.add(new Inlink("http://test3.com/","text2"));
  try {
    filter.filter(doc,parse,new Text("http://nutch.apache.org/index.html"),new CrawlDatum(),inlinks);
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail(e.getMessage());
  }
  Assert.assertNotNull(doc);
  Assert.assertTrue("test if there is an anchor at all",doc.getFieldNames().contains("anchor"));
  Assert.assertEquals("test dedup, we expect 2",2,doc.getField("anchor").getValues().size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.nutch.indexer.basic.TestBasicIndexingFilter </h4><pre class="type-2 type-5 type-1 type-13 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBasicIndexingFilter() throws Exception {
  Configuration conf=NutchConfiguration.create();
  conf.setInt("indexer.max.title.length",10);
  conf.setBoolean("indexer.add.domain",true);
  conf.setInt("indexer.max.content.length",20);
  BasicIndexingFilter filter=new BasicIndexingFilter();
  filter.setConf(conf);
  Assert.assertNotNull(filter);
  NutchDocument doc=new NutchDocument();
  String title="The Foo Page";
  Outlink[] outlinks=new Outlink[]{new Outlink("http://foo.com/","Foo")};
  Metadata metaData=new Metadata();
  metaData.add("Language","en/us");
  ParseData parseData=new ParseData(ParseStatus.STATUS_SUCCESS,title,outlinks,metaData);
  ParseImpl parse=new ParseImpl("this is a sample foo bar page. hope you enjoy it.",parseData);
  CrawlDatum crawlDatum=new CrawlDatum();
  crawlDatum.setFetchTime(100L);
  Inlinks inlinks=new Inlinks();
  try {
    filter.filter(doc,parse,new Text("http://nutch.apache.org/index.html"),crawlDatum,inlinks);
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail(e.getMessage());
  }
  Assert.assertNotNull(doc);
  Assert.assertEquals("test title, expect \"The Foo Pa\"","The Foo Pa",doc.getField("title").getValues().get(0));
  Assert.assertEquals("test domain, expect \"apache.org\"","apache.org",doc.getField("domain").getValues().get(0));
  Assert.assertEquals("test host, expect \"nutch.apache.org\"","nutch.apache.org",doc.getField("host").getValues().get(0));
  Assert.assertEquals("test url, expect \"http://nutch.apache.org/index.html\"","http://nutch.apache.org/index.html",doc.getField("url").getValues().get(0));
  Assert.assertEquals("test content","this is a sample foo",doc.getField("content").getValues().get(0));
  Assert.assertEquals("test fetch time",new Date(100L),(Date)doc.getField("tstamp").getValues().get(0));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.nutch.indexer.more.TestMoreIndexingFilter </h4><pre class="type-2 type-12 type-5 type-1 type-13 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @since NUTCH-901
 */
@Test public void testNoParts(){
  Configuration conf=NutchConfiguration.create();
  conf.setBoolean("moreIndexingFilter.indexMimeTypeParts",false);
  MoreIndexingFilter filter=new MoreIndexingFilter();
  filter.setConf(conf);
  Assert.assertNotNull(filter);
  NutchDocument doc=new NutchDocument();
  ParseImpl parse=new ParseImpl("foo bar",new ParseData());
  try {
    filter.filter(doc,parse,new Text("http://nutch.apache.org/index.html"),new CrawlDatum(),new Inlinks());
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail(e.getMessage());
  }
  Assert.assertNotNull(doc);
  Assert.assertTrue(doc.getFieldNames().contains("type"));
  Assert.assertEquals(1,doc.getField("type").getValues().size());
  Assert.assertEquals("text/html",doc.getFieldValue("type"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.nutch.indexer.replace.TestIndexReplace </h4><pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test property parsing.
 * The filter does not expose details of the parse. So all we are checking is
 * that the parse does not throw a runtime exception and that the value
 * provided is the value returned.
 */
@Test public void testPropertyParse(){
  Configuration conf=NutchConfiguration.create();
  String indexReplaceProperty="  metatag.description=/this(.*)plugin/this awesome plugin/2\n" + "  metatag.keywords=/\\,/\\!/\n" + "  hostmatch=.*.com\n"+ "  metatag.keywords=/\\,/\\?/\n"+ "  metatag.author:dc_author=/\\s+/ David /\n"+ "  urlmatch=.*.html\n"+ "  metatag.keywords=/\\,/\\./\n"+ "  metatag.author=/\\s+/ D. /\n";
  conf.set(INDEX_REPLACE_PROPERTY,indexReplaceProperty);
  ReplaceIndexer rp=new ReplaceIndexer();
  try {
    rp.setConf(conf);
  }
 catch (  RuntimeException ohno) {
    Assert.fail("Unable to parse a valid index.replace.regexp property! " + ohno.getMessage());
  }
  Configuration parsedConf=rp.getConf();
  Assert.assertEquals(indexReplaceProperty,parsedConf.get(INDEX_REPLACE_PROPERTY));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.nutch.indexer.staticfield.TestStaticFieldIndexerTest </h4><pre class="type-2 type-12 type-5 type-1 type-13 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test for NUTCH-2052 custom delimiters in index.static.
 * @throws Exception
 */
@Test public void testCustomDelimiters() throws Exception {
  conf.set("index.static.fieldsep",">");
  conf.set("index.static.keysep","=");
  conf.set("index.static.valuesep","|");
  conf.set("index.static","field1=val1>field2    =      val2|val3     >field3>field4 =val4 > ");
  Assert.assertNotNull(filter);
  filter.setConf(conf);
  NutchDocument doc=new NutchDocument();
  try {
    filter.filter(doc,parse,url,crawlDatum,inlinks);
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail(e.getMessage());
  }
  Assert.assertNotNull(doc);
  Assert.assertFalse("test if doc is not empty",doc.getFieldNames().isEmpty());
  Assert.assertEquals("test if doc has 3 fields",3,doc.getFieldNames().size());
  Assert.assertTrue("test if doc has field1",doc.getField("field1").getValues().contains("val1"));
  Assert.assertTrue("test if doc has field2",doc.getField("field2").getValues().contains("val2"));
  Assert.assertTrue("test if doc has field4",doc.getField("field4").getValues().contains("val4"));
}

</code></pre>

<br>
<pre class="type-2 type-12 type-13 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that empty {@code index.static} does not add anything to the document
 * @throws Exception
 */
@Test public void testEmptyIndexStatic() throws Exception {
  Assert.assertNotNull(filter);
  filter.setConf(conf);
  NutchDocument doc=new NutchDocument();
  try {
    filter.filter(doc,parse,url,crawlDatum,inlinks);
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail(e.getMessage());
  }
  Assert.assertNotNull(doc);
  Assert.assertTrue("tests if no field is set for empty index.static",doc.getFieldNames().isEmpty());
}

</code></pre>

<br>
<pre class="type-2 type-12 type-5 type-1 type-13 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test for NUTCH-2052 custom delimiters in index.static.
 * @throws Exception
 */
@Test public void testCustomMulticharacterDelimiters() throws Exception {
  conf.set("index.static.fieldsep","\n\n");
  conf.set("index.static.keysep","\t\t");
  conf.set("index.static.valuesep","***");
  conf.set("index.static","field1\t\tval1\n\n" + "field2\t\tval2***val3\n\n" + "field3\n\n"+ "field4\t\tval4\n\n\n\n");
  Assert.assertNotNull(filter);
  filter.setConf(conf);
  NutchDocument doc=new NutchDocument();
  try {
    filter.filter(doc,parse,url,crawlDatum,inlinks);
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail(e.getMessage());
  }
  Assert.assertNotNull(doc);
  Assert.assertFalse("test if doc is not empty",doc.getFieldNames().isEmpty());
  Assert.assertEquals("test if doc has 3 fields",3,doc.getFieldNames().size());
  Assert.assertTrue("test if doc has field1",doc.getField("field1").getValues().contains("val1"));
  Assert.assertTrue("test if doc has field2",doc.getField("field2").getValues().contains("val2"));
  Assert.assertTrue("test if doc has field4",doc.getField("field4").getValues().contains("val4"));
}

</code></pre>

<br>
<pre class="type-2 type-12 type-5 type-1 type-13 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that valid field:value pairs are added to the document
 * @throws Exception
 */
@Test public void testNormalScenario() throws Exception {
  conf.set("index.static","field1:val1, field2    :      val2 val3     , field3, field4 :val4 , ");
  Assert.assertNotNull(filter);
  filter.setConf(conf);
  NutchDocument doc=new NutchDocument();
  try {
    filter.filter(doc,parse,url,crawlDatum,inlinks);
  }
 catch (  Exception e) {
    e.printStackTrace();
    Assert.fail(e.getMessage());
  }
  Assert.assertNotNull(doc);
  Assert.assertFalse("test if doc is not empty",doc.getFieldNames().isEmpty());
  Assert.assertEquals("test if doc has 3 fields",3,doc.getFieldNames().size());
  Assert.assertTrue("test if doc has field1",doc.getField("field1").getValues().contains("val1"));
  Assert.assertTrue("test if doc has field2",doc.getField("field2").getValues().contains("val2"));
  Assert.assertTrue("test if doc has field4",doc.getField("field4").getValues().contains("val4"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.nutch.net.TestURLNormalizers </h4><pre class="type-7 type-2 type-12 type-5 type-1 type-13 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testURLNormalizers(){
  Configuration conf=NutchConfiguration.create();
  String clazz1="org.apache.nutch.net.urlnormalizer.regex.RegexURLNormalizer";
  String clazz2="org.apache.nutch.net.urlnormalizer.basic.BasicURLNormalizer";
  conf.set("urlnormalizer.order",clazz1 + " " + clazz2);
  URLNormalizers normalizers=new URLNormalizers(conf,URLNormalizers.SCOPE_DEFAULT);
  Assert.assertNotNull(normalizers);
  try {
    normalizers.normalize("http://www.example.com/",URLNormalizers.SCOPE_DEFAULT);
  }
 catch (  MalformedURLException mue) {
    Assert.fail(mue.toString());
  }
  try {
    String normalizedSlashes=normalizers.normalize("http://www.example.com//path/to//somewhere.html",URLNormalizers.SCOPE_DEFAULT);
    Assert.assertEquals(normalizedSlashes,"http://www.example.com/path/to/somewhere.html");
  }
 catch (  MalformedURLException mue) {
    Assert.fail(mue.toString());
  }
  try {
    String normalizedHost=normalizers.normalize("http://www.example.org//path/to//somewhere.html",URLNormalizers.SCOPE_DEFAULT);
    Assert.assertEquals(normalizedHost,"http://www.example.org/path/to/somewhere.html");
  }
 catch (  MalformedURLException mue) {
    Assert.fail(mue.toString());
  }
  int pos1=-1, pos2=-1;
  URLNormalizer[] impls=normalizers.getURLNormalizers(URLNormalizers.SCOPE_DEFAULT);
  for (int i=0; i < impls.length; i++) {
    if (impls[i].getClass().getName().equals(clazz1))     pos1=i;
    if (impls[i].getClass().getName().equals(clazz2))     pos2=i;
  }
  if (pos1 != -1 && pos2 != -1) {
    Assert.assertTrue("RegexURLNormalizer before BasicURLNormalizer",pos1 < pos2);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.nutch.net.urlnormalizer.pass.TestPassURLNormalizer </h4><pre class="type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPassURLNormalizer(){
  Configuration conf=NutchConfiguration.create();
  PassURLNormalizer normalizer=new PassURLNormalizer();
  normalizer.setConf(conf);
  String url="http://www.example.com/test/..//";
  String result=null;
  try {
    result=normalizer.normalize(url,URLNormalizers.SCOPE_DEFAULT);
  }
 catch (  MalformedURLException mue) {
    Assert.fail(mue.toString());
  }
  Assert.assertEquals(url,result);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.nutch.parse.feed.TestFeedParser </h4><pre class="type-6 type-4 type-7 type-2 type-5 type-1 type-13 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Calls the {@link FeedParser} on a sample RSS file and checks that there are
 * 3 {@link ParseResult} entries including the below 2 links:
 * <ul>
 * <li>http://www-scf.usc.edu/~mattmann/</li>
 * <li>http://www.nutch.org</li>
 * </ul>
 * @throws ProtocolNotFoundIf the {@link Protocol}Layer cannot be loaded (required to fetch
 * the {@link Content} for the RSS file).
 * @throws ParseExceptionIf the {@link Parser}Layer cannot be loaded.
 */
@Test public void testParseFetchChannel() throws ProtocolNotFound, ParseException {
  String urlString;
  Protocol protocol;
  Content content;
  ParseResult parseResult;
  Configuration conf=NutchConfiguration.create();
  for (int i=0; i < sampleFiles.length; i++) {
    urlString="file:" + sampleDir + fileSeparator+ sampleFiles[i];
    urlString=urlString.replace('\\','/');
    protocol=new ProtocolFactory(conf).getProtocol(urlString);
    content=protocol.getProtocolOutput(new Text(urlString),new CrawlDatum()).getContent();
    parseResult=new ParseUtil(conf).parseByExtensionId("feed",content);
    Assert.assertEquals(3,parseResult.size());
    boolean hasLink1=false, hasLink2=false, hasLink3=false;
    for (Iterator<Map.Entry<Text,Parse>> j=parseResult.iterator(); j.hasNext(); ) {
      Map.Entry<Text,Parse> entry=j.next();
      if (entry.getKey().toString().equals("http://www-scf.usc.edu/~mattmann/")) {
        hasLink1=true;
      }
 else       if (entry.getKey().toString().equals("http://www.nutch.org/")) {
        hasLink2=true;
      }
 else       if (entry.getKey().toString().equals(urlString)) {
        hasLink3=true;
      }
      Assert.assertNotNull(entry.getValue());
      Assert.assertNotNull(entry.getValue().getData());
    }
    if (!hasLink1 || !hasLink2 || !hasLink3) {
      Assert.fail("Outlinks read from sample rss file are not correct!");
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.nutch.plugin.TestPluginSystem </h4><pre class="type-4 type-7 type-2 type-5 type-1 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @throws PluginRuntimeException
 */
@Test public void testGetExtensionInstances() throws PluginRuntimeException {
  Extension[] extensions=repository.getExtensionPoint(getGetExtensionId()).getExtensions();
  Assert.assertEquals(extensions.length,fPluginCount);
  for (int i=0; i < extensions.length; i++) {
    Extension extension=extensions[i];
    Object object=extension.getExtensionInstance();
    if (!(object instanceof HelloWorldExtension))     Assert.fail(" object is not a instance of HelloWorldExtension");
    ((ITestExtension)object).testGetExtension("Bla ");
    String string=((ITestExtension)object).testGetExtension("Hello");
    Assert.assertEquals("Hello World",string);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.nutch.protocol.TestProtocolFactory </h4><pre class="type-6 type-2 type-12 type-5 type-1 type-13 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetProtocol(){
  try {
    factory.getProtocol("xyzxyz://somehost");
    Assert.fail("Must throw ProtocolNotFound");
  }
 catch (  ProtocolNotFound e) {
  }
catch (  Exception ex) {
    Assert.fail("Must not throw any other exception");
  }
  Protocol httpProtocol=null;
  try {
    httpProtocol=factory.getProtocol("http://somehost");
    Assert.assertNotNull(httpProtocol);
  }
 catch (  Exception ex) {
    Assert.fail("Must not throw any other exception");
  }
  Object protocol=ObjectCache.get(conf).getObject(Protocol.X_POINT_ID + "http");
  Assert.assertNotNull(protocol);
  Assert.assertEquals(httpProtocol,protocol);
  try {
    Assert.assertTrue(httpProtocol == factory.getProtocol("http://somehost"));
  }
 catch (  ProtocolNotFound e) {
    Assert.fail("Must not throw any exception");
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.nutch.tika.TestFeedParser </h4><pre class="type-4 type-7 type-2 type-12 type-5 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * <p>
 * The test method: tests out the following 2 asserts:
 * </p>
 * <ul>
 * <li>There are 3 outlinks read from the sample rss file</li>
 * <li>The 3 outlinks read are in fact the correct outlinks from the sample
 * file</li>
 * </ul>
 */
@Test public void testIt() throws ProtocolException, ParseException {
  String urlString;
  Protocol protocol;
  Content content;
  Parse parse;
  Configuration conf=NutchConfiguration.create();
  for (int i=0; i < sampleFiles.length; i++) {
    urlString="file:" + sampleDir + fileSeparator+ sampleFiles[i];
    protocol=new ProtocolFactory(conf).getProtocol(urlString);
    content=protocol.getProtocolOutput(new Text(urlString),new CrawlDatum()).getContent();
    parse=new ParseUtil(conf).parseByExtensionId("parse-tika",content).get(content.getUrl());
    ParseData theParseData=parse.getData();
    Outlink[] theOutlinks=theParseData.getOutlinks();
    Assert.assertTrue("There aren't 2 outlinks read!",theOutlinks.length == 2);
    boolean hasLink1=false, hasLink2=false;
    for (int j=0; j < theOutlinks.length; j++) {
      if (theOutlinks[j].getToUrl().equals("http://www-scf.usc.edu/~mattmann/")) {
        hasLink1=true;
      }
      if (theOutlinks[j].getToUrl().equals("http://www.nutch.org/")) {
        hasLink2=true;
      }
    }
    if (!hasLink1 || !hasLink2) {
      Assert.fail("Outlinks read from sample rss file are not correct!");
    }
  }
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
