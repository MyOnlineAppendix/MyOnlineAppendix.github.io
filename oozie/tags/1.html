<h3><span class=" glyphicon glyphicon-tag"/>&nbspBooleanVerifier</h3><kbd>Verifies boolean conditions</kbd><br><br><br><h4 style="margin:0px">Class: org.apache.oozie.action.hadoop.TestFSPrepareActions </h4><pre class="type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testDelete() throws Exception {
  Path actionDir=getFsTestCaseDir();
  FileSystem fs=getFileSystem();
  Path newDir=new Path(actionDir,"newDir");
  if (fs.exists(newDir)) {
    fs.delete(newDir,true);
  }
  fs.mkdirs(newDir);
  String prepareXML="<prepare>" + "<delete path='" + newDir + "'/>"+ "</prepare>";
  JobConf conf=createJobConf();
  LauncherMapperHelper.setupLauncherURIHandlerConf(conf);
  PrepareActionsDriver.doOperations(prepareXML,conf);
  assertFalse(fs.exists(newDir));
}

</code></pre>

<br>
<pre class="type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testForNullScheme() throws Exception {
  Path actionDir=getFsTestCaseDir();
  Path newDir=new Path(actionDir,"newDir");
  String noSchemePath=newDir.toUri().getPath();
  FileSystem fs=getFileSystem();
  if (fs.exists(newDir)) {
    fs.delete(newDir,true);
  }
  String prepareXML="<prepare>" + "<mkdir path='" + noSchemePath + "'/>"+ "</prepare>";
  JobConf conf=createJobConf();
  LauncherMapperHelper.setupLauncherURIHandlerConf(conf);
  PrepareActionsDriver.doOperations(prepareXML,conf);
  assertTrue(fs.exists(new Path(noSchemePath)));
}

</code></pre>

<br>
<pre class="type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testDeleteWithGlob() throws Exception {
  Path actionDir=getFsTestCaseDir();
  FileSystem fs=getFileSystem();
  Path newDir=new Path(actionDir,"newDir");
  if (fs.exists(newDir)) {
    fs.delete(newDir,true);
  }
  fs.mkdirs(newDir);
  fs.mkdirs(new Path(newDir,"2010"));
  fs.mkdirs(new Path(newDir + "/2010/10"));
  fs.mkdirs(new Path(newDir,"2011"));
  fs.mkdirs(new Path(newDir + "/2011/10"));
  fs.mkdirs(new Path(newDir,"2012"));
  fs.mkdirs(new Path(newDir + "/2012/10"));
  String prepareXML="<prepare>" + "<delete path='" + newDir + "/201[0-1]/*"+ "'/>"+ "</prepare>";
  JobConf conf=createJobConf();
  LauncherMapperHelper.setupLauncherURIHandlerConf(conf);
  PrepareActionsDriver.doOperations(prepareXML,conf);
  assertFalse(fs.exists(new Path(newDir + "/2010/10")));
  assertFalse(fs.exists(new Path(newDir + "/2011/10")));
  assertTrue(fs.exists(new Path(newDir + "/2012/10")));
  fs.delete(newDir,true);
}

</code></pre>

<br>
<pre class="type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testMkdir() throws Exception {
  Path actionDir=getFsTestCaseDir();
  FileSystem fs=getFileSystem();
  Path newDir=new Path(actionDir,"newDir");
  if (fs.exists(newDir)) {
    fs.delete(newDir,true);
  }
  String prepareXML="<prepare>" + "<mkdir path='" + newDir + "'/>"+ "</prepare>";
  JobConf conf=createJobConf();
  LauncherMapperHelper.setupLauncherURIHandlerConf(conf);
  PrepareActionsDriver.doOperations(prepareXML,conf);
  assertTrue(fs.exists(newDir));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.oozie.action.hadoop.TestHCatPrepareActions </h4><pre class="type-1 type-2 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDelete() throws Exception {
  dropTable("db1","table1",true);
  dropDatabase("db1",true);
  createDatabase("db1");
  createTable("db1","table1","year,month,dt,country");
  String part1=addPartition("db1","table1","year=2012;month=12;dt=02;country=us");
  String part2=addPartition("db1","table1","year=2012;month=12;dt=03;country=us");
  String part3=addPartition("db1","table1","year=2013;month=1;dt=01;country=us");
  String uri1="hcat://" + getMetastoreAuthority() + "/db1/table1/year=2012;month=12";
  String uri2="hcat://" + getMetastoreAuthority() + "/db1/table1/year=2013;dt=01";
  String prepareXML="<prepare>" + "<delete path='" + uri1 + "'/>"+ "<delete path='"+ uri2+ "'/>"+ "</prepare>";
  JobConf conf=createJobConf();
  LauncherMapperHelper.setupLauncherURIHandlerConf(conf);
  PrepareActionsDriver.doOperations(prepareXML,conf);
  FileSystem fs=getFileSystem();
  assertFalse(fs.exists(new Path(part1)));
  assertFalse(fs.exists(new Path(part2)));
  assertFalse(fs.exists(new Path(part3)));
  assertEquals(0,getPartitions("db1","table1","country=us").size());
  dropTable("db1","table1",true);
  dropDatabase("db1",true);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.oozie.action.hadoop.TestJavaActionExecutor </h4><pre class="type-3 type-4 type-1 type-2 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAddActionShareLib() throws Exception {
  WorkflowAppService wps=Services.get().get(WorkflowAppService.class);
  Path systemLibPath=new Path(wps.getSystemLibPath(),ShareLibService.SHARE_LIB_PREFIX + new SimpleDateFormat("yyyyMMddHHmmss").format(new Date()).toString());
  Path javaShareLibPath=new Path(systemLibPath,"java");
  getFileSystem().mkdirs(javaShareLibPath);
  Path jar1Path=new Path(javaShareLibPath,"jar1.jar");
  getFileSystem().create(jar1Path).close();
  Path jar2Path=new Path(javaShareLibPath,"jar2.jar");
  getFileSystem().create(jar2Path).close();
  Path hcatShareLibPath=new Path(systemLibPath,"hcat");
  getFileSystem().mkdirs(hcatShareLibPath);
  Path jar3Path=new Path(hcatShareLibPath,"jar3.jar");
  getFileSystem().create(jar3Path).close();
  Path jar4Path=new Path(hcatShareLibPath,"jar4.jar");
  getFileSystem().create(jar4Path).close();
  Path otherShareLibPath=new Path(systemLibPath,"other");
  getFileSystem().mkdirs(otherShareLibPath);
  Path jar5Path=new Path(otherShareLibPath,"jar5.jar");
  getFileSystem().create(jar5Path).close();
  String actionXml="<java>" + "<job-tracker>" + getJobTrackerUri() + "</job-tracker>"+ "<name-node>"+ getNameNodeUri()+ "</name-node>"+ "<job-xml>job.xml</job-xml>"+ "<job-xml>job2.xml</job-xml>"+ "<main-class>MAIN-CLASS</main-class>"+ "</java>";
  Element eActionXml=XmlUtils.parseXml(actionXml);
  Context context=createContext(actionXml,null);
  Services.get().setService(ShareLibService.class);
  WorkflowJobBean workflow=(WorkflowJobBean)context.getWorkflow();
  XConfiguration wfConf=new XConfiguration();
  wfConf.set(WorkflowAppService.HADOOP_USER,getTestUser());
  wfConf.set(OozieClient.APP_PATH,new Path(getAppPath(),"workflow.xml").toString());
  wfConf.setBoolean(OozieClient.USE_SYSTEM_LIBPATH,true);
  workflow.setConf(XmlUtils.prettyPrint(wfConf).toString());
  ConfigurationService.set("oozie.action.sharelib.for.java","java,hcat");
  JavaActionExecutor ae=new JavaActionExecutor();
  Configuration jobConf=ae.createBaseHadoopConf(context,eActionXml);
  ae.setupLauncherConf(jobConf,eActionXml,getAppPath(),context);
  try {
    ae.setLibFilesArchives(context,eActionXml,getAppPath(),jobConf);
    fail();
  }
 catch (  ActionExecutorException aee) {
    assertEquals("EJ001",aee.getErrorCode());
    assertEquals("Could not locate Oozie sharelib",aee.getMessage());
  }
  Path launcherPath=new Path(systemLibPath,"oozie");
  getFileSystem().mkdirs(launcherPath);
  Path jar6Path=new Path(launcherPath,"jar6.jar");
  getFileSystem().create(jar6Path).close();
  Services.get().get(ShareLibService.class).updateShareLib();
  ae.setLibFilesArchives(context,eActionXml,getAppPath(),jobConf);
  URI[] cacheFiles=DistributedCache.getCacheFiles(jobConf);
  String cacheFilesStr=Arrays.toString(cacheFiles);
  assertTrue(cacheFilesStr.contains(jar1Path.toString()));
  assertTrue(cacheFilesStr.contains(jar2Path.toString()));
  assertTrue(cacheFilesStr.contains(jar3Path.toString()));
  assertTrue(cacheFilesStr.contains(jar4Path.toString()));
  assertFalse(cacheFilesStr.contains(jar5Path.toString()));
  assertTrue(cacheFilesStr.contains(jar6Path.toString()));
  workflow=(WorkflowJobBean)context.getWorkflow();
  wfConf=new XConfiguration();
  wfConf.set(WorkflowAppService.HADOOP_USER,getTestUser());
  wfConf.set(OozieClient.APP_PATH,new Path(getAppPath(),"workflow.xml").toString());
  wfConf.setBoolean(OozieClient.USE_SYSTEM_LIBPATH,true);
  wfConf.set("oozie.action.sharelib.for.java","other,hcat");
  workflow.setConf(XmlUtils.prettyPrint(wfConf).toString());
  ConfigurationService.set("oozie.action.sharelib.for.java","java");
  ae=new JavaActionExecutor();
  jobConf=ae.createBaseHadoopConf(context,eActionXml);
  ae.setupLauncherConf(jobConf,eActionXml,getAppPath(),context);
  ae.setLibFilesArchives(context,eActionXml,getAppPath(),jobConf);
  cacheFiles=DistributedCache.getCacheFiles(jobConf);
  cacheFilesStr=Arrays.toString(cacheFiles);
  assertFalse(cacheFilesStr.contains(jar1Path.toString()));
  assertFalse(cacheFilesStr.contains(jar2Path.toString()));
  assertTrue(cacheFilesStr.contains(jar3Path.toString()));
  assertTrue(cacheFilesStr.contains(jar4Path.toString()));
  assertTrue(cacheFilesStr.contains(jar5Path.toString()));
  assertTrue(cacheFilesStr.contains(jar6Path.toString()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.oozie.action.hadoop.TestLauncherFSURIHandler </h4><pre class="type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testCreate() throws Exception {
  Path path=new Path(getFsTestCaseDir() + "/2012/12/02/");
  LauncherURIHandler handler=uriHandlerFactory.getURIHandler(path.toUri());
  assertTrue(handler.create(path.toUri(),conf));
  assertTrue(getFileSystem().exists(path));
}

</code></pre>

<br>
<pre class="type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testDelete() throws Exception {
  Path path=new Path(getFsTestCaseDir() + "/2012/12/02/");
  LauncherURIHandler handler=uriHandlerFactory.getURIHandler(path.toUri());
  getFileSystem().mkdirs(path);
  assertTrue(handler.delete(path.toUri(),conf));
  assertFalse(getFileSystem().exists(path));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.oozie.action.hadoop.TestLauncherHCatURIHandler </h4><pre class="type-3 type-1 type-2 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDelete() throws Exception {
  createTestTable();
  String location1=getPartitionDir(db,table,"year=2012;month=12;dt=02;country=us");
  String location2=getPartitionDir(db,table,"year=2012;month=12;dt=03;country=us");
  createPartitionForTestDelete(true,true);
  URI hcatURI=getHCatURI(db,table,"year=2012;month=12;dt=02;country=us");
  URIHandler uriHandler=uriService.getURIHandler(hcatURI);
  assertTrue(uriHandler.exists(hcatURI,conf,getTestUser()));
  LauncherURIHandlerFactory uriHandlerFactory=new LauncherURIHandlerFactory(uriService.getLauncherConfig());
  LauncherURIHandler handler=uriHandlerFactory.getURIHandler(hcatURI);
  handler.delete(hcatURI,conf);
  assertFalse(getFileSystem().exists(new Path(location1)));
  assertTrue(getFileSystem().exists(new Path(location2)));
  assertEquals(0,getPartitions(db,table,"year=2012;month=12;dt=02;country=us").size());
  assertEquals(1,getPartitions(db,table,"year=2012;month=12;dt=03;country=us").size());
  createPartitionForTestDelete(true,false);
  hcatURI=getHCatURI(db,table,"year=2012;month=12");
  handler.delete(hcatURI,conf);
  assertFalse(getFileSystem().exists(new Path(location1)));
  assertFalse(getFileSystem().exists(new Path(location2)));
  assertEquals(0,getPartitions(db,table,"year=2012;month=12;dt=02;country=us").size());
  assertEquals(0,getPartitions(db,table,"year=2012;month=12;dt=03;country=us").size());
  createPartitionForTestDelete(true,true);
  hcatURI=getHCatURI(db,table,"month=12;country=us");
  handler.delete(hcatURI,conf);
  assertFalse(getFileSystem().exists(new Path(location1)));
  assertFalse(getFileSystem().exists(new Path(location2)));
  assertEquals(0,getPartitions(db,table,"year=2012;month=12;dt=02;country=us").size());
  assertEquals(0,getPartitions(db,table,"year=2012;month=12;dt=03;country=us").size());
  createPartitionForTestDelete(true,true);
  hcatURI=getHCatURI(db,table,"country=us");
  handler.delete(hcatURI,conf);
  assertFalse(getFileSystem().exists(new Path(location1)));
  assertFalse(getFileSystem().exists(new Path(location2)));
  assertEquals(0,getPartitions(db,table,"year=2012;month=12;dt=02;country=us").size());
  assertEquals(0,getPartitions(db,table,"year=2012;month=12;dt=03;country=us").size());
  createPartitionForTestDelete(true,true);
  hcatURI=getHCatURI(db,table,"dt=03");
  handler.delete(hcatURI,conf);
  assertTrue(getFileSystem().exists(new Path(location1)));
  assertFalse(getFileSystem().exists(new Path(location2)));
  assertEquals(1,getPartitions(db,table,"year=2012;month=12;dt=02;country=us").size());
  assertEquals(0,getPartitions(db,table,"year=2012;month=12;dt=03;country=us").size());
  createPartitionForTestDelete(false,true);
  hcatURI=getHCatURI(db,table,"dt=09");
  handler.delete(hcatURI,conf);
  assertTrue(getFileSystem().exists(new Path(location1)));
  assertTrue(getFileSystem().exists(new Path(location2)));
  assertEquals(1,getPartitions(db,table,"year=2012;month=12;dt=02;country=us").size());
  assertEquals(1,getPartitions(db,table,"year=2012;month=12;dt=03;country=us").size());
  dropTestTable();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.oozie.cli.TestCLIParser </h4><pre class="type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testCommandParserShowHelp() throws Exception {
  String pattern="oozie job <A>: AAAAA";
  CLIParser parser=new CLIParser("oozie",new String[]{});
  parser.addCommand("job","<A>","AAAAA",new Options(),false);
  CLIParser.Command c=parser.parse(new String[]{"job","b"});
  assertTrue(readCommandOutput(parser,c).contains(pattern));
}

</code></pre>

<br>
<pre class="type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testCommandParserShowHelpWithOptions() throws Exception {
  String pattern="oozie job <OPTIONS> : job operations";
  CLIParser parser=new CLIParser("oozie",new String[]{});
  parser.addCommand("job","","job operations",createCommandOptions(),false);
  CLIParser.Command c=parser.parse(new String[]{"job","-url","test-name","-verbose"});
  assertTrue(readCommandOutput(parser,c).contains(pattern));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.oozie.command.coord.TestCoordActionInputCheckXCommand </h4><pre class="type-4 type-1 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTimeoutWithException() throws Exception {
  String missingDeps="nofs:///dirx/filex";
  String actionId=addInitRecords(missingDeps,null,TZ);
  try {
    new CoordActionInputCheckXCommand(actionId,actionId.substring(0,actionId.indexOf("@"))).call();
    fail();
  }
 catch (  Exception e) {
    assertTrue(e.getMessage().contains("No FileSystem for scheme"));
  }
  long timeOutCreationTime=System.currentTimeMillis() - (12 * 60 * 1000);
  setCoordActionCreationTime(actionId,timeOutCreationTime);
  try {
    new CoordActionInputCheckXCommand(actionId,actionId.substring(0,actionId.indexOf("@"))).call();
    fail();
  }
 catch (  Exception e) {
    assertTrue(e.getMessage().contains("No FileSystem for scheme"));
  }
  Thread.sleep(100);
  checkCoordAction(actionId,missingDeps,CoordinatorAction.Status.TIMEDOUT);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.oozie.command.coord.TestCoordActionUpdatePushMissingDependency </h4><pre class="type-3 type-1 type-2 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdateCoordTableBasic() throws Exception {
  String newHCatDependency="hcat://hcat.server.com:5080/mydb/clicks/datastamp=12;region=us";
  HCatURI hcatUri=new HCatURI(newHCatDependency);
  String actionId=addInitRecords(newHCatDependency);
  checkCoordAction(actionId,newHCatDependency,CoordinatorAction.Status.WAITING);
  PartitionDependencyManagerService pdms=Services.get().get(PartitionDependencyManagerService.class);
  pdms.addMissingDependency(hcatUri,actionId);
  pdms.partitionAvailable("hcat.server.com:5080","mydb","clicks",getPartitionMap("src=search;datastamp=12;region=us"));
  Collection<String> availableURIs=pdms.getAvailableDependencyURIs(actionId);
  assertEquals(availableURIs.size(),1);
  assertTrue(availableURIs.contains(newHCatDependency));
  new CoordActionUpdatePushMissingDependency(actionId).call();
  checkCoordAction(actionId,"",CoordinatorAction.Status.READY);
  assertNull(pdms.getAvailableDependencyURIs(actionId));
}

</code></pre>

<br>
<pre class="type-3 type-1 type-2 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdateCoordTableAdvanced() throws Exception {
  String newHCatDependency1="hcat://hcat.server.com:5080/mydb/clicks/datastamp=11;region=us";
  String newHCatDependency2="hcat://hcat.server.com:5080/mydb/clicks/datastamp=12;region=us";
  HCatURI hcatUri1=new HCatURI(newHCatDependency1);
  HCatURI hcatUri2=new HCatURI(newHCatDependency2);
  String fullDeps=newHCatDependency1 + CoordELFunctions.INSTANCE_SEPARATOR + newHCatDependency2;
  String actionId=addInitRecords(fullDeps);
  checkCoordAction(actionId,fullDeps,CoordinatorAction.Status.WAITING);
  PartitionDependencyManagerService pdms=Services.get().get(PartitionDependencyManagerService.class);
  pdms.addMissingDependency(hcatUri1,actionId);
  pdms.addMissingDependency(hcatUri2,actionId);
  pdms.partitionAvailable("hcat.server.com:5080","mydb","clicks",getPartitionMap("src=search;datastamp=12;region=us"));
  Collection<String> availableURIs=pdms.getAvailableDependencyURIs(actionId);
  assertEquals(1,availableURIs.size());
  assertTrue(availableURIs.contains(newHCatDependency2));
  new CoordActionUpdatePushMissingDependency(actionId).call();
  checkCoordAction(actionId,newHCatDependency1,CoordinatorAction.Status.WAITING);
  pdms.partitionAvailable("hcat.server.com:5080","mydb","clicks",getPartitionMap("src=search;datastamp=11;region=us"));
  availableURIs=pdms.getAvailableDependencyURIs(actionId);
  assertEquals(1,availableURIs.size());
  assertTrue(availableURIs.contains(newHCatDependency1));
  new CoordActionUpdatePushMissingDependency(actionId).call();
  checkCoordAction(actionId,"",CoordinatorAction.Status.READY);
  assertNull(pdms.getAvailableDependencyURIs(actionId));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.oozie.command.coord.TestCoordCommandUtils </h4><pre class="type-3 type-4 type-1 type-2 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCoordAbsolute() throws Exception {
  CoordinatorJobBean job=addRecordToCoordJobTableForWaiting("coord-dataset-absolute.xml",CoordinatorJob.Status.RUNNING,false,true);
  Path appPath=new Path(getFsTestCaseDir(),"coord");
  String actionXml=getCoordActionXml(appPath,"coord-dataset-absolute.xml");
  CoordinatorActionBean actionBean=createCoordinatorActionBean(job);
  Configuration jobConf=new XConfiguration(new StringReader(job.getConf()));
  Element eAction=createActionElement(actionXml);
  jobConf.set("startInstance","coord:absolute(2009-08-20T01:00Z)");
  jobConf.set("endInstance","coord:current(2)");
  String output=CoordCommandUtils.materializeOneInstance("jobId",true,eAction,DateUtils.parseDateOozieTZ("2009-08-20T01:00Z"),DateUtils.parseDateOozieTZ("2009-08-20T01:00Z"),1,jobConf,actionBean);
  eAction=XmlUtils.parseXml(output);
  List<?> elementList=((Element)eAction.getChildren("input-events",eAction.getNamespace()).get(0)).getChildren();
  Element e1=(Element)elementList.get(0);
  Element e2=(Element)elementList.get(1);
  assertEquals(e1.getChild("uris",e1.getNamespace()).getTextTrim(),"hdfs:///tmp/workflows/2009/09/03;region=us#hdfs:///tmp/workflows/2009/08/27;" + "region=us#hdfs:///tmp/workflows/2009/08/20;region=us");
  assertEquals(e2.getChild("uris",e1.getNamespace()).getTextTrim(),"hdfs:///tmp/workflows/2009/09/03;region=us#hdfs:///tmp/workflows/2009/08/27;" + "region=us#hdfs:///tmp/workflows/2009/08/20;region=us");
  jobConf.set("startInstance","coord:absolute(2009-08-20T01:00Z)");
  jobConf.set("endInstance","coord:current(2)");
  eAction=createActionElement(actionXml);
  output=CoordCommandUtils.materializeOneInstance("jobId",true,eAction,DateUtils.parseDateOozieTZ("2009-09-10T01:00Z"),DateUtils.parseDateOozieTZ("2009-09-08T01:00Z"),1,jobConf,actionBean);
  eAction=XmlUtils.parseXml(output);
  elementList=((Element)eAction.getChildren("input-events",eAction.getNamespace()).get(0)).getChildren();
  e1=(Element)elementList.get(1);
  assertEquals(e1.getChild("uris",e1.getNamespace()).getTextTrim(),"hdfs:///tmp/workflows/2009/09/24;region=us#hdfs:///tmp/workflows/2009/09/17;region=us#" + "hdfs:///tmp/workflows/2009/09/10;region=us#hdfs:///tmp/workflows/2009/09/03;region=us#" + "hdfs:///tmp/workflows/2009/08/27;region=us#hdfs:///tmp/workflows/2009/08/20;region=us");
  jobConf.set("startInstance","coord:absolute(2009-08-20T01:00Z)");
  jobConf.set("endInstance","coord:current(2)");
  eAction=createActionElement(actionXml);
  output=CoordCommandUtils.materializeOneInstance("jobId",true,eAction,DateUtils.parseDateOozieTZ("2009-08-14T01:00Z"),DateUtils.parseDateOozieTZ("2009-08-14T01:00Z"),1,jobConf,actionBean);
  eAction=XmlUtils.parseXml(output);
  elementList=((Element)eAction.getChildren("input-events",eAction.getNamespace()).get(0)).getChildren();
  e1=(Element)elementList.get(1);
  assertEquals(e1.getChild("uris",e1.getNamespace()).getTextTrim(),"hdfs:///tmp/workflows/2009/08/27;region=us#hdfs:///tmp/workflows/2009/08/20;region=us");
  try {
    jobConf.set("startInstance","coord:absolute(2009-08-27T01:00Z)");
    jobConf.set("endInstance","coord:current(2)");
    eAction=createActionElement(actionXml);
    output=CoordCommandUtils.materializeOneInstance("jobId",true,eAction,DateUtils.parseDateOozieTZ("2009-08-06T01:00Z"),DateUtils.parseDateOozieTZ("2009-08-16T01:00Z"),1,jobConf,actionBean);
    eAction=XmlUtils.parseXml(output);
    fail("Should throw exception. Start-instance > end-instance ");
  }
 catch (  Exception e) {
    assertTrue(e.getCause().getMessage().contains("start-instance should be equal or earlier than the end-instance"));
  }
  try {
    jobConf.set("startInstance","coord:absolute(2009-07-01T01:00Z)");
    jobConf.set("endInstance","coord:current(2)");
    eAction=createActionElement(actionXml);
    output=CoordCommandUtils.materializeOneInstance("jobId",true,eAction,DateUtils.parseDateOozieTZ("2009-08-06T01:00Z"),DateUtils.parseDateOozieTZ("2009-08-16T01:00Z"),1,jobConf,actionBean);
    eAction=XmlUtils.parseXml(output);
    fail("Should throw exception. Start-instance > end-instance ");
  }
 catch (  Exception e) {
    assertTrue(e.getCause().getMessage().contains("intial-instance should be equal or earlier than the start-instance"));
  }
  try {
    jobConf.set("startInstance","coord:absolute(2009-08-20T01:00Z)");
    jobConf.set("endInstance","coord:latest(2)");
    eAction=createActionElement(actionXml);
    output=CoordCommandUtils.materializeOneInstance("jobId",true,eAction,DateUtils.parseDateOozieTZ("2009-08-20T01:00Z"),DateUtils.parseDateOozieTZ("2009-08-20T01:00Z"),1,jobConf,actionBean);
    eAction=XmlUtils.parseXml(output);
    fail("Should throw exception. Start-instance is absolute and end-instance is latest");
  }
 catch (  Exception e) {
    assertTrue(e.getMessage().contains("Only start-instance as absolute and end-instance as current is supported"));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.oozie.command.coord.TestCoordPushDependencyCheckXCommand </h4><pre class="type-4 type-1 type-2 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRequeueOnException() throws Exception {
  Services.get().getConf().setInt(RecoveryService.CONF_SERVICE_INTERVAL,6000);
  String newHCatDependency1="hcat://" + server + "/nodb/notable/dt=20120430;country=brazil";
  String newHCatDependency2="hcat://" + server + "/nodb/notable/dt=20120430;country=usa";
  String newHCatDependency=newHCatDependency1 + CoordELFunctions.INSTANCE_SEPARATOR + newHCatDependency2;
  CoordinatorJobBean job=addRecordToCoordJobTableForWaiting("coord-job-for-action-input-check.xml",CoordinatorJob.Status.RUNNING,false,true);
  CoordinatorActionBean action=addRecordToCoordActionTableForWaiting(job.getId(),1,CoordinatorAction.Status.WAITING,"coord-action-for-action-input-check.xml",null,newHCatDependency,"Z");
  String actionId=action.getId();
  checkCoordAction(actionId,newHCatDependency,CoordinatorAction.Status.WAITING);
  try {
    new CoordPushDependencyCheckXCommand(actionId,true).call();
    fail();
  }
 catch (  Exception e) {
    assertTrue(e.getMessage().contains("NoSuchObjectException"));
  }
  CallableQueueService callableQueueService=Services.get().get(CallableQueueService.class);
  assertEquals(0,callableQueueService.getQueueDump().size());
  new CoordActionInputCheckXCommand(actionId,job.getId()).call();
  callableQueueService=Services.get().get(CallableQueueService.class);
  assertEquals(0,callableQueueService.getQueueDump().size());
  setMissingDependencies(actionId,newHCatDependency1);
  try {
    new CoordPushDependencyCheckXCommand(actionId,true).call();
    fail();
  }
 catch (  Exception e) {
    assertTrue(e.getMessage().contains("NoSuchObjectException"));
  }
  final List<String> queueDump=callableQueueService.getQueueDump();
  assertEquals(1,callableQueueService.getQueueDump().size());
  assertTrue(queueDump.get(0).contains("coord_push_dep_check"));
  log.info("Queue dump is " + queueDump.toString());
  assertTrue(queueDump.get(0).matches(".* delay=(599[0-9]{3}|600000)"));
}

</code></pre>

<br>
<pre class="type-3 type-4 type-1 type-2 type-8 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTimeOutWithException2() throws Exception {
  String db="default";
  String table="tablename";
  String newHCatDependency1="hcat://" + server + "/"+ db+ "/"+ table+ "/dt=20120430;country=brazil";
  String newHCatDependency2="hcat://" + server + "/"+ db+ "/"+ table+ "/dt=20120430;country=usa";
  String newHCatDependency=newHCatDependency1 + CoordELFunctions.INSTANCE_SEPARATOR + newHCatDependency2;
  populateTable(db,table);
  String actionId=addInitRecords(newHCatDependency);
  checkCoordAction(actionId,newHCatDependency,CoordinatorAction.Status.WAITING);
  new CoordPushDependencyCheckXCommand(actionId,true).call();
  checkCoordAction(actionId,newHCatDependency1,CoordinatorAction.Status.WAITING);
  PartitionDependencyManagerService pdms=Services.get().get(PartitionDependencyManagerService.class);
  HCatAccessorService hcatService=Services.get().get(HCatAccessorService.class);
  assertTrue(pdms.getWaitingActions(new HCatURI(newHCatDependency1)).contains(actionId));
  assertTrue(hcatService.isRegisteredForNotification(new HCatURI(newHCatDependency1)));
  long timeOutCreationTime=System.currentTimeMillis() - (12 * 60 * 1000);
  setCoordActionCreationTime(actionId,timeOutCreationTime);
  dropTable(db,table,true);
  try {
    new CoordPushDependencyCheckXCommand(actionId).call();
    fail();
  }
 catch (  Exception e) {
    assertTrue(e.getMessage().contains("NoSuchObjectException"));
  }
  Thread.sleep(100);
  checkCoordAction(actionId,newHCatDependency1,CoordinatorAction.Status.TIMEDOUT);
  assertNull(pdms.getWaitingActions(new HCatURI(newHCatDependency1)));
  assertFalse(hcatService.isRegisteredForNotification(new HCatURI(newHCatDependency1)));
}

</code></pre>

<br>
<pre class="type-3 type-1 type-2 type-8 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTimeOut() throws Exception {
  String db="default";
  String table="tablename";
  String newHCatDependency1="hcat://" + server + "/"+ db+ "/"+ table+ "/dt=20120430;country=brazil";
  String newHCatDependency2="hcat://" + server + "/"+ db+ "/"+ table+ "/dt=20120430;country=usa";
  String newHCatDependency=newHCatDependency1 + CoordELFunctions.INSTANCE_SEPARATOR + newHCatDependency2;
  populateTable(db,table);
  String actionId=addInitRecords(newHCatDependency);
  checkCoordAction(actionId,newHCatDependency,CoordinatorAction.Status.WAITING);
  new CoordPushDependencyCheckXCommand(actionId,true).call();
  checkCoordAction(actionId,newHCatDependency1,CoordinatorAction.Status.WAITING);
  PartitionDependencyManagerService pdms=Services.get().get(PartitionDependencyManagerService.class);
  HCatAccessorService hcatService=Services.get().get(HCatAccessorService.class);
  assertTrue(pdms.getWaitingActions(new HCatURI(newHCatDependency1)).contains(actionId));
  assertTrue(hcatService.isRegisteredForNotification(new HCatURI(newHCatDependency1)));
  long timeOutCreationTime=System.currentTimeMillis() - (12 * 60 * 1000);
  setCoordActionCreationTime(actionId,timeOutCreationTime);
  new CoordPushDependencyCheckXCommand(actionId).call();
  Thread.sleep(100);
  checkCoordAction(actionId,newHCatDependency1,CoordinatorAction.Status.TIMEDOUT);
  assertNull(pdms.getWaitingActions(new HCatURI(newHCatDependency1)));
  assertFalse(hcatService.isRegisteredForNotification(new HCatURI(newHCatDependency1)));
}

</code></pre>

<br>
<pre class="type-3 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testLogMessagePrefix() throws Exception {
  Logger logger=Logger.getLogger(DependencyChecker.class);
  ByteArrayOutputStream out=new ByteArrayOutputStream();
  Layout layout=new SimpleLayout();
  Appender appender=new WriterAppender(layout,out);
  logger.addAppender(appender);
  String db="default";
  String table="tablename";
  populateTable(db,table);
  String newHCatDependency="hcat://" + server + "/"+ db+ "/"+ table+ "/dt=20120430;country=brazil";
  String actionId1=addInitRecords(newHCatDependency);
  new CoordPushDependencyCheckXCommand(actionId1).call();
  assertTrue(out.toString().contains("ACTION[" + actionId1 + "]"));
  out.reset();
  String actionId2=addInitRecords(newHCatDependency);
  new CoordPushDependencyCheckXCommand(actionId2).call();
  assertFalse(out.toString().contains("ACTION[" + actionId1 + "]"));
  assertTrue(out.toString().contains("ACTION[" + actionId2 + "]"));
}

</code></pre>

<br>
<pre class="type-4 type-1 type-8 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTimeOutWithException1() throws Exception {
  String newHCatDependency1="hcat://" + server + "/nodb/notable/dt=20120430;country=brazil";
  String newHCatDependency2="hcat://" + server + "/nodb/notable/dt=20120430;country=usa";
  String newHCatDependency=newHCatDependency1 + CoordELFunctions.INSTANCE_SEPARATOR + newHCatDependency2;
  String actionId=addInitRecords(newHCatDependency);
  checkCoordAction(actionId,newHCatDependency,CoordinatorAction.Status.WAITING);
  try {
    new CoordPushDependencyCheckXCommand(actionId,true).call();
    fail();
  }
 catch (  Exception e) {
    assertTrue(e.getMessage().contains("NoSuchObjectException"));
  }
  checkCoordAction(actionId,newHCatDependency,CoordinatorAction.Status.WAITING);
  PartitionDependencyManagerService pdms=Services.get().get(PartitionDependencyManagerService.class);
  HCatAccessorService hcatService=Services.get().get(HCatAccessorService.class);
  assertNull(pdms.getWaitingActions(new HCatURI(newHCatDependency1)));
  assertFalse(hcatService.isRegisteredForNotification(new HCatURI(newHCatDependency1)));
  long timeOutCreationTime=System.currentTimeMillis() - (12 * 60 * 1000);
  setCoordActionCreationTime(actionId,timeOutCreationTime);
  try {
    new CoordPushDependencyCheckXCommand(actionId).call();
    fail();
  }
 catch (  Exception e) {
    assertTrue(e.getMessage().contains("NoSuchObjectException"));
  }
  Thread.sleep(100);
  checkCoordAction(actionId,newHCatDependency,CoordinatorAction.Status.TIMEDOUT);
}

</code></pre>

<br>
<pre class="type-3 type-1 type-2 type-8 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdateCoordTableMultipleDepsV3() throws Exception {
  String db="default";
  String table="tablename";
  String newHCatDependency1="hcat://" + server + "/"+ db+ "/"+ table+ "/dt=20120430;country=brazil";
  String newHCatDependency2="hcat://" + server + "/"+ db+ "/"+ table+ "/dt=20120430;country=usa";
  String newHCatDependency=newHCatDependency1 + CoordELFunctions.INSTANCE_SEPARATOR + newHCatDependency2;
  populateTable(db,table);
  String actionId=addInitRecords(newHCatDependency);
  checkCoordAction(actionId,newHCatDependency,CoordinatorAction.Status.WAITING);
  new CoordPushDependencyCheckXCommand(actionId,true).call();
  checkCoordAction(actionId,newHCatDependency1,CoordinatorAction.Status.WAITING);
  PartitionDependencyManagerService pdms=Services.get().get(PartitionDependencyManagerService.class);
  HCatAccessorService hcatService=Services.get().get(HCatAccessorService.class);
  assertTrue(pdms.getWaitingActions(new HCatURI(newHCatDependency1)).contains(actionId));
  assertTrue(hcatService.isRegisteredForNotification(new HCatURI(newHCatDependency1)));
  assertNull(pdms.getWaitingActions(new HCatURI(newHCatDependency2)));
  addPartition(db,table,"dt=20120430;country=brazil");
  new CoordPushDependencyCheckXCommand(actionId).call();
  checkCoordAction(actionId,"",CoordinatorAction.Status.READY);
  assertNull(pdms.getWaitingActions(new HCatURI(newHCatDependency1)));
  assertFalse(hcatService.isRegisteredForNotification(new HCatURI(newHCatDependency1)));
}

</code></pre>

<br>
<pre class="type-3 type-1 type-2 type-8 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTimeOutWithUnresolvedMissingDependencies() throws Exception {
  String db="default";
  String table="tablename";
  String newHCatDependency1="hcat://" + server + "/"+ db+ "/"+ table+ "/dt=20120430;country=brazil";
  String newHCatDependency2="hcat://" + server + "/"+ db+ "/"+ table+ "/dt=20120430;country=usa";
  String newHCatDependency3="hcat://" + server + "/"+ db+ "/"+ table+ "/dt=20120430;country=uk";
  String newHCatDependency=newHCatDependency1 + CoordELFunctions.INSTANCE_SEPARATOR + newHCatDependency2;
  populateTable(db,table);
  String actionId=addInitRecords(newHCatDependency);
  checkCoordAction(actionId,newHCatDependency,CoordinatorAction.Status.WAITING);
  new CoordPushDependencyCheckXCommand(actionId,true).call();
  checkCoordAction(actionId,newHCatDependency1,CoordinatorAction.Status.WAITING);
  PartitionDependencyManagerService pdms=Services.get().get(PartitionDependencyManagerService.class);
  HCatAccessorService hcatService=Services.get().get(HCatAccessorService.class);
  assertTrue(pdms.getWaitingActions(new HCatURI(newHCatDependency1)).contains(actionId));
  assertTrue(hcatService.isRegisteredForNotification(new HCatURI(newHCatDependency1)));
  long timeOutCreationTime=System.currentTimeMillis() - (12 * 60 * 1000);
  setCoordActionCreationTime(actionId,timeOutCreationTime);
  setMissingDependencies(actionId,newHCatDependency + CoordELFunctions.INSTANCE_SEPARATOR + newHCatDependency3);
  addPartition(db,table,"dt=20120430;country=brazil");
  checkDependencies(actionId,newHCatDependency + CoordELFunctions.INSTANCE_SEPARATOR + newHCatDependency3,newHCatDependency1);
  new CoordPushDependencyCheckXCommand(actionId).call();
  Thread.sleep(1300);
  checkDependencies(actionId,newHCatDependency3,"");
  assertNull(pdms.getWaitingActions(new HCatURI(newHCatDependency1)));
  assertFalse(hcatService.isRegisteredForNotification(new HCatURI(newHCatDependency1)));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.oozie.compression.TestCodecFactory </h4><pre class="type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompressionCodecs() throws IOException {
  assertTrue(CodecFactory.isCompressionEnabled());
  assertEquals(GzipCompressionCodec.class,CodecFactory.getCompressionCodec().getClass());
  byte[] bytes=CodecFactory.getHeaderBytes();
  DataInputStream dais=new DataInputStream(new ByteArrayInputStream(bytes));
  assertEquals(GzipCompressionCodec.class,CodecFactory.getDeCompressionCodec(dais).getClass());
  dais.close();
}

</code></pre>

<br>
<pre class="type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCodecFactoryConf() throws Exception {
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  DataOutputStream daos=new DataOutputStream(baos);
  daos.write(CodecFactory.COMPRESSION_MAGIC_DATA.getBytes(CodecFactory.UTF_8_ENCODING));
  daos.writeInt(1);
  daos.writeInt(1);
  daos.writeUTF(CodecFactory.COMPRESSION_KEY_HEADER);
  daos.writeUTF(GzipCompressionCodec.CODEC_NAME);
  daos.close();
  assertEquals(new String(baos.toByteArray()),new String(CodecFactory.getHeaderBytes()));
  Configuration conf=services.getConf();
  conf.set(CodecFactory.COMPRESSION_OUTPUT_CODEC,"none");
  CodecFactory.initialize(conf);
  assertTrue(!CodecFactory.isCompressionEnabled());
  conf.set(CodecFactory.COMPRESSION_OUTPUT_CODEC,"");
  CodecFactory.initialize(conf);
  assertTrue(!CodecFactory.isCompressionEnabled());
  conf.set(CodecFactory.COMPRESSION_CODECS,"gz=" + GzipCompressionCodec.class.getName());
  CodecFactory.initialize(conf);
  conf.set(CodecFactory.COMPRESSION_OUTPUT_CODEC,"abcd");
  try {
    CodecFactory.initialize(conf);
  }
 catch (  Exception e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.oozie.coord.TestHCatELFunctions </h4><pre class="type-3 type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
/** 
 * Test dataInPartitionMax EL function (phase 3) which returns the maximum
 * value of a partition to be used as maximum in a range of input data to
 * load
 * @throws Exception
 */
@Test public void testDataInPartitionMax() throws Exception {
  init("coord-action-start");
  eval.setVariable(".datain.ABC","hcat://hcat.server.com:5080/mydb/clicks/datastamp=20;region=us," + "hcat://hcat.server.com:5080/mydb/clicks/datastamp=12;region=us," + "hcat://hcat.server.com:5080/mydb/clicks/datastamp=13;region=us,"+ "hcat://hcat.server.com:5080/mydb/clicks/datastamp=10;region=us");
  eval.setVariable(".datain.ABC.unresolved",Boolean.FALSE);
  String expr="${coord:dataInPartitionMax('ABC','datastamp')}";
  String res=CoordELFunctions.evalAndWrap(eval,expr);
  assertTrue(res.equals("20"));
}

</code></pre>

<br>
<pre class="type-3 type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
/** 
 * Test dataOutPartitionsPig EL function (phase 3) which returns the partition
 * to be used as output to store data into
 * @throws Exception
 */
@Test public void testDataOutPartitions() throws Exception {
  init("coord-action-start");
  String expr="${coord:dataOutPartitions('ABC')}";
  eval.setVariable(".dataout.ABC","hcat://hcat.server.com:5080/mydb/clicks/datastamp=20120230;region=us");
  eval.setVariable(".dataout.ABC.unresolved",Boolean.FALSE);
  String res=CoordELFunctions.evalAndWrap(eval,expr);
  assertTrue(res.equals("'datastamp=20120230,region=us'"));
  init("coord-sla-create");
  eval.setVariable(".dataout.ABC","hcat://hcat.server.com:5080/mydb/clicks/datastamp=20130230;region=euro");
  eval.setVariable(".dataout.ABC.unresolved",Boolean.FALSE);
  res=CoordELFunctions.evalAndWrap(eval,expr);
  assertTrue(res.equals("'datastamp=20130230,region=us'") || res.equals("'datastamp=20130230,region=euro'"));
}

</code></pre>

<br>
<pre class="type-3 type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
/** 
 * Test dataOutPartitionValue EL function (phase 3) which returns the value
 * of a particular partition to be used as output to store data into
 * @throws Exception
 */
@Test public void testDataOutPartitionValue() throws Exception {
  init("coord-action-start");
  String expr="${coord:dataOutPartitionValue('ABC','datastamp')}";
  eval.setVariable(".dataout.ABC","hcat://hcat.server.com:5080/mydb/clicks/datastamp=20120230;region=US");
  eval.setVariable(".dataout.ABC.unresolved",Boolean.FALSE);
  String res=CoordELFunctions.evalAndWrap(eval,expr);
  assertTrue(res.equals("20120230"));
  expr="${coord:dataOutPartitionValue('ABC','region')}";
  res=CoordELFunctions.evalAndWrap(eval,expr);
  assertTrue(res.equals("US"));
  init("coord-sla-create");
  eval.setVariable(".dataout.ABC","hcat://hcat.server.com:5080/mydb/clicks/datastamp=20120230;region=US");
  eval.setVariable(".dataout.ABC.unresolved",Boolean.FALSE);
  expr="${coord:dataOutPartitionValue('ABC','datastamp')}";
  res=CoordELFunctions.evalAndWrap(eval,expr);
  assertTrue(res.equals("20120230"));
  expr="${coord:dataOutPartitionValue('ABC','region')}";
  res=CoordELFunctions.evalAndWrap(eval,expr);
  assertTrue(res.equals("US"));
}

</code></pre>

<br>
<pre class="type-3 type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
/** 
 * Test dataInPartitionPigFilter EL function (phase 3) which returns the
 * partition filter to be used as input to load data from
 * @throws Exception
 */
@Test public void testdataInPartitionFilter() throws Exception {
  init("coord-action-start");
  eval.setVariable(".datain.ABC","hcat://hcat.server.com:5080/mydb/clicks/datastamp=12;region=us");
  eval.setVariable(".datain.ABC.unresolved",Boolean.FALSE);
  String expr="${coord:dataInPartitionFilter('ABC', 'pig')}";
  String res=CoordELFunctions.evalAndWrap(eval,expr);
  assertTrue(res.equals("(datastamp=='12' AND region=='us')") || res.equals("(region=='us' AND datastamp=='12')"));
  eval.setVariable(".datain.ABC","hcat://hcat.server.com:5080/mydb/clicks/datastamp=12;region=us," + "hcat://hcat.server.com:5080/mydb/clicks/datastamp=13;region=us");
  eval.setVariable(".datain.ABC.unresolved",Boolean.FALSE);
  expr="${coord:dataInPartitionFilter('ABC', 'pig')}";
  res=CoordELFunctions.evalAndWrap(eval,expr);
  assertTrue(res.equals("(datastamp=='12' AND region=='us') OR (datastamp=='13' AND region=='us')") || res.equals("(datastamp=='12' AND region=='us') OR (region=='us' AND datastamp=='13')") || res.equals("(region=='us' AND datastamp=='12') OR (datastamp=='13' AND region=='us')")|| res.equals("(region=='us' AND datastamp=='12') OR (region=='us' AND datastamp=='13')"));
  eval.setVariable(".datain.ABC","hcat://hcat.server.com:5080/mydb/clicks/datastamp=12;region=us");
  eval.setVariable(".datain.ABC.unresolved",Boolean.FALSE);
  expr="${coord:dataInPartitionFilter('ABC', 'java')}";
  res=CoordELFunctions.evalAndWrap(eval,expr);
  assertTrue(res.equals("(datastamp='12' AND region='us')") || res.equals("(region='us' AND datastamp='12')"));
}

</code></pre>

<br>
<pre class="type-3 type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
/** 
 * Test dataInPartitionMin EL function (phase 3) which returns the minimum
 * value of a partition to be used as minimum in a range of input data to
 * load
 * @throws Exception
 */
@Test public void testDataInPartitionMin() throws Exception {
  init("coord-action-start");
  eval.setVariable(".datain.ABC","hcat://hcat.server.com:5080/mydb/clicks/datastamp=12;region=us," + "hcat://hcat.server.com:5080/mydb/clicks/datastamp=13;region=us," + "hcat://hcat.server.com:5080/mydb/clicks/datastamp=10;region=us");
  eval.setVariable(".datain.ABC.unresolved",Boolean.FALSE);
  String expr="${coord:dataInPartitionMin('ABC','datastamp')}";
  String res=CoordELFunctions.evalAndWrap(eval,expr);
  assertTrue(res.equals("10"));
}

</code></pre>

<br>
<pre class="type-3 type-4 type-1 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test dataInPartitions EL function (phase 3) which returns the complete partition value string of a single partition
 * in case of hive-export type.
 * @throws Exception
 */
@Test public void testDataInPartitions() throws Exception {
  init("coord-action-start");
  String expr="${coord:dataInPartitions('ABC', 'hive-export')}";
  eval.setVariable(".datain.ABC","hcat://hcat.server.com:5080/mydb/clicks/datastamp=20120230;region=us");
  eval.setVariable(".datain.ABC.unresolved",Boolean.FALSE);
  String res=CoordELFunctions.evalAndWrap(eval,expr);
  assertTrue(res.equals("datastamp='20120230',region='us'") || res.equals("region='us',datastamp='20120230'"));
  try {
    expr="${coord:dataInPartitions('ABC', 'invalid-type')}";
    eval.setVariable(".datain.ABC","hcat://hcat.server.com:5080/mydb/clicks/datastamp=20120230;region=us");
    eval.setVariable(".datain.ABC.unresolved",Boolean.FALSE);
    res=CoordELFunctions.evalAndWrap(eval,expr);
    fail("EL function should throw exception because of invalid type");
  }
 catch (  Exception e) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.oozie.dependency.TestFSURIHandler </h4><pre class="type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testExists() throws Exception {
  Path path1=new Path(getFsTestCaseDir() + "/2012/12/02/");
  Path path2=new Path(getFsTestCaseDir() + "/2012/12/12/");
  getFileSystem().mkdirs(path1);
  URIHandler handler=uriService.getURIHandler(path1.toUri());
  assertTrue(handler.exists(path1.toUri(),conf,getTestUser()));
  assertFalse(handler.exists(path2.toUri(),conf,getTestUser()));
  handler=uriService.getURIHandler(path1.toUri(),false);
  assertTrue(handler.exists(new URI(path1.toUri().getPath()),conf,getTestUser()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.oozie.dependency.TestHCatURIHandler </h4><pre class="type-3 type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testExists() throws Exception {
  createTestTable();
  addPartition(db,table,"year=2012;month=12;dt=02;country=us");
  URI hcatURI=getHCatURI(db,table,"country=us;year=2012;month=12;dt=02");
  URIHandler handler=uriService.getURIHandler(hcatURI);
  assertTrue(handler.exists(hcatURI,conf,getTestUser()));
  hcatURI=getHCatURI(db,table,"year=2012;month=12");
  assertTrue(handler.exists(hcatURI,conf,getTestUser()));
  addPartition(db,table,"year=2012;month=12;dt=03;country=us");
  hcatURI=getHCatURI(db,table,"country=us;month=12");
  assertTrue(handler.exists(hcatURI,conf,getTestUser()));
  hcatURI=getHCatURI(db,table,"country=us");
  assertTrue(handler.exists(hcatURI,conf,getTestUser()));
  hcatURI=getHCatURI(db,table,"dt=02");
  assertTrue(handler.exists(hcatURI,conf,getTestUser()));
  hcatURI=getHCatURI(db,table,"dt=05");
  assertFalse(handler.exists(hcatURI,conf,getTestUser()));
  hcatURI=getHCatURI(db,table,"month=02;dt=02");
  assertFalse(handler.exists(hcatURI,conf,getTestUser()));
  addPartition(db,table,"year=2012;month=12;dt=04;country=us");
  hcatURI=getHCatURI(db,table,"country=us;year=2012;month=12;dt=04");
  assertTrue(handler.exists(hcatURI,conf,getTestUser()));
  ((HCatURIHandler)handler).delete(hcatURI,conf,getTestUser());
  assertFalse(handler.exists(hcatURI,conf,getTestUser()));
  dropTestTable();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.oozie.dependency.TestURIHandlerService </h4><pre class="type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testGetURIHandler() throws Exception {
  URIHandlerService uriService=services.get(URIHandlerService.class);
  URI uri=uriService.getAuthorityWithScheme("/tmp/file");
  URIHandler uriHandler=uriService.getURIHandler(uri);
  assertTrue(uriHandler instanceof FSURIHandler);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.oozie.event.TestEventQueue </h4><pre class="type-1 type-2 type-8 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMemoryEventQueueBasic() throws Exception {
  EventHandlerService ehs=Services.get().get(EventHandlerService.class);
  assertNotNull(ehs);
  EventQueue eventQ=ehs.getEventQueue();
  assertNotNull(eventQ);
  assertTrue(eventQ instanceof MemoryEventQueue);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.oozie.jms.TestDefaultConnectionContext </h4><pre class="type-3 type-1 type-2 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testThreadLocalSession() throws JMSException {
  String jmsProps=services.getConf().get(JMSJobEventListener.JMS_CONNECTION_PROPERTIES);
  JMSConnectionInfo connInfo=new JMSConnectionInfo(jmsProps);
  ConnectionContext jmsContext=Services.get().get(JMSAccessorService.class).createConnectionContext(connInfo);
  Thread th=new Thread(new SessionThread(jmsContext));
  th.start();
  try {
    th.join();
  }
 catch (  InterruptedException e) {
    e.printStackTrace();
  }
  assertEquals(session1,session2);
  Session session3=jmsContext.createThreadLocalSession(Session.AUTO_ACKNOWLEDGE);
  Session session4=jmsContext.createThreadLocalSession(Session.AUTO_ACKNOWLEDGE);
  assertTrue(session3.equals(session4));
  assertFalse(session1.equals(session3));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.oozie.jms.TestHCatMessageHandler </h4><pre class="type-4 type-1 type-2 type-8 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test that message is processed to update the dependency map and mark
 * partition as available
 */
@Test public void testCacheUpdateByMessage(){
  try {
    String actionId1="1234465451";
    String actionId2="1234465452";
    String actionId3="1234465453";
    String actionId4="1234465454";
    HCatURI dep1=new HCatURI("hcat://hcat.server.com:5080/mydb/mytbl/dt=20120101;country=us");
    HCatURI dep2=new HCatURI("hcat://hcat.server.com:5080/mydb/mytbl/country=us;dt=20120101");
    HCatURI dep3=new HCatURI("hcat://hcat.server.com:5080/mydb/mytbl/dt=20120102;country=us");
    HCatURI dep4=new HCatURI("hcat://hcat.server.com:5080/mydb/mytbl/dt=20120102;country=us;state=CA");
    PartitionDependencyManagerService pdms=Services.get().get(PartitionDependencyManagerService.class);
    pdms.addMissingDependency(dep1,actionId1);
    pdms.addMissingDependency(dep2,actionId2);
    pdms.addMissingDependency(dep3,actionId3);
    pdms.addMissingDependency(dep4,actionId4);
    assertTrue(pdms.getWaitingActions(dep1).contains(actionId1));
    assertTrue(pdms.getWaitingActions(dep2).contains(actionId2));
    assertTrue(pdms.getWaitingActions(dep3).contains(actionId3));
    assertTrue(pdms.getWaitingActions(dep4).contains(actionId4));
    List<Map<String,String>> partitionsList=new ArrayList<Map<String,String>>();
    partitionsList.add(getPartitionMap("dt=20120101;country=us;state=CA"));
    partitionsList.add(getPartitionMap("dt=20120101;country=us;state=NY"));
    JSONAddPartitionMessage jsonMsg=new JSONAddPartitionMessage("thrift://" + dep1.getServer(),"",dep1.getDb(),dep1.getTable(),partitionsList,System.currentTimeMillis());
    Message msg=session.createTextMessage(jsonMsg.toString());
    msg.setStringProperty(HCatConstants.HCAT_EVENT,HCatEventMessage.EventType.ADD_PARTITION.toString());
    HCatMessageHandler hcatHandler=new HCatMessageHandler("hcat.server.com:5080");
    hcatHandler.process(msg);
    assertNull(pdms.getWaitingActions(dep1));
    assertNull(pdms.getWaitingActions(dep2));
    assertTrue(pdms.getWaitingActions(dep3).contains(actionId3));
    assertTrue(pdms.getWaitingActions(dep4).contains(actionId4));
    partitionsList.clear();
    partitionsList.add(getPartitionMap("dt=20120102;country=us;state=CA"));
    partitionsList.add(getPartitionMap("dt=20120102;country=us;state=NY"));
    jsonMsg=new JSONAddPartitionMessage("thrift://" + dep1.getServer(),"",dep1.getDb(),dep1.getTable(),partitionsList,System.currentTimeMillis());
    msg=session.createTextMessage(jsonMsg.toString());
    msg.setStringProperty(HCatConstants.HCAT_EVENT,HCatEventMessage.EventType.ADD_PARTITION.toString());
    HCatAccessorService hcatService=Services.get().get(HCatAccessorService.class);
    hcatService.registerForNotification(dep1,"hcat.topic1",hcatHandler);
    Topic topic=session.createTopic("hcat.topic1");
    MessageProducer producer=session.createProducer(topic);
    producer.send(msg);
    Thread.sleep(500);
    assertNull(pdms.getWaitingActions(dep3));
    assertNull(pdms.getWaitingActions(dep4));
    assertTrue(pdms.getAvailableDependencyURIs(actionId1).contains(dep1.getURI().toString()));
    assertTrue(pdms.getAvailableDependencyURIs(actionId2).contains(dep2.getURI().toString()));
    assertTrue(pdms.getAvailableDependencyURIs(actionId3).contains(dep3.getURI().toString()));
    assertTrue(pdms.getAvailableDependencyURIs(actionId4).contains(dep4.getURI().toString()));
  }
 catch (  Exception e) {
    e.printStackTrace();
    fail("Exception: " + e.getMessage());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.oozie.jms.TestJMSJobEventListener </h4><pre class="type-3 type-4 type-1 type-2 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOnWorkflowJobSuspendEvent() throws ParseException {
  JMSJobEventListener wfEventListener=new JMSJobEventListener();
  wfEventListener.init(conf);
  Date startDate=DateUtils.parseDateUTC("2012-07-22T00:00Z");
  WorkflowJobEvent wfe=new WorkflowJobEvent("wfId1","caId1",WorkflowJob.Status.SUSPENDED,"user1","wf-app-name1",startDate,null);
  ConnectionContext jmsContext=getConnectionContext();
  try {
    Session session=jmsContext.createSession(Session.AUTO_ACKNOWLEDGE);
    MessageConsumer consumer=jmsContext.createConsumer(session,wfEventListener.getTopic(wfe));
    wfEventListener.onWorkflowJobEvent(wfe);
    TextMessage message=(TextMessage)consumer.receive(5000);
    assertFalse(message.getText().contains("endTime"));
    WorkflowJobMessage wfFailMessage=JMSMessagingUtils.getEventMessage(message);
    assertEquals(WorkflowJob.Status.SUSPENDED,wfFailMessage.getStatus());
    assertEquals(startDate,wfFailMessage.getStartTime());
    assertEquals("wfId1",wfFailMessage.getId());
    assertEquals("caId1",wfFailMessage.getParentId());
    assertEquals(MessageType.JOB,wfFailMessage.getMessageType());
    assertEquals(AppType.WORKFLOW_JOB,wfFailMessage.getAppType());
    assertEquals(EventStatus.SUSPEND,wfFailMessage.getEventStatus());
    assertEquals("user1",wfFailMessage.getUser());
    assertEquals("wf-app-name1",wfFailMessage.getAppName());
    assertNull(wfFailMessage.getErrorCode());
    assertNull(wfFailMessage.getErrorMessage());
    wfEventListener.destroy();
  }
 catch (  Exception e) {
    e.printStackTrace();
    fail(e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-3 type-4 type-1 type-2 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOnCoordinatorActionStartEvent() throws ParseException {
  JMSJobEventListener coordEventListener=new JMSJobEventListener();
  coordEventListener.init(conf);
  Date startDate=DateUtils.parseDateUTC("2012-07-22T00:00Z");
  Date nominalTime=DateUtils.parseDateUTC("2011-07-11T00:00Z");
  CoordinatorActionEvent cae=new CoordinatorActionEvent("caId1","caJobId1",CoordinatorAction.Status.RUNNING,"user1","wf-app-name1",nominalTime,startDate,null);
  ConnectionContext jmsContext=getConnectionContext();
  try {
    Session session=jmsContext.createSession(Session.AUTO_ACKNOWLEDGE);
    MessageConsumer consumer=jmsContext.createConsumer(session,coordEventListener.getTopic(cae));
    coordEventListener.onCoordinatorActionEvent(cae);
    TextMessage message=(TextMessage)consumer.receive(5000);
    assertFalse(message.getText().contains("endTime"));
    assertFalse(message.getText().contains("errorCode"));
    assertFalse(message.getText().contains("errorMessage"));
    assertFalse(message.getText().contains("missingDependency"));
    CoordinatorActionMessage coordActionStartMessage=JMSMessagingUtils.getEventMessage(message);
    assertEquals(CoordinatorAction.Status.RUNNING,coordActionStartMessage.getStatus());
    assertEquals(startDate,coordActionStartMessage.getStartTime());
    assertEquals("caJobId1",coordActionStartMessage.getParentId());
    assertEquals("caId1",coordActionStartMessage.getId());
    assertEquals(MessageType.JOB,coordActionStartMessage.getMessageType());
    assertEquals(AppType.COORDINATOR_ACTION,coordActionStartMessage.getAppType());
    assertEquals(EventStatus.STARTED,coordActionStartMessage.getEventStatus());
    assertEquals("user1",coordActionStartMessage.getUser());
    assertEquals("wf-app-name1",coordActionStartMessage.getAppName());
  }
 catch (  Exception e) {
    e.printStackTrace();
    fail(e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-3 type-4 type-1 type-2 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOnWorkflowJobStartedEvent() throws ParseException {
  JMSJobEventListener wfEventListener=new JMSJobEventListener();
  wfEventListener.init(conf);
  Date startDate=DateUtils.parseDateUTC("2012-07-22T00:00Z");
  WorkflowJobEvent wfe=new WorkflowJobEvent("wfId1","caId1",WorkflowJob.Status.RUNNING,"user1","wf-app-name1",startDate,null);
  ConnectionContext jmsContext=getConnectionContext();
  try {
    Session session=jmsContext.createSession(Session.AUTO_ACKNOWLEDGE);
    MessageConsumer consumer=jmsContext.createConsumer(session,wfEventListener.getTopic(wfe));
    wfEventListener.onWorkflowJobEvent(wfe);
    TextMessage message=(TextMessage)consumer.receive(5000);
    assertFalse(message.getText().contains("endTime"));
    WorkflowJobMessage wfStartMessage=JMSMessagingUtils.getEventMessage(message);
    assertEquals(WorkflowJob.Status.RUNNING,wfStartMessage.getStatus());
    assertEquals(startDate,wfStartMessage.getStartTime());
    assertEquals("wfId1",wfStartMessage.getId());
    assertEquals("caId1",wfStartMessage.getParentId());
    assertEquals(MessageType.JOB,wfStartMessage.getMessageType());
    assertEquals(AppType.WORKFLOW_JOB,wfStartMessage.getAppType());
    assertEquals(EventStatus.STARTED,wfStartMessage.getEventStatus());
    assertEquals("user1",wfStartMessage.getUser());
    assertEquals("wf-app-name1",wfStartMessage.getAppName());
    wfEventListener.destroy();
  }
 catch (  Exception e) {
    e.printStackTrace();
    fail(e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-3 type-4 type-1 type-2 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOnCoordinatorJobSuccessEvent() throws ParseException {
  JMSJobEventListener coordEventListener=new JMSJobEventListener();
  coordEventListener.init(conf);
  Date startDate=DateUtils.parseDateUTC("2012-07-22T00:00Z");
  Date nominalTime=DateUtils.parseDateUTC("2011-07-11T00:00Z");
  Date endDate=new Date();
  CoordinatorActionEvent cae=new CoordinatorActionEvent("caId1","caJobId1",CoordinatorAction.Status.SUCCEEDED,"user1","wf-app-name1",nominalTime,startDate,null);
  cae.setEndTime(endDate);
  ConnectionContext jmsContext=getConnectionContext();
  try {
    Session session=jmsContext.createSession(Session.AUTO_ACKNOWLEDGE);
    MessageConsumer consumer=jmsContext.createConsumer(session,coordEventListener.getTopic(cae));
    coordEventListener.onCoordinatorActionEvent(cae);
    TextMessage message=(TextMessage)consumer.receive(5000);
    assertFalse(message.getText().contains("errorCode"));
    assertFalse(message.getText().contains("errorMessage"));
    assertFalse(message.getText().contains("missingDependency"));
    CoordinatorActionMessage coordActionSuccessMessage=JMSMessagingUtils.getEventMessage(message);
    assertEquals(CoordinatorAction.Status.SUCCEEDED,coordActionSuccessMessage.getStatus());
    assertEquals(startDate,coordActionSuccessMessage.getStartTime());
    assertEquals(endDate,coordActionSuccessMessage.getEndTime());
    assertEquals("caJobId1",coordActionSuccessMessage.getParentId());
    assertEquals("caId1",coordActionSuccessMessage.getId());
    assertEquals(MessageType.JOB,coordActionSuccessMessage.getMessageType());
    assertEquals(AppType.COORDINATOR_ACTION,coordActionSuccessMessage.getAppType());
    assertEquals(EventStatus.SUCCESS,coordActionSuccessMessage.getEventStatus());
    assertEquals("user1",coordActionSuccessMessage.getUser());
    assertEquals("wf-app-name1",coordActionSuccessMessage.getAppName());
  }
 catch (  Exception e) {
    e.printStackTrace();
    fail(e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-3 type-4 type-1 type-2 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOnCoordinatorActionWaitingEvent() throws ParseException {
  JMSJobEventListener wfEventListner=new JMSJobEventListener();
  wfEventListner.init(conf);
  Date startDate=DateUtils.parseDateUTC("2012-07-22T00:00Z");
  Date nominalTime=DateUtils.parseDateUTC("2011-07-11T00:00Z");
  CoordinatorActionEvent cae=new CoordinatorActionEvent("caId1","caJobId1",CoordinatorAction.Status.WAITING,"user1","wf-app-name1",nominalTime,startDate,"missingDep1");
  ConnectionContext jmsContext=getConnectionContext();
  try {
    Session session=jmsContext.createSession(Session.AUTO_ACKNOWLEDGE);
    MessageConsumer consumer=jmsContext.createConsumer(session,wfEventListner.getTopic(cae));
    wfEventListner.onCoordinatorActionEvent(cae);
    TextMessage message=(TextMessage)consumer.receive(5000);
    assertFalse(message.getText().contains("endTime"));
    assertFalse(message.getText().contains("errorCode"));
    assertFalse(message.getText().contains("errorMessage"));
    CoordinatorActionMessage coordActionWaitingMessage=JMSMessagingUtils.getEventMessage(message);
    assertEquals(CoordinatorAction.Status.WAITING,coordActionWaitingMessage.getStatus());
    assertEquals(startDate,coordActionWaitingMessage.getStartTime());
    assertEquals(nominalTime,coordActionWaitingMessage.getNominalTime());
    assertEquals("caJobId1",coordActionWaitingMessage.getParentId());
    assertEquals("caId1",coordActionWaitingMessage.getId());
    assertEquals(MessageType.JOB,coordActionWaitingMessage.getMessageType());
    assertEquals(AppType.COORDINATOR_ACTION,coordActionWaitingMessage.getAppType());
    assertEquals(EventStatus.WAITING,coordActionWaitingMessage.getEventStatus());
    assertEquals("user1",coordActionWaitingMessage.getUser());
    assertEquals("wf-app-name1",coordActionWaitingMessage.getAppName());
    assertEquals("missingDep1",coordActionWaitingMessage.getMissingDependency());
  }
 catch (  Exception e) {
    e.printStackTrace();
    fail(e.getMessage());
  }
}

</code></pre>

<br>
<pre class="type-3 type-4 type-1 type-2 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOnCoordinatorJobFailureEvent() throws ParseException {
  JMSJobEventListener coordEventListener=new JMSJobEventListener();
  coordEventListener.init(conf);
  Date startDate=DateUtils.parseDateUTC("2012-07-22T00:00Z");
  Date nominalTime=DateUtils.parseDateUTC("2011-07-11T00:00Z");
  Date endDate=new Date();
  CoordinatorActionEvent cae=new CoordinatorActionEvent("caId1","caJobId1",CoordinatorAction.Status.FAILED,"user1","wf-app-name1",nominalTime,startDate,null);
  cae.setEndTime(endDate);
  cae.setErrorCode("E0101");
  cae.setErrorMessage("dummyError");
  ConnectionContext jmsContext=getConnectionContext();
  try {
    Session session=jmsContext.createSession(Session.AUTO_ACKNOWLEDGE);
    MessageConsumer consumer=jmsContext.createConsumer(session,coordEventListener.getTopic(cae));
    coordEventListener.onCoordinatorActionEvent(cae);
    TextMessage message=(TextMessage)consumer.receive(5000);
    assertFalse(message.getText().contains("missingDependency"));
    CoordinatorActionMessage coordActionFailMessage=JMSMessagingUtils.getEventMessage(message);
    assertEquals(CoordinatorAction.Status.FAILED,coordActionFailMessage.getStatus());
    assertEquals(startDate,coordActionFailMessage.getStartTime());
    assertEquals(endDate,coordActionFailMessage.getEndTime());
    assertEquals("caJobId1",coordActionFailMessage.getParentId());
    assertEquals("caId1",coordActionFailMessage.getId());
    assertEquals(MessageType.JOB,coordActionFailMessage.getMessageType());
    assertEquals(AppType.COORDINATOR_ACTION,coordActionFailMessage.getAppType());
    assertEquals(EventStatus.FAILURE,coordActionFailMessage.getEventStatus());
    assertEquals("user1",coordActionFailMessage.getUser());
    assertEquals("wf-app-name1",coordActionFailMessage.getAppName());
    assertEquals("E0101",coordActionFailMessage.getErrorCode());
    assertEquals("dummyError",coordActionFailMessage.getErrorMessage());
  }
 catch (  Exception e) {
    e.printStackTrace();
    fail(e.getMessage());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.oozie.service.TestEventHandlerService </h4><pre class="type-3 type-1 type-2 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEventLogging() throws Exception {
  EventHandlerService ehs=_testEventHandlerService();
  WorkflowJobEvent event=new WorkflowJobEvent("jobid","parentid",WorkflowJob.Status.RUNNING,getTestUser(),"myapp",null,null);
  TestLogAppender appender=null;
  Logger logger=null;
  try {
    appender=getTestLogAppender();
    logger=Logger.getLogger(EventHandlerService.class);
    logger.addAppender(appender);
    logger.setLevel(Level.DEBUG);
    ehs.queueEvent(event);
    List<LoggingEvent> log=appender.getLog();
    LoggingEvent logEntry=log.get(0);
    assertEquals(Level.DEBUG,logEntry.getLevel());
    assertTrue(logEntry.getMessage().toString().contains("APP[myapp] JOB[jobid] ACTION[-] Queueing event : ID: jobid"));
    assertEquals("org.apache.oozie.service.EventHandlerService",logEntry.getLoggerName());
    ehs.new EventWorker().run();
    log=appender.getLog();
    logEntry=log.get(1);
    assertEquals(Level.DEBUG,logEntry.getLevel());
    assertTrue(logEntry.getMessage().toString().contains("APP[myapp] JOB[jobid] ACTION[-] Processing event : ID: jobid"));
    CoordinatorActionEvent event2=new CoordinatorActionEvent("jobid2@1","parentid",CoordinatorAction.Status.WAITING,getTestUser(),"myapp",null,null,null);
    ehs.queueEvent(event2);
    log=appender.getLog();
    logEntry=log.get(2);
    assertTrue(logEntry.getMessage().toString().contains("APP[myapp] JOB[jobid2] ACTION[jobid2@1] Queueing event : ID: jobid2@1"));
    WorkflowJobEvent event3=new WorkflowJobEvent("jobid-other","parentid",WorkflowJob.Status.RUNNING,getTestUser(),"myapp-other",null,null);
    ehs.queueEvent(event3);
    log=appender.getLog();
    logEntry=log.get(3);
    assertTrue(logEntry.getMessage().toString().contains("APP[myapp-other] JOB[jobid-other] ACTION[-] Queueing event : ID: jobid-other"));
  }
  finally {
    logger.removeAppender(appender);
  }
}

</code></pre>

<br>
<pre class="type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testService() throws Exception {
  EventHandlerService ehs=_testEventHandlerService();
  assertTrue(ehs.getEventQueue() instanceof MemoryEventQueue);
  Set<String> jobtypes=ehs.getAppTypes();
  assertTrue(jobtypes.contains("workflow_job"));
  assertTrue(jobtypes.contains("coordinator_action"));
  Services services=Services.get();
  services.destroy();
  services=new Services();
  Configuration conf=services.getConf();
  conf.set(Services.CONF_SERVICE_EXT_CLASSES,"");
  services.init();
  assertFalse(EventHandlerService.isEnabled());
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testEventListener() throws Exception {
  EventHandlerService ehs=_testEventHandlerService();
  WorkflowJobEvent event=new WorkflowJobEvent("jobid","parentid",WorkflowJob.Status.RUNNING,getTestUser(),"myapp",null,null);
  ehs.queueEvent(event);
  ehs.new EventWorker().run();
  assertTrue(output.toString().contains("Workflow Job event STARTED"));
  output.setLength(0);
  event.setStatus(WorkflowJob.Status.SUSPENDED);
  ehs.queueEvent(event);
  ehs.new EventWorker().run();
  assertTrue(output.toString().contains("Workflow Job event SUSPEND"));
  output.setLength(0);
  event.setStatus(WorkflowJob.Status.SUCCEEDED);
  ehs.queueEvent(event);
  ehs.new EventWorker().run();
  assertTrue(output.toString().contains("Workflow Job event SUCCESS"));
  output.setLength(0);
  event.setStatus(WorkflowJob.Status.KILLED);
  ehs.queueEvent(event);
  ehs.new EventWorker().run();
  assertTrue(output.toString().contains("Workflow Job event FAILURE"));
  output.setLength(0);
  CoordinatorActionEvent event2=new CoordinatorActionEvent("parentid@1","parentid",CoordinatorAction.Status.WAITING,getTestUser(),"myapp",null,null,null);
  ehs.queueEvent(event2);
  ehs.new EventWorker().run();
  assertTrue(output.toString().contains("Coord Action event WAITING"));
  output.setLength(0);
  event2.setStatus(CoordinatorAction.Status.RUNNING);
  ehs.queueEvent(event2);
  ehs.new EventWorker().run();
  assertTrue(output.toString().contains("Coord Action event STARTED"));
  output.setLength(0);
  event2.setStatus(CoordinatorAction.Status.SUSPENDED);
  ehs.queueEvent(event2);
  ehs.new EventWorker().run();
  assertTrue(output.toString().contains("Coord Action event SUSPEND"));
  output.setLength(0);
  event2.setStatus(CoordinatorAction.Status.SUCCEEDED);
  ehs.queueEvent(event2);
  ehs.new EventWorker().run();
  assertTrue(output.toString().contains("Coord Action event SUCCESS"));
  output.setLength(0);
  event2.setStatus(CoordinatorAction.Status.TIMEDOUT);
  ehs.queueEvent(event2);
  ehs.new EventWorker().run();
  assertTrue(output.toString().contains("Coord Action event FAILURE"));
  output.setLength(0);
  event2.setStatus(CoordinatorAction.Status.KILLED);
  ehs.queueEvent(event2);
  ehs.new EventWorker().run();
  assertTrue(output.toString().contains("Coord Action event FAILURE"));
  output.setLength(0);
  WorkflowActionEvent event3=new WorkflowActionEvent("parentid@wfaction","parentid",WorkflowAction.Status.RUNNING,getTestUser(),"myapp",null,null);
  ehs.queueEvent(event3);
  ehs.new EventWorker().run();
  assertTrue(output.toString().contains("Workflow Action event STARTED"));
  output.setLength(0);
  event3.setStatus(WorkflowAction.Status.START_MANUAL);
  ehs.queueEvent(event3);
  ehs.new EventWorker().run();
  assertTrue(output.toString().contains("Workflow Action event SUSPEND"));
  output.setLength(0);
  event3.setStatus(WorkflowAction.Status.OK);
  ehs.queueEvent(event3);
  ehs.new EventWorker().run();
  assertTrue(output.toString().contains("Workflow Action event SUCCESS"));
  output.setLength(0);
  event3.setStatus(WorkflowAction.Status.ERROR);
  ehs.queueEvent(event3);
  ehs.new EventWorker().run();
  assertTrue(output.toString().contains("Workflow Action event FAILURE"));
  output.setLength(0);
  event3.setStatus(WorkflowAction.Status.KILLED);
  ehs.queueEvent(event3);
  ehs.new EventWorker().run();
  assertTrue(output.toString().contains("Workflow Action event FAILURE"));
  output.setLength(0);
  event3.setStatus(WorkflowAction.Status.FAILED);
  ehs.queueEvent(event3);
  ehs.new EventWorker().run();
  assertTrue(output.toString().contains("Workflow Action event FAILURE"));
  output.setLength(0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.oozie.service.TestHCatAccessorService </h4><pre class="type-1 type-2 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetHCatConfHDFS() throws Exception {
  Path hcatConfPath=new Path(getFsTestCaseDir(),"hive-site.xml");
  assertFalse(getFileSystem().exists(hcatConfPath));
  assertNull(services.get(HCatAccessorService.class).getHCatConf());
  Configuration hcatConf=new Configuration(false);
  hcatConf.set("A","a");
  FSDataOutputStream out=getFileSystem().create(hcatConfPath);
  hcatConf.writeXml(out);
  out.close();
  assertTrue(getFileSystem().exists(hcatConfPath));
  services.destroy();
  services=super.setupServicesForHCatalog();
  Configuration conf=services.getConf();
  conf.set("oozie.service.HCatAccessorService.hcat.configuration",hcatConfPath.toUri().toString());
  services.init();
  Configuration hcatConfLoaded=services.get(HCatAccessorService.class).getHCatConf();
  assertEquals("a",hcatConfLoaded.get("A"));
}

</code></pre>

<br>
<pre class="type-1 type-2 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetHCatConfLocal() throws Exception {
  File hcatConfFile=new File(getTestCaseConfDir(),"hive-site.xml");
  assertFalse(hcatConfFile.exists());
  assertNull(services.get(HCatAccessorService.class).getHCatConf());
  Configuration hcatConf=new Configuration(false);
  hcatConf.set("A","a");
  hcatConf.writeXml(new FileOutputStream(hcatConfFile));
  assertTrue(hcatConfFile.exists());
  services.destroy();
  services=super.setupServicesForHCatalog();
  Configuration conf=services.getConf();
  conf.set("oozie.service.HCatAccessorService.hcat.configuration",hcatConfFile.getAbsolutePath());
  services.init();
  Configuration hcatConfLoaded=services.get(HCatAccessorService.class).getHCatConf();
  assertEquals("a",hcatConfLoaded.get("A"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.oozie.service.TestJMSAccessorService </h4><pre class="type-4 type-1 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConnectionRetryExceptionListener() throws Exception {
  services.destroy();
  services=super.setupServicesForHCatalog();
  int randomPort=30000 + random.nextInt(10000);
  String brokerURL="tcp://localhost:" + randomPort;
  String jndiPropertiesString="java.naming.factory.initial#" + ActiveMQConnFactory + ";"+ "java.naming.provider.url#"+ brokerURL+ ";"+ "connectionFactoryNames#"+ "ConnectionFactory";
  Configuration servicesConf=services.getConf();
  servicesConf.set(JMSAccessorService.CONF_RETRY_INITIAL_DELAY,"1");
  servicesConf.set(JMSAccessorService.CONF_RETRY_MAX_ATTEMPTS,"3");
  servicesConf.set(HCatAccessorService.JMS_CONNECTIONS_PROPERTIES,"default=" + jndiPropertiesString);
  services.init();
  HCatAccessorService hcatService=Services.get().get(HCatAccessorService.class);
  JMSAccessorService jmsService=Services.get().get(JMSAccessorService.class);
  String publisherAuthority="hcat.server.com:5080";
  String topic="topic.topic1";
  BrokerService broker=new BrokerService();
  broker.addConnector(brokerURL);
  broker.start();
  JMSConnectionInfo connInfo=hcatService.getJMSConnectionInfo(new URI("hcat://hcat.server.com:8020"));
  jmsService.registerForNotification(connInfo,topic,new HCatMessageHandler(publisherAuthority));
  assertTrue(jmsService.isListeningToTopic(connInfo,topic));
  assertFalse(jmsService.isConnectionInRetryList(connInfo));
  assertFalse(jmsService.isTopicInRetryList(connInfo,topic));
  ConnectionContext connCtxt=jmsService.createConnectionContext(connInfo);
  broker.stop();
  try {
    connCtxt.createSession(Session.AUTO_ACKNOWLEDGE);
    fail("Exception expected");
  }
 catch (  Exception e) {
    Thread.sleep(100);
    assertFalse(jmsService.isListeningToTopic(connInfo,topic));
    assertTrue(jmsService.isConnectionInRetryList(connInfo));
    assertTrue(jmsService.isTopicInRetryList(connInfo,topic));
  }
  broker=new BrokerService();
  broker.addConnector(brokerURL);
  broker.start();
  Thread.sleep(1000);
  assertTrue(jmsService.isListeningToTopic(connInfo,topic));
  assertFalse(jmsService.isConnectionInRetryList(connInfo));
  assertFalse(jmsService.isTopicInRetryList(connInfo,topic));
  broker.stop();
  jmsService.destroy();
}

</code></pre>

<br>
<pre class="type-1 type-2 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConnection() throws Exception {
  HCatAccessorService hcatService=services.get(HCatAccessorService.class);
  JMSAccessorService jmsService=services.get(JMSAccessorService.class);
  JMSConnectionInfo connInfo=hcatService.getJMSConnectionInfo(new URI("hcat://hcatserver.blue.server.com:8020"));
  ConnectionContext ctxt1=jmsService.createConnectionContext(connInfo);
  assertTrue(ctxt1.isConnectionInitialized());
  JMSConnectionInfo connInfo1=hcatService.getJMSConnectionInfo(new URI("http://unknown:80"));
  ConnectionContext ctxt2=jmsService.createConnectionContext(connInfo1);
  assertTrue(ctxt2.isConnectionInitialized());
  assertEquals(ctxt1,ctxt2);
  ctxt1.close();
}

</code></pre>

<br>
<pre class="type-1 type-2 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConnectionRetryMaxAttempt() throws Exception {
  services.destroy();
  services=super.setupServicesForHCatalog();
  String jndiPropertiesString="java.naming.factory.initial#" + ActiveMQConnFactory + ";"+ "java.naming.provider.url#"+ "tcp://localhost:12345;connectionFactoryNames#ConnectionFactory";
  Configuration servicesConf=services.getConf();
  servicesConf.set(JMSAccessorService.CONF_RETRY_INITIAL_DELAY,"1");
  servicesConf.set(JMSAccessorService.CONF_RETRY_MAX_ATTEMPTS,"1");
  servicesConf.set(HCatAccessorService.JMS_CONNECTIONS_PROPERTIES,"default=" + jndiPropertiesString);
  services.init();
  HCatAccessorService hcatService=Services.get().get(HCatAccessorService.class);
  JMSAccessorService jmsService=Services.get().get(JMSAccessorService.class);
  String publisherAuthority="hcat.server.com:5080";
  String topic="topic.topic1";
  JMSConnectionInfo connInfo=hcatService.getJMSConnectionInfo(new URI("hcat://hcat.server.com:8020"));
  jmsService.registerForNotification(connInfo,topic,new HCatMessageHandler(publisherAuthority));
  assertTrue(jmsService.isConnectionInRetryList(connInfo));
  assertTrue(jmsService.isTopicInRetryList(connInfo,topic));
  assertFalse(jmsService.isListeningToTopic(connInfo,topic));
  Thread.sleep(1100);
  assertTrue(jmsService.isConnectionInRetryList(connInfo));
  assertTrue(jmsService.isTopicInRetryList(connInfo,topic));
  assertFalse(jmsService.isListeningToTopic(connInfo,topic));
  assertEquals(1,jmsService.getNumConnectionAttempts(connInfo));
  assertFalse(jmsService.retryConnection(connInfo));
  jmsService.destroy();
}

</code></pre>

<br>
<pre class="type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testConnectionRetry() throws Exception {
  services.destroy();
  services=super.setupServicesForHCatalog();
  int randomPort=30000 + random.nextInt(10000);
  String brokerURl="tcp://localhost:" + randomPort;
  Configuration servicesConf=services.getConf();
  servicesConf.set(JMSAccessorService.CONF_RETRY_INITIAL_DELAY,"1");
  servicesConf.set(JMSAccessorService.CONF_RETRY_MAX_ATTEMPTS,"3");
  servicesConf.set(HCatAccessorService.JMS_CONNECTIONS_PROPERTIES,"default=java.naming.factory.initial#" + ActiveMQConnFactory + ";"+ "java.naming.provider.url#"+ brokerURl+ ";"+ "connectionFactoryNames#"+ "ConnectionFactory");
  services.init();
  HCatAccessorService hcatService=Services.get().get(HCatAccessorService.class);
  JMSAccessorService jmsService=Services.get().get(JMSAccessorService.class);
  String publisherAuthority="hcat.server.com:5080";
  String topic="topic.topic1";
  JMSConnectionInfo connInfo=hcatService.getJMSConnectionInfo(new URI("hcat://hcat.server.com:8020"));
  jmsService.registerForNotification(connInfo,topic,new HCatMessageHandler(publisherAuthority));
  assertFalse(jmsService.isListeningToTopic(connInfo,topic));
  assertTrue(jmsService.isConnectionInRetryList(connInfo));
  assertTrue(jmsService.isTopicInRetryList(connInfo,topic));
  BrokerService broker=new BrokerService();
  broker.addConnector(brokerURl);
  broker.start();
  Thread.sleep(1000);
  assertTrue(jmsService.isListeningToTopic(connInfo,topic));
  assertFalse(jmsService.isConnectionInRetryList(connInfo));
  assertFalse(jmsService.isTopicInRetryList(connInfo,topic));
  broker.stop();
  jmsService.destroy();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.oozie.service.TestJMSTopicService </h4><pre class="type-4 type-1 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIncorrectConfigurationDefault(){
  try {
    services=setupServicesForTopic();
    services.getConf().set(JMSTopicService.TOPIC_NAME,"default=" + "invalidvalue");
    services.init();
    fail("Expected Service Exception");
  }
 catch (  ServiceException se) {
    assertTrue(se.getMessage().contains("not allowed in default"));
  }
}

</code></pre>

<br>
<pre class="type-4 type-1 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIncorrectConfigurationJobType(){
  try {
    services=setupServicesForTopic();
    services.getConf().set(JMSTopicService.TOPIC_NAME,"InvalidJobType" + " = workflow," + JMSTopicService.JobType.COORDINATOR.getValue() + "=coord");
    services.init();
    fail("Expected Service Exception");
  }
 catch (  ServiceException se) {
    assertTrue(se.getMessage().contains("Incorrect job type"));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.oozie.service.TestPartitionDependencyManagerEhcache </h4><pre class="type-12 type-1 type-2 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMaxElementsInMemory() throws Exception {
  setupServices("testmaxelementsinmemory");
  PartitionDependencyManagerService pdms=Services.get().get(PartitionDependencyManagerService.class);
  int numItems=1000;
  for (int i=0; i < numItems; i++) {
    HCatURI dep=new HCatURI("hcat://hcat.server.com:5080/mydb/mytbl/id=" + i);
    pdms.addMissingDependency(dep,"" + i);
  }
  for (int i=0; i < 150; i++) {
    assertNull(pdms.getWaitingActions(new HCatURI("hcat://hcat.server.com:5080/mydb/mytbl/id=" + "" + i)));
  }
  int evicted=0;
  for (int i=150; i < 750; i++) {
    if (pdms.getWaitingActions(new HCatURI("hcat://hcat.server.com:5080/mydb/mytbl/id=" + "" + i)) == null) {
      evicted++;
    }
  }
  assertEquals(350,evicted);
  for (int i=750; i < 1000; i++) {
    String actionID="" + i;
    HCatURI dep=new HCatURI("hcat://hcat.server.com:5080/mydb/mytbl/id=" + actionID);
    Collection<String> waitingActions=pdms.getWaitingActions(dep);
    assertNotNull(dep.toURIString() + " is missing in cache",waitingActions);
    assertTrue(dep.toURIString() + " is missing in cache",waitingActions.contains(actionID));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.oozie.service.TestPartitionDependencyManagerService </h4><pre class="type-1 type-2 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPartitionDependency() throws Exception {
  String actionId1="1234465451";
  String actionId2="1234465452";
  String actionId3="1234465453";
  String actionId4="1234465454";
  String server1="hcat-server1.domain.com:5080";
  String server2="hcat-server2.domain.com:5080";
  String db="mydb";
  String table1="mytbl1";
  String table2="mytbl2";
  HCatURI dep1=new HCatURI("hcat://hcat-server1.domain.com:5080/mydb/mytbl1/dt=20120101;country=us");
  HCatURI dep2=new HCatURI("hcat://hcat-server1.domain.com:5080/mydb/mytbl1/country=us;dt=20120101");
  HCatURI dep3=new HCatURI("hcat://hcat-server2.domain.com:5080/mydb/mytbl2/dt=20120102;country=us");
  HCatURI dep4=new HCatURI("hcat://hcat-server2.domain.com:5080/mydb/mytbl2/dt=20120102;country=us;state=CA");
  PartitionDependencyManagerService pdms=Services.get().get(PartitionDependencyManagerService.class);
  addMissingDependencyAndRegister(dep1,actionId1,pdms);
  addMissingDependencyAndRegister(dep2,actionId1,pdms);
  addMissingDependencyAndRegister(dep2,actionId2,pdms);
  addMissingDependencyAndRegister(dep2,actionId3,pdms);
  addMissingDependencyAndRegister(dep3,actionId3,pdms);
  addMissingDependencyAndRegister(dep4,actionId4,pdms);
  addMissingDependencyAndRegister(dep4,actionId4,pdms);
  addMissingDependencyAndRegister(dep4,actionId4,pdms);
  HCatAccessorService hcatService=Services.get().get(HCatAccessorService.class);
  JMSAccessorService jmsService=Services.get().get(JMSAccessorService.class);
  JMSConnectionInfo connInfo=hcatService.getJMSConnectionInfo(dep1.getURI());
  assertTrue(hcatService.isRegisteredForNotification(dep1));
  assertTrue(hcatService.isRegisteredForNotification(dep3));
  assertTrue(jmsService.isListeningToTopic(connInfo,dep1.getDb() + "." + dep1.getTable()));
  assertTrue(jmsService.isListeningToTopic(connInfo,dep3.getDb() + "." + dep3.getTable()));
  assertTrue(pdms.getWaitingActions(dep1).contains(actionId1));
  assertTrue(pdms.getWaitingActions(dep2).contains(actionId1));
  assertTrue(pdms.getWaitingActions(dep2).contains(actionId2));
  assertTrue(pdms.getWaitingActions(dep2).contains(actionId2));
  assertTrue(pdms.getWaitingActions(dep3).contains(actionId3));
  assertTrue(pdms.getWaitingActions(dep4).contains(actionId4));
  assertEquals(1,pdms.getWaitingActions(dep4).size());
  pdms.removeMissingDependency(dep2,actionId1);
  assertTrue(pdms.getWaitingActions(dep1).contains(actionId1));
  assertEquals(2,pdms.getWaitingActions(dep2).size());
  assertTrue(!pdms.getWaitingActions(dep2).contains(actionId1));
  assertNull(pdms.getAvailableDependencyURIs(actionId1));
  pdms.partitionAvailable(server2,db,table2,getPartitionMap("dt=20120102;country=us;state=NY"));
  assertNull(pdms.getWaitingActions(dep3));
  assertTrue(pdms.getAvailableDependencyURIs(actionId3).contains(dep3.getURI().toString()));
  pdms.partitionAvailable(server2,db,table2,getPartitionMap("dt=20120102;country=us;state=CA"));
  assertNull(pdms.getWaitingActions(dep4));
  assertTrue(pdms.getAvailableDependencyURIs(actionId4).contains(dep4.getURI().toString()));
  pdms.partitionAvailable(server1,db,table1,getPartitionMap("dt=20120101;country=us"));
  assertNull(pdms.getWaitingActions(dep1));
  assertNull(pdms.getWaitingActions(dep2));
  assertTrue(pdms.getAvailableDependencyURIs(actionId2).contains(dep2.getURI().toString()));
  assertTrue(pdms.getAvailableDependencyURIs(actionId3).contains(dep2.getURI().toString()));
  assertTrue(pdms.getAvailableDependencyURIs(actionId3).contains(dep3.getURI().toString()));
  assertTrue(pdms.removeAvailableDependencyURIs(actionId3,pdms.getAvailableDependencyURIs(actionId3)));
  assertNull(pdms.getAvailableDependencyURIs(actionId3));
  assertFalse(hcatService.isRegisteredForNotification(dep1));
  assertFalse(hcatService.isRegisteredForNotification(dep3));
  assertFalse(jmsService.isListeningToTopic(connInfo,dep1.getDb() + "." + dep1.getTable()));
  assertFalse(jmsService.isListeningToTopic(connInfo,dep3.getDb() + "." + dep3.getTable()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.oozie.service.TestShareLibService </h4><pre class="type-3 type-1 type-2 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPurgeLauncherJar() throws Exception {
  services=new Services();
  setSystemProps();
  Configuration conf=services.get(ConfigurationService.class).getConf();
  conf.set(ShareLibService.SHIP_LAUNCHER_JAR,"true");
  FileSystem fs=getFileSystem();
  long expiryTime=System.currentTimeMillis() - TimeUnit.MILLISECONDS.convert(services.get(ConfigurationService.class).getConf().getInt(ShareLibService.LAUNCHERJAR_LIB_RETENTION,7),TimeUnit.DAYS);
  String expireTs=dt.format(new Date(expiryTime - TimeUnit.MILLISECONDS.convert(1,TimeUnit.DAYS)));
  String noexpireTs=dt.format(new Date(expiryTime + TimeUnit.MILLISECONDS.convert(1,TimeUnit.DAYS)));
  String noexpireTs1=dt.format(new Date(expiryTime + TimeUnit.MILLISECONDS.convert(2,TimeUnit.DAYS)));
  Path basePath=new Path(services.get(ConfigurationService.class).getConf().get(WorkflowAppService.SYSTEM_LIB_PATH));
  Path expirePath=new Path(basePath,ShareLibService.LAUNCHER_LIB_PREFIX + expireTs);
  Path noexpirePath=new Path(basePath,ShareLibService.LAUNCHER_LIB_PREFIX + noexpireTs);
  Path noexpirePath1=new Path(basePath,ShareLibService.LAUNCHER_LIB_PREFIX + noexpireTs1);
  createDirs(fs,expirePath,noexpirePath,noexpirePath1);
  try {
    services.init();
    assertEquals(4,fs.listStatus(basePath).length);
    assertTrue(fs.exists(noexpirePath));
    assertTrue(fs.exists(noexpirePath1));
    assertTrue(fs.exists(expirePath));
  }
  finally {
    services.destroy();
  }
}

</code></pre>

<br>
<pre class="type-1 type-2 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDuplicateJarsInDistributedCache() throws Exception {
  services=new Services();
  setSystemProps();
  FileSystem fs=getFileSystem();
  Path basePath=new Path(services.get(ConfigurationService.class).getConf().get(WorkflowAppService.SYSTEM_LIB_PATH));
  Configuration conf=services.get(ConfigurationService.class).getConf();
  conf.set(ShareLibService.SHIP_LAUNCHER_JAR,"true");
  Date time=new Date(System.currentTimeMillis());
  Path libpath=new Path(basePath,ShareLibService.SHARE_LIB_PREFIX + ShareLibService.dateFormat.format(time));
  Path pigPath=new Path(libpath.toString() + Path.SEPARATOR + "pig");
  createDirs(fs,pigPath,new Path(pigPath,"temp"));
  createFile(new Path(pigPath,"pig.jar"));
  createFile(new Path(pigPath,"hive.jar"));
  createFile(new Path(new Path(pigPath,"temp"),"pig.jar#pig.jar"));
  try {
    verifyFilesInDistributedCache(setUpPigJob(true),"pig.jar","hive.jar","MyOozie.jar","MyPig.jar");
    ShareLibService shareLibService=services.get(ShareLibService.class);
    List<Path> shareLib=shareLibService.getShareLibJars("pig");
    assertEquals(shareLib.size(),3);
    assertTrue(shareLib.toString().contains("pig.jar#pig.jar"));
    assertTrue(shareLib.toString().contains("hive.jar"));
  }
  finally {
    services.destroy();
  }
}

</code></pre>

<br>
<pre class="type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testShareLibLoadFile() throws Exception {
  services=new Services();
  FileSystem fs=getFileSystem();
  setSystemProps();
  createTestShareLibMetaFile(fs);
  Configuration conf=services.get(ConfigurationService.class).getConf();
  conf.set(ShareLibService.SHARELIB_MAPPING_FILE,fs.getUri() + "/user/test/config.properties");
  conf.set(ShareLibService.SHIP_LAUNCHER_JAR,"true");
  try {
    services.init();
    ShareLibService shareLibService=Services.get().get(ShareLibService.class);
    assertTrue(shareLibService.getShareLibJars("something_new").get(0).getName().endsWith("somethingNew.jar"));
    assertTrue(shareLibService.getShareLibJars("pig").get(0).getName().endsWith("pig.jar"));
    fs.delete(new Path("shareLibPath/"),true);
  }
  finally {
    services.destroy();
  }
}

</code></pre>

<br>
<pre class="type-1 type-2 type-8 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateLauncherLibPath() throws Exception {
  services=new Services();
  setSystemProps();
  Configuration conf=services.get(ConfigurationService.class).getConf();
  conf.set(ShareLibService.SHIP_LAUNCHER_JAR,"true");
  try {
    services.init();
    ShareLibService shareLibService=Services.get().get(ShareLibService.class);
    List<Path> launcherPath=shareLibService.getSystemLibJars(JavaActionExecutor.OOZIE_COMMON_LIBDIR);
    assertNotNull(launcherPath);
    assertTrue(getFileSystem().exists(launcherPath.get(0)));
    List<Path> pigLauncherPath=shareLibService.getSystemLibJars("pig");
    assertTrue(getFileSystem().exists(pigLauncherPath.get(0)));
  }
  finally {
    services.destroy();
  }
}

</code></pre>

<br>
<pre class="type-4 type-1 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testfailFast() throws Exception {
  services=new Services();
  setSystemProps();
  Configuration conf=services.get(ConfigurationService.class).getConf();
  conf.set(ShareLibService.FAIL_FAST_ON_STARTUP,"true");
  conf.set(ShareLibService.SHARELIB_MAPPING_FILE,String.valueOf(new Date().getTime()));
  try {
    services.init();
    fail("Should throw exception");
  }
 catch (  Throwable e) {
    assertTrue(e.getMessage().contains("E0104: Could not fully initialize service"));
  }
 finally {
    services.destroy();
  }
}

</code></pre>

<br>
<pre class="type-3 type-1 type-2 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPurgeShareLib() throws Exception {
  services=new Services();
  setSystemProps();
  Configuration conf=services.get(ConfigurationService.class).getConf();
  conf.set(ShareLibService.SHIP_LAUNCHER_JAR,"true");
  FileSystem fs=getFileSystem();
  long expiryTime=System.currentTimeMillis() - TimeUnit.MILLISECONDS.convert(services.get(ConfigurationService.class).getConf().getInt(ShareLibService.LAUNCHERJAR_LIB_RETENTION,7),TimeUnit.DAYS);
  String expireTs=dt.format(new Date(expiryTime - TimeUnit.MILLISECONDS.convert(1,TimeUnit.DAYS)));
  String noexpireTs=dt.format(new Date(expiryTime + TimeUnit.MILLISECONDS.convert(1,TimeUnit.DAYS)));
  String noexpireTs1=dt.format(new Date(expiryTime + TimeUnit.MILLISECONDS.convert(2,TimeUnit.DAYS)));
  Path basePath=new Path(services.get(ConfigurationService.class).getConf().get(WorkflowAppService.SYSTEM_LIB_PATH));
  Path expirePath=new Path(basePath,ShareLibService.SHARE_LIB_PREFIX + expireTs);
  Path noexpirePath=new Path(basePath,ShareLibService.SHARE_LIB_PREFIX + noexpireTs);
  Path noexpirePath1=new Path(basePath,ShareLibService.SHARE_LIB_PREFIX + noexpireTs1);
  createDirs(fs,expirePath,noexpirePath,noexpirePath1);
  try {
    services.init();
    assertEquals(4,fs.listStatus(basePath).length);
    assertTrue(fs.exists(noexpirePath));
    assertTrue(fs.exists(noexpirePath1));
    assertTrue(fs.exists(expirePath));
  }
  finally {
    services.destroy();
  }
}

</code></pre>

<br>
<pre class="type-3 type-1 type-2 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPurgeJar() throws Exception {
  services=new Services();
  setSystemProps();
  Configuration conf=services.get(ConfigurationService.class).getConf();
  conf.set(ShareLibService.SHIP_LAUNCHER_JAR,"true");
  final FileSystem fs=getFileSystem();
  long expiryTime=System.currentTimeMillis() - TimeUnit.MILLISECONDS.convert(services.get(ConfigurationService.class).getConf().getInt(ShareLibService.LAUNCHERJAR_LIB_RETENTION,7),TimeUnit.DAYS);
  String expireTs=dt.format(new Date(expiryTime - TimeUnit.MILLISECONDS.convert(1,TimeUnit.DAYS)));
  String expireTs1=dt.format(new Date(expiryTime - TimeUnit.MILLISECONDS.convert(2,TimeUnit.DAYS)));
  String noexpireTs=dt.format(new Date(expiryTime + TimeUnit.MILLISECONDS.convert(1,TimeUnit.DAYS)));
  String noexpireTs1=dt.format(new Date(expiryTime + TimeUnit.MILLISECONDS.convert(2,TimeUnit.DAYS)));
  final Path basePath=new Path(services.get(ConfigurationService.class).getConf().get(WorkflowAppService.SYSTEM_LIB_PATH));
  Path expirePath=new Path(basePath,ShareLibService.LAUNCHER_LIB_PREFIX + expireTs);
  Path expirePath1=new Path(basePath,ShareLibService.LAUNCHER_LIB_PREFIX + expireTs1);
  Path noexpirePath=new Path(basePath,ShareLibService.LAUNCHER_LIB_PREFIX + noexpireTs);
  Path noexpirePath1=new Path(basePath,ShareLibService.LAUNCHER_LIB_PREFIX + noexpireTs1);
  createDirs(fs,expirePath,expirePath1,noexpirePath,noexpirePath1);
  try {
    services.init();
    waitFor(20 * 1000,new Predicate(){
      @Override public boolean evaluate() throws Exception {
        return (fs.listStatus(basePath).length == 4);
      }
    }
);
    assertEquals(4,fs.listStatus(basePath).length);
    assertTrue(fs.exists(noexpirePath));
    assertTrue(fs.exists(noexpirePath1));
    assertTrue(fs.exists(expirePath));
    assertFalse(fs.exists(expirePath1));
  }
  finally {
    services.destroy();
  }
}

</code></pre>

<br>
<pre class="type-3 type-1 type-2 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConfFileAddedToDistributedCache() throws Exception {
  try {
    Properties prop=new Properties();
    prop.put("oozie.hive_conf","/user/test/" + sharelibPath + "/hive-site.xml#hive-site.xml");
    setupSharelibConf("hive-site.xml","oozie.hive_conf",prop);
    String actionXml="<pig>" + "<job-tracker>" + getJobTrackerUri() + "</job-tracker>"+ "<name-node>"+ getNameNodeUri()+ "</name-node>"+ "<script>test</script>"+ "</pig>";
    Element eActionXml=XmlUtils.parseXml(actionXml);
    XConfiguration protoConf=new XConfiguration();
    protoConf.set(WorkflowAppService.HADOOP_USER,getTestUser());
    WorkflowJobBean wfj=new WorkflowJobBean();
    protoConf.setBoolean(OozieClient.USE_SYSTEM_LIBPATH,true);
    wfj.setProtoActionConf(XmlUtils.prettyPrint(protoConf).toString());
    wfj.setConf(XmlUtils.prettyPrint(protoConf).toString());
    Context context=new TestJavaActionExecutor().new Context(wfj,new WorkflowActionBean());
    PigActionExecutor ae=new PigActionExecutor();
    Configuration jobConf=ae.createBaseHadoopConf(context,eActionXml);
    jobConf.set("oozie.action.sharelib.for.pig","hive_conf");
    ae.setLibFilesArchives(context,eActionXml,new Path("hdfs://dummyAppPath"),jobConf);
    URI[] cacheFiles=DistributedCache.getCacheFiles(jobConf);
    String cacheFilesStr=Arrays.toString(cacheFiles);
    assertEquals(jobConf.get("oozie.hive_conf-sharelib-test"),null);
    assertTrue(URLDecoder.decode(cacheFilesStr).contains("hive-site.xml#hive-site.xml"));
    setupSharelibConf("hbase-site.xml","oozie.hbase_conf");
    jobConf=ae.createBaseHadoopConf(context,eActionXml);
    jobConf.set("oozie.action.sharelib.for.pig","hbase_conf");
    ae.setLibFilesArchives(context,eActionXml,new Path("hdfs://dummyAppPath"),jobConf);
    cacheFiles=DistributedCache.getCacheFiles(jobConf);
    cacheFilesStr=Arrays.toString(cacheFiles);
    assertTrue(cacheFilesStr.contains("hbase-site.xml"));
  }
  finally {
    getFileSystem().delete(new Path(sharelibPath),true);
    services.destroy();
  }
}

</code></pre>

<br>
<pre class="type-3 type-1 type-2 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConfFileAddedToActionConf() throws Exception {
  try {
    XConfiguration protoConf=new XConfiguration();
    protoConf.set(WorkflowAppService.HADOOP_USER,getTestUser());
    WorkflowJobBean wfj=new WorkflowJobBean();
    protoConf.setBoolean(OozieClient.USE_SYSTEM_LIBPATH,true);
    wfj.setProtoActionConf(XmlUtils.prettyPrint(protoConf).toString());
    wfj.setConf(XmlUtils.prettyPrint(protoConf).toString());
    Context context=new TestJavaActionExecutor().new Context(wfj,new WorkflowActionBean());
    setupSharelibConf("hive-site.xml","oozie.hive_conf");
    ShareLibService shareLibService=services.get(ShareLibService.class);
    assertEquals(shareLibService.getShareLibConfigMap().get("hive_conf").values().size(),1);
    assertEquals(shareLibService.getShareLibConfigMap().get("hive_conf").keySet().toArray(new Path[]{})[0].getName(),"hive-site.xml");
    setupSharelibConf("hive-site.xml","oozie.hive_conf");
    String actionXml="<hive>" + "<job-tracker>" + getJobTrackerUri() + "</job-tracker>"+ "<name-node>"+ getNameNodeUri()+ "</name-node>"+ "<script>test</script>"+ "</hive>";
    Element eActionXml=XmlUtils.parseXml(actionXml);
    HiveActionExecutor ae=new HiveActionExecutor();
    Configuration jobConf=ae.createBaseHadoopConf(context,eActionXml);
    Configuration actionConf=ae.createBaseHadoopConf(context,eActionXml);
    jobConf.set("oozie.action.sharelib.for.hive","hive_conf");
    ae.setLibFilesArchives(context,eActionXml,new Path("hdfs://dummyAppPath"),jobConf);
    URI[] cacheFiles=DistributedCache.getCacheFiles(actionConf);
    String cacheFilesStr=Arrays.toString(cacheFiles);
    assertFalse(cacheFilesStr.contains("hive-site.xml"));
    jobConf=ae.createBaseHadoopConf(context,eActionXml);
    Properties prop=new Properties();
    actionConf=ae.createBaseHadoopConf(context,eActionXml);
    prop.put("oozie.hive_conf","/user/test/" + sharelibPath + "/hive-site.xml#hive-site.xml");
    setupSharelibConf("hive-site.xml","oozie.hive_conf",prop);
    jobConf.set("oozie.action.sharelib.for.hive","hive_conf");
    ae.setLibFilesArchives(context,eActionXml,new Path("hdfs://dummyAppPath"),jobConf);
    assertEquals(jobConf.get("oozie.hive_conf-sharelib-test"),"test");
  }
  finally {
    getFileSystem().delete(new Path(sharelibPath),true);
    services.destroy();
  }
}

</code></pre>

<br>
<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testShareLib() throws Exception {
  services=new Services();
  setSystemProps();
  Configuration conf=services.get(ConfigurationService.class).getConf();
  conf.set(ShareLibService.SHIP_LAUNCHER_JAR,"true");
  FileSystem fs=getFileSystem();
  String dir1=dt.format(new Date(System.currentTimeMillis() - TimeUnit.MILLISECONDS.convert(1,TimeUnit.DAYS)));
  String dir2=dt.format(new Date(System.currentTimeMillis() - TimeUnit.MILLISECONDS.convert(2,TimeUnit.DAYS)));
  String dir3=dt.format(new Date(System.currentTimeMillis() - TimeUnit.MILLISECONDS.convert(3,TimeUnit.DAYS)));
  Path basePath=new Path(services.get(ConfigurationService.class).getConf().get(WorkflowAppService.SYSTEM_LIB_PATH));
  Path path1=new Path(basePath,ShareLibService.SHARE_LIB_PREFIX + dir1);
  Path path2=new Path(basePath,ShareLibService.SHARE_LIB_PREFIX + dir2);
  Path path3=new Path(basePath,ShareLibService.SHARE_LIB_PREFIX + dir3);
  createDirs(fs,path1,path2,path3);
  createFile(path1.toString() + Path.SEPARATOR + "pig"+ Path.SEPARATOR+ "pig.jar");
  try {
    services.init();
    ShareLibService shareLibService=Services.get().get(ShareLibService.class);
    assertTrue(shareLibService.getShareLibJars("pig").get(0).getName().endsWith("pig.jar"));
  }
  finally {
    services.destroy();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.oozie.sla.TestSLACalculatorMemory </h4><pre class="type-3 type-1 type-2 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDuplicateEndMiss() throws Exception {
  EventHandlerService ehs=Services.get().get(EventHandlerService.class);
  SLACalculatorMemory slaCalcMemory=new SLACalculatorMemory();
  slaCalcMemory.init(Services.get().get(ConfigurationService.class).getConf());
  WorkflowJobBean job1=addRecordToWfJobTable(WorkflowJob.Status.RUNNING,WorkflowInstance.Status.RUNNING);
  SLARegistrationBean slaRegBean=_createSLARegistration(job1.getId(),AppType.WORKFLOW_JOB);
  Date startTime=new Date(System.currentTimeMillis() + 1 * 1 * 3600* 1000);
  slaRegBean.setExpectedStart(startTime);
  slaRegBean.setExpectedDuration(3600 * 1000);
  slaRegBean.setExpectedEnd(new Date(System.currentTimeMillis() - 1 * 1 * 3600* 1000));
  String jobId=slaRegBean.getId();
  slaCalcMemory.addRegistration(slaRegBean.getId(),slaRegBean);
  slaCalcMemory.updateJobSla(jobId);
  SLASummaryBean slaSummary=SLASummaryQueryExecutor.getInstance().get(SLASummaryQuery.GET_SLA_SUMMARY,jobId);
  slaRegBean=SLARegistrationQueryExecutor.getInstance().get(SLARegQuery.GET_SLA_REG_ALL,jobId);
  assertNotNull(slaRegBean.getCreatedTimestamp());
  assertEquals(slaRegBean.getCreatedTimestamp(),slaSummary.getCreatedTimestamp());
  assertEquals(4,slaSummary.getEventProcessed());
  slaCalcMemory.updateJobSla(jobId);
  slaSummary=SLASummaryQueryExecutor.getInstance().get(SLASummaryQuery.GET_SLA_SUMMARY,jobId);
  assertEquals(4,slaSummary.getEventProcessed());
  assertEquals(SLAStatus.MISS,slaSummary.getSLAStatus());
  slaCalcMemory.addJobStatus(jobId,WorkflowJob.Status.SUCCEEDED.toString(),EventStatus.SUCCESS,new Date(System.currentTimeMillis()),new Date(System.currentTimeMillis() + 1 * 1 * 3600* 1000));
  slaSummary=SLASummaryQueryExecutor.getInstance().get(SLASummaryQuery.GET_SLA_SUMMARY,jobId);
  assertEquals(6,slaSummary.getEventProcessed());
  assertEquals(SLAStatus.MISS,slaSummary.getSLAStatus());
  assertTrue(slaCalcMemory.addJobStatus(jobId,WorkflowJob.Status.RUNNING.toString(),EventStatus.STARTED,new Date(System.currentTimeMillis()),new Date(System.currentTimeMillis() + 1 * 1 * 3600* 1000)));
  slaSummary=SLASummaryQueryExecutor.getInstance().get(SLASummaryQuery.GET_SLA_SUMMARY,jobId);
  assertEquals(8,slaSummary.getEventProcessed());
  assertEquals(SLAStatus.MISS,slaSummary.getSLAStatus());
  assertEquals(0,slaCalcMemory.size());
  assertEquals(3,ehs.getEventQueue().size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.oozie.sla.TestSLAEventGeneration </h4><pre class="type-3 type-1 type-2 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Test for SLA Events generated through Coordinator Action commands
 * CoordSubmitX and CoordStartX
 * @throws Exception
 */
@Test public void testCoordinatorActionCommandsSubmitAndStart() throws Exception {
  ehs.setAppTypes(new HashSet<String>(Arrays.asList(new String[]{"coordinator_action"})));
  ehs.getEventQueue().clear();
  SLAService slas=services.get(SLAService.class);
  String coordXml=IOUtils.getResourceAsString("coord-action-sla.xml",-1);
  Path appPath=getFsTestCaseDir();
  writeToFile(coordXml,appPath,"coordinator.xml");
  Configuration conf=new XConfiguration();
  conf.set(OozieClient.COORDINATOR_APP_PATH,appPath.toString());
  String wfXml=IOUtils.getResourceAsString("wf-credentials.xml",-1);
  writeToFile(wfXml,appPath,"workflow.xml");
  conf.set("wfAppPath",appPath.toString());
  conf.set(OozieClient.USER_NAME,getTestUser());
  cal.setTime(new Date());
  cal.add(Calendar.MINUTE,-20);
  Date nominal=cal.getTime();
  String nominalTime=DateUtils.formatDateOozieTZ(nominal);
  conf.set("nominal_time",nominalTime);
  conf.set("start","2009-01-02T08:01Z");
  conf.set("frequency","coord:days(1)");
  conf.set("end","2009-01-03T08:00Z");
  cal.setTime(nominal);
  cal.add(Calendar.MINUTE,10);
  String expectedStart=DateUtils.formatDateOozieTZ(cal.getTime());
  cal.setTime(nominal);
  cal.add(Calendar.MINUTE,30);
  String expectedEnd=DateUtils.formatDateOozieTZ(cal.getTime());
  String appName="test-coord-sla";
  String jobId=new CoordSubmitXCommand(conf).call();
  Thread.sleep(500);
  final CoordActionGetJPAExecutor getCmd=new CoordActionGetJPAExecutor(jobId + "@1");
  CoordinatorActionBean action=jpa.execute(getCmd);
  String actionId=action.getId();
  SLACalcStatus slaEvent=slas.getSLACalculator().get(actionId);
  assertEquals(actionId,slaEvent.getId());
  assertEquals(appName,slaEvent.getAppName());
  assertEquals(AppType.COORDINATOR_ACTION,slaEvent.getAppType());
  assertEquals(nominalTime,DateUtils.formatDateOozieTZ(slaEvent.getNominalTime()));
  assertEquals(expectedStart,DateUtils.formatDateOozieTZ(slaEvent.getExpectedStart()));
  assertEquals(expectedEnd,DateUtils.formatDateOozieTZ(slaEvent.getExpectedEnd()));
  assertEquals(30 * 60 * 1000,slaEvent.getExpectedDuration());
  assertEquals(alert_events,slaEvent.getAlertEvents());
  slas.runSLAWorker();
  slaEvent=skipToSLAEvent();
  assertTrue(SLAStatus.NOT_STARTED == slaEvent.getSLAStatus());
  assertEquals(EventStatus.START_MISS,slaEvent.getEventStatus());
  ehs.getEventQueue().clear();
  action.setStatus(CoordinatorAction.Status.SUBMITTED);
  CoordActionQueryExecutor.getInstance().executeUpdate(CoordActionQuery.UPDATE_COORD_ACTION_STATUS_PENDING_TIME,action);
  new CoordActionStartXCommand(actionId,getTestUser(),appName,jobId).call();
  slaEvent=slas.getSLACalculator().get(actionId);
  slaEvent.setEventProcessed(0);
  SLASummaryBean suBean=new SLASummaryBean();
  suBean.setId(actionId);
  suBean.setEventProcessed(0);
  SLASummaryQueryExecutor.getInstance().executeUpdate(SLASummaryQuery.UPDATE_SLA_SUMMARY_EVENTPROCESSED,suBean);
  ehs.new EventWorker().run();
  slaEvent=skipToSLAEvent();
  assertEquals(actionId,slaEvent.getId());
  assertNotNull(slaEvent.getActualStart());
  assertEquals(SLAStatus.IN_PROCESS,slaEvent.getSLAStatus());
  assertEquals(CoordinatorAction.Status.RUNNING.name(),slaEvent.getJobStatus());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.oozie.sla.TestSLAJobEventListener </h4><pre class="type-1 type-2 type-8 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testListenerConfigured() throws Exception {
  EventHandlerService ehs=services.get(EventHandlerService.class);
  assertNotNull(ehs);
  assertTrue(SLAService.isEnabled());
  assertTrue(ehs.listEventListeners().contains(SLAJobEventListener.class.getCanonicalName()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.oozie.sla.TestSLAService </h4><pre class="type-1 type-2 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testUpdateSLA() throws Exception {
  SLAService slas=Services.get().get(SLAService.class);
  assertNotNull(slas);
  assertTrue(SLAService.isEnabled());
  EventHandlerService ehs=Services.get().get(EventHandlerService.class);
  SLARegistrationBean sla1=_createSLARegistration("job-1",AppType.WORKFLOW_JOB);
  sla1.setExpectedStart(new Date(System.currentTimeMillis() - 1 * 1 * 3600* 1000));
  sla1.setExpectedEnd(new Date(System.currentTimeMillis() - 1 * 1 * 3600* 1000));
  sla1.setExpectedDuration(10 * 60 * 1000);
  slas.addRegistrationEvent(sla1);
  assertEquals(1,slas.getSLACalculator().size());
  slas.runSLAWorker();
  ehs.new EventWorker().run();
  assertEventNoDuplicates(output.toString(),"Sla START - MISS!!!");
  assertEventNoDuplicates(output.toString(),"Sla END - MISS!!!");
  output.setLength(0);
  sla1=_createSLARegistration("job-2",AppType.WORKFLOW_JOB);
  sla1.setExpectedStart(new Date(System.currentTimeMillis() + 1 * 3600 * 1000));
  sla1.setExpectedEnd(new Date(System.currentTimeMillis() + 2 * 3600 * 1000));
  slas.addRegistrationEvent(sla1);
  slas.addStatusEvent(sla1.getId(),WorkflowJob.Status.RUNNING.name(),EventStatus.STARTED,new Date(),new Date());
  SLARegistrationBean sla2=_createSLARegistration("job-3",AppType.COORDINATOR_JOB);
  sla2.setExpectedStart(new Date(System.currentTimeMillis() + 1 * 3600 * 1000));
  sla2.setExpectedEnd(new Date(System.currentTimeMillis() - 2 * 3600 * 1000));
  sla2.setExpectedDuration(10);
  slas.addRegistrationEvent(sla2);
  assertEquals(3,slas.getSLACalculator().size());
  Date startTime=new Date();
  slas.addStatusEvent(sla2.getId(),CoordinatorJob.Status.RUNNING.name(),EventStatus.STARTED,startTime,null);
  slas.addStatusEvent(sla2.getId(),CoordinatorJob.Status.SUCCEEDED.name(),EventStatus.SUCCESS,startTime,new Date());
  slas.runSLAWorker();
  ehs.new EventWorker().run();
  assertTrue(output.toString().contains(sla1.getId() + " Sla START - MET!!!"));
  assertTrue(output.toString().contains(sla2.getId() + " Sla END - MISS!!!"));
  assertTrue(output.toString().contains(sla2.getId() + " Sla DURATION - MET!!!"));
  output.setLength(0);
  WorkflowJobBean job4=addRecordToWfJobTable(WorkflowJob.Status.KILLED,WorkflowInstance.Status.KILLED);
  sla2=_createSLARegistration(job4.getId(),AppType.WORKFLOW_JOB);
  sla2.setExpectedStart(new Date(System.currentTimeMillis() - 2 * 3600 * 1000));
  sla2.setExpectedEnd(new Date(System.currentTimeMillis() - 1 * 3600 * 1000));
  slas.addRegistrationEvent(sla2);
  assertEquals(3,slas.getSLACalculator().size());
  slas.runSLAWorker();
  ehs.new EventWorker().run();
  assertTrue(output.toString().contains(sla2.getId() + " Sla START - MISS!!!"));
  assertTrue(output.toString().contains(sla2.getId() + " Sla END - MISS!!!"));
  output.setLength(0);
  assertEquals(2,slas.getSLACalculator().size());
  sla1=_createSLARegistration("action@1",AppType.COORDINATOR_ACTION);
  sla1.setExpectedStart(new Date(System.currentTimeMillis() + 1 * 3600 * 1000));
  sla1.setExpectedEnd(new Date(System.currentTimeMillis() + 2 * 3600 * 1000));
  slas.addRegistrationEvent(sla1);
  assertEquals(3,slas.getSLACalculator().size());
  slas.addStatusEvent(sla1.getId(),CoordinatorAction.Status.RUNNING.name(),EventStatus.STARTED,new Date(),new Date());
  slas.addStatusEvent(sla1.getId(),CoordinatorAction.Status.SUCCEEDED.name(),EventStatus.SUCCESS,new Date(),new Date());
  slas.runSLAWorker();
  assertEquals(2,ehs.getEventQueue().size());
  ehs.new EventWorker().run();
  assertTrue(output.toString().contains(sla1.getId() + " Sla START - MET!!!"));
  assertTrue(output.toString().contains(sla1.getId() + " Sla END - MET!!!"));
}

</code></pre>

<br>
<pre class="type-1 type-2 type-8 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBasicService() throws Exception {
  Services services=Services.get();
  SLAService slas=services.get(SLAService.class);
  assertNotNull(slas);
  assertTrue(SLAService.isEnabled());
  services.destroy();
  services=new Services();
  Configuration conf=services.getConf();
  conf.set(Services.CONF_SERVICE_EXT_CLASSES,"");
  services.init();
  assertFalse(SLAService.isEnabled());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.oozie.tools.workflowgenerator.client.OozieWorkflowGeneratorTest </h4><pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void test1(){
  OozieWorkflowGenerator entry=new OozieWorkflowGenerator();
  assertTrue(entry instanceof OozieWorkflowGenerator);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.oozie.util.TestDateUtils </h4><pre class="type-1 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetTimeZoneValidFormats() throws Exception {
  Assert.assertEquals(TimeZone.getTimeZone("America/Los_Angeles"),DateUtils.getTimeZone("America/Los_Angeles"));
  Assert.assertEquals(TimeZone.getTimeZone("PST"),DateUtils.getTimeZone("PST"));
  Assert.assertEquals(TimeZone.getTimeZone("GMT"),DateUtils.getTimeZone("GMT"));
  TimeZone GMTOffsetColon=TimeZone.getTimeZone("GMT-07:00");
  TimeZone GMTOffsetNoColon=TimeZone.getTimeZone("GMT-0700");
  TimeZone oozieGMTOffsetColon=DateUtils.getTimeZone("GMT-07:00");
  TimeZone oozieGMTOffsetNoColon=DateUtils.getTimeZone("GMT-0700");
  Assert.assertEquals(GMTOffsetColon,GMTOffsetNoColon);
  Assert.assertEquals(GMTOffsetNoColon,oozieGMTOffsetColon);
  Assert.assertEquals(oozieGMTOffsetColon,oozieGMTOffsetNoColon);
  Assert.assertFalse(TimeZone.getTimeZone("GMT").equals(oozieGMTOffsetNoColon));
  GMTOffsetColon=TimeZone.getTimeZone("GMT+05:30");
  GMTOffsetNoColon=TimeZone.getTimeZone("GMT+0530");
  oozieGMTOffsetColon=DateUtils.getTimeZone("GMT+05:30");
  oozieGMTOffsetNoColon=DateUtils.getTimeZone("GMT+0530");
  Assert.assertEquals(GMTOffsetColon,GMTOffsetNoColon);
  Assert.assertEquals(GMTOffsetNoColon,oozieGMTOffsetColon);
  Assert.assertEquals(oozieGMTOffsetColon,oozieGMTOffsetNoColon);
  Assert.assertFalse(TimeZone.getTimeZone("GMT").equals(oozieGMTOffsetNoColon));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.oozie.util.TestHCatURI </h4><pre class="type-4 type-1 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testToFilter(){
  String hcatURI="hcat://hcat.server.com:5080/mydb/clicks/datastamp=20120230;region=us";
  String filter="";
  try {
    filter=new HCatURI(hcatURI).toPartitionFilter("java");
  }
 catch (  URISyntaxException e) {
    fail(e.getMessage());
  }
  assertTrue(filter.equals("(datastamp='20120230' AND region='us')") || filter.equals("(region='us' AND datastamp='20120230')"));
}

</code></pre>

<br>
<pre class="type-4 type-1 type-2 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEqualsNegative(){
  HCatURI uri1=null;
  HCatURI uri2=null;
  HCatURI uri3=null;
  HCatURI uri4=null;
  HCatURI uri5=null;
  try {
    uri1=new HCatURI("hcat://hcat.server.com:5080/mydb/clicks/datastamp=12;region=us;timestamp=1201");
    uri2=new HCatURI("hcat://hcat.server.com:5080/mydb2/clicks/region=us;timestamp=1201;datastamp=12");
    uri3=new HCatURI("hcat://hcat.server.com:5080/mydb/clicks2/region=us;timestamp=1201;datastamp=12");
    uri4=new HCatURI("hcat://hcat.server.com:5080/mydb/clicks/region=uk;timestamp=1201;datastamp=12");
    uri5=new HCatURI("hcat://hcat.server.com:5080/mydb/clicks/region=us;timestamp=1201");
  }
 catch (  URISyntaxException e) {
    fail(e.getMessage());
  }
  assertFalse(uri1.equals(uri2));
  assertFalse(uri2.equals(uri1));
  assertFalse(uri1.equals(uri3));
  assertFalse(uri3.equals(uri1));
  assertFalse(uri1.equals(uri4));
  assertFalse(uri4.equals(uri1));
  assertFalse(uri1.equals(uri5));
  assertFalse(uri5.equals(uri1));
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
