<h3 style="margin:0px">Class: org.apache.oozie.service.TestShareLibService (19 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="2"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('2')" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls"><kbd id="tag-2"class="label-info"style="display: inline-block;font-size:7pt" >InternalCallVerifier&nbsp;(12)</kbd></button>&nbsp;<button id="1"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('1')" data-toggle="tooltip" title="Verifies boolean conditions"><kbd id="tag-1"class="label-info"style="display: inline-block;font-size:7pt" >BooleanVerifier&nbsp;(10)</kbd></button>&nbsp;<button id="6"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('6')" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value "><kbd id="tag-6"class="label-info"style="display: inline-block;font-size:7pt" >EqualityVerifier&nbsp;(9)</kbd></button>&nbsp;<button id="5"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('5')" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes"><kbd id="tag-5"class="label-info"style="display: inline-block;font-size:7pt" >HybridVerifier&nbsp;(9)</kbd></button>&nbsp;<button id="3"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('3')" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) "><kbd id="tag-3"class="label-info"style="display: inline-block;font-size:7pt" >APIUtilityVerifier&nbsp;(5)</kbd></button>&nbsp;<button id="8"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('8')" data-toggle="tooltip" title="Verifies whether objects are null"><kbd id="tag-8"class="label-info"style="display: inline-block;font-size:7pt" >NullVerifier&nbsp;(4)</kbd></button>&nbsp;<button id="7"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('7')" data-toggle="tooltip" title="Executes methods or other tests from the same test unit"><kbd id="tag-7"class="label-info"style="display: inline-block;font-size:7pt" >ExecutionTester&nbsp;(4)</kbd></button>&nbsp;<button id="4"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('4')" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure"><kbd id="tag-4"class="label-info"style="display: inline-block;font-size:7pt" >UtilityVerifier&nbsp;(1)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMultipleLauncherCall() throws Exception {
  services=new Services();
  setSystemProps();
  Configuration conf=services.get(ConfigurationService.class).getConf();
  conf.set(ShareLibService.SHIP_LAUNCHER_JAR,"true");
  try {
    FileSystem fs=getFileSystem();
    Date time=new Date(System.currentTimeMillis());
    Path basePath=new Path(services.get(ConfigurationService.class).getConf().get(WorkflowAppService.SYSTEM_LIB_PATH));
    Path libpath=new Path(basePath,ShareLibService.SHARE_LIB_PREFIX + ShareLibService.dateFormat.format(time));
    fs.mkdirs(libpath);
    Path ooziePath=new Path(libpath.toString() + Path.SEPARATOR + "oozie");
    fs.mkdirs(ooziePath);
    createFile(libpath.toString() + Path.SEPARATOR + "oozie"+ Path.SEPARATOR+ "oozie_luncher.jar");
    services.init();
    ShareLibService shareLibService=Services.get().get(ShareLibService.class);
    List<Path> launcherPath=shareLibService.getSystemLibJars(JavaActionExecutor.OOZIE_COMMON_LIBDIR);
    assertEquals(launcherPath.size(),2);
    launcherPath=shareLibService.getSystemLibJars(JavaActionExecutor.OOZIE_COMMON_LIBDIR);
    assertEquals(launcherPath.size(),2);
  }
  finally {
    services.destroy();
  }
}

</code></pre>

<pre class="type-3 type-1 type-2 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPurgeLauncherJar() throws Exception {
  services=new Services();
  setSystemProps();
  Configuration conf=services.get(ConfigurationService.class).getConf();
  conf.set(ShareLibService.SHIP_LAUNCHER_JAR,"true");
  FileSystem fs=getFileSystem();
  long expiryTime=System.currentTimeMillis() - TimeUnit.MILLISECONDS.convert(services.get(ConfigurationService.class).getConf().getInt(ShareLibService.LAUNCHERJAR_LIB_RETENTION,7),TimeUnit.DAYS);
  String expireTs=dt.format(new Date(expiryTime - TimeUnit.MILLISECONDS.convert(1,TimeUnit.DAYS)));
  String noexpireTs=dt.format(new Date(expiryTime + TimeUnit.MILLISECONDS.convert(1,TimeUnit.DAYS)));
  String noexpireTs1=dt.format(new Date(expiryTime + TimeUnit.MILLISECONDS.convert(2,TimeUnit.DAYS)));
  Path basePath=new Path(services.get(ConfigurationService.class).getConf().get(WorkflowAppService.SYSTEM_LIB_PATH));
  Path expirePath=new Path(basePath,ShareLibService.LAUNCHER_LIB_PREFIX + expireTs);
  Path noexpirePath=new Path(basePath,ShareLibService.LAUNCHER_LIB_PREFIX + noexpireTs);
  Path noexpirePath1=new Path(basePath,ShareLibService.LAUNCHER_LIB_PREFIX + noexpireTs1);
  createDirs(fs,expirePath,noexpirePath,noexpirePath1);
  try {
    services.init();
    assertEquals(4,fs.listStatus(basePath).length);
    assertTrue(fs.exists(noexpirePath));
    assertTrue(fs.exists(noexpirePath1));
    assertTrue(fs.exists(expirePath));
  }
  finally {
    services.destroy();
  }
}

</code></pre>

<pre class="type-2 type-8 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testShareLibLoadFileMultipleFile() throws Exception {
  FileSystem fs=getFileSystem();
  services=new Services();
  createTestShareLibMetaFile_multipleFile(fs);
  setSystemProps();
  Configuration conf=services.get(ConfigurationService.class).getConf();
  conf.set(ShareLibService.SHARELIB_MAPPING_FILE,fs.getUri() + "/user/test/config.properties");
  conf.set(ShareLibService.SHIP_LAUNCHER_JAR,"true");
  try {
    services.init();
    ShareLibService shareLibService=Services.get().get(ShareLibService.class);
    assertNull(shareLibService.getShareLibJars("something_new"));
    assertEquals(shareLibService.getShareLibJars("pig").size(),2);
    fs.delete(new Path("shareLibPath/"),true);
  }
  finally {
    services.destroy();
  }
}

</code></pre>

<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAddShareLib_pig_withVersion() throws Exception {
  services=new Services();
  setSystemProps();
  Configuration conf=services.get(ConfigurationService.class).getConf();
  conf.set(ShareLibService.SHIP_LAUNCHER_JAR,"true");
  FileSystem fs=getFileSystem();
  Date time=new Date(System.currentTimeMillis());
  Path basePath=new Path(services.get(ConfigurationService.class).getConf().get(WorkflowAppService.SYSTEM_LIB_PATH));
  Path libpath=new Path(basePath,ShareLibService.SHARE_LIB_PREFIX + ShareLibService.dateFormat.format(time));
  fs.mkdirs(libpath);
  Path pigPath=new Path(libpath.toString() + Path.SEPARATOR + "pig");
  Path pigPath1=new Path(libpath.toString() + Path.SEPARATOR + "pig_9");
  Path pigPath2=new Path(libpath.toString() + Path.SEPARATOR + "pig_10");
  fs.mkdirs(pigPath);
  fs.mkdirs(pigPath1);
  fs.mkdirs(pigPath2);
  createFile(libpath.toString() + Path.SEPARATOR + "pig_10"+ Path.SEPARATOR+ "pig-10.jar");
  try {
    services.init();
    String actionXml="<pig>" + "<job-tracker>" + getJobTrackerUri() + "</job-tracker>"+ "<name-node>"+ getNameNodeUri()+ "</name-node>"+ "<property><name>oozie.action.sharelib.for.pig</name><value>pig_10</value></property>"+ "</pig>";
    Element eActionXml=XmlUtils.parseXml(actionXml);
    XConfiguration protoConf=new XConfiguration();
    protoConf.set(WorkflowAppService.HADOOP_USER,getTestUser());
    WorkflowJobBean wfj=new WorkflowJobBean();
    protoConf.setBoolean(OozieClient.USE_SYSTEM_LIBPATH,true);
    wfj.setProtoActionConf(XmlUtils.prettyPrint(protoConf).toString());
    wfj.setConf(XmlUtils.prettyPrint(protoConf).toString());
    Context context=new TestJavaActionExecutor().new Context(wfj,new WorkflowActionBean());
    PigActionExecutor ae=new PigActionExecutor();
    Configuration jobConf=ae.createBaseHadoopConf(context,eActionXml);
    jobConf.set("oozie.action.sharelib.for.pig","pig_10");
    ae.setLibFilesArchives(context,eActionXml,new Path("hdfs://dummyAppPath"),jobConf);
    verifyFilesInDistributedCache(DistributedCache.getCacheFiles(jobConf),"MyPig.jar","MyOozie.jar","pig-10.jar");
  }
  finally {
    services.destroy();
  }
}

</code></pre>

<pre class="type-1 type-2 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDuplicateJarsInDistributedCache() throws Exception {
  services=new Services();
  setSystemProps();
  FileSystem fs=getFileSystem();
  Path basePath=new Path(services.get(ConfigurationService.class).getConf().get(WorkflowAppService.SYSTEM_LIB_PATH));
  Configuration conf=services.get(ConfigurationService.class).getConf();
  conf.set(ShareLibService.SHIP_LAUNCHER_JAR,"true");
  Date time=new Date(System.currentTimeMillis());
  Path libpath=new Path(basePath,ShareLibService.SHARE_LIB_PREFIX + ShareLibService.dateFormat.format(time));
  Path pigPath=new Path(libpath.toString() + Path.SEPARATOR + "pig");
  createDirs(fs,pigPath,new Path(pigPath,"temp"));
  createFile(new Path(pigPath,"pig.jar"));
  createFile(new Path(pigPath,"hive.jar"));
  createFile(new Path(new Path(pigPath,"temp"),"pig.jar#pig.jar"));
  try {
    verifyFilesInDistributedCache(setUpPigJob(true),"pig.jar","hive.jar","MyOozie.jar","MyPig.jar");
    ShareLibService shareLibService=services.get(ShareLibService.class);
    List<Path> shareLib=shareLibService.getShareLibJars("pig");
    assertEquals(shareLib.size(),3);
    assertTrue(shareLib.toString().contains("pig.jar#pig.jar"));
    assertTrue(shareLib.toString().contains("hive.jar"));
  }
  finally {
    services.destroy();
  }
}

</code></pre>

<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAddShareLib_pig() throws Exception {
  services=new Services();
  setSystemProps();
  Configuration conf=services.get(ConfigurationService.class).getConf();
  conf.set(ShareLibService.SHIP_LAUNCHER_JAR,"true");
  try {
    services.init();
    String actionXml="<pig>" + "<job-tracker>" + getJobTrackerUri() + "</job-tracker>"+ "<name-node>"+ getNameNodeUri()+ "</name-node>"+ "</pig>";
    Element eActionXml=XmlUtils.parseXml(actionXml);
    XConfiguration protoConf=new XConfiguration();
    protoConf.set(WorkflowAppService.HADOOP_USER,getTestUser());
    WorkflowJobBean wfj=new WorkflowJobBean();
    wfj.setProtoActionConf(XmlUtils.prettyPrint(protoConf).toString());
    wfj.setConf(XmlUtils.prettyPrint(new XConfiguration()).toString());
    Context context=new TestJavaActionExecutor().new Context(wfj,new WorkflowActionBean());
    PigActionExecutor ae=new PigActionExecutor();
    Configuration jobConf=ae.createBaseHadoopConf(context,eActionXml);
    ae.setLibFilesArchives(context,eActionXml,new Path("hdfs://dummyAppPath"),jobConf);
    verifyFilesInDistributedCache(DistributedCache.getCacheFiles(jobConf),"MyPig.jar","MyOozie.jar");
  }
  finally {
    services.destroy();
  }
}

</code></pre>

<pre class="type-1 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testShareLibLoadFile() throws Exception {
  services=new Services();
  FileSystem fs=getFileSystem();
  setSystemProps();
  createTestShareLibMetaFile(fs);
  Configuration conf=services.get(ConfigurationService.class).getConf();
  conf.set(ShareLibService.SHARELIB_MAPPING_FILE,fs.getUri() + "/user/test/config.properties");
  conf.set(ShareLibService.SHIP_LAUNCHER_JAR,"true");
  try {
    services.init();
    ShareLibService shareLibService=Services.get().get(ShareLibService.class);
    assertTrue(shareLibService.getShareLibJars("something_new").get(0).getName().endsWith("somethingNew.jar"));
    assertTrue(shareLibService.getShareLibJars("pig").get(0).getName().endsWith("pig.jar"));
    fs.delete(new Path("shareLibPath/"),true);
  }
  finally {
    services.destroy();
  }
}

</code></pre>

<pre class="type-1 type-2 type-8 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateLauncherLibPath() throws Exception {
  services=new Services();
  setSystemProps();
  Configuration conf=services.get(ConfigurationService.class).getConf();
  conf.set(ShareLibService.SHIP_LAUNCHER_JAR,"true");
  try {
    services.init();
    ShareLibService shareLibService=Services.get().get(ShareLibService.class);
    List<Path> launcherPath=shareLibService.getSystemLibJars(JavaActionExecutor.OOZIE_COMMON_LIBDIR);
    assertNotNull(launcherPath);
    assertTrue(getFileSystem().exists(launcherPath.get(0)));
    List<Path> pigLauncherPath=shareLibService.getSystemLibJars("pig");
    assertTrue(getFileSystem().exists(pigLauncherPath.get(0)));
  }
  finally {
    services.destroy();
  }
}

</code></pre>

<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testLoadfromDFS() throws Exception {
  services=new Services();
  setSystemProps();
  try {
    services.init();
    FileSystem fs=getFileSystem();
    Date time=new Date(System.currentTimeMillis());
    Path basePath=new Path(services.get(ConfigurationService.class).getConf().get(WorkflowAppService.SYSTEM_LIB_PATH));
    Path libpath=new Path(basePath,ShareLibService.SHARE_LIB_PREFIX + ShareLibService.dateFormat.format(time));
    fs.mkdirs(libpath);
    Path pigPath=new Path(libpath.toString() + Path.SEPARATOR + "pig");
    Path ooziePath=new Path(libpath.toString() + Path.SEPARATOR + "oozie");
    Path pigPath1=new Path(libpath.toString() + Path.SEPARATOR + "pig_9");
    Path pigPath2=new Path(libpath.toString() + Path.SEPARATOR + "pig_10");
    fs.mkdirs(pigPath);
    fs.mkdirs(ooziePath);
    fs.mkdirs(pigPath1);
    fs.mkdirs(pigPath2);
    createFile(libpath.toString() + Path.SEPARATOR + "pig_10"+ Path.SEPARATOR+ "pig-10.jar");
    createFile(libpath.toString() + Path.SEPARATOR + "oozie"+ Path.SEPARATOR+ "oozie_luncher.jar");
    String actionXml="<pig>" + "<job-tracker>" + getJobTrackerUri() + "</job-tracker>"+ "<name-node>"+ getNameNodeUri()+ "</name-node>"+ "<property><name>oozie.action.sharelib.for.pig</name><value>pig_10</value></property>"+ "</pig>";
    Element eActionXml=XmlUtils.parseXml(actionXml);
    XConfiguration protoConf=new XConfiguration();
    protoConf.set(WorkflowAppService.HADOOP_USER,getTestUser());
    WorkflowJobBean wfj=new WorkflowJobBean();
    protoConf.setBoolean(OozieClient.USE_SYSTEM_LIBPATH,true);
    wfj.setProtoActionConf(XmlUtils.prettyPrint(protoConf).toString());
    wfj.setConf(XmlUtils.prettyPrint(protoConf).toString());
    Context context=new TestJavaActionExecutor().new Context(wfj,new WorkflowActionBean());
    PigActionExecutor ae=new PigActionExecutor();
    Configuration jobConf=ae.createBaseHadoopConf(context,eActionXml);
    jobConf.set("oozie.action.sharelib.for.pig","pig_10");
    ae.setLibFilesArchives(context,eActionXml,new Path("hdfs://dummyAppPath"),jobConf);
    verifyFilesInDistributedCache(DistributedCache.getCacheFiles(jobConf),"pig-10.jar","oozie_luncher.jar");
  }
  finally {
    services.destroy();
  }
}

</code></pre>

<pre class="type-4 type-1 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testfailFast() throws Exception {
  services=new Services();
  setSystemProps();
  Configuration conf=services.get(ConfigurationService.class).getConf();
  conf.set(ShareLibService.FAIL_FAST_ON_STARTUP,"true");
  conf.set(ShareLibService.SHARELIB_MAPPING_FILE,String.valueOf(new Date().getTime()));
  try {
    services.init();
    fail("Should throw exception");
  }
 catch (  Throwable e) {
    assertTrue(e.getMessage().contains("E0104: Could not fully initialize service"));
  }
 finally {
    services.destroy();
  }
}

</code></pre>

<pre class="type-3 type-1 type-2 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPurgeShareLib() throws Exception {
  services=new Services();
  setSystemProps();
  Configuration conf=services.get(ConfigurationService.class).getConf();
  conf.set(ShareLibService.SHIP_LAUNCHER_JAR,"true");
  FileSystem fs=getFileSystem();
  long expiryTime=System.currentTimeMillis() - TimeUnit.MILLISECONDS.convert(services.get(ConfigurationService.class).getConf().getInt(ShareLibService.LAUNCHERJAR_LIB_RETENTION,7),TimeUnit.DAYS);
  String expireTs=dt.format(new Date(expiryTime - TimeUnit.MILLISECONDS.convert(1,TimeUnit.DAYS)));
  String noexpireTs=dt.format(new Date(expiryTime + TimeUnit.MILLISECONDS.convert(1,TimeUnit.DAYS)));
  String noexpireTs1=dt.format(new Date(expiryTime + TimeUnit.MILLISECONDS.convert(2,TimeUnit.DAYS)));
  Path basePath=new Path(services.get(ConfigurationService.class).getConf().get(WorkflowAppService.SYSTEM_LIB_PATH));
  Path expirePath=new Path(basePath,ShareLibService.SHARE_LIB_PREFIX + expireTs);
  Path noexpirePath=new Path(basePath,ShareLibService.SHARE_LIB_PREFIX + noexpireTs);
  Path noexpirePath1=new Path(basePath,ShareLibService.SHARE_LIB_PREFIX + noexpireTs1);
  createDirs(fs,expirePath,noexpirePath,noexpirePath1);
  try {
    services.init();
    assertEquals(4,fs.listStatus(basePath).length);
    assertTrue(fs.exists(noexpirePath));
    assertTrue(fs.exists(noexpirePath1));
    assertTrue(fs.exists(expirePath));
  }
  finally {
    services.destroy();
  }
}

</code></pre>

<pre class="type-2 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMetafileSymlink() throws ServiceException, IOException {
  if (!HadoopShims.isSymlinkSupported()) {
    return;
  }
  services=new Services();
  setSystemProps();
  Configuration conf=services.get(ConfigurationService.class).getConf();
  conf.set(ShareLibService.SHIP_LAUNCHER_JAR,"true");
  services.init();
  FileSystem fs=getFileSystem();
  Properties prop=new Properties();
  try {
    String testPath="shareLibPath/";
    Path basePath=new Path(testPath + Path.SEPARATOR + "testPath");
    Path basePath1=new Path(testPath + Path.SEPARATOR + "testPath1");
    Path hive_site=new Path(basePath.toString() + Path.SEPARATOR + "hive_conf"+ Path.SEPARATOR+ "hive-site.xml");
    Path hive_site1=new Path(basePath.toString() + Path.SEPARATOR + "hive_conf"+ Path.SEPARATOR+ "hive-site1.xml");
    Path symlink=new Path("symlink/");
    Path symlink_hive_site=new Path("symlink/hive_conf" + Path.SEPARATOR + "hive-site.xml");
    fs.mkdirs(basePath);
    createFile(basePath.toString() + Path.SEPARATOR + "pig"+ Path.SEPARATOR+ "pig.jar");
    createFile(basePath.toString() + Path.SEPARATOR + "pig"+ Path.SEPARATOR+ "pig_1.jar");
    createFile(basePath1.toString() + Path.SEPARATOR + "pig"+ Path.SEPARATOR+ "pig_2.jar");
    createFile(basePath1.toString() + Path.SEPARATOR + "pig"+ Path.SEPARATOR+ "pig_3.jar");
    createFile(basePath1.toString() + Path.SEPARATOR + "pig"+ Path.SEPARATOR+ "pig_4.jar");
    createFile(hive_site.toString());
    HadoopShims fileSystem=new HadoopShims(fs);
    fileSystem.createSymlink(basePath,symlink,true);
    fileSystem.createSymlink(hive_site,symlink_hive_site,true);
    prop.put(ShareLibService.SHARE_LIB_CONF_PREFIX + ".pig","/user/test/" + symlink.toString());
    prop.put(ShareLibService.SHARE_LIB_CONF_PREFIX + ".hive_conf","/user/test/" + symlink_hive_site.toString() + "#hive-site.xml");
    createTestShareLibMetaFile(fs,prop);
    assertEquals(fileSystem.isSymlink(symlink),true);
    conf.set(ShareLibService.SHARELIB_MAPPING_FILE,fs.getUri() + "/user/test/config.properties");
    conf.set(ShareLibService.SHIP_LAUNCHER_JAR,"true");
    try {
      ShareLibService shareLibService=Services.get().get(ShareLibService.class);
      assertEquals(shareLibService.getShareLibJars("pig").size(),2);
      assertEquals(shareLibService.getShareLibJars("hive_conf").size(),1);
      new HadoopShims(fs).createSymlink(basePath1,symlink,true);
      new HadoopShims(fs).createSymlink(hive_site1,symlink_hive_site,true);
      assertEquals(new HadoopShims(fs).getSymLinkTarget(shareLibService.getShareLibJars("hive_conf").get(0)),hive_site1);
      assertEquals(shareLibService.getShareLibJars("pig").size(),3);
    }
  finally {
      fs.delete(new Path("shareLibPath/"),true);
      fs.delete(new Path(metaFile),true);
      fs.delete(new Path("/user/test/config.properties"),true);
      fs.delete(symlink,true);
      services.destroy();
    }
  }
 catch (  IOException ex) {
    ex.printStackTrace();
  }
}

</code></pre>

<pre class="type-3 type-1 type-2 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPurgeJar() throws Exception {
  services=new Services();
  setSystemProps();
  Configuration conf=services.get(ConfigurationService.class).getConf();
  conf.set(ShareLibService.SHIP_LAUNCHER_JAR,"true");
  final FileSystem fs=getFileSystem();
  long expiryTime=System.currentTimeMillis() - TimeUnit.MILLISECONDS.convert(services.get(ConfigurationService.class).getConf().getInt(ShareLibService.LAUNCHERJAR_LIB_RETENTION,7),TimeUnit.DAYS);
  String expireTs=dt.format(new Date(expiryTime - TimeUnit.MILLISECONDS.convert(1,TimeUnit.DAYS)));
  String expireTs1=dt.format(new Date(expiryTime - TimeUnit.MILLISECONDS.convert(2,TimeUnit.DAYS)));
  String noexpireTs=dt.format(new Date(expiryTime + TimeUnit.MILLISECONDS.convert(1,TimeUnit.DAYS)));
  String noexpireTs1=dt.format(new Date(expiryTime + TimeUnit.MILLISECONDS.convert(2,TimeUnit.DAYS)));
  final Path basePath=new Path(services.get(ConfigurationService.class).getConf().get(WorkflowAppService.SYSTEM_LIB_PATH));
  Path expirePath=new Path(basePath,ShareLibService.LAUNCHER_LIB_PREFIX + expireTs);
  Path expirePath1=new Path(basePath,ShareLibService.LAUNCHER_LIB_PREFIX + expireTs1);
  Path noexpirePath=new Path(basePath,ShareLibService.LAUNCHER_LIB_PREFIX + noexpireTs);
  Path noexpirePath1=new Path(basePath,ShareLibService.LAUNCHER_LIB_PREFIX + noexpireTs1);
  createDirs(fs,expirePath,expirePath1,noexpirePath,noexpirePath1);
  try {
    services.init();
    waitFor(20 * 1000,new Predicate(){
      @Override public boolean evaluate() throws Exception {
        return (fs.listStatus(basePath).length == 4);
      }
    }
);
    assertEquals(4,fs.listStatus(basePath).length);
    assertTrue(fs.exists(noexpirePath));
    assertTrue(fs.exists(noexpirePath1));
    assertTrue(fs.exists(expirePath));
    assertFalse(fs.exists(expirePath1));
  }
  finally {
    services.destroy();
  }
}

</code></pre>

<pre class="type-2 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
@Test public void testGetShareLibPath() throws Exception {
  services=new Services();
  setSystemProps();
  FileSystem fs=getFileSystem();
  Path basePath=new Path(services.get(ConfigurationService.class).getConf().get(WorkflowAppService.SYSTEM_LIB_PATH));
  Date time=new Date(System.currentTimeMillis());
  Path libpath=new Path(basePath,ShareLibService.SHARE_LIB_PREFIX + ShareLibService.dateFormat.format(time));
  fs.mkdirs(libpath);
  Path pigPath=new Path(libpath.toString() + Path.SEPARATOR + "pig");
  Path pigPath1=new Path(libpath.toString() + Path.SEPARATOR + "pig_9");
  Path pigPath2=new Path(libpath.toString() + Path.SEPARATOR + "pig_10");
  fs.mkdirs(pigPath);
  fs.mkdirs(pigPath1);
  fs.mkdirs(pigPath2);
  try {
    services.init();
    ShareLibService shareLibService=Services.get().get(ShareLibService.class);
    assertNotNull(shareLibService.getShareLibJars("pig"));
    assertNotNull(shareLibService.getShareLibJars("pig_9"));
    assertNotNull(shareLibService.getShareLibJars("pig_10"));
    assertNull(shareLibService.getShareLibJars("pig_11"));
  }
  finally {
    services.destroy();
  }
}

</code></pre>

<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testAddShareLibDistributedCache() throws Exception {
  services=new Services();
  setSystemProps();
  Configuration conf=services.get(ConfigurationService.class).getConf();
  conf.set(ShareLibService.SHIP_LAUNCHER_JAR,"true");
  try {
    services.init();
    String actionXml="<java>" + "<job-tracker>" + getJobTrackerUri() + "</job-tracker>"+ "<name-node>"+ getNameNodeUri()+ "</name-node>"+ "</java>";
    Element eActionXml=XmlUtils.parseXml(actionXml);
    XConfiguration protoConf=new XConfiguration();
    protoConf.set(WorkflowAppService.HADOOP_USER,getTestUser());
    WorkflowJobBean wfj=new WorkflowJobBean();
    wfj.setProtoActionConf(XmlUtils.prettyPrint(protoConf).toString());
    wfj.setConf(XmlUtils.prettyPrint(new XConfiguration()).toString());
    Context context=new TestJavaActionExecutor().new Context(wfj,new WorkflowActionBean());
    PigActionExecutor ae=new PigActionExecutor();
    Configuration jobConf=ae.createBaseHadoopConf(context,eActionXml);
    ae.setLibFilesArchives(context,eActionXml,new Path("hdfs://dummyAppPath"),jobConf);
    verifyFilesInDistributedCache(DistributedCache.getCacheFiles(jobConf),MyPig.class.getName() + ".jar",MyOozie.class.getName() + ".jar");
  }
  finally {
    services.destroy();
  }
}

</code></pre>

<pre class="type-3 type-1 type-2 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConfFileAddedToDistributedCache() throws Exception {
  try {
    Properties prop=new Properties();
    prop.put("oozie.hive_conf","/user/test/" + sharelibPath + "/hive-site.xml#hive-site.xml");
    setupSharelibConf("hive-site.xml","oozie.hive_conf",prop);
    String actionXml="<pig>" + "<job-tracker>" + getJobTrackerUri() + "</job-tracker>"+ "<name-node>"+ getNameNodeUri()+ "</name-node>"+ "<script>test</script>"+ "</pig>";
    Element eActionXml=XmlUtils.parseXml(actionXml);
    XConfiguration protoConf=new XConfiguration();
    protoConf.set(WorkflowAppService.HADOOP_USER,getTestUser());
    WorkflowJobBean wfj=new WorkflowJobBean();
    protoConf.setBoolean(OozieClient.USE_SYSTEM_LIBPATH,true);
    wfj.setProtoActionConf(XmlUtils.prettyPrint(protoConf).toString());
    wfj.setConf(XmlUtils.prettyPrint(protoConf).toString());
    Context context=new TestJavaActionExecutor().new Context(wfj,new WorkflowActionBean());
    PigActionExecutor ae=new PigActionExecutor();
    Configuration jobConf=ae.createBaseHadoopConf(context,eActionXml);
    jobConf.set("oozie.action.sharelib.for.pig","hive_conf");
    ae.setLibFilesArchives(context,eActionXml,new Path("hdfs://dummyAppPath"),jobConf);
    URI[] cacheFiles=DistributedCache.getCacheFiles(jobConf);
    String cacheFilesStr=Arrays.toString(cacheFiles);
    assertEquals(jobConf.get("oozie.hive_conf-sharelib-test"),null);
    assertTrue(URLDecoder.decode(cacheFilesStr).contains("hive-site.xml#hive-site.xml"));
    setupSharelibConf("hbase-site.xml","oozie.hbase_conf");
    jobConf=ae.createBaseHadoopConf(context,eActionXml);
    jobConf.set("oozie.action.sharelib.for.pig","hbase_conf");
    ae.setLibFilesArchives(context,eActionXml,new Path("hdfs://dummyAppPath"),jobConf);
    cacheFiles=DistributedCache.getCacheFiles(jobConf);
    cacheFilesStr=Arrays.toString(cacheFiles);
    assertTrue(cacheFilesStr.contains("hbase-site.xml"));
  }
  finally {
    getFileSystem().delete(new Path(sharelibPath),true);
    services.destroy();
  }
}

</code></pre>

<pre class="type-3 type-1 type-2 type-6 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConfFileAddedToActionConf() throws Exception {
  try {
    XConfiguration protoConf=new XConfiguration();
    protoConf.set(WorkflowAppService.HADOOP_USER,getTestUser());
    WorkflowJobBean wfj=new WorkflowJobBean();
    protoConf.setBoolean(OozieClient.USE_SYSTEM_LIBPATH,true);
    wfj.setProtoActionConf(XmlUtils.prettyPrint(protoConf).toString());
    wfj.setConf(XmlUtils.prettyPrint(protoConf).toString());
    Context context=new TestJavaActionExecutor().new Context(wfj,new WorkflowActionBean());
    setupSharelibConf("hive-site.xml","oozie.hive_conf");
    ShareLibService shareLibService=services.get(ShareLibService.class);
    assertEquals(shareLibService.getShareLibConfigMap().get("hive_conf").values().size(),1);
    assertEquals(shareLibService.getShareLibConfigMap().get("hive_conf").keySet().toArray(new Path[]{})[0].getName(),"hive-site.xml");
    setupSharelibConf("hive-site.xml","oozie.hive_conf");
    String actionXml="<hive>" + "<job-tracker>" + getJobTrackerUri() + "</job-tracker>"+ "<name-node>"+ getNameNodeUri()+ "</name-node>"+ "<script>test</script>"+ "</hive>";
    Element eActionXml=XmlUtils.parseXml(actionXml);
    HiveActionExecutor ae=new HiveActionExecutor();
    Configuration jobConf=ae.createBaseHadoopConf(context,eActionXml);
    Configuration actionConf=ae.createBaseHadoopConf(context,eActionXml);
    jobConf.set("oozie.action.sharelib.for.hive","hive_conf");
    ae.setLibFilesArchives(context,eActionXml,new Path("hdfs://dummyAppPath"),jobConf);
    URI[] cacheFiles=DistributedCache.getCacheFiles(actionConf);
    String cacheFilesStr=Arrays.toString(cacheFiles);
    assertFalse(cacheFilesStr.contains("hive-site.xml"));
    jobConf=ae.createBaseHadoopConf(context,eActionXml);
    Properties prop=new Properties();
    actionConf=ae.createBaseHadoopConf(context,eActionXml);
    prop.put("oozie.hive_conf","/user/test/" + sharelibPath + "/hive-site.xml#hive-site.xml");
    setupSharelibConf("hive-site.xml","oozie.hive_conf",prop);
    jobConf.set("oozie.action.sharelib.for.hive","hive_conf");
    ae.setLibFilesArchives(context,eActionXml,new Path("hdfs://dummyAppPath"),jobConf);
    assertEquals(jobConf.get("oozie.hive_conf-sharelib-test"),"test");
  }
  finally {
    getFileSystem().delete(new Path(sharelibPath),true);
    services.destroy();
  }
}

</code></pre>

<pre class="type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects are null
"></span><br>
@Test public void testGetShareLibCompatible() throws Exception {
  services=new Services();
  setSystemProps();
  FileSystem fs=getFileSystem();
  Path basePath=new Path(services.get(ConfigurationService.class).getConf().get(WorkflowAppService.SYSTEM_LIB_PATH));
  fs.mkdirs(basePath);
  Path pigPath=new Path(basePath.toString() + Path.SEPARATOR + "pig");
  fs.mkdirs(pigPath);
  try {
    services.init();
    ShareLibService shareLibService=Services.get().get(ShareLibService.class);
    assertNotNull(shareLibService.getShareLibJars("pig"));
  }
  finally {
    services.destroy();
  }
}

</code></pre>

<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testShareLib() throws Exception {
  services=new Services();
  setSystemProps();
  Configuration conf=services.get(ConfigurationService.class).getConf();
  conf.set(ShareLibService.SHIP_LAUNCHER_JAR,"true");
  FileSystem fs=getFileSystem();
  String dir1=dt.format(new Date(System.currentTimeMillis() - TimeUnit.MILLISECONDS.convert(1,TimeUnit.DAYS)));
  String dir2=dt.format(new Date(System.currentTimeMillis() - TimeUnit.MILLISECONDS.convert(2,TimeUnit.DAYS)));
  String dir3=dt.format(new Date(System.currentTimeMillis() - TimeUnit.MILLISECONDS.convert(3,TimeUnit.DAYS)));
  Path basePath=new Path(services.get(ConfigurationService.class).getConf().get(WorkflowAppService.SYSTEM_LIB_PATH));
  Path path1=new Path(basePath,ShareLibService.SHARE_LIB_PREFIX + dir1);
  Path path2=new Path(basePath,ShareLibService.SHARE_LIB_PREFIX + dir2);
  Path path3=new Path(basePath,ShareLibService.SHARE_LIB_PREFIX + dir3);
  createDirs(fs,path1,path2,path3);
  createFile(path1.toString() + Path.SEPARATOR + "pig"+ Path.SEPARATOR+ "pig.jar");
  try {
    services.init();
    ShareLibService shareLibService=Services.get().get(ShareLibService.class);
    assertTrue(shareLibService.getShareLibJars("pig").get(0).getName().endsWith("pig.jar"));
  }
  finally {
    services.destroy();
  }
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
