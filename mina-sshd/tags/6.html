<h3><span class=" glyphicon glyphicon-tag"/>&nbspUtilityVerifier</h3><kbd>Verifies (un)successful execution of the test case by reporting explicitly a failure</kbd><br><br><br><h4 style="margin:0px">Class: org.apache.sshd.KeyReExchangeTest </h4><pre class="type-8 type-10 type-6 type-2 type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReExchangeFromServerBySize() throws Exception {
  final long LIMIT=10 * 1024L;
  setUp(LIMIT,0L,0L);
  try (SshClient client=setupTestClient()){
    client.start();
    final Semaphore pipedCount=new Semaphore(0,true);
    try (ClientSession session=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession();ByteArrayOutputStream sent=new ByteArrayOutputStream();ByteArrayOutputStream out=new ByteArrayOutputStream(){
      private long writeCount=0L;
      @Override public void write(      int b){
        super.write(b);
        updateWriteCount(1L);
        pipedCount.release(1);
      }
      @Override public void write(      byte[] b,      int off,      int len){
        super.write(b,off,len);
        updateWriteCount(len);
        pipedCount.release(len);
      }
      private void updateWriteCount(      long delta){
        writeCount+=delta;
        outputDebugMessage("OUT write count=%d",writeCount);
      }
    }
){
      session.addPasswordIdentity(getCurrentTestName());
      session.auth().verify(5L,TimeUnit.SECONDS);
      byte[] sentData;
      try (ChannelShell channel=session.createShellChannel();PipedOutputStream pipedIn=new PipedOutputStream();OutputStream teeOut=new TeeOutputStream(sent,pipedIn);OutputStream err=new NullOutputStream();InputStream inPipe=new PipedInputStream(pipedIn)){
        channel.setIn(inPipe);
        channel.setOut(out);
        channel.setErr(err);
        channel.open();
        teeOut.write("this is my command\n".getBytes(StandardCharsets.UTF_8));
        teeOut.flush();
        StringBuilder sb=new StringBuilder(101 * 10);
        for (int i=0; i < 100; i++) {
          sb.append("0123456789");
        }
        sb.append('\n');
        final AtomicInteger exchanges=new AtomicInteger();
        session.addSessionListener(new SessionListener(){
          @Override public void sessionCreated(          Session session){
          }
          @Override public void sessionEvent(          Session session,          Event event){
            if (Event.KeyEstablished.equals(event)) {
              int count=exchanges.incrementAndGet();
              outputDebugMessage("Key established for %s - count=%d",session,count);
            }
          }
          @Override public void sessionException(          Session session,          Throwable t){
          }
          @Override public void sessionClosed(          Session session){
          }
        }
);
        byte[] data=sb.toString().getBytes(StandardCharsets.UTF_8);
        for (long sentSize=0L; sentSize < (LIMIT + Byte.MAX_VALUE + data.length); sentSize+=data.length) {
          teeOut.write(data);
          teeOut.flush();
          if (exchanges.get() > 0) {
            outputDebugMessage("Stop sending after %d bytes - exchanges=%s",sentSize + data.length,exchanges);
            break;
          }
        }
        teeOut.write("exit\n".getBytes(StandardCharsets.UTF_8));
        teeOut.flush();
        Collection<ClientChannel.ClientChannelEvent> result=channel.waitFor(EnumSet.of(ClientChannel.ClientChannelEvent.CLOSED),TimeUnit.SECONDS.toMillis(15L));
        assertFalse("Timeout while waiting for channel closure",result.contains(ClientChannel.ClientChannelEvent.TIMEOUT));
        sentData=sent.toByteArray();
        if (!pipedCount.tryAcquire(sentData.length,13L,TimeUnit.SECONDS)) {
          fail("Failed to await sent data signal for len=" + sentData.length + " (available="+ pipedCount.availablePermits()+ ")");
        }
        assertTrue("Expected rekeying",exchanges.get() > 0);
      }
       byte[] outData=out.toByteArray();
      assertEquals("Mismatched sent data length",sentData.length,outData.length);
      assertArrayEquals("Mismatched sent data content",sentData,outData);
    }
  finally {
      client.stop();
    }
  }
 }

</code></pre>

<br>
<pre class="type-11 type-8 type-10 type-6 type-2 type-3 type-7 type-12 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReExchangeFromSshdClient() throws Exception {
  setUp(0L,0L,0L);
  try (SshClient client=setupTestClient()){
    client.start();
    try (ClientSession session=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession()){
      session.addPasswordIdentity(getCurrentTestName());
      session.auth().verify(5L,TimeUnit.SECONDS);
      final Semaphore pipedCount=new Semaphore(0,true);
      try (ChannelShell channel=session.createShellChannel();ByteArrayOutputStream sent=new ByteArrayOutputStream();PipedOutputStream pipedIn=new PipedOutputStream();InputStream inPipe=new PipedInputStream(pipedIn);OutputStream teeOut=new TeeOutputStream(sent,pipedIn);ByteArrayOutputStream out=new ByteArrayOutputStream(){
        private long writeCount=0L;
        @Override public void write(        int b){
          super.write(b);
          updateWriteCount(1L);
          pipedCount.release(1);
        }
        @Override public void write(        byte[] b,        int off,        int len){
          super.write(b,off,len);
          updateWriteCount(len);
          pipedCount.release(len);
        }
        private void updateWriteCount(        long delta){
          writeCount+=delta;
          outputDebugMessage("OUT write count=%d",writeCount);
        }
      }
;ByteArrayOutputStream err=new ByteArrayOutputStream()){
        channel.setIn(inPipe);
        channel.setOut(out);
        channel.setErr(err);
        channel.open();
        teeOut.write("this is my command\n".getBytes(StandardCharsets.UTF_8));
        teeOut.flush();
        StringBuilder sb=new StringBuilder(Byte.MAX_VALUE);
        for (int i=0; i < 10; i++) {
          sb.append("0123456789");
        }
        sb.append('\n');
        byte[] data=sb.toString().getBytes(StandardCharsets.UTF_8);
        for (int i=1; i <= 10; i++) {
          teeOut.write(data);
          teeOut.flush();
          KeyExchangeFuture kexFuture=session.reExchangeKeys();
          assertTrue("Failed to complete KEX on time at iteration " + i,kexFuture.await(5L,TimeUnit.SECONDS));
          assertNull("KEX exception signalled at iteration " + i,kexFuture.getException());
        }
        teeOut.write("exit\n".getBytes(StandardCharsets.UTF_8));
        teeOut.flush();
        Collection<ClientChannel.ClientChannelEvent> result=channel.waitFor(EnumSet.of(ClientChannel.ClientChannelEvent.CLOSED),TimeUnit.SECONDS.toMillis(15L));
        assertFalse("Timeout while waiting for channel closure",result.contains(ClientChannel.ClientChannelEvent.TIMEOUT));
        byte[] expected=sent.toByteArray();
        if (!pipedCount.tryAcquire(expected.length,13L,TimeUnit.SECONDS)) {
          fail("Failed to await sent data signal for len=" + expected.length + " (available="+ pipedCount.availablePermits()+ ")");
        }
        assertArrayEquals("Mismatched sent data content",expected,out.toByteArray());
      }
     }
  finally {
      client.stop();
    }
  }
 }

</code></pre>

<br>
<pre class="type-8 type-10 type-6 type-2 type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReExchangeFromServerByPackets() throws Exception {
  final int PACKETS=135;
  setUp(0L,0L,PACKETS);
  try (SshClient client=setupTestClient()){
    client.start();
    final Semaphore pipedCount=new Semaphore(0,true);
    try (ClientSession session=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession();ByteArrayOutputStream sent=new ByteArrayOutputStream();ByteArrayOutputStream out=new ByteArrayOutputStream(){
      private long writeCount=0L;
      @Override public void write(      int b){
        super.write(b);
        updateWriteCount(1L);
        pipedCount.release(1);
      }
      @Override public void write(      byte[] b,      int off,      int len){
        super.write(b,off,len);
        updateWriteCount(len);
        pipedCount.release(len);
      }
      private void updateWriteCount(      long delta){
        writeCount+=delta;
        outputDebugMessage("OUT write count=%d",writeCount);
      }
    }
){
      session.addPasswordIdentity(getCurrentTestName());
      session.auth().verify(5L,TimeUnit.SECONDS);
      byte[] sentData;
      try (ChannelShell channel=session.createShellChannel();PipedOutputStream pipedIn=new PipedOutputStream();OutputStream sentTracker=new OutputCountTrackingOutputStream(sent){
        @Override protected long updateWriteCount(        long delta){
          long result=super.updateWriteCount(delta);
          outputDebugMessage("SENT write count=%d",result);
          return result;
        }
      }
;OutputStream teeOut=new TeeOutputStream(sentTracker,pipedIn);OutputStream stderr=new NullOutputStream();OutputStream stdout=new OutputCountTrackingOutputStream(out){
        @Override protected long updateWriteCount(        long delta){
          long result=super.updateWriteCount(delta);
          outputDebugMessage("OUT write count=%d",result);
          return result;
        }
      }
;InputStream inPipe=new PipedInputStream(pipedIn)){
        channel.setIn(inPipe);
        channel.setOut(stdout);
        channel.setErr(stderr);
        channel.open();
        teeOut.write("this is my command\n".getBytes(StandardCharsets.UTF_8));
        teeOut.flush();
        final AtomicInteger exchanges=new AtomicInteger();
        session.addSessionListener(new SessionListener(){
          @Override public void sessionCreated(          Session session){
          }
          @Override public void sessionEvent(          Session session,          Event event){
            if (Event.KeyEstablished.equals(event)) {
              int count=exchanges.incrementAndGet();
              outputDebugMessage("Key established for %s - count=%d",session,count);
            }
          }
          @Override public void sessionException(          Session session,          Throwable t){
          }
          @Override public void sessionClosed(          Session session){
          }
        }
);
        byte[] data=(getClass().getName() + "#" + getCurrentTestName()+ "\n").getBytes(StandardCharsets.UTF_8);
        for (int index=0; index < (PACKETS * 2); index++) {
          teeOut.write(data);
          teeOut.flush();
          if (exchanges.get() > 0) {
            outputDebugMessage("Stop sending after %d packets and %d bytes - exchanges=%s",(index + 1),(index + 1L) * data.length,exchanges);
            break;
          }
        }
        teeOut.write("exit\n".getBytes(StandardCharsets.UTF_8));
        teeOut.flush();
        Collection<ClientChannel.ClientChannelEvent> result=channel.waitFor(EnumSet.of(ClientChannel.ClientChannelEvent.CLOSED),TimeUnit.SECONDS.toMillis(15L));
        assertFalse("Timeout while waiting for channel closure",result.contains(ClientChannel.ClientChannelEvent.TIMEOUT));
        sentData=sent.toByteArray();
        if (!pipedCount.tryAcquire(sentData.length,13L,TimeUnit.SECONDS)) {
          fail("Failed to await sent data signal for len=" + sentData.length + " (available="+ pipedCount.availablePermits()+ ")");
        }
        assertTrue("Expected rekeying",exchanges.get() > 0);
      }
       byte[] outData=out.toByteArray();
      assertEquals("Mismatched sent data length",sentData.length,outData.length);
      assertArrayEquals("Mismatched sent data content",sentData,outData);
    }
  finally {
      client.stop();
    }
  }
 }

</code></pre>

<br>
<pre class="type-8 type-10 type-6 type-2 type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReExchangeFromServerByTime() throws Exception {
  final long TIME=TimeUnit.SECONDS.toMillis(2L);
  setUp(0L,TIME,0L);
  try (SshClient client=setupTestClient()){
    client.start();
    final Semaphore pipedCount=new Semaphore(0,true);
    try (ClientSession session=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession();ByteArrayOutputStream sent=new ByteArrayOutputStream();ByteArrayOutputStream out=new ByteArrayOutputStream(){
      private long writeCount=0L;
      @Override public void write(      int b){
        super.write(b);
        updateWriteCount(1L);
        pipedCount.release(1);
      }
      @Override public void write(      byte[] b,      int off,      int len){
        super.write(b,off,len);
        updateWriteCount(len);
        pipedCount.release(len);
      }
      private void updateWriteCount(      long delta){
        writeCount+=delta;
        outputDebugMessage("OUT write count=%d",writeCount);
      }
    }
){
      session.addPasswordIdentity(getCurrentTestName());
      session.auth().verify(5L,TimeUnit.SECONDS);
      byte[] sentData;
      try (ChannelShell channel=session.createShellChannel();PipedOutputStream pipedIn=new PipedOutputStream();OutputStream teeOut=new TeeOutputStream(sent,pipedIn);OutputStream err=new NullOutputStream();InputStream inPipe=new PipedInputStream(pipedIn)){
        channel.setIn(inPipe);
        channel.setOut(out);
        channel.setErr(err);
        channel.open();
        teeOut.write("this is my command\n".getBytes(StandardCharsets.UTF_8));
        teeOut.flush();
        StringBuilder sb=new StringBuilder(101 * 10);
        for (int i=0; i < 100; i++) {
          sb.append("0123456789");
        }
        sb.append('\n');
        final AtomicInteger exchanges=new AtomicInteger();
        session.addSessionListener(new SessionListener(){
          @Override public void sessionCreated(          Session session){
          }
          @Override public void sessionEvent(          Session session,          Event event){
            if (Event.KeyEstablished.equals(event)) {
              int count=exchanges.incrementAndGet();
              outputDebugMessage("Key established for %s - count=%d",session,count);
            }
          }
          @Override public void sessionException(          Session session,          Throwable t){
          }
          @Override public void sessionClosed(          Session session){
          }
        }
);
        byte[] data=getCurrentTestName().getBytes(StandardCharsets.UTF_8);
        final long MAX_WAIT_NANOS=TimeUnit.MILLISECONDS.toNanos(3L * TIME);
        final long MIN_WAIT=10L;
        final long MIN_WAIT_NANOS=TimeUnit.MILLISECONDS.toNanos(MIN_WAIT);
        for (long timePassed=0L, sentSize=0L; timePassed < MAX_WAIT_NANOS; timePassed++) {
          long nanoStart=System.nanoTime();
          teeOut.write(data);
          teeOut.write('\n');
          teeOut.flush();
          long nanoEnd=System.nanoTime();
          long nanoDuration=nanoEnd - nanoStart;
          timePassed+=nanoDuration;
          sentSize+=data.length + 1;
          if (exchanges.get() > 0) {
            outputDebugMessage("Stop sending after %d nanos and size=%d - exchanges=%s",timePassed,sentSize,exchanges);
            break;
          }
          if ((timePassed < MAX_WAIT_NANOS) && (nanoDuration < MIN_WAIT_NANOS)) {
            Thread.sleep(MIN_WAIT);
          }
        }
        teeOut.write("exit\n".getBytes(StandardCharsets.UTF_8));
        teeOut.flush();
        Collection<ClientChannel.ClientChannelEvent> result=channel.waitFor(EnumSet.of(ClientChannel.ClientChannelEvent.CLOSED),TimeUnit.SECONDS.toMillis(15L));
        assertFalse("Timeout while waiting for channel closure",result.contains(ClientChannel.ClientChannelEvent.TIMEOUT));
        sentData=sent.toByteArray();
        if (!pipedCount.tryAcquire(sentData.length,13L,TimeUnit.SECONDS)) {
          fail("Failed to await sent data signal for len=" + sentData.length + " (available="+ pipedCount.availablePermits()+ ")");
        }
        assertTrue("Expected rekeying",exchanges.get() > 0);
      }
       byte[] outData=out.toByteArray();
      assertEquals("Mismatched sent data length",sentData.length,outData.length);
      assertArrayEquals("Mismatched sent data content",sentData,outData);
    }
  finally {
      client.stop();
    }
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.ProxyTest </h4><pre class="type-11 type-8 type-6 type-3 type-7 type-13 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSocksProxy() throws Exception {
  try (ClientSession session=createNativeSession()){
    String expected=getCurrentTestName();
    byte[] bytes=expected.getBytes(StandardCharsets.UTF_8);
    byte[] buf=new byte[bytes.length + Long.SIZE];
    SshdSocketAddress dynamic=session.startDynamicPortForwarding(new SshdSocketAddress(TEST_LOCALHOST,0));
    try {
      for (int i=0; i < 10; i++) {
        try (Socket s=new Socket(new Proxy(Proxy.Type.SOCKS,new InetSocketAddress(TEST_LOCALHOST,dynamic.getPort())))){
          s.connect(new InetSocketAddress(TEST_LOCALHOST,echoPort));
          s.setSoTimeout((int)TimeUnit.SECONDS.toMillis(10L));
          try (OutputStream sockOut=s.getOutputStream();InputStream sockIn=s.getInputStream()){
            sockOut.write(bytes);
            sockOut.flush();
            int l=sockIn.read(buf);
            assertEquals("Mismatched data at iteration " + i,expected,new String(buf,0,l));
          }
         }
       }
    }
  finally {
      session.stopDynamicPortForwarding(dynamic);
    }
    try {
      try (Socket s=new Socket(new Proxy(Proxy.Type.SOCKS,new InetSocketAddress(TEST_LOCALHOST,dynamic.getPort())))){
        s.connect(new InetSocketAddress(TEST_LOCALHOST,echoPort));
        s.setSoTimeout((int)TimeUnit.SECONDS.toMillis(10L));
        s.getOutputStream().write(bytes);
        fail("Unexpected success to write proxy data");
      }
     }
 catch (    IOException e) {
    }
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.client.scp.ScpTest </h4><pre class="type-8 type-6 type-2 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testScpNativeOnSingleFile() throws Exception {
  String data=getClass().getName() + "#" + getCurrentTestName()+ IoUtils.EOL;
  Path targetPath=detectTargetFolder();
  Path parentPath=targetPath.getParent();
  Path scpRoot=Utils.resolve(targetPath,ScpHelper.SCP_COMMAND_PREFIX,getClass().getSimpleName(),getCurrentTestName());
  Utils.deleteRecursive(scpRoot);
  Path localDir=assertHierarchyTargetFolderExists(scpRoot.resolve("local"));
  Path localOutFile=localDir.resolve("file-1.txt");
  Path remoteDir=scpRoot.resolve("remote");
  Path remoteOutFile=remoteDir.resolve(localOutFile.getFileName());
  try (SshClient client=setupTestClient()){
    client.start();
    try (ClientSession session=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession()){
      session.addPasswordIdentity(getCurrentTestName());
      session.auth().verify(5L,TimeUnit.SECONDS);
      ScpClient scp=createScpClient(session);
      Utils.writeFile(localOutFile,data);
      assertFalse("Remote folder already exists: " + remoteDir,Files.exists(remoteDir));
      String localOutPath=localOutFile.toString();
      String remoteOutPath=Utils.resolveRelativeRemotePath(parentPath,remoteOutFile);
      outputDebugMessage("Expect upload failure %s => %s",localOutPath,remoteOutPath);
      try {
        scp.upload(localOutPath,remoteOutPath);
        fail("Expected IOException for 1st time " + remoteOutPath);
      }
 catch (      IOException e) {
      }
      assertHierarchyTargetFolderExists(remoteDir);
      outputDebugMessage("Expect upload success %s => %s",localOutPath,remoteOutPath);
      scp.upload(localOutPath,remoteOutPath);
      assertFileLength(remoteOutFile,data.length(),TimeUnit.SECONDS.toMillis(5L));
      Path secondLocal=localDir.resolve(localOutFile.getFileName());
      String downloadTarget=Utils.resolveRelativeRemotePath(parentPath,secondLocal);
      outputDebugMessage("Expect download success %s => %s",remoteOutPath,downloadTarget);
      scp.download(remoteOutPath,downloadTarget);
      assertFileLength(secondLocal,data.length(),TimeUnit.SECONDS.toMillis(5L));
      Path localPath=localDir.resolve("file-path.txt");
      downloadTarget=Utils.resolveRelativeRemotePath(parentPath,localPath);
      outputDebugMessage("Expect download success %s => %s",remoteOutPath,downloadTarget);
      scp.download(remoteOutPath,downloadTarget);
      assertFileLength(localPath,data.length(),TimeUnit.SECONDS.toMillis(5L));
    }
  finally {
      client.stop();
    }
  }
 }

</code></pre>

<br>
<pre class="type-8 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testScpNativeOnMultipleFiles() throws Exception {
  try (SshClient client=setupTestClient()){
    client.start();
    try (ClientSession session=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession()){
      session.addPasswordIdentity(getCurrentTestName());
      session.auth().verify(5L,TimeUnit.SECONDS);
      ScpClient scp=createScpClient(session);
      Path targetPath=detectTargetFolder();
      Path parentPath=targetPath.getParent();
      Path scpRoot=Utils.resolve(targetPath,ScpHelper.SCP_COMMAND_PREFIX,getClass().getSimpleName(),getCurrentTestName());
      Utils.deleteRecursive(scpRoot);
      Path localDir=assertHierarchyTargetFolderExists(scpRoot.resolve("local"));
      Path local1=localDir.resolve("file-1.txt");
      byte[] data=Utils.writeFile(local1,getClass().getName() + "#" + getCurrentTestName()+ IoUtils.EOL);
      Path local2=localDir.resolve("file-2.txt");
      Files.write(local2,data);
      Path remoteDir=assertHierarchyTargetFolderExists(scpRoot.resolve("remote"));
      Path remote1=remoteDir.resolve(local1.getFileName());
      String remote1Path=Utils.resolveRelativeRemotePath(parentPath,remote1);
      String[] locals={local1.toString(),local2.toString()};
      try {
        scp.upload(locals,remote1Path);
        fail("Unexpected upload success to missing remote file: " + remote1Path);
      }
 catch (      IOException e) {
      }
      Files.write(remote1,data);
      try {
        scp.upload(locals,remote1Path);
        fail("Unexpected upload success to existing remote file: " + remote1Path);
      }
 catch (      IOException e) {
      }
      Path remoteSubDir=assertHierarchyTargetFolderExists(remoteDir.resolve("dir"));
      scp.upload(locals,Utils.resolveRelativeRemotePath(parentPath,remoteSubDir));
      Path remoteSub1=remoteSubDir.resolve(local1.getFileName());
      assertFileLength(remoteSub1,data.length,TimeUnit.SECONDS.toMillis(5L));
      Path remoteSub2=remoteSubDir.resolve(local2.getFileName());
      assertFileLength(remoteSub2,data.length,TimeUnit.SECONDS.toMillis(5L));
      String[] remotes={Utils.resolveRelativeRemotePath(parentPath,remoteSub1),Utils.resolveRelativeRemotePath(parentPath,remoteSub2)};
      try {
        scp.download(remotes,Utils.resolveRelativeRemotePath(parentPath,local1));
        fail("Unexpected download success to existing local file: " + local1);
      }
 catch (      IOException e) {
      }
      Path localSubDir=localDir.resolve("dir");
      try {
        scp.download(remotes,localSubDir);
        fail("Unexpected download success to non-existing folder: " + localSubDir);
      }
 catch (      IOException e) {
      }
      assertHierarchyTargetFolderExists(localSubDir);
      scp.download(remotes,localSubDir);
      assertFileLength(localSubDir.resolve(remoteSub1.getFileName()),data.length,TimeUnit.SECONDS.toMillis(5L));
      assertFileLength(localSubDir.resolve(remoteSub2.getFileName()),data.length,TimeUnit.SECONDS.toMillis(5L));
    }
  finally {
      client.stop();
    }
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.client.simple.SimpleSessionClientTest </h4><pre class="type-6 type-2 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAuthenticationTimeout() throws Exception {
  sshd.setPublickeyAuthenticator(RejectAllPublickeyAuthenticator.INSTANCE);
  final PasswordAuthenticator delegate=ValidateUtils.checkNotNull(sshd.getPasswordAuthenticator(),"No password authenticator");
  sshd.setPasswordAuthenticator(new PasswordAuthenticator(){
    @Override public boolean authenticate(    String username,    String password,    ServerSession session){
      try {
        Thread.sleep(AUTH_TIMEOUT + 150L);
      }
 catch (      InterruptedException e) {
      }
      return delegate.authenticate(username,password,session);
    }
  }
);
  client.start();
  long nanoStart=System.nanoTime();
  try (ClientSession session=simple.sessionLogin(TEST_LOCALHOST,port,getCurrentTestName(),getCurrentTestName())){
    fail("Unexpected connection success");
  }
 catch (  IOException e) {
    long nanoEnd=System.nanoTime();
    long nanoDuration=nanoEnd - nanoStart;
    long nanoTimeout=TimeUnit.MILLISECONDS.toNanos(AUTH_TIMEOUT);
    assertTrue("Expired time (" + nanoDuration + ") too long",nanoDuration < (nanoTimeout * 3L));
  }
}

</code></pre>

<br>
<pre class="type-6 type-2 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testConnectionTimeout() throws Exception {
  client.addSessionListener(new SessionListener(){
    @Override public void sessionEvent(    Session session,    Event event){
    }
    @Override public void sessionCreated(    Session session){
      try {
        Thread.sleep(CONNECT_TIMEOUT + 150L);
      }
 catch (      InterruptedException e) {
      }
    }
    @Override public void sessionException(    Session session,    Throwable t){
    }
    @Override public void sessionClosed(    Session session){
    }
  }
);
  client.start();
  long nanoStart=System.nanoTime();
  try (ClientSession session=simple.sessionLogin(TEST_LOCALHOST,port,getCurrentTestName(),getCurrentTestName())){
    fail("Unexpected connection success");
  }
 catch (  IOException e) {
    long nanoEnd=System.nanoTime();
    long nanoDuration=nanoEnd - nanoStart;
    long nanoTimeout=TimeUnit.MILLISECONDS.toNanos(CONNECT_TIMEOUT);
    assertTrue("Expired time (" + nanoDuration + ") too long",nanoDuration < (nanoTimeout * 3L));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.client.subsystem.sftp.SftpTest </h4><pre class="type-8 type-10 type-6 type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCannotEscapeUserRoot() throws Exception {
  Path targetPath=detectTargetFolder();
  Path lclSftp=Utils.resolve(targetPath,SftpConstants.SFTP_SUBSYSTEM_NAME,getClass().getSimpleName(),getCurrentTestName());
  assertHierarchyTargetFolderExists(lclSftp);
  sshd.setFileSystemFactory(new VirtualFileSystemFactory(lclSftp));
  try (SshClient client=setupTestClient()){
    client.start();
    try (ClientSession session=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession()){
      session.addPasswordIdentity(getCurrentTestName());
      session.auth().verify(5L,TimeUnit.SECONDS);
      String escapePath=targetPath.toString();
      if (OsUtils.isWin32()) {
        escapePath="/" + escapePath.replace(File.separatorChar,'/');
      }
      try (SftpClient sftp=session.createSftpClient()){
        SftpClient.Attributes attrs=sftp.stat(escapePath);
        fail("Unexpected escape success for path=" + escapePath + ": "+ attrs);
      }
 catch (      SftpException e) {
        if (OsUtils.isWin32()) {
          assertEquals("Mismatched status for " + escapePath,SftpConstants.getStatusName(SftpConstants.SSH_FX_INVALID_FILENAME),SftpConstants.getStatusName(e.getStatus()));
        }
 else {
          assertEquals("Mismatched status for " + escapePath,SftpConstants.getStatusName(SftpConstants.SSH_FX_NO_SUCH_FILE),SftpConstants.getStatusName(e.getStatus()));
        }
      }
    }
  finally {
      client.stop();
    }
  }
 }

</code></pre>

<br>
<pre class="type-8 type-6 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRename() throws Exception {
  Path targetPath=detectTargetFolder();
  Path lclSftp=Utils.resolve(targetPath,SftpConstants.SFTP_SUBSYSTEM_NAME,getClass().getSimpleName(),getCurrentTestName());
  Utils.deleteRecursive(lclSftp);
  Path parentPath=targetPath.getParent();
  Path clientFolder=assertHierarchyTargetFolderExists(lclSftp.resolve("client"));
  try (SshClient client=setupTestClient()){
    client.start();
    try (ClientSession session=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession()){
      session.addPasswordIdentity(getCurrentTestName());
      session.auth().verify(5L,TimeUnit.SECONDS);
      try (SftpClient sftp=session.createSftpClient()){
        Path file1=clientFolder.resolve("file-1.txt");
        String file1Path=Utils.resolveRelativeRemotePath(parentPath,file1);
        try (OutputStream os=sftp.write(file1Path,SftpClient.MIN_WRITE_BUFFER_SIZE)){
          os.write((getCurrentTestName() + "\n").getBytes(StandardCharsets.UTF_8));
        }
         Path file2=clientFolder.resolve("file-2.txt");
        String file2Path=Utils.resolveRelativeRemotePath(parentPath,file2);
        Path file3=clientFolder.resolve("file-3.txt");
        String file3Path=Utils.resolveRelativeRemotePath(parentPath,file3);
        try {
          sftp.rename(file2Path,file3Path);
          fail("Unxpected rename success of " + file2Path + " => "+ file3Path);
        }
 catch (        org.apache.sshd.common.subsystem.sftp.SftpException e) {
          assertEquals("Mismatched status for failed rename of " + file2Path + " => "+ file3Path,SftpConstants.SSH_FX_NO_SUCH_FILE,e.getStatus());
        }
        try (OutputStream os=sftp.write(file2Path,SftpClient.MIN_WRITE_BUFFER_SIZE)){
          os.write("h".getBytes(StandardCharsets.UTF_8));
        }
         try {
          sftp.rename(file1Path,file2Path);
          fail("Unxpected rename success of " + file1Path + " => "+ file2Path);
        }
 catch (        org.apache.sshd.common.subsystem.sftp.SftpException e) {
          assertEquals("Mismatched status for failed rename of " + file1Path + " => "+ file2Path,SftpConstants.SSH_FX_FILE_ALREADY_EXISTS,e.getStatus());
        }
        sftp.rename(file1Path,file2Path,SftpClient.CopyMode.Overwrite);
      }
     }
  finally {
      client.stop();
    }
  }
 }

</code></pre>

<br>
<pre class="type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testServerDoesNotSupportSftp() throws Exception {
  sshd.setSubsystemFactories(null);
  try (SshClient client=setupTestClient()){
    client.start();
    try (ClientSession session=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession()){
      session.addPasswordIdentity(getCurrentTestName());
      session.auth().verify(5L,TimeUnit.SECONDS);
      PropertyResolverUtils.updateProperty(session,SftpClient.SFTP_CHANNEL_OPEN_TIMEOUT,TimeUnit.SECONDS.toMillis(4L));
      try (SftpClient sftp=session.createSftpClient()){
        fail("Unexpected SFTP client creation success");
      }
 catch (      SocketTimeoutException|EOFException|WindowClosedException e) {
      }
    }
  finally {
      client.stop();
    }
  }
 }

</code></pre>

<br>
<pre class="type-8 type-6 type-2 type-3 type-7 type-13 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOpen() throws Exception {
  Path targetPath=detectTargetFolder();
  Path parentPath=targetPath.getParent();
  Path lclSftp=Utils.resolve(targetPath,SftpConstants.SFTP_SUBSYSTEM_NAME,getClass().getSimpleName(),getCurrentTestName());
  Path clientFolder=lclSftp.resolve("client");
  Path testFile=clientFolder.resolve("file.txt");
  String file=Utils.resolveRelativeRemotePath(parentPath,testFile);
  File javaFile=testFile.toFile();
  assertHierarchyTargetFolderExists(javaFile.getParentFile());
  try (SshClient client=setupTestClient()){
    client.start();
    try (ClientSession session=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession()){
      session.addPasswordIdentity(getCurrentTestName());
      session.auth().verify(5L,TimeUnit.SECONDS);
      javaFile.createNewFile();
      javaFile.setWritable(false,false);
      javaFile.setReadable(false,false);
      try (SftpClient sftp=session.createSftpClient()){
        boolean isWindows=OsUtils.isWin32();
        try (SftpClient.CloseableHandle h=sftp.open(file)){
          assertTrue("Empty read should have failed on " + file,isWindows);
        }
 catch (        IOException e) {
          if (isWindows) {
            throw e;
          }
        }
        try (SftpClient.CloseableHandle h=sftp.open(file,EnumSet.of(SftpClient.OpenMode.Write))){
          fail("Empty write should have failed on " + file);
        }
 catch (        IOException e) {
        }
        try (SftpClient.CloseableHandle h=sftp.open(file,EnumSet.of(SftpClient.OpenMode.Truncate))){
          assertTrue("Empty truncate should have failed on " + file,isWindows);
        }
 catch (        IOException e) {
        }
        int perms=sftp.stat(file).getPermissions();
        int permsMask=SftpConstants.S_IWUSR | (isWindows ? 0 : SftpConstants.S_IRUSR);
        assertEquals("Mismatched permissions for " + file + ": 0x"+ Integer.toHexString(perms),0,(perms & permsMask));
        javaFile.setWritable(true,false);
        try (SftpClient.CloseableHandle h=sftp.open(file,EnumSet.of(SftpClient.OpenMode.Truncate,SftpClient.OpenMode.Write))){
          assertTrue("Handle not marked as open for file=" + file,h.isOpen());
        }
         byte[] d="0123456789\n".getBytes(StandardCharsets.UTF_8);
        try (SftpClient.CloseableHandle h=sftp.open(file,EnumSet.of(SftpClient.OpenMode.Write))){
          sftp.write(h,0,d,0,d.length);
          sftp.write(h,d.length,d,0,d.length);
        }
         try (SftpClient.CloseableHandle h=sftp.open(file,EnumSet.of(SftpClient.OpenMode.Write))){
          sftp.write(h,d.length * 2,d,0,d.length);
        }
         try (SftpClient.CloseableHandle h=sftp.open(file,EnumSet.of(SftpClient.OpenMode.Write))){
          byte[] overwrite="-".getBytes(StandardCharsets.UTF_8);
          sftp.write(h,3L,overwrite,0,1);
          d[3]=overwrite[0];
        }
         try (SftpClient.CloseableHandle h=sftp.open(file)){
          assertTrue("Data read should have failed on " + file,isWindows);
        }
 catch (        IOException e) {
          if (isWindows) {
            throw e;
          }
        }
        javaFile.setReadable(true,false);
        byte[] buf=new byte[3];
        try (SftpClient.CloseableHandle h=sftp.open(file)){
          int l=sftp.read(h,2L,buf,0,buf.length);
          String expected=new String(d,2,l,StandardCharsets.UTF_8);
          String actual=new String(buf,0,l,StandardCharsets.UTF_8);
          assertEquals("Mismatched read data",expected,actual);
        }
       }
     }
  finally {
      client.stop();
    }
  }
 }

</code></pre>

<br>
<pre class="type-11 type-8 type-10 type-6 type-3 type-7 type-13 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadBufferLimit() throws Exception {
  Path targetPath=detectTargetFolder();
  Path parentPath=targetPath.getParent();
  Path lclSftp=Utils.resolve(targetPath,SftpConstants.SFTP_SUBSYSTEM_NAME,getClass().getSimpleName(),getCurrentTestName());
  Path testFile=assertHierarchyTargetFolderExists(lclSftp).resolve("file.txt");
  byte[] expected=new byte[1024];
  Factory<? extends Random> factory=sshd.getRandomFactory();
  Random rnd=factory.create();
  rnd.fill(expected);
  Files.write(testFile,expected);
  try (SshClient client=setupTestClient()){
    client.start();
    try (ClientSession session=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession()){
      session.addPasswordIdentity(getCurrentTestName());
      session.auth().verify(5L,TimeUnit.SECONDS);
      try (SftpClient sftp=session.createSftpClient()){
        String file=Utils.resolveRelativeRemotePath(parentPath,testFile);
        byte[] actual=new byte[expected.length];
        int maxAllowed=actual.length / 4;
        PropertyResolverUtils.updateProperty(sshd,SftpSubsystem.MAX_PACKET_LENGTH_PROP,maxAllowed);
        try (CloseableHandle handle=sftp.open(file,OpenMode.Read)){
          int readLen=sftp.read(handle,0L,actual);
          assertEquals("Mismatched read len",maxAllowed,readLen);
          for (int index=0; index < readLen; index++) {
            byte expByte=expected[index], actByte=actual[index];
            if (expByte != actByte) {
              fail("Mismatched values at index=" + index + ": expected=0x"+ Integer.toHexString(expByte & 0xFF)+ ", actual=0x"+ Integer.toHexString(actByte & 0xFF));
            }
          }
        }
       }
     }
  finally {
      client.stop();
    }
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.client.subsystem.sftp.SftpVersionSelectorTest </h4><pre class="type-11 type-8 type-6 type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPreferredVersionSelector(){
  List<Integer> available=new ArrayList<>();
  for (int version=SftpSubsystem.LOWER_SFTP_IMPL; version <= SftpSubsystem.HIGHER_SFTP_IMPL; version++) {
    available.add(Integer.valueOf(version));
  }
  List<Integer> preferred=new ArrayList<>(available);
  List<Integer> unavailable=Arrays.asList(7365,3777347);
  Random rnd=new Random(System.nanoTime());
  for (int index=0; index < preferred.size(); index++) {
    Collections.shuffle(preferred,rnd);
    SftpVersionSelector selector=SftpVersionSelector.Utils.preferredVersionSelector(preferred);
    int expected=preferred.get(0);
    for (int current=SftpSubsystem.LOWER_SFTP_IMPL; current <= SftpSubsystem.HIGHER_SFTP_IMPL; current++) {
      assertEquals("Mismatched selected for current= " + current + ", available="+ available+ ", preferred="+ preferred,expected,selector.selectVersion(current,available));
      try {
        Collections.shuffle(unavailable,rnd);
        int version=unavailable.get(0);
        int actual=selector.selectVersion(version,unavailable);
        fail("Unexpected selected version (" + actual + ")"+ " for current= "+ version+ ", available="+ unavailable+ ", preferred="+ preferred);
      }
 catch (      IllegalStateException e) {
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.client.subsystem.sftp.extensions.impl.CopyFileExtensionImplTest </h4><pre class="type-8 type-6 type-2 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCopyFileExtension() throws Exception {
  Path targetPath=detectTargetFolder();
  Path lclSftp=Utils.resolve(targetPath,SftpConstants.SFTP_SUBSYSTEM_NAME,getClass().getSimpleName(),getCurrentTestName());
  Utils.deleteRecursive(lclSftp);
  byte[] data=(getClass().getName() + "#" + getCurrentTestName()).getBytes(StandardCharsets.UTF_8);
  Path srcFile=assertHierarchyTargetFolderExists(lclSftp).resolve("src.txt");
  Files.write(srcFile,data,IoUtils.EMPTY_OPEN_OPTIONS);
  Path parentPath=targetPath.getParent();
  String srcPath=Utils.resolveRelativeRemotePath(parentPath,srcFile);
  Path dstFile=lclSftp.resolve("dst.txt");
  String dstPath=Utils.resolveRelativeRemotePath(parentPath,dstFile);
  LinkOption[] options=IoUtils.getLinkOptions(false);
  assertFalse("Destination file unexpectedly exists",Files.exists(dstFile,options));
  try (SshClient client=setupTestClient()){
    client.start();
    try (ClientSession session=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession()){
      session.addPasswordIdentity(getCurrentTestName());
      session.auth().verify(5L,TimeUnit.SECONDS);
      try (SftpClient sftp=session.createSftpClient()){
        CopyFileExtension ext=assertExtensionCreated(sftp,CopyFileExtension.class);
        ext.copyFile(srcPath,dstPath,false);
        assertTrue("Source file not preserved",Files.exists(srcFile,options));
        assertTrue("Destination file not created",Files.exists(dstFile,options));
        byte[] actual=Files.readAllBytes(dstFile);
        assertArrayEquals("Mismatched copied data",data,actual);
        try {
          ext.copyFile(srcPath,dstPath,false);
          fail("Unexpected success to overwrite existing destination: " + dstFile);
        }
 catch (        IOException e) {
          assertTrue("Not an SftpException",e instanceof SftpException);
        }
      }
     }
  finally {
      client.stop();
    }
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.channel.ChannelPipedOutputStreamTest </h4><pre class="type-6 type-2 type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNioChannelImplementation() throws IOException {
  ChannelPipedSink sink=Mockito.mock(ChannelPipedSink.class);
  final AtomicBoolean eofCalled=new AtomicBoolean(false);
  Mockito.doAnswer(new Answer<Void>(){
    @Override public Void answer(    InvocationOnMock invocation) throws Throwable {
      assertFalse("Multiple EOF calls",eofCalled.getAndSet(true));
      return null;
    }
  }
).when(sink).eof();
  final AtomicInteger receiveCount=new AtomicInteger(0);
  Mockito.doAnswer(new Answer<Void>(){
    @Override public Void answer(    InvocationOnMock invocation) throws Throwable {
      Number len=invocation.getArgumentAt(2,Number.class);
      receiveCount.addAndGet(len.intValue());
      return null;
    }
  }
).when(sink).receive(Matchers.any(byte[].class),Matchers.anyInt(),Matchers.anyInt());
  try (ChannelPipedOutputStream stream=new ChannelPipedOutputStream(sink)){
    assertTrue("Stream not marked as initially open",stream.isOpen());
    assertEquals("Unexpected initial receive count",0,receiveCount.intValue());
    byte[] b=getCurrentTestName().getBytes(StandardCharsets.UTF_8);
    stream.write(b);
    assertTrue("Stream not marked as still open after write data",stream.isOpen());
    assertEquals("Mismatched write data count",b.length,receiveCount.intValue());
    stream.close();
    assertFalse("Stream still marked as open after close",stream.isOpen());
    assertTrue("Sink EOF not called on close",eofCalled.get());
    try {
      stream.write(b);
      fail("Unexpected write success after close");
    }
 catch (    IOException e) {
    }
    try {
      stream.flush();
      fail("Unexpected flush success after close");
    }
 catch (    IOException e) {
    }
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.channel.WindowTimeoutTest </h4><pre class="type-6 type-2 type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWindowWaitForSpaceTimeout() throws Exception {
  try (Window window=channel.getLocalWindow()){
    window.init(FactoryManager.DEFAULT_WINDOW_SIZE,FactoryManager.DEFAULT_MAX_PACKET_SIZE,null);
    window.consume(window.getSize());
    assertEquals("Window not empty",0,window.getSize());
    long waitStart=System.nanoTime();
    try {
      int len=window.waitForSpace(MAX_WAIT_TIME);
      fail("Unexpected timed wait success - len=" + len);
    }
 catch (    SocketTimeoutException e) {
      long waitEnd=System.nanoTime();
      long waitDuration=TimeUnit.NANOSECONDS.toMillis(waitEnd - waitStart);
      assertTrue("Timeout too soon: " + waitDuration,waitDuration >= (MAX_WAIT_TIME - 100L));
    }
    window.close();
    assertFalse("Window not closed",window.isOpen());
    try {
      int len=window.waitForSpace(MAX_WAIT_TIME);
      fail("Unexpected closed wait success - len=" + len);
    }
 catch (    WindowClosedException e) {
    }
  }
 }

</code></pre>

<br>
<pre class="type-6 type-2 type-3 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWindowWaitAndConsumeTimeout() throws Exception {
  try (Window window=channel.getLocalWindow()){
    window.init(FactoryManager.DEFAULT_WINDOW_SIZE,FactoryManager.DEFAULT_MAX_PACKET_SIZE,null);
    long waitStart=System.nanoTime();
    try {
      window.waitAndConsume(2 * window.getSize(),MAX_WAIT_TIME);
      fail("Unexpected timed wait success");
    }
 catch (    SocketTimeoutException e) {
      long waitEnd=System.nanoTime();
      long waitDuration=TimeUnit.NANOSECONDS.toMillis(waitEnd - waitStart);
      assertTrue("Timeout too soon: " + waitDuration,waitDuration >= (MAX_WAIT_TIME - 100L));
    }
    window.close();
    assertFalse("Window not closed",window.isOpen());
    try {
      window.waitAndConsume(2 * window.getSize(),MAX_WAIT_TIME);
      fail("Unexpected closed wait success");
    }
 catch (    WindowClosedException e) {
    }
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.cipher.BuiltinCiphersTest </h4><pre class="type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testNotAllowedToRegisterBuiltinFactories(){
  for (  CipherFactory expected : BuiltinCiphers.VALUES) {
    try {
      BuiltinCiphers.registerExtension(expected);
      fail("Unexpected sucess for " + expected.getName());
    }
 catch (    IllegalArgumentException e) {
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.compression.BuiltinCompressionsTest </h4><pre class="type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testNotAllowedToRegisterBuiltinFactories(){
  for (  CompressionFactory expected : BuiltinCompressions.VALUES) {
    try {
      BuiltinCompressions.registerExtension(expected);
      fail("Unexpected sucess for " + expected.getName());
    }
 catch (    IllegalArgumentException e) {
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.config.SshConfigFileReaderTest </h4><pre class="type-6 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testNonLenientCiphersConfiguration(){
  FactoryManager manager=SshConfigFileReader.configureCiphers(new AbstractFactoryManager(){
    @Override protected Closeable getInnerCloseable(){
      return null;
    }
  }
,getCurrentTestName(),false,true);
  fail("Unexpected success: " + NamedResource.Utils.getNames(manager.getCipherFactories()));
}

</code></pre>

<br>
<pre class="type-6 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testNonLenientSignaturesConfiguration(){
  FactoryManager manager=SshConfigFileReader.configureSignatures(new AbstractFactoryManager(){
    @Override protected Closeable getInnerCloseable(){
      return null;
    }
  }
,getCurrentTestName(),false,true);
  fail("Unexpected success: " + NamedResource.Utils.getNames(manager.getSignatureFactories()));
}

</code></pre>

<br>
<pre class="type-6 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testNonLenientMacsConfiguration(){
  FactoryManager manager=SshConfigFileReader.configureMacs(new AbstractFactoryManager(){
    @Override protected Closeable getInnerCloseable(){
      return null;
    }
  }
,getCurrentTestName(),false,true);
  fail("Unexpected success: " + NamedResource.Utils.getNames(manager.getMacFactories()));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.file.util.BasePathTest </h4><pre class="type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testRelativizeOneAbsoluteOneRelative(){
  try {
    parsePath("/foo/bar").relativize(parsePath("foo"));
    fail();
  }
 catch (  IllegalArgumentException expected) {
  }
  try {
    parsePath("foo").relativize(parsePath("/foo/bar"));
    fail();
  }
 catch (  IllegalArgumentException expected) {
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.kex.AbstractDHTest </h4><pre class="type-11 type-8 type-10 type-6 type-15 type-7 type-13 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStripLeadingZeroes(){
  byte[] data={3,7,7,3,4,7};
  for (int index=1; index <= data.length; index++) {
    assertSame("Unexpected sub-array generation for " + Arrays.toString(data),data,AbstractDH.stripLeadingZeroes(data));
    if (index < data.length) {
      data[index]=0;
    }
  }
  Arrays.fill(data,(byte)0);
  try {
    byte[] stripped=AbstractDH.stripLeadingZeroes(data);
    fail("Unexpected success for all zeroes data: " + Arrays.toString(stripped));
  }
 catch (  IllegalArgumentException expected) {
  }
  for (int index=data.length - 1; index > 0; index--) {
    data[index]=(byte)index;
    byte[] stripped=AbstractDH.stripLeadingZeroes(data);
    String ds=Arrays.toString(data), ss=Arrays.toString(stripped);
    assertEquals("Mismatched stripped (" + ss + ") length for "+ ds,data.length - index,stripped.length);
    for (int i=index, j=0; j < stripped.length; i++, j++) {
      if (data[i] != stripped[j]) {
        fail("Mismatched values at stripped index = " + j + ": data="+ ds+ ", stripped="+ ss);
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.kex.BuiltinDHFactoriesTest </h4><pre class="type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testNotAllowedToRegisterBuiltinFactories(){
  for (  DHFactory expected : BuiltinDHFactories.VALUES) {
    try {
      BuiltinDHFactories.registerExtension(expected);
      fail("Unexpected sucess for " + expected.getName());
    }
 catch (    IllegalArgumentException e) {
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.mac.BuiltinMacsTest </h4><pre class="type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testNotAllowedToRegisterBuiltinFactories(){
  for (  MacFactory expected : BuiltinMacs.VALUES) {
    try {
      BuiltinMacs.registerExtension(expected);
      fail("Unexpected sucess for " + expected.getName());
    }
 catch (    IllegalArgumentException e) {
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.session.AbstractSessionTest </h4><pre class="type-8 type-6 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=IllegalStateException.class) public void testReadIdentLongLine(){
  Buffer buf=new ByteArrayBuffer(("SSH-2.0-software" + "01234567890123456789012345678901234567890123456789" + "01234567890123456789012345678901234567890123456789"+ "01234567890123456789012345678901234567890123456789"+ "01234567890123456789012345678901234567890123456789"+ "01234567890123456789012345678901234567890123456789"+ "01234567890123456789012345678901234567890123456789").getBytes(StandardCharsets.UTF_8));
  String ident=session.doReadIdentification(buf);
  fail("Unexpected success: " + ident);
}

</code></pre>

<br>
<pre class="type-8 type-6 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=IllegalStateException.class) public void testReadIdentBadLineEnding(){
  Buffer buf=new ByteArrayBuffer(("SSH-2.0-software\ra").getBytes(StandardCharsets.UTF_8));
  String ident=session.doReadIdentification(buf);
  fail("Unexpected success: " + ident);
}

</code></pre>

<br>
<pre class="type-8 type-6 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=IllegalStateException.class) public void testReadIdentLongHeader(){
  StringBuilder sb=new StringBuilder(32768);
  for (int i=0; i < 500; i++) {
    sb.append("01234567890123456789012345678901234567890123456789\r\n");
  }
  sb.append("SSH-2.0-software\r\n");
  Buffer buf=new ByteArrayBuffer(sb.toString().getBytes(StandardCharsets.UTF_8));
  String ident=session.doReadIdentification(buf);
  fail("Unexpected success: " + ident);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.signature.BuiltinSignaturesTest </h4><pre class="type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testNotAllowedToRegisterBuiltinFactories(){
  for (  SignatureFactory expected : BuiltinSignatures.VALUES) {
    try {
      BuiltinSignatures.registerExtension(expected);
      fail("Unexpected sucess for " + expected.getName());
    }
 catch (    IllegalArgumentException e) {
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.subsystem.sftp.SftpUniversalOwnerAndGroupTest </h4><pre class="type-11 type-10 type-6 type-2 type-3 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNameFormat(){
  for (  SftpUniversalOwnerAndGroup value : SftpUniversalOwnerAndGroup.VALUES) {
    String name=value.getName();
    assertFalse(value.name() + ": empty name",GenericUtils.isEmpty(name));
    assertTrue(value.name() + ": bad suffix",name.charAt(name.length() - 1) == '@');
    for (int index=0; index < name.length() - 1; index++) {
      char ch=name.charAt(index);
      if ((ch < 'A') || (ch > 'Z')) {
        fail("Non-uppercase character in " + name);
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.util.GenericUtilsTest </h4><pre class="type-11 type-8 type-10 type-6 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSplitAndJoin(){
  List<String> expected=Collections.unmodifiableList(Arrays.asList(getClass().getPackage().getName().replace('.','/'),getClass().getSimpleName(),getCurrentTestName()));
  for (  char ch : new char[]{',','.','*','?'}) {
    String sep=String.valueOf(ch);
    String s=GenericUtils.join(expected,sep);
    String[] actual=GenericUtils.split(s,ch);
    assertEquals("Mismatched split length for separator=" + sep,expected.size(),GenericUtils.length((Object[])actual));
    for (int index=0; index < actual.length; index++) {
      String e=expected.get(index), a=actual[index];
      if (!e.endsWith(a)) {
        fail("Mismatched value at index=" + index + " for separator="+ sep+ ": expected="+ e+ ", actual="+ a);
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.util.closeable.CloseableUtilsTest </h4><pre class="type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCloseImmediateNotCalledIfAlreadyClosed() throws IOException {
  Closeable closeable=new IoBaseCloseable(){
    @Override public CloseFuture close(    boolean immediately){
      fail("Unexpected call to close(" + immediately + ")");
      return null;
    }
    @Override public boolean isClosed(){
      return true;
    }
    @Override public boolean isClosing(){
      return false;
    }
  }
;
  closeable.close();
}

</code></pre>

<br>
<pre class="type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
"></span><br>
@Test public void testCloseImmediateNotCalledIfIsClosing() throws IOException {
  Closeable closeable=new IoBaseCloseable(){
    @Override public CloseFuture close(    boolean immediately){
      fail("Unexpected call to close(" + immediately + ")");
      return null;
    }
    @Override public boolean isClosed(){
      return false;
    }
    @Override public boolean isClosing(){
      return true;
    }
  }
;
  closeable.close();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.util.io.LimitInputStreamTest </h4><pre class="type-8 type-6 type-2 type-3 type-7 type-13 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadLimit() throws IOException {
  Path targetPath=detectTargetFolder();
  Path rootFolder=assertHierarchyTargetFolderExists(targetPath.resolve(getClass().getSimpleName()));
  Path inputFile=rootFolder.resolve(getCurrentTestName() + ".bin");
  byte[] data=(getClass().getName() + "#" + getCurrentTestName()).getBytes(StandardCharsets.UTF_8);
  Files.write(inputFile,data);
  try (InputStream in=Files.newInputStream(inputFile)){
    int maxLen=data.length / 2;
    byte[] expected=new byte[maxLen];
    System.arraycopy(data,0,expected,0,expected.length);
    byte[] actual=new byte[expected.length];
    try (LimitInputStream limited=new LimitInputStream(in,expected.length)){
      assertTrue("Limited stream not marked as open",limited.isOpen());
      assertEquals("Mismatched initial available data size",expected.length,limited.available());
      int readLen=limited.read(actual);
      assertEquals("Incomplete actual data read",actual.length,readLen);
      assertArrayEquals("Mismatched read data",expected,actual);
      assertEquals("Mismatched remaining available data size",0,limited.available());
      readLen=limited.read();
      assertTrue("Unexpected success to read one more byte: " + readLen,readLen < 0);
      readLen=limited.read(actual);
      assertTrue("Unexpected success to read extra buffer: " + readLen,readLen < 0);
      limited.close();
      assertFalse("Limited stream still marked as open",limited.isOpen());
      try {
        readLen=limited.read();
        fail("Unexpected one byte read success after close");
      }
 catch (      IOException e) {
      }
      try {
        readLen=limited.read(actual);
        fail("Unexpected buffer read success after close: " + readLen);
      }
 catch (      IOException e) {
      }
      try {
        readLen=limited.read(actual);
        fail("Unexpected buffer read success after close: " + readLen);
      }
 catch (      IOException e) {
      }
      try {
        readLen=(int)limited.skip(Byte.SIZE);
        fail("Unexpected skip success after close: " + readLen);
      }
 catch (      IOException e) {
      }
      try {
        readLen=limited.available();
        fail("Unexpected available success after close: " + readLen);
      }
 catch (      IOException e) {
      }
    }
     int readLen=in.read(actual);
    assertEquals("Incomplete extra data read",Math.min(actual.length,data.length - expected.length),readLen);
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.server.ServerSessionListenerTest </h4><pre class="type-11 type-8 type-6 type-2 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testServerStillListensIfSessionListenerThrowsException() throws Exception {
  final Map<String,SocketAddress> eventsMap=new TreeMap<String,SocketAddress>(String.CASE_INSENSITIVE_ORDER);
  final Logger log=LoggerFactory.getLogger(getClass());
  sshd.addSessionListener(new SessionListener(){
    @Override public void sessionCreated(    Session session){
      throwException("SessionCreated",session);
    }
    @Override public void sessionEvent(    Session session,    Event event){
      throwException("SessionEvent",session);
    }
    @Override public void sessionClosed(    Session session){
      throwException("SessionClosed",session);
    }
    @Override public void sessionException(    Session session,    Throwable t){
    }
    private void throwException(    String phase,    Session session){
      IoSession ioSession=session.getIoSession();
      SocketAddress addr=ioSession.getRemoteAddress();
synchronized (eventsMap) {
        if (eventsMap.put(phase,addr) != null) {
          return;
        }
      }
      RuntimeException e=new RuntimeException("Synthetic exception at phase=" + phase + ": "+ addr);
      log.info(e.getMessage());
      throw e;
    }
  }
);
  client.start();
  int curCount=0;
  for (int retryCount=0; retryCount < Byte.SIZE; retryCount++) {
synchronized (eventsMap) {
      if ((curCount=eventsMap.size()) >= 3) {
        return;
      }
    }
    try {
      try (ClientSession s=createTestClientSession()){
        log.info("Retry #" + retryCount + " successful");
      }
 synchronized (eventsMap) {
        assertTrue("Unexpected premature success at retry # " + retryCount + ": "+ eventsMap,eventsMap.size() >= 3);
      }
    }
 catch (    IOException e) {
synchronized (eventsMap) {
        int nextCount=eventsMap.size();
        assertTrue("No session event generated at retry #" + retryCount,nextCount > curCount);
      }
    }
  }
  fail("No success to authenticate");
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
