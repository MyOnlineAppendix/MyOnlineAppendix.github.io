<h3><span class=" glyphicon glyphicon-tag"/>&nbspIterativeVerifier</h3><kbd>Verifies assertions in iterations</kbd><br><br><br><h4 style="margin:0px">Class: org.apache.sshd.KeyReExchangeTest </h4><pre class="type-11 type-8 type-10 type-6 type-2 type-3 type-7 type-12 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReExchangeFromSshdClient() throws Exception {
  setUp(0L,0L,0L);
  try (SshClient client=setupTestClient()){
    client.start();
    try (ClientSession session=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession()){
      session.addPasswordIdentity(getCurrentTestName());
      session.auth().verify(5L,TimeUnit.SECONDS);
      final Semaphore pipedCount=new Semaphore(0,true);
      try (ChannelShell channel=session.createShellChannel();ByteArrayOutputStream sent=new ByteArrayOutputStream();PipedOutputStream pipedIn=new PipedOutputStream();InputStream inPipe=new PipedInputStream(pipedIn);OutputStream teeOut=new TeeOutputStream(sent,pipedIn);ByteArrayOutputStream out=new ByteArrayOutputStream(){
        private long writeCount=0L;
        @Override public void write(        int b){
          super.write(b);
          updateWriteCount(1L);
          pipedCount.release(1);
        }
        @Override public void write(        byte[] b,        int off,        int len){
          super.write(b,off,len);
          updateWriteCount(len);
          pipedCount.release(len);
        }
        private void updateWriteCount(        long delta){
          writeCount+=delta;
          outputDebugMessage("OUT write count=%d",writeCount);
        }
      }
;ByteArrayOutputStream err=new ByteArrayOutputStream()){
        channel.setIn(inPipe);
        channel.setOut(out);
        channel.setErr(err);
        channel.open();
        teeOut.write("this is my command\n".getBytes(StandardCharsets.UTF_8));
        teeOut.flush();
        StringBuilder sb=new StringBuilder(Byte.MAX_VALUE);
        for (int i=0; i < 10; i++) {
          sb.append("0123456789");
        }
        sb.append('\n');
        byte[] data=sb.toString().getBytes(StandardCharsets.UTF_8);
        for (int i=1; i <= 10; i++) {
          teeOut.write(data);
          teeOut.flush();
          KeyExchangeFuture kexFuture=session.reExchangeKeys();
          assertTrue("Failed to complete KEX on time at iteration " + i,kexFuture.await(5L,TimeUnit.SECONDS));
          assertNull("KEX exception signalled at iteration " + i,kexFuture.getException());
        }
        teeOut.write("exit\n".getBytes(StandardCharsets.UTF_8));
        teeOut.flush();
        Collection<ClientChannel.ClientChannelEvent> result=channel.waitFor(EnumSet.of(ClientChannel.ClientChannelEvent.CLOSED),TimeUnit.SECONDS.toMillis(15L));
        assertFalse("Timeout while waiting for channel closure",result.contains(ClientChannel.ClientChannelEvent.TIMEOUT));
        byte[] expected=sent.toByteArray();
        if (!pipedCount.tryAcquire(expected.length,13L,TimeUnit.SECONDS)) {
          fail("Failed to await sent data signal for len=" + expected.length + " (available="+ pipedCount.availablePermits()+ ")");
        }
        assertArrayEquals("Mismatched sent data content",expected,out.toByteArray());
      }
     }
  finally {
      client.stop();
    }
  }
 }

</code></pre>

<br>
<pre class="type-11 type-8 type-3 type-14 type-7 type-13 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReExchangeFromJschClient() throws Exception {
  Assume.assumeTrue("DH Group Exchange not supported",SecurityUtils.isDHGroupExchangeSupported());
  setUp(0L,0L,0L);
  JSch.setConfig("kex",BuiltinDHFactories.Constants.DIFFIE_HELLMAN_GROUP_EXCHANGE_SHA1);
  JSch sch=new JSch();
  com.jcraft.jsch.Session s=sch.getSession(getCurrentTestName(),TEST_LOCALHOST,port);
  try {
    s.setUserInfo(new SimpleUserInfo(getCurrentTestName()));
    s.connect();
    com.jcraft.jsch.Channel c=s.openChannel(Channel.CHANNEL_SHELL);
    c.connect();
    try (OutputStream os=c.getOutputStream();InputStream is=c.getInputStream()){
      String expected="this is my command\n";
      byte[] bytes=expected.getBytes(StandardCharsets.UTF_8);
      byte[] data=new byte[bytes.length + Long.SIZE];
      for (int i=1; i <= 10; i++) {
        os.write(bytes);
        os.flush();
        int len=is.read(data);
        String str=new String(data,0,len);
        assertEquals("Mismatched data at iteration " + i,expected,str);
        outputDebugMessage("Request re-key #%d",i);
        s.rekey();
      }
    }
  finally {
      c.disconnect();
    }
  }
  finally {
    s.disconnect();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.ProxyTest </h4><pre class="type-11 type-8 type-6 type-3 type-7 type-13 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSocksProxy() throws Exception {
  try (ClientSession session=createNativeSession()){
    String expected=getCurrentTestName();
    byte[] bytes=expected.getBytes(StandardCharsets.UTF_8);
    byte[] buf=new byte[bytes.length + Long.SIZE];
    SshdSocketAddress dynamic=session.startDynamicPortForwarding(new SshdSocketAddress(TEST_LOCALHOST,0));
    try {
      for (int i=0; i < 10; i++) {
        try (Socket s=new Socket(new Proxy(Proxy.Type.SOCKS,new InetSocketAddress(TEST_LOCALHOST,dynamic.getPort())))){
          s.connect(new InetSocketAddress(TEST_LOCALHOST,echoPort));
          s.setSoTimeout((int)TimeUnit.SECONDS.toMillis(10L));
          try (OutputStream sockOut=s.getOutputStream();InputStream sockIn=s.getInputStream()){
            sockOut.write(bytes);
            sockOut.flush();
            int l=sockIn.read(buf);
            assertEquals("Mismatched data at iteration " + i,expected,new String(buf,0,l));
          }
         }
       }
    }
  finally {
      session.stopDynamicPortForwarding(dynamic);
    }
    try {
      try (Socket s=new Socket(new Proxy(Proxy.Type.SOCKS,new InetSocketAddress(TEST_LOCALHOST,dynamic.getPort())))){
        s.connect(new InetSocketAddress(TEST_LOCALHOST,echoPort));
        s.setSoTimeout((int)TimeUnit.SECONDS.toMillis(10L));
        s.getOutputStream().write(bytes);
        fail("Unexpected success to write proxy data");
      }
     }
 catch (    IOException e) {
    }
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.client.ClientTest </h4><pre class="type-11 type-2 type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testClientStillActiveIfListenerExceptions() throws Exception {
  final Map<String,Integer> eventsMap=new TreeMap<>(String.CASE_INSENSITIVE_ORDER);
  final Collection<String> failuresSet=new TreeSet<>(String.CASE_INSENSITIVE_ORDER);
  final Logger log=LoggerFactory.getLogger(getClass());
  client.addChannelListener(new ChannelListener(){
    @Override public void channelInitialized(    Channel channel){
      handleChannelEvent("Initialized",channel);
    }
    @Override public void channelOpenSuccess(    Channel channel){
      handleChannelEvent("OpenSuccess",channel);
    }
    @Override public void channelOpenFailure(    Channel channel,    Throwable reason){
      assertObjectInstanceOf("Mismatched failure reason type",ChannelFailureException.class,reason);
      String name=((NamedResource)reason).getName();
synchronized (failuresSet) {
        assertTrue("Re-signalled failure location: " + name,failuresSet.add(name));
      }
    }
    @Override public void channelClosed(    Channel channel,    Throwable reason){
      log.info("channelClosed(" + channel + ") reason="+ reason);
    }
    private void handleChannelEvent(    String name,    Channel channel){
      int id=channel.getId();
synchronized (eventsMap) {
        if (eventsMap.put(name,id) != null) {
          return;
        }
      }
      log.info("handleChannelEvent({})[{}] id={}",channel,name,id);
      throw new ChannelFailureException(name);
    }
  }
);
  client.start();
  try (ClientSession session=createTestClientSession();PipedOutputStream pipedIn=new PipedOutputStream();InputStream inPipe=new PipedInputStream(pipedIn);ByteArrayOutputStream out=new ByteArrayOutputStream();ByteArrayOutputStream err=new ByteArrayOutputStream()){
    for (int retryCount=0; retryCount <= 3; retryCount++) {
      try {
        out.reset();
        err.reset();
        try (ChannelShell channel=session.createShellChannel()){
          channel.setIn(inPipe);
          channel.setOut(out);
          channel.setErr(err);
          channel.open().verify(11L,TimeUnit.SECONDS);
          log.info("Channel established at retry#" + retryCount);
          try (OutputStream stdin=channel.getInvertedIn()){
            stdin.write((getCurrentTestName() + "-retry#" + retryCount+ "\n").getBytes(StandardCharsets.UTF_8));
          }
           break;
        }
       }
 catch (      IOException e) {
        outputDebugMessage("%s at retry #%d: %s",e.getClass().getSimpleName(),retryCount,e.getMessage());
synchronized (eventsMap) {
          eventsMap.remove("Closed");
          assertTrue("Unexpected failure at retry #" + retryCount,eventsMap.size() < 3);
        }
      }
catch (      ChannelFailureException e) {
        assertEquals("Mismatched failure reason","Initialized",e.getMessage());
      }
catch (      IllegalStateException e) {
        assertTrue("Premature exception phase - count=" + retryCount,retryCount > 0);
        assertTrue("Session not closing",session.isClosing() || session.isClosed());
        log.warn("Session closing prematurely: " + session);
        return;
      }
    }
  }
  finally {
    client.stop();
  }
  assertEquals("Mismatched total failures count on test end",2,eventsMap.size());
  assertEquals("Mismatched open failures count on test end: " + failuresSet,1,failuresSet.size());
}

</code></pre>

<br>
<pre class="type-11 type-2 type-3 type-12 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDefaultKeyboardInteractivePasswordPromptLocationIndependence() throws Exception {
  final Collection<String> mismatchedPrompts=new LinkedList<String>();
  client.setUserAuthFactories(Arrays.<NamedFactory<UserAuth>>asList(new UserAuthKeyboardInteractiveFactory(){
    @Override public UserAuthKeyboardInteractive create(){
      return new UserAuthKeyboardInteractive(){
        @Override protected boolean useCurrentPassword(        String password,        String name,        String instruction,        String lang,        String[] prompt,        boolean[] echo){
          boolean expected=GenericUtils.length(password) > 0;
          boolean actual=super.useCurrentPassword(password,name,instruction,lang,prompt,echo);
          if (expected != actual) {
            System.err.println("Mismatched usage result for prompt=" + prompt[0] + ": expected="+ expected+ ", actual=actual");
            mismatchedPrompts.add(prompt[0]);
          }
          return actual;
        }
      }
;
    }
  }
));
  client.start();
  final Transformer<String,String> stripper=new Transformer<String,String>(){
    @Override public String transform(    String input){
      int pos=GenericUtils.isEmpty(input) ? (-1) : input.lastIndexOf(':');
      if (pos < 0) {
        return input;
      }
 else {
        return input.substring(0,pos);
      }
    }
  }
;
  final List<Transformer<String,String>> xformers=Collections.unmodifiableList(Arrays.<Transformer<String,String>>asList(new Transformer<String,String>(){
    @Override public String transform(    String input){
      return getCurrentTestName() + " " + input;
    }
  }
,new Transformer<String,String>(){
    @Override public String transform(    String input){
      return stripper.transform(input) + " " + getCurrentTestName()+ ":";
    }
  }
,new Transformer<String,String>(){
    @Override public String transform(    String input){
      return getCurrentTestName() + " " + stripper.transform(input)+ " "+ getCurrentTestName()+ ":";
    }
  }
));
  sshd.setKeyboardInteractiveAuthenticator(new DefaultKeyboardInteractiveAuthenticator(){
    private int xformerIndex;
    @Override protected String getInteractionPrompt(    ServerSession session){
      String original=super.getInteractionPrompt(session);
      if (xformerIndex < xformers.size()) {
        Transformer<String,String> x=xformers.get(xformerIndex);
        xformerIndex++;
        return x.transform(original);
      }
 else {
        return original;
      }
    }
  }
);
  try {
    for (int index=0; index < xformers.size(); index++) {
      try (ClientSession session=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7,TimeUnit.SECONDS).getSession()){
        assertNotNull("Client session creation not signalled at iteration #" + index,clientSessionHolder.get());
        String password="bad-" + getCurrentTestName() + "-"+ index;
        session.addPasswordIdentity(password);
        AuthFuture future=session.auth();
        assertTrue("Failed to verify password=" + password + " in time",future.await(5L,TimeUnit.SECONDS));
        assertFalse("Unexpected success for password=" + password,future.isSuccess());
        session.removePasswordIdentity(password);
      }
       assertNull("Session closure not signalled at iteration #" + index,clientSessionHolder.get());
    }
    try (ClientSession session=createTestClientSession()){
      assertTrue("Mismatched prompts evaluation results",mismatchedPrompts.isEmpty());
    }
     assertNull("Final session closure not signalled",clientSessionHolder.get());
  }
  finally {
    client.stop();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.client.config.hosts.HostConfigEntryTest </h4><pre class="type-11 type-8 type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether two objects/variables are the same
"></span><br>
@Test public void testFindBestMatch(){
  final String HOST=getCurrentTestName();
  HostConfigEntry expected=new HostConfigEntry(HOST,HOST,7365,HOST);
  List<HostConfigEntry> matches=new ArrayList<>();
  matches.add(new HostConfigEntry(HostConfigEntry.ALL_HOSTS_PATTERN,getClass().getSimpleName(),Short.MAX_VALUE,getClass().getSimpleName()));
  matches.add(new HostConfigEntry(HOST + String.valueOf(HostConfigEntry.WILDCARD_PATTERN),getClass().getSimpleName(),Byte.MAX_VALUE,getClass().getSimpleName()));
  matches.add(expected);
  for (int index=0; index < matches.size(); index++) {
    HostConfigEntry actual=HostConfigEntry.findBestMatch(matches);
    assertSame("Mismatched best match for " + matches,expected,actual);
    Collections.shuffle(matches);
  }
}

</code></pre>

<br>
<pre class="type-11 type-8 type-2 type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadGlobalHostsConfigEntries() throws IOException {
  List<HostConfigEntry> entries=validateHostConfigEntries(readHostConfigEntries());
  assertTrue("Not enough entries read",GenericUtils.size(entries) > 1);
  HostConfigEntry globalEntry=entries.get(0);
  assertEquals("Mismatched global entry pattern",HostConfigEntry.ALL_HOSTS_PATTERN,globalEntry.getHost());
  for (int index=1; index < entries.size(); index++) {
    HostConfigEntry entry=entries.get(index);
    assertFalse("No target host for " + entry,GenericUtils.isEmpty(entry.getHostName()));
    assertTrue("No target port for " + entry,entry.getPort() > 0);
    assertFalse("No username for " + entry,GenericUtils.isEmpty(entry.getUsername()));
    assertFalse("No identities for " + entry,GenericUtils.isEmpty(entry.getIdentities()));
    assertFalse("No properties for " + entry,GenericUtils.isEmpty(entry.getProperties()));
  }
}

</code></pre>

<br>
<pre class="type-11 type-8 type-2 type-13 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values related to public fields.
"></span><br>
@Test public void testNegatingPatternOverridesAll(){
  String testHost="37.77.34.7";
  String[] elements=GenericUtils.split(testHost,'.');
  StringBuilder sb=new StringBuilder(testHost.length() + Byte.SIZE);
  List<Pair<Pattern,Boolean>> patterns=new ArrayList<>(elements.length + 1);
  patterns.add(HostConfigEntry.toPattern(String.valueOf(HostConfigEntry.NEGATION_CHAR_PATTERN) + testHost));
  for (int i=0; i < elements.length; i++) {
    sb.setLength(0);
    for (int j=0; j < elements.length; j++) {
      if (j > 0) {
        sb.append('.');
      }
      if (i == j) {
        sb.append(HostConfigEntry.WILDCARD_PATTERN);
      }
 else {
        sb.append(elements[j]);
      }
    }
    patterns.add(HostConfigEntry.toPattern(sb));
  }
  for (int index=0; index < patterns.size(); index++) {
    assertFalse("Unexpected match for " + patterns,HostConfigEntry.isHostMatch(testHost,patterns));
    Collections.shuffle(patterns);
  }
}

</code></pre>

<br>
<pre class="type-11 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testIPAddressWildcardPatternMatching(){
  StringBuilder sb=new StringBuilder().append("10.0.0.");
  int sbLen=sb.length();
  Pattern pattern=HostConfigEntry.toPattern(sb.append(HostConfigEntry.WILDCARD_PATTERN)).getFirst();
  for (int v=0; v <= 255; v++) {
    sb.setLength(sbLen);
    sb.append(v);
    String address=sb.toString();
    assertTrue("No match for " + address,HostConfigEntry.isHostMatch(address,pattern));
  }
}

</code></pre>

<br>
<pre class="type-11 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testIPAddressSingleCharPatternMatching(){
  StringBuilder sb=new StringBuilder().append("10.0.0.");
  int sbLen=sb.length();
  for (int v=0; v <= 255; v++) {
    sb.setLength(sbLen);
    sb.append(v);
    String address=sb.toString();
    for (int index=sbLen; index < sb.length(); index++) {
      sb.setCharAt(index,HostConfigEntry.SINGLE_CHAR_PATTERN);
    }
    String pattern=sb.toString();
    Pair<Pattern,Boolean> pp=HostConfigEntry.toPattern(pattern);
    assertTrue("No match for " + address + " on pattern="+ pattern,HostConfigEntry.isHostMatch(address,Collections.singletonList(pp)));
  }
}

</code></pre>

<br>
<pre class="type-11 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
"></span><br>
@Test public void testIsValidPatternChar(){
  for (char ch='\0'; ch <= ' '; ch++) {
    assertFalse("Unexpected valid character (0x" + Integer.toHexString(ch & 0xFF) + ")",HostConfigEntry.isValidPatternChar(ch));
  }
  for (char ch='a'; ch <= 'z'; ch++) {
    assertTrue("Valid character not recognized: " + String.valueOf(ch),HostConfigEntry.isValidPatternChar(ch));
  }
  for (char ch='A'; ch <= 'Z'; ch++) {
    assertTrue("Valid character not recognized: " + String.valueOf(ch),HostConfigEntry.isValidPatternChar(ch));
  }
  for (char ch='0'; ch <= '9'; ch++) {
    assertTrue("Valid character not recognized: " + String.valueOf(ch),HostConfigEntry.isValidPatternChar(ch));
  }
  for (  char ch : new char[]{'-','_','.',HostConfigEntry.SINGLE_CHAR_PATTERN,HostConfigEntry.WILDCARD_PATTERN}) {
    assertTrue("Valid character not recognized: " + String.valueOf(ch),HostConfigEntry.isValidPatternChar(ch));
  }
  for (  char ch : new char[]{'(',')','{','}','[',']','@','#','$','^','&','%','~','<','>',',','/','\\','\'','"',':',';'}) {
    assertFalse("Unexpected valid character: " + String.valueOf(ch),HostConfigEntry.isValidPatternChar(ch));
  }
  for (char ch=0x7E; ch <= 0xFF; ch++) {
    assertFalse("Unexpected valid character (0x" + Integer.toHexString(ch & 0xFF) + ")",HostConfigEntry.isValidPatternChar(ch));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.client.scp.ScpTest </h4><pre class="type-11 type-8 type-2 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNormalizedScpRemotePaths() throws Exception {
  Path targetPath=detectTargetFolder();
  Path parentPath=targetPath.getParent();
  Path scpRoot=Utils.resolve(targetPath,ScpHelper.SCP_COMMAND_PREFIX,getClass().getSimpleName(),getCurrentTestName());
  Utils.deleteRecursive(scpRoot);
  Path localDir=assertHierarchyTargetFolderExists(scpRoot.resolve("local"));
  Path localFile=localDir.resolve("file.txt");
  byte[] data=Utils.writeFile(localFile,getClass().getName() + "#" + getCurrentTestName()+ IoUtils.EOL);
  Path remoteDir=assertHierarchyTargetFolderExists(scpRoot.resolve("remote"));
  Path remoteFile=remoteDir.resolve(localFile.getFileName().toString());
  String localPath=localFile.toString();
  String remotePath=Utils.resolveRelativeRemotePath(parentPath,remoteFile);
  String[] remoteComps=GenericUtils.split(remotePath,'/');
  try (SshClient client=setupTestClient()){
    client.start();
    Factory<? extends Random> factory=client.getRandomFactory();
    Random rnd=factory.create();
    try (ClientSession session=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession()){
      session.addPasswordIdentity(getCurrentTestName());
      session.auth().verify(5L,TimeUnit.SECONDS);
      ScpClient scp=createScpClient(session);
      StringBuilder sb=new StringBuilder(remotePath.length() + Long.SIZE);
      for (int i=0; i < Math.max(Long.SIZE,remoteComps.length); i++) {
        if (sb.length() > 0) {
          sb.setLength(0);
        }
        sb.append(remoteComps[0]);
        for (int j=1; j < remoteComps.length; j++) {
          String name=remoteComps[j];
          slashify(sb,rnd);
          sb.append(name);
        }
        slashify(sb,rnd);
        String path=sb.toString();
        scp.upload(localPath,path);
        assertTrue("Remote file not ready for " + path,waitForFile(remoteFile,data.length,TimeUnit.SECONDS.toMillis(5L)));
        byte[] actual=Files.readAllBytes(remoteFile);
        assertArrayEquals("Mismatched uploaded data for " + path,data,actual);
        Files.delete(remoteFile);
        assertFalse("Remote file (" + remoteFile + ") not deleted for "+ path,Files.exists(remoteFile));
      }
    }
   }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.client.subsystem.sftp.SftpFileSystemTest </h4><pre class="type-11 type-8 type-2 type-3 type-15 type-12 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMultipleFileStoresOnSameProvider() throws IOException {
  try (SshClient client=setupTestClient()){
    client.start();
    SftpFileSystemProvider provider=new SftpFileSystemProvider(client);
    Collection<SftpFileSystem> fsList=new LinkedList<>();
    try {
      Collection<String> idSet=new HashSet<>();
      Map<String,Object> empty=Collections.<String,Object>emptyMap();
      for (int index=0; index < 4; index++) {
        String credentials=getCurrentTestName() + "-user-" + index;
        SftpFileSystem expected=provider.newFileSystem(createFileSystemURI(credentials,empty),empty);
        fsList.add(expected);
        String id=expected.getId();
        assertTrue("Non unique file system id: " + id,idSet.add(id));
        SftpFileSystem actual=provider.getFileSystem(id);
        assertSame("Mismatched cached instances for " + id,expected,actual);
        outputDebugMessage("Created file system id: %s",id);
      }
      for (      SftpFileSystem fs : fsList) {
        String id=fs.getId();
        fs.close();
        assertNull("File system not removed from cache: " + id,provider.getFileSystem(id));
      }
    }
  finally {
      IOException err=null;
      for (      FileSystem fs : fsList) {
        try {
          fs.close();
        }
 catch (        IOException e) {
          err=GenericUtils.accumulateException(err,e);
        }
      }
      client.stop();
      if (err != null) {
        throw err;
      }
    }
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.client.subsystem.sftp.SftpTest </h4><pre class="type-11 type-8 type-3 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNormalizeRemoteRootValues() throws Exception {
  try (SshClient client=setupTestClient()){
    client.start();
    try (ClientSession session=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession()){
      session.addPasswordIdentity(getCurrentTestName());
      session.auth().verify(5L,TimeUnit.SECONDS);
      try (SftpClient sftp=session.createSftpClient()){
        StringBuilder sb=new StringBuilder(Long.SIZE + 1);
        String expected=sftp.canonicalPath("/");
        for (int i=0; i < Long.SIZE; i++) {
          if (sb.length() > 0) {
            sb.setLength(0);
          }
          for (int j=1; j <= i; j++) {
            sb.append('/');
          }
          String remotePath=sb.toString();
          String actual=sftp.canonicalPath(remotePath);
          assertEquals("Mismatched roots for " + remotePath.length() + " slashes",expected,actual);
        }
      }
     }
  finally {
      client.stop();
    }
  }
 }

</code></pre>

<br>
<pre class="type-11 type-8 type-3 type-7 type-13 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testNormalizeRemotePathsValues() throws Exception {
  Path targetPath=detectTargetFolder();
  Path parentPath=targetPath.getParent();
  Path lclSftp=Utils.resolve(targetPath,SftpConstants.SFTP_SUBSYSTEM_NAME,getClass().getSimpleName(),getCurrentTestName());
  Path testFile=assertHierarchyTargetFolderExists(lclSftp).resolve("file.txt");
  String file=Utils.resolveRelativeRemotePath(parentPath,testFile);
  String[] comps=GenericUtils.split(file,'/');
  try (SshClient client=setupTestClient()){
    client.start();
    Factory<? extends Random> factory=client.getRandomFactory();
    Random rnd=factory.create();
    try (ClientSession session=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession()){
      session.addPasswordIdentity(getCurrentTestName());
      session.auth().verify(5L,TimeUnit.SECONDS);
      try (SftpClient sftp=session.createSftpClient()){
        StringBuilder sb=new StringBuilder(file.length() + comps.length);
        String expected=sftp.canonicalPath(file);
        for (int i=0; i < file.length(); i++) {
          if (sb.length() > 0) {
            sb.setLength(0);
          }
          sb.append(comps[0]);
          for (int j=1; j < comps.length; j++) {
            String name=comps[j];
            slashify(sb,rnd);
            sb.append(name);
          }
          slashify(sb,rnd);
          if (rnd.random(Byte.SIZE) < (Byte.SIZE / 2)) {
            sb.append('.');
          }
          String remotePath=sb.toString();
          String actual=sftp.canonicalPath(remotePath);
          assertEquals("Mismatched canonical value for " + remotePath,expected,actual);
        }
      }
     }
  finally {
      client.stop();
    }
  }
 }

</code></pre>

<br>
<pre class="type-11 type-8 type-10 type-6 type-3 type-7 type-13 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadBufferLimit() throws Exception {
  Path targetPath=detectTargetFolder();
  Path parentPath=targetPath.getParent();
  Path lclSftp=Utils.resolve(targetPath,SftpConstants.SFTP_SUBSYSTEM_NAME,getClass().getSimpleName(),getCurrentTestName());
  Path testFile=assertHierarchyTargetFolderExists(lclSftp).resolve("file.txt");
  byte[] expected=new byte[1024];
  Factory<? extends Random> factory=sshd.getRandomFactory();
  Random rnd=factory.create();
  rnd.fill(expected);
  Files.write(testFile,expected);
  try (SshClient client=setupTestClient()){
    client.start();
    try (ClientSession session=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession()){
      session.addPasswordIdentity(getCurrentTestName());
      session.auth().verify(5L,TimeUnit.SECONDS);
      try (SftpClient sftp=session.createSftpClient()){
        String file=Utils.resolveRelativeRemotePath(parentPath,testFile);
        byte[] actual=new byte[expected.length];
        int maxAllowed=actual.length / 4;
        PropertyResolverUtils.updateProperty(sshd,SftpSubsystem.MAX_PACKET_LENGTH_PROP,maxAllowed);
        try (CloseableHandle handle=sftp.open(file,OpenMode.Read)){
          int readLen=sftp.read(handle,0L,actual);
          assertEquals("Mismatched read len",maxAllowed,readLen);
          for (int index=0; index < readLen; index++) {
            byte expByte=expected[index], actByte=actual[index];
            if (expByte != actByte) {
              fail("Mismatched values at index=" + index + ": expected=0x"+ Integer.toHexString(expByte & 0xFF)+ ", actual=0x"+ Integer.toHexString(actByte & 0xFF));
            }
          }
        }
       }
     }
  finally {
      client.stop();
    }
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.client.subsystem.sftp.SftpVersionSelectorTest </h4><pre class="type-11 type-8 type-6 type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPreferredVersionSelector(){
  List<Integer> available=new ArrayList<>();
  for (int version=SftpSubsystem.LOWER_SFTP_IMPL; version <= SftpSubsystem.HIGHER_SFTP_IMPL; version++) {
    available.add(Integer.valueOf(version));
  }
  List<Integer> preferred=new ArrayList<>(available);
  List<Integer> unavailable=Arrays.asList(7365,3777347);
  Random rnd=new Random(System.nanoTime());
  for (int index=0; index < preferred.size(); index++) {
    Collections.shuffle(preferred,rnd);
    SftpVersionSelector selector=SftpVersionSelector.Utils.preferredVersionSelector(preferred);
    int expected=preferred.get(0);
    for (int current=SftpSubsystem.LOWER_SFTP_IMPL; current <= SftpSubsystem.HIGHER_SFTP_IMPL; current++) {
      assertEquals("Mismatched selected for current= " + current + ", available="+ available+ ", preferred="+ preferred,expected,selector.selectVersion(current,available));
      try {
        Collections.shuffle(unavailable,rnd);
        int version=unavailable.get(0);
        int actual=selector.selectVersion(version,unavailable);
        fail("Unexpected selected version (" + actual + ")"+ " for current= "+ version+ ", available="+ unavailable+ ", preferred="+ preferred);
      }
 catch (      IllegalStateException e) {
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCurrentVersionSelector(){
  List<Integer> available=new ArrayList<>();
  Random rnd=new Random(System.nanoTime());
  for (int expected=SftpSubsystem.LOWER_SFTP_IMPL; expected <= SftpSubsystem.HIGHER_SFTP_IMPL; expected++) {
    assertEquals("Mismatched directly selected for available=" + available,expected,SftpVersionSelector.CURRENT.selectVersion(expected,available));
    available.add(Integer.valueOf(expected));
  }
  for (int expected=SftpSubsystem.LOWER_SFTP_IMPL; expected <= SftpSubsystem.HIGHER_SFTP_IMPL; expected++) {
    for (int index=0; index < available.size(); index++) {
      Collections.shuffle(available,rnd);
      assertEquals("Mismatched suffling selected for current=" + expected + ", available="+ available,expected,SftpVersionSelector.CURRENT.selectVersion(expected,available));
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.client.subsystem.sftp.SftpVersionsTest </h4><pre class="type-11 type-8 type-10 type-2 type-3 type-12 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEndOfListIndicator() throws Exception {
  try (SshClient client=setupTestClient()){
    client.start();
    try (ClientSession session=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession()){
      session.addPasswordIdentity(getCurrentTestName());
      session.auth().verify(5L,TimeUnit.SECONDS);
      try (SftpClient sftp=session.createSftpClient(getTestedVersion())){
        AtomicReference<Boolean> eolIndicator=new AtomicReference<>();
        int version=sftp.getVersion();
        Path targetPath=detectTargetFolder();
        Path parentPath=targetPath.getParent();
        String remotePath=Utils.resolveRelativeRemotePath(parentPath,targetPath);
        try (CloseableHandle handle=sftp.openDir(remotePath)){
          List<DirEntry> entries=sftp.readDir(handle,eolIndicator);
          for (int index=1; entries != null; entries=sftp.readDir(handle,eolIndicator), index++) {
            Boolean value=eolIndicator.get();
            if (version < SftpConstants.SFTP_V6) {
              assertNull("Unexpected indicator value at iteration #" + index,value);
            }
 else {
              assertNotNull("No indicator returned at iteration #" + index,value);
              if (value.booleanValue()) {
                break;
              }
            }
            eolIndicator.set(null);
          }
          Boolean value=eolIndicator.get();
          if (version < SftpConstants.SFTP_V6) {
            assertNull("Unexpected end-of-list indication received at end of entries",value);
            assertNull("Unexpected no last entries indication",entries);
          }
 else {
            assertNotNull("No end-of-list indication received at end of entries",value);
            assertNotNull("No last received entries",entries);
            assertTrue("Bad end-of-list value",value.booleanValue());
          }
        }
       }
     }
  finally {
      client.stop();
    }
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.client.subsystem.sftp.extensions.BuiltinSftpClientExtensionsTest </h4><pre class="type-11 type-8 type-3 type-15 type-12 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFromName(){
  for (  String name : new String[]{null,"",getCurrentTestName()}) {
    assertNull("Unexpected result for name='" + name + "'",BuiltinSftpClientExtensions.fromName(name));
  }
  for (  BuiltinSftpClientExtensions expected : BuiltinSftpClientExtensions.VALUES) {
    String name=expected.getName();
    for (int index=0; index < name.length(); index++) {
      BuiltinSftpClientExtensions actual=BuiltinSftpClientExtensions.fromName(name);
      assertSame(name,expected,actual);
      name=shuffleCase(name);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.ForwardingFilterTest </h4><pre class="type-11 type-8 type-3 type-15 type-12 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFromStringForwardingFilterType(){
  for (  String name : new String[]{null,"",getCurrentTestName()}) {
    assertNull("Unexpected value for name='" + name + "'",ForwardingFilter.Type.fromString(name));
  }
  for (  ForwardingFilter.Type expected : ForwardingFilter.Type.VALUES) {
    for (    String name : new String[]{expected.name(),expected.getName()}) {
      for (int index=0; index < name.length(); index++) {
        ForwardingFilter.Type actual=ForwardingFilter.Type.fromString(name);
        assertSame("Mismatched instance for name=" + name,expected,actual);
        name=shuffleCase(name);
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.SshConstantsTest </h4><pre class="type-11 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testGetOpenErrorName(){
  for (int code=SshConstants.SSH_OPEN_ADMINISTRATIVELY_PROHIBITED; code <= SshConstants.SSH_OPEN_RESOURCE_SHORTAGE; code++) {
    String name=SshConstants.getOpenErrorCodeName(code);
    assertTrue("Mismatched name for code=" + code + ": "+ name,name.startsWith("SSH_OPEN_"));
  }
}

</code></pre>

<br>
<pre class="type-11 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testGetDisconnectReason(){
  for (int reason=SshConstants.SSH2_DISCONNECT_HOST_NOT_ALLOWED_TO_CONNECT; reason <= SshConstants.SSH2_DISCONNECT_ILLEGAL_USER_NAME; reason++) {
    String name=SshConstants.getDisconnectReasonName(reason);
    assertTrue("Mismatched name for reason=" + reason + ": "+ name,name.startsWith("SSH2_DISCONNECT_"));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.auth.AuthenticationTest </h4><pre class="type-11 type-10 type-2 type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRuntimeErrorsInAuthenticators() throws Exception {
  final Error thrown=new OutOfMemoryError(getCurrentTestName());
  final PasswordAuthenticator authPassword=sshd.getPasswordAuthenticator();
  final AtomicInteger passCounter=new AtomicInteger(0);
  sshd.setPasswordAuthenticator(new PasswordAuthenticator(){
    @Override public boolean authenticate(    String username,    String password,    ServerSession session) throws PasswordChangeRequiredException {
      int count=passCounter.incrementAndGet();
      if (count == 1) {
        throw thrown;
      }
      return authPassword.authenticate(username,password,session);
    }
  }
);
  final PublickeyAuthenticator authPubkey=sshd.getPublickeyAuthenticator();
  final AtomicInteger pubkeyCounter=new AtomicInteger(0);
  sshd.setPublickeyAuthenticator(new PublickeyAuthenticator(){
    @Override public boolean authenticate(    String username,    PublicKey key,    ServerSession session){
      int count=pubkeyCounter.incrementAndGet();
      if (count == 1) {
        throw thrown;
      }
      return authPubkey.authenticate(username,key,session);
    }
  }
);
  sshd.setKeyboardInteractiveAuthenticator(KeyboardInteractiveAuthenticator.NONE);
  try (SshClient client=setupTestClient()){
    KeyPair kp=Utils.generateKeyPair("RSA",1024);
    client.start();
    try {
      for (int index=1; index < 3; index++) {
        try (ClientSession s=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession()){
          s.addPasswordIdentity(getCurrentTestName());
          s.addPublicKeyIdentity(kp);
          AuthFuture auth=s.auth();
          assertTrue("Failed to complete authentication on time",auth.await(11L,TimeUnit.SECONDS));
          if (auth.isSuccess()) {
            assertTrue("Premature authentication success",index > 1);
            break;
          }
          assertEquals("Password authenticator not consulted",1,passCounter.get());
          assertEquals("Pubkey authenticator not consulted",1,pubkeyCounter.get());
        }
       }
    }
  finally {
      client.stop();
    }
  }
 }

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMismatchedUserAuthPkOkData() throws Exception {
  final AtomicInteger challengeCounter=new AtomicInteger(0);
  sshd.setUserAuthFactories(Collections.<NamedFactory<org.apache.sshd.server.auth.UserAuth>>singletonList(new org.apache.sshd.server.auth.pubkey.UserAuthPublicKeyFactory(){
    @Override public org.apache.sshd.server.auth.pubkey.UserAuthPublicKey create(){
      return new org.apache.sshd.server.auth.pubkey.UserAuthPublicKey(){
        @Override protected void sendPublicKeyResponse(        ServerSession session,        String username,        String alg,        PublicKey key,        byte[] keyBlob,        int offset,        int blobLen,        Buffer buffer) throws Exception {
          int count=challengeCounter.incrementAndGet();
          outputDebugMessage("sendPublicKeyChallenge(%s)[%s]: count=%d",session,alg,count);
          if (count == 1) {
            super.sendPublicKeyResponse(session,username,KeyPairProvider.SSH_DSS,key,keyBlob,offset,blobLen,buffer);
          }
 else           if (count == 2) {
            KeyPair otherPair=org.apache.sshd.util.test.Utils.generateKeyPair("RSA",1024);
            PublicKey otherKey=otherPair.getPublic();
            Buffer buf=session.prepareBuffer(SshConstants.SSH_MSG_USERAUTH_PK_OK,BufferUtils.clear(buffer));
            buf.putString(alg);
            buf.putPublicKey(otherKey);
            session.writePacket(buf);
          }
 else {
            super.sendPublicKeyResponse(session,username,alg,key,keyBlob,offset,blobLen,buffer);
          }
        }
      }
;
    }
  }
));
  try (SshClient client=setupTestClient()){
    KeyPair clientIdentity=Utils.generateKeyPair("RSA",1024);
    client.start();
    try {
      for (int index=1; index <= 4; index++) {
        try (ClientSession s=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession()){
          s.addPublicKeyIdentity(clientIdentity);
          s.auth().verify(17L,TimeUnit.SECONDS);
          assertEquals("Mismatched number of challenges",3,challengeCounter.get());
          break;
        }
 catch (        SshException e) {
          outputDebugMessage("%s on retry #%d: %s",e.getClass().getSimpleName(),index,e.getMessage());
          Throwable t=e.getCause();
          assertObjectInstanceOf("Unexpected failure cause at retry #" + index,InvalidKeySpecException.class,t);
        }
      }
    }
  finally {
      client.stop();
    }
  }
 }

</code></pre>

<br>
<pre class="type-11 type-8 type-3 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAuthMultiChallengeKeyInteractive() throws Exception {
  final Class<?> anchor=getClass();
  final InteractiveChallenge challenge=new InteractiveChallenge();
  challenge.setInteractionName(getCurrentTestName());
  challenge.setInteractionInstruction(anchor.getPackage().getName());
  challenge.setLanguageTag(Locale.getDefault().getLanguage());
  final Map<String,String> rspMap=new TreeMap<String,String>(String.CASE_INSENSITIVE_ORDER){
    private static final long serialVersionUID=1L;
{
      put("class",anchor.getSimpleName());
      put("package",anchor.getPackage().getName());
      put("test",getCurrentTestName());
    }
  }
;
  for (  String prompt : rspMap.keySet()) {
    challenge.addPrompt(prompt,(GenericUtils.size(challenge.getPrompts()) & 0x1) != 0);
  }
  PropertyResolverUtils.updateProperty(sshd,ServerFactoryManager.AUTH_METHODS,UserAuthKeyboardInteractiveFactory.NAME);
  final AtomicInteger genCount=new AtomicInteger(0);
  final AtomicInteger authCount=new AtomicInteger(0);
  sshd.setKeyboardInteractiveAuthenticator(new KeyboardInteractiveAuthenticator(){
    @Override public InteractiveChallenge generateChallenge(    ServerSession session,    String username,    String lang,    String subMethods){
      assertEquals("Unexpected challenge call",1,genCount.incrementAndGet());
      return challenge;
    }
    @Override public boolean authenticate(    ServerSession session,    String username,    List<String> responses) throws Exception {
      assertEquals("Unexpected authenticate call",1,authCount.incrementAndGet());
      assertEquals("Mismatched number of responses",GenericUtils.size(rspMap),GenericUtils.size(responses));
      int index=0;
      for (      Map.Entry<String,String> re : rspMap.entrySet()) {
        String prompt=re.getKey();
        String expected=re.getValue();
        String actual=responses.get(index);
        assertEquals("Mismatched response for prompt=" + prompt,expected,actual);
        index++;
      }
      return true;
    }
  }
);
  PropertyResolverUtils.updateProperty(sshd,ServerFactoryManager.AUTH_METHODS,UserAuthKeyboardInteractiveFactory.NAME);
  try (SshClient client=setupTestClient()){
    final AtomicInteger interactiveCount=new AtomicInteger(0);
    client.setUserInteraction(new UserInteraction(){
      @Override public boolean isInteractionAllowed(      ClientSession session){
        return true;
      }
      @Override public void welcome(      ClientSession session,      String banner,      String lang){
      }
      @Override public String[] interactive(      ClientSession session,      String name,      String instruction,      String lang,      String[] prompt,      boolean[] echo){
        assertEquals("Unexpected multiple calls",1,interactiveCount.incrementAndGet());
        assertEquals("Mismatched name",challenge.getInteractionName(),name);
        assertEquals("Mismatched instruction",challenge.getInteractionInstruction(),instruction);
        assertEquals("Mismatched language",challenge.getLanguageTag(),lang);
        List<PromptEntry> entries=challenge.getPrompts();
        assertEquals("Mismatched prompts count",GenericUtils.size(entries),GenericUtils.length(prompt));
        String[] responses=new String[prompt.length];
        for (int index=0; index < prompt.length; index++) {
          PromptEntry e=entries.get(index);
          String key=e.getPrompt();
          assertEquals("Mismatched prompt at index=" + index,key,prompt[index]);
          assertEquals("Mismatched echo at index=" + index,e.isEcho(),echo[index]);
          responses[index]=ValidateUtils.checkNotNull(rspMap.get(key),"No value for prompt=%s",key);
        }
        return responses;
      }
      @Override public String getUpdatedPassword(      ClientSession session,      String prompt,      String lang){
        throw new UnsupportedOperationException("Unexpected call");
      }
    }
);
    PropertyResolverUtils.updateProperty(client,ServerFactoryManager.AUTH_METHODS,UserAuthKeyboardInteractiveFactory.NAME);
    client.start();
    try (ClientSession s=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession()){
      s.auth().verify(11L,TimeUnit.SECONDS);
      assertEquals("Bad generated challenge count",1,genCount.get());
      assertEquals("Bad authentication count",1,authCount.get());
      assertEquals("Bad interactive count",1,interactiveCount.get());
    }
  finally {
      client.stop();
    }
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.channel.WindowTest </h4><pre class="type-11 type-8 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testWindowConsumptionWithDirectStreams() throws Exception {
  sshd.setShellFactory(new AsyncEchoShellFactory());
  PropertyResolverUtils.updateProperty(sshd,FactoryManager.WINDOW_SIZE,1024);
  PropertyResolverUtils.updateProperty(client,FactoryManager.WINDOW_SIZE,1024);
  client.start();
  try (ClientSession session=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession()){
    session.addPasswordIdentity(getCurrentTestName());
    session.auth().verify(5L,TimeUnit.SECONDS);
    try (ChannelShell channel=session.createShellChannel();PipedInputStream inPis=new PipedInputStream();PipedOutputStream inPos=new PipedOutputStream(inPis);PipedInputStream outPis=new PipedInputStream();PipedOutputStream outPos=new PipedOutputStream(outPis)){
      channel.setIn(inPis);
      channel.setOut(outPos);
      channel.open().verify(7L,TimeUnit.SECONDS);
      try (Channel serverChannel=sshd.getActiveSessions().iterator().next().getService(ServerConnectionService.class).getChannels().iterator().next()){
        Window clientLocal=channel.getLocalWindow();
        Window clientRemote=channel.getRemoteWindow();
        Window serverLocal=serverChannel.getLocalWindow();
        Window serverRemote=serverChannel.getRemoteWindow();
        final String message="0123456789";
        final int nbMessages=500;
        try (BufferedWriter writer=new BufferedWriter(new OutputStreamWriter(inPos));BufferedReader reader=new BufferedReader(new InputStreamReader(outPis))){
          for (int i=0; i < nbMessages; i++) {
            writer.write(message);
            writer.write('\n');
            writer.flush();
            waitForWindowEquals(clientLocal,serverRemote,"client local","server remote",TimeUnit.SECONDS.toMillis(3L));
            String line=reader.readLine();
            assertEquals("Mismatched message at line #" + i,message,line);
            waitForWindowEquals(clientLocal,serverRemote,"client local","server remote",TimeUnit.SECONDS.toMillis(3L));
            waitForWindowEquals(clientRemote,serverLocal,"client remote","server local",TimeUnit.SECONDS.toMillis(3L));
          }
        }
       }
     }
   }
  finally {
    client.stop();
  }
}

</code></pre>

<br>
<pre class="type-11 type-3 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testWindowConsumptionWithAsyncStreams() throws Exception {
  sshd.setShellFactory(new AsyncEchoShellFactory());
  PropertyResolverUtils.updateProperty(sshd,FactoryManager.WINDOW_SIZE,1024);
  PropertyResolverUtils.updateProperty(client,FactoryManager.WINDOW_SIZE,1024);
  client.start();
  try (ClientSession session=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession()){
    session.addPasswordIdentity(getCurrentTestName());
    session.auth().verify(5L,TimeUnit.SECONDS);
    try (ChannelShell channel=session.createShellChannel()){
      channel.setStreaming(ClientChannel.Streaming.Async);
      channel.open().verify(5L,TimeUnit.SECONDS);
      try (Channel serverChannel=sshd.getActiveSessions().iterator().next().getService(ServerConnectionService.class).getChannels().iterator().next()){
        Window clientLocal=channel.getLocalWindow();
        Window clientRemote=channel.getRemoteWindow();
        Window serverLocal=serverChannel.getLocalWindow();
        Window serverRemote=serverChannel.getRemoteWindow();
        final String message="0123456789\n";
        final byte[] bytes=message.getBytes(StandardCharsets.UTF_8);
        final int nbMessages=500;
        IoOutputStream output=channel.getAsyncIn();
        IoInputStream input=channel.getAsyncOut();
        for (int i=0; i < nbMessages; i++) {
          Buffer buffer=new ByteArrayBuffer(bytes);
          output.write(buffer).verify(5L,TimeUnit.SECONDS);
          waitForWindowNotEquals(clientLocal,serverRemote,"client local","server remote",TimeUnit.SECONDS.toMillis(3L));
          Buffer buf=new ByteArrayBuffer(16);
          IoReadFuture future=input.read(buf);
          future.verify(5L,TimeUnit.SECONDS);
          assertEquals("Mismatched available data at line #" + i,message.length(),buf.available());
          assertEquals("Mismatched data at line #" + i,message,new String(buf.array(),buf.rpos(),buf.available()));
          waitForWindowEquals(clientLocal,serverRemote,"client local","server remote",TimeUnit.SECONDS.toMillis(3L));
          waitForWindowEquals(clientRemote,serverLocal,"client remote","server local",TimeUnit.SECONDS.toMillis(3L));
        }
      }
     }
   }
  finally {
    client.stop();
  }
}

</code></pre>

<br>
<pre class="type-11 type-8 type-3 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testWindowConsumptionWithInvertedStreams() throws Exception {
  sshd.setShellFactory(new AsyncEchoShellFactory());
  PropertyResolverUtils.updateProperty(sshd,FactoryManager.WINDOW_SIZE,1024);
  PropertyResolverUtils.updateProperty(client,FactoryManager.WINDOW_SIZE,1024);
  client.start();
  try (ClientSession session=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession()){
    session.addPasswordIdentity(getCurrentTestName());
    session.auth().verify(5L,TimeUnit.SECONDS);
    try (ChannelShell channel=session.createShellChannel()){
      channel.open().verify(5L,TimeUnit.SECONDS);
      try (Channel serverChannel=sshd.getActiveSessions().iterator().next().getService(ServerConnectionService.class).getChannels().iterator().next()){
        Window clientLocal=channel.getLocalWindow();
        Window clientRemote=channel.getRemoteWindow();
        Window serverLocal=serverChannel.getLocalWindow();
        Window serverRemote=serverChannel.getRemoteWindow();
        final String message="0123456789";
        final int nbMessages=500;
        try (BufferedWriter writer=new BufferedWriter(new OutputStreamWriter(channel.getInvertedIn()));BufferedReader reader=new BufferedReader(new InputStreamReader(channel.getInvertedOut()))){
          for (int i=0; i < nbMessages; i++) {
            writer.write(message);
            writer.write("\n");
            writer.flush();
            waitForWindowNotEquals(clientLocal,serverRemote,"client local","server remote",TimeUnit.SECONDS.toMillis(3L));
            String line=reader.readLine();
            assertEquals("Mismatched message at line #" + i,message,line);
            waitForWindowEquals(clientLocal,serverRemote,"client local","server remote",TimeUnit.SECONDS.toMillis(3L));
            waitForWindowEquals(clientRemote,serverLocal,"client remote","server local",TimeUnit.SECONDS.toMillis(3L));
          }
        }
       }
     }
   }
  finally {
    client.stop();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.cipher.BuiltinCiphersTest </h4><pre class="type-11 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testNotAllowedToOverrideRegisteredFactories(){
  CipherFactory expected=Mockito.mock(CipherFactory.class);
  Mockito.when(expected.getName()).thenReturn(getCurrentTestName());
  String name=expected.getName();
  try {
    for (int index=1; index <= Byte.SIZE; index++) {
      BuiltinCiphers.registerExtension(expected);
      assertEquals("Unexpected success at attempt #" + index,1,index);
    }
  }
  finally {
    BuiltinCiphers.unregisterExtension(name);
  }
}

</code></pre>

<br>
<pre class="type-11 type-8 type-3 type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
"></span><br>
@Test public void testFromEnumName(){
  for (  BuiltinCiphers expected : BuiltinCiphers.VALUES) {
    String name=expected.name();
    for (int index=0; index < name.length(); index++) {
      BuiltinCiphers actual=BuiltinCiphers.fromString(name);
      assertSame(name + " - mismatched enum values",expected,actual);
      name=shuffleCase(name);
    }
  }
}

</code></pre>

<br>
<pre class="type-11 type-8 type-3 type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
"></span><br>
@Test public void testFromFactoryName(){
  for (  BuiltinCiphers expected : BuiltinCiphers.VALUES) {
    String name=expected.getName();
    for (int index=0; index < name.length(); index++) {
      BuiltinCiphers actual=BuiltinCiphers.fromFactoryName(name);
      assertSame(name + " - mismatched enum values",expected,actual);
      name=shuffleCase(name);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.cipher.ECCurvesTest </h4><pre class="type-11 type-8 type-3 type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
"></span><br>
@Test public void testFromName(){
  for (  ECCurves expected : ECCurves.VALUES) {
    String name=expected.getName();
    for (int index=0; index < name.length(); index++) {
      ECCurves actual=ECCurves.fromCurveName(name);
      assertSame(name,expected,actual);
      name=shuffleCase(name);
    }
  }
}

</code></pre>

<br>
<pre class="type-11 type-8 type-3 type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
"></span><br>
@Test public void testFromKeyType(){
  for (  ECCurves expected : ECCurves.VALUES) {
    String keyType=expected.getKeyType();
    for (int index=0; index < keyType.length(); index++) {
      ECCurves actual=ECCurves.fromKeyType(keyType);
      assertSame(keyType,expected,actual);
      keyType=shuffleCase(keyType);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.compression.BuiltinCompressionsTest </h4><pre class="type-11 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testNotAllowedToOverrideRegisteredFactories(){
  CompressionFactory expected=Mockito.mock(CompressionFactory.class);
  Mockito.when(expected.getName()).thenReturn(getCurrentTestName());
  String name=expected.getName();
  try {
    for (int index=1; index <= Byte.SIZE; index++) {
      BuiltinCompressions.registerExtension(expected);
      assertEquals("Unexpected success at attempt #" + index,1,index);
    }
  }
  finally {
    BuiltinCompressions.unregisterExtension(name);
  }
}

</code></pre>

<br>
<pre class="type-11 type-8 type-3 type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
"></span><br>
@Test public void testFromFactoryName(){
  for (  BuiltinCompressions expected : BuiltinCompressions.VALUES) {
    String name=expected.getName();
    for (int index=0; index < name.length(); index++) {
      BuiltinCompressions actual=BuiltinCompressions.fromFactoryName(name);
      assertSame(name,expected,actual);
      name=shuffleCase(name);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.compression.CompressionTest </h4><pre class="type-11 type-8 type-3 type-14 type-7 type-13 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompression() throws Exception {
  Assume.assumeTrue("Skip unsupported compression " + factory,factory.isSupported());
  JSch sch=new JSch();
  com.jcraft.jsch.Session s=sch.getSession(getCurrentTestName(),TEST_LOCALHOST,sshd.getPort());
  s.setUserInfo(new SimpleUserInfo(getCurrentTestName()));
  s.connect();
  try {
    com.jcraft.jsch.Channel c=s.openChannel(Channel.CHANNEL_SHELL);
    c.connect();
    try (OutputStream os=c.getOutputStream();InputStream is=c.getInputStream()){
      String STR="this is my command\n";
      byte[] bytes=STR.getBytes(StandardCharsets.UTF_8);
      byte[] data=new byte[bytes.length + Long.SIZE];
      for (int i=1; i <= 10; i++) {
        os.write(bytes);
        os.flush();
        int len=is.read(data);
        String str=new String(data,0,len,StandardCharsets.UTF_8);
        assertEquals("Mismatched read data at iteration #" + i,STR,str);
      }
    }
  finally {
      c.disconnect();
    }
  }
  finally {
    s.disconnect();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.config.TimeValueConfigTest </h4><pre class="type-11 type-8 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDurationOf(){
  Object[] values={"600",Long.valueOf(TimeUnit.SECONDS.toMillis(600L)),"10m",Long.valueOf(TimeUnit.MINUTES.toMillis(10L)),"1h30m",Long.valueOf(TimeUnit.MINUTES.toMillis(90L)),"2d",Long.valueOf(TimeUnit.DAYS.toMillis(2L)),"3w",Long.valueOf(TimeUnit.DAYS.toMillis(3L * 7L))};
  for (int index=0; index < values.length; index+=2) {
    String s=(String)values[index];
    Number expected=(Number)values[index + 1];
    long actual=TimeValueConfig.durationOf(s);
    assertEquals(s,expected.longValue(),actual);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.config.keys.BuiltinIdentitiesTest </h4><pre class="type-11 type-3 type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
"></span><br>
@Test public void testFromAlgorithm(){
  for (  BuiltinIdentities expected : BuiltinIdentities.VALUES) {
    String algorithm=expected.getAlgorithm();
    for (int index=0; index < algorithm.length(); index++) {
      assertSame(algorithm,expected,BuiltinIdentities.fromAlgorithm(algorithm));
      algorithm=shuffleCase(algorithm);
    }
  }
}

</code></pre>

<br>
<pre class="type-11 type-3 type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
"></span><br>
@Test public void testFromName(){
  for (  BuiltinIdentities expected : BuiltinIdentities.VALUES) {
    String name=expected.getName();
    for (int index=0; index < name.length(); index++) {
      assertSame(name,expected,BuiltinIdentities.fromName(name));
      name=shuffleCase(name);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.forward.PortForwardingLoadTest </h4><pre class="type-11 type-8 type-7 type-13 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testLocalForwardingPayload() throws Exception {
  final int NUM_ITERATIONS=100;
  final String PAYLOAD_TMP="This is significantly longer Test Data. This is significantly " + "longer Test Data. This is significantly longer Test Data. This is significantly " + "longer Test Data. This is significantly longer Test Data. This is significantly "+ "longer Test Data. This is significantly longer Test Data. This is significantly "+ "longer Test Data. This is significantly longer Test Data. This is significantly "+ "longer Test Data. ";
  StringBuilder sb=new StringBuilder(PAYLOAD_TMP.length() * 1000);
  for (int i=0; i < 1000; i++) {
    sb.append(PAYLOAD_TMP);
  }
  final String PAYLOAD=sb.toString();
  Session session=createSession();
  try (final ServerSocket ss=new ServerSocket()){
    ss.setReuseAddress(true);
    ss.bind(new InetSocketAddress((InetAddress)null,0));
    int forwardedPort=ss.getLocalPort();
    int sinkPort=session.setPortForwardingL(0,TEST_LOCALHOST,forwardedPort);
    final AtomicInteger conCount=new AtomicInteger(0);
    Thread tAcceptor=new Thread(getCurrentTestName() + "Acceptor"){
      @SuppressWarnings("synthetic-access") @Override public void run(){
        try {
          byte[] buf=new byte[8192];
          log.info("Started...");
          for (int i=0; i < NUM_ITERATIONS; ++i) {
            try (Socket s=ss.accept()){
              conCount.incrementAndGet();
              try (InputStream sockIn=s.getInputStream();ByteArrayOutputStream baos=new ByteArrayOutputStream()){
                int l;
                while ((baos.size() < PAYLOAD.length()) && ((l=sockIn.read(buf)) > 0)) {
                  baos.write(buf,0,l);
                }
                assertEquals("Mismatched received data at iteration #" + i,PAYLOAD,baos.toString());
                try (InputStream inputCopy=new ByteArrayInputStream(baos.toByteArray());OutputStream sockOut=s.getOutputStream()){
                  while ((l=sockIn.read(buf)) > 0) {
                    sockOut.write(buf,0,l);
                  }
                }
               }
             }
           }
          log.info("Done");
        }
 catch (        Exception e) {
          log.error("Failed to complete run loop",e);
        }
      }
    }
;
    tAcceptor.start();
    Thread.sleep(50);
    byte[] buf=new byte[8192];
    byte[] bytes=PAYLOAD.getBytes(StandardCharsets.UTF_8);
    for (int i=0; i < NUM_ITERATIONS; i++) {
      log.info("Iteration {}",Integer.valueOf(i));
      try (Socket s=new Socket(TEST_LOCALHOST,sinkPort);OutputStream sockOut=s.getOutputStream()){
        s.setSoTimeout((int)TimeUnit.SECONDS.toMillis(10L));
        sockOut.write(bytes);
        sockOut.flush();
        try (InputStream sockIn=s.getInputStream();ByteArrayOutputStream baos=new ByteArrayOutputStream(bytes.length)){
          int l;
          while ((baos.size() < PAYLOAD.length()) && ((l=sockIn.read(buf)) > 0)) {
            baos.write(buf,0,l);
          }
          assertEquals("Mismatched payload at iteration #" + i,PAYLOAD,baos.toString());
        }
       }
 catch (      Exception e) {
        log.error("Error in iteration #" + i,e);
      }
    }
    session.delPortForwardingL(sinkPort);
    ss.close();
    tAcceptor.join(TimeUnit.SECONDS.toMillis(5L));
  }
  finally {
    session.disconnect();
  }
}

</code></pre>

<br>
<pre class="type-11 type-2 type-12 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRemoteForwardingPayload() throws Exception {
  final int NUM_ITERATIONS=100;
  final String PAYLOAD="This is significantly longer Test Data. This is significantly " + "longer Test Data. This is significantly longer Test Data. This is significantly " + "longer Test Data. This is significantly longer Test Data. This is significantly "+ "longer Test Data. This is significantly longer Test Data. This is significantly "+ "longer Test Data. This is significantly longer Test Data. This is significantly "+ "longer Test Data. ";
  Session session=createSession();
  try (final ServerSocket ss=new ServerSocket()){
    ss.setReuseAddress(true);
    ss.bind(new InetSocketAddress((InetAddress)null,0));
    int forwardedPort=ss.getLocalPort();
    int sinkPort=Utils.getFreePort();
    session.setPortForwardingR(sinkPort,TEST_LOCALHOST,forwardedPort);
    final boolean started[]=new boolean[1];
    started[0]=false;
    final AtomicInteger conCount=new AtomicInteger(0);
    Thread tWriter=new Thread(getCurrentTestName() + "Writer"){
      @SuppressWarnings("synthetic-access") @Override public void run(){
        started[0]=true;
        try {
          byte[] bytes=PAYLOAD.getBytes(StandardCharsets.UTF_8);
          for (int i=0; i < NUM_ITERATIONS; ++i) {
            try (Socket s=ss.accept()){
              conCount.incrementAndGet();
              try (OutputStream sockOut=s.getOutputStream()){
                sockOut.write(bytes);
                sockOut.flush();
              }
             }
           }
        }
 catch (        Exception e) {
          log.error("Failed to complete run loop",e);
        }
      }
    }
;
    tWriter.start();
    Thread.sleep(50);
    assertTrue("Server not started",started[0]);
    final RuntimeException lenOK[]=new RuntimeException[NUM_ITERATIONS];
    final RuntimeException dataOK[]=new RuntimeException[NUM_ITERATIONS];
    byte b2[]=new byte[PAYLOAD.length()];
    byte b1[]=new byte[b2.length / 2];
    for (int i=0; i < NUM_ITERATIONS; i++) {
      final int ii=i;
      try (Socket s=new Socket(TEST_LOCALHOST,sinkPort);InputStream sockIn=s.getInputStream()){
        s.setSoTimeout((int)TimeUnit.SECONDS.toMillis(10L));
        int read1=sockIn.read(b1);
        String part1=new String(b1,0,read1,StandardCharsets.UTF_8);
        Thread.sleep(50);
        int read2=sockIn.read(b2);
        String part2=new String(b2,0,read2,StandardCharsets.UTF_8);
        int totalRead=read1 + read2;
        lenOK[ii]=(PAYLOAD.length() == totalRead) ? null : new IndexOutOfBoundsException("Mismatched length: expected=" + PAYLOAD.length() + ", actual="+ totalRead);
        String readData=part1 + part2;
        dataOK[ii]=PAYLOAD.equals(readData) ? null : new IllegalStateException("Mismatched content");
        if (lenOK[ii] != null) {
          throw lenOK[ii];
        }
        if (dataOK[ii] != null) {
          throw dataOK[ii];
        }
      }
 catch (      Exception e) {
        if (e instanceof IOException) {
          log.warn("I/O exception in iteration #" + i,e);
        }
 else {
          log.error("Failed to complete iteration #" + i,e);
        }
      }
    }
    int ok=0;
    for (int i=0; i < NUM_ITERATIONS; i++) {
      ok+=(lenOK[i] == null) ? 1 : 0;
    }
    log.info("Successful iteration: " + ok + " out of "+ NUM_ITERATIONS);
    Thread.sleep(55L);
    for (int i=0; i < NUM_ITERATIONS; i++) {
      assertNull("Bad length at iteration " + i,lenOK[i]);
      assertNull("Bad data at iteration " + i,dataOK[i]);
    }
    session.delPortForwardingR(forwardedPort);
    ss.close();
    tWriter.join(TimeUnit.SECONDS.toMillis(5L));
  }
  finally {
    session.disconnect();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.forward.PortForwardingTest </h4><pre class="type-11 type-8 type-3 type-7 type-13 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testLocalForwardingNativeBigPayload() throws Exception {
  try (ClientSession session=createNativeSession()){
    String expected=getCurrentTestName();
    byte[] bytes=expected.getBytes(StandardCharsets.UTF_8);
    byte[] buf=new byte[bytes.length + Long.SIZE];
    SshdSocketAddress local=new SshdSocketAddress("",0);
    SshdSocketAddress remote=new SshdSocketAddress(TEST_LOCALHOST,echoPort);
    SshdSocketAddress bound=session.startLocalPortForwarding(local,remote);
    try (Socket s=new Socket(bound.getHostName(),bound.getPort());OutputStream output=s.getOutputStream();InputStream input=s.getInputStream()){
      s.setSoTimeout((int)TimeUnit.SECONDS.toMillis(10L));
      for (int i=0; i < 1000; i++) {
        output.write(bytes);
        output.flush();
        int n=input.read(buf);
        String res=new String(buf,0,n);
        assertEquals("Mismatched data at iteration #" + i,expected,res);
      }
    }
  finally {
      session.stopLocalPortForwarding(bound);
    }
  }
 }

</code></pre>

<br>
<pre class="type-11 type-8 type-3 type-7 type-13 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testRemoteForwardingNativeBigPayload() throws Exception {
  try (ClientSession session=createNativeSession()){
    SshdSocketAddress remote=new SshdSocketAddress("",0);
    SshdSocketAddress local=new SshdSocketAddress(TEST_LOCALHOST,echoPort);
    SshdSocketAddress bound=session.startRemotePortForwarding(remote,local);
    try (Socket s=new Socket(bound.getHostName(),bound.getPort());OutputStream output=s.getOutputStream();InputStream input=s.getInputStream()){
      s.setSoTimeout((int)TimeUnit.SECONDS.toMillis(10L));
      String expected=getCurrentTestName();
      byte[] bytes=expected.getBytes(StandardCharsets.UTF_8);
      byte[] buf=new byte[bytes.length + Long.SIZE];
      for (int i=0; i < 1000; i++) {
        output.write(bytes);
        output.flush();
        int n=input.read(buf);
        String res=new String(buf,0,n);
        assertEquals("Mismatched data at iteration #" + i,expected,res);
      }
    }
  finally {
      session.stopRemotePortForwarding(remote);
    }
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.kex.AbstractDHTest </h4><pre class="type-11 type-8 type-10 type-6 type-15 type-7 type-13 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStripLeadingZeroes(){
  byte[] data={3,7,7,3,4,7};
  for (int index=1; index <= data.length; index++) {
    assertSame("Unexpected sub-array generation for " + Arrays.toString(data),data,AbstractDH.stripLeadingZeroes(data));
    if (index < data.length) {
      data[index]=0;
    }
  }
  Arrays.fill(data,(byte)0);
  try {
    byte[] stripped=AbstractDH.stripLeadingZeroes(data);
    fail("Unexpected success for all zeroes data: " + Arrays.toString(stripped));
  }
 catch (  IllegalArgumentException expected) {
  }
  for (int index=data.length - 1; index > 0; index--) {
    data[index]=(byte)index;
    byte[] stripped=AbstractDH.stripLeadingZeroes(data);
    String ds=Arrays.toString(data), ss=Arrays.toString(stripped);
    assertEquals("Mismatched stripped (" + ss + ") length for "+ ds,data.length - index,stripped.length);
    for (int i=index, j=0; j < stripped.length; i++, j++) {
      if (data[i] != stripped[j]) {
        fail("Mismatched values at stripped index = " + j + ": data="+ ds+ ", stripped="+ ss);
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.kex.BuiltinDHFactoriesTest </h4><pre class="type-11 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testNotAllowedToOverrideRegisteredFactories(){
  DHFactory expected=Mockito.mock(DHFactory.class);
  Mockito.when(expected.getName()).thenReturn(getCurrentTestName());
  String name=expected.getName();
  try {
    for (int index=1; index <= Byte.SIZE; index++) {
      BuiltinDHFactories.registerExtension(expected);
      assertEquals("Unexpected success at attempt #" + index,1,index);
    }
  }
  finally {
    BuiltinDHFactories.unregisterExtension(name);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.kex.KexProposalOptionTest </h4><pre class="type-11 type-8 type-3 type-15 type-12 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFromName(){
  for (  String n : new String[]{null,"",getCurrentTestName()}) {
    KexProposalOption o=KexProposalOption.fromName(n);
    assertNull("Unexpected value for name='" + n + "'",o);
  }
  for (  KexProposalOption expected : KexProposalOption.VALUES) {
    String n=expected.name();
    for (int index=0; index < n.length(); index++) {
      KexProposalOption actual=KexProposalOption.fromName(n);
      assertSame("Mismatched option for name=" + n,expected,actual);
      n=shuffleCase(n);
    }
  }
}

</code></pre>

<br>
<pre class="type-11 type-8 type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testByProposalIndexSortOrder(){
  for (int index=0; index < KexProposalOption.VALUES.size(); index++) {
    if (index < 1) {
      continue;
    }
    KexProposalOption o1=KexProposalOption.VALUES.get(index - 1);
    KexProposalOption o2=KexProposalOption.VALUES.get(index);
    int i1=o1.getProposalIndex(), i2=o2.getProposalIndex();
    assertTrue("Non increasing index for " + o1 + "["+ i1+ "] vs. "+ o2+ "["+ i2+ "]",i1 < i2);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.mac.BuiltinMacsTest </h4><pre class="type-11 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testNotAllowedToOverrideRegisteredFactories(){
  MacFactory expected=Mockito.mock(MacFactory.class);
  Mockito.when(expected.getName()).thenReturn(getCurrentTestName());
  String name=expected.getName();
  try {
    for (int index=1; index <= Byte.SIZE; index++) {
      BuiltinMacs.registerExtension(expected);
      assertEquals("Unexpected success at attempt #" + index,1,index);
    }
  }
  finally {
    BuiltinMacs.unregisterExtension(name);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.session.AbstractSessionTest </h4><pre class="type-11 type-8 type-10 type-2 type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMsgIgnorePadding() throws Exception {
  final long frequency=Byte.SIZE;
  PropertyResolverUtils.updateProperty(session,FactoryManager.IGNORE_MESSAGE_SIZE,Short.SIZE);
  PropertyResolverUtils.updateProperty(session,FactoryManager.IGNORE_MESSAGE_FREQUENCY,frequency);
  PropertyResolverUtils.updateProperty(session,FactoryManager.IGNORE_MESSAGE_VARIANCE,0);
  session.refreshConfiguration();
  Buffer msg=session.createBuffer(SshConstants.SSH_MSG_DEBUG,Long.SIZE);
  msg.putBoolean(true);
  msg.putString(getCurrentTestName());
  msg.putString("");
  MyIoSession ioSession=(MyIoSession)session.getIoSession();
  Queue<Buffer> queue=ioSession.getOutgoingMessages();
  int numIgnores=0;
  for (int cycle=0; cycle < Byte.SIZE; cycle++) {
    for (long index=0; index <= frequency; index++) {
      session.writePacket(msg);
      Buffer data=queue.remove();
      if (data != msg) {
        int cmd=data.getUByte();
        assertEquals("Mismatched buffer command at cycle " + cycle + "["+ index+ "]",SshConstants.SSH_MSG_IGNORE,cmd);
        int len=data.getInt();
        assertTrue("Mismatched random padding data length at cycle " + cycle + "["+ index+ "]: "+ len,len >= Short.SIZE);
        numIgnores++;
      }
    }
  }
  assertEquals("Mismatched number of ignore messages",Byte.SIZE,numIgnores);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.signature.BuiltinSignaturesTest </h4><pre class="type-11 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testNotAllowedToOverrideRegisteredFactories(){
  SignatureFactory expected=Mockito.mock(SignatureFactory.class);
  Mockito.when(expected.getName()).thenReturn(getCurrentTestName());
  String name=expected.getName();
  try {
    for (int index=1; index <= Byte.SIZE; index++) {
      BuiltinSignatures.registerExtension(expected);
      assertEquals("Unexpected success at attempt #" + index,1,index);
    }
  }
  finally {
    BuiltinSignatures.unregisterExtension(name);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.subsystem.sftp.SftpConstantsTest </h4><pre class="type-11 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testSubstatusNameResolution(){
  for (int status=SftpConstants.SSH_FX_OK; status <= SftpConstants.SSH_FX_NO_MATCHING_BYTE_RANGE_LOCK; status++) {
    String name=SftpConstants.getStatusName(status);
    assertTrue("Failed to convert status=" + status + ": "+ name,name.startsWith("SSH_FX_"));
  }
}

</code></pre>

<br>
<pre class="type-11 type-8 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testRealPathModesNotMarkedAsOpcodes(){
  for (int cmd=SftpConstants.SSH_FXP_REALPATH_NO_CHECK; cmd <= SftpConstants.SSH_FXP_REALPATH_STAT_IF; cmd++) {
    String name=SftpConstants.getCommandMessageName(cmd);
    assertFalse("Mismatched name for " + cmd + ": "+ name,name.startsWith("SSH_FXP_REALPATH_"));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.subsystem.sftp.SftpUniversalOwnerAndGroupTest </h4><pre class="type-11 type-3 type-15 type-12 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFromName(){
  for (  String name : new String[]{null,"",getCurrentTestName()}) {
    assertNull("Unexpected value for '" + name + "'",SftpUniversalOwnerAndGroup.fromName(name));
  }
  for (  SftpUniversalOwnerAndGroup expected : SftpUniversalOwnerAndGroup.VALUES) {
    String name=expected.getName();
    for (int index=0; index < name.length(); index++) {
      assertSame(name,expected,SftpUniversalOwnerAndGroup.fromName(name));
      name=shuffleCase(name);
    }
  }
}

</code></pre>

<br>
<pre class="type-11 type-10 type-6 type-2 type-3 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNameFormat(){
  for (  SftpUniversalOwnerAndGroup value : SftpUniversalOwnerAndGroup.VALUES) {
    String name=value.getName();
    assertFalse(value.name() + ": empty name",GenericUtils.isEmpty(name));
    assertTrue(value.name() + ": bad suffix",name.charAt(name.length() - 1) == '@');
    for (int index=0; index < name.length() - 1; index++) {
      char ch=name.charAt(index);
      if ((ch < 'A') || (ch > 'Z')) {
        fail("Non-uppercase character in " + name);
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.util.EventListenerUtilsTest </h4><pre class="type-11 type-8 type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether two objects/variables are the same
"></span><br>
@Test @SuppressWarnings("synthetic-access") public void testProxyWrapper(){
  List<ProxyListenerImpl> impls=new ArrayList<ProxyListenerImpl>();
  for (int index=0; index < Byte.SIZE; index++) {
    impls.add(new ProxyListenerImpl());
  }
  ProxyListener listener=EventListenerUtils.proxyWrapper(ProxyListener.class,impls);
  String expStr=getCurrentTestName();
  Number expNum=Long.valueOf(System.currentTimeMillis());
  listener.callMeWithString(expStr);
  listener.callMeWithNumber(expNum);
  for (int index=0; index < impls.size(); index++) {
    ProxyListenerImpl l=impls.get(index);
    assertSame("Mismatched string at listener #" + index,expStr,l.getStringValue());
    assertSame("Mismatched number at listener #" + index,expNum,l.getNumberValue());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.util.GenericUtilsTest </h4><pre class="type-11 type-8 type-15 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStripQuotes(){
  String expected=getCurrentTestName();
  assertSame("Unexpected un-quoted stripping",expected,GenericUtils.stripQuotes(expected));
  StringBuilder sb=new StringBuilder(2 + expected.length()).append('|').append(expected).append('|');
  for (int index=0; index < GenericUtils.QUOTES.length(); index++) {
    char delim=GenericUtils.QUOTES.charAt(index);
    sb.setCharAt(0,delim);
    sb.setCharAt(sb.length() - 1,delim);
    CharSequence actual=GenericUtils.stripQuotes(sb);
    assertEquals("Mismatched result for delim (" + delim + ")",expected,actual.toString());
  }
}

</code></pre>

<br>
<pre class="type-11 type-8 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testStripOnlyFirstLayerQuotes(){
  StringBuilder sb=new StringBuilder().append("||").append(getCurrentTestName()).append("||");
  char[] delims={'\'','"','"','\''};
  for (int index=0; index < delims.length; index+=2) {
    char topDelim=delims[index], innerDelim=delims[index + 1];
    sb.setCharAt(0,topDelim);
    sb.setCharAt(1,innerDelim);
    sb.setCharAt(sb.length() - 2,innerDelim);
    sb.setCharAt(sb.length() - 1,topDelim);
    CharSequence expected=sb.subSequence(1,sb.length() - 1);
    CharSequence actual=GenericUtils.stripQuotes(sb);
    assertEquals("Mismatched result for delim (" + topDelim + "/"+ innerDelim+ ")",expected.toString(),actual.toString());
  }
}

</code></pre>

<br>
<pre class="type-11 type-8 type-10 type-6 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSplitAndJoin(){
  List<String> expected=Collections.unmodifiableList(Arrays.asList(getClass().getPackage().getName().replace('.','/'),getClass().getSimpleName(),getCurrentTestName()));
  for (  char ch : new char[]{',','.','*','?'}) {
    String sep=String.valueOf(ch);
    String s=GenericUtils.join(expected,sep);
    String[] actual=GenericUtils.split(s,ch);
    assertEquals("Mismatched split length for separator=" + sep,expected.size(),GenericUtils.length((Object[])actual));
    for (int index=0; index < actual.length; index++) {
      String e=expected.get(index), a=actual[index];
      if (!e.endsWith(a)) {
        fail("Mismatched value at index=" + index + " for separator="+ sep+ ": expected="+ e+ ", actual="+ a);
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.util.NumberUtilsTest </h4><pre class="type-11 type-8 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPowersOf2List(){
  assertEquals("Mismatched values size for " + NumberUtils.POWERS_OF_TWO,Long.SIZE,GenericUtils.size(NumberUtils.POWERS_OF_TWO));
  long expected=1L;
  for (int index=0; index < Long.SIZE; index++, expected<<=1) {
    Long actual=NumberUtils.POWERS_OF_TWO.get(index);
    assertEquals("Mismatched value at index=" + index,Long.toHexString(expected),Long.toHexString(actual.longValue()));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.util.SecurityUtilsTest </h4><pre class="type-11 type-2 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSetMaxDHGroupExchangeKeySizeProgrammatically(){
  try {
    for (int expected=SecurityUtils.MIN_DHGEX_KEY_SIZE; expected <= SecurityUtils.MAX_DHGEX_KEY_SIZE; expected+=1024) {
      SecurityUtils.setMaxDHGroupExchangeKeySize(expected);
      assertTrue("DH group not supported for key size=" + expected,SecurityUtils.isDHGroupExchangeSupported());
      assertEquals("Mismatched values",expected,SecurityUtils.getMaxDHGroupExchangeKeySize());
    }
  }
  finally {
    SecurityUtils.setMaxDHGroupExchangeKeySize(0);
  }
}

</code></pre>

<br>
<pre class="type-11 type-2 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSetMaxDHGroupExchangeKeySizeByProperty(){
  try {
    for (int expected=SecurityUtils.MIN_DHGEX_KEY_SIZE; expected <= SecurityUtils.MAX_DHGEX_KEY_SIZE; expected+=1024) {
      SecurityUtils.setMaxDHGroupExchangeKeySize(0);
      try {
        System.setProperty(SecurityUtils.MAX_DHGEX_KEY_SIZE_PROP,Integer.toString(expected));
        assertTrue("DH group not supported for key size=" + expected,SecurityUtils.isDHGroupExchangeSupported());
        assertEquals("Mismatched values",expected,SecurityUtils.getMaxDHGroupExchangeKeySize());
      }
  finally {
        System.clearProperty(SecurityUtils.MAX_DHGEX_KEY_SIZE_PROP);
      }
    }
  }
  finally {
    SecurityUtils.setMaxDHGroupExchangeKeySize(0);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.util.io.IoUtilsTest </h4><pre class="type-11 type-2 type-15 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetEOLBytes(){
  byte[] expected=IoUtils.getEOLBytes();
  assertTrue("Empty bytes",NumberUtils.length(expected) > 0);
  for (int index=1; index < Byte.SIZE; index++) {
    byte[] actual=IoUtils.getEOLBytes();
    assertNotSame("Same bytes received at iteration " + index,expected,actual);
    assertArrayEquals("Mismatched bytes at iteration " + index,expected,actual);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.server.ServerSessionListenerTest </h4><pre class="type-11 type-8 type-6 type-2 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testServerStillListensIfSessionListenerThrowsException() throws Exception {
  final Map<String,SocketAddress> eventsMap=new TreeMap<String,SocketAddress>(String.CASE_INSENSITIVE_ORDER);
  final Logger log=LoggerFactory.getLogger(getClass());
  sshd.addSessionListener(new SessionListener(){
    @Override public void sessionCreated(    Session session){
      throwException("SessionCreated",session);
    }
    @Override public void sessionEvent(    Session session,    Event event){
      throwException("SessionEvent",session);
    }
    @Override public void sessionClosed(    Session session){
      throwException("SessionClosed",session);
    }
    @Override public void sessionException(    Session session,    Throwable t){
    }
    private void throwException(    String phase,    Session session){
      IoSession ioSession=session.getIoSession();
      SocketAddress addr=ioSession.getRemoteAddress();
synchronized (eventsMap) {
        if (eventsMap.put(phase,addr) != null) {
          return;
        }
      }
      RuntimeException e=new RuntimeException("Synthetic exception at phase=" + phase + ": "+ addr);
      log.info(e.getMessage());
      throw e;
    }
  }
);
  client.start();
  int curCount=0;
  for (int retryCount=0; retryCount < Byte.SIZE; retryCount++) {
synchronized (eventsMap) {
      if ((curCount=eventsMap.size()) >= 3) {
        return;
      }
    }
    try {
      try (ClientSession s=createTestClientSession()){
        log.info("Retry #" + retryCount + " successful");
      }
 synchronized (eventsMap) {
        assertTrue("Unexpected premature success at retry # " + retryCount + ": "+ eventsMap,eventsMap.size() >= 3);
      }
    }
 catch (    IOException e) {
synchronized (eventsMap) {
        int nextCount=eventsMap.size();
        assertTrue("No session event generated at retry #" + retryCount,nextCount > curCount);
      }
    }
  }
  fail("No success to authenticate");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.server.ServerTest </h4><pre class="type-11 type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testServerIdleTimeoutWithForce() throws Exception {
  final CountDownLatch latch=new CountDownLatch(1);
  sshd.setCommandFactory(new StreamCommand.Factory());
  final long IDLE_TIMEOUT_VALUE=TimeUnit.SECONDS.toMillis(5L);
  PropertyResolverUtils.updateProperty(sshd,FactoryManager.IDLE_TIMEOUT,IDLE_TIMEOUT_VALUE);
  final long DISCONNECT_TIMEOUT_VALUE=TimeUnit.SECONDS.toMillis(2L);
  PropertyResolverUtils.updateProperty(sshd,FactoryManager.DISCONNECT_TIMEOUT,DISCONNECT_TIMEOUT_VALUE);
  sshd.addSessionListener(new SessionListener(){
    @Override public void sessionCreated(    Session session){
      outputDebugMessage("Session created: %s",session);
    }
    @Override public void sessionEvent(    Session session,    Event event){
      outputDebugMessage("Session %s event: %s",session,event);
    }
    @Override public void sessionException(    Session session,    Throwable t){
      outputDebugMessage("Session %s exception %s caught: %s",session,t.getClass().getSimpleName(),t.getMessage());
    }
    @Override public void sessionClosed(    Session session){
      outputDebugMessage("Session closed: %s",session);
      latch.countDown();
    }
  }
);
  TestChannelListener channelListener=new TestChannelListener();
  sshd.addChannelListener(channelListener);
  sshd.start();
  client.start();
  try (ClientSession s=createTestClientSession(sshd);ChannelExec shell=s.createExecChannel("normal");PipedInputStream pis=new PipedInputStream();PipedOutputStream pos=new PipedOutputStream(pis)){
    shell.setOut(pos);
    shell.open().verify(5L,TimeUnit.SECONDS);
    assertTrue("No changes in activated channels",channelListener.waitForModification(3L,TimeUnit.SECONDS));
    assertTrue("No activated server side channels",GenericUtils.size(channelListener.getActiveChannels()) > 0);
    assertTrue("No changes in open channels",channelListener.waitForModification(3L,TimeUnit.SECONDS));
    assertTrue("No open server side channels",GenericUtils.size(channelListener.getOpenChannels()) > 0);
    try (AbstractSession serverSession=sshd.getActiveSessions().iterator().next()){
      AbstractConnectionService<?> service=serverSession.getService(AbstractConnectionService.class);
      Collection<? extends Channel> channels=service.getChannels();
      try (Channel channel=channels.iterator().next()){
        final long MAX_TIMEOUT_VALUE=IDLE_TIMEOUT_VALUE + DISCONNECT_TIMEOUT_VALUE + TimeUnit.SECONDS.toMillis(3L);
        for (long totalNanoTime=0L; channel.getRemoteWindow().getSize() > 0; ) {
          long nanoStart=System.nanoTime();
          Thread.sleep(1L);
          long nanoEnd=System.nanoTime();
          long nanoDuration=nanoEnd - nanoStart;
          totalNanoTime+=nanoDuration;
          assertTrue("Waiting for too long on remote window size to reach zero",totalNanoTime < TimeUnit.MILLISECONDS.toNanos(MAX_TIMEOUT_VALUE));
        }
        LoggerFactory.getLogger(getClass()).info("Waiting for session idle timeouts");
        long t0=System.currentTimeMillis();
        latch.await(1,TimeUnit.MINUTES);
        long t1=System.currentTimeMillis(), diff=t1 - t0;
        assertTrue("Wait time too low: " + diff,diff > IDLE_TIMEOUT_VALUE);
        assertTrue("Wait time too high: " + diff,diff < MAX_TIMEOUT_VALUE);
      }
     }
   }
  finally {
    client.stop();
  }
}

</code></pre>

<br>
<pre class="type-11 type-2 type-3 type-12 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFailAuthenticationWithFuture() throws Exception {
  final int MAX_AUTH_REQUESTS=10;
  PropertyResolverUtils.updateProperty(sshd,ServerAuthenticationManager.MAX_AUTH_REQUESTS,MAX_AUTH_REQUESTS);
  sshd.start();
  client.setServiceFactories(Arrays.asList(new ClientUserAuthServiceOld.Factory(),ClientConnectionServiceFactory.INSTANCE));
  client.start();
  try (ClientSession s=client.connect(getCurrentTestName(),TEST_LOCALHOST,sshd.getPort()).verify(7L,TimeUnit.SECONDS).getSession()){
    int nbTrials=0;
    AuthFuture authFuture;
    do {
      nbTrials++;
      assertTrue("Number of trials below max.",nbTrials < 100);
      authFuture=s.getService(ClientUserAuthServiceOld.class).auth(new org.apache.sshd.deprecated.UserAuthPassword(s,"ssh-connection","buggy"));
      assertTrue("Authentication wait failed",authFuture.await(5L,TimeUnit.SECONDS));
      assertTrue("Authentication not done",authFuture.isDone());
      assertFalse("Authentication unexpectedly successful",authFuture.isSuccess());
    }
 while (authFuture.getException() == null);
    Throwable t=authFuture.getException();
    assertNotNull("Missing auth future exception",t);
    assertTrue("Number trials (" + nbTrials + ") below min.="+ MAX_AUTH_REQUESTS,nbTrials > MAX_AUTH_REQUESTS);
  }
  finally {
    client.stop();
  }
}

</code></pre>

<br>
<pre class="type-11 type-2 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testFailAuthenticationWithWaitFor() throws Exception {
  final int MAX_AUTH_REQUESTS=10;
  PropertyResolverUtils.updateProperty(sshd,ServerAuthenticationManager.MAX_AUTH_REQUESTS,MAX_AUTH_REQUESTS);
  sshd.start();
  client.setServiceFactories(Arrays.asList(new ClientUserAuthServiceOld.Factory(),ClientConnectionServiceFactory.INSTANCE));
  client.start();
  try (ClientSession s=client.connect(getCurrentTestName(),TEST_LOCALHOST,sshd.getPort()).verify(7L,TimeUnit.SECONDS).getSession()){
    int nbTrials=0;
    Collection<ClientSession.ClientSessionEvent> res=Collections.emptySet();
    Collection<ClientSession.ClientSessionEvent> mask=EnumSet.of(ClientSession.ClientSessionEvent.CLOSED,ClientSession.ClientSessionEvent.WAIT_AUTH);
    while (!res.contains(ClientSession.ClientSessionEvent.CLOSED)) {
      nbTrials++;
      s.getService(ClientUserAuthServiceOld.class).auth(new org.apache.sshd.deprecated.UserAuthPassword(s,"ssh-connection","buggy"));
      res=s.waitFor(mask,TimeUnit.SECONDS.toMillis(5L));
      assertFalse("Timeout signalled",res.contains(ClientSession.ClientSessionEvent.TIMEOUT));
    }
    assertTrue("Number trials (" + nbTrials + ") below min.="+ MAX_AUTH_REQUESTS,nbTrials > MAX_AUTH_REQUESTS);
  }
  finally {
    client.stop();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.server.config.keys.AuthorizedKeysAuthenticatorTest </h4><pre class="type-11 type-8 type-2 type-3 type-15 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAutomaticReload() throws Exception {
  final Path file=getTempTargetRelativeFile(getCurrentTestName());
  if (Files.exists(file)) {
    Files.delete(file);
  }
  final AtomicInteger reloadCount=new AtomicInteger(0);
  PublickeyAuthenticator auth=new AuthorizedKeysAuthenticator(file){
    @Override protected Collection<AuthorizedKeyEntry> reloadAuthorizedKeys(    Path path,    String username,    ServerSession session) throws IOException {
      assertSame("Mismatched reload path",file,path);
      reloadCount.incrementAndGet();
      return super.reloadAuthorizedKeys(path,username,session);
    }
  }
;
  assertFalse("Unexpected authentication success for missing file " + file,auth.authenticate(getCurrentTestName(),Mockito.mock(PublicKey.class),null));
  List<String> keyLines=loadDefaultSupportedKeys();
  assertHierarchyTargetFolderExists(file.getParent());
  while (keyLines.size() > 0) {
    try (Writer w=Files.newBufferedWriter(file,StandardCharsets.UTF_8)){
      w.append(PublicKeyEntry.COMMENT_CHAR).append(' ').append(getCurrentTestName()).append(' ').append(String.valueOf(keyLines.size())).append(" remaining keys").append(IoUtils.EOL);
      for (      String l : keyLines) {
        w.append(l).append(IoUtils.EOL);
      }
    }
     List<AuthorizedKeyEntry> entries=AuthorizedKeyEntry.readAuthorizedKeys(file);
    assertEquals("Mismatched number of loaded entries",keyLines.size(),entries.size());
    List<PublicKey> keySet=AuthorizedKeyEntry.resolveAuthorizedKeys(PublicKeyEntryResolver.FAILING,entries);
    assertEquals("Mismatched number of loaded keys",entries.size(),keySet.size());
    reloadCount.set(0);
    for (int index=0; index < keySet.size(); index++) {
      PublicKey k=keySet.get(index);
      String keyData=keyLines.get(index);
      assertTrue("Failed to authenticate with key #" + (index + 1) + " "+ k.getAlgorithm()+ "["+ keyData+ "] on file="+ file,auth.authenticate(getCurrentTestName(),k,null));
      assertEquals("Unexpected keys re-loading of " + keyLines.size() + " remaining at key #"+ (index + 1)+ " on file="+ file,1,reloadCount.get());
    }
    keyLines.remove(0);
  }
  assertTrue("File no longer exists: " + file,Files.exists(file));
  assertFalse("Unexpected authentication success for empty file " + file,auth.authenticate(getCurrentTestName(),Mockito.mock(PublicKey.class),null));
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
