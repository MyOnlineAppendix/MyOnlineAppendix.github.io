<h3><span class=" glyphicon glyphicon-tag"/>&nbspEqualityVerifier</h3><kbd>Verifies whether objects/variable are equal to an expected value </kbd><br><br><br><h4 style="margin:0px">Class: org.apache.sshd.KeyReExchangeTest </h4><pre class="type-8 type-10 type-6 type-2 type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReExchangeFromServerBySize() throws Exception {
  final long LIMIT=10 * 1024L;
  setUp(LIMIT,0L,0L);
  try (SshClient client=setupTestClient()){
    client.start();
    final Semaphore pipedCount=new Semaphore(0,true);
    try (ClientSession session=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession();ByteArrayOutputStream sent=new ByteArrayOutputStream();ByteArrayOutputStream out=new ByteArrayOutputStream(){
      private long writeCount=0L;
      @Override public void write(      int b){
        super.write(b);
        updateWriteCount(1L);
        pipedCount.release(1);
      }
      @Override public void write(      byte[] b,      int off,      int len){
        super.write(b,off,len);
        updateWriteCount(len);
        pipedCount.release(len);
      }
      private void updateWriteCount(      long delta){
        writeCount+=delta;
        outputDebugMessage("OUT write count=%d",writeCount);
      }
    }
){
      session.addPasswordIdentity(getCurrentTestName());
      session.auth().verify(5L,TimeUnit.SECONDS);
      byte[] sentData;
      try (ChannelShell channel=session.createShellChannel();PipedOutputStream pipedIn=new PipedOutputStream();OutputStream teeOut=new TeeOutputStream(sent,pipedIn);OutputStream err=new NullOutputStream();InputStream inPipe=new PipedInputStream(pipedIn)){
        channel.setIn(inPipe);
        channel.setOut(out);
        channel.setErr(err);
        channel.open();
        teeOut.write("this is my command\n".getBytes(StandardCharsets.UTF_8));
        teeOut.flush();
        StringBuilder sb=new StringBuilder(101 * 10);
        for (int i=0; i < 100; i++) {
          sb.append("0123456789");
        }
        sb.append('\n');
        final AtomicInteger exchanges=new AtomicInteger();
        session.addSessionListener(new SessionListener(){
          @Override public void sessionCreated(          Session session){
          }
          @Override public void sessionEvent(          Session session,          Event event){
            if (Event.KeyEstablished.equals(event)) {
              int count=exchanges.incrementAndGet();
              outputDebugMessage("Key established for %s - count=%d",session,count);
            }
          }
          @Override public void sessionException(          Session session,          Throwable t){
          }
          @Override public void sessionClosed(          Session session){
          }
        }
);
        byte[] data=sb.toString().getBytes(StandardCharsets.UTF_8);
        for (long sentSize=0L; sentSize < (LIMIT + Byte.MAX_VALUE + data.length); sentSize+=data.length) {
          teeOut.write(data);
          teeOut.flush();
          if (exchanges.get() > 0) {
            outputDebugMessage("Stop sending after %d bytes - exchanges=%s",sentSize + data.length,exchanges);
            break;
          }
        }
        teeOut.write("exit\n".getBytes(StandardCharsets.UTF_8));
        teeOut.flush();
        Collection<ClientChannel.ClientChannelEvent> result=channel.waitFor(EnumSet.of(ClientChannel.ClientChannelEvent.CLOSED),TimeUnit.SECONDS.toMillis(15L));
        assertFalse("Timeout while waiting for channel closure",result.contains(ClientChannel.ClientChannelEvent.TIMEOUT));
        sentData=sent.toByteArray();
        if (!pipedCount.tryAcquire(sentData.length,13L,TimeUnit.SECONDS)) {
          fail("Failed to await sent data signal for len=" + sentData.length + " (available="+ pipedCount.availablePermits()+ ")");
        }
        assertTrue("Expected rekeying",exchanges.get() > 0);
      }
       byte[] outData=out.toByteArray();
      assertEquals("Mismatched sent data length",sentData.length,outData.length);
      assertArrayEquals("Mismatched sent data content",sentData,outData);
    }
  finally {
      client.stop();
    }
  }
 }

</code></pre>

<br>
<pre class="type-11 type-8 type-10 type-6 type-2 type-3 type-7 type-12 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReExchangeFromSshdClient() throws Exception {
  setUp(0L,0L,0L);
  try (SshClient client=setupTestClient()){
    client.start();
    try (ClientSession session=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession()){
      session.addPasswordIdentity(getCurrentTestName());
      session.auth().verify(5L,TimeUnit.SECONDS);
      final Semaphore pipedCount=new Semaphore(0,true);
      try (ChannelShell channel=session.createShellChannel();ByteArrayOutputStream sent=new ByteArrayOutputStream();PipedOutputStream pipedIn=new PipedOutputStream();InputStream inPipe=new PipedInputStream(pipedIn);OutputStream teeOut=new TeeOutputStream(sent,pipedIn);ByteArrayOutputStream out=new ByteArrayOutputStream(){
        private long writeCount=0L;
        @Override public void write(        int b){
          super.write(b);
          updateWriteCount(1L);
          pipedCount.release(1);
        }
        @Override public void write(        byte[] b,        int off,        int len){
          super.write(b,off,len);
          updateWriteCount(len);
          pipedCount.release(len);
        }
        private void updateWriteCount(        long delta){
          writeCount+=delta;
          outputDebugMessage("OUT write count=%d",writeCount);
        }
      }
;ByteArrayOutputStream err=new ByteArrayOutputStream()){
        channel.setIn(inPipe);
        channel.setOut(out);
        channel.setErr(err);
        channel.open();
        teeOut.write("this is my command\n".getBytes(StandardCharsets.UTF_8));
        teeOut.flush();
        StringBuilder sb=new StringBuilder(Byte.MAX_VALUE);
        for (int i=0; i < 10; i++) {
          sb.append("0123456789");
        }
        sb.append('\n');
        byte[] data=sb.toString().getBytes(StandardCharsets.UTF_8);
        for (int i=1; i <= 10; i++) {
          teeOut.write(data);
          teeOut.flush();
          KeyExchangeFuture kexFuture=session.reExchangeKeys();
          assertTrue("Failed to complete KEX on time at iteration " + i,kexFuture.await(5L,TimeUnit.SECONDS));
          assertNull("KEX exception signalled at iteration " + i,kexFuture.getException());
        }
        teeOut.write("exit\n".getBytes(StandardCharsets.UTF_8));
        teeOut.flush();
        Collection<ClientChannel.ClientChannelEvent> result=channel.waitFor(EnumSet.of(ClientChannel.ClientChannelEvent.CLOSED),TimeUnit.SECONDS.toMillis(15L));
        assertFalse("Timeout while waiting for channel closure",result.contains(ClientChannel.ClientChannelEvent.TIMEOUT));
        byte[] expected=sent.toByteArray();
        if (!pipedCount.tryAcquire(expected.length,13L,TimeUnit.SECONDS)) {
          fail("Failed to await sent data signal for len=" + expected.length + " (available="+ pipedCount.availablePermits()+ ")");
        }
        assertArrayEquals("Mismatched sent data content",expected,out.toByteArray());
      }
     }
  finally {
      client.stop();
    }
  }
 }

</code></pre>

<br>
<pre class="type-11 type-8 type-3 type-14 type-7 type-13 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReExchangeFromJschClient() throws Exception {
  Assume.assumeTrue("DH Group Exchange not supported",SecurityUtils.isDHGroupExchangeSupported());
  setUp(0L,0L,0L);
  JSch.setConfig("kex",BuiltinDHFactories.Constants.DIFFIE_HELLMAN_GROUP_EXCHANGE_SHA1);
  JSch sch=new JSch();
  com.jcraft.jsch.Session s=sch.getSession(getCurrentTestName(),TEST_LOCALHOST,port);
  try {
    s.setUserInfo(new SimpleUserInfo(getCurrentTestName()));
    s.connect();
    com.jcraft.jsch.Channel c=s.openChannel(Channel.CHANNEL_SHELL);
    c.connect();
    try (OutputStream os=c.getOutputStream();InputStream is=c.getInputStream()){
      String expected="this is my command\n";
      byte[] bytes=expected.getBytes(StandardCharsets.UTF_8);
      byte[] data=new byte[bytes.length + Long.SIZE];
      for (int i=1; i <= 10; i++) {
        os.write(bytes);
        os.flush();
        int len=is.read(data);
        String str=new String(data,0,len);
        assertEquals("Mismatched data at iteration " + i,expected,str);
        outputDebugMessage("Request re-key #%d",i);
        s.rekey();
      }
    }
  finally {
      c.disconnect();
    }
  }
  finally {
    s.disconnect();
  }
}

</code></pre>

<br>
<pre class="type-8 type-10 type-6 type-2 type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReExchangeFromServerByPackets() throws Exception {
  final int PACKETS=135;
  setUp(0L,0L,PACKETS);
  try (SshClient client=setupTestClient()){
    client.start();
    final Semaphore pipedCount=new Semaphore(0,true);
    try (ClientSession session=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession();ByteArrayOutputStream sent=new ByteArrayOutputStream();ByteArrayOutputStream out=new ByteArrayOutputStream(){
      private long writeCount=0L;
      @Override public void write(      int b){
        super.write(b);
        updateWriteCount(1L);
        pipedCount.release(1);
      }
      @Override public void write(      byte[] b,      int off,      int len){
        super.write(b,off,len);
        updateWriteCount(len);
        pipedCount.release(len);
      }
      private void updateWriteCount(      long delta){
        writeCount+=delta;
        outputDebugMessage("OUT write count=%d",writeCount);
      }
    }
){
      session.addPasswordIdentity(getCurrentTestName());
      session.auth().verify(5L,TimeUnit.SECONDS);
      byte[] sentData;
      try (ChannelShell channel=session.createShellChannel();PipedOutputStream pipedIn=new PipedOutputStream();OutputStream sentTracker=new OutputCountTrackingOutputStream(sent){
        @Override protected long updateWriteCount(        long delta){
          long result=super.updateWriteCount(delta);
          outputDebugMessage("SENT write count=%d",result);
          return result;
        }
      }
;OutputStream teeOut=new TeeOutputStream(sentTracker,pipedIn);OutputStream stderr=new NullOutputStream();OutputStream stdout=new OutputCountTrackingOutputStream(out){
        @Override protected long updateWriteCount(        long delta){
          long result=super.updateWriteCount(delta);
          outputDebugMessage("OUT write count=%d",result);
          return result;
        }
      }
;InputStream inPipe=new PipedInputStream(pipedIn)){
        channel.setIn(inPipe);
        channel.setOut(stdout);
        channel.setErr(stderr);
        channel.open();
        teeOut.write("this is my command\n".getBytes(StandardCharsets.UTF_8));
        teeOut.flush();
        final AtomicInteger exchanges=new AtomicInteger();
        session.addSessionListener(new SessionListener(){
          @Override public void sessionCreated(          Session session){
          }
          @Override public void sessionEvent(          Session session,          Event event){
            if (Event.KeyEstablished.equals(event)) {
              int count=exchanges.incrementAndGet();
              outputDebugMessage("Key established for %s - count=%d",session,count);
            }
          }
          @Override public void sessionException(          Session session,          Throwable t){
          }
          @Override public void sessionClosed(          Session session){
          }
        }
);
        byte[] data=(getClass().getName() + "#" + getCurrentTestName()+ "\n").getBytes(StandardCharsets.UTF_8);
        for (int index=0; index < (PACKETS * 2); index++) {
          teeOut.write(data);
          teeOut.flush();
          if (exchanges.get() > 0) {
            outputDebugMessage("Stop sending after %d packets and %d bytes - exchanges=%s",(index + 1),(index + 1L) * data.length,exchanges);
            break;
          }
        }
        teeOut.write("exit\n".getBytes(StandardCharsets.UTF_8));
        teeOut.flush();
        Collection<ClientChannel.ClientChannelEvent> result=channel.waitFor(EnumSet.of(ClientChannel.ClientChannelEvent.CLOSED),TimeUnit.SECONDS.toMillis(15L));
        assertFalse("Timeout while waiting for channel closure",result.contains(ClientChannel.ClientChannelEvent.TIMEOUT));
        sentData=sent.toByteArray();
        if (!pipedCount.tryAcquire(sentData.length,13L,TimeUnit.SECONDS)) {
          fail("Failed to await sent data signal for len=" + sentData.length + " (available="+ pipedCount.availablePermits()+ ")");
        }
        assertTrue("Expected rekeying",exchanges.get() > 0);
      }
       byte[] outData=out.toByteArray();
      assertEquals("Mismatched sent data length",sentData.length,outData.length);
      assertArrayEquals("Mismatched sent data content",sentData,outData);
    }
  finally {
      client.stop();
    }
  }
 }

</code></pre>

<br>
<pre class="type-8 type-10 type-6 type-2 type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReExchangeFromServerByTime() throws Exception {
  final long TIME=TimeUnit.SECONDS.toMillis(2L);
  setUp(0L,TIME,0L);
  try (SshClient client=setupTestClient()){
    client.start();
    final Semaphore pipedCount=new Semaphore(0,true);
    try (ClientSession session=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession();ByteArrayOutputStream sent=new ByteArrayOutputStream();ByteArrayOutputStream out=new ByteArrayOutputStream(){
      private long writeCount=0L;
      @Override public void write(      int b){
        super.write(b);
        updateWriteCount(1L);
        pipedCount.release(1);
      }
      @Override public void write(      byte[] b,      int off,      int len){
        super.write(b,off,len);
        updateWriteCount(len);
        pipedCount.release(len);
      }
      private void updateWriteCount(      long delta){
        writeCount+=delta;
        outputDebugMessage("OUT write count=%d",writeCount);
      }
    }
){
      session.addPasswordIdentity(getCurrentTestName());
      session.auth().verify(5L,TimeUnit.SECONDS);
      byte[] sentData;
      try (ChannelShell channel=session.createShellChannel();PipedOutputStream pipedIn=new PipedOutputStream();OutputStream teeOut=new TeeOutputStream(sent,pipedIn);OutputStream err=new NullOutputStream();InputStream inPipe=new PipedInputStream(pipedIn)){
        channel.setIn(inPipe);
        channel.setOut(out);
        channel.setErr(err);
        channel.open();
        teeOut.write("this is my command\n".getBytes(StandardCharsets.UTF_8));
        teeOut.flush();
        StringBuilder sb=new StringBuilder(101 * 10);
        for (int i=0; i < 100; i++) {
          sb.append("0123456789");
        }
        sb.append('\n');
        final AtomicInteger exchanges=new AtomicInteger();
        session.addSessionListener(new SessionListener(){
          @Override public void sessionCreated(          Session session){
          }
          @Override public void sessionEvent(          Session session,          Event event){
            if (Event.KeyEstablished.equals(event)) {
              int count=exchanges.incrementAndGet();
              outputDebugMessage("Key established for %s - count=%d",session,count);
            }
          }
          @Override public void sessionException(          Session session,          Throwable t){
          }
          @Override public void sessionClosed(          Session session){
          }
        }
);
        byte[] data=getCurrentTestName().getBytes(StandardCharsets.UTF_8);
        final long MAX_WAIT_NANOS=TimeUnit.MILLISECONDS.toNanos(3L * TIME);
        final long MIN_WAIT=10L;
        final long MIN_WAIT_NANOS=TimeUnit.MILLISECONDS.toNanos(MIN_WAIT);
        for (long timePassed=0L, sentSize=0L; timePassed < MAX_WAIT_NANOS; timePassed++) {
          long nanoStart=System.nanoTime();
          teeOut.write(data);
          teeOut.write('\n');
          teeOut.flush();
          long nanoEnd=System.nanoTime();
          long nanoDuration=nanoEnd - nanoStart;
          timePassed+=nanoDuration;
          sentSize+=data.length + 1;
          if (exchanges.get() > 0) {
            outputDebugMessage("Stop sending after %d nanos and size=%d - exchanges=%s",timePassed,sentSize,exchanges);
            break;
          }
          if ((timePassed < MAX_WAIT_NANOS) && (nanoDuration < MIN_WAIT_NANOS)) {
            Thread.sleep(MIN_WAIT);
          }
        }
        teeOut.write("exit\n".getBytes(StandardCharsets.UTF_8));
        teeOut.flush();
        Collection<ClientChannel.ClientChannelEvent> result=channel.waitFor(EnumSet.of(ClientChannel.ClientChannelEvent.CLOSED),TimeUnit.SECONDS.toMillis(15L));
        assertFalse("Timeout while waiting for channel closure",result.contains(ClientChannel.ClientChannelEvent.TIMEOUT));
        sentData=sent.toByteArray();
        if (!pipedCount.tryAcquire(sentData.length,13L,TimeUnit.SECONDS)) {
          fail("Failed to await sent data signal for len=" + sentData.length + " (available="+ pipedCount.availablePermits()+ ")");
        }
        assertTrue("Expected rekeying",exchanges.get() > 0);
      }
       byte[] outData=out.toByteArray();
      assertEquals("Mismatched sent data length",sentData.length,outData.length);
      assertArrayEquals("Mismatched sent data content",sentData,outData);
    }
  finally {
      client.stop();
    }
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.ProxyTest </h4><pre class="type-11 type-8 type-6 type-3 type-7 type-13 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSocksProxy() throws Exception {
  try (ClientSession session=createNativeSession()){
    String expected=getCurrentTestName();
    byte[] bytes=expected.getBytes(StandardCharsets.UTF_8);
    byte[] buf=new byte[bytes.length + Long.SIZE];
    SshdSocketAddress dynamic=session.startDynamicPortForwarding(new SshdSocketAddress(TEST_LOCALHOST,0));
    try {
      for (int i=0; i < 10; i++) {
        try (Socket s=new Socket(new Proxy(Proxy.Type.SOCKS,new InetSocketAddress(TEST_LOCALHOST,dynamic.getPort())))){
          s.connect(new InetSocketAddress(TEST_LOCALHOST,echoPort));
          s.setSoTimeout((int)TimeUnit.SECONDS.toMillis(10L));
          try (OutputStream sockOut=s.getOutputStream();InputStream sockIn=s.getInputStream()){
            sockOut.write(bytes);
            sockOut.flush();
            int l=sockIn.read(buf);
            assertEquals("Mismatched data at iteration " + i,expected,new String(buf,0,l));
          }
         }
       }
    }
  finally {
      session.stopDynamicPortForwarding(dynamic);
    }
    try {
      try (Socket s=new Socket(new Proxy(Proxy.Type.SOCKS,new InetSocketAddress(TEST_LOCALHOST,dynamic.getPort())))){
        s.connect(new InetSocketAddress(TEST_LOCALHOST,echoPort));
        s.setSoTimeout((int)TimeUnit.SECONDS.toMillis(10L));
        s.getOutputStream().write(bytes);
        fail("Unexpected success to write proxy data");
      }
     }
 catch (    IOException e) {
    }
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.WelcomeBannerTest </h4><pre class="type-8 type-10 type-3 type-15 type-7 type-12 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBanner() throws Exception {
  try (SshClient client=setupTestClient()){
    final AtomicReference<String> welcomeHolder=new AtomicReference<>(null);
    final AtomicReference<ClientSession> sessionHolder=new AtomicReference<>(null);
    client.setUserInteraction(new UserInteraction(){
      @Override public boolean isInteractionAllowed(      ClientSession session){
        return true;
      }
      @Override public void welcome(      ClientSession session,      String banner,      String lang){
        validateSession("welcome",session);
        assertNull("Multiple banner invocations",welcomeHolder.getAndSet(banner));
      }
      @Override public String[] interactive(      ClientSession session,      String name,      String instruction,      String lang,      String[] prompt,      boolean[] echo){
        validateSession("interactive",session);
        return null;
      }
      @Override public String getUpdatedPassword(      ClientSession clientSession,      String prompt,      String lang){
        throw new UnsupportedOperationException("Unexpected call");
      }
      private void validateSession(      String phase,      ClientSession session){
        ClientSession prev=sessionHolder.getAndSet(session);
        if (prev != null) {
          assertSame("Mismatched " + phase + " client session",prev,session);
        }
      }
    }
);
    client.start();
    try (ClientSession session=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession()){
      session.addPasswordIdentity(getCurrentTestName());
      session.auth().verify(5L,TimeUnit.SECONDS);
      assertSame("Mismatched sessions",session,sessionHolder.get());
      assertEquals("Mismatched banner",WELCOME,welcomeHolder.get());
    }
  finally {
      client.stop();
    }
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.agent.AgentTest </h4><pre class="type-3 type-14 type-7 type-12 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAgentServer() throws Exception {
  Assume.assumeTrue("BouncyCastle not registered",SecurityUtils.isBouncyCastleRegistered());
  try (AgentServer agent=new AgentServer()){
    String authSocket;
    try {
      authSocket=agent.start();
    }
 catch (    RuntimeException e) {
      Throwable cause=e.getCause();
      if (cause instanceof UnsatisfiedLinkError) {
        authSocket=null;
      }
 else {
        throw e;
      }
    }
    Assume.assumeTrue("Native library N/A",authSocket != null);
    try (SshAgent client=new AgentClient(authSocket)){
      List<Pair<PublicKey,String>> keys=client.getIdentities();
      assertNotNull("No initial identities",keys);
      assertEquals("Unexpected initial identities size",0,keys.size());
      KeyPair k=createTestHostKeyProvider().loadKey(KeyPairProvider.SSH_RSA);
      client.addIdentity(k,"");
      keys=client.getIdentities();
      assertNotNull("No registered identities after add",keys);
      assertEquals("Mismatched registered keys size",1,keys.size());
      client.removeIdentity(k.getPublic());
      keys=client.getIdentities();
      assertNotNull("No registered identities after remove",keys);
      assertEquals("Registered keys size not empty",0,keys.size());
      client.removeAllIdentities();
    }
   }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.client.ClientSessionListenerTest </h4><pre class="type-8 type-3 type-15 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSessionListenerCanInfluenceAuthentication() throws IOException {
  final AtomicInteger verificationCount=new AtomicInteger();
  final ServerKeyVerifier verifier=new ServerKeyVerifier(){
    @Override public boolean verifyServerKey(    ClientSession sshClientSession,    SocketAddress remoteAddress,    PublicKey serverKey){
      verificationCount.incrementAndGet();
      return true;
    }
  }
;
  client.addSessionListener(new SessionListener(){
    @Override public void sessionCreated(    Session session){
    }
    @Override public void sessionEvent(    Session session,    Event event){
      if ((!session.isAuthenticated()) && (session instanceof ClientSession) && Event.KexCompleted.equals(event)) {
        ClientSession clientSession=(ClientSession)session;
        clientSession.setServerKeyVerifier(verifier);
        clientSession.setUserInteraction(UserInteraction.NONE);
      }
    }
    @Override public void sessionException(    Session session,    Throwable t){
    }
    @Override public void sessionClosed(    Session session){
    }
  }
);
  client.start();
  try (ClientSession session=createTestClientSession()){
    assertNotSame("Invalid default user interaction",UserInteraction.NONE,client.getUserInteraction());
    assertNotSame("Invalid default server key verifier",verifier,client.getServerKeyVerifier());
    assertSame("Mismatched session user interaction",UserInteraction.NONE,session.getUserInteraction());
    assertSame("Mismatched session server key verifier",verifier,session.getServerKeyVerifier());
    assertEquals("Mismatched verification count",1,verificationCount.get());
  }
  finally {
    client.stop();
  }
}

</code></pre>

<br>
<pre class="type-8 type-3 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSessionListenerCanModifyKEXNegotiation() throws Exception {
  final Map<KexProposalOption,NamedFactory<?>> kexParams=new EnumMap<>(KexProposalOption.class);
  kexParams.put(KexProposalOption.ALGORITHMS,getLeastFavorite(KeyExchange.class,client.getKeyExchangeFactories()));
  kexParams.put(KexProposalOption.C2SENC,getLeastFavorite(Cipher.class,client.getCipherFactories()));
  kexParams.put(KexProposalOption.C2SMAC,getLeastFavorite(Mac.class,client.getMacFactories()));
  client.addSessionListener(new SessionListener(){
    @Override @SuppressWarnings("unchecked") public void sessionCreated(    Session session){
      session.setKeyExchangeFactories(Collections.singletonList((NamedFactory<KeyExchange>)kexParams.get(KexProposalOption.ALGORITHMS)));
      session.setCipherFactories(Collections.singletonList((NamedFactory<Cipher>)kexParams.get(KexProposalOption.C2SENC)));
      session.setMacFactories(Collections.singletonList((NamedFactory<Mac>)kexParams.get(KexProposalOption.C2SMAC)));
    }
    @Override public void sessionEvent(    Session session,    Event event){
    }
    @Override public void sessionException(    Session session,    Throwable t){
    }
    @Override public void sessionClosed(    Session session){
    }
  }
);
  client.start();
  try (ClientSession session=createTestClientSession()){
    for (    Map.Entry<KexProposalOption,? extends NamedResource> ke : kexParams.entrySet()) {
      KexProposalOption option=ke.getKey();
      String expected=ke.getValue().getName();
      String actual=session.getNegotiatedKexParameter(option);
      assertEquals("Mismatched values for KEX=" + option,expected,actual);
    }
  }
  finally {
    client.stop();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.client.ClientTest </h4><pre class="type-2 type-3 type-15 type-7 type-12 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testKeyboardInteractiveInSessionUserInteractiveFailure() throws Exception {
  final AtomicInteger count=new AtomicInteger();
  final int MAX_PROMPTS=3;
  PropertyResolverUtils.updateProperty(client,ClientAuthenticationManager.PASSWORD_PROMPTS,MAX_PROMPTS);
  client.setUserAuthFactories(Collections.<NamedFactory<UserAuth>>singletonList(UserAuthKeyboardInteractiveFactory.INSTANCE));
  client.start();
  try (final ClientSession session=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession()){
    assertNotNull("Client session creation not signalled",clientSessionHolder.get());
    session.setUserInteraction(new UserInteraction(){
      @Override public boolean isInteractionAllowed(      ClientSession session){
        return true;
      }
      @Override public void welcome(      ClientSession clientSession,      String banner,      String lang){
        assertSame("Mismatched welcome session",session,clientSession);
      }
      @Override public String[] interactive(      ClientSession clientSession,      String name,      String instruction,      String lang,      String[] prompt,      boolean[] echo){
        assertSame("Mismatched interactive session",session,clientSession);
        int attemptId=count.incrementAndGet();
        return new String[]{"bad#" + attemptId};
      }
      @Override public String getUpdatedPassword(      ClientSession clientSession,      String prompt,      String lang){
        throw new UnsupportedOperationException("Unexpected call");
      }
    }
);
    AuthFuture future=session.auth();
    assertTrue("Authentication not completed in time",future.await(11L,TimeUnit.SECONDS));
    assertTrue("Authentication not, marked as failure",future.isFailure());
    assertEquals("Mismatched authentication retry count",MAX_PROMPTS,count.get());
  }
  finally {
    client.stop();
  }
  assertNull("Session closure not signalled",clientSessionHolder.get());
}

</code></pre>

<br>
<pre class="type-2 type-3 type-7 type-12 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testClientInverted() throws Exception {
  client.start();
  try (ClientSession session=createTestClientSession();ClientChannel channel=session.createShellChannel();ByteArrayOutputStream sent=new ByteArrayOutputStream();ByteArrayOutputStream out=new ByteArrayOutputStream();ByteArrayOutputStream err=new ByteArrayOutputStream()){
    channel.setOut(out);
    channel.setErr(err);
    channel.open().verify(9L,TimeUnit.SECONDS);
    try (OutputStream pipedIn=new TeeOutputStream(sent,channel.getInvertedIn())){
      pipedIn.write("this is my command\n".getBytes(StandardCharsets.UTF_8));
      pipedIn.flush();
      StringBuilder sb=new StringBuilder();
      for (int i=0; i < 1000; i++) {
        sb.append("0123456789");
      }
      sb.append("\n");
      pipedIn.write(sb.toString().getBytes(StandardCharsets.UTF_8));
      pipedIn.write("exit\n".getBytes(StandardCharsets.UTF_8));
      pipedIn.flush();
    }
     Collection<ClientChannel.ClientChannelEvent> result=channel.waitFor(EnumSet.of(ClientChannel.ClientChannelEvent.CLOSED),TimeUnit.SECONDS.toMillis(15L));
    assertFalse("Timeout while waiting on channel close",result.contains(ClientChannel.ClientChannelEvent.TIMEOUT));
    channel.close(false);
    client.stop();
    assertArrayEquals("Mismatched sent and received data",sent.toByteArray(),out.toByteArray());
  }
  finally {
    client.stop();
  }
  assertNull("Session closure not signalled",clientSessionHolder.get());
}

</code></pre>

<br>
<pre class="type-11 type-2 type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testClientStillActiveIfListenerExceptions() throws Exception {
  final Map<String,Integer> eventsMap=new TreeMap<>(String.CASE_INSENSITIVE_ORDER);
  final Collection<String> failuresSet=new TreeSet<>(String.CASE_INSENSITIVE_ORDER);
  final Logger log=LoggerFactory.getLogger(getClass());
  client.addChannelListener(new ChannelListener(){
    @Override public void channelInitialized(    Channel channel){
      handleChannelEvent("Initialized",channel);
    }
    @Override public void channelOpenSuccess(    Channel channel){
      handleChannelEvent("OpenSuccess",channel);
    }
    @Override public void channelOpenFailure(    Channel channel,    Throwable reason){
      assertObjectInstanceOf("Mismatched failure reason type",ChannelFailureException.class,reason);
      String name=((NamedResource)reason).getName();
synchronized (failuresSet) {
        assertTrue("Re-signalled failure location: " + name,failuresSet.add(name));
      }
    }
    @Override public void channelClosed(    Channel channel,    Throwable reason){
      log.info("channelClosed(" + channel + ") reason="+ reason);
    }
    private void handleChannelEvent(    String name,    Channel channel){
      int id=channel.getId();
synchronized (eventsMap) {
        if (eventsMap.put(name,id) != null) {
          return;
        }
      }
      log.info("handleChannelEvent({})[{}] id={}",channel,name,id);
      throw new ChannelFailureException(name);
    }
  }
);
  client.start();
  try (ClientSession session=createTestClientSession();PipedOutputStream pipedIn=new PipedOutputStream();InputStream inPipe=new PipedInputStream(pipedIn);ByteArrayOutputStream out=new ByteArrayOutputStream();ByteArrayOutputStream err=new ByteArrayOutputStream()){
    for (int retryCount=0; retryCount <= 3; retryCount++) {
      try {
        out.reset();
        err.reset();
        try (ChannelShell channel=session.createShellChannel()){
          channel.setIn(inPipe);
          channel.setOut(out);
          channel.setErr(err);
          channel.open().verify(11L,TimeUnit.SECONDS);
          log.info("Channel established at retry#" + retryCount);
          try (OutputStream stdin=channel.getInvertedIn()){
            stdin.write((getCurrentTestName() + "-retry#" + retryCount+ "\n").getBytes(StandardCharsets.UTF_8));
          }
           break;
        }
       }
 catch (      IOException e) {
        outputDebugMessage("%s at retry #%d: %s",e.getClass().getSimpleName(),retryCount,e.getMessage());
synchronized (eventsMap) {
          eventsMap.remove("Closed");
          assertTrue("Unexpected failure at retry #" + retryCount,eventsMap.size() < 3);
        }
      }
catch (      ChannelFailureException e) {
        assertEquals("Mismatched failure reason","Initialized",e.getMessage());
      }
catch (      IllegalStateException e) {
        assertTrue("Premature exception phase - count=" + retryCount,retryCount > 0);
        assertTrue("Session not closing",session.isClosing() || session.isClosed());
        log.warn("Session closing prematurely: " + session);
        return;
      }
    }
  }
  finally {
    client.stop();
  }
  assertEquals("Mismatched total failures count on test end",2,eventsMap.size());
  assertEquals("Mismatched open failures count on test end: " + failuresSet,1,failuresSet.size());
}

</code></pre>

<br>
<pre class="type-2 type-3 type-7 type-12 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAsyncClient() throws Exception {
  PropertyResolverUtils.updateProperty(sshd,FactoryManager.WINDOW_SIZE,1024);
  sshd.setShellFactory(new AsyncEchoShellFactory());
  PropertyResolverUtils.updateProperty(client,FactoryManager.WINDOW_SIZE,1024);
  client.start();
  try (ClientSession session=createTestClientSession();final ChannelShell channel=session.createShellChannel()){
    channel.setStreaming(ClientChannel.Streaming.Async);
    channel.open().verify(5L,TimeUnit.SECONDS);
    final byte[] message="0123456789\n".getBytes(StandardCharsets.UTF_8);
    final int nbMessages=1000;
    try (final ByteArrayOutputStream baosOut=new ByteArrayOutputStream();final ByteArrayOutputStream baosErr=new ByteArrayOutputStream()){
      final AtomicInteger writes=new AtomicInteger(nbMessages);
      channel.getAsyncIn().write(new ByteArrayBuffer(message)).addListener(new SshFutureListener<IoWriteFuture>(){
        @Override public void operationComplete(        IoWriteFuture future){
          try {
            if (future.isWritten()) {
              if (writes.decrementAndGet() > 0) {
                channel.getAsyncIn().write(new ByteArrayBuffer(message)).addListener(this);
              }
 else {
                channel.getAsyncIn().close(false);
              }
            }
 else {
              throw new SshException("Error writing",future.getException());
            }
          }
 catch (          IOException e) {
            if (!channel.isClosing()) {
              e.printStackTrace();
              channel.close(true);
            }
          }
        }
      }
);
      channel.getAsyncOut().read(new ByteArrayBuffer()).addListener(new SshFutureListener<IoReadFuture>(){
        @Override public void operationComplete(        IoReadFuture future){
          try {
            future.verify(5L,TimeUnit.SECONDS);
            Buffer buffer=future.getBuffer();
            baosOut.write(buffer.array(),buffer.rpos(),buffer.available());
            buffer.rpos(buffer.rpos() + buffer.available());
            buffer.compact();
            channel.getAsyncOut().read(buffer).addListener(this);
          }
 catch (          IOException e) {
            if (!channel.isClosing()) {
              e.printStackTrace();
              channel.close(true);
            }
          }
        }
      }
);
      channel.getAsyncErr().read(new ByteArrayBuffer()).addListener(new SshFutureListener<IoReadFuture>(){
        @Override public void operationComplete(        IoReadFuture future){
          try {
            future.verify(5L,TimeUnit.SECONDS);
            Buffer buffer=future.getBuffer();
            baosErr.write(buffer.array(),buffer.rpos(),buffer.available());
            buffer.rpos(buffer.rpos() + buffer.available());
            buffer.compact();
            channel.getAsyncErr().read(buffer).addListener(this);
          }
 catch (          IOException e) {
            if (!channel.isClosing()) {
              e.printStackTrace();
              channel.close(true);
            }
          }
        }
      }
);
      Collection<ClientChannel.ClientChannelEvent> result=channel.waitFor(EnumSet.of(ClientChannel.ClientChannelEvent.CLOSED),TimeUnit.SECONDS.toMillis(15L));
      assertFalse("Timeout while waiting for channel closure",result.contains(ClientChannel.ClientChannelEvent.TIMEOUT));
      assertEquals("Mismatched sent and received data size",nbMessages * message.length,baosOut.size());
    }
     client.close(true);
  }
  finally {
    client.stop();
  }
  assertNull("Session closure not signalled",clientSessionHolder.get());
}

</code></pre>

<br>
<pre class="type-2 type-3 type-7 type-12 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testClient() throws Exception {
  client.start();
  try (ClientSession session=createTestClientSession();ClientChannel channel=session.createShellChannel();ByteArrayOutputStream sent=new ByteArrayOutputStream();PipedOutputStream pipedIn=new PipedOutputStream();PipedInputStream pipedOut=new PipedInputStream(pipedIn)){
    channel.setIn(pipedOut);
    try (OutputStream teeOut=new TeeOutputStream(sent,pipedIn);ByteArrayOutputStream out=new ByteArrayOutputStream();ByteArrayOutputStream err=new ByteArrayOutputStream()){
      channel.setOut(out);
      channel.setErr(err);
      channel.open();
      teeOut.write("this is my command\n".getBytes(StandardCharsets.UTF_8));
      teeOut.flush();
      StringBuilder sb=new StringBuilder();
      for (int i=0; i < 1000; i++) {
        sb.append("0123456789");
      }
      sb.append("\n");
      teeOut.write(sb.toString().getBytes(StandardCharsets.UTF_8));
      teeOut.write("exit\n".getBytes(StandardCharsets.UTF_8));
      teeOut.flush();
      Collection<ClientChannel.ClientChannelEvent> result=channel.waitFor(EnumSet.of(ClientChannel.ClientChannelEvent.CLOSED),TimeUnit.SECONDS.toMillis(15L));
      assertFalse("Timeout while waiting on channel close",result.contains(ClientChannel.ClientChannelEvent.TIMEOUT));
      channel.close(false);
      client.stop();
      assertArrayEquals("Mismatched sent and received data",sent.toByteArray(),out.toByteArray());
    }
   }
  finally {
    client.stop();
  }
  assertNull("Session closure not signalled",clientSessionHolder.get());
}

</code></pre>

<br>
<pre class="type-2 type-3 type-7 type-12 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testClientClosingStream() throws Exception {
  client.start();
  try (ClientSession session=createTestClientSession();ClientChannel channel=session.createShellChannel();ByteArrayOutputStream sent=new ByteArrayOutputStream();PipedOutputStream pipedIn=new PipedOutputStream();InputStream inPipe=new PipedInputStream(pipedIn);ByteArrayOutputStream out=new ByteArrayOutputStream();ByteArrayOutputStream err=new ByteArrayOutputStream()){
    channel.setIn(inPipe);
    channel.setOut(out);
    channel.setErr(err);
    channel.open();
    try (OutputStream teeOut=new TeeOutputStream(sent,pipedIn)){
      teeOut.write("this is my command\n".getBytes(StandardCharsets.UTF_8));
      teeOut.flush();
      StringBuilder sb=new StringBuilder();
      for (int i=0; i < 1000; i++) {
        sb.append("0123456789");
      }
      sb.append("\n");
      teeOut.write(sb.toString().getBytes(StandardCharsets.UTF_8));
    }
     Collection<ClientChannel.ClientChannelEvent> result=channel.waitFor(EnumSet.of(ClientChannel.ClientChannelEvent.CLOSED),TimeUnit.SECONDS.toMillis(15L));
    assertFalse("Timeout while waiting on channel close",result.contains(ClientChannel.ClientChannelEvent.TIMEOUT));
    channel.close(false);
    client.stop();
    assertArrayEquals("Mismatched sent and received data",sent.toByteArray(),out.toByteArray());
  }
  finally {
    client.stop();
  }
  assertNull("Session closure not signalled",clientSessionHolder.get());
}

</code></pre>

<br>
<pre class="type-8 type-10 type-2 type-3 type-15 type-7 type-12 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDefaultKeyboardInteractiveWithFailures() throws Exception {
  client.setUserAuthFactories(Collections.<NamedFactory<UserAuth>>singletonList(UserAuthKeyboardInteractiveFactory.INSTANCE));
  final AtomicInteger count=new AtomicInteger();
  final AtomicReference<ClientSession> interactionSessionHolder=new AtomicReference<>(null);
  client.setUserInteraction(new UserInteraction(){
    private final String[] BAD_RESPONSE={"bad"};
    @Override public boolean isInteractionAllowed(    ClientSession session){
      return true;
    }
    @Override public void welcome(    ClientSession session,    String banner,    String lang){
      validateSession("welcome",session);
    }
    @Override public String[] interactive(    ClientSession session,    String name,    String instruction,    String lang,    String[] prompt,    boolean[] echo){
      validateSession("interactive",session);
      count.incrementAndGet();
      return BAD_RESPONSE;
    }
    @Override public String getUpdatedPassword(    ClientSession session,    String prompt,    String lang){
      throw new UnsupportedOperationException("Unexpected call");
    }
    private void validateSession(    String phase,    ClientSession session){
      ClientSession prev=interactionSessionHolder.getAndSet(session);
      if (prev != null) {
        assertSame("Mismatched " + phase + " client session",prev,session);
      }
    }
  }
);
  final int MAX_PROMPTS=3;
  PropertyResolverUtils.updateProperty(client,ClientAuthenticationManager.PASSWORD_PROMPTS,MAX_PROMPTS);
  client.start();
  try (ClientSession session=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession()){
    assertNotNull("Client session creation not signalled",clientSessionHolder.get());
    AuthFuture future=session.auth();
    assertTrue("Failed to complete authentication on time",future.await(15L,TimeUnit.SECONDS));
    assertTrue("Unexpected authentication success",future.isFailure());
    assertEquals("Mismatched authentication retry count",MAX_PROMPTS,count.get());
  }
  finally {
    client.stop();
  }
  assertNull("Session closure not signalled",clientSessionHolder.get());
}

</code></pre>

<br>
<pre class="type-2 type-3 type-7 type-12 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testClientWithLengthyDialog() throws Exception {
  client.start();
  try (ClientSession session=createTestClientSession();ClientChannel channel=session.createShellChannel();ByteArrayOutputStream sent=new ByteArrayOutputStream();PipedOutputStream pipedIn=new PipedOutputStream();InputStream inPipe=new PipedInputStream(pipedIn);ByteArrayOutputStream out=new ByteArrayOutputStream();ByteArrayOutputStream err=new ByteArrayOutputStream()){
    channel.setIn(inPipe);
    channel.setOut(out);
    channel.setErr(err);
    channel.open().verify(9L,TimeUnit.SECONDS);
    int bytes=0;
    byte[] data="01234567890123456789012345678901234567890123456789\n".getBytes(StandardCharsets.UTF_8);
    long t0=System.currentTimeMillis();
    try (OutputStream teeOut=new TeeOutputStream(sent,pipedIn)){
      for (int i=0; i < 10000; i++) {
        teeOut.write(data);
        teeOut.flush();
        bytes+=data.length;
        if ((bytes & 0xFFF00000) != ((bytes - data.length) & 0xFFF00000)) {
          outputDebugMessage("Bytes written: %d",bytes);
        }
      }
      teeOut.write("exit\n".getBytes(StandardCharsets.UTF_8));
      teeOut.flush();
    }
     long t1=System.currentTimeMillis();
    outputDebugMessage("Sent %d Kb in %d ms",bytes / 1024,t1 - t0);
    outputDebugMessage("Waiting for channel to be closed");
    Collection<ClientChannel.ClientChannelEvent> result=channel.waitFor(EnumSet.of(ClientChannel.ClientChannelEvent.CLOSED),TimeUnit.SECONDS.toMillis(35L));
    assertFalse("Timeout while waiting on channel close",result.contains(ClientChannel.ClientChannelEvent.TIMEOUT));
    channel.close(false);
    client.stop();
    assertArrayEquals("Mismatched sent and received data",sent.toByteArray(),out.toByteArray());
  }
  finally {
    client.stop();
  }
  assertNull("Session closure not signalled",clientSessionHolder.get());
}

</code></pre>

<br>
<pre class="type-2 type-3 type-15 type-7 type-12 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testDefaultKeyboardInteractiveInSessionUserInteractive() throws Exception {
  final AtomicInteger count=new AtomicInteger();
  final int MAX_PROMPTS=3;
  PropertyResolverUtils.updateProperty(client,ClientAuthenticationManager.PASSWORD_PROMPTS,MAX_PROMPTS);
  client.setUserAuthFactories(Collections.<NamedFactory<UserAuth>>singletonList(UserAuthKeyboardInteractiveFactory.INSTANCE));
  client.start();
  try (final ClientSession session=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession()){
    assertNotNull("Client session creation not signalled",clientSessionHolder.get());
    session.setUserInteraction(new UserInteraction(){
      @Override public boolean isInteractionAllowed(      ClientSession session){
        return true;
      }
      @Override public void welcome(      ClientSession clientSession,      String banner,      String lang){
        assertSame("Mismatched welcome session",session,clientSession);
      }
      @Override public String[] interactive(      ClientSession clientSession,      String name,      String instruction,      String lang,      String[] prompt,      boolean[] echo){
        assertSame("Mismatched interactive session",session,clientSession);
        count.incrementAndGet();
        return new String[]{getCurrentTestName()};
      }
      @Override public String getUpdatedPassword(      ClientSession clientSession,      String prompt,      String lang){
        throw new UnsupportedOperationException("Unexpected call");
      }
    }
);
    AuthFuture future=session.auth();
    assertTrue("Failed to complete authentication on time",future.await(15L,TimeUnit.SECONDS));
    assertTrue("Authentication not marked as success",future.isSuccess());
    assertFalse("Authentication marked as failure",future.isFailure());
    assertEquals("Mismatched authentication attempts count",1,count.get());
  }
  finally {
    client.stop();
  }
  assertNull("Session closure not signalled",clientSessionHolder.get());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.client.config.hosts.HostConfigEntryTest </h4><pre class="type-11 type-8 type-2 type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadGlobalHostsConfigEntries() throws IOException {
  List<HostConfigEntry> entries=validateHostConfigEntries(readHostConfigEntries());
  assertTrue("Not enough entries read",GenericUtils.size(entries) > 1);
  HostConfigEntry globalEntry=entries.get(0);
  assertEquals("Mismatched global entry pattern",HostConfigEntry.ALL_HOSTS_PATTERN,globalEntry.getHost());
  for (int index=1; index < entries.size(); index++) {
    HostConfigEntry entry=entries.get(index);
    assertFalse("No target host for " + entry,GenericUtils.isEmpty(entry.getHostName()));
    assertTrue("No target port for " + entry,entry.getPort() > 0);
    assertFalse("No username for " + entry,GenericUtils.isEmpty(entry.getUsername()));
    assertFalse("No identities for " + entry,GenericUtils.isEmpty(entry.getIdentities()));
    assertFalse("No properties for " + entry,GenericUtils.isEmpty(entry.getProperties()));
  }
}

</code></pre>

<br>
<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReadMultipleHostPatterns() throws IOException {
  List<HostConfigEntry> entries=validateHostConfigEntries(readHostConfigEntries());
  assertEquals("Mismatched number of entries",1,GenericUtils.size(entries));
  assertEquals("Mismatched number of patterns",3,GenericUtils.size(entries.get(0).getPatterns()));
}

</code></pre>

<br>
<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testResolvePort(){
  final int ORIGINAL_PORT=Short.MAX_VALUE;
  final int ENTRY_PORT=7365;
  assertEquals("Mismatched entry port preference",ENTRY_PORT,HostConfigEntry.resolvePort(ORIGINAL_PORT,ENTRY_PORT));
  for (  int entryPort : new int[]{-1,0}) {
    assertEquals("Non-preferred original port for entry port=" + entryPort,ORIGINAL_PORT,HostConfigEntry.resolvePort(ORIGINAL_PORT,entryPort));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.client.config.keys.ClientIdentityFileWatcherTest </h4><pre class="type-8 type-2 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testIdentityReload() throws Exception {
  Path dir=assertHierarchyTargetFolderExists(getTempTargetRelativeFile(getClass().getSimpleName()));
  final Path idFile=dir.resolve(getCurrentTestName() + ".pem");
  final KeyPair identity=Utils.getFirstKeyPair(createTestHostKeyProvider());
  ClientIdentityLoader loader=new ClientIdentityLoader(){
    @Override public KeyPair loadClientIdentity(    String location,    FilePasswordProvider provider) throws IOException, GeneralSecurityException {
      assertTrue("Invalid location: " + location,isValidLocation(location));
      return identity;
    }
    @Override public boolean isValidLocation(    String location) throws IOException {
      return Objects.equals(location,toString());
    }
    @Override public String toString(){
      return Objects.toString(idFile);
    }
  }
;
  final AtomicInteger reloadCount=new AtomicInteger(0);
  ClientIdentityProvider idProvider=new ClientIdentityFileWatcher(idFile,loader,FilePasswordProvider.EMPTY,false){
    @Override protected KeyPair reloadClientIdentity(    Path path) throws IOException, GeneralSecurityException {
      assertEquals("Mismatched client identity path",idFile,path);
      reloadCount.incrementAndGet();
      return super.reloadClientIdentity(path);
    }
  }
;
  Files.deleteIfExists(idFile);
  testIdentityReload("Non-existing",reloadCount,idProvider,null,0);
  touchIdentityFile(idFile);
  for (int index=1; index < Byte.SIZE; index++) {
    testIdentityReload("Created iteration " + 1,reloadCount,idProvider,identity,1);
  }
  touchIdentityFile(idFile);
  for (int index=1; index < Byte.SIZE; index++) {
    testIdentityReload("Modified iteration " + 1,reloadCount,idProvider,identity,2);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.client.config.keys.ClientIdentityTest </h4><pre class="type-8 type-10 type-2 type-3 type-14 type-7 type-12 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLoadClientIdentities() throws Exception {
  Assume.assumeTrue("BouncyCastle not registered",SecurityUtils.isBouncyCastleRegistered());
  Path resFolder=getClassResourcesFolder(TEST_SUBFOLDER,getClass());
  LinkOption[] options=IoUtils.getLinkOptions(false);
  Collection<BuiltinIdentities> expected=EnumSet.noneOf(BuiltinIdentities.class);
  for (  BuiltinIdentities type : BuiltinIdentities.VALUES) {
    String fileName=ClientIdentity.getIdentityFileName(type);
    Path file=resFolder.resolve(fileName);
    if (!Files.exists(file,options)) {
      System.out.println("Skip non-existing identity file " + file);
      continue;
    }
    if (!type.isSupported()) {
      System.out.println("Skip unsupported identity file " + file);
      continue;
    }
    expected.add(type);
  }
  Map<String,KeyPair> ids=ClientIdentity.loadDefaultIdentities(resFolder,false,null,options);
  assertEquals("Mismatched loaded ids count",GenericUtils.size(expected),GenericUtils.size(ids));
  Collection<KeyPair> pairs=new ArrayList<KeyPair>(ids.size());
  for (  BuiltinIdentities type : BuiltinIdentities.VALUES) {
    if (expected.contains(type)) {
      KeyPair kp=ids.get(type.getName());
      assertNotNull("No key pair loaded for " + type,kp);
      pairs.add(kp);
    }
  }
  KeyIdentityProvider provider=IdentityUtils.createKeyPairProvider(ids,true);
  assertNotNull("No provider generated",provider);
  Iterable<KeyPair> keys=provider.loadKeys();
  for (  KeyPair kp : keys) {
    assertTrue("Unexpected loaded key: " + kp,pairs.remove(kp));
  }
  assertEquals("Not all pairs listed",0,pairs.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.client.kex.KexTest </h4><pre class="type-10 type-3 type-14 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testClientKeyExchange() throws Exception {
  if (factory.isGroupExchange()) {
    assertEquals(factory.getName() + " not supported even though DH group exchange supported",SecurityUtils.isDHGroupExchangeSupported(),factory.isSupported());
  }
  Assume.assumeTrue(factory.getName() + " not supported",factory.isSupported());
  testClient(ClientBuilder.DH2KEX.transform(factory));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.client.scp.ScpTest </h4><pre class="type-2 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testJschScp() throws Exception {
  com.jcraft.jsch.Session session=getJschSession();
  try {
    String data=getCurrentTestName() + "\n";
    String unixDir="target/scp";
    String fileName=getCurrentTestName() + ".txt";
    String unixPath=unixDir + "/" + fileName;
    File root=new File(unixDir);
    File target=new File(unixPath);
    Utils.deleteRecursive(root);
    root.mkdirs();
    assertTrue(root.exists());
    target.delete();
    assertFalse(target.exists());
    sendFile(session,unixPath,fileName,data);
    assertFileLength(target,data.length(),TimeUnit.SECONDS.toMillis(5L));
    target.delete();
    assertFalse(target.exists());
    sendFile(session,unixDir,fileName,data);
    assertFileLength(target,data.length(),TimeUnit.SECONDS.toMillis(5L));
    sendFileError(session,"target",ScpHelper.SCP_COMMAND_PREFIX,data);
    readFileError(session,unixDir);
    assertEquals("Mismatched file data",data,readFile(session,unixPath,target.length()));
    assertEquals("Mismatched dir data",data,readDir(session,unixDir,fileName,target.length()));
    target.delete();
    root.delete();
    sendDir(session,"target",ScpHelper.SCP_COMMAND_PREFIX,fileName,data);
    assertFileLength(target,data.length(),TimeUnit.SECONDS.toMillis(5L));
  }
  finally {
    session.disconnect();
  }
}

</code></pre>

<br>
<pre class="type-8 type-3 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testStreamsUploadAndDownload() throws Exception {
  try (SshClient client=setupTestClient()){
    client.start();
    try (ClientSession session=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession()){
      session.addPasswordIdentity(getCurrentTestName());
      session.auth().verify(5L,TimeUnit.SECONDS);
      ScpClient scp=createScpClient(session);
      Path targetPath=detectTargetFolder();
      Path parentPath=targetPath.getParent();
      Path scpRoot=Utils.resolve(targetPath,ScpHelper.SCP_COMMAND_PREFIX,getClass().getSimpleName(),getCurrentTestName());
      Utils.deleteRecursive(scpRoot);
      Path remoteDir=assertHierarchyTargetFolderExists(scpRoot.resolve("remote"));
      Path remoteFile=remoteDir.resolve("file.txt");
      String remotePath=Utils.resolveRelativeRemotePath(parentPath,remoteFile);
      byte[] data=(getClass().getName() + "#" + getCurrentTestName()).getBytes(StandardCharsets.UTF_8);
      outputDebugMessage("Upload data to %s",remotePath);
      scp.upload(data,remotePath,EnumSet.allOf(PosixFilePermission.class),null);
      assertFileLength(remoteFile,data.length,TimeUnit.SECONDS.toMillis(5L));
      byte[] uploaded=Files.readAllBytes(remoteFile);
      assertArrayEquals("Mismatched uploaded data",data,uploaded);
      outputDebugMessage("Download data from %s",remotePath);
      byte[] downloaded=scp.downloadBytes(remotePath);
      assertArrayEquals("Mismatched downloaded data",uploaded,downloaded);
    }
  finally {
      client.stop();
    }
  }
 }

</code></pre>

<br>
<pre class="type-8 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testScpDownloadZeroLengthFile() throws Exception {
  Path targetPath=detectTargetFolder();
  Path scpRoot=Utils.resolve(targetPath,ScpHelper.SCP_COMMAND_PREFIX,getClass().getSimpleName(),getCurrentTestName());
  Path localDir=assertHierarchyTargetFolderExists(scpRoot.resolve("local"));
  Path remoteDir=assertHierarchyTargetFolderExists(scpRoot.resolve("remote"));
  Path zeroLocal=localDir.resolve(getCurrentTestName());
  if (Files.exists(zeroLocal)) {
    Files.delete(zeroLocal);
  }
  Path zeroRemote=remoteDir.resolve(zeroLocal.getFileName());
  try (FileChannel fch=FileChannel.open(zeroRemote,StandardOpenOption.CREATE,StandardOpenOption.WRITE,StandardOpenOption.TRUNCATE_EXISTING)){
    if (fch.size() > 0L) {
      fch.truncate(0L);
    }
  }
   assertEquals("Non-zero size for remote file=" + zeroRemote,0L,Files.size(zeroRemote));
  try (SshClient client=setupTestClient()){
    client.start();
    try (ClientSession session=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession()){
      session.addPasswordIdentity(getCurrentTestName());
      session.auth().verify(5L,TimeUnit.SECONDS);
      ScpClient scp=createScpClient(session);
      String remotePath=Utils.resolveRelativeRemotePath(targetPath.getParent(),zeroRemote);
      scp.download(remotePath,zeroLocal.toString());
      assertFileLength(zeroLocal,0L,TimeUnit.SECONDS.toMillis(5L));
    }
  finally {
      client.stop();
    }
  }
 }

</code></pre>

<br>
<pre class="type-8 type-2 type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWithGanymede() throws Exception {
  Path targetPath=detectTargetFolder();
  Path parentPath=targetPath.getParent();
  Path scpRoot=Utils.resolve(targetPath,ScpHelper.SCP_COMMAND_PREFIX,getClass().getSimpleName(),getCurrentTestName());
  Utils.deleteRecursive(scpRoot);
  byte[] expected=(getClass().getName() + "#" + getCurrentTestName()).getBytes(StandardCharsets.UTF_8);
  Path remoteDir=assertHierarchyTargetFolderExists(scpRoot.resolve("remote"));
  String remotePath=Utils.resolveRelativeRemotePath(parentPath,remoteDir);
  String fileName="file.txt";
  Path remoteFile=remoteDir.resolve(fileName);
  String mode=ScpHelper.getOctalPermissions(EnumSet.of(PosixFilePermission.OTHERS_READ,PosixFilePermission.OTHERS_WRITE,PosixFilePermission.GROUP_READ,PosixFilePermission.GROUP_WRITE,PosixFilePermission.OWNER_READ,PosixFilePermission.OWNER_WRITE));
  ch.ethz.ssh2.log.Logger.enabled=true;
  final Connection conn=new Connection(TEST_LOCALHOST,port);
  try {
    ConnectionInfo info=conn.connect(null,(int)TimeUnit.SECONDS.toMillis(5L),(int)TimeUnit.SECONDS.toMillis(11L));
    outputDebugMessage("Connected: kex=%s, key-type=%s, c2senc=%s, s2cenc=%s, c2mac=%s, s2cmac=%s",info.keyExchangeAlgorithm,info.serverHostKeyAlgorithm,info.clientToServerCryptoAlgorithm,info.serverToClientCryptoAlgorithm,info.clientToServerMACAlgorithm,info.serverToClientMACAlgorithm);
    assertTrue("Failed to authenticate",conn.authenticateWithPassword(getCurrentTestName(),getCurrentTestName()));
    final SCPClient scp_client=new SCPClient(conn);
    try (OutputStream output=scp_client.put(fileName,expected.length,remotePath,mode)){
      output.write(expected);
    }
     assertTrue("Remote file not created: " + remoteFile,Files.exists(remoteFile));
    byte[] remoteData=Files.readAllBytes(remoteFile);
    assertArrayEquals("Mismatched remote put data",expected,remoteData);
    Arrays.fill(remoteData,(byte)0);
    try (InputStream input=scp_client.get(remotePath + "/" + fileName)){
      int readLen=input.read(remoteData);
      assertEquals("Mismatched remote get data size",expected.length,readLen);
      assertEquals("Unexpected extra data after read expected size",(-1),input.read());
    }
     assertArrayEquals("Mismatched remote get data",expected,remoteData);
  }
  finally {
    conn.close();
  }
}

</code></pre>

<br>
<pre class="type-11 type-8 type-2 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNormalizedScpRemotePaths() throws Exception {
  Path targetPath=detectTargetFolder();
  Path parentPath=targetPath.getParent();
  Path scpRoot=Utils.resolve(targetPath,ScpHelper.SCP_COMMAND_PREFIX,getClass().getSimpleName(),getCurrentTestName());
  Utils.deleteRecursive(scpRoot);
  Path localDir=assertHierarchyTargetFolderExists(scpRoot.resolve("local"));
  Path localFile=localDir.resolve("file.txt");
  byte[] data=Utils.writeFile(localFile,getClass().getName() + "#" + getCurrentTestName()+ IoUtils.EOL);
  Path remoteDir=assertHierarchyTargetFolderExists(scpRoot.resolve("remote"));
  Path remoteFile=remoteDir.resolve(localFile.getFileName().toString());
  String localPath=localFile.toString();
  String remotePath=Utils.resolveRelativeRemotePath(parentPath,remoteFile);
  String[] remoteComps=GenericUtils.split(remotePath,'/');
  try (SshClient client=setupTestClient()){
    client.start();
    Factory<? extends Random> factory=client.getRandomFactory();
    Random rnd=factory.create();
    try (ClientSession session=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession()){
      session.addPasswordIdentity(getCurrentTestName());
      session.auth().verify(5L,TimeUnit.SECONDS);
      ScpClient scp=createScpClient(session);
      StringBuilder sb=new StringBuilder(remotePath.length() + Long.SIZE);
      for (int i=0; i < Math.max(Long.SIZE,remoteComps.length); i++) {
        if (sb.length() > 0) {
          sb.setLength(0);
        }
        sb.append(remoteComps[0]);
        for (int j=1; j < remoteComps.length; j++) {
          String name=remoteComps[j];
          slashify(sb,rnd);
          sb.append(name);
        }
        slashify(sb,rnd);
        String path=sb.toString();
        scp.upload(localPath,path);
        assertTrue("Remote file not ready for " + path,waitForFile(remoteFile,data.length,TimeUnit.SECONDS.toMillis(5L)));
        byte[] actual=Files.readAllBytes(remoteFile);
        assertArrayEquals("Mismatched uploaded data for " + path,data,actual);
        Files.delete(remoteFile);
        assertFalse("Remote file (" + remoteFile + ") not deleted for "+ path,Files.exists(remoteFile));
      }
    }
   }
 }

</code></pre>

<br>
<pre class="type-8 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testScpUploadZeroLengthFile() throws Exception {
  Path targetPath=detectTargetFolder();
  Path scpRoot=Utils.resolve(targetPath,ScpHelper.SCP_COMMAND_PREFIX,getClass().getSimpleName(),getCurrentTestName());
  Path localDir=assertHierarchyTargetFolderExists(scpRoot.resolve("local"));
  Path remoteDir=assertHierarchyTargetFolderExists(scpRoot.resolve("remote"));
  Path zeroLocal=localDir.resolve("zero.txt");
  try (FileChannel fch=FileChannel.open(zeroLocal,StandardOpenOption.CREATE,StandardOpenOption.WRITE,StandardOpenOption.TRUNCATE_EXISTING)){
    if (fch.size() > 0L) {
      fch.truncate(0L);
    }
  }
   assertEquals("Non-zero size for local file=" + zeroLocal,0L,Files.size(zeroLocal));
  Path zeroRemote=remoteDir.resolve(zeroLocal.getFileName());
  if (Files.exists(zeroRemote)) {
    Files.delete(zeroRemote);
  }
  try (SshClient client=setupTestClient()){
    client.start();
    try (ClientSession session=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession()){
      session.addPasswordIdentity(getCurrentTestName());
      session.auth().verify(5L,TimeUnit.SECONDS);
      ScpClient scp=createScpClient(session);
      String remotePath=Utils.resolveRelativeRemotePath(targetPath.getParent(),zeroRemote);
      scp.upload(zeroLocal.toString(),remotePath);
      assertFileLength(zeroRemote,0L,TimeUnit.SECONDS.toMillis(5L));
    }
  finally {
      client.stop();
    }
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.client.simple.SimpleScpClientTest </h4><pre class="type-8 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testScpDownloadProxy() throws Exception {
  try (CloseableScpClient scp=login()){
    Path scpRoot=Utils.resolve(targetPath,ScpHelper.SCP_COMMAND_PREFIX,getClass().getSimpleName(),getCurrentTestName());
    Utils.deleteRecursive(scpRoot);
    Path remoteDir=assertHierarchyTargetFolderExists(scpRoot.resolve("remote"));
    Path remoteFile=remoteDir.resolve("file.txt");
    String data=getClass().getName() + "#" + getCurrentTestName()+ IoUtils.EOL;
    byte[] written=Utils.writeFile(remoteFile,data);
    Path localDir=assertHierarchyTargetFolderExists(scpRoot.resolve("local"));
    Path localFile=localDir.resolve(remoteFile.getFileName());
    String remotePath=Utils.resolveRelativeRemotePath(parentPath,remoteFile);
    scp.download(remotePath,localFile);
    byte[] downloaded=Files.readAllBytes(localFile);
    assertArrayEquals("Mismatched downloaded data",written,downloaded);
  }
 }

</code></pre>

<br>
<pre class="type-8 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testScpUploadProxy() throws Exception {
  try (CloseableScpClient scp=login()){
    Path scpRoot=Utils.resolve(targetPath,ScpHelper.SCP_COMMAND_PREFIX,getClass().getSimpleName(),getCurrentTestName());
    Utils.deleteRecursive(scpRoot);
    Path localDir=assertHierarchyTargetFolderExists(scpRoot.resolve("local"));
    Path localFile=localDir.resolve("file.txt");
    String data=getClass().getName() + "#" + getCurrentTestName()+ IoUtils.EOL;
    byte[] written=Utils.writeFile(localFile,data);
    Path remoteDir=assertHierarchyTargetFolderExists(scpRoot.resolve("remote"));
    Path remoteFile=remoteDir.resolve(localFile.getFileName());
    String remotePath=Utils.resolveRelativeRemotePath(parentPath,remoteFile);
    scp.upload(localFile,remotePath);
    byte[] uploaded=Files.readAllBytes(remoteFile);
    assertArrayEquals("Mismatched uploaded data",written,uploaded);
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.client.simple.SimpleSessionClientTest </h4><pre class="type-8 type-2 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLoginSessionWithIdentity() throws Exception {
  final KeyPair identity=Utils.getFirstKeyPair(createTestHostKeyProvider());
  final AtomicBoolean identityQueried=new AtomicBoolean(false);
  sshd.setPublickeyAuthenticator(new PublickeyAuthenticator(){
    @Override public boolean authenticate(    String username,    PublicKey key,    ServerSession session){
      if (username.equals(getCurrentTestName())) {
        identityQueried.set(true);
        return KeyUtils.compareKeys(identity.getPublic(),key);
      }
      return false;
    }
  }
);
  sshd.setPasswordAuthenticator(RejectAllPasswordAuthenticator.INSTANCE);
  client.start();
  try (ClientSession session=simple.sessionLogin(TEST_LOCALHOST,port,getCurrentTestName(),identity)){
    assertEquals("Mismatched session username",getCurrentTestName(),session.getUsername());
    assertTrue("User identity not queried",identityQueried.get());
  }
 }

</code></pre>

<br>
<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testLoginSessionWithPassword() throws Exception {
  sshd.setPublickeyAuthenticator(RejectAllPublickeyAuthenticator.INSTANCE);
  client.start();
  try (ClientSession session=simple.sessionLogin(TEST_LOCALHOST,port,getCurrentTestName(),getCurrentTestName())){
    assertEquals("Mismatched session username",getCurrentTestName(),session.getUsername());
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.client.simple.SimpleSftpClientTest </h4><pre class="type-8 type-2 type-3 type-7 type-12 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSftpProxyCalls() throws Exception {
  Path lclSftp=Utils.resolve(targetPath,SftpConstants.SFTP_SUBSYSTEM_NAME,getClass().getSimpleName(),getCurrentTestName());
  Utils.deleteRecursive(lclSftp);
  Path clientFolder=assertHierarchyTargetFolderExists(lclSftp).resolve("client");
  Path clientFile=clientFolder.resolve("file.txt");
  String remoteFileDir=Utils.resolveRelativeRemotePath(parentPath,clientFolder);
  String clientFileName=clientFile.getFileName().toString();
  String remoteFilePath=remoteFileDir + "/" + clientFileName;
  try (SftpClient sftp=login()){
    sftp.mkdir(remoteFileDir);
    byte[] written=(getClass().getSimpleName() + "#" + getCurrentTestName()+ IoUtils.EOL).getBytes(StandardCharsets.UTF_8);
    try (SftpClient.CloseableHandle h=sftp.open(remoteFilePath,EnumSet.of(SftpClient.OpenMode.Write,SftpClient.OpenMode.Create))){
      sftp.write(h,0L,written);
      SftpClient.Attributes attrs=sftp.stat(h);
      assertNotNull("No handle attributes",attrs);
      assertEquals("Mismatched remote file size",written.length,attrs.getSize());
    }
     assertTrue("Remote file not created: " + clientFile,Files.exists(clientFile,IoUtils.EMPTY_LINK_OPTIONS));
    byte[] local=Files.readAllBytes(clientFile);
    assertArrayEquals("Mismatched remote written data",written,local);
    try (SftpClient.CloseableHandle h=sftp.openDir(remoteFileDir)){
      List<SftpClient.DirEntry> dirEntries=sftp.readDir(h);
      assertNotNull("No dir entries",dirEntries);
      boolean matchFound=false;
      for (Iterator<SftpClient.DirEntry> it=dirEntries.iterator(); it.hasNext(); ) {
        SftpClient.DirEntry entry=it.next();
        String name=entry.getFilename();
        if (clientFileName.equals(name)) {
          matchFound=true;
          break;
        }
      }
      assertTrue("No directory entry found for " + clientFileName,matchFound);
    }
     sftp.remove(remoteFilePath);
    assertFalse("Remote file not removed: " + clientFile,Files.exists(clientFile,IoUtils.EMPTY_LINK_OPTIONS));
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.client.subsystem.sftp.DefaultCloseableHandleTest </h4><pre class="type-2 type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testChannelBehavior() throws IOException {
  final byte[] id=getCurrentTestName().getBytes(StandardCharsets.UTF_8);
  SftpClient client=Mockito.mock(SftpClient.class);
  Mockito.doAnswer(new Answer<Void>(){
    @Override public Void answer(    InvocationOnMock invocation) throws Throwable {
      Object[] args=invocation.getArguments();
      Handle handle=(Handle)args[0];
      assertArrayEquals("Mismatched closing handle",id,handle.getIdentifier());
      return null;
    }
  }
).when(client).close(Matchers.any(Handle.class));
  CloseableHandle handle=new DefaultCloseableHandle(client,getCurrentTestName(),id);
  try {
    assertTrue("Handle not initially open",handle.isOpen());
  }
  finally {
    handle.close();
  }
  assertFalse("Handle not marked as closed",handle.isOpen());
  Mockito.verify(client).close(handle);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.client.subsystem.sftp.SftpFileSystemTest </h4><pre class="type-8 type-3 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFileSystemURIParameters() throws Exception {
  Map<String,Object> params=new TreeMap<String,Object>(String.CASE_INSENSITIVE_ORDER);
  params.put("test-class-name",getClass().getSimpleName());
  params.put("test-pkg-name",getClass().getPackage().getName());
  params.put("test-name",getCurrentTestName());
  int expectedVersion=(SftpSubsystem.LOWER_SFTP_IMPL + SftpSubsystem.HIGHER_SFTP_IMPL) / 2;
  params.put(SftpFileSystemProvider.VERSION_PARAM,Integer.valueOf(expectedVersion));
  try (SftpFileSystem fs=(SftpFileSystem)FileSystems.newFileSystem(createDefaultFileSystemURI(params),Collections.<String,Object>emptyMap())){
    try (SftpClient sftpClient=fs.getClient()){
      assertEquals("Mismatched negotiated version",expectedVersion,sftpClient.getVersion());
      Session session=sftpClient.getClientSession();
      for (      Map.Entry<String,?> pe : params.entrySet()) {
        String key=pe.getKey();
        Object expected=pe.getValue();
        if (SftpFileSystemProvider.VERSION_PARAM.equalsIgnoreCase(key)) {
          continue;
        }
        Object actual=PropertyResolverUtils.getObject(session,key);
        assertEquals("Mismatched value for param '" + key + "'",expected,actual);
      }
    }
   }
 }

</code></pre>

<br>
<pre class="type-8 type-2 type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSftpVersionSelector() throws Exception {
  final AtomicInteger selected=new AtomicInteger(-1);
  SftpVersionSelector selector=new SftpVersionSelector(){
    @Override public int selectVersion(    int current,    List<Integer> available){
      int numAvailable=GenericUtils.size(available);
      Integer maxValue=null;
      if (numAvailable == 1) {
        maxValue=available.get(0);
      }
 else {
        for (        Integer v : available) {
          if (v.intValue() == current) {
            continue;
          }
          if ((maxValue == null) || (maxValue.intValue() < v.intValue())) {
            maxValue=v;
          }
        }
      }
      selected.set(maxValue.intValue());
      return selected.get();
    }
  }
;
  try (SshClient client=setupTestClient()){
    client.start();
    try (ClientSession session=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession()){
      session.addPasswordIdentity(getCurrentTestName());
      session.auth().verify(5L,TimeUnit.SECONDS);
      try (FileSystem fs=session.createSftpFileSystem(selector)){
        assertTrue("Not an SftpFileSystem",fs instanceof SftpFileSystem);
        Collection<String> views=fs.supportedFileAttributeViews();
        assertTrue("Universal views (" + SftpFileSystem.UNIVERSAL_SUPPORTED_VIEWS + ") not supported: "+ views,views.containsAll(SftpFileSystem.UNIVERSAL_SUPPORTED_VIEWS));
        int expectedVersion=selected.get();
        assertEquals("Mismatched negotiated version",expectedVersion,((SftpFileSystem)fs).getVersion());
        testFileSystem(fs,expectedVersion);
      }
     }
  finally {
      client.stop();
    }
  }
 }

</code></pre>

<br>
<pre class="type-8 type-2 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFileStore() throws IOException {
  try (FileSystem fs=FileSystems.newFileSystem(createDefaultFileSystemURI(),Collections.<String,Object>emptyMap())){
    Iterable<FileStore> iter=fs.getFileStores();
    assertTrue("Not a list",iter instanceof List<?>);
    List<FileStore> list=(List<FileStore>)iter;
    assertEquals("Mismatched stores count",1,list.size());
    FileStore store=list.get(0);
    assertEquals("Mismatched type",SftpConstants.SFTP_SUBSYSTEM_NAME,store.type());
    assertFalse("Read-only ?",store.isReadOnly());
    for (    String name : fs.supportedFileAttributeViews()) {
      assertTrue("Unsupported view name: " + name,store.supportsFileAttributeView(name));
    }
    for (    Class<? extends FileAttributeView> type : SftpFileSystemProvider.UNIVERSAL_SUPPORTED_VIEWS) {
      assertTrue("Unsupported view type: " + type.getSimpleName(),store.supportsFileAttributeView(type));
    }
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.client.subsystem.sftp.SftpTest </h4><pre class="type-8 type-2 type-3 type-15 type-14 type-7 type-12 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCreateSymbolicLink() throws Exception {
  Assume.assumeTrue("Skip non-Unix O/S",OsUtils.isUNIX());
  List<NamedFactory<Command>> factories=sshd.getSubsystemFactories();
  assertEquals("Mismatched subsystem factories count",1,GenericUtils.size(factories));
  NamedFactory<Command> f=factories.get(0);
  assertObjectInstanceOf("Not an SFTP subsystem factory",SftpSubsystemFactory.class,f);
  SftpSubsystemFactory factory=(SftpSubsystemFactory)f;
  final AtomicReference<LinkData> linkDataHolder=new AtomicReference<>();
  factory.addSftpEventListener(new AbstractSftpEventListenerAdapter(){
    @Override public void linking(    ServerSession session,    Path src,    Path target,    boolean symLink){
      assertNull("Multiple linking calls",linkDataHolder.getAndSet(new LinkData(src,target,symLink)));
    }
    @Override public void linked(    ServerSession session,    Path src,    Path target,    boolean symLink,    Throwable thrown){
      LinkData data=linkDataHolder.get();
      assertNotNull("No previous linking call",data);
      assertSame("Mismatched source",data.getSource(),src);
      assertSame("Mismatched target",data.getTarget(),target);
      assertEquals("Mismatched link type",data.isSymLink(),symLink);
      assertNull("Unexpected failure",thrown);
    }
  }
);
  Path targetPath=detectTargetFolder();
  Path lclSftp=Utils.resolve(targetPath,SftpConstants.SFTP_SUBSYSTEM_NAME,getClass().getSimpleName(),getCurrentTestName());
  Utils.deleteRecursive(lclSftp);
  Path parentPath=targetPath.getParent();
  Path sourcePath=assertHierarchyTargetFolderExists(lclSftp).resolve("src.txt");
  String remSrcPath="/" + Utils.resolveRelativeRemotePath(parentPath,sourcePath);
  String data=getCurrentTestName();
  ChannelSftp c=(ChannelSftp)session.openChannel(SftpConstants.SFTP_SUBSYSTEM_NAME);
  c.connect();
  try {
    try (InputStream dataStream=new ByteArrayInputStream(data.getBytes(StandardCharsets.UTF_8))){
      c.put(dataStream,remSrcPath);
    }
     assertTrue("Source file not created: " + sourcePath,Files.exists(sourcePath));
    assertEquals("Mismatched stored data in " + remSrcPath,data,readFile(remSrcPath));
    Path linkPath=lclSftp.resolve("link-" + sourcePath.getFileName());
    String remLinkPath="/" + Utils.resolveRelativeRemotePath(parentPath,linkPath);
    LinkOption[] options=IoUtils.getLinkOptions(false);
    if (Files.exists(linkPath,options)) {
      Files.delete(linkPath);
    }
    assertFalse("Target link exists before linking: " + linkPath,Files.exists(linkPath,options));
    outputDebugMessage("Symlink %s => %s",remLinkPath,remSrcPath);
    c.symlink(remSrcPath,remLinkPath);
    assertTrue("Symlink not created: " + linkPath,Files.exists(linkPath,options));
    assertEquals("Mismatched link data in " + remLinkPath,data,readFile(remLinkPath));
    String str1=c.readlink(remLinkPath);
    String str2=c.realpath(remSrcPath);
    assertEquals("Mismatched link vs. real path",str1,str2);
  }
  finally {
    c.disconnect();
  }
  assertNotNull("No symlink signalled",linkDataHolder.getAndSet(null));
}

</code></pre>

<br>
<pre class="type-8 type-10 type-6 type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCannotEscapeUserRoot() throws Exception {
  Path targetPath=detectTargetFolder();
  Path lclSftp=Utils.resolve(targetPath,SftpConstants.SFTP_SUBSYSTEM_NAME,getClass().getSimpleName(),getCurrentTestName());
  assertHierarchyTargetFolderExists(lclSftp);
  sshd.setFileSystemFactory(new VirtualFileSystemFactory(lclSftp));
  try (SshClient client=setupTestClient()){
    client.start();
    try (ClientSession session=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession()){
      session.addPasswordIdentity(getCurrentTestName());
      session.auth().verify(5L,TimeUnit.SECONDS);
      String escapePath=targetPath.toString();
      if (OsUtils.isWin32()) {
        escapePath="/" + escapePath.replace(File.separatorChar,'/');
      }
      try (SftpClient sftp=session.createSftpClient()){
        SftpClient.Attributes attrs=sftp.stat(escapePath);
        fail("Unexpected escape success for path=" + escapePath + ": "+ attrs);
      }
 catch (      SftpException e) {
        if (OsUtils.isWin32()) {
          assertEquals("Mismatched status for " + escapePath,SftpConstants.getStatusName(SftpConstants.SSH_FX_INVALID_FILENAME),SftpConstants.getStatusName(e.getStatus()));
        }
 else {
          assertEquals("Mismatched status for " + escapePath,SftpConstants.getStatusName(SftpConstants.SSH_FX_NO_SUCH_FILE),SftpConstants.getStatusName(e.getStatus()));
        }
      }
    }
  finally {
      client.stop();
    }
  }
 }

</code></pre>

<br>
<pre class="type-8 type-3 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSftpVersionSelector() throws Exception {
  final AtomicInteger selected=new AtomicInteger(-1);
  SftpVersionSelector selector=new SftpVersionSelector(){
    @Override public int selectVersion(    int current,    List<Integer> available){
      int numAvailable=GenericUtils.size(available);
      Integer maxValue=null;
      if (numAvailable == 1) {
        maxValue=available.get(0);
      }
 else {
        for (        Integer v : available) {
          if (v.intValue() == current) {
            continue;
          }
          if ((maxValue == null) || (maxValue.intValue() < v.intValue())) {
            maxValue=v;
          }
        }
      }
      selected.set(maxValue.intValue());
      return selected.get();
    }
  }
;
  try (SshClient client=setupTestClient()){
    client.start();
    try (ClientSession session=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession()){
      session.addPasswordIdentity(getCurrentTestName());
      session.auth().verify(5L,TimeUnit.SECONDS);
      try (SftpClient sftp=session.createSftpClient(selector)){
        assertEquals("Mismatched negotiated version",selected.get(),sftp.getVersion());
        testClient(client,sftp);
      }
     }
  finally {
      client.stop();
    }
  }
 }

</code></pre>

<br>
<pre class="type-8 type-10 type-2 type-3 type-7 type-12 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testServerExtensionsDeclarations() throws Exception {
  try (SshClient client=setupTestClient()){
    client.start();
    try (ClientSession session=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession()){
      session.addPasswordIdentity(getCurrentTestName());
      session.auth().verify(5L,TimeUnit.SECONDS);
      try (SftpClient sftp=session.createSftpClient()){
        Map<String,byte[]> extensions=sftp.getServerExtensions();
        for (        String name : new String[]{SftpConstants.EXT_NEWLINE,SftpConstants.EXT_VERSIONS,SftpConstants.EXT_VENDOR_ID,SftpConstants.EXT_ACL_SUPPORTED,SftpConstants.EXT_SUPPORTED,SftpConstants.EXT_SUPPORTED2}) {
          assertTrue("Missing extension=" + name,extensions.containsKey(name));
        }
        Map<String,?> data=ParserUtils.parse(extensions);
        for (        Map.Entry<String,?> de : data.entrySet()) {
          String extName=de.getKey();
          Object extValue=de.getValue();
          outputDebugMessage("%s: %s",extName,extValue);
          if (SftpConstants.EXT_SUPPORTED.equalsIgnoreCase(extName)) {
            assertSupportedExtensions(extName,((Supported)extValue).extensionNames);
          }
 else           if (SftpConstants.EXT_SUPPORTED2.equalsIgnoreCase(extName)) {
            assertSupportedExtensions(extName,((Supported2)extValue).extensionNames);
          }
 else           if (SftpConstants.EXT_ACL_SUPPORTED.equalsIgnoreCase(extName)) {
            assertSupportedAclCapabilities((AclCapabilities)extValue);
          }
 else           if (SftpConstants.EXT_VERSIONS.equalsIgnoreCase(extName)) {
            assertSupportedVersions((Versions)extValue);
          }
 else           if (SftpConstants.EXT_NEWLINE.equalsIgnoreCase(extName)) {
            assertNewlineValue((Newline)extValue);
          }
        }
        for (        String extName : extensions.keySet()) {
          if (!data.containsKey(extName)) {
            outputDebugMessage("No parser for extension=%s",extName);
          }
        }
        for (        OpenSSHExtension expected : SftpSubsystem.DEFAULT_OPEN_SSH_EXTENSIONS) {
          String name=expected.getName();
          Object value=data.get(name);
          assertNotNull("OpenSSH extension not declared: " + name,value);
          OpenSSHExtension actual=(OpenSSHExtension)value;
          assertEquals("Mismatched version for OpenSSH extension=" + name,expected.getVersion(),actual.getVersion());
        }
        for (        BuiltinSftpClientExtensions type : BuiltinSftpClientExtensions.VALUES) {
          String extensionName=type.getName();
          boolean isOpenSSHExtension=extensionName.endsWith("@openssh.com");
          SftpClientExtension instance=sftp.getExtension(extensionName);
          assertNotNull("Extension not implemented:" + extensionName,instance);
          assertEquals("Mismatched instance name",extensionName,instance.getName());
          if (instance.isSupported()) {
            if (isOpenSSHExtension) {
              assertTrue("Unlisted default OpenSSH extension: " + extensionName,SftpSubsystem.DEFAULT_OPEN_SSH_EXTENSIONS_NAMES.contains(extensionName));
            }
          }
 else {
            assertTrue("Unsupported non-OpenSSH extension: " + extensionName,isOpenSSHExtension);
            assertFalse("Unsupported default OpenSSH extension: " + extensionName,SftpSubsystem.DEFAULT_OPEN_SSH_EXTENSIONS_NAMES.contains(extensionName));
          }
        }
      }
     }
  finally {
      client.stop();
    }
  }
 }

</code></pre>

<br>
<pre class="type-2 type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testClient() throws Exception {
  List<NamedFactory<Command>> factories=sshd.getSubsystemFactories();
  assertEquals("Mismatched subsystem factories count",1,GenericUtils.size(factories));
  NamedFactory<Command> f=factories.get(0);
  assertObjectInstanceOf("Not an SFTP subsystem factory",SftpSubsystemFactory.class,f);
  SftpSubsystemFactory factory=(SftpSubsystemFactory)f;
  final AtomicInteger versionHolder=new AtomicInteger(-1);
  final AtomicInteger openCount=new AtomicInteger(0);
  final AtomicInteger closeCount=new AtomicInteger(0);
  final AtomicLong readSize=new AtomicLong(0L);
  final AtomicLong writeSize=new AtomicLong(0L);
  final AtomicInteger entriesCount=new AtomicInteger(0);
  final AtomicInteger creatingCount=new AtomicInteger(0);
  final AtomicInteger createdCount=new AtomicInteger(0);
  final AtomicInteger removingCount=new AtomicInteger(0);
  final AtomicInteger removedCount=new AtomicInteger(0);
  final AtomicInteger modifyingCount=new AtomicInteger(0);
  final AtomicInteger modifiedCount=new AtomicInteger(0);
  factory.addSftpEventListener(new SftpEventListener(){
    private final Logger log=LoggerFactory.getLogger(SftpEventListener.class);
    @Override public void initialized(    ServerSession session,    int version){
      log.info("initialized(" + session + ") version: "+ version);
      assertTrue("Initialized version below minimum",version >= SftpSubsystem.LOWER_SFTP_IMPL);
      assertTrue("Initialized version above maximum",version <= SftpSubsystem.HIGHER_SFTP_IMPL);
      assertTrue("Initializion re-called",versionHolder.getAndSet(version) < 0);
    }
    @Override public void destroying(    ServerSession session){
      log.info("destroying(" + session + ")");
      assertTrue("Initialization method not called",versionHolder.get() > 0);
    }
    @Override public void write(    ServerSession session,    String remoteHandle,    FileHandle localHandle,    long offset,    byte[] data,    int dataOffset,    int dataLen){
      writeSize.addAndGet(dataLen);
      if (log.isDebugEnabled()) {
        log.debug("write(" + session + ")["+ localHandle.getFile()+ "] offset="+ offset+ ", requested="+ dataLen);
      }
    }
    @Override public void removing(    ServerSession session,    Path path){
      removingCount.incrementAndGet();
      log.info("removing(" + session + ") "+ path);
    }
    @Override public void removed(    ServerSession session,    Path path,    Throwable thrown){
      removedCount.incrementAndGet();
      log.info("removed(" + session + ") "+ path+ ((thrown == null) ? "" : (": " + thrown.getClass().getSimpleName() + ": "+ thrown.getMessage())));
    }
    @Override public void modifyingAttributes(    ServerSession session,    Path path,    Map<String,?> attrs){
      modifyingCount.incrementAndGet();
      log.info("modifyingAttributes(" + session + ") "+ path);
    }
    @Override public void modifiedAttributes(    ServerSession session,    Path path,    Map<String,?> attrs,    Throwable thrown){
      modifiedCount.incrementAndGet();
      log.info("modifiedAttributes(" + session + ") "+ path+ ((thrown == null) ? "" : (": " + thrown.getClass().getSimpleName() + ": "+ thrown.getMessage())));
    }
    @Override public void read(    ServerSession session,    String remoteHandle,    FileHandle localHandle,    long offset,    byte[] data,    int dataOffset,    int dataLen,    int readLen){
      readSize.addAndGet(readLen);
      if (log.isDebugEnabled()) {
        log.debug("read(" + session + ")["+ localHandle.getFile()+ "] offset="+ offset+ ", requested="+ dataLen+ ", read="+ readLen);
      }
    }
    @Override public void read(    ServerSession session,    String remoteHandle,    DirectoryHandle localHandle,    Map<String,Path> entries){
      int numEntries=GenericUtils.size(entries);
      entriesCount.addAndGet(numEntries);
      if (log.isDebugEnabled()) {
        log.debug("read(" + session + ")["+ localHandle.getFile()+ "] "+ numEntries+ " entries");
      }
      if ((numEntries > 0) && log.isTraceEnabled()) {
        for (        Map.Entry<String,Path> ee : entries.entrySet()) {
          log.trace("read(" + session + ")["+ localHandle.getFile()+ "] "+ ee.getKey()+ " - "+ ee.getValue());
        }
      }
    }
    @Override public void open(    ServerSession session,    String remoteHandle,    Handle localHandle){
      Path path=localHandle.getFile();
      log.info("open(" + session + ")["+ remoteHandle+ "] "+ (Files.isDirectory(path) ? "directory" : "file")+ " "+ path);
      openCount.incrementAndGet();
    }
    @Override public void moving(    ServerSession session,    Path srcPath,    Path dstPath,    Collection<CopyOption> opts){
      log.info("moving(" + session + ")["+ opts+ "]"+ srcPath+ " => "+ dstPath);
    }
    @Override public void moved(    ServerSession session,    Path srcPath,    Path dstPath,    Collection<CopyOption> opts,    Throwable thrown){
      log.info("moved(" + session + ")["+ opts+ "]"+ srcPath+ " => "+ dstPath+ ((thrown == null) ? "" : (": " + thrown.getClass().getSimpleName() + ": "+ thrown.getMessage())));
    }
    @Override public void linking(    ServerSession session,    Path src,    Path target,    boolean symLink){
      log.info("linking(" + session + ")["+ symLink+ "]"+ src+ " => "+ target);
    }
    @Override public void linked(    ServerSession session,    Path src,    Path target,    boolean symLink,    Throwable thrown){
      log.info("linked(" + session + ")["+ symLink+ "]"+ src+ " => "+ target+ ((thrown == null) ? "" : (": " + thrown.getClass().getSimpleName() + ": "+ thrown.getMessage())));
    }
    @Override public void creating(    ServerSession session,    Path path,    Map<String,?> attrs){
      creatingCount.incrementAndGet();
      log.info("creating(" + session + ") "+ (Files.isDirectory(path) ? "directory" : "file")+ " "+ path);
    }
    @Override public void created(    ServerSession session,    Path path,    Map<String,?> attrs,    Throwable thrown){
      createdCount.incrementAndGet();
      log.info("created(" + session + ") "+ (Files.isDirectory(path) ? "directory" : "file")+ " "+ path+ ((thrown == null) ? "" : (": " + thrown.getClass().getSimpleName() + ": "+ thrown.getMessage())));
    }
    @Override public void blocking(    ServerSession session,    String remoteHandle,    FileHandle localHandle,    long offset,    long length,    int mask){
      log.info("blocking(" + session + ")["+ localHandle.getFile()+ "]"+ " offset="+ offset+ ", length="+ length+ ", mask=0x"+ Integer.toHexString(mask));
    }
    @Override public void blocked(    ServerSession session,    String remoteHandle,    FileHandle localHandle,    long offset,    long length,    int mask,    Throwable thrown){
      log.info("blocked(" + session + ")["+ localHandle.getFile()+ "]"+ " offset="+ offset+ ", length="+ length+ ", mask=0x"+ Integer.toHexString(mask)+ ((thrown == null) ? "" : (": " + thrown.getClass().getSimpleName() + ": "+ thrown.getMessage())));
    }
    @Override public void unblocking(    ServerSession session,    String remoteHandle,    FileHandle localHandle,    long offset,    long length){
      log.info("unblocking(" + session + ")["+ localHandle.getFile()+ "] offset="+ offset+ ", length="+ length);
    }
    @Override public void unblocked(    ServerSession session,    String remoteHandle,    FileHandle localHandle,    long offset,    long length,    Boolean result,    Throwable thrown){
      log.info("unblocked(" + session + ")["+ localHandle.getFile()+ "]"+ " offset="+ offset+ ", length="+ length+ ", result="+ result+ ((thrown == null) ? "" : (": " + thrown.getClass().getSimpleName() + ": "+ thrown.getMessage())));
    }
    @Override public void close(    ServerSession session,    String remoteHandle,    Handle localHandle){
      Path path=localHandle.getFile();
      log.info("close(" + session + ")["+ remoteHandle+ "] "+ (Files.isDirectory(path) ? "directory" : "file")+ " "+ path);
      closeCount.incrementAndGet();
    }
  }
);
  try (SshClient client=setupTestClient()){
    client.start();
    try (ClientSession session=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession()){
      session.addPasswordIdentity(getCurrentTestName());
      session.auth().verify(5L,TimeUnit.SECONDS);
      try (SftpClient sftp=session.createSftpClient()){
        assertEquals("Mismatched negotiated version",sftp.getVersion(),versionHolder.get());
        testClient(client,sftp);
      }
       assertEquals("Mismatched open/close count",openCount.get(),closeCount.get());
      assertTrue("No entries read",entriesCount.get() > 0);
      assertTrue("No data read",readSize.get() > 0L);
      assertTrue("No data written",writeSize.get() > 0L);
      assertEquals("Mismatched removal counts",removingCount.get(),removedCount.get());
      assertTrue("No removals signalled",removedCount.get() > 0);
      assertEquals("Mismatched creation counts",creatingCount.get(),createdCount.get());
      assertTrue("No creations signalled",creatingCount.get() > 0);
      assertEquals("Mismatched modification counts",modifyingCount.get(),modifiedCount.get());
      assertTrue("No modifications signalled",modifiedCount.get() > 0);
    }
  finally {
      client.stop();
    }
  }
 }

</code></pre>

<br>
<pre class="type-11 type-8 type-3 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNormalizeRemoteRootValues() throws Exception {
  try (SshClient client=setupTestClient()){
    client.start();
    try (ClientSession session=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession()){
      session.addPasswordIdentity(getCurrentTestName());
      session.auth().verify(5L,TimeUnit.SECONDS);
      try (SftpClient sftp=session.createSftpClient()){
        StringBuilder sb=new StringBuilder(Long.SIZE + 1);
        String expected=sftp.canonicalPath("/");
        for (int i=0; i < Long.SIZE; i++) {
          if (sb.length() > 0) {
            sb.setLength(0);
          }
          for (int j=1; j <= i; j++) {
            sb.append('/');
          }
          String remotePath=sb.toString();
          String actual=sftp.canonicalPath(remotePath);
          assertEquals("Mismatched roots for " + remotePath.length() + " slashes",expected,actual);
        }
      }
     }
  finally {
      client.stop();
    }
  }
 }

</code></pre>

<br>
<pre class="type-11 type-8 type-3 type-7 type-13 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testNormalizeRemotePathsValues() throws Exception {
  Path targetPath=detectTargetFolder();
  Path parentPath=targetPath.getParent();
  Path lclSftp=Utils.resolve(targetPath,SftpConstants.SFTP_SUBSYSTEM_NAME,getClass().getSimpleName(),getCurrentTestName());
  Path testFile=assertHierarchyTargetFolderExists(lclSftp).resolve("file.txt");
  String file=Utils.resolveRelativeRemotePath(parentPath,testFile);
  String[] comps=GenericUtils.split(file,'/');
  try (SshClient client=setupTestClient()){
    client.start();
    Factory<? extends Random> factory=client.getRandomFactory();
    Random rnd=factory.create();
    try (ClientSession session=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession()){
      session.addPasswordIdentity(getCurrentTestName());
      session.auth().verify(5L,TimeUnit.SECONDS);
      try (SftpClient sftp=session.createSftpClient()){
        StringBuilder sb=new StringBuilder(file.length() + comps.length);
        String expected=sftp.canonicalPath(file);
        for (int i=0; i < file.length(); i++) {
          if (sb.length() > 0) {
            sb.setLength(0);
          }
          sb.append(comps[0]);
          for (int j=1; j < comps.length; j++) {
            String name=comps[j];
            slashify(sb,rnd);
            sb.append(name);
          }
          slashify(sb,rnd);
          if (rnd.random(Byte.SIZE) < (Byte.SIZE / 2)) {
            sb.append('.');
          }
          String remotePath=sb.toString();
          String actual=sftp.canonicalPath(remotePath);
          assertEquals("Mismatched canonical value for " + remotePath,expected,actual);
        }
      }
     }
  finally {
      client.stop();
    }
  }
 }

</code></pre>

<br>
<pre class="type-8 type-2 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadWriteWithOffset() throws Exception {
  Path targetPath=detectTargetFolder();
  Path lclSftp=Utils.resolve(targetPath,SftpConstants.SFTP_SUBSYSTEM_NAME,getClass().getSimpleName(),getCurrentTestName());
  Utils.deleteRecursive(lclSftp);
  Path localPath=assertHierarchyTargetFolderExists(lclSftp).resolve("file.txt");
  String remotePath=Utils.resolveRelativeRemotePath(targetPath.getParent(),localPath);
  String data=getCurrentTestName();
  String extraData="@" + getClass().getSimpleName();
  int appendOffset=-5;
  ChannelSftp c=(ChannelSftp)session.openChannel(SftpConstants.SFTP_SUBSYSTEM_NAME);
  c.connect();
  try {
    c.put(new ByteArrayInputStream(data.getBytes(StandardCharsets.UTF_8)),remotePath);
    assertTrue("Remote file not created after initial write: " + localPath,Files.exists(localPath));
    assertEquals("Mismatched data read from " + remotePath,data,readFile(remotePath));
    try (OutputStream os=c.put(remotePath,null,ChannelSftp.APPEND,appendOffset)){
      os.write(extraData.getBytes(StandardCharsets.UTF_8));
    }
   }
  finally {
    c.disconnect();
  }
  assertTrue("Remote file not created after data update: " + localPath,Files.exists(localPath));
  String expected=data.substring(0,data.length() + appendOffset) + extraData;
  String actual=readFile(remotePath);
  assertEquals("Mismatched final file data in " + remotePath,expected,actual);
}

</code></pre>

<br>
<pre class="type-8 type-6 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRename() throws Exception {
  Path targetPath=detectTargetFolder();
  Path lclSftp=Utils.resolve(targetPath,SftpConstants.SFTP_SUBSYSTEM_NAME,getClass().getSimpleName(),getCurrentTestName());
  Utils.deleteRecursive(lclSftp);
  Path parentPath=targetPath.getParent();
  Path clientFolder=assertHierarchyTargetFolderExists(lclSftp.resolve("client"));
  try (SshClient client=setupTestClient()){
    client.start();
    try (ClientSession session=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession()){
      session.addPasswordIdentity(getCurrentTestName());
      session.auth().verify(5L,TimeUnit.SECONDS);
      try (SftpClient sftp=session.createSftpClient()){
        Path file1=clientFolder.resolve("file-1.txt");
        String file1Path=Utils.resolveRelativeRemotePath(parentPath,file1);
        try (OutputStream os=sftp.write(file1Path,SftpClient.MIN_WRITE_BUFFER_SIZE)){
          os.write((getCurrentTestName() + "\n").getBytes(StandardCharsets.UTF_8));
        }
         Path file2=clientFolder.resolve("file-2.txt");
        String file2Path=Utils.resolveRelativeRemotePath(parentPath,file2);
        Path file3=clientFolder.resolve("file-3.txt");
        String file3Path=Utils.resolveRelativeRemotePath(parentPath,file3);
        try {
          sftp.rename(file2Path,file3Path);
          fail("Unxpected rename success of " + file2Path + " => "+ file3Path);
        }
 catch (        org.apache.sshd.common.subsystem.sftp.SftpException e) {
          assertEquals("Mismatched status for failed rename of " + file2Path + " => "+ file3Path,SftpConstants.SSH_FX_NO_SUCH_FILE,e.getStatus());
        }
        try (OutputStream os=sftp.write(file2Path,SftpClient.MIN_WRITE_BUFFER_SIZE)){
          os.write("h".getBytes(StandardCharsets.UTF_8));
        }
         try {
          sftp.rename(file1Path,file2Path);
          fail("Unxpected rename success of " + file1Path + " => "+ file2Path);
        }
 catch (        org.apache.sshd.common.subsystem.sftp.SftpException e) {
          assertEquals("Mismatched status for failed rename of " + file1Path + " => "+ file2Path,SftpConstants.SSH_FX_FILE_ALREADY_EXISTS,e.getStatus());
        }
        sftp.rename(file1Path,file2Path,SftpClient.CopyMode.Overwrite);
      }
     }
  finally {
      client.stop();
    }
  }
 }

</code></pre>

<br>
<pre class="type-8 type-6 type-2 type-3 type-7 type-13 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testOpen() throws Exception {
  Path targetPath=detectTargetFolder();
  Path parentPath=targetPath.getParent();
  Path lclSftp=Utils.resolve(targetPath,SftpConstants.SFTP_SUBSYSTEM_NAME,getClass().getSimpleName(),getCurrentTestName());
  Path clientFolder=lclSftp.resolve("client");
  Path testFile=clientFolder.resolve("file.txt");
  String file=Utils.resolveRelativeRemotePath(parentPath,testFile);
  File javaFile=testFile.toFile();
  assertHierarchyTargetFolderExists(javaFile.getParentFile());
  try (SshClient client=setupTestClient()){
    client.start();
    try (ClientSession session=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession()){
      session.addPasswordIdentity(getCurrentTestName());
      session.auth().verify(5L,TimeUnit.SECONDS);
      javaFile.createNewFile();
      javaFile.setWritable(false,false);
      javaFile.setReadable(false,false);
      try (SftpClient sftp=session.createSftpClient()){
        boolean isWindows=OsUtils.isWin32();
        try (SftpClient.CloseableHandle h=sftp.open(file)){
          assertTrue("Empty read should have failed on " + file,isWindows);
        }
 catch (        IOException e) {
          if (isWindows) {
            throw e;
          }
        }
        try (SftpClient.CloseableHandle h=sftp.open(file,EnumSet.of(SftpClient.OpenMode.Write))){
          fail("Empty write should have failed on " + file);
        }
 catch (        IOException e) {
        }
        try (SftpClient.CloseableHandle h=sftp.open(file,EnumSet.of(SftpClient.OpenMode.Truncate))){
          assertTrue("Empty truncate should have failed on " + file,isWindows);
        }
 catch (        IOException e) {
        }
        int perms=sftp.stat(file).getPermissions();
        int permsMask=SftpConstants.S_IWUSR | (isWindows ? 0 : SftpConstants.S_IRUSR);
        assertEquals("Mismatched permissions for " + file + ": 0x"+ Integer.toHexString(perms),0,(perms & permsMask));
        javaFile.setWritable(true,false);
        try (SftpClient.CloseableHandle h=sftp.open(file,EnumSet.of(SftpClient.OpenMode.Truncate,SftpClient.OpenMode.Write))){
          assertTrue("Handle not marked as open for file=" + file,h.isOpen());
        }
         byte[] d="0123456789\n".getBytes(StandardCharsets.UTF_8);
        try (SftpClient.CloseableHandle h=sftp.open(file,EnumSet.of(SftpClient.OpenMode.Write))){
          sftp.write(h,0,d,0,d.length);
          sftp.write(h,d.length,d,0,d.length);
        }
         try (SftpClient.CloseableHandle h=sftp.open(file,EnumSet.of(SftpClient.OpenMode.Write))){
          sftp.write(h,d.length * 2,d,0,d.length);
        }
         try (SftpClient.CloseableHandle h=sftp.open(file,EnumSet.of(SftpClient.OpenMode.Write))){
          byte[] overwrite="-".getBytes(StandardCharsets.UTF_8);
          sftp.write(h,3L,overwrite,0,1);
          d[3]=overwrite[0];
        }
         try (SftpClient.CloseableHandle h=sftp.open(file)){
          assertTrue("Data read should have failed on " + file,isWindows);
        }
 catch (        IOException e) {
          if (isWindows) {
            throw e;
          }
        }
        javaFile.setReadable(true,false);
        byte[] buf=new byte[3];
        try (SftpClient.CloseableHandle h=sftp.open(file)){
          int l=sftp.read(h,2L,buf,0,buf.length);
          String expected=new String(d,2,l,StandardCharsets.UTF_8);
          String actual=new String(buf,0,l,StandardCharsets.UTF_8);
          assertEquals("Mismatched read data",expected,actual);
        }
       }
     }
  finally {
      client.stop();
    }
  }
 }

</code></pre>

<br>
<pre class="type-11 type-8 type-10 type-6 type-3 type-7 type-13 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadBufferLimit() throws Exception {
  Path targetPath=detectTargetFolder();
  Path parentPath=targetPath.getParent();
  Path lclSftp=Utils.resolve(targetPath,SftpConstants.SFTP_SUBSYSTEM_NAME,getClass().getSimpleName(),getCurrentTestName());
  Path testFile=assertHierarchyTargetFolderExists(lclSftp).resolve("file.txt");
  byte[] expected=new byte[1024];
  Factory<? extends Random> factory=sshd.getRandomFactory();
  Random rnd=factory.create();
  rnd.fill(expected);
  Files.write(testFile,expected);
  try (SshClient client=setupTestClient()){
    client.start();
    try (ClientSession session=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession()){
      session.addPasswordIdentity(getCurrentTestName());
      session.auth().verify(5L,TimeUnit.SECONDS);
      try (SftpClient sftp=session.createSftpClient()){
        String file=Utils.resolveRelativeRemotePath(parentPath,testFile);
        byte[] actual=new byte[expected.length];
        int maxAllowed=actual.length / 4;
        PropertyResolverUtils.updateProperty(sshd,SftpSubsystem.MAX_PACKET_LENGTH_PROP,maxAllowed);
        try (CloseableHandle handle=sftp.open(file,OpenMode.Read)){
          int readLen=sftp.read(handle,0L,actual);
          assertEquals("Mismatched read len",maxAllowed,readLen);
          for (int index=0; index < readLen; index++) {
            byte expByte=expected[index], actByte=actual[index];
            if (expByte != actByte) {
              fail("Mismatched values at index=" + index + ": expected=0x"+ Integer.toHexString(expByte & 0xFF)+ ", actual=0x"+ Integer.toHexString(actByte & 0xFF));
            }
          }
        }
       }
     }
  finally {
      client.stop();
    }
  }
 }

</code></pre>

<br>
<pre class="type-3 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNavigateBeyondRootFolder() throws Exception {
  Path rootLocation=Paths.get(OsUtils.isUNIX() ? "/" : "C:\\");
  final FileSystem fsRoot=rootLocation.getFileSystem();
  sshd.setFileSystemFactory(new FileSystemFactory(){
    @Override public FileSystem createFileSystem(    Session session) throws IOException {
      return fsRoot;
    }
  }
);
  try (SshClient client=setupTestClient()){
    client.start();
    try (ClientSession session=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession()){
      session.addPasswordIdentity(getCurrentTestName());
      session.auth().verify(5L,TimeUnit.SECONDS);
      try (SftpClient sftp=session.createSftpClient()){
        String rootDir=sftp.canonicalPath("/");
        String upDir=sftp.canonicalPath(rootDir + "/..");
        assertEquals("Mismatched root dir parent",rootDir,upDir);
      }
     }
  finally {
      client.stop();
    }
  }
 }

</code></pre>

<br>
<pre class="type-8 type-3 type-7 type-13 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testWriteOffsetIgnoredForAppendMode() throws IOException {
  Path targetPath=detectTargetFolder();
  Path parentPath=targetPath.getParent();
  Path lclSftp=Utils.resolve(targetPath,SftpConstants.SFTP_SUBSYSTEM_NAME,getClass().getSimpleName(),getCurrentTestName());
  Path testFile=assertHierarchyTargetFolderExists(lclSftp).resolve("file.txt");
  Files.deleteIfExists(testFile);
  byte[] expectedRandom=new byte[Byte.MAX_VALUE];
  Factory<? extends Random> factory=sshd.getRandomFactory();
  Random rnd=factory.create();
  rnd.fill(expectedRandom);
  byte[] expectedText=(getClass().getName() + "#" + getCurrentTestName()).getBytes(StandardCharsets.UTF_8);
  try (SshClient client=setupTestClient()){
    client.start();
    try (ClientSession session=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession()){
      session.addPasswordIdentity(getCurrentTestName());
      session.auth().verify(5L,TimeUnit.SECONDS);
      try (SftpClient sftp=session.createSftpClient()){
        String file=Utils.resolveRelativeRemotePath(parentPath,testFile);
        try (CloseableHandle handle=sftp.open(file,OpenMode.Create,OpenMode.Write,OpenMode.Read,OpenMode.Append)){
          sftp.write(handle,7365L,expectedRandom);
          byte[] actualRandom=new byte[expectedRandom.length];
          int readLen=sftp.read(handle,0L,actualRandom);
          assertEquals("Incomplete random data read",expectedRandom.length,readLen);
          assertArrayEquals("Mismatched read random data",expectedRandom,actualRandom);
          sftp.write(handle,3777347L,expectedText);
          byte[] actualText=new byte[expectedText.length];
          readLen=sftp.read(handle,actualRandom.length,actualText);
          assertEquals("Incomplete text data read",actualText.length,readLen);
          assertArrayEquals("Mismatched read text data",expectedText,actualText);
        }
       }
     }
  finally {
      client.stop();
    }
  }
   byte[] actualBytes=Files.readAllBytes(testFile);
  assertEquals("Mismatched result file size",expectedRandom.length + expectedText.length,actualBytes.length);
  byte[] actualRandom=Arrays.copyOfRange(actualBytes,0,expectedRandom.length);
  assertArrayEquals("Mismatched random part",expectedRandom,actualRandom);
  byte[] actualText=Arrays.copyOfRange(actualBytes,expectedRandom.length,actualBytes.length);
  assertArrayEquals("Mismatched text part",expectedText,actualText);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.client.subsystem.sftp.SftpVersionSelectorTest </h4><pre class="type-11 type-8 type-6 type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPreferredVersionSelector(){
  List<Integer> available=new ArrayList<>();
  for (int version=SftpSubsystem.LOWER_SFTP_IMPL; version <= SftpSubsystem.HIGHER_SFTP_IMPL; version++) {
    available.add(Integer.valueOf(version));
  }
  List<Integer> preferred=new ArrayList<>(available);
  List<Integer> unavailable=Arrays.asList(7365,3777347);
  Random rnd=new Random(System.nanoTime());
  for (int index=0; index < preferred.size(); index++) {
    Collections.shuffle(preferred,rnd);
    SftpVersionSelector selector=SftpVersionSelector.Utils.preferredVersionSelector(preferred);
    int expected=preferred.get(0);
    for (int current=SftpSubsystem.LOWER_SFTP_IMPL; current <= SftpSubsystem.HIGHER_SFTP_IMPL; current++) {
      assertEquals("Mismatched selected for current= " + current + ", available="+ available+ ", preferred="+ preferred,expected,selector.selectVersion(current,available));
      try {
        Collections.shuffle(unavailable,rnd);
        int version=unavailable.get(0);
        int actual=selector.selectVersion(version,unavailable);
        fail("Unexpected selected version (" + actual + ")"+ " for current= "+ version+ ", available="+ unavailable+ ", preferred="+ preferred);
      }
 catch (      IllegalStateException e) {
      }
    }
  }
}

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCurrentVersionSelector(){
  List<Integer> available=new ArrayList<>();
  Random rnd=new Random(System.nanoTime());
  for (int expected=SftpSubsystem.LOWER_SFTP_IMPL; expected <= SftpSubsystem.HIGHER_SFTP_IMPL; expected++) {
    assertEquals("Mismatched directly selected for available=" + available,expected,SftpVersionSelector.CURRENT.selectVersion(expected,available));
    available.add(Integer.valueOf(expected));
  }
  for (int expected=SftpSubsystem.LOWER_SFTP_IMPL; expected <= SftpSubsystem.HIGHER_SFTP_IMPL; expected++) {
    for (int index=0; index < available.size(); index++) {
      Collections.shuffle(available,rnd);
      assertEquals("Mismatched suffling selected for current=" + expected + ", available="+ available,expected,SftpVersionSelector.CURRENT.selectVersion(expected,available));
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.client.subsystem.sftp.SftpVersionsTest </h4><pre class="type-8 type-10 type-2 type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSftpFileTypeAndPermissionsUpdate() throws Exception {
  Path targetPath=detectTargetFolder();
  Path lclSftp=Utils.resolve(targetPath,SftpConstants.SFTP_SUBSYSTEM_NAME,getClass().getSimpleName());
  Path subFolder=Files.createDirectories(lclSftp.resolve("sub-folder"));
  String subFolderName=subFolder.getFileName().toString();
  Path lclFile=assertHierarchyTargetFolderExists(lclSftp).resolve(getCurrentTestName() + "-" + getTestedVersion()+ ".txt");
  String lclFileName=lclFile.getFileName().toString();
  Files.write(lclFile,getClass().getName().getBytes(StandardCharsets.UTF_8));
  Path parentPath=targetPath.getParent();
  String remotePath=Utils.resolveRelativeRemotePath(parentPath,lclSftp);
  try (SshClient client=setupTestClient()){
    client.start();
    try (ClientSession session=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession()){
      session.addPasswordIdentity(getCurrentTestName());
      session.auth().verify(5L,TimeUnit.SECONDS);
      try (SftpClient sftp=session.createSftpClient(getTestedVersion())){
        for (        DirEntry entry : sftp.readDir(remotePath)) {
          String fileName=entry.getFilename();
          if (".".equals(fileName) || "..".equals(fileName)) {
            continue;
          }
          Attributes attrs=validateSftpFileTypeAndPermissions(fileName,getTestedVersion(),entry.getAttributes());
          if (subFolderName.equals(fileName)) {
            assertEquals("Mismatched sub-folder type",SftpConstants.SSH_FILEXFER_TYPE_DIRECTORY,attrs.getType());
            assertTrue("Sub-folder not marked as directory",attrs.isDirectory());
          }
 else           if (lclFileName.equals(fileName)) {
            assertEquals("Mismatched sub-file type",SftpConstants.SSH_FILEXFER_TYPE_REGULAR,attrs.getType());
            assertTrue("Sub-folder not marked as directory",attrs.isRegularFile());
          }
        }
      }
     }
  finally {
      client.stop();
    }
  }
 }

</code></pre>

<br>
<pre class="type-8 type-10 type-3 type-7 type-12 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSftpACLEncodeDecode() throws Exception {
  AclEntryType[] types=AclEntryType.values();
  final List<AclEntry> aclExpected=new ArrayList<>(types.length);
  for (  AclEntryType t : types) {
    aclExpected.add(AclEntry.newBuilder().setType(t).setFlags(EnumSet.allOf(AclEntryFlag.class)).setPermissions(EnumSet.allOf(AclEntryPermission.class)).setPrincipal(new DefaultGroupPrincipal(getCurrentTestName() + "@" + getClass().getPackage().getName())).build());
  }
  final AtomicInteger numInvocations=new AtomicInteger(0);
  SftpSubsystemFactory factory=new SftpSubsystemFactory(){
    @Override public Command create(){
      SftpSubsystem subsystem=new SftpSubsystem(getExecutorService(),isShutdownOnExit(),getUnsupportedAttributePolicy()){
        @Override protected Map<String,Object> resolveFileAttributes(        Path file,        int flags,        LinkOption... options) throws IOException {
          Map<String,Object> attrs=super.resolveFileAttributes(file,flags,options);
          if (GenericUtils.isEmpty(attrs)) {
            attrs=new TreeMap<String,Object>(String.CASE_INSENSITIVE_ORDER);
          }
          @SuppressWarnings("unchecked") List<AclEntry> aclActual=(List<AclEntry>)attrs.put("acl",aclExpected);
          if (aclActual != null) {
            log.info("resolveFileAttributes(" + file + ") replaced ACL: "+ aclActual);
          }
          return attrs;
        }
        @Override protected void setFileAccessControl(        Path file,        List<AclEntry> aclActual,        LinkOption... options) throws IOException {
          if (aclActual != null) {
            assertListEquals("Mismatched ACL set for file=" + file,aclExpected,aclActual);
            numInvocations.incrementAndGet();
          }
        }
      }
;
      Collection<? extends SftpEventListener> listeners=getRegisteredListeners();
      if (GenericUtils.size(listeners) > 0) {
        for (        SftpEventListener l : listeners) {
          subsystem.addSftpEventListener(l);
        }
      }
      return subsystem;
    }
  }
;
  factory.addSftpEventListener(new AbstractSftpEventListenerAdapter(){
    @Override public void modifyingAttributes(    ServerSession session,    Path path,    Map<String,?> attrs){
      @SuppressWarnings("unchecked") List<AclEntry> aclActual=GenericUtils.isEmpty(attrs) ? null : (List<AclEntry>)attrs.get("acl");
      if (getTestedVersion() > SftpConstants.SFTP_V3) {
        assertListEquals("Mismatched modifying ACL for file=" + path,aclExpected,aclActual);
      }
 else {
        assertNull("Unexpected modifying ACL for file=" + path,aclActual);
      }
    }
    @Override public void modifiedAttributes(    ServerSession session,    Path path,    Map<String,?> attrs,    Throwable thrown){
      @SuppressWarnings("unchecked") List<AclEntry> aclActual=GenericUtils.isEmpty(attrs) ? null : (List<AclEntry>)attrs.get("acl");
      if (getTestedVersion() > SftpConstants.SFTP_V3) {
        assertListEquals("Mismatched modified ACL for file=" + path,aclExpected,aclActual);
      }
 else {
        assertNull("Unexpected modified ACL for file=" + path,aclActual);
      }
    }
  }
);
  sshd.setSubsystemFactories(Collections.<NamedFactory<Command>>singletonList(factory));
  Path targetPath=detectTargetFolder();
  Path lclSftp=Utils.resolve(targetPath,SftpConstants.SFTP_SUBSYSTEM_NAME,getClass().getSimpleName());
  Files.createDirectories(lclSftp.resolve("sub-folder"));
  Path lclFile=assertHierarchyTargetFolderExists(lclSftp).resolve(getCurrentTestName() + "-" + getTestedVersion()+ ".txt");
  Files.write(lclFile,getClass().getName().getBytes(StandardCharsets.UTF_8));
  Path parentPath=targetPath.getParent();
  String remotePath=Utils.resolveRelativeRemotePath(parentPath,lclSftp);
  int numInvoked=0;
  try (SshClient client=setupTestClient()){
    client.start();
    try (ClientSession session=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession()){
      session.addPasswordIdentity(getCurrentTestName());
      session.auth().verify(5L,TimeUnit.SECONDS);
      try (SftpClient sftp=session.createSftpClient(getTestedVersion())){
        for (        DirEntry entry : sftp.readDir(remotePath)) {
          String fileName=entry.getFilename();
          if (".".equals(fileName) || "..".equals(fileName)) {
            continue;
          }
          Attributes attrs=validateSftpFileTypeAndPermissions(fileName,getTestedVersion(),entry.getAttributes());
          List<AclEntry> aclActual=attrs.getAcl();
          if (getTestedVersion() == SftpConstants.SFTP_V3) {
            assertNull("Unexpected ACL for entry=" + fileName,aclActual);
          }
 else {
            assertListEquals("Mismatched ACL for entry=" + fileName,aclExpected,aclActual);
          }
          attrs.getFlags().clear();
          attrs.setAcl(aclExpected);
          sftp.setStat(remotePath + "/" + fileName,attrs);
          if (getTestedVersion() > SftpConstants.SFTP_V3) {
            numInvoked++;
          }
        }
      }
     }
  finally {
      client.stop();
    }
  }
   assertEquals("Mismatched invocations count",numInvoked,numInvocations.get());
}

</code></pre>

<br>
<pre class="type-2 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSftpExtensionsEncodeDecode() throws Exception {
  final Class<?> anchor=getClass();
  final Map<String,String> expExtensions=new TreeMap<String,String>(String.CASE_INSENSITIVE_ORDER){
    private static final long serialVersionUID=1L;
{
      put("class",anchor.getSimpleName());
      put("package",anchor.getPackage().getName());
      put("method",getCurrentTestName());
    }
  }
;
  final AtomicInteger numInvocations=new AtomicInteger(0);
  SftpSubsystemFactory factory=new SftpSubsystemFactory(){
    @Override public Command create(){
      SftpSubsystem subsystem=new SftpSubsystem(getExecutorService(),isShutdownOnExit(),getUnsupportedAttributePolicy()){
        @Override protected Map<String,Object> resolveFileAttributes(        Path file,        int flags,        LinkOption... options) throws IOException {
          Map<String,Object> attrs=super.resolveFileAttributes(file,flags,options);
          if (GenericUtils.isEmpty(attrs)) {
            attrs=new TreeMap<String,Object>(String.CASE_INSENSITIVE_ORDER);
          }
          @SuppressWarnings("unchecked") Map<String,String> actExtensions=(Map<String,String>)attrs.put("extended",expExtensions);
          if (actExtensions != null) {
            log.info("resolveFileAttributes(" + file + ") replaced extensions: "+ actExtensions);
          }
          return attrs;
        }
        @Override protected void setFileExtensions(        Path file,        Map<String,byte[]> extensions,        LinkOption... options) throws IOException {
          assertExtensionsMapEquals("setFileExtensions(" + file + ")",expExtensions,extensions);
          numInvocations.incrementAndGet();
          int currentVersion=getTestedVersion();
          try {
            super.setFileExtensions(file,extensions,options);
            assertFalse("Expected exception not generated for version=" + currentVersion,currentVersion >= SftpConstants.SFTP_V6);
          }
 catch (          UnsupportedOperationException e) {
            assertTrue("Unexpected exception for version=" + currentVersion,currentVersion >= SftpConstants.SFTP_V6);
          }
        }
      }
;
      Collection<? extends SftpEventListener> listeners=getRegisteredListeners();
      if (GenericUtils.size(listeners) > 0) {
        for (        SftpEventListener l : listeners) {
          subsystem.addSftpEventListener(l);
        }
      }
      return subsystem;
    }
  }
;
  factory.addSftpEventListener(new AbstractSftpEventListenerAdapter(){
    @Override public void modifyingAttributes(    ServerSession session,    Path path,    Map<String,?> attrs){
      @SuppressWarnings("unchecked") Map<String,byte[]> actExtensions=GenericUtils.isEmpty(attrs) ? null : (Map<String,byte[]>)attrs.get("extended");
      assertExtensionsMapEquals("modifying(" + path + ")",expExtensions,actExtensions);
    }
    @Override public void modifiedAttributes(    ServerSession session,    Path path,    Map<String,?> attrs,    Throwable thrown){
      @SuppressWarnings("unchecked") Map<String,byte[]> actExtensions=GenericUtils.isEmpty(attrs) ? null : (Map<String,byte[]>)attrs.get("extended");
      assertExtensionsMapEquals("modified(" + path + ")",expExtensions,actExtensions);
    }
  }
);
  sshd.setSubsystemFactories(Collections.<NamedFactory<Command>>singletonList(factory));
  Path targetPath=detectTargetFolder();
  Path lclSftp=Utils.resolve(targetPath,SftpConstants.SFTP_SUBSYSTEM_NAME,getClass().getSimpleName());
  Files.createDirectories(lclSftp.resolve("sub-folder"));
  Path lclFile=assertHierarchyTargetFolderExists(lclSftp).resolve(getCurrentTestName() + "-" + getTestedVersion()+ ".txt");
  Files.write(lclFile,getClass().getName().getBytes(StandardCharsets.UTF_8));
  Path parentPath=targetPath.getParent();
  String remotePath=Utils.resolveRelativeRemotePath(parentPath,lclSftp);
  int numInvoked=0;
  try (SshClient client=setupTestClient()){
    client.start();
    try (ClientSession session=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession()){
      session.addPasswordIdentity(getCurrentTestName());
      session.auth().verify(5L,TimeUnit.SECONDS);
      try (SftpClient sftp=session.createSftpClient(getTestedVersion())){
        for (        DirEntry entry : sftp.readDir(remotePath)) {
          String fileName=entry.getFilename();
          if (".".equals(fileName) || "..".equals(fileName)) {
            continue;
          }
          Attributes attrs=validateSftpFileTypeAndPermissions(fileName,getTestedVersion(),entry.getAttributes());
          Map<String,byte[]> actExtensions=attrs.getExtensions();
          assertExtensionsMapEquals("dirEntry=" + fileName,expExtensions,actExtensions);
          attrs.getFlags().clear();
          attrs.setStringExtensions(expExtensions);
          sftp.setStat(remotePath + "/" + fileName,attrs);
          numInvoked++;
        }
      }
     }
  finally {
      client.stop();
    }
  }
   assertEquals("Mismatched invocations count",numInvoked,numInvocations.get());
}

</code></pre>

<br>
<pre class="type-3 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSftpVersionSelector() throws Exception {
  try (SshClient client=setupTestClient()){
    client.start();
    try (ClientSession session=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession()){
      session.addPasswordIdentity(getCurrentTestName());
      session.auth().verify(5L,TimeUnit.SECONDS);
      try (SftpClient sftp=session.createSftpClient(getTestedVersion())){
        assertEquals("Mismatched negotiated version",getTestedVersion(),sftp.getVersion());
      }
     }
  finally {
      client.stop();
    }
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.client.subsystem.sftp.extensions.BuiltinSftpClientExtensionsTest </h4><pre class="type-8 type-3 type-15 type-7 type-12 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFromInstance(){
  for (  Object instance : new Object[]{null,this}) {
    assertNull("Unexpected value for " + instance,BuiltinSftpClientExtensions.fromInstance(instance));
  }
  SftpClient mockClient=Mockito.mock(SftpClient.class);
  RawSftpClient mockRaw=Mockito.mock(RawSftpClient.class);
  for (  BuiltinSftpClientExtensions expected : BuiltinSftpClientExtensions.VALUES) {
    SftpClientExtension e=expected.create(mockClient,mockRaw);
    BuiltinSftpClientExtensions actual=BuiltinSftpClientExtensions.fromInstance(e);
    assertSame(expected.getName(),expected,actual);
    assertEquals("Mismatched extension name",expected.getName(),actual.getName());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.client.subsystem.sftp.extensions.impl.CopyFileExtensionImplTest </h4><pre class="type-8 type-6 type-2 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCopyFileExtension() throws Exception {
  Path targetPath=detectTargetFolder();
  Path lclSftp=Utils.resolve(targetPath,SftpConstants.SFTP_SUBSYSTEM_NAME,getClass().getSimpleName(),getCurrentTestName());
  Utils.deleteRecursive(lclSftp);
  byte[] data=(getClass().getName() + "#" + getCurrentTestName()).getBytes(StandardCharsets.UTF_8);
  Path srcFile=assertHierarchyTargetFolderExists(lclSftp).resolve("src.txt");
  Files.write(srcFile,data,IoUtils.EMPTY_OPEN_OPTIONS);
  Path parentPath=targetPath.getParent();
  String srcPath=Utils.resolveRelativeRemotePath(parentPath,srcFile);
  Path dstFile=lclSftp.resolve("dst.txt");
  String dstPath=Utils.resolveRelativeRemotePath(parentPath,dstFile);
  LinkOption[] options=IoUtils.getLinkOptions(false);
  assertFalse("Destination file unexpectedly exists",Files.exists(dstFile,options));
  try (SshClient client=setupTestClient()){
    client.start();
    try (ClientSession session=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession()){
      session.addPasswordIdentity(getCurrentTestName());
      session.auth().verify(5L,TimeUnit.SECONDS);
      try (SftpClient sftp=session.createSftpClient()){
        CopyFileExtension ext=assertExtensionCreated(sftp,CopyFileExtension.class);
        ext.copyFile(srcPath,dstPath,false);
        assertTrue("Source file not preserved",Files.exists(srcFile,options));
        assertTrue("Destination file not created",Files.exists(dstFile,options));
        byte[] actual=Files.readAllBytes(dstFile);
        assertArrayEquals("Mismatched copied data",data,actual);
        try {
          ext.copyFile(srcPath,dstPath,false);
          fail("Unexpected success to overwrite existing destination: " + dstFile);
        }
 catch (        IOException e) {
          assertTrue("Not an SftpException",e instanceof SftpException);
        }
      }
     }
  finally {
      client.stop();
    }
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.client.subsystem.sftp.extensions.impl.SpaceAvailableExtensionImplTest </h4><pre class="type-8 type-3 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFileStoreReport() throws Exception {
  Path targetPath=detectTargetFolder();
  Path lclSftp=Utils.resolve(targetPath,SftpConstants.SFTP_SUBSYSTEM_NAME,getClass().getSimpleName(),getCurrentTestName());
  Path parentPath=targetPath.getParent();
  FileStore store=Files.getFileStore(lclSftp.getRoot());
  final String queryPath=Utils.resolveRelativeRemotePath(parentPath,lclSftp);
  final SpaceAvailableExtensionInfo expected=new SpaceAvailableExtensionInfo(store);
  sshd.setSubsystemFactories(Arrays.<NamedFactory<Command>>asList(new SftpSubsystemFactory(){
    @Override public Command create(){
      return new SftpSubsystem(getExecutorService(),isShutdownOnExit(),getUnsupportedAttributePolicy()){
        @Override protected SpaceAvailableExtensionInfo doSpaceAvailable(        int id,        String path) throws IOException {
          if (!queryPath.equals(path)) {
            throw new StreamCorruptedException("Mismatched query paths: expected=" + queryPath + ", actual="+ path);
          }
          return expected;
        }
      }
;
    }
  }
));
  try (SshClient client=setupTestClient()){
    client.start();
    try (ClientSession session=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession()){
      session.addPasswordIdentity(getCurrentTestName());
      session.auth().verify(5L,TimeUnit.SECONDS);
      try (SftpClient sftp=session.createSftpClient()){
        SpaceAvailableExtension ext=assertExtensionCreated(sftp,SpaceAvailableExtension.class);
        SpaceAvailableExtensionInfo actual=ext.available(queryPath);
        assertEquals("Mismatched information",expected,actual);
      }
     }
  finally {
      client.stop();
    }
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.client.subsystem.sftp.extensions.openssh.impl.OpenSSHExtensionsTest </h4><pre class="type-8 type-3 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testStat() throws Exception {
  Path targetPath=detectTargetFolder();
  Path lclSftp=Utils.resolve(targetPath,SftpConstants.SFTP_SUBSYSTEM_NAME,getClass().getSimpleName());
  Path srcFile=assertHierarchyTargetFolderExists(lclSftp).resolve(getCurrentTestName() + ".txt");
  Files.write(srcFile,(getClass().getName() + "#" + getCurrentTestName()).getBytes(StandardCharsets.UTF_8),IoUtils.EMPTY_OPEN_OPTIONS);
  Path parentPath=targetPath.getParent();
  String srcPath=Utils.resolveRelativeRemotePath(parentPath,srcFile);
  final AtomicReference<String> extensionHolder=new AtomicReference<String>(null);
  final OpenSSHStatExtensionInfo expected=new OpenSSHStatExtensionInfo();
{
    expected.f_bavail=Short.MAX_VALUE;
    expected.f_bfree=Integer.MAX_VALUE;
    expected.f_blocks=Short.MAX_VALUE;
    expected.f_bsize=IoUtils.DEFAULT_COPY_SIZE;
    expected.f_favail=Long.MAX_VALUE;
    expected.f_ffree=Byte.MAX_VALUE;
    expected.f_files=3777347L;
    expected.f_flag=OpenSSHStatExtensionInfo.SSH_FXE_STATVFS_ST_RDONLY;
    expected.f_frsize=7365L;
    expected.f_fsid=1L;
    expected.f_namemax=256;
  }
  sshd.setSubsystemFactories(Arrays.<NamedFactory<Command>>asList(new SftpSubsystemFactory(){
    @Override public Command create(){
      return new SftpSubsystem(getExecutorService(),isShutdownOnExit(),getUnsupportedAttributePolicy()){
        @Override protected List<OpenSSHExtension> resolveOpenSSHExtensions(        ServerSession session){
          List<OpenSSHExtension> original=super.resolveOpenSSHExtensions(session);
          int numOriginal=GenericUtils.size(original);
          List<OpenSSHExtension> result=new ArrayList<OpenSSHExtension>(numOriginal + 2);
          if (numOriginal > 0) {
            result.addAll(original);
          }
          for (          String name : new String[]{StatVfsExtensionParser.NAME,FstatVfsExtensionParser.NAME}) {
            result.add(new OpenSSHExtension(name,"2"));
          }
          return result;
        }
        @Override protected void executeExtendedCommand(        Buffer buffer,        int id,        String extension) throws IOException {
          if (StatVfsExtensionParser.NAME.equals(extension) || FstatVfsExtensionParser.NAME.equals(extension)) {
            String prev=extensionHolder.getAndSet(extension);
            if (prev != null) {
              throw new StreamCorruptedException("executeExtendedCommand(" + extension + ") previous not null: "+ prev);
            }
            buffer.clear();
            buffer.putByte((byte)SftpConstants.SSH_FXP_EXTENDED_REPLY);
            buffer.putInt(id);
            OpenSSHStatExtensionInfo.encode(buffer,expected);
            send(buffer);
          }
 else {
            super.executeExtendedCommand(buffer,id,extension);
          }
        }
      }
;
    }
  }
));
  try (SshClient client=setupTestClient()){
    client.start();
    try (ClientSession session=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession()){
      session.addPasswordIdentity(getCurrentTestName());
      session.auth().verify(5L,TimeUnit.SECONDS);
      try (SftpClient sftp=session.createSftpClient()){
{
          OpenSSHStatPathExtension pathStat=assertExtensionCreated(sftp,OpenSSHStatPathExtension.class);
          OpenSSHStatExtensionInfo actual=pathStat.stat(srcPath);
          String invokedExtension=extensionHolder.getAndSet(null);
          assertEquals("Mismatched invoked extension",pathStat.getName(),invokedExtension);
          assertOpenSSHStatExtensionInfoEquals(invokedExtension,expected,actual);
        }
        try (CloseableHandle handle=sftp.open(srcPath)){
          OpenSSHStatHandleExtension handleStat=assertExtensionCreated(sftp,OpenSSHStatHandleExtension.class);
          OpenSSHStatExtensionInfo actual=handleStat.stat(handle);
          String invokedExtension=extensionHolder.getAndSet(null);
          assertEquals("Mismatched invoked extension",handleStat.getName(),invokedExtension);
          assertOpenSSHStatExtensionInfoEquals(invokedExtension,expected,actual);
        }
       }
     }
   }
 }

</code></pre>

<br>
<pre class="type-8 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFsync() throws IOException {
  Path targetPath=detectTargetFolder();
  Path lclSftp=Utils.resolve(targetPath,SftpConstants.SFTP_SUBSYSTEM_NAME,getClass().getSimpleName());
  Path srcFile=assertHierarchyTargetFolderExists(lclSftp).resolve(getCurrentTestName() + ".txt");
  byte[] expected=(getClass().getName() + "#" + getCurrentTestName()).getBytes(StandardCharsets.UTF_8);
  Path parentPath=targetPath.getParent();
  String srcPath=Utils.resolveRelativeRemotePath(parentPath,srcFile);
  try (SshClient client=setupTestClient()){
    client.start();
    try (ClientSession session=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession()){
      session.addPasswordIdentity(getCurrentTestName());
      session.auth().verify(5L,TimeUnit.SECONDS);
      try (SftpClient sftp=session.createSftpClient()){
        OpenSSHFsyncExtension fsync=assertExtensionCreated(sftp,OpenSSHFsyncExtension.class);
        try (CloseableHandle fileHandle=sftp.open(srcPath,SftpClient.OpenMode.Write,SftpClient.OpenMode.Create)){
          sftp.write(fileHandle,0L,expected);
          fsync.fsync(fileHandle);
          byte[] actual=Files.readAllBytes(srcFile);
          assertArrayEquals("Mismatched written data",expected,actual);
        }
       }
     }
  finally {
      client.stop();
    }
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.PropertyResolverUtilsTest </h4><pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testIntegerProperty(){
  final int expected=3777347;
  final String name=getCurrentTestName();
  Session session=createMockSession();
  assertEquals("Mismatched empty props value",expected,PropertyResolverUtils.getIntProperty(session,name,expected));
  PropertyResolverUtils.updateProperty(session,name,expected);
  testIntegerProperty(session,name,expected);
  PropertyResolverUtils.updateProperty(session,name,Integer.toString(expected));
  testIntegerProperty(session,name,expected);
  PropertyResolverUtils.updateProperty(session,name,Long.valueOf(expected));
  testIntegerProperty(session,name,expected);
}

</code></pre>

<br>
<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testLongProperty(){
  final long expected=System.currentTimeMillis();
  final String name=getCurrentTestName();
  Session session=createMockSession();
  assertEquals("Mismatched empty props value",expected,PropertyResolverUtils.getLongProperty(session,name,expected));
  PropertyResolverUtils.updateProperty(session,name,expected);
  testLongProperty(session,name,expected);
  PropertyResolverUtils.updateProperty(session,name,Long.toString(expected));
  testLongProperty(session,name,expected);
}

</code></pre>

<br>
<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBooleanProperty(){
  for (  final boolean expected : new boolean[]{false,true}) {
    final String name=getCurrentTestName();
    Session session=createMockSession();
    assertEquals("Mismatched empty props value",expected,PropertyResolverUtils.getBooleanProperty(session,name,expected));
    PropertyResolverUtils.updateProperty(session,name,expected);
    testBooleanProperty(session,name,expected);
    PropertyResolverUtils.updateProperty(session,name,Boolean.toString(expected));
    testBooleanProperty(session,name,expected);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.SshBuilderTest </h4><pre class="type-8 type-10 type-2 type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Make sure that {@link BaseBuilder#setUpDefaultCiphers(boolean)} returns
 * the correct result - i.e., according to the {@code ingoreUnsupported}parameter and in the defined preference order
 */
@Test public void testSetUpDefaultCiphers(){
  for (  boolean ignoreUnsupported : new boolean[]{true,false}) {
    List<NamedFactory<Cipher>> ciphers=BaseBuilder.setUpDefaultCiphers(ignoreUnsupported);
    int numCiphers=GenericUtils.size(ciphers);
    if (ignoreUnsupported) {
      assertEquals("Incomplete full ciphers size",BaseBuilder.DEFAULT_CIPHERS_PREFERENCE.size(),numCiphers);
    }
 else {
      int expectedCount=0;
      for (      BuiltinCiphers c : BaseBuilder.DEFAULT_CIPHERS_PREFERENCE) {
        if (c.isSupported()) {
          expectedCount++;
        }
      }
      assertEquals("Incomplete supported ciphers size",expectedCount,numCiphers);
    }
    List<String> cipherNames=NamedResource.Utils.getNameList(ciphers);
    int nameIndex=0;
    for (    BuiltinCiphers c : BaseBuilder.DEFAULT_CIPHERS_PREFERENCE) {
      if ((!c.isSupported()) && (!ignoreUnsupported)) {
        continue;
      }
      String expectedName=c.getName();
      assertTrue("Out of actual ciphers for expected=" + expectedName,nameIndex < numCiphers);
      String actualName=cipherNames.get(nameIndex);
      assertEquals("Mismatched cipher at position " + nameIndex + " for ignoreUnsupported="+ ignoreUnsupported,expectedName,actualName);
      nameIndex++;
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.SshConstantsTest </h4><pre class="type-2 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAmbiguousOpcodes() throws Exception {
  int[] knownAmbiguities={30,31,60};
  Collection<Integer> opcodes=SshConstants.getAmbiguousOpcodes();
  assertTrue("Not enough ambiguities found",GenericUtils.size(opcodes) >= knownAmbiguities.length);
  for (  int cmd : knownAmbiguities) {
    assertEquals("Mismatched mnemonic for known ambiguity=" + cmd,Integer.toString(cmd),SshConstants.getCommandMessageName(cmd));
    assertTrue("Known ambiguity not reported as such: " + cmd,SshConstants.isAmbigouosOpcode(cmd));
    assertTrue("Known ambiguity=" + cmd + " not listed: "+ opcodes,opcodes.contains(cmd));
  }
  for (  Integer cmd : opcodes) {
    assertEquals("Mismatched mnemonic for " + cmd,cmd.toString(),SshConstants.getCommandMessageName(cmd));
    assertTrue("Opcode not detected as ambiguous: " + cmd,SshConstants.isAmbigouosOpcode(cmd));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.auth.AuthenticationTest </h4><pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testHostBasedAuthentication() throws Exception {
  final String CLIENT_USERNAME=getClass().getSimpleName();
  final String CLIENT_HOSTNAME=SshdSocketAddress.toAddressString(SshdSocketAddress.getFirstExternalNetwork4Address());
  final KeyPair CLIENT_HOSTKEY=Utils.generateKeyPair("RSA",1024);
  final AtomicInteger invocationCount=new AtomicInteger(0);
  sshd.setHostBasedAuthenticator(new HostBasedAuthenticator(){
    @Override public boolean authenticate(    ServerSession session,    String username,    PublicKey clientHostKey,    String clientHostName,    String clientUsername,    List<X509Certificate> certificates){
      invocationCount.incrementAndGet();
      return CLIENT_USERNAME.equals(clientUsername) && CLIENT_HOSTNAME.equals(clientHostName) && KeyUtils.compareKeys(CLIENT_HOSTKEY.getPublic(),clientHostKey);
    }
  }
);
  sshd.setPasswordAuthenticator(RejectAllPasswordAuthenticator.INSTANCE);
  sshd.setKeyboardInteractiveAuthenticator(KeyboardInteractiveAuthenticator.NONE);
  sshd.setPublickeyAuthenticator(RejectAllPublickeyAuthenticator.INSTANCE);
  sshd.setUserAuthFactories(Collections.<NamedFactory<org.apache.sshd.server.auth.UserAuth>>singletonList(org.apache.sshd.server.auth.hostbased.UserAuthHostBasedFactory.INSTANCE));
  try (SshClient client=setupTestClient()){
    org.apache.sshd.client.auth.hostbased.UserAuthHostBasedFactory factory=new org.apache.sshd.client.auth.hostbased.UserAuthHostBasedFactory();
    factory.setClientUsername(CLIENT_USERNAME);
    factory.setClientHostKeys(HostKeyIdentityProvider.Utils.wrap(CLIENT_HOSTKEY));
    client.setUserAuthFactories(Collections.<NamedFactory<org.apache.sshd.client.auth.UserAuth>>singletonList(factory));
    client.start();
    try (ClientSession s=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession()){
      s.auth().verify(11L,TimeUnit.SECONDS);
      assertEquals("Mismatched authenticator invocation count",1,invocationCount.get());
    }
  finally {
      client.stop();
    }
  }
 }

</code></pre>

<br>
<pre class="type-8 type-3 type-15 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPasswordIdentityProviderPropagation() throws Exception {
  try (SshClient client=setupTestClient()){
    final List<String> passwords=Collections.singletonList(getCurrentTestName());
    final AtomicInteger loadCount=new AtomicInteger(0);
    PasswordIdentityProvider provider=new PasswordIdentityProvider(){
      @Override public Iterable<String> loadPasswords(){
        loadCount.incrementAndGet();
        outputDebugMessage("loadPasswords - count=%s",loadCount);
        return passwords;
      }
    }
;
    client.setPasswordIdentityProvider(provider);
    client.start();
    try (ClientSession s=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession()){
      s.auth().verify(11L,TimeUnit.SECONDS);
      assertEquals("Mismatched load passwords count",1,loadCount.get());
      assertSame("Mismatched passwords identity provider",provider,s.getPasswordIdentityProvider());
    }
  finally {
      client.stop();
    }
  }
 }

</code></pre>

<br>
<pre class="type-11 type-10 type-2 type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRuntimeErrorsInAuthenticators() throws Exception {
  final Error thrown=new OutOfMemoryError(getCurrentTestName());
  final PasswordAuthenticator authPassword=sshd.getPasswordAuthenticator();
  final AtomicInteger passCounter=new AtomicInteger(0);
  sshd.setPasswordAuthenticator(new PasswordAuthenticator(){
    @Override public boolean authenticate(    String username,    String password,    ServerSession session) throws PasswordChangeRequiredException {
      int count=passCounter.incrementAndGet();
      if (count == 1) {
        throw thrown;
      }
      return authPassword.authenticate(username,password,session);
    }
  }
);
  final PublickeyAuthenticator authPubkey=sshd.getPublickeyAuthenticator();
  final AtomicInteger pubkeyCounter=new AtomicInteger(0);
  sshd.setPublickeyAuthenticator(new PublickeyAuthenticator(){
    @Override public boolean authenticate(    String username,    PublicKey key,    ServerSession session){
      int count=pubkeyCounter.incrementAndGet();
      if (count == 1) {
        throw thrown;
      }
      return authPubkey.authenticate(username,key,session);
    }
  }
);
  sshd.setKeyboardInteractiveAuthenticator(KeyboardInteractiveAuthenticator.NONE);
  try (SshClient client=setupTestClient()){
    KeyPair kp=Utils.generateKeyPair("RSA",1024);
    client.start();
    try {
      for (int index=1; index < 3; index++) {
        try (ClientSession s=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession()){
          s.addPasswordIdentity(getCurrentTestName());
          s.addPublicKeyIdentity(kp);
          AuthFuture auth=s.auth();
          assertTrue("Failed to complete authentication on time",auth.await(11L,TimeUnit.SECONDS));
          if (auth.isSuccess()) {
            assertTrue("Premature authentication success",index > 1);
            break;
          }
          assertEquals("Password authenticator not consulted",1,passCounter.get());
          assertEquals("Pubkey authenticator not consulted",1,pubkeyCounter.get());
        }
       }
    }
  finally {
      client.stop();
    }
  }
 }

</code></pre>

<br>
<pre class="type-11 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMismatchedUserAuthPkOkData() throws Exception {
  final AtomicInteger challengeCounter=new AtomicInteger(0);
  sshd.setUserAuthFactories(Collections.<NamedFactory<org.apache.sshd.server.auth.UserAuth>>singletonList(new org.apache.sshd.server.auth.pubkey.UserAuthPublicKeyFactory(){
    @Override public org.apache.sshd.server.auth.pubkey.UserAuthPublicKey create(){
      return new org.apache.sshd.server.auth.pubkey.UserAuthPublicKey(){
        @Override protected void sendPublicKeyResponse(        ServerSession session,        String username,        String alg,        PublicKey key,        byte[] keyBlob,        int offset,        int blobLen,        Buffer buffer) throws Exception {
          int count=challengeCounter.incrementAndGet();
          outputDebugMessage("sendPublicKeyChallenge(%s)[%s]: count=%d",session,alg,count);
          if (count == 1) {
            super.sendPublicKeyResponse(session,username,KeyPairProvider.SSH_DSS,key,keyBlob,offset,blobLen,buffer);
          }
 else           if (count == 2) {
            KeyPair otherPair=org.apache.sshd.util.test.Utils.generateKeyPair("RSA",1024);
            PublicKey otherKey=otherPair.getPublic();
            Buffer buf=session.prepareBuffer(SshConstants.SSH_MSG_USERAUTH_PK_OK,BufferUtils.clear(buffer));
            buf.putString(alg);
            buf.putPublicKey(otherKey);
            session.writePacket(buf);
          }
 else {
            super.sendPublicKeyResponse(session,username,alg,key,keyBlob,offset,blobLen,buffer);
          }
        }
      }
;
    }
  }
));
  try (SshClient client=setupTestClient()){
    KeyPair clientIdentity=Utils.generateKeyPair("RSA",1024);
    client.start();
    try {
      for (int index=1; index <= 4; index++) {
        try (ClientSession s=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession()){
          s.addPublicKeyIdentity(clientIdentity);
          s.auth().verify(17L,TimeUnit.SECONDS);
          assertEquals("Mismatched number of challenges",3,challengeCounter.get());
          break;
        }
 catch (        SshException e) {
          outputDebugMessage("%s on retry #%d: %s",e.getClass().getSimpleName(),index,e.getMessage());
          Throwable t=e.getCause();
          assertObjectInstanceOf("Unexpected failure cause at retry #" + index,InvalidKeySpecException.class,t);
        }
      }
    }
  finally {
      client.stop();
    }
  }
 }

</code></pre>

<br>
<pre class="type-8 type-3 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPublicKeyAuthDifferentThanKex() throws Exception {
  final KeyPairProvider serverKeys=KeyPairProvider.Utils.wrap(Utils.generateKeyPair("RSA",1024),Utils.generateKeyPair("DSA",512),Utils.generateKeyPair("EC",256));
  sshd.setKeyPairProvider(serverKeys);
  sshd.setKeyboardInteractiveAuthenticator(KeyboardInteractiveAuthenticator.NONE);
  sshd.setPasswordAuthenticator(RejectAllPasswordAuthenticator.INSTANCE);
  final KeyPair clientIdentity=Utils.generateKeyPair("EC",256);
  sshd.setPublickeyAuthenticator(new PublickeyAuthenticator(){
    @Override public boolean authenticate(    String username,    PublicKey key,    ServerSession session){
      String keyType=KeyUtils.getKeyType(key);
      String expType=KeyUtils.getKeyType(clientIdentity);
      assertEquals("Mismatched client key types",expType,keyType);
      assertKeyEquals("Mismatched authentication public keys",clientIdentity.getPublic(),key);
      return true;
    }
  }
);
  try (SshClient client=setupTestClient()){
    final NamedFactory<Signature> kexSignature=BuiltinSignatures.rsa;
    client.setSignatureFactories(Collections.<NamedFactory<Signature>>singletonList(kexSignature));
    client.setServerKeyVerifier(new ServerKeyVerifier(){
      @Override public boolean verifyServerKey(      ClientSession sshClientSession,      SocketAddress remoteAddress,      PublicKey serverKey){
        String keyType=KeyUtils.getKeyType(serverKey);
        String expType=kexSignature.getName();
        assertEquals("Mismatched server key type",expType,keyType);
        KeyPair kp=ValidateUtils.checkNotNull(serverKeys.loadKey(keyType),"No server key for type=%s",keyType);
        assertKeyEquals("Mismatched server public keys",kp.getPublic(),serverKey);
        return true;
      }
    }
);
    org.apache.sshd.client.auth.pubkey.UserAuthPublicKeyFactory factory=new org.apache.sshd.client.auth.pubkey.UserAuthPublicKeyFactory();
    factory.setSignatureFactories(Arrays.<NamedFactory<Signature>>asList(BuiltinSignatures.nistp256,BuiltinSignatures.nistp384,BuiltinSignatures.nistp521));
    client.setUserAuthFactories(Collections.<NamedFactory<UserAuth>>singletonList(factory));
    client.start();
    try (ClientSession s=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession()){
      s.addPublicKeyIdentity(clientIdentity);
      s.auth().verify(11L,TimeUnit.SECONDS);
    }
  finally {
      client.stop();
    }
  }
 }

</code></pre>

<br>
<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAuthPasswordChangeRequest() throws Exception {
  final PasswordAuthenticator delegate=ValidateUtils.checkNotNull(sshd.getPasswordAuthenticator(),"No password authenticator");
  final AtomicInteger attemptsCount=new AtomicInteger(0);
  sshd.setPasswordAuthenticator(new PasswordAuthenticator(){
    @Override public boolean authenticate(    String username,    String password,    ServerSession session) throws PasswordChangeRequiredException {
      if (attemptsCount.incrementAndGet() == 1) {
        throw new PasswordChangeRequiredException(attemptsCount.toString(),getCurrentTestName(),ServerFactoryManager.DEFAULT_WELCOME_BANNER_LANGUAGE);
      }
      return delegate.authenticate(username,password,session);
    }
  }
);
  PropertyResolverUtils.updateProperty(sshd,ServerFactoryManager.AUTH_METHODS,UserAuthPasswordFactory.NAME);
  try (SshClient client=setupTestClient()){
    final AtomicInteger updatesCount=new AtomicInteger(0);
    client.setUserInteraction(new UserInteraction(){
      @Override public boolean isInteractionAllowed(      ClientSession session){
        return true;
      }
      @Override public void welcome(      ClientSession session,      String banner,      String lang){
      }
      @Override public String[] interactive(      ClientSession session,      String name,      String instruction,      String lang,      String[] prompt,      boolean[] echo){
        throw new UnsupportedOperationException("Unexpected call");
      }
      @Override public String getUpdatedPassword(      ClientSession session,      String prompt,      String lang){
        assertEquals("Mismatched prompt",getCurrentTestName(),prompt);
        assertEquals("Mismatched language",ServerFactoryManager.DEFAULT_WELCOME_BANNER_LANGUAGE,lang);
        assertEquals("Unexpected repeated call",1,updatesCount.incrementAndGet());
        return getCurrentTestName();
      }
    }
);
    PropertyResolverUtils.updateProperty(client,ServerFactoryManager.AUTH_METHODS,UserAuthPasswordFactory.NAME);
    client.start();
    try (ClientSession s=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession()){
      s.addPasswordIdentity(getCurrentTestName());
      s.auth().verify(11L,TimeUnit.SECONDS);
      assertEquals("No password change request generated",2,attemptsCount.get());
      assertEquals("No user interaction invoked",1,updatesCount.get());
    }
  finally {
      client.stop();
    }
  }
 }

</code></pre>

<br>
<pre class="type-8 type-2 type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAuthDefaultKeyInteractive() throws Exception {
  try (SshClient client=setupTestClient()){
    sshd.setPublickeyAuthenticator(RejectAllPublickeyAuthenticator.INSTANCE);
    sshd.setKeyboardInteractiveAuthenticator(new DefaultKeyboardInteractiveAuthenticator(){
      @Override public InteractiveChallenge generateChallenge(      ServerSession session,      String username,      String lang,      String subMethods){
        assertEquals("Mismatched user language",PropertyResolverUtils.getStringProperty(client,org.apache.sshd.client.auth.keyboard.UserAuthKeyboardInteractive.INTERACTIVE_LANGUAGE_TAG,org.apache.sshd.client.auth.keyboard.UserAuthKeyboardInteractive.DEFAULT_INTERACTIVE_LANGUAGE_TAG),lang);
        assertEquals("Mismatched client sub-methods",PropertyResolverUtils.getStringProperty(client,org.apache.sshd.client.auth.keyboard.UserAuthKeyboardInteractive.INTERACTIVE_SUBMETHODS,org.apache.sshd.client.auth.keyboard.UserAuthKeyboardInteractive.DEFAULT_INTERACTIVE_SUBMETHODS),subMethods);
        InteractiveChallenge challenge=super.generateChallenge(session,username,lang,subMethods);
        assertEquals("Mismatched interaction name",getInteractionName(session),challenge.getInteractionName());
        assertEquals("Mismatched interaction instruction",getInteractionInstruction(session),challenge.getInteractionInstruction());
        assertEquals("Mismatched language tag",getInteractionLanguage(session),challenge.getLanguageTag());
        List<PromptEntry> entries=challenge.getPrompts();
        assertEquals("Mismatched prompts count",1,GenericUtils.size(entries));
        PromptEntry entry=entries.get(0);
        assertEquals("Mismatched prompt",getInteractionPrompt(session),entry.getPrompt());
        assertEquals("Mismatched echo",isInteractionPromptEchoEnabled(session),entry.isEcho());
        return challenge;
      }
      @Override public boolean authenticate(      ServerSession session,      String username,      List<String> responses) throws Exception {
        return super.authenticate(session,username,responses);
      }
    }
);
    client.start();
    try (ClientSession s=client.connect(null,TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession()){
      Collection<ClientSession.ClientSessionEvent> result=s.waitFor(EnumSet.of(ClientSession.ClientSessionEvent.CLOSED,ClientSession.ClientSessionEvent.WAIT_AUTH),TimeUnit.SECONDS.toMillis(11L));
      assertFalse("Timeout while waiting for session",result.contains(ClientSession.ClientSessionEvent.TIMEOUT));
      KeyPair pair=createTestHostKeyProvider().loadKey(KeyPairProvider.SSH_RSA);
      try {
        assertAuthenticationResult(UserAuthMethodFactory.PUBLIC_KEY,authPublicKey(s,getCurrentTestName(),pair),false);
      }
  finally {
        s.removePublicKeyIdentity(pair);
      }
      try {
        assertAuthenticationResult(UserAuthMethodFactory.KB_INTERACTIVE,authInteractive(s,getCurrentTestName(),getCurrentTestName()),true);
      }
  finally {
        s.setUserInteraction(null);
      }
    }
  finally {
      client.stop();
    }
  }
 }

</code></pre>

<br>
<pre class="type-11 type-8 type-3 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAuthMultiChallengeKeyInteractive() throws Exception {
  final Class<?> anchor=getClass();
  final InteractiveChallenge challenge=new InteractiveChallenge();
  challenge.setInteractionName(getCurrentTestName());
  challenge.setInteractionInstruction(anchor.getPackage().getName());
  challenge.setLanguageTag(Locale.getDefault().getLanguage());
  final Map<String,String> rspMap=new TreeMap<String,String>(String.CASE_INSENSITIVE_ORDER){
    private static final long serialVersionUID=1L;
{
      put("class",anchor.getSimpleName());
      put("package",anchor.getPackage().getName());
      put("test",getCurrentTestName());
    }
  }
;
  for (  String prompt : rspMap.keySet()) {
    challenge.addPrompt(prompt,(GenericUtils.size(challenge.getPrompts()) & 0x1) != 0);
  }
  PropertyResolverUtils.updateProperty(sshd,ServerFactoryManager.AUTH_METHODS,UserAuthKeyboardInteractiveFactory.NAME);
  final AtomicInteger genCount=new AtomicInteger(0);
  final AtomicInteger authCount=new AtomicInteger(0);
  sshd.setKeyboardInteractiveAuthenticator(new KeyboardInteractiveAuthenticator(){
    @Override public InteractiveChallenge generateChallenge(    ServerSession session,    String username,    String lang,    String subMethods){
      assertEquals("Unexpected challenge call",1,genCount.incrementAndGet());
      return challenge;
    }
    @Override public boolean authenticate(    ServerSession session,    String username,    List<String> responses) throws Exception {
      assertEquals("Unexpected authenticate call",1,authCount.incrementAndGet());
      assertEquals("Mismatched number of responses",GenericUtils.size(rspMap),GenericUtils.size(responses));
      int index=0;
      for (      Map.Entry<String,String> re : rspMap.entrySet()) {
        String prompt=re.getKey();
        String expected=re.getValue();
        String actual=responses.get(index);
        assertEquals("Mismatched response for prompt=" + prompt,expected,actual);
        index++;
      }
      return true;
    }
  }
);
  PropertyResolverUtils.updateProperty(sshd,ServerFactoryManager.AUTH_METHODS,UserAuthKeyboardInteractiveFactory.NAME);
  try (SshClient client=setupTestClient()){
    final AtomicInteger interactiveCount=new AtomicInteger(0);
    client.setUserInteraction(new UserInteraction(){
      @Override public boolean isInteractionAllowed(      ClientSession session){
        return true;
      }
      @Override public void welcome(      ClientSession session,      String banner,      String lang){
      }
      @Override public String[] interactive(      ClientSession session,      String name,      String instruction,      String lang,      String[] prompt,      boolean[] echo){
        assertEquals("Unexpected multiple calls",1,interactiveCount.incrementAndGet());
        assertEquals("Mismatched name",challenge.getInteractionName(),name);
        assertEquals("Mismatched instruction",challenge.getInteractionInstruction(),instruction);
        assertEquals("Mismatched language",challenge.getLanguageTag(),lang);
        List<PromptEntry> entries=challenge.getPrompts();
        assertEquals("Mismatched prompts count",GenericUtils.size(entries),GenericUtils.length(prompt));
        String[] responses=new String[prompt.length];
        for (int index=0; index < prompt.length; index++) {
          PromptEntry e=entries.get(index);
          String key=e.getPrompt();
          assertEquals("Mismatched prompt at index=" + index,key,prompt[index]);
          assertEquals("Mismatched echo at index=" + index,e.isEcho(),echo[index]);
          responses[index]=ValidateUtils.checkNotNull(rspMap.get(key),"No value for prompt=%s",key);
        }
        return responses;
      }
      @Override public String getUpdatedPassword(      ClientSession session,      String prompt,      String lang){
        throw new UnsupportedOperationException("Unexpected call");
      }
    }
);
    PropertyResolverUtils.updateProperty(client,ServerFactoryManager.AUTH_METHODS,UserAuthKeyboardInteractiveFactory.NAME);
    client.start();
    try (ClientSession s=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession()){
      s.auth().verify(11L,TimeUnit.SECONDS);
      assertEquals("Bad generated challenge count",1,genCount.get());
      assertEquals("Bad authentication count",1,authCount.get());
      assertEquals("Bad interactive count",1,interactiveCount.get());
    }
  finally {
      client.stop();
    }
  }
 }

</code></pre>

<br>
<pre class="type-8 type-2 type-3 type-15 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAuthExceptionPropagation() throws Exception {
  try (SshClient client=setupTestClient()){
    final RuntimeException expected=new RuntimeException("Synthetic exception");
    final AtomicInteger invocations=new AtomicInteger(0);
    client.addSessionListener(new SessionListener(){
      @Override public void sessionCreated(      Session session){
      }
      @Override public void sessionEvent(      Session session,      Event event){
        assertEquals("Mismatched invocations count",1,invocations.incrementAndGet());
        throw expected;
      }
      @Override public void sessionException(      Session session,      Throwable t){
      }
      @Override public void sessionClosed(      Session session){
      }
    }
);
    client.start();
    try (ClientSession s=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession()){
      s.addPasswordIdentity(getCurrentTestName());
      AuthFuture future=s.auth();
      assertTrue("Failed to complete auth in allocated time",future.await(11L,TimeUnit.SECONDS));
      assertFalse("Unexpected authentication success",future.isSuccess());
      Throwable actual=future.getException();
      if (actual instanceof IOException) {
        actual=actual.getCause();
      }
      assertSame("Mismatched authentication failure reason",expected,actual);
    }
  finally {
      client.stop();
    }
  }
 }

</code></pre>

<br>
<pre class="type-10 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions inside branch conditions
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testChangePassword() throws Exception {
  final PasswordAuthenticator delegate=sshd.getPasswordAuthenticator();
  final AtomicInteger attemptsCount=new AtomicInteger(0);
  sshd.setPasswordAuthenticator(new PasswordAuthenticator(){
    @Override public boolean authenticate(    String username,    String password,    ServerSession session) throws PasswordChangeRequiredException {
      if (attemptsCount.incrementAndGet() == 1) {
        throw new PasswordChangeRequiredException(attemptsCount.toString(),getCurrentTestName(),ServerFactoryManager.DEFAULT_WELCOME_BANNER_LANGUAGE);
      }
      return delegate.authenticate(username,password,session);
    }
  }
);
  final AtomicInteger changesCount=new AtomicInteger(0);
  sshd.setUserAuthFactories(Collections.<NamedFactory<org.apache.sshd.server.auth.UserAuth>>singletonList(new org.apache.sshd.server.auth.password.UserAuthPasswordFactory(){
    @Override public org.apache.sshd.server.auth.password.UserAuthPassword create(){
      return new org.apache.sshd.server.auth.password.UserAuthPassword(){
        @Override protected Boolean handleClientPasswordChangeRequest(        Buffer buffer,        ServerSession session,        String username,        String oldPassword,        String newPassword) throws Exception {
          if (changesCount.incrementAndGet() == 1) {
            assertNotEquals("Non-different passwords",oldPassword,newPassword);
            return checkPassword(buffer,session,username,newPassword);
          }
 else {
            return super.handleClientPasswordChangeRequest(buffer,session,username,oldPassword,newPassword);
          }
        }
      }
;
    }
  }
));
  PropertyResolverUtils.updateProperty(sshd,ServerFactoryManager.AUTH_METHODS,UserAuthPasswordFactory.NAME);
  try (SshClient client=setupTestClient()){
    final AtomicInteger updatesCount=new AtomicInteger(0);
    client.setUserInteraction(new UserInteraction(){
      @Override public boolean isInteractionAllowed(      ClientSession session){
        return true;
      }
      @Override public void welcome(      ClientSession session,      String banner,      String lang){
      }
      @Override public String[] interactive(      ClientSession session,      String name,      String instruction,      String lang,      String[] prompt,      boolean[] echo){
        throw new UnsupportedOperationException("Unexpected call");
      }
      @Override public String getUpdatedPassword(      ClientSession session,      String prompt,      String lang){
        assertEquals("Mismatched prompt",getCurrentTestName(),prompt);
        assertEquals("Mismatched language",ServerFactoryManager.DEFAULT_WELCOME_BANNER_LANGUAGE,lang);
        assertEquals("Unexpected repeated call",1,updatesCount.incrementAndGet());
        return getCurrentTestName();
      }
    }
);
    final AtomicInteger sentCount=new AtomicInteger(0);
    client.setUserAuthFactories(Collections.<NamedFactory<org.apache.sshd.client.auth.UserAuth>>singletonList(new org.apache.sshd.client.auth.password.UserAuthPasswordFactory(){
      @Override public org.apache.sshd.client.auth.password.UserAuthPassword create(){
        return new org.apache.sshd.client.auth.password.UserAuthPassword(){
          @Override protected void sendPassword(          Buffer buffer,          ClientSession session,          String oldPassword,          String newPassword) throws IOException {
            int count=sentCount.incrementAndGet();
            if (count == 2) {
              super.sendPassword(buffer,session,getClass().getName(),newPassword);
            }
 else {
              super.sendPassword(buffer,session,oldPassword,newPassword);
            }
          }
        }
;
      }
    }
));
    PropertyResolverUtils.updateProperty(client,ServerFactoryManager.AUTH_METHODS,UserAuthPasswordFactory.NAME);
    client.start();
    try (ClientSession s=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession()){
      s.addPasswordIdentity(getCurrentTestName());
      s.auth().verify(11L,TimeUnit.SECONDS);
      assertEquals("No password change request generated",2,attemptsCount.get());
      assertEquals("No password change handled",1,changesCount.get());
      assertEquals("No user interaction invoked",1,updatesCount.get());
    }
  finally {
      client.stop();
    }
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.auth.SinglePublicKeyAuthTest </h4><pre class="type-8 type-2 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPublicKeyAuthWithCache() throws Exception {
  final ConcurrentHashMap<String,AtomicInteger> count=new ConcurrentHashMap<String,AtomicInteger>();
  TestCachingPublicKeyAuthenticator auth=new TestCachingPublicKeyAuthenticator(new PublickeyAuthenticator(){
    @SuppressWarnings("synthetic-access") @Override public boolean authenticate(    String username,    PublicKey key,    ServerSession session){
      String fp=KeyUtils.getFingerPrint(key);
      count.putIfAbsent(fp,new AtomicInteger());
      count.get(fp).incrementAndGet();
      return key.equals(pairRsa.getPublic());
    }
  }
);
  delegate=auth;
  try (SshClient client=setupTestClient()){
    client.start();
    try (ClientSession session=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession()){
      session.addPublicKeyIdentity(pairRsaBad);
      session.addPublicKeyIdentity(pairRsa);
      session.auth().verify(5L,TimeUnit.SECONDS);
      assertEquals("Mismatched authentication invocations count",2,count.size());
      String fpBad=KeyUtils.getFingerPrint(pairRsaBad.getPublic());
      String fpGood=KeyUtils.getFingerPrint(pairRsa.getPublic());
      assertTrue("Missing bad public key",count.containsKey(fpBad));
      assertTrue("Missing good public key",count.containsKey(fpGood));
      assertEquals("Mismatched bad key authentication attempts",1,count.get(fpBad).get());
      assertEquals("Mismatched good key authentication attempts",1,count.get(fpGood).get());
    }
  finally {
      client.stop();
    }
  }
   Thread.sleep(100L);
  assertTrue("Cache not empty",auth.getCache().isEmpty());
}

</code></pre>

<br>
<pre class="type-8 type-2 type-3 type-7 type-12 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testPublicKeyAuthWithoutCache() throws Exception {
  final ConcurrentHashMap<String,AtomicInteger> count=new ConcurrentHashMap<String,AtomicInteger>();
  delegate=new PublickeyAuthenticator(){
    @SuppressWarnings("synthetic-access") @Override public boolean authenticate(    String username,    PublicKey key,    ServerSession session){
      String fp=KeyUtils.getFingerPrint(key);
      count.putIfAbsent(fp,new AtomicInteger());
      count.get(fp).incrementAndGet();
      return key.equals(pairRsa.getPublic());
    }
  }
;
  try (SshClient client=setupTestClient()){
    client.start();
    try (ClientSession session=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession()){
      session.addPublicKeyIdentity(pairRsaBad);
      session.addPublicKeyIdentity(pairRsa);
      AuthFuture auth=session.auth();
      assertTrue("Failed to authenticate on time",auth.await(5L,TimeUnit.SECONDS));
      assertTrue("Authentication failed",auth.isSuccess());
    }
  finally {
      client.stop();
    }
  }
   assertEquals("Mismatched attempted keys count",2,count.size());
  String badFingerPrint=KeyUtils.getFingerPrint(pairRsaBad.getPublic());
  Number badIndex=count.get(badFingerPrint);
  assertNotNull("Missing bad RSA key",badIndex);
  assertEquals("Mismatched attempt index for bad key",1,badIndex.intValue());
  String goodFingerPrint=KeyUtils.getFingerPrint(pairRsa.getPublic());
  Number goodIndex=count.get(goodFingerPrint);
  assertNotNull("Missing good RSA key",goodIndex);
  assertEquals("Mismatched attempt index for good key",2,goodIndex.intValue());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.channel.ChannelPipedInputStreamTest </h4><pre class="type-3 type-7 type-13 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testAvailable() throws IOException {
  try (ChannelPipedInputStream stream=createTestStream()){
    byte[] b=getCurrentTestName().getBytes(StandardCharsets.UTF_8);
    stream.receive(b,0,b.length);
    assertEquals("Mismatched reported available size after receive",b.length,stream.available());
    stream.eof();
    assertEquals("Mismatched reported available size after EOF",b.length,stream.available());
    byte[] readBytes=new byte[b.length + Long.SIZE];
    assertEquals("Mismatched reported read size",b.length,stream.read(readBytes));
    assertStreamEquals(b,readBytes);
    assertEquals("Unexpected data still available",-1,stream.available());
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.channel.ChannelPipedOutputStreamTest </h4><pre class="type-6 type-2 type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNioChannelImplementation() throws IOException {
  ChannelPipedSink sink=Mockito.mock(ChannelPipedSink.class);
  final AtomicBoolean eofCalled=new AtomicBoolean(false);
  Mockito.doAnswer(new Answer<Void>(){
    @Override public Void answer(    InvocationOnMock invocation) throws Throwable {
      assertFalse("Multiple EOF calls",eofCalled.getAndSet(true));
      return null;
    }
  }
).when(sink).eof();
  final AtomicInteger receiveCount=new AtomicInteger(0);
  Mockito.doAnswer(new Answer<Void>(){
    @Override public Void answer(    InvocationOnMock invocation) throws Throwable {
      Number len=invocation.getArgumentAt(2,Number.class);
      receiveCount.addAndGet(len.intValue());
      return null;
    }
  }
).when(sink).receive(Matchers.any(byte[].class),Matchers.anyInt(),Matchers.anyInt());
  try (ChannelPipedOutputStream stream=new ChannelPipedOutputStream(sink)){
    assertTrue("Stream not marked as initially open",stream.isOpen());
    assertEquals("Unexpected initial receive count",0,receiveCount.intValue());
    byte[] b=getCurrentTestName().getBytes(StandardCharsets.UTF_8);
    stream.write(b);
    assertTrue("Stream not marked as still open after write data",stream.isOpen());
    assertEquals("Mismatched write data count",b.length,receiveCount.intValue());
    stream.close();
    assertFalse("Stream still marked as open after close",stream.isOpen());
    assertTrue("Sink EOF not called on close",eofCalled.get());
    try {
      stream.write(b);
      fail("Unexpected write success after close");
    }
 catch (    IOException e) {
    }
    try {
      stream.flush();
      fail("Unexpected flush success after close");
    }
 catch (    IOException e) {
    }
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.channel.PtyModeTest </h4><pre class="type-8 type-15 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEnabledOptions(){
  Set<PtyMode> expected=EnumSet.of(PtyMode.ECHO,PtyMode.CS8,PtyMode.ICANON);
  Map<PtyMode,Integer> modes=PtyMode.createEnabledOptions(expected);
  assertEquals("Mismatched modes size",expected.size(),GenericUtils.size(modes));
  for (  PtyMode m : expected) {
    assertSame("Mismatched setting for " + m,PtyMode.TRUE_SETTING,modes.get(m));
  }
  Set<PtyMode> actual=PtyMode.resolveEnabledOptions(modes,expected);
  assertEquals("Mismatched enabled options",expected,actual);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.channel.WindowTest </h4><pre class="type-11 type-8 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testWindowConsumptionWithDirectStreams() throws Exception {
  sshd.setShellFactory(new AsyncEchoShellFactory());
  PropertyResolverUtils.updateProperty(sshd,FactoryManager.WINDOW_SIZE,1024);
  PropertyResolverUtils.updateProperty(client,FactoryManager.WINDOW_SIZE,1024);
  client.start();
  try (ClientSession session=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession()){
    session.addPasswordIdentity(getCurrentTestName());
    session.auth().verify(5L,TimeUnit.SECONDS);
    try (ChannelShell channel=session.createShellChannel();PipedInputStream inPis=new PipedInputStream();PipedOutputStream inPos=new PipedOutputStream(inPis);PipedInputStream outPis=new PipedInputStream();PipedOutputStream outPos=new PipedOutputStream(outPis)){
      channel.setIn(inPis);
      channel.setOut(outPos);
      channel.open().verify(7L,TimeUnit.SECONDS);
      try (Channel serverChannel=sshd.getActiveSessions().iterator().next().getService(ServerConnectionService.class).getChannels().iterator().next()){
        Window clientLocal=channel.getLocalWindow();
        Window clientRemote=channel.getRemoteWindow();
        Window serverLocal=serverChannel.getLocalWindow();
        Window serverRemote=serverChannel.getRemoteWindow();
        final String message="0123456789";
        final int nbMessages=500;
        try (BufferedWriter writer=new BufferedWriter(new OutputStreamWriter(inPos));BufferedReader reader=new BufferedReader(new InputStreamReader(outPis))){
          for (int i=0; i < nbMessages; i++) {
            writer.write(message);
            writer.write('\n');
            writer.flush();
            waitForWindowEquals(clientLocal,serverRemote,"client local","server remote",TimeUnit.SECONDS.toMillis(3L));
            String line=reader.readLine();
            assertEquals("Mismatched message at line #" + i,message,line);
            waitForWindowEquals(clientLocal,serverRemote,"client local","server remote",TimeUnit.SECONDS.toMillis(3L));
            waitForWindowEquals(clientRemote,serverLocal,"client remote","server local",TimeUnit.SECONDS.toMillis(3L));
          }
        }
       }
     }
   }
  finally {
    client.stop();
  }
}

</code></pre>

<br>
<pre class="type-11 type-3 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testWindowConsumptionWithAsyncStreams() throws Exception {
  sshd.setShellFactory(new AsyncEchoShellFactory());
  PropertyResolverUtils.updateProperty(sshd,FactoryManager.WINDOW_SIZE,1024);
  PropertyResolverUtils.updateProperty(client,FactoryManager.WINDOW_SIZE,1024);
  client.start();
  try (ClientSession session=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession()){
    session.addPasswordIdentity(getCurrentTestName());
    session.auth().verify(5L,TimeUnit.SECONDS);
    try (ChannelShell channel=session.createShellChannel()){
      channel.setStreaming(ClientChannel.Streaming.Async);
      channel.open().verify(5L,TimeUnit.SECONDS);
      try (Channel serverChannel=sshd.getActiveSessions().iterator().next().getService(ServerConnectionService.class).getChannels().iterator().next()){
        Window clientLocal=channel.getLocalWindow();
        Window clientRemote=channel.getRemoteWindow();
        Window serverLocal=serverChannel.getLocalWindow();
        Window serverRemote=serverChannel.getRemoteWindow();
        final String message="0123456789\n";
        final byte[] bytes=message.getBytes(StandardCharsets.UTF_8);
        final int nbMessages=500;
        IoOutputStream output=channel.getAsyncIn();
        IoInputStream input=channel.getAsyncOut();
        for (int i=0; i < nbMessages; i++) {
          Buffer buffer=new ByteArrayBuffer(bytes);
          output.write(buffer).verify(5L,TimeUnit.SECONDS);
          waitForWindowNotEquals(clientLocal,serverRemote,"client local","server remote",TimeUnit.SECONDS.toMillis(3L));
          Buffer buf=new ByteArrayBuffer(16);
          IoReadFuture future=input.read(buf);
          future.verify(5L,TimeUnit.SECONDS);
          assertEquals("Mismatched available data at line #" + i,message.length(),buf.available());
          assertEquals("Mismatched data at line #" + i,message,new String(buf.array(),buf.rpos(),buf.available()));
          waitForWindowEquals(clientLocal,serverRemote,"client local","server remote",TimeUnit.SECONDS.toMillis(3L));
          waitForWindowEquals(clientRemote,serverLocal,"client remote","server local",TimeUnit.SECONDS.toMillis(3L));
        }
      }
     }
   }
  finally {
    client.stop();
  }
}

</code></pre>

<br>
<pre class="type-11 type-8 type-3 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testWindowConsumptionWithInvertedStreams() throws Exception {
  sshd.setShellFactory(new AsyncEchoShellFactory());
  PropertyResolverUtils.updateProperty(sshd,FactoryManager.WINDOW_SIZE,1024);
  PropertyResolverUtils.updateProperty(client,FactoryManager.WINDOW_SIZE,1024);
  client.start();
  try (ClientSession session=client.connect(getCurrentTestName(),TEST_LOCALHOST,port).verify(7L,TimeUnit.SECONDS).getSession()){
    session.addPasswordIdentity(getCurrentTestName());
    session.auth().verify(5L,TimeUnit.SECONDS);
    try (ChannelShell channel=session.createShellChannel()){
      channel.open().verify(5L,TimeUnit.SECONDS);
      try (Channel serverChannel=sshd.getActiveSessions().iterator().next().getService(ServerConnectionService.class).getChannels().iterator().next()){
        Window clientLocal=channel.getLocalWindow();
        Window clientRemote=channel.getRemoteWindow();
        Window serverLocal=serverChannel.getLocalWindow();
        Window serverRemote=serverChannel.getRemoteWindow();
        final String message="0123456789";
        final int nbMessages=500;
        try (BufferedWriter writer=new BufferedWriter(new OutputStreamWriter(channel.getInvertedIn()));BufferedReader reader=new BufferedReader(new InputStreamReader(channel.getInvertedOut()))){
          for (int i=0; i < nbMessages; i++) {
            writer.write(message);
            writer.write("\n");
            writer.flush();
            waitForWindowNotEquals(clientLocal,serverRemote,"client local","server remote",TimeUnit.SECONDS.toMillis(3L));
            String line=reader.readLine();
            assertEquals("Mismatched message at line #" + i,message,line);
            waitForWindowEquals(clientLocal,serverRemote,"client local","server remote",TimeUnit.SECONDS.toMillis(3L));
            waitForWindowEquals(clientRemote,serverLocal,"client remote","server local",TimeUnit.SECONDS.toMillis(3L));
          }
        }
       }
     }
   }
  finally {
    client.stop();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.channel.WindowTimeoutTest </h4><pre class="type-6 type-2 type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testWindowWaitForSpaceTimeout() throws Exception {
  try (Window window=channel.getLocalWindow()){
    window.init(FactoryManager.DEFAULT_WINDOW_SIZE,FactoryManager.DEFAULT_MAX_PACKET_SIZE,null);
    window.consume(window.getSize());
    assertEquals("Window not empty",0,window.getSize());
    long waitStart=System.nanoTime();
    try {
      int len=window.waitForSpace(MAX_WAIT_TIME);
      fail("Unexpected timed wait success - len=" + len);
    }
 catch (    SocketTimeoutException e) {
      long waitEnd=System.nanoTime();
      long waitDuration=TimeUnit.NANOSECONDS.toMillis(waitEnd - waitStart);
      assertTrue("Timeout too soon: " + waitDuration,waitDuration >= (MAX_WAIT_TIME - 100L));
    }
    window.close();
    assertFalse("Window not closed",window.isOpen());
    try {
      int len=window.waitForSpace(MAX_WAIT_TIME);
      fail("Unexpected closed wait success - len=" + len);
    }
 catch (    WindowClosedException e) {
    }
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.cipher.BuiltinCiphersTest </h4><pre class="type-11 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testNotAllowedToOverrideRegisteredFactories(){
  CipherFactory expected=Mockito.mock(CipherFactory.class);
  Mockito.when(expected.getName()).thenReturn(getCurrentTestName());
  String name=expected.getName();
  try {
    for (int index=1; index <= Byte.SIZE; index++) {
      BuiltinCiphers.registerExtension(expected);
      assertEquals("Unexpected success at attempt #" + index,1,index);
    }
  }
  finally {
    BuiltinCiphers.unregisterExtension(name);
  }
}

</code></pre>

<br>
<pre class="type-8 type-3 type-15 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFromFactory(){
  for (  BuiltinCiphers expected : BuiltinCiphers.VALUES) {
    if (!expected.isSupported()) {
      System.out.append("Skip unsupported cipher: ").println(expected);
      continue;
    }
    NamedFactory<Cipher> factory=expected;
    assertEquals(expected.name() + " - mismatched factory names",expected.getName(),factory.getName());
    BuiltinCiphers actual=BuiltinCiphers.fromFactory(factory);
    assertSame(expected.getName() + " - mismatched enum values",expected,actual);
  }
}

</code></pre>

<br>
<pre class="type-8 type-2 type-7 type-12 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAllConstantsCovered() throws Exception {
  Set<BuiltinCiphers> avail=EnumSet.noneOf(BuiltinCiphers.class);
  Field[] fields=BuiltinCiphers.Constants.class.getFields();
  for (  Field f : fields) {
    int mods=f.getModifiers();
    if (!Modifier.isStatic(mods)) {
      continue;
    }
    Class<?> type=f.getType();
    if (!String.class.isAssignableFrom(type)) {
      continue;
    }
    String name=Objects.toString(f.get(null),null);
    BuiltinCiphers value=BuiltinCiphers.fromFactoryName(name);
    assertNotNull("No match found for " + name,value);
    assertTrue(name + " re-specified",avail.add(value));
  }
  assertEquals("Incomplete coverage",BuiltinCiphers.VALUES,avail);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.cipher.ECCurvesTest </h4><pre class="type-8 type-2 type-7 type-12 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAllNamesListed(){
  Set<ECCurves> listed=EnumSet.noneOf(ECCurves.class);
  for (  String name : ECCurves.NAMES) {
    ECCurves c=ECCurves.fromCurveName(name);
    assertNotNull("No curve for listed name=" + name,c);
    assertTrue("Duplicated listed name: " + name,listed.add(c));
  }
  assertEquals("Mismatched listed vs. values",ECCurves.VALUES,listed);
}

</code></pre>

<br>
<pre class="type-8 type-2 type-7 type-12 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAllKeyTypesListed(){
  Set<ECCurves> listed=EnumSet.noneOf(ECCurves.class);
  for (  String name : ECCurves.KEY_TYPES) {
    ECCurves c=ECCurves.fromKeyType(name);
    assertNotNull("No curve for listed key type=" + name,c);
    assertTrue("Duplicated listed key type: " + name,listed.add(c));
  }
  assertEquals("Mismatched listed vs. values",ECCurves.VALUES,listed);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.compression.BuiltinCompressionsTest </h4><pre class="type-8 type-2 type-7 type-12 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAllConstantsCovered() throws Exception {
  Set<BuiltinCompressions> avail=EnumSet.noneOf(BuiltinCompressions.class);
  Field[] fields=BuiltinCompressions.Constants.class.getFields();
  for (  Field f : fields) {
    String name=(String)f.get(null);
    BuiltinCompressions value=BuiltinCompressions.fromFactoryName(name);
    assertNotNull("No match found for " + name,value);
    assertTrue(name + " re-specified",avail.add(value));
  }
  assertEquals("Incomplete coverage",BuiltinCompressions.VALUES,avail);
}

</code></pre>

<br>
<pre class="type-11 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testNotAllowedToOverrideRegisteredFactories(){
  CompressionFactory expected=Mockito.mock(CompressionFactory.class);
  Mockito.when(expected.getName()).thenReturn(getCurrentTestName());
  String name=expected.getName();
  try {
    for (int index=1; index <= Byte.SIZE; index++) {
      BuiltinCompressions.registerExtension(expected);
      assertEquals("Unexpected success at attempt #" + index,1,index);
    }
  }
  finally {
    BuiltinCompressions.unregisterExtension(name);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.compression.CompressionTest </h4><pre class="type-11 type-8 type-3 type-14 type-7 type-13 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompression() throws Exception {
  Assume.assumeTrue("Skip unsupported compression " + factory,factory.isSupported());
  JSch sch=new JSch();
  com.jcraft.jsch.Session s=sch.getSession(getCurrentTestName(),TEST_LOCALHOST,sshd.getPort());
  s.setUserInfo(new SimpleUserInfo(getCurrentTestName()));
  s.connect();
  try {
    com.jcraft.jsch.Channel c=s.openChannel(Channel.CHANNEL_SHELL);
    c.connect();
    try (OutputStream os=c.getOutputStream();InputStream is=c.getInputStream()){
      String STR="this is my command\n";
      byte[] bytes=STR.getBytes(StandardCharsets.UTF_8);
      byte[] data=new byte[bytes.length + Long.SIZE];
      for (int i=1; i <= 10; i++) {
        os.write(bytes);
        os.flush();
        int len=is.read(data);
        String str=new String(data,0,len,StandardCharsets.UTF_8);
        assertEquals("Mismatched read data at iteration #" + i,STR,str);
      }
    }
  finally {
      c.disconnect();
    }
  }
  finally {
    s.disconnect();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.config.SshConfigFileReaderTest </h4><pre class="type-8 type-3 type-7 type-12 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetCompression(){
  Properties props=new Properties();
  for (  CompressionConfigValue expected : CompressionConfigValue.VALUES) {
    props.setProperty(SshConfigFileReader.COMPRESSION_PROP,expected.name().toLowerCase());
    NamedResource actual=SshConfigFileReader.getCompression(props);
    assertNotNull("No match for " + expected.name(),actual);
    assertEquals(expected.name(),expected.getName(),actual.getName());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.config.TimeValueConfigTest </h4><pre class="type-11 type-8 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDurationOf(){
  Object[] values={"600",Long.valueOf(TimeUnit.SECONDS.toMillis(600L)),"10m",Long.valueOf(TimeUnit.MINUTES.toMillis(10L)),"1h30m",Long.valueOf(TimeUnit.MINUTES.toMillis(90L)),"2d",Long.valueOf(TimeUnit.DAYS.toMillis(2L)),"3w",Long.valueOf(TimeUnit.DAYS.toMillis(3L * 7L))};
  for (int index=0; index < values.length; index+=2) {
    String s=(String)values[index];
    Number expected=(Number)values[index + 1];
    long actual=TimeValueConfig.durationOf(s);
    assertEquals(s,expected.longValue(),actual);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.config.keys.KeyUtilsFingerprintCaseSensitivityTest </h4><pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testCase() throws Exception {
  assertEquals("Check failed",new Pair<Boolean,String>(true,expected),KeyUtils.checkFingerPrint(test,key));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.config.keys.KeyUtilsFingerprintGenerationTest </h4><pre class="type-3 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testFingerprint() throws Exception {
  String name=digestFactory.getName();
  assertEquals(String.format("Fingerprint does not match for digest %s",name),expected,KeyUtils.getFingerPrint(digestFactory,key));
  assertEquals(String.format("Fingerprint check failed for digest %s",name),new Pair<Boolean,String>(true,expected),KeyUtils.checkFingerPrint(expected,digestFactory,key));
  assertEquals(String.format("Fingerprint check succeeded for invalid digest %s",name),new Pair<Boolean,String>(false,expected),KeyUtils.checkFingerPrint(expected + "A",digestFactory,key));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.config.keys.KeyUtilsTest </h4><pre class="type-8 type-3 type-7 type-12 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGenerateDefaultFingerprintDigest(){
  final DigestFactory defaultValue=KeyUtils.getDefaultFingerPrintFactory();
  assertNotNull("No current default fingerprint digest factory",defaultValue);
  try {
    for (    DigestFactory f : BuiltinDigests.VALUES) {
      if (!f.isSupported()) {
        System.out.println("Skip unsupported digest=" + f.getAlgorithm());
        continue;
      }
      KeyUtils.setDefaultFingerPrintFactory(f);
      String data=getClass().getName() + "#" + getCurrentTestName()+ "("+ f.getName()+ ")";
      String expected=KeyUtils.getFingerPrint(f,data);
      String actual=KeyUtils.getFingerPrint(data);
      assertEquals("Mismatched fingerprint for digest=" + f.getName(),expected,actual);
    }
  }
  finally {
    KeyUtils.setDefaultFingerPrintFactory(defaultValue);
  }
}

</code></pre>

<br>
<pre class="type-8 type-3 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGenerateFingerPrintOnException(){
  for (  final DigestFactory info : BuiltinDigests.VALUES) {
    if (!info.isSupported()) {
      System.out.println("Skip unsupported digest: " + info.getAlgorithm());
      continue;
    }
    final Exception thrown=new DigestException(info.getAlgorithm() + ":" + info.getBlockSize());
    final Digest digest=new BaseDigest(info.getAlgorithm(),info.getBlockSize()){
      @Override public byte[] digest() throws Exception {
        throw thrown;
      }
    }
;
    String actual=KeyUtils.getFingerPrint(new DigestFactory(){
      @Override public String getName(){
        return getCurrentTestName();
      }
      @Override public String getAlgorithm(){
        return digest.getAlgorithm();
      }
      @Override public boolean isSupported(){
        return info.isSupported();
      }
      @Override public int getBlockSize(){
        return info.getBlockSize();
      }
      @Override public Digest create(){
        return digest;
      }
    }
,getCurrentTestName());
    String expected=thrown.getClass().getSimpleName();
    assertEquals("Mismatched fingerprint for " + thrown.getMessage(),expected,actual);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.digest.BuiltinDigestsTest </h4><pre class="type-8 type-2 type-7 type-12 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAllConstantsCovered() throws Exception {
  Set<BuiltinDigests> avail=EnumSet.noneOf(BuiltinDigests.class);
  Field[] fields=BuiltinDigests.Constants.class.getFields();
  for (  Field f : fields) {
    String name=(String)f.get(null);
    BuiltinDigests value=BuiltinDigests.fromFactoryName(name);
    assertNotNull("No match found for " + name,value);
    assertTrue(name + " re-specified",avail.add(value));
  }
  assertEquals("Incomplete coverage",BuiltinDigests.VALUES,avail);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.file.util.BasePathTest </h4><pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testRelativePathSingleName(){
  new PathTester(fileSystem,"test").names("test").test("test");
  Path path=parsePath("test");
  assertEquals(path,path.getFileName());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.forward.PortForwardingLoadTest </h4><pre class="type-11 type-8 type-7 type-13 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testLocalForwardingPayload() throws Exception {
  final int NUM_ITERATIONS=100;
  final String PAYLOAD_TMP="This is significantly longer Test Data. This is significantly " + "longer Test Data. This is significantly longer Test Data. This is significantly " + "longer Test Data. This is significantly longer Test Data. This is significantly "+ "longer Test Data. This is significantly longer Test Data. This is significantly "+ "longer Test Data. This is significantly longer Test Data. This is significantly "+ "longer Test Data. ";
  StringBuilder sb=new StringBuilder(PAYLOAD_TMP.length() * 1000);
  for (int i=0; i < 1000; i++) {
    sb.append(PAYLOAD_TMP);
  }
  final String PAYLOAD=sb.toString();
  Session session=createSession();
  try (final ServerSocket ss=new ServerSocket()){
    ss.setReuseAddress(true);
    ss.bind(new InetSocketAddress((InetAddress)null,0));
    int forwardedPort=ss.getLocalPort();
    int sinkPort=session.setPortForwardingL(0,TEST_LOCALHOST,forwardedPort);
    final AtomicInteger conCount=new AtomicInteger(0);
    Thread tAcceptor=new Thread(getCurrentTestName() + "Acceptor"){
      @SuppressWarnings("synthetic-access") @Override public void run(){
        try {
          byte[] buf=new byte[8192];
          log.info("Started...");
          for (int i=0; i < NUM_ITERATIONS; ++i) {
            try (Socket s=ss.accept()){
              conCount.incrementAndGet();
              try (InputStream sockIn=s.getInputStream();ByteArrayOutputStream baos=new ByteArrayOutputStream()){
                int l;
                while ((baos.size() < PAYLOAD.length()) && ((l=sockIn.read(buf)) > 0)) {
                  baos.write(buf,0,l);
                }
                assertEquals("Mismatched received data at iteration #" + i,PAYLOAD,baos.toString());
                try (InputStream inputCopy=new ByteArrayInputStream(baos.toByteArray());OutputStream sockOut=s.getOutputStream()){
                  while ((l=sockIn.read(buf)) > 0) {
                    sockOut.write(buf,0,l);
                  }
                }
               }
             }
           }
          log.info("Done");
        }
 catch (        Exception e) {
          log.error("Failed to complete run loop",e);
        }
      }
    }
;
    tAcceptor.start();
    Thread.sleep(50);
    byte[] buf=new byte[8192];
    byte[] bytes=PAYLOAD.getBytes(StandardCharsets.UTF_8);
    for (int i=0; i < NUM_ITERATIONS; i++) {
      log.info("Iteration {}",Integer.valueOf(i));
      try (Socket s=new Socket(TEST_LOCALHOST,sinkPort);OutputStream sockOut=s.getOutputStream()){
        s.setSoTimeout((int)TimeUnit.SECONDS.toMillis(10L));
        sockOut.write(bytes);
        sockOut.flush();
        try (InputStream sockIn=s.getInputStream();ByteArrayOutputStream baos=new ByteArrayOutputStream(bytes.length)){
          int l;
          while ((baos.size() < PAYLOAD.length()) && ((l=sockIn.read(buf)) > 0)) {
            baos.write(buf,0,l);
          }
          assertEquals("Mismatched payload at iteration #" + i,PAYLOAD,baos.toString());
        }
       }
 catch (      Exception e) {
        log.error("Error in iteration #" + i,e);
      }
    }
    session.delPortForwardingL(sinkPort);
    ss.close();
    tAcceptor.join(TimeUnit.SECONDS.toMillis(5L));
  }
  finally {
    session.disconnect();
  }
}

</code></pre>

<br>
<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testForwardingOnLoad() throws Exception {
  final String path="";
  final String host=TEST_LOCALHOST;
  final int nbThread=2;
  final int nbDownloads=2;
  final int nbLoops=2;
  StringBuilder resp=new StringBuilder();
  resp.append("<html><body>\n");
  for (int i=0; i < 1000; i++) {
    resp.append("0123456789\n");
  }
  resp.append("</body></html>\n");
  final StringBuilder sb=new StringBuilder();
  sb.append("HTTP/1.1 200 OK").append('\n');
  sb.append("Content-Type: text/HTML").append('\n');
  sb.append("Content-Length: ").append(resp.length()).append('\n');
  sb.append('\n');
  sb.append(resp);
  NioSocketAcceptor acceptor=new NioSocketAcceptor();
  acceptor.setHandler(new IoHandlerAdapter(){
    @Override public void messageReceived(    IoSession session,    Object message) throws Exception {
      session.write(IoBuffer.wrap(sb.toString().getBytes(StandardCharsets.UTF_8)));
    }
  }
);
  acceptor.setReuseAddress(true);
  acceptor.bind(new InetSocketAddress(0));
  final int port=acceptor.getLocalAddress().getPort();
  Session session=createSession();
  try {
    final int forwardedPort1=session.setPortForwardingL(0,host,port);
    final int forwardedPort2=Utils.getFreePort();
    session.setPortForwardingR(forwardedPort2,TEST_LOCALHOST,forwardedPort1);
    System.err.println("URL: http://localhost:" + forwardedPort2);
    final CountDownLatch latch=new CountDownLatch(nbThread * nbDownloads * nbLoops);
    final Thread[] threads=new Thread[nbThread];
    final List<Throwable> errors=new CopyOnWriteArrayList<Throwable>();
    for (int i=0; i < threads.length; i++) {
      threads[i]=new Thread(getCurrentTestName() + "[" + i+ "]"){
        @Override public void run(){
          for (int j=0; j < nbLoops; j++) {
            final MultiThreadedHttpConnectionManager mgr=new MultiThreadedHttpConnectionManager();
            final HttpClient client=new HttpClient(mgr);
            client.getHttpConnectionManager().getParams().setDefaultMaxConnectionsPerHost(100);
            client.getHttpConnectionManager().getParams().setMaxTotalConnections(1000);
            for (int i=0; i < nbDownloads; i++) {
              try {
                checkHtmlPage(client,new URL("http://localhost:" + forwardedPort2 + path));
              }
 catch (              Throwable e) {
                errors.add(e);
              }
 finally {
                latch.countDown();
                System.err.println("Remaining: " + latch.getCount());
              }
            }
            mgr.shutdown();
          }
        }
      }
;
    }
    for (int i=0; i < threads.length; i++) {
      threads[i].start();
    }
    latch.await();
    for (    Throwable t : errors) {
      t.printStackTrace();
    }
    assertEquals(0,errors.size());
  }
  finally {
    session.disconnect();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.forward.PortForwardingTest </h4><pre class="type-11 type-8 type-3 type-7 type-13 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testLocalForwardingNativeBigPayload() throws Exception {
  try (ClientSession session=createNativeSession()){
    String expected=getCurrentTestName();
    byte[] bytes=expected.getBytes(StandardCharsets.UTF_8);
    byte[] buf=new byte[bytes.length + Long.SIZE];
    SshdSocketAddress local=new SshdSocketAddress("",0);
    SshdSocketAddress remote=new SshdSocketAddress(TEST_LOCALHOST,echoPort);
    SshdSocketAddress bound=session.startLocalPortForwarding(local,remote);
    try (Socket s=new Socket(bound.getHostName(),bound.getPort());OutputStream output=s.getOutputStream();InputStream input=s.getInputStream()){
      s.setSoTimeout((int)TimeUnit.SECONDS.toMillis(10L));
      for (int i=0; i < 1000; i++) {
        output.write(bytes);
        output.flush();
        int n=input.read(buf);
        String res=new String(buf,0,n);
        assertEquals("Mismatched data at iteration #" + i,expected,res);
      }
    }
  finally {
      session.stopLocalPortForwarding(bound);
    }
  }
 }

</code></pre>

<br>
<pre class="type-11 type-8 type-3 type-7 type-13 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testRemoteForwardingNativeBigPayload() throws Exception {
  try (ClientSession session=createNativeSession()){
    SshdSocketAddress remote=new SshdSocketAddress("",0);
    SshdSocketAddress local=new SshdSocketAddress(TEST_LOCALHOST,echoPort);
    SshdSocketAddress bound=session.startRemotePortForwarding(remote,local);
    try (Socket s=new Socket(bound.getHostName(),bound.getPort());OutputStream output=s.getOutputStream();InputStream input=s.getInputStream()){
      s.setSoTimeout((int)TimeUnit.SECONDS.toMillis(10L));
      String expected=getCurrentTestName();
      byte[] bytes=expected.getBytes(StandardCharsets.UTF_8);
      byte[] buf=new byte[bytes.length + Long.SIZE];
      for (int i=0; i < 1000; i++) {
        output.write(bytes);
        output.flush();
        int n=input.read(buf);
        String res=new String(buf,0,n);
        assertEquals("Mismatched data at iteration #" + i,expected,res);
      }
    }
  finally {
      session.stopRemotePortForwarding(remote);
    }
  }
 }

</code></pre>

<br>
<pre class="type-8 type-7 type-13 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testRemoteForwardingSecondTimeInSameSession() throws Exception {
  Session session=createSession();
  try {
    int forwardedPort=Utils.getFreePort();
    session.setPortForwardingR(forwardedPort,TEST_LOCALHOST,echoPort);
    waitForForwardingRequest(TcpipForwardHandler.REQUEST,TimeUnit.SECONDS.toMillis(5L));
    session.delPortForwardingR(TEST_LOCALHOST,forwardedPort);
    waitForForwardingRequest(CancelTcpipForwardHandler.REQUEST,TimeUnit.SECONDS.toMillis(5L));
    session.setPortForwardingR(forwardedPort,TEST_LOCALHOST,echoPort);
    waitForForwardingRequest(TcpipForwardHandler.REQUEST,TimeUnit.SECONDS.toMillis(5L));
    try (Socket s=new Socket(TEST_LOCALHOST,forwardedPort);OutputStream output=s.getOutputStream();InputStream input=s.getInputStream()){
      s.setSoTimeout((int)TimeUnit.SECONDS.toMillis(10L));
      String expected=getCurrentTestName();
      byte[] bytes=expected.getBytes(StandardCharsets.UTF_8);
      output.write(bytes);
      output.flush();
      byte[] buf=new byte[bytes.length + Long.SIZE];
      int n=input.read(buf);
      String res=new String(buf,0,n,StandardCharsets.UTF_8);
      assertEquals("Mismatched data",expected,res);
    }
  finally {
      session.delPortForwardingR(TEST_LOCALHOST,forwardedPort);
    }
  }
  finally {
    session.disconnect();
  }
}

</code></pre>

<br>
<pre class="type-8 type-7 type-13 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testRemoteForwarding() throws Exception {
  Session session=createSession();
  try {
    int forwardedPort=Utils.getFreePort();
    session.setPortForwardingR(forwardedPort,TEST_LOCALHOST,echoPort);
    waitForForwardingRequest(TcpipForwardHandler.REQUEST,TimeUnit.SECONDS.toMillis(5L));
    try (Socket s=new Socket(TEST_LOCALHOST,forwardedPort);OutputStream output=s.getOutputStream();InputStream input=s.getInputStream()){
      s.setSoTimeout((int)TimeUnit.SECONDS.toMillis(10L));
      String expected=getCurrentTestName();
      byte[] bytes=expected.getBytes(StandardCharsets.UTF_8);
      output.write(bytes);
      output.flush();
      byte[] buf=new byte[bytes.length + Long.SIZE];
      int n=input.read(buf);
      String res=new String(buf,0,n,StandardCharsets.UTF_8);
      assertEquals("Mismatched data",expected,res);
    }
  finally {
      session.delPortForwardingR(forwardedPort);
    }
  }
  finally {
    session.disconnect();
  }
}

</code></pre>

<br>
<pre class="type-8 type-3 type-7 type-13 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testLocalForwardingNative() throws Exception {
  try (ClientSession session=createNativeSession()){
    SshdSocketAddress local=new SshdSocketAddress("",0);
    SshdSocketAddress remote=new SshdSocketAddress(TEST_LOCALHOST,echoPort);
    SshdSocketAddress bound=session.startLocalPortForwarding(local,remote);
    try (Socket s=new Socket(bound.getHostName(),bound.getPort());OutputStream output=s.getOutputStream();InputStream input=s.getInputStream()){
      s.setSoTimeout((int)TimeUnit.SECONDS.toMillis(10L));
      String expected=getCurrentTestName();
      byte[] bytes=expected.getBytes(StandardCharsets.UTF_8);
      output.write(bytes);
      output.flush();
      byte[] buf=new byte[bytes.length + Long.SIZE];
      int n=input.read(buf);
      String res=new String(buf,0,n);
      assertEquals("Mismatched data",expected,res);
    }
  finally {
      session.stopLocalPortForwarding(bound);
    }
  }
 }

</code></pre>

<br>
<pre class="type-8 type-3 type-7 type-13 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testForwardingChannel() throws Exception {
  try (ClientSession session=createNativeSession()){
    SshdSocketAddress local=new SshdSocketAddress("",0);
    SshdSocketAddress remote=new SshdSocketAddress(TEST_LOCALHOST,echoPort);
    try (ChannelDirectTcpip channel=session.createDirectTcpipChannel(local,remote)){
      channel.open().verify(9L,TimeUnit.SECONDS);
      String expected=getCurrentTestName();
      byte[] bytes=expected.getBytes(StandardCharsets.UTF_8);
      try (OutputStream output=channel.getInvertedIn();InputStream input=channel.getInvertedOut()){
        output.write(bytes);
        output.flush();
        byte[] buf=new byte[bytes.length + Long.SIZE];
        int n=input.read(buf);
        String res=new String(buf,0,n);
        assertEquals("Mismatched data",expected,res);
      }
       channel.close(false);
    }
   }
 }

</code></pre>

<br>
<pre class="type-8 type-7 type-13 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testLocalForwarding() throws Exception {
  Session session=createSession();
  try {
    int forwardedPort=Utils.getFreePort();
    session.setPortForwardingL(forwardedPort,TEST_LOCALHOST,echoPort);
    try (Socket s=new Socket(TEST_LOCALHOST,forwardedPort);OutputStream output=s.getOutputStream();InputStream input=s.getInputStream()){
      s.setSoTimeout((int)TimeUnit.SECONDS.toMillis(10L));
      String expected=getCurrentTestName();
      byte[] bytes=expected.getBytes(StandardCharsets.UTF_8);
      output.write(bytes);
      output.flush();
      byte[] buf=new byte[bytes.length + Long.SIZE];
      int n=input.read(buf);
      String res=new String(buf,0,n);
      assertEquals("Mismatched data",expected,res);
    }
  finally {
      session.delPortForwardingL(forwardedPort);
    }
  }
  finally {
    session.disconnect();
  }
}

</code></pre>

<br>
<pre class="type-8 type-3 type-7 type-13 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
@Test public void testRemoteForwardingNative() throws Exception {
  try (ClientSession session=createNativeSession()){
    SshdSocketAddress remote=new SshdSocketAddress("",0);
    SshdSocketAddress local=new SshdSocketAddress(TEST_LOCALHOST,echoPort);
    SshdSocketAddress bound=session.startRemotePortForwarding(remote,local);
    try (Socket s=new Socket(bound.getHostName(),bound.getPort());OutputStream output=s.getOutputStream();InputStream input=s.getInputStream()){
      s.setSoTimeout((int)TimeUnit.SECONDS.toMillis(10L));
      String expected=getCurrentTestName();
      byte[] bytes=expected.getBytes(StandardCharsets.UTF_8);
      output.write(bytes);
      output.flush();
      byte[] buf=new byte[bytes.length + Long.SIZE];
      int n=input.read(buf);
      String res=new String(buf,0,n);
      assertEquals("Mismatched data",expected,res);
    }
  finally {
      session.stopRemotePortForwarding(remote);
    }
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.io.DefaultIoServiceFactoryFactoryTest </h4><pre class="type-3 type-15 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@SuppressWarnings("boxing") @Test public void testExecutorServiceInitialization() throws IOException {
  ExecutorService service=Mockito.mock(ExecutorService.class);
  Mockito.when(service.shutdownNow()).thenReturn(Collections.<Runnable>emptyList());
  Mockito.when(service.isShutdown()).thenReturn(Boolean.TRUE);
  Mockito.when(service.isTerminated()).thenReturn(Boolean.TRUE);
  FactoryManager manager=Mockito.mock(FactoryManager.class);
  Mockito.when(manager.getProperties()).thenReturn(Collections.<String,Object>emptyMap());
  String propName=IoServiceFactoryFactory.class.getName();
  for (  BuiltinIoServiceFactoryFactories f : BuiltinIoServiceFactoryFactories.VALUES) {
    String name=f.getName();
    try {
      System.setProperty(propName,name);
      for (      boolean shutdownOnExit : new boolean[]{true,false}) {
        DefaultIoServiceFactoryFactory defaultFactory=new DefaultIoServiceFactoryFactory(service,shutdownOnExit);
        try (IoServiceFactory factory=defaultFactory.create(manager)){
          assertObjectInstanceOf(name + "/" + shutdownOnExit+ " no executor service configuration",ExecutorServiceCarrier.class,factory);
          ExecutorServiceCarrier carrier=(ExecutorServiceCarrier)factory;
          assertSame(name + "/" + shutdownOnExit+ " - mismatched executor service",service,carrier.getExecutorService());
          assertEquals(name + "/" + shutdownOnExit+ " - mismatched shutdown on exit",shutdownOnExit,carrier.isShutdownOnExit());
        }
       }
    }
  finally {
      System.clearProperty(propName);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.kex.AbstractDHTest </h4><pre class="type-11 type-8 type-10 type-6 type-15 type-7 type-13 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStripLeadingZeroes(){
  byte[] data={3,7,7,3,4,7};
  for (int index=1; index <= data.length; index++) {
    assertSame("Unexpected sub-array generation for " + Arrays.toString(data),data,AbstractDH.stripLeadingZeroes(data));
    if (index < data.length) {
      data[index]=0;
    }
  }
  Arrays.fill(data,(byte)0);
  try {
    byte[] stripped=AbstractDH.stripLeadingZeroes(data);
    fail("Unexpected success for all zeroes data: " + Arrays.toString(stripped));
  }
 catch (  IllegalArgumentException expected) {
  }
  for (int index=data.length - 1; index > 0; index--) {
    data[index]=(byte)index;
    byte[] stripped=AbstractDH.stripLeadingZeroes(data);
    String ds=Arrays.toString(data), ss=Arrays.toString(stripped);
    assertEquals("Mismatched stripped (" + ss + ") length for "+ ds,data.length - index,stripped.length);
    for (int i=index, j=0; j < stripped.length; i++, j++) {
      if (data[i] != stripped[j]) {
        fail("Mismatched values at stripped index = " + j + ": data="+ ds+ ", stripped="+ ss);
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.kex.BuiltinDHFactoriesTest </h4><pre class="type-8 type-2 type-7 type-12 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAllConstantsCovered() throws Exception {
  Set<BuiltinDHFactories> avail=EnumSet.noneOf(BuiltinDHFactories.class);
  Field[] fields=BuiltinDHFactories.Constants.class.getFields();
  for (  Field f : fields) {
    String name=(String)f.get(null);
    BuiltinDHFactories value=BuiltinDHFactories.fromFactoryName(name);
    assertNotNull("No match found for " + name,value);
    assertTrue(name + " re-specified",avail.add(value));
  }
  assertEquals("Incomplete coverage",BuiltinDHFactories.VALUES,avail);
}

</code></pre>

<br>
<pre class="type-11 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testNotAllowedToOverrideRegisteredFactories(){
  DHFactory expected=Mockito.mock(DHFactory.class);
  Mockito.when(expected.getName()).thenReturn(getCurrentTestName());
  String name=expected.getName();
  try {
    for (int index=1; index <= Byte.SIZE; index++) {
      BuiltinDHFactories.registerExtension(expected);
      assertEquals("Unexpected success at attempt #" + index,1,index);
    }
  }
  finally {
    BuiltinDHFactories.unregisterExtension(name);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.keyprovider.KeyPairProviderTest </h4><pre class="type-8 type-3 type-15 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMapToKeyPairProvider(){
  final PublicKey pubKey=Mockito.mock(PublicKey.class);
  final PrivateKey prvKey=Mockito.mock(PrivateKey.class);
  final String[] testKeys={getCurrentTestName(),getClass().getSimpleName()};
  Map<String,KeyPair> pairsMap=new TreeMap<String,KeyPair>(String.CASE_INSENSITIVE_ORDER){
    private static final long serialVersionUID=1L;
{
      for (      String keyType : testKeys) {
        put(keyType,new KeyPair(pubKey,prvKey));
      }
    }
  }
;
  KeyPairProvider provider=MappedKeyPairProvider.MAP_TO_KEY_PAIR_PROVIDER.transform(pairsMap);
  assertEquals("Key types",pairsMap.keySet(),provider.getKeyTypes());
  assertEquals("Key pairs",pairsMap.values(),provider.loadKeys());
  for (  Map.Entry<String,KeyPair> pairEntry : pairsMap.entrySet()) {
    String keyType=pairEntry.getKey();
    KeyPair expected=pairEntry.getValue(), actual=provider.loadKey(keyType);
    assertSame(keyType,expected,actual);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.mac.BuiltinMacsTest </h4><pre class="type-8 type-2 type-7 type-12 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAllConstantsCovered() throws Exception {
  Set<BuiltinMacs> avail=EnumSet.noneOf(BuiltinMacs.class);
  Field[] fields=BuiltinMacs.Constants.class.getFields();
  for (  Field f : fields) {
    String name=(String)f.get(null);
    BuiltinMacs value=BuiltinMacs.fromFactoryName(name);
    assertNotNull("No match found for " + name,value);
    assertTrue(name + " re-specified",avail.add(value));
  }
  assertEquals("Incomplete coverage",BuiltinMacs.VALUES,avail);
}

</code></pre>

<br>
<pre class="type-11 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testNotAllowedToOverrideRegisteredFactories(){
  MacFactory expected=Mockito.mock(MacFactory.class);
  Mockito.when(expected.getName()).thenReturn(getCurrentTestName());
  String name=expected.getName();
  try {
    for (int index=1; index <= Byte.SIZE; index++) {
      BuiltinMacs.registerExtension(expected);
      assertEquals("Unexpected success at attempt #" + index,1,index);
    }
  }
  finally {
    BuiltinMacs.unregisterExtension(name);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.mac.MacVectorsTest </h4><pre class="type-3 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testStandardVectorMac() throws Exception {
  Mac mac=macFactory.create();
  mac.init(seed.getKey());
  mac.update(seed.getData());
  byte[] actual=new byte[mac.getBlockSize()];
  mac.doFinal(actual);
  assertArrayEquals("Mismatched results for actual=" + BufferUtils.toHex(BufferUtils.EMPTY_HEX_SEPARATOR,actual),expected,actual);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.session.AbstractSessionTest </h4><pre class="type-8 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReadIdentSimple(){
  Buffer buf=new ByteArrayBuffer("SSH-2.0-software\r\n".getBytes(StandardCharsets.UTF_8));
  String ident=session.doReadIdentification(buf);
  assertEquals("SSH-2.0-software",ident);
}

</code></pre>

<br>
<pre class="type-8 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReadIdentWithoutCR(){
  Buffer buf=new ByteArrayBuffer("SSH-2.0-software\n".getBytes(StandardCharsets.UTF_8));
  String ident=session.doReadIdentification(buf);
  assertEquals("SSH-2.0-software",ident);
}

</code></pre>

<br>
<pre class="type-8 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReadIdentWithHeaders(){
  Buffer buf=new ByteArrayBuffer(("a header line\r\nSSH-2.0-software\r\n").getBytes(StandardCharsets.UTF_8));
  String ident=session.doReadIdentification(buf);
  assertEquals("SSH-2.0-software",ident);
}

</code></pre>

<br>
<pre class="type-11 type-8 type-10 type-2 type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMsgIgnorePadding() throws Exception {
  final long frequency=Byte.SIZE;
  PropertyResolverUtils.updateProperty(session,FactoryManager.IGNORE_MESSAGE_SIZE,Short.SIZE);
  PropertyResolverUtils.updateProperty(session,FactoryManager.IGNORE_MESSAGE_FREQUENCY,frequency);
  PropertyResolverUtils.updateProperty(session,FactoryManager.IGNORE_MESSAGE_VARIANCE,0);
  session.refreshConfiguration();
  Buffer msg=session.createBuffer(SshConstants.SSH_MSG_DEBUG,Long.SIZE);
  msg.putBoolean(true);
  msg.putString(getCurrentTestName());
  msg.putString("");
  MyIoSession ioSession=(MyIoSession)session.getIoSession();
  Queue<Buffer> queue=ioSession.getOutgoingMessages();
  int numIgnores=0;
  for (int cycle=0; cycle < Byte.SIZE; cycle++) {
    for (long index=0; index <= frequency; index++) {
      session.writePacket(msg);
      Buffer data=queue.remove();
      if (data != msg) {
        int cmd=data.getUByte();
        assertEquals("Mismatched buffer command at cycle " + cycle + "["+ index+ "]",SshConstants.SSH_MSG_IGNORE,cmd);
        int len=data.getInt();
        assertTrue("Mismatched random padding data length at cycle " + cycle + "["+ index+ "]: "+ len,len >= Short.SIZE);
        numIgnores++;
      }
    }
  }
  assertEquals("Mismatched number of ignore messages",Byte.SIZE,numIgnores);
}

</code></pre>

<br>
<pre class="type-8 type-3 type-7 type-12 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadIdentWithSplitPackets(){
  Buffer buf=new ByteArrayBuffer("header line\r\nSSH".getBytes(StandardCharsets.UTF_8));
  String ident=session.doReadIdentification(buf);
  assertNull(ident);
  buf.putRawBytes("-2.0-software\r\n".getBytes(StandardCharsets.UTF_8));
  ident=session.doReadIdentification(buf);
  assertEquals("SSH-2.0-software",ident);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.signature.BuiltinSignaturesTest </h4><pre class="type-11 type-7 type-16 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=IllegalArgumentException.class) public void testNotAllowedToOverrideRegisteredFactories(){
  SignatureFactory expected=Mockito.mock(SignatureFactory.class);
  Mockito.when(expected.getName()).thenReturn(getCurrentTestName());
  String name=expected.getName();
  try {
    for (int index=1; index <= Byte.SIZE; index++) {
      BuiltinSignatures.registerExtension(expected);
      assertEquals("Unexpected success at attempt #" + index,1,index);
    }
  }
  finally {
    BuiltinSignatures.unregisterExtension(name);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.util.GenericUtilsTest </h4><pre class="type-8 type-15 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAccumulateExceptionOnExistingCurrent(){
  RuntimeException[] expected=new RuntimeException[]{new IllegalArgumentException(getCurrentTestName()),new ClassCastException(getClass().getName()),new NoSuchElementException(getClass().getPackage().getName())};
  RuntimeException current=new UnsupportedOperationException("top");
  for (  RuntimeException extra : expected) {
    RuntimeException actual=GenericUtils.accumulateException(current,extra);
    assertSame("Mismatched returned actual exception",current,actual);
  }
  Throwable[] actual=current.getSuppressed();
  assertArrayEquals("Suppressed",expected,actual);
}

</code></pre>

<br>
<pre class="type-11 type-8 type-15 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStripQuotes(){
  String expected=getCurrentTestName();
  assertSame("Unexpected un-quoted stripping",expected,GenericUtils.stripQuotes(expected));
  StringBuilder sb=new StringBuilder(2 + expected.length()).append('|').append(expected).append('|');
  for (int index=0; index < GenericUtils.QUOTES.length(); index++) {
    char delim=GenericUtils.QUOTES.charAt(index);
    sb.setCharAt(0,delim);
    sb.setCharAt(sb.length() - 1,delim);
    CharSequence actual=GenericUtils.stripQuotes(sb);
    assertEquals("Mismatched result for delim (" + delim + ")",expected,actual.toString());
  }
}

</code></pre>

<br>
<pre class="type-8 type-15 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testStripDelimiters(){
  String expected=getCurrentTestName();
  final char delim='|';
  assertSame("Unexpected un-delimited stripping",expected,GenericUtils.stripDelimiters(expected,delim));
  CharSequence actual=GenericUtils.stripDelimiters(new StringBuilder(2 + expected.length()).append(delim).append(expected).append(delim),delim);
  assertEquals("Mismatched stripped values",expected,actual.toString());
}

</code></pre>

<br>
<pre class="type-11 type-8 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testStripOnlyFirstLayerQuotes(){
  StringBuilder sb=new StringBuilder().append("||").append(getCurrentTestName()).append("||");
  char[] delims={'\'','"','"','\''};
  for (int index=0; index < delims.length; index+=2) {
    char topDelim=delims[index], innerDelim=delims[index + 1];
    sb.setCharAt(0,topDelim);
    sb.setCharAt(1,innerDelim);
    sb.setCharAt(sb.length() - 2,innerDelim);
    sb.setCharAt(sb.length() - 1,topDelim);
    CharSequence expected=sb.subSequence(1,sb.length() - 1);
    CharSequence actual=GenericUtils.stripQuotes(sb);
    assertEquals("Mismatched result for delim (" + topDelim + "/"+ innerDelim+ ")",expected.toString(),actual.toString());
  }
}

</code></pre>

<br>
<pre class="type-11 type-8 type-10 type-6 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSplitAndJoin(){
  List<String> expected=Collections.unmodifiableList(Arrays.asList(getClass().getPackage().getName().replace('.','/'),getClass().getSimpleName(),getCurrentTestName()));
  for (  char ch : new char[]{',','.','*','?'}) {
    String sep=String.valueOf(ch);
    String s=GenericUtils.join(expected,sep);
    String[] actual=GenericUtils.split(s,ch);
    assertEquals("Mismatched split length for separator=" + sep,expected.size(),GenericUtils.length((Object[])actual));
    for (int index=0; index < actual.length; index++) {
      String e=expected.get(index), a=actual[index];
      if (!e.endsWith(a)) {
        fail("Mismatched value at index=" + index + " for separator="+ sep+ ": expected="+ e+ ", actual="+ a);
      }
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.util.NumberUtilsTest </h4><pre class="type-11 type-8 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testPowersOf2List(){
  assertEquals("Mismatched values size for " + NumberUtils.POWERS_OF_TWO,Long.SIZE,GenericUtils.size(NumberUtils.POWERS_OF_TWO));
  long expected=1L;
  for (int index=0; index < Long.SIZE; index++, expected<<=1) {
    Long actual=NumberUtils.POWERS_OF_TWO.get(index);
    assertEquals("Mismatched value at index=" + index,Long.toHexString(expected),Long.toHexString(actual.longValue()));
  }
}

</code></pre>

<br>
<pre class="type-8 type-10 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNextPowerOf2(){
  for (  Long v : NumberUtils.POWERS_OF_TWO) {
    long expected=v.longValue();
    if (expected > 2L) {
      assertEquals("Mismatched lower bound value",expected,NumberUtils.getNextPowerOf2(expected - 1L));
    }
    if (expected > 0L) {
      assertEquals("Mismatched exact value",expected,NumberUtils.getNextPowerOf2(expected));
    }
  }
}

</code></pre>

<br>
<pre class="type-8 type-10 type-15 type-7 type-12 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testToInteger(){
  assertNull("Unexpected null value",NumberUtils.toInteger(null));
  for (  Number n : new Number[]{Byte.valueOf(Byte.MAX_VALUE),Short.valueOf(Short.MIN_VALUE),Integer.valueOf(Short.MAX_VALUE),Long.valueOf(82007160L)}) {
    Integer i=NumberUtils.toInteger(n);
    if (n instanceof Integer) {
      assertSame("Unexpected conversion",n,i);
    }
 else {
      assertEquals("Mismatched values",n.intValue(),i.intValue());
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.util.OsUtilsTest </h4><pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSetCurrentUserByProperty(){
  try {
    for (    String expected : new String[]{getClass().getSimpleName(),getCurrentTestName()}) {
      OsUtils.setCurrentUser(null);
      try {
        System.setProperty(OsUtils.CURRENT_USER_OVERRIDE_PROP,expected);
        String actual=OsUtils.getCurrentUser();
        assertEquals("Mismatched reported current user",expected,actual);
      }
  finally {
        System.clearProperty(OsUtils.CURRENT_USER_OVERRIDE_PROP);
      }
    }
  }
  finally {
    OsUtils.setCurrentUser(null);
  }
}

</code></pre>

<br>
<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSetOsTypeProgrammatically(){
  try {
    for (    boolean expected : new boolean[]{true,false}) {
      OsUtils.setWin32(expected);
      assertEquals("Mismatched detection value",expected,OsUtils.isWin32());
    }
  }
  finally {
    OsUtils.setWin32(null);
  }
}

</code></pre>

<br>
<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSetCurrentUserProgrammatically(){
  try {
    for (    String expected : new String[]{getClass().getSimpleName(),getCurrentTestName()}) {
      OsUtils.setCurrentUser(expected);
      assertEquals("Mismatched detection value",expected,OsUtils.getCurrentUser());
    }
  }
  finally {
    OsUtils.setCurrentUser(null);
  }
}

</code></pre>

<br>
<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSetJavaVersionProgrammatically(){
  try {
    for (    VersionInfo expected : new VersionInfo[]{VersionInfo.parse("7.3.6.5"),VersionInfo.parse("37.77.34.7")}) {
      OsUtils.setJavaVersion(expected);
      assertEquals("Mismatched detection value",expected,OsUtils.getJavaVersion());
    }
  }
  finally {
    OsUtils.setJavaVersion(null);
  }
}

</code></pre>

<br>
<pre class="type-8 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSetOsTypeByProperty(){
  try {
    for (    String osType : new String[]{"Some-Windows","Some-Linux"}) {
      OsUtils.setWin32(null);
      try {
        boolean expected=osType.contains("Windows");
        System.setProperty(OsUtils.OS_TYPE_OVERRIDE_PROP,osType);
        boolean actual=OsUtils.isWin32();
        assertEquals(osType,expected,actual);
      }
  finally {
        System.clearProperty(OsUtils.OS_TYPE_OVERRIDE_PROP);
      }
    }
  }
  finally {
    OsUtils.setWin32(null);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.util.SecurityUtilsTest </h4><pre class="type-2 type-14 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testBouncyCastleRegistrationSettings(){
  Assume.assumeTrue("Bouncycastle not registered",SecurityUtils.isBouncyCastleRegistered());
  assertTrue("DH Group Exchange not supported",SecurityUtils.isDHGroupExchangeSupported());
  assertEquals("Mismatched max. DH group exchange key size",SecurityUtils.MAX_DHGEX_KEY_SIZE,SecurityUtils.getMaxDHGroupExchangeKeySize());
  assertTrue("ECC not supported",SecurityUtils.hasEcc());
}

</code></pre>

<br>
<pre class="type-11 type-2 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSetMaxDHGroupExchangeKeySizeProgrammatically(){
  try {
    for (int expected=SecurityUtils.MIN_DHGEX_KEY_SIZE; expected <= SecurityUtils.MAX_DHGEX_KEY_SIZE; expected+=1024) {
      SecurityUtils.setMaxDHGroupExchangeKeySize(expected);
      assertTrue("DH group not supported for key size=" + expected,SecurityUtils.isDHGroupExchangeSupported());
      assertEquals("Mismatched values",expected,SecurityUtils.getMaxDHGroupExchangeKeySize());
    }
  }
  finally {
    SecurityUtils.setMaxDHGroupExchangeKeySize(0);
  }
}

</code></pre>

<br>
<pre class="type-11 type-2 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSetMaxDHGroupExchangeKeySizeByProperty(){
  try {
    for (int expected=SecurityUtils.MIN_DHGEX_KEY_SIZE; expected <= SecurityUtils.MAX_DHGEX_KEY_SIZE; expected+=1024) {
      SecurityUtils.setMaxDHGroupExchangeKeySize(0);
      try {
        System.setProperty(SecurityUtils.MAX_DHGEX_KEY_SIZE_PROP,Integer.toString(expected));
        assertTrue("DH group not supported for key size=" + expected,SecurityUtils.isDHGroupExchangeSupported());
        assertEquals("Mismatched values",expected,SecurityUtils.getMaxDHGroupExchangeKeySize());
      }
  finally {
        System.clearProperty(SecurityUtils.MAX_DHGEX_KEY_SIZE_PROP);
      }
    }
  }
  finally {
    SecurityUtils.setMaxDHGroupExchangeKeySize(0);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.util.SelectorUtilsTest </h4><pre class="type-8 type-14 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testNormalizeWindowsPath(){
  Assume.assumeTrue("Not tested on Windows",OsUtils.isWin32());
  String path=detectTargetFolder().toString().replace(File.separatorChar,'/');
  String actual=SelectorUtils.normalizePath(path,"/");
  assertEquals("Mismatched result","/" + path,actual);
}

</code></pre>

<br>
<pre class="type-8 type-15 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTranslateToFileSystemPath(){
  String path=getClass().getPackage().getName().replace('.',File.separatorChar) + File.separator + getClass().getSimpleName()+ File.separator+ getCurrentTestName();
  for (  String expected : new String[]{null,"",path}) {
    String actual=SelectorUtils.translateToFileSystemPath(expected,File.separator,File.separator);
    assertSame("Mismatched instance for translated result",expected,actual);
  }
  for (  String fsSeparator : new String[]{String.valueOf('.'),"##"}) {
    String expected=path.replace(File.separator,fsSeparator);
    String actual=SelectorUtils.translateToFileSystemPath(path,File.separator,fsSeparator);
    assertEquals("Mismatched translation result for separator='" + fsSeparator + "'",expected,actual);
    actual=SelectorUtils.translateToFileSystemPath(actual,fsSeparator,File.separator);
    assertEquals("Mismatched translation revert for separator='" + fsSeparator + "'",path,actual);
  }
}

</code></pre>

<br>
<pre class="type-8 type-14 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAbsoluteWindowsPathTranslation(){
  Assume.assumeTrue("Not tested on Windows",OsUtils.isWin32());
  String expected=detectTargetFolder().toString();
  for (  String prefix : new String[]{"","/"}) {
    String actual=SelectorUtils.translateToLocalPath(prefix + expected.replace('/',File.separatorChar));
    assertEquals("Mismatched result for prefix='" + prefix + "'",expected,actual);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.util.TransformerTest </h4><pre class="type-8 type-7 type-12 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testExtractEnumName(){
  assertNull("Invalid null result",Transformer.ENUM_NAME_EXTRACTOR.transform(null));
  for (  TimeUnit u : TimeUnit.values()) {
    String expected=u.name();
    String actual=Transformer.ENUM_NAME_EXTRACTOR.transform(u);
    assertEquals("Mismatched name",expected,actual);
  }
}

</code></pre>

<br>
<pre class="type-8 type-7 type-12 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testToString(){
  assertNull("Invalid null result",Transformer.TOSTRING.transform(null));
  for (  Object o : new Object[]{"",getClass(),new Date()}) {
    String expected=o.toString();
    String actual=Transformer.TOSTRING.transform(o);
    assertEquals("Mismatched result for type=" + o.getClass().getSimpleName(),expected,actual);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.util.VersionInfoTest </h4><pre class="type-3 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMoreThan4Components(){
  VersionInfo expected=new VersionInfo(7,3,6,5);
  VersionInfo actual=VersionInfo.parse(expected.toString() + ".3.7.7.7.3.4.7");
  assertEquals("Mismatched result",expected,actual);
}

</code></pre>

<br>
<pre class="type-3 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testLessThan4Components(){
  VersionInfo expected=new VersionInfo(73,65);
  VersionInfo actual=VersionInfo.parse(NumberUtils.join('.',expected.getMajorVersion(),expected.getMinorVersion()));
  assertEquals("Mismatched result",expected,actual);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.util.buffer.BufferTest </h4><pre class="type-8 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testGetLong() throws Exception {
  long expected=1234567890123456789L;
  try (ByteArrayOutputStream stream=new ByteArrayOutputStream()){
    try (DataOutputStream ds=new DataOutputStream(stream)){
      ds.writeLong(expected);
    }
     Buffer buffer=new ByteArrayBuffer(stream.toByteArray());
    assertEquals("Mismatched recovered value",expected,buffer.getLong());
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.util.buffer.BufferUtilsTest </h4><pre class="type-8 type-3 type-15 type-7 type-13 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetCompactClone(){
  byte[] expected=getCurrentTestName().getBytes(StandardCharsets.UTF_8);
  final int OFFSET=Byte.SIZE / 2;
  byte[] data=new byte[expected.length + 2 * OFFSET];
  Random rnd=new Random(System.nanoTime());
  rnd.nextBytes(data);
  System.arraycopy(expected,0,data,OFFSET,expected.length);
  Buffer buf=ByteArrayBuffer.getCompactClone(data,OFFSET,expected.length);
  assertEquals("Mismatched cloned buffer read position",0,buf.rpos());
  assertEquals("Mismatched cloned buffer available size",expected.length,buf.available());
  byte[] actual=buf.array();
  assertNotSame("Original data not cloned",data,actual);
  assertArrayEquals("Mismatched cloned contents",expected,actual);
}

</code></pre>

<br>
<pre class="type-8 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testHexEncodeDecode(){
  String expValue=getClass().getName() + "#" + getCurrentTestName();
  byte[] expData=expValue.getBytes(StandardCharsets.UTF_8);
  for (  char sep : new char[]{BufferUtils.EMPTY_HEX_SEPARATOR,':'}) {
    String hexData=BufferUtils.toHex(sep,expData);
    byte[] actData=BufferUtils.decodeHex(sep,hexData);
    String actValue=new String(actData,StandardCharsets.UTF_8);
    String sepName=(BufferUtils.EMPTY_HEX_SEPARATOR == sep) ? "EMPTY" : Character.toString(sep);
    outputDebugMessage("Decode(sep=%s) expected=%s, actual=%s",sepName,expValue,actValue);
    assertArrayEquals("Mismatched result for sep='" + sepName + "'",expData,actData);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.util.closeable.CloseableUtilsTest </h4><pre class="type-2 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCloseImmediateCalledAndWait() throws Exception {
  final DefaultCloseFuture future=new DefaultCloseFuture(this);
  final AtomicInteger callsCount=new AtomicInteger(0);
  final Closeable closeable=new IoBaseCloseable(){
    @Override public CloseFuture close(    boolean immediately){
      assertTrue("Closure is not immediate",immediately);
      assertEquals("Multiple close immediate calls",1,callsCount.incrementAndGet());
      return future;
    }
    @Override public boolean isClosed(){
      return false;
    }
    @Override public boolean isClosing(){
      return false;
    }
  }
;
  ExecutorService service=ThreadUtils.newSingleThreadExecutor(getCurrentTestName());
  try {
    Future<?> task=service.submit(new Runnable(){
      @Override public void run(){
        try {
          closeable.close();
        }
 catch (        IOException e) {
          throw new RuntimeException(e);
        }
      }
    }
);
    future.setClosed();
    task.get(5L,TimeUnit.SECONDS);
    assertEquals("Close immediate not called",1,callsCount.get());
  }
  finally {
    service.shutdownNow();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.util.io.IoUtilsTest </h4><pre class="type-11 type-2 type-15 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGetEOLBytes(){
  byte[] expected=IoUtils.getEOLBytes();
  assertTrue("Empty bytes",NumberUtils.length(expected) > 0);
  for (int index=1; index < Byte.SIZE; index++) {
    byte[] actual=IoUtils.getEOLBytes();
    assertNotSame("Same bytes received at iteration " + index,expected,actual);
    assertArrayEquals("Mismatched bytes at iteration " + index,expected,actual);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.common.util.io.LimitInputStreamTest </h4><pre class="type-8 type-6 type-2 type-3 type-7 type-13 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testReadLimit() throws IOException {
  Path targetPath=detectTargetFolder();
  Path rootFolder=assertHierarchyTargetFolderExists(targetPath.resolve(getClass().getSimpleName()));
  Path inputFile=rootFolder.resolve(getCurrentTestName() + ".bin");
  byte[] data=(getClass().getName() + "#" + getCurrentTestName()).getBytes(StandardCharsets.UTF_8);
  Files.write(inputFile,data);
  try (InputStream in=Files.newInputStream(inputFile)){
    int maxLen=data.length / 2;
    byte[] expected=new byte[maxLen];
    System.arraycopy(data,0,expected,0,expected.length);
    byte[] actual=new byte[expected.length];
    try (LimitInputStream limited=new LimitInputStream(in,expected.length)){
      assertTrue("Limited stream not marked as open",limited.isOpen());
      assertEquals("Mismatched initial available data size",expected.length,limited.available());
      int readLen=limited.read(actual);
      assertEquals("Incomplete actual data read",actual.length,readLen);
      assertArrayEquals("Mismatched read data",expected,actual);
      assertEquals("Mismatched remaining available data size",0,limited.available());
      readLen=limited.read();
      assertTrue("Unexpected success to read one more byte: " + readLen,readLen < 0);
      readLen=limited.read(actual);
      assertTrue("Unexpected success to read extra buffer: " + readLen,readLen < 0);
      limited.close();
      assertFalse("Limited stream still marked as open",limited.isOpen());
      try {
        readLen=limited.read();
        fail("Unexpected one byte read success after close");
      }
 catch (      IOException e) {
      }
      try {
        readLen=limited.read(actual);
        fail("Unexpected buffer read success after close: " + readLen);
      }
 catch (      IOException e) {
      }
      try {
        readLen=limited.read(actual);
        fail("Unexpected buffer read success after close: " + readLen);
      }
 catch (      IOException e) {
      }
      try {
        readLen=(int)limited.skip(Byte.SIZE);
        fail("Unexpected skip success after close: " + readLen);
      }
 catch (      IOException e) {
      }
      try {
        readLen=limited.available();
        fail("Unexpected available success after close: " + readLen);
      }
 catch (      IOException e) {
      }
    }
     int readLen=in.read(actual);
    assertEquals("Incomplete extra data read",Math.min(actual.length,data.length - expected.length),readLen);
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.server.ServerSessionListenerTest </h4><pre class="type-8 type-3 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testSessionListenerCanModifyKEXNegotiation() throws Exception {
  final Map<KexProposalOption,NamedFactory<?>> kexParams=new EnumMap<>(KexProposalOption.class);
  kexParams.put(KexProposalOption.ALGORITHMS,getLeastFavorite(KeyExchange.class,sshd.getKeyExchangeFactories()));
  kexParams.put(KexProposalOption.S2CENC,getLeastFavorite(Cipher.class,sshd.getCipherFactories()));
  kexParams.put(KexProposalOption.S2CMAC,getLeastFavorite(Mac.class,sshd.getMacFactories()));
  sshd.addSessionListener(new SessionListener(){
    @Override @SuppressWarnings("unchecked") public void sessionCreated(    Session session){
      session.setKeyExchangeFactories(Collections.singletonList((NamedFactory<KeyExchange>)kexParams.get(KexProposalOption.ALGORITHMS)));
      session.setCipherFactories(Collections.singletonList((NamedFactory<Cipher>)kexParams.get(KexProposalOption.S2CENC)));
      session.setMacFactories(Collections.singletonList((NamedFactory<Mac>)kexParams.get(KexProposalOption.S2CMAC)));
    }
    @Override public void sessionEvent(    Session session,    Event event){
    }
    @Override public void sessionException(    Session session,    Throwable t){
    }
    @Override public void sessionClosed(    Session session){
    }
  }
);
  client.start();
  try (ClientSession session=createTestClientSession()){
    for (    Map.Entry<KexProposalOption,? extends NamedResource> ke : kexParams.entrySet()) {
      KexProposalOption option=ke.getKey();
      String expected=ke.getValue().getName();
      String actual=session.getNegotiatedKexParameter(option);
      assertEquals("Mismatched values for KEX=" + option,expected,actual);
    }
  }
  finally {
    client.stop();
  }
}

</code></pre>

<br>
<pre class="type-8 type-3 type-15 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSessionListenerCanModifyAuthentication() throws Exception {
  final AtomicInteger passCount=new AtomicInteger(0);
  final PasswordAuthenticator defaultPassAuth=sshd.getPasswordAuthenticator();
  final PasswordAuthenticator passAuth=new PasswordAuthenticator(){
    @Override public boolean authenticate(    String username,    String password,    ServerSession session) throws PasswordChangeRequiredException {
      passCount.incrementAndGet();
      return defaultPassAuth.authenticate(username,password,session);
    }
  }
;
  sshd.addSessionListener(new SessionListener(){
    @Override public void sessionCreated(    Session session){
      if ((!session.isAuthenticated()) && (session instanceof ServerSession)) {
        ServerSession serverSession=(ServerSession)session;
        serverSession.setPasswordAuthenticator(passAuth);
        serverSession.setUserAuthFactories(Collections.<NamedFactory<UserAuth>>singletonList(ServerAuthenticationManager.Utils.DEFAULT_USER_AUTH_PASSWORD_FACTORY));
      }
    }
    @Override public void sessionEvent(    Session session,    Event event){
    }
    @Override public void sessionException(    Session session,    Throwable t){
    }
    @Override public void sessionClosed(    Session session){
    }
  }
);
  client.start();
  try (ClientSession session=createTestClientSession()){
    assertNotSame("Mismatched default password authenticator",passAuth,sshd.getPasswordAuthenticator());
    assertNotSame("Mismatched default kb authenticator",KeyboardInteractiveAuthenticator.NONE,sshd.getKeyboardInteractiveAuthenticator());
    assertEquals("Authenticator override not invoked",1,passCount.get());
  }
  finally {
    client.stop();
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.server.ServerTest </h4><pre class="type-2 type-3 type-7 type-12 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCompressionNegotiation() throws Exception {
  sshd.setSessionFactory(new org.apache.sshd.server.session.SessionFactory(sshd){
    @Override protected ServerSessionImpl doCreateSession(    IoSession ioSession) throws Exception {
      return new ServerSessionImpl(getServer(),ioSession){
        @Override protected Map<KexProposalOption,String> createProposal(        String hostKeyTypes){
          Map<KexProposalOption,String> proposal=super.createProposal(hostKeyTypes);
          proposal.put(KexProposalOption.C2SCOMP,getCurrentTestName());
          proposal.put(KexProposalOption.S2CCOMP,getCurrentTestName());
          return proposal;
        }
      }
;
    }
  }
);
  sshd.start();
  client.setSessionFactory(new org.apache.sshd.client.session.SessionFactory(client){
    @Override protected ClientSessionImpl doCreateSession(    IoSession ioSession) throws Exception {
      return new ClientSessionImpl(getClient(),ioSession){
        @Override protected Map<KexProposalOption,String> createProposal(        String hostKeyTypes){
          Map<KexProposalOption,String> proposal=super.createProposal(hostKeyTypes);
          proposal.put(KexProposalOption.C2SCOMP,getCurrentTestName());
          proposal.put(KexProposalOption.S2CCOMP,getCurrentTestName());
          return proposal;
        }
      }
;
    }
  }
);
  final Semaphore sigSem=new Semaphore(0,true);
  client.addSessionListener(new SessionListener(){
    @Override public void sessionCreated(    Session session){
      outputDebugMessage("Session created: %s",session);
    }
    @Override public void sessionEvent(    Session session,    Event event){
      assertNotEquals("Unexpected key establishment success",Event.KeyEstablished,event);
    }
    @Override public void sessionException(    Session session,    Throwable t){
      outputDebugMessage("Session %s exception %s caught: %s",session,t.getClass().getSimpleName(),t.getMessage());
    }
    @Override public void sessionClosed(    Session session){
      sigSem.release();
    }
  }
);
  client.start();
  try {
    try (ClientSession s=client.connect(getCurrentTestName(),TEST_LOCALHOST,sshd.getPort()).verify(7L,TimeUnit.SECONDS).getSession()){
      assertTrue("Session closing not signalled on time",sigSem.tryAcquire(5L,TimeUnit.SECONDS));
      for (      boolean incoming : new boolean[]{true,false}) {
        assertNull("Unexpected compression information for incoming=" + incoming,s.getCompressionInformation(incoming));
      }
      assertFalse("Session unexpectedly still open",s.isOpen());
    }
   }
  finally {
    client.stop();
  }
}

</code></pre>

<br>
<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testKexCompletedEvent() throws Exception {
  final AtomicInteger serverEventCount=new AtomicInteger(0);
  sshd.addSessionListener(new SessionListener(){
    @Override public void sessionCreated(    Session session){
    }
    @Override public void sessionEvent(    Session session,    Event event){
      if (event == Event.KexCompleted) {
        serverEventCount.incrementAndGet();
      }
    }
    @Override public void sessionException(    Session session,    Throwable t){
    }
    @Override public void sessionClosed(    Session session){
    }
  }
);
  sshd.start();
  final AtomicInteger clientEventCount=new AtomicInteger(0);
  client.addSessionListener(new SessionListener(){
    @Override public void sessionCreated(    Session session){
    }
    @Override public void sessionEvent(    Session session,    Event event){
      if (event == Event.KexCompleted) {
        clientEventCount.incrementAndGet();
      }
    }
    @Override public void sessionException(    Session session,    Throwable t){
    }
    @Override public void sessionClosed(    Session session){
    }
  }
);
  client.start();
  try (ClientSession s=createTestClientSession(sshd)){
    assertEquals("Mismatched client events count",1,clientEventCount.get());
    assertEquals("Mismatched server events count",1,serverEventCount.get());
    s.close(false);
  }
  finally {
    client.stop();
  }
}

</code></pre>

<br>
<pre class="type-2 type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMaxKeyboardInteractiveTrialsSetting() throws Exception {
  sshd.setPasswordAuthenticator(RejectAllPasswordAuthenticator.INSTANCE);
  sshd.setPublickeyAuthenticator(RejectAllPublickeyAuthenticator.INSTANCE);
  final InteractiveChallenge challenge=new InteractiveChallenge();
  challenge.setInteractionInstruction(getCurrentTestName());
  challenge.setInteractionName(getClass().getSimpleName());
  challenge.setLanguageTag("il-heb");
  challenge.addPrompt(new PromptEntry("Password",false));
  final AtomicInteger serverCount=new AtomicInteger(0);
  sshd.setKeyboardInteractiveAuthenticator(new KeyboardInteractiveAuthenticator(){
    @Override public InteractiveChallenge generateChallenge(    ServerSession session,    String username,    String lang,    String subMethods){
      return challenge;
    }
    @Override public boolean authenticate(    ServerSession session,    String username,    List<String> responses) throws Exception {
      outputDebugMessage("authenticate(%s@%s) count=%s",username,session,serverCount);
      serverCount.incrementAndGet();
      return false;
    }
  }
);
  sshd.start();
  String authMethods=GenericUtils.join(Arrays.asList(UserAuthMethodFactory.KB_INTERACTIVE,UserAuthMethodFactory.PUBLIC_KEY,UserAuthMethodFactory.PUBLIC_KEY),',');
  PropertyResolverUtils.updateProperty(client,ClientAuthenticationManager.PREFERRED_AUTHS,authMethods);
  final AtomicInteger clientCount=new AtomicInteger(0);
  final String[] replies={getCurrentTestName()};
  client.setUserInteraction(new UserInteraction(){
    @Override public void welcome(    ClientSession session,    String banner,    String lang){
    }
    @Override public boolean isInteractionAllowed(    ClientSession session){
      return true;
    }
    @Override public String[] interactive(    ClientSession session,    String name,    String instruction,    String lang,    String[] prompt,    boolean[] echo){
      clientCount.incrementAndGet();
      return replies;
    }
    @Override public String getUpdatedPassword(    ClientSession session,    String prompt,    String lang){
      throw new UnsupportedOperationException("Unexpected updated password request");
    }
  }
);
  client.start();
  try (ClientSession session=client.connect(getCurrentTestName(),TEST_LOCALHOST,sshd.getPort()).verify(7L,TimeUnit.SECONDS).getSession()){
    AuthFuture auth=session.auth();
    assertTrue("Failed to complete authentication on time",auth.await(17L,TimeUnit.SECONDS));
    assertFalse("Unexpected authentication success",auth.isSuccess());
    assertEquals("Mismatched interactive server challenge calls",ClientAuthenticationManager.DEFAULT_PASSWORD_PROMPTS,serverCount.get());
    assertEquals("Mismatched interactive client challenge calls",ClientAuthenticationManager.DEFAULT_PASSWORD_PROMPTS,clientCount.get());
  }
  finally {
    client.stop();
  }
}

</code></pre>

<br>
<pre class="type-2 type-3 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testImmediateAuthFailureOpcode() throws Exception {
  sshd.setPasswordAuthenticator(RejectAllPasswordAuthenticator.INSTANCE);
  sshd.setPublickeyAuthenticator(RejectAllPublickeyAuthenticator.INSTANCE);
  final AtomicInteger challengeCount=new AtomicInteger(0);
  sshd.setKeyboardInteractiveAuthenticator(new KeyboardInteractiveAuthenticator(){
    @Override public InteractiveChallenge generateChallenge(    ServerSession session,    String username,    String lang,    String subMethods){
      challengeCount.incrementAndGet();
      outputDebugMessage("generateChallenge(%s@%s) count=%s",username,session,challengeCount);
      return null;
    }
    @Override public boolean authenticate(    ServerSession session,    String username,    List<String> responses) throws Exception {
      return false;
    }
  }
);
  sshd.start();
  String authMethods=GenericUtils.join(Arrays.asList(UserAuthMethodFactory.KB_INTERACTIVE,UserAuthMethodFactory.PUBLIC_KEY,UserAuthMethodFactory.PUBLIC_KEY),',');
  PropertyResolverUtils.updateProperty(client,ClientAuthenticationManager.PREFERRED_AUTHS,authMethods);
  client.start();
  try (ClientSession session=client.connect(getCurrentTestName(),TEST_LOCALHOST,sshd.getPort()).verify(7L,TimeUnit.SECONDS).getSession()){
    AuthFuture auth=session.auth();
    assertTrue("Failed to complete authentication on time",auth.await(17L,TimeUnit.SECONDS));
    assertFalse("Unexpected authentication success",auth.isSuccess());
    assertEquals("Mismatched interactive challenge calls",1,challengeCount.get());
  }
  finally {
    client.stop();
  }
}

</code></pre>

<br>
<pre class="type-8 type-2 type-3 type-7 type-12 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEnvironmentVariablesPropagationToServer() throws Exception {
  final AtomicReference<Environment> envHolder=new AtomicReference<Environment>(null);
  sshd.setCommandFactory(new CommandFactory(){
    @Override public Command createCommand(    final String command){
      ValidateUtils.checkTrue(String.CASE_INSENSITIVE_ORDER.compare(command,getCurrentTestName()) == 0,"Unexpected command: %s",command);
      return new Command(){
        private ExitCallback cb;
        @Override public void setOutputStream(        OutputStream out){
        }
        @Override public void setInputStream(        InputStream in){
        }
        @Override public void setExitCallback(        ExitCallback callback){
          cb=callback;
        }
        @Override public void setErrorStream(        OutputStream err){
        }
        @Override public void destroy(){
        }
        @Override public void start(        Environment env) throws IOException {
          if (envHolder.getAndSet(env) != null) {
            throw new StreamCorruptedException("Multiple starts for command=" + command);
          }
          cb.onExit(0,command);
        }
      }
;
    }
  }
);
  TestChannelListener channelListener=new TestChannelListener();
  sshd.addChannelListener(channelListener);
  sshd.start();
  @SuppressWarnings("synthetic-access") Map<String,String> expected=new TreeMap<String,String>(String.CASE_INSENSITIVE_ORDER){
    private static final long serialVersionUID=1L;
{
      put("test",getCurrentTestName());
      put("port",Integer.toString(sshd.getPort()));
      put("user",OsUtils.getCurrentUser());
    }
  }
;
  client.start();
  try (ClientSession s=createTestClientSession(sshd);ChannelExec shell=s.createExecChannel(getCurrentTestName())){
    for (    Map.Entry<String,String> ee : expected.entrySet()) {
      shell.setEnv(ee.getKey(),ee.getValue());
    }
    shell.open().verify(5L,TimeUnit.SECONDS);
    assertTrue("No changes in activated channels",channelListener.waitForModification(3L,TimeUnit.SECONDS));
    assertTrue("No activated server side channels",GenericUtils.size(channelListener.getActiveChannels()) > 0);
    assertTrue("No changes in open channels",channelListener.waitForModification(3L,TimeUnit.SECONDS));
    assertTrue("No open server side channels",GenericUtils.size(channelListener.getOpenChannels()) > 0);
    Collection<ClientChannel.ClientChannelEvent> result=shell.waitFor(EnumSet.of(ClientChannel.ClientChannelEvent.CLOSED),TimeUnit.SECONDS.toMillis(17L));
    assertFalse("Channel close timeout",result.contains(ClientChannel.ClientChannelEvent.TIMEOUT));
    Integer status=shell.getExitStatus();
    assertNotNull("No exit status",status);
    assertEquals("Bad exit status",0,status.intValue());
  }
  finally {
    client.stop();
  }
  assertTrue("No changes in closed channels",channelListener.waitForModification(3L,TimeUnit.SECONDS));
  assertTrue("Still activated server side channels",GenericUtils.isEmpty(channelListener.getActiveChannels()));
  Environment cmdEnv=envHolder.get();
  assertNotNull("No environment set",cmdEnv);
  Map<String,String> vars=cmdEnv.getEnv();
  assertTrue("Mismatched vars count",GenericUtils.size(vars) >= GenericUtils.size(expected));
  for (  Map.Entry<String,String> ee : expected.entrySet()) {
    String key=ee.getKey(), expValue=ee.getValue(), actValue=vars.get(key);
    assertEquals("Mismatched value for " + key,expValue,actValue);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.server.SshServerTest </h4><pre class="type-3 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testDynamicPort() throws Exception {
  try (SshServer sshd=setupTestServer()){
    sshd.setHost(TEST_LOCALHOST);
    sshd.start();
    assertNotEquals(0,sshd.getPort());
    sshd.stop();
  }
 }

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.server.StandardEnvironmentTest </h4><pre class="type-3 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testAddSignalListenerOnDuplicateSignals(){
  StandardEnvironment environ=new StandardEnvironment();
  SignalListener listener=new SignalListener(){
    @Override public void signal(    Signal signal){
    }
  }
;
  for (  Signal s : Signal.SIGNALS) {
    environ.addSignalListener(listener,s,s,s,s,s,s);
    Collection<SignalListener> ls=environ.getSignalListeners(s,false);
    assertEquals("Mismatched registered listeners count for signal=" + s,1,GenericUtils.size(ls));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.server.command.ScpCommandFactoryTest </h4><pre class="type-2 type-3 type-7 type-12 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Make sure that the builder returns a factory with the default values
 * if no {@code withXXX} method is invoked
 */
@Test public void testBuilderDefaultFactoryValues(){
  ScpCommandFactory factory=new ScpCommandFactory.Builder().build();
  assertNull("Mismatched delegate",factory.getDelegateCommandFactory());
  assertNull("Mismatched executor",factory.getExecutorService());
  assertEquals("Mismatched send size",ScpHelper.MIN_SEND_BUFFER_SIZE,factory.getSendBufferSize());
  assertEquals("Mismatched receive size",ScpHelper.MIN_RECEIVE_BUFFER_SIZE,factory.getReceiveBufferSize());
  assertFalse("Mismatched shutdown state",factory.isShutdownOnExit());
}

</code></pre>

<br>
<pre class="type-8 type-2 type-3 type-15 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Make sure that the builder initializes correctly the built factory
 */
@Test public void testBuilderCorrectlyInitializesFactory(){
  CommandFactory delegate=dummyFactory();
  ExecutorService service=dummyExecutor();
  int receiveSize=Short.MAX_VALUE, sendSize=receiveSize + Long.SIZE;
  ScpCommandFactory factory=new ScpCommandFactory.Builder().withDelegate(delegate).withExecutorService(service).withSendBufferSize(sendSize).withReceiveBufferSize(receiveSize).withShutdownOnExit(true).build();
  assertSame("Mismatched delegate",delegate,factory.getDelegateCommandFactory());
  assertSame("Mismatched executor",service,factory.getExecutorService());
  assertEquals("Mismatched send size",sendSize,factory.getSendBufferSize());
  assertEquals("Mismatched receive size",receiveSize,factory.getReceiveBufferSize());
  assertTrue("Mismatched shutdown state",factory.isShutdownOnExit());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.server.config.keys.AuthorizedKeyEntryTest </h4><pre class="type-8 type-3 type-7 type-12 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testEncodePublicKeyEntry() throws Exception {
  List<String> keyLines=loadDefaultSupportedKeys();
  StringBuilder sb=new StringBuilder(Byte.MAX_VALUE);
  for (  String line : keyLines) {
    int pos=line.indexOf(' ');
    String data=line;
    String keyType=line.substring(0,pos);
    if (KeyUtils.getPublicKeyEntryDecoder(keyType) == null) {
      data=line.substring(pos + 1).trim();
    }
    AuthorizedKeyEntry entry=AuthorizedKeyEntry.parseAuthorizedKeyEntry(data);
    if (sb.length() > 0) {
      sb.setLength(0);
    }
    PublicKey key=entry.appendPublicKey(sb,PublicKeyEntryResolver.FAILING);
    assertNotNull("No key for line=" + line,key);
    String encoded=sb.toString();
    assertEquals("Mismatched encoded form for line=" + line,data,encoded);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.server.config.keys.AuthorizedKeysAuthenticatorTest </h4><pre class="type-11 type-8 type-2 type-3 type-15 type-7 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAutomaticReload() throws Exception {
  final Path file=getTempTargetRelativeFile(getCurrentTestName());
  if (Files.exists(file)) {
    Files.delete(file);
  }
  final AtomicInteger reloadCount=new AtomicInteger(0);
  PublickeyAuthenticator auth=new AuthorizedKeysAuthenticator(file){
    @Override protected Collection<AuthorizedKeyEntry> reloadAuthorizedKeys(    Path path,    String username,    ServerSession session) throws IOException {
      assertSame("Mismatched reload path",file,path);
      reloadCount.incrementAndGet();
      return super.reloadAuthorizedKeys(path,username,session);
    }
  }
;
  assertFalse("Unexpected authentication success for missing file " + file,auth.authenticate(getCurrentTestName(),Mockito.mock(PublicKey.class),null));
  List<String> keyLines=loadDefaultSupportedKeys();
  assertHierarchyTargetFolderExists(file.getParent());
  while (keyLines.size() > 0) {
    try (Writer w=Files.newBufferedWriter(file,StandardCharsets.UTF_8)){
      w.append(PublicKeyEntry.COMMENT_CHAR).append(' ').append(getCurrentTestName()).append(' ').append(String.valueOf(keyLines.size())).append(" remaining keys").append(IoUtils.EOL);
      for (      String l : keyLines) {
        w.append(l).append(IoUtils.EOL);
      }
    }
     List<AuthorizedKeyEntry> entries=AuthorizedKeyEntry.readAuthorizedKeys(file);
    assertEquals("Mismatched number of loaded entries",keyLines.size(),entries.size());
    List<PublicKey> keySet=AuthorizedKeyEntry.resolveAuthorizedKeys(PublicKeyEntryResolver.FAILING,entries);
    assertEquals("Mismatched number of loaded keys",entries.size(),keySet.size());
    reloadCount.set(0);
    for (int index=0; index < keySet.size(); index++) {
      PublicKey k=keySet.get(index);
      String keyData=keyLines.get(index);
      assertTrue("Failed to authenticate with key #" + (index + 1) + " "+ k.getAlgorithm()+ "["+ keyData+ "] on file="+ file,auth.authenticate(getCurrentTestName(),k,null));
      assertEquals("Unexpected keys re-loading of " + keyLines.size() + " remaining at key #"+ (index + 1)+ " on file="+ file,1,reloadCount.get());
    }
    keyLines.remove(0);
  }
  assertTrue("File no longer exists: " + file,Files.exists(file));
  assertFalse("Unexpected authentication success for empty file " + file,auth.authenticate(getCurrentTestName(),Mockito.mock(PublicKey.class),null));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.server.config.keys.DefaultAuthorizedKeysAuthenticatorTest </h4><pre class="type-8 type-3 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUsernameValidation() throws Exception {
  Path file=getTempTargetRelativeFile(getCurrentTestName());
  writeDefaultSupportedKeys(file);
  Collection<AuthorizedKeyEntry> entries=AuthorizedKeyEntry.readAuthorizedKeys(file);
  Collection<PublicKey> keySet=AuthorizedKeyEntry.resolveAuthorizedKeys(PublicKeyEntryResolver.FAILING,entries);
  PublickeyAuthenticator auth=new DefaultAuthorizedKeysAuthenticator(file,false);
  String thisUser=OsUtils.getCurrentUser();
  for (  String username : new String[]{null,"",thisUser,getClass().getName() + "#" + getCurrentTestName()}) {
    boolean expected=thisUser.equals(username);
    for (    PublicKey key : keySet) {
      boolean actual=auth.authenticate(username,key,null);
      assertEquals("Mismatched authentication results for user='" + username + "'",expected,actual);
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.server.config.keys.ServerIdentityTest </h4><pre class="type-8 type-10 type-2 type-3 type-14 type-7 type-12 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Sets implicit assumptions ">AssumptionSetter</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Sets implicit assumptions 
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLoadServerIdentities() throws Exception {
  Assume.assumeTrue("BouncyCastle not registered",SecurityUtils.isBouncyCastleRegistered());
  Path resFolder=getClassResourcesFolder(TEST_SUBFOLDER,getClass());
  Collection<Path> paths=new ArrayList<Path>(BuiltinIdentities.VALUES.size());
  LinkOption[] options=IoUtils.getLinkOptions(false);
  Collection<BuiltinIdentities> expected=EnumSet.noneOf(BuiltinIdentities.class);
  for (  BuiltinIdentities type : BuiltinIdentities.VALUES) {
    String fileName=ServerIdentity.getIdentityFileName(type);
    Path file=resFolder.resolve(fileName);
    if (!Files.exists(file,options)) {
      System.out.println("Skip non-existing identity file " + file);
      continue;
    }
    if (!type.isSupported()) {
      System.out.println("Skip unsupported identity file " + file);
      continue;
    }
    paths.add(file);
    expected.add(type);
  }
  Properties props=new Properties();
  props.setProperty(ServerIdentity.HOST_KEY_CONFIG_PROP,GenericUtils.join(paths,','));
  Map<String,KeyPair> ids=ServerIdentity.loadIdentities(props,options);
  assertEquals("Mismatched loaded ids count",GenericUtils.size(paths),GenericUtils.size(ids));
  Collection<KeyPair> pairs=new ArrayList<KeyPair>(ids.size());
  for (  BuiltinIdentities type : BuiltinIdentities.VALUES) {
    if (expected.contains(type)) {
      KeyPair kp=ids.get(type.getName());
      assertNotNull("No key pair loaded for " + type,kp);
      pairs.add(kp);
    }
  }
  KeyPairProvider provider=IdentityUtils.createKeyPairProvider(ids,true);
  assertNotNull("No provider generated",provider);
  Iterable<KeyPair> keys=provider.loadKeys();
  for (  KeyPair kp : keys) {
    assertTrue("Unexpected loaded key: " + kp,pairs.remove(kp));
  }
  assertEquals("Not all pairs listed",0,pairs.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.server.jaas.JaasPasswordAuthenticatorTest </h4><pre class="type-2 type-3 type-7 type-12 type-9 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies whether objects are null
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testAuthenticator(){
  JaasPasswordAuthenticator auth=new JaasPasswordAuthenticator();
  assertNull(auth.getDomain());
  auth.setDomain("domain");
  assertEquals("domain",auth.getDomain());
  assertTrue(auth.authenticate("sshd","sshd"));
  assertFalse(auth.authenticate("sshd","dummy"));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.server.keyprovider.AbstractGeneratorHostKeyProviderTest </h4><pre class="type-3 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@SuppressWarnings("synthetic-access") @Test public void testOverwriteKey() throws Exception {
  File keyPairFile=temporaryFolder.newFile();
  TestProvider provider=new TestProvider(keyPairFile);
  provider.loadKeys();
  assertEquals("Mismatched generate write count",1,provider.getWriteCount());
  provider=new TestProvider(keyPairFile);
  provider.setOverwriteAllowed(false);
  provider.loadKeys();
  assertEquals("Mismatched load write count",0,provider.getWriteCount());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: org.apache.sshd.server.shell.InvertedShellWrapperTest </h4><pre class="type-8 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testShellDiesBeforeAllDataExhausted() throws Exception {
  final String IN_CONTENT="shellInput";
  final String OUT_CONTENT="shellOutput";
  final String ERR_CONTENT="shellError";
  try (final InputStream stdin=newDelayedInputStream(Long.SIZE,IN_CONTENT);final ByteArrayOutputStream shellIn=new ByteArrayOutputStream(Byte.MAX_VALUE);final InputStream shellOut=newDelayedInputStream(Byte.SIZE,OUT_CONTENT);ByteArrayOutputStream stdout=new ByteArrayOutputStream(OUT_CONTENT.length() + Byte.SIZE);final InputStream shellErr=newDelayedInputStream(Short.SIZE,ERR_CONTENT);ByteArrayOutputStream stderr=new ByteArrayOutputStream(ERR_CONTENT.length() + Byte.SIZE)){
    InvertedShell shell=new InvertedShell(){
      @Override public void start(      Environment env) throws IOException {
      }
      @Override public void setSession(      ServerSession session){
      }
      @Override public boolean isAlive(){
        return false;
      }
      @Override public InputStream getOutputStream(){
        return shellOut;
      }
      @Override public OutputStream getInputStream(){
        return shellIn;
      }
      @Override public InputStream getErrorStream(){
        return shellErr;
      }
      @Override public int exitValue(){
        return -1;
      }
      @Override public void destroy(){
      }
    }
;
    BogusExitCallback exitCallback=new BogusExitCallback();
    InvertedShellWrapper wrapper=new InvertedShellWrapper(shell);
    try {
      wrapper.setInputStream(stdin);
      wrapper.setOutputStream(stdout);
      wrapper.setErrorStream(stderr);
      wrapper.setExitCallback(exitCallback);
      wrapper.start(new BogusEnvironment());
      wrapper.pumpStreams();
    }
  finally {
      wrapper.destroy();
    }
    assertEquals("Mismatched STDIN value",IN_CONTENT,shellIn.toString(StandardCharsets.UTF_8.name()));
    assertEquals("Mismatched STDOUT value",OUT_CONTENT,stdout.toString(StandardCharsets.UTF_8.name()));
    assertEquals("Mismatched STDERR value",ERR_CONTENT,stderr.toString(StandardCharsets.UTF_8.name()));
  }
 }

</code></pre>

<br>
<pre class="type-3 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testExceptionWhilePumpStreams() throws Exception {
  final BogusInvertedShell bogusShell=newShell("out","err");
  bogusShell.setAlive(false);
  final int DESTROYED_EXIT_VALUE=7365;
  InvertedShell shell=new InvertedShell(){
    private boolean destroyed;
    @Override public void start(    Environment env) throws IOException {
      bogusShell.start(env);
    }
    @Override public void setSession(    ServerSession session){
      bogusShell.setSession(session);
    }
    @Override public boolean isAlive(){
      return bogusShell.isAlive();
    }
    @Override public InputStream getOutputStream(){
      return bogusShell.getOutputStream();
    }
    @Override public OutputStream getInputStream(){
      return bogusShell.getInputStream();
    }
    @Override public InputStream getErrorStream(){
      return bogusShell.getErrorStream();
    }
    @Override public int exitValue(){
      return destroyed ? DESTROYED_EXIT_VALUE : bogusShell.exitValue();
    }
    @Override public void destroy(){
      bogusShell.destroy();
      bogusShell.setAlive(false);
      destroyed=true;
    }
  }
;
  try (ByteArrayOutputStream out=new ByteArrayOutputStream();ByteArrayOutputStream err=new ByteArrayOutputStream();InputStream stdin=new InputStream(){
    private final byte[] data=getCurrentTestName().getBytes(StandardCharsets.UTF_8);
    private int readPos;
    @Override public int read() throws IOException {
      if (readPos >= data.length) {
        throw new EOFException("Data exhausted");
      }
      return data[readPos++];
    }
    @Override public int available() throws IOException {
      return data.length;
    }
  }
){
    BogusExitCallback exitCallback=new BogusExitCallback();
    InvertedShellWrapper wrapper=new InvertedShellWrapper(shell);
    try {
      wrapper.setInputStream(stdin);
      wrapper.setOutputStream(out);
      wrapper.setErrorStream(err);
      wrapper.setExitCallback(exitCallback);
      wrapper.start(new BogusEnvironment());
      wrapper.pumpStreams();
    }
  finally {
      wrapper.destroy();
    }
    assertEquals("Mismatched exit value",DESTROYED_EXIT_VALUE,exitCallback.getExitValue());
    assertEquals("Mismatched exit message",EOFException.class.getSimpleName(),exitCallback.getExitMessage());
  }
 }

</code></pre>

<br>
<pre class="type-3 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testStreamsAreFlushedBeforeClosing() throws Exception {
  BogusInvertedShell shell=newShell("out","err");
  shell.setAlive(false);
  try (ByteArrayInputStream in=new ByteArrayInputStream("in".getBytes(StandardCharsets.UTF_8));ByteArrayOutputStream out=new ByteArrayOutputStream(50);ByteArrayOutputStream err=new ByteArrayOutputStream()){
    InvertedShellWrapper wrapper=new InvertedShellWrapper(shell);
    try {
      wrapper.setInputStream(in);
      wrapper.setOutputStream(out);
      wrapper.setErrorStream(err);
      wrapper.setExitCallback(new BogusExitCallback());
      wrapper.start(new BogusEnvironment());
      wrapper.pumpStreams();
      assertEquals("stdin","in",shell.getInputStream().toString());
      assertEquals("stdout","out",out.toString());
      assertEquals("stderr","err",err.toString());
    }
  finally {
      wrapper.destroy();
    }
  }
 }

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
