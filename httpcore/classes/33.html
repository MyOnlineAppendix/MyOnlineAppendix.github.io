<h3 style="margin:0px">Class: org.apache.hc.core5.http.impl.io.TestSessionInOutBuffers (20 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="10"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('10')" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value "><kbd id="tag-10"class="label-info"style="display: inline-block;font-size:7pt" >EqualityVerifier&nbsp;(16)</kbd></button>&nbsp;<button id="1"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('1')" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls"><kbd id="tag-1"class="label-info"style="display: inline-block;font-size:7pt" >InternalCallVerifier&nbsp;(12)</kbd></button>&nbsp;<button id="11"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('11')" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) "><kbd id="tag-11"class="label-info"style="display: inline-block;font-size:7pt" >APIUtilityVerifier&nbsp;(11)</kbd></button>&nbsp;<button id="14"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('14')" data-toggle="tooltip" title="Verifies assertions in iterations"><kbd id="tag-14"class="label-info"style="display: inline-block;font-size:7pt" >IterativeVerifier&nbsp;(4)</kbd></button>&nbsp;<button id="6"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('6')" data-toggle="tooltip" title="Executes methods or other tests from the same test unit"><kbd id="tag-6"class="label-info"style="display: inline-block;font-size:7pt" >ExecutionTester&nbsp;(4)</kbd></button>&nbsp;<button id="5"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('5')" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution"><kbd id="tag-5"class="label-info"style="display: inline-block;font-size:7pt" >ExceptionVerifier&nbsp;(2)</kbd></button>&nbsp;<button id="4"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('4')" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes"><kbd id="tag-4"class="label-info"style="display: inline-block;font-size:7pt" >HybridVerifier&nbsp;(2)</kbd></button>&nbsp;<button id="9"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('9')" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure"><kbd id="tag-9"class="label-info"style="display: inline-block;font-size:7pt" >UtilityVerifier&nbsp;(2)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-11 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUnmappableInputActionIgnore() throws Exception {
  final String s="This text contains a circumflex \u0302 !!!";
  final CharsetEncoder encoder=StandardCharsets.ISO_8859_1.newEncoder();
  encoder.onMalformedInput(CodingErrorAction.IGNORE);
  encoder.onUnmappableCharacter(CodingErrorAction.IGNORE);
  final SessionOutputBuffer outbuffer=new SessionOutputBufferImpl(16,encoder);
  final ByteArrayOutputStream outputStream=new ByteArrayOutputStream();
  final CharArrayBuffer chbuffer=new CharArrayBuffer(32);
  chbuffer.append(s);
  outbuffer.writeLine(chbuffer,outputStream);
  outbuffer.flush(outputStream);
  final String result=new String(outputStream.toByteArray(),"ISO-8859-1");
  Assert.assertEquals("This text contains a circumflex  !!!\r\n",result);
}

</code></pre>

<pre class="type-11 type-1 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBasicReadWriteLineLargeBuffer() throws Exception {
  final String[] teststrs=new String[5];
  teststrs[0]="Hello";
  teststrs[1]="This string should be much longer than the size of the output buffer " + "which is only 16 bytes for this test";
  final StringBuilder buffer=new StringBuilder();
  for (int i=0; i < 15; i++) {
    buffer.append("123456789 ");
  }
  buffer.append("and stuff like that");
  teststrs[2]=buffer.toString();
  teststrs[3]="";
  teststrs[4]="And goodbye";
  final CharArrayBuffer chbuffer=new CharArrayBuffer(16);
  final SessionOutputBuffer outbuffer=new SessionOutputBufferImpl(16);
  final ByteArrayOutputStream outputStream=new ByteArrayOutputStream();
  for (  final String teststr : teststrs) {
    chbuffer.clear();
    chbuffer.append(teststr);
    outbuffer.writeLine(chbuffer,outputStream);
  }
  outbuffer.writeLine(null,outputStream);
  outbuffer.flush(outputStream);
  final long bytesWritten=outbuffer.getMetrics().getBytesTransferred();
  long expected=0;
  for (  final String teststr : teststrs) {
    expected+=(teststr.length() + 2);
  }
  Assert.assertEquals(expected,bytesWritten);
  final SessionInputBuffer inbuffer=new SessionInputBufferImpl(1024);
  final ByteArrayInputStream inputStream=new ByteArrayInputStream(outputStream.toByteArray());
  for (  final String teststr : teststrs) {
    chbuffer.clear();
    inbuffer.readLine(chbuffer,inputStream);
    Assert.assertEquals(teststr,chbuffer.toString());
  }
  chbuffer.clear();
  Assert.assertEquals(-1,inbuffer.readLine(chbuffer,inputStream));
  chbuffer.clear();
  Assert.assertEquals(-1,inbuffer.readLine(chbuffer,inputStream));
  final long bytesRead=inbuffer.getMetrics().getBytesTransferred();
  Assert.assertEquals(expected,bytesRead);
}

</code></pre>

<pre class="type-1 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBasicBufferProperties() throws Exception {
  final SessionInputBuffer inbuffer=new SessionInputBufferImpl(16);
  final ByteArrayInputStream inputStream=new ByteArrayInputStream(new byte[]{1,2,3});
  Assert.assertEquals(16,inbuffer.capacity());
  Assert.assertEquals(16,inbuffer.available());
  Assert.assertEquals(0,inbuffer.length());
  inbuffer.read(inputStream);
  Assert.assertEquals(14,inbuffer.available());
  Assert.assertEquals(2,inbuffer.length());
  final SessionOutputBuffer outbuffer=new SessionOutputBufferImpl(16);
  final ByteArrayOutputStream outputStream=new ByteArrayOutputStream();
  Assert.assertEquals(16,outbuffer.capacity());
  Assert.assertEquals(16,outbuffer.available());
  Assert.assertEquals(0,outbuffer.length());
  outbuffer.write(new byte[]{1,2,3},outputStream);
  Assert.assertEquals(13,outbuffer.available());
  Assert.assertEquals(3,outbuffer.length());
}

</code></pre>

<pre class="type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=CharacterCodingException.class) public void testMalformedInputActionReport() throws Exception {
  final byte[] tmp=constructString(SWISS_GERMAN_HELLO).getBytes(StandardCharsets.ISO_8859_1);
  final CharsetDecoder decoder=StandardCharsets.UTF_8.newDecoder();
  decoder.onMalformedInput(CodingErrorAction.REPORT);
  decoder.onUnmappableCharacter(CodingErrorAction.IGNORE);
  final SessionInputBuffer inbuffer=new SessionInputBufferImpl(16,decoder);
  final ByteArrayInputStream inputStream=new ByteArrayInputStream(tmp);
  final CharArrayBuffer chbuffer=new CharArrayBuffer(32);
  inbuffer.readLine(chbuffer,inputStream);
}

</code></pre>

<pre class="type-11 type-14 type-1 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReadWriteBytes() throws Exception {
  final byte[] out=new byte[40];
  for (int i=0; i < out.length; i++) {
    out[i]=(byte)('0' + i);
  }
  final SessionOutputBuffer outbuffer=new SessionOutputBufferImpl(16);
  final ByteArrayOutputStream outputStream=new ByteArrayOutputStream();
  int off=0;
  int remaining=out.length;
  while (remaining > 0) {
    int chunk=10;
    if (chunk > remaining) {
      chunk=remaining;
    }
    outbuffer.write(out,off,chunk,outputStream);
    off+=chunk;
    remaining-=chunk;
  }
  outbuffer.flush(outputStream);
  final long bytesWritten=outbuffer.getMetrics().getBytesTransferred();
  Assert.assertEquals(out.length,bytesWritten);
  final byte[] tmp=outputStream.toByteArray();
  Assert.assertEquals(out.length,tmp.length);
  for (int i=0; i < out.length; i++) {
    Assert.assertEquals(out[i],tmp[i]);
  }
  final SessionInputBuffer inbuffer=new SessionInputBufferImpl(16);
  final ByteArrayInputStream inputStream=new ByteArrayInputStream(tmp);
  Assert.assertEquals(0,inbuffer.read(null,0,10,inputStream));
  Assert.assertEquals(0,inbuffer.read(null,inputStream));
  long bytesRead=inbuffer.getMetrics().getBytesTransferred();
  Assert.assertEquals(0,bytesRead);
  final byte[] in=new byte[40];
  off=0;
  remaining=in.length;
  while (remaining > 0) {
    int chunk=10;
    if (chunk > remaining) {
      chunk=remaining;
    }
    final int l=inbuffer.read(in,off,chunk,inputStream);
    if (l == -1) {
      break;
    }
    off+=l;
    remaining-=l;
  }
  for (int i=0; i < out.length; i++) {
    Assert.assertEquals(out[i],in[i]);
  }
  Assert.assertEquals(-1,inbuffer.read(tmp,inputStream));
  Assert.assertEquals(-1,inbuffer.read(tmp,inputStream));
  bytesRead=inbuffer.getMetrics().getBytesTransferred();
  Assert.assertEquals(out.length,bytesRead);
}

</code></pre>

<pre class="type-5 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expected=CharacterCodingException.class) public void testUnmappableInputActionReport() throws Exception {
  final String s="This text contains a circumflex \u0302 !!!";
  final CharsetEncoder encoder=StandardCharsets.ISO_8859_1.newEncoder();
  encoder.onMalformedInput(CodingErrorAction.IGNORE);
  encoder.onUnmappableCharacter(CodingErrorAction.REPORT);
  final SessionOutputBuffer outbuffer=new SessionOutputBufferImpl(16,encoder);
  final ByteArrayOutputStream outputStream=new ByteArrayOutputStream();
  final CharArrayBuffer chbuffer=new CharArrayBuffer(32);
  chbuffer.append(s);
  outbuffer.writeLine(chbuffer,outputStream);
}

</code></pre>

<pre class="type-11 type-1 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testComplexReadWriteLine() throws Exception {
  final SessionOutputBuffer outbuffer=new SessionOutputBufferImpl(16);
  final ByteArrayOutputStream outputStream=new ByteArrayOutputStream();
  outbuffer.write(new byte[]{'a','\n'},outputStream);
  outbuffer.write(new byte[]{'\r','\n'},outputStream);
  outbuffer.write(new byte[]{'\r','\r','\n'},outputStream);
  outbuffer.write(new byte[]{'\n'},outputStream);
  outbuffer.write(null,outputStream);
  outbuffer.write(null,0,12,outputStream);
  outbuffer.flush(outputStream);
  long bytesWritten=outbuffer.getMetrics().getBytesTransferred();
  Assert.assertEquals(8,bytesWritten);
  final StringBuilder buffer=new StringBuilder();
  for (int i=0; i < 14; i++) {
    buffer.append("a");
  }
  final String s1=buffer.toString();
  buffer.append("\r\n");
  outbuffer.write(buffer.toString().getBytes(StandardCharsets.US_ASCII),outputStream);
  outbuffer.flush(outputStream);
  bytesWritten=outbuffer.getMetrics().getBytesTransferred();
  Assert.assertEquals(8 + 14 + 2,bytesWritten);
  buffer.setLength(0);
  for (int i=0; i < 15; i++) {
    buffer.append("a");
  }
  final String s2=buffer.toString();
  buffer.append("\r\n");
  outbuffer.write(buffer.toString().getBytes(StandardCharsets.US_ASCII),outputStream);
  outbuffer.flush(outputStream);
  bytesWritten=outbuffer.getMetrics().getBytesTransferred();
  Assert.assertEquals(8 + 14 + 2+ 15+ 2,bytesWritten);
  buffer.setLength(0);
  for (int i=0; i < 16; i++) {
    buffer.append("a");
  }
  final String s3=buffer.toString();
  buffer.append("\r\n");
  outbuffer.write(buffer.toString().getBytes(StandardCharsets.US_ASCII),outputStream);
  outbuffer.flush(outputStream);
  bytesWritten=outbuffer.getMetrics().getBytesTransferred();
  Assert.assertEquals(8 + 14 + 2+ 15+ 2+ 16+ 2,bytesWritten);
  outbuffer.write(new byte[]{'a'},outputStream);
  outbuffer.flush(outputStream);
  bytesWritten=outbuffer.getMetrics().getBytesTransferred();
  Assert.assertEquals(8 + 14 + 2+ 15+ 2+ 16+ 2+ 1,bytesWritten);
  final SessionInputBuffer inbuffer=new SessionInputBufferImpl(16);
  final ByteArrayInputStream inputStream=new ByteArrayInputStream(outputStream.toByteArray());
  final CharArrayBuffer chbuffer=new CharArrayBuffer(16);
  chbuffer.clear();
  inbuffer.readLine(chbuffer,inputStream);
  Assert.assertEquals("a",chbuffer.toString());
  chbuffer.clear();
  inbuffer.readLine(chbuffer,inputStream);
  Assert.assertEquals("",chbuffer.toString());
  chbuffer.clear();
  inbuffer.readLine(chbuffer,inputStream);
  Assert.assertEquals("\r",chbuffer.toString());
  chbuffer.clear();
  inbuffer.readLine(chbuffer,inputStream);
  Assert.assertEquals("",chbuffer.toString());
  chbuffer.clear();
  inbuffer.readLine(chbuffer,inputStream);
  Assert.assertEquals(s1,chbuffer.toString());
  chbuffer.clear();
  inbuffer.readLine(chbuffer,inputStream);
  Assert.assertEquals(s2,chbuffer.toString());
  chbuffer.clear();
  inbuffer.readLine(chbuffer,inputStream);
  Assert.assertEquals(s3,chbuffer.toString());
  chbuffer.clear();
  inbuffer.readLine(chbuffer,inputStream);
  Assert.assertEquals("a",chbuffer.toString());
  chbuffer.clear();
  inbuffer.readLine(chbuffer,inputStream);
  Assert.assertEquals(-1,inbuffer.readLine(chbuffer,inputStream));
  chbuffer.clear();
  inbuffer.readLine(chbuffer,inputStream);
  Assert.assertEquals(-1,inbuffer.readLine(chbuffer,inputStream));
  final long bytesRead=inbuffer.getMetrics().getBytesTransferred();
  Assert.assertEquals(bytesWritten,bytesRead);
}

</code></pre>

<pre class="type-11 type-14 type-1 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMultibyteCodedReadWriteLine() throws Exception {
  final String s1=constructString(SWISS_GERMAN_HELLO);
  final String s2=constructString(RUSSIAN_HELLO);
  final String s3="Like hello and stuff";
  final SessionOutputBuffer outbuffer=new SessionOutputBufferImpl(16,StandardCharsets.UTF_8.newEncoder());
  final ByteArrayOutputStream outputStream=new ByteArrayOutputStream();
  final CharArrayBuffer chbuffer=new CharArrayBuffer(16);
  for (int i=0; i < 10; i++) {
    chbuffer.clear();
    chbuffer.append(s1);
    outbuffer.writeLine(chbuffer,outputStream);
    chbuffer.clear();
    chbuffer.append(s2);
    outbuffer.writeLine(chbuffer,outputStream);
    chbuffer.clear();
    chbuffer.append(s3);
    outbuffer.writeLine(chbuffer,outputStream);
  }
  outbuffer.flush(outputStream);
  final long bytesWritten=outbuffer.getMetrics().getBytesTransferred();
  final long expected=((s1.getBytes(StandardCharsets.UTF_8).length + 2) + (s2.getBytes(StandardCharsets.UTF_8).length + 2) + (s3.getBytes(StandardCharsets.UTF_8).length + 2)) * 10;
  Assert.assertEquals(expected,bytesWritten);
  final SessionInputBuffer inbuffer=new SessionInputBufferImpl(16,StandardCharsets.UTF_8.newDecoder());
  final ByteArrayInputStream inputStream=new ByteArrayInputStream(outputStream.toByteArray());
  for (int i=0; i < 10; i++) {
    chbuffer.clear();
    inbuffer.readLine(chbuffer,inputStream);
    Assert.assertEquals(s1,chbuffer.toString());
    chbuffer.clear();
    inbuffer.readLine(chbuffer,inputStream);
    Assert.assertEquals(s2,chbuffer.toString());
    chbuffer.clear();
    inbuffer.readLine(chbuffer,inputStream);
    Assert.assertEquals(s3,chbuffer.toString());
  }
  chbuffer.clear();
  Assert.assertEquals(-1,inbuffer.readLine(chbuffer,inputStream));
  chbuffer.clear();
  Assert.assertEquals(-1,inbuffer.readLine(chbuffer,inputStream));
  final long bytesRead=inbuffer.getMetrics().getBytesTransferred();
  Assert.assertEquals(expected,bytesRead);
}

</code></pre>

<pre class="type-9 type-1 type-10 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLineLimit() throws Exception {
  final String s="a very looooooooooooooooooooooooooooooooooooooooooong line\r\n";
  final byte[] tmp=s.getBytes(StandardCharsets.US_ASCII);
  final SessionInputBuffer inbuffer1=new SessionInputBufferImpl(5,MessageConstraints.DEFAULT);
  final InputStream inputStream1=new ByteArrayInputStream(tmp);
  final CharArrayBuffer chbuffer=new CharArrayBuffer(16);
  inbuffer1.readLine(chbuffer,inputStream1);
  final long bytesRead=inbuffer1.getMetrics().getBytesTransferred();
  Assert.assertEquals(60,bytesRead);
  final SessionInputBuffer inbuffer2=new SessionInputBufferImpl(5,MessageConstraints.lineLen(15));
  final InputStream inputStream2=new ByteArrayInputStream(tmp);
  try {
    chbuffer.clear();
    inbuffer2.readLine(chbuffer,inputStream2);
    Assert.fail("MessageConstraintException expected");
  }
 catch (  final MessageConstraintException ex) {
  }
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMalformedInputActionReplace() throws Exception {
  final byte[] tmp=constructString(SWISS_GERMAN_HELLO).getBytes(StandardCharsets.ISO_8859_1);
  final CharsetDecoder decoder=StandardCharsets.UTF_8.newDecoder();
  decoder.onMalformedInput(CodingErrorAction.REPLACE);
  decoder.onUnmappableCharacter(CodingErrorAction.IGNORE);
  final SessionInputBuffer inbuffer=new SessionInputBufferImpl(16,decoder);
  final ByteArrayInputStream inputStream=new ByteArrayInputStream(tmp);
  final CharArrayBuffer chbuffer=new CharArrayBuffer(32);
  inbuffer.readLine(chbuffer,inputStream);
  Assert.assertEquals("Gr\ufffdezi_z\ufffdm\ufffd",chbuffer.toString());
}

</code></pre>

<pre class="type-11 type-14 type-1 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReadWriteByte() throws Exception {
  final byte[] out=new byte[40];
  for (int i=0; i < out.length; i++) {
    out[i]=(byte)(120 + i);
  }
  final SessionOutputBuffer outbuffer=new SessionOutputBufferImpl(16);
  final ByteArrayOutputStream outputStream=new ByteArrayOutputStream();
  for (  final byte element : out) {
    outbuffer.write(element,outputStream);
  }
  outbuffer.flush(outputStream);
  final long bytesWritten=outbuffer.getMetrics().getBytesTransferred();
  Assert.assertEquals(out.length,bytesWritten);
  final byte[] tmp=outputStream.toByteArray();
  Assert.assertEquals(out.length,tmp.length);
  for (int i=0; i < out.length; i++) {
    Assert.assertEquals(out[i],tmp[i]);
  }
  final SessionInputBuffer inbuffer=new SessionInputBufferImpl(16);
  final ByteArrayInputStream inputStream=new ByteArrayInputStream(tmp);
  final byte[] in=new byte[40];
  for (int i=0; i < in.length; i++) {
    in[i]=(byte)inbuffer.read(inputStream);
  }
  for (int i=0; i < out.length; i++) {
    Assert.assertEquals(out[i],in[i]);
  }
  Assert.assertEquals(-1,inbuffer.read(inputStream));
  Assert.assertEquals(-1,inbuffer.read(inputStream));
  final long bytesRead=inbuffer.getMetrics().getBytesTransferred();
  Assert.assertEquals(out.length,bytesRead);
}

</code></pre>

<pre class="type-11 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testUnmappableInputActionReplace() throws Exception {
  final String s="This text contains a circumflex \u0302 !!!";
  final CharsetEncoder encoder=StandardCharsets.ISO_8859_1.newEncoder();
  encoder.onMalformedInput(CodingErrorAction.IGNORE);
  encoder.onUnmappableCharacter(CodingErrorAction.REPLACE);
  final SessionOutputBuffer outbuffer=new SessionOutputBufferImpl(16,encoder);
  final ByteArrayOutputStream outputStream=new ByteArrayOutputStream();
  final CharArrayBuffer chbuffer=new CharArrayBuffer(32);
  chbuffer.append(s);
  outbuffer.writeLine(chbuffer,outputStream);
  outbuffer.flush(outputStream);
  final String result=new String(outputStream.toByteArray(),"ISO-8859-1");
  Assert.assertEquals("This text contains a circumflex ? !!!\r\n",result);
}

</code></pre>

<pre class="type-11 type-1 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testBasicReadWriteLine() throws Exception {
  final String[] teststrs=new String[5];
  teststrs[0]="Hello";
  teststrs[1]="This string should be much longer than the size of the output buffer " + "which is only 16 bytes for this test";
  final StringBuilder buffer=new StringBuilder();
  for (int i=0; i < 15; i++) {
    buffer.append("123456789 ");
  }
  buffer.append("and stuff like that");
  teststrs[2]=buffer.toString();
  teststrs[3]="";
  teststrs[4]="And goodbye";
  final CharArrayBuffer chbuffer=new CharArrayBuffer(16);
  final SessionOutputBuffer outbuffer=new SessionOutputBufferImpl(16);
  final ByteArrayOutputStream outputStream=new ByteArrayOutputStream();
  for (  final String teststr : teststrs) {
    chbuffer.clear();
    chbuffer.append(teststr);
    outbuffer.writeLine(chbuffer,outputStream);
  }
  outbuffer.writeLine(null,outputStream);
  outbuffer.flush(outputStream);
  HttpTransportMetrics tmetrics=outbuffer.getMetrics();
  final long bytesWritten=tmetrics.getBytesTransferred();
  long expected=0;
  for (  final String teststr : teststrs) {
    expected+=(teststr.length() + 2);
  }
  Assert.assertEquals(expected,bytesWritten);
  final SessionInputBuffer inbuffer=new SessionInputBufferImpl(16);
  final ByteArrayInputStream inputStream=new ByteArrayInputStream(outputStream.toByteArray());
  for (  final String teststr : teststrs) {
    chbuffer.clear();
    inbuffer.readLine(chbuffer,inputStream);
    Assert.assertEquals(teststr,chbuffer.toString());
  }
  chbuffer.clear();
  Assert.assertEquals(-1,inbuffer.readLine(chbuffer,inputStream));
  chbuffer.clear();
  Assert.assertEquals(-1,inbuffer.readLine(chbuffer,inputStream));
  tmetrics=inbuffer.getMetrics();
  final long bytesRead=tmetrics.getBytesTransferred();
  Assert.assertEquals(expected,bytesRead);
}

</code></pre>

<pre class="type-11 type-1 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testReadLineFringeCase1() throws Exception {
  final String s="abc\r\n";
  final byte[] tmp=s.getBytes(StandardCharsets.US_ASCII);
  final SessionInputBuffer inbuffer1=new SessionInputBufferImpl(128);
  final ByteArrayInputStream inputStream=new ByteArrayInputStream(tmp);
  Assert.assertEquals('a',inbuffer1.read(inputStream));
  Assert.assertEquals('b',inbuffer1.read(inputStream));
  Assert.assertEquals('c',inbuffer1.read(inputStream));
  Assert.assertEquals('\r',inbuffer1.read(inputStream));
  final CharArrayBuffer chbuffer=new CharArrayBuffer(16);
  Assert.assertEquals(0,inbuffer1.readLine(chbuffer,inputStream));
}

</code></pre>

<pre class="type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWriteSmallFragmentNoBuffering() throws Exception {
  final ByteArrayOutputStream outputStream=Mockito.spy(new ByteArrayOutputStream());
  final SessionOutputBuffer outbuffer=new SessionOutputBufferImpl(new BasicHttpTransportMetrics(),16,0,null);
  outbuffer.write(1,outputStream);
  outbuffer.write(2,outputStream);
  outbuffer.write(new byte[]{1,2},outputStream);
  outbuffer.write(new byte[]{3,4},outputStream);
  Mockito.verify(outputStream,Mockito.times(2)).write(Mockito.<byte[]>any(),Mockito.anyInt(),Mockito.anyInt());
  Mockito.verify(outputStream,Mockito.times(2)).write(Mockito.anyInt());
}

</code></pre>

<pre class="type-11 type-1 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMultibyteCodedReadWriteLongLine() throws Exception {
  final String s1=constructString(SWISS_GERMAN_HELLO);
  final String s2=constructString(RUSSIAN_HELLO);
  final String s3="Like hello and stuff";
  final StringBuilder buf=new StringBuilder();
  for (int i=0; i < 1024; i++) {
    buf.append(s1).append(s2).append(s3);
  }
  final String s=buf.toString();
  final SessionOutputBuffer outbuffer=new SessionOutputBufferImpl(16,StandardCharsets.UTF_8.newEncoder());
  final ByteArrayOutputStream outputStream=new ByteArrayOutputStream();
  final CharArrayBuffer chbuffer=new CharArrayBuffer(16);
  chbuffer.append(s);
  outbuffer.writeLine(chbuffer,outputStream);
  outbuffer.flush(outputStream);
  final SessionInputBuffer inbuffer=new SessionInputBufferImpl(16,StandardCharsets.UTF_8.newDecoder());
  final ByteArrayInputStream inputStream=new ByteArrayInputStream(outputStream.toByteArray());
  chbuffer.clear();
  inbuffer.readLine(chbuffer,inputStream);
  Assert.assertEquals(s,chbuffer.toString());
}

</code></pre>

<pre class="type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testWriteSmallFragmentBuffering() throws Exception {
  final ByteArrayOutputStream outputStream=Mockito.spy(new ByteArrayOutputStream());
  final SessionOutputBuffer outbuffer=new SessionOutputBufferImpl(new BasicHttpTransportMetrics(),16,16,null);
  outbuffer.write(1,outputStream);
  outbuffer.write(2,outputStream);
  outbuffer.write(new byte[]{1,2},outputStream);
  outbuffer.write(new byte[]{3,4},outputStream);
  outbuffer.flush(outputStream);
  Mockito.verify(outputStream,Mockito.times(1)).write(Mockito.<byte[]>any(),Mockito.anyInt(),Mockito.anyInt());
  Mockito.verify(outputStream,Mockito.never()).write(Mockito.anyInt());
}

</code></pre>

<pre class="type-9 type-1 type-10 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testLineLimit2() throws Exception {
  final String s="just a line\r\n";
  final byte[] tmp=s.getBytes(StandardCharsets.US_ASCII);
  final SessionInputBuffer inbuffer1=new SessionInputBufferImpl(25,MessageConstraints.DEFAULT);
  final InputStream inputStream1=new ByteArrayInputStream(tmp);
  final CharArrayBuffer chbuffer=new CharArrayBuffer(16);
  inbuffer1.readLine(chbuffer,inputStream1);
  final long bytesRead=inbuffer1.getMetrics().getBytesTransferred();
  Assert.assertEquals(13,bytesRead);
  final SessionInputBuffer inbuffer2=new SessionInputBufferImpl(25,MessageConstraints.lineLen(10));
  final InputStream inputStream2=new ByteArrayInputStream(tmp);
  try {
    chbuffer.clear();
    inbuffer2.readLine(chbuffer,inputStream2);
    Assert.fail("MessageConstraintException expected");
  }
 catch (  final MessageConstraintException ex) {
  }
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMalformedInputActionIgnore() throws Exception {
  final byte[] tmp=constructString(SWISS_GERMAN_HELLO).getBytes(StandardCharsets.ISO_8859_1);
  final CharsetDecoder decoder=StandardCharsets.UTF_8.newDecoder();
  decoder.onMalformedInput(CodingErrorAction.IGNORE);
  decoder.onUnmappableCharacter(CodingErrorAction.IGNORE);
  final SessionInputBuffer inbuffer=new SessionInputBufferImpl(16,decoder);
  final ByteArrayInputStream inputStream=new ByteArrayInputStream(tmp);
  final CharArrayBuffer chbuffer=new CharArrayBuffer(32);
  inbuffer.readLine(chbuffer,inputStream);
  Assert.assertEquals("Grezi_zm",chbuffer.toString());
}

</code></pre>

<pre class="type-11 type-14 type-1 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testNonAsciiReadWriteLine() throws Exception {
  final String s1=constructString(SWISS_GERMAN_HELLO);
  final SessionOutputBuffer outbuffer=new SessionOutputBufferImpl(16,StandardCharsets.ISO_8859_1.newEncoder());
  final ByteArrayOutputStream outputStream=new ByteArrayOutputStream();
  final CharArrayBuffer chbuffer=new CharArrayBuffer(16);
  for (int i=0; i < 10; i++) {
    chbuffer.clear();
    chbuffer.append(s1);
    outbuffer.writeLine(chbuffer,outputStream);
  }
  chbuffer.clear();
  outbuffer.writeLine(chbuffer,outputStream);
  outbuffer.flush(outputStream);
  final long bytesWritten=outbuffer.getMetrics().getBytesTransferred();
  final long expected=((s1.getBytes(StandardCharsets.ISO_8859_1).length + 2)) * 10 + 2;
  Assert.assertEquals(expected,bytesWritten);
  final SessionInputBuffer inbuffer=new SessionInputBufferImpl(16,StandardCharsets.ISO_8859_1.newDecoder());
  final ByteArrayInputStream inputStream=new ByteArrayInputStream(outputStream.toByteArray());
  for (int i=0; i < 10; i++) {
    chbuffer.clear();
    final int len=inbuffer.readLine(chbuffer,inputStream);
    Assert.assertEquals(len,SWISS_GERMAN_HELLO.length);
    Assert.assertEquals(s1,chbuffer.toString());
  }
  chbuffer.clear();
  Assert.assertEquals(0,inbuffer.readLine(chbuffer,inputStream));
  chbuffer.clear();
  Assert.assertEquals(-1,inbuffer.readLine(chbuffer,inputStream));
  chbuffer.clear();
  Assert.assertEquals(-1,inbuffer.readLine(chbuffer,inputStream));
  final long bytesRead=inbuffer.getMetrics().getBytesTransferred();
  Assert.assertEquals(expected,bytesRead);
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
