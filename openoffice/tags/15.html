<h3><span class=" glyphicon glyphicon-tag"/>&nbspPublicFieldVerifier</h3><kbd>Verifies values related to public fields.</kbd><br><br><br><h4 style="margin:0px">Class: complex.dbaccess.QueryInQuery </h4><pre class="type-4 type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values related to public fields.
"></span><br>
@Test public void checkCyclicReferences() throws ElementExistException, WrappedTargetException, IllegalArgumentException {
  m_database.getDatabase().getDataSource().createQuery("orders level 1","SELECT * FROM \"orders level 0\"");
  m_database.getDatabase().getDataSource().createQuery("orders level 2","SELECT * FROM \"orders level 1\"");
  m_database.getDatabase().getDataSource().createQuery("orders level 3","SELECT * FROM \"orders level 2\"");
  m_database.getDatabase().getDataSource().createQuery("orders level 0","SELECT * FROM \"orders level 3\"");
  final RowSet rowSet=m_database.getDatabase().createRowSet(CommandType.QUERY,"orders level 0");
  boolean caughtExpected=false;
  try {
    rowSet.execute();
  }
 catch (  SQLException e) {
    caughtExpected=(e.ErrorCode == -com.sun.star.sdb.ErrorCondition.PARSER_CYCLIC_SUB_QUERIES);
  }
  assertTrue("executing a query with cyclic nested sub queries should fail!",caughtExpected);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: complex.sfx2.DocumentProperties </h4><pre class="type-5 type-12 type-10 type-4 type-3 type-15 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void check(){
  try {
    XMultiServiceFactory xMSF=getMSF();
    assertNotNull("could not create MultiServiceFactory.",xMSF);
    XPropertySet xPropertySet=UnoRuntime.queryInterface(XPropertySet.class,xMSF);
    Object defaultCtx=xPropertySet.getPropertyValue("DefaultContext");
    XComponentContext xContext=UnoRuntime.queryInterface(XComponentContext.class,defaultCtx);
    assertNotNull("could not get component context.",xContext);
    String temp=util.utils.getOfficeTemp(xMSF);
    System.out.println("tempdir: " + temp);
    PropertyValue[] noArgs={};
    PropertyValue mimetype=new PropertyValue();
    mimetype.Name="MediaType";
    mimetype.Value="application/vnd.oasis.opendocument.text";
    PropertyValue[] mimeArgs={mimetype};
    PropertyValue cfile=new PropertyValue();
    cfile.Name="URL";
    cfile.Value=temp + "EMPTY.odt";
    PropertyValue[] mimeEmptyArgs={mimetype,cfile};
    System.out.println("Creating service DocumentProperties...");
    Object oDP=xMSF.createInstance("com.sun.star.document.DocumentProperties");
    XDocumentProperties xDP=UnoRuntime.queryInterface(XDocumentProperties.class,oDP);
    System.out.println("...done");
    System.out.println("Checking initialize ...");
    XDocumentProperties xDP2=UnoRuntime.queryInterface(XDocumentProperties.class,xMSF.createInstance("com.sun.star.document.DocumentProperties"));
    XInitialization xInit=UnoRuntime.queryInterface(XInitialization.class,xDP2);
    xInit.initialize(new Object[]{});
    System.out.println("...done");
    System.out.println("Checking storing default-initialized meta data ...");
    xDP2.storeToMedium("",mimeEmptyArgs);
    System.out.println("...done");
    System.out.println("Checking loading default-initialized meta data ...");
    xDP2.loadFromMedium("",mimeEmptyArgs);
    assertTrue("Author","".equals(xDP2.getAuthor()));
    System.out.println("...done");
    System.out.println("(Not) Checking preservation of custom meta data ...");
    xDP2.loadFromMedium(TestDocument.getUrl("CUSTOM.odt"),noArgs);
    assertTrue("Author","".equals(xDP2.getAuthor()));
    xDP2.storeToMedium(temp + "CUSTOM.odt",mimeArgs);
    System.out.println("...done");
    System.out.println("Checking loading from test document...");
    String file=TestDocument.getUrl("TEST.odt");
    xDP.loadFromMedium(file,noArgs);
    System.out.println("...done");
    System.out.println("Checking meta-data import...");
    assertTrue("Author","Karl-Heinz Mustermann".equals(xDP.getAuthor()));
    assertTrue("Generator","StarOffice/8$Solaris_x86 OpenOffice.org_project/680m232$Build-9227".equals(xDP.getGenerator()));
    assertTrue("CreationDate",2007 == xDP.getCreationDate().Year);
    assertTrue("Title","Urgent Memo".equals(xDP.getTitle()));
    assertTrue("Subject","Wichtige Mitteilung".equals(xDP.getSubject()));
    assertTrue("Description","Modern internal company memorandum in full-blocked style".equals(xDP.getDescription()));
    assertTrue("ModifiedBy","Karl-Heinz Mustermann".equals(xDP.getModifiedBy()));
    assertTrue("ModificationDate",10 == xDP.getModificationDate().Month);
    assertTrue("PrintedBy","Karl-Heinz Mustermann".equals(xDP.getPrintedBy()));
    assertTrue("PrintDate",29 == xDP.getPrintDate().Day);
    assertTrue("TemplateName","Modern Memo".equals(xDP.getTemplateName()));
    assertTrue("TemplateURL",xDP.getTemplateURL().endsWith("memmodern.ott"));
    assertTrue("TemplateDate",17 == xDP.getTemplateDate().Hours);
    assertTrue("AutoloadURL","../TEST.odt".equals(xDP.getAutoloadURL()));
    assertTrue("AutoloadSecs",0 == xDP.getAutoloadSecs());
    assertTrue("DefaultTarget","_blank".equals(xDP.getDefaultTarget()));
    assertTrue("EditingCycles",3 == xDP.getEditingCycles());
    assertTrue("EditingDuration",320 == xDP.getEditingDuration());
    String[] kws=xDP.getKeywords();
    assertTrue("Keywords",fromArray(kws).containsAll(fromArray(new Object[]{"Asien","Memo","Reis"})));
    NamedValue[] ds=xDP.getDocumentStatistics();
    assertTrue("DocumentStatistics:WordCount",containsNV(ds,new NamedValue("WordCount",new Integer(23))));
    assertTrue("DocumentStatistics:PageCount",containsNV(ds,new NamedValue("PageCount",new Integer(1))));
    XPropertyContainer udpc=xDP.getUserDefinedProperties();
    XPropertySet udps=UnoRuntime.queryInterface(XPropertySet.class,udpc);
    assertTrue("UserDefined 1","Dies ist ein wichtiger Hinweis".equals(udps.getPropertyValue("Hinweis")));
    assertTrue("UserDefined 2",("Kann Spuren von N" + new String(new byte[]{(byte)0xc3,(byte)0xbc},"UTF-8") + "ssen enthalten").equals(udps.getPropertyValue("Warnung")));
    System.out.println("...done");
    System.out.println("Checking meta-data updates...");
    String str;
    DateTime dt=new DateTime();
    Locale l=new Locale();
    int i;
    str="me";
    xDP.setAuthor(str);
    assertTrue("setAuthor",str.equals(xDP.getAuthor()));
    str="the computa";
    xDP.setGenerator(str);
    assertTrue("setGenerator",str.equals(xDP.getGenerator()));
    dt.Year=2038;
    dt.Month=1;
    dt.Day=1;
    xDP.setCreationDate(dt);
    assertTrue("setCreationDate",dt.Year == xDP.getCreationDate().Year);
    str="El t'itulo";
    xDP.setTitle(str);
    assertTrue("setTitle",str.equals(xDP.getTitle()));
    str="Ein verkommenes Subjekt";
    xDP.setSubject(str);
    assertTrue("setSubject",str.equals(xDP.getSubject()));
    str="Este descripci'on no es importante";
    xDP.setDescription(str);
    assertTrue("setDescription",str.equals(xDP.getDescription()));
    l.Language="en";
    l.Country="GB";
    xDP.setLanguage(l);
    Locale l2=xDP.getLanguage();
    assertTrue("setLanguage Lang",l.Language.equals(l2.Language));
    assertTrue("setLanguage Cty",l.Country.equals(l2.Country));
    str="myself";
    xDP.setModifiedBy(str);
    assertTrue("setModifiedBy",str.equals(xDP.getModifiedBy()));
    dt.Year=2042;
    xDP.setModificationDate(dt);
    assertTrue("setModificationDate",dt.Year == xDP.getModificationDate().Year);
    str="i didn't do it";
    xDP.setPrintedBy(str);
    assertTrue("setPrintedBy",str.equals(xDP.getPrintedBy()));
    dt.Year=2024;
    xDP.setPrintDate(dt);
    assertTrue("setPrintDate",dt.Year == xDP.getPrintDate().Year);
    str="blah";
    xDP.setTemplateName(str);
    assertTrue("setTemplateName",str.equals(xDP.getTemplateName()));
    str="gopher://some-hole-in-the-ground/";
    xDP.setTemplateURL(str);
    assertTrue("setTemplateURL",str.equals(xDP.getTemplateURL()));
    dt.Year=2043;
    xDP.setTemplateDate(dt);
    assertTrue("setTemplateDate",dt.Year == xDP.getTemplateDate().Year);
    str="http://nowhere/";
    xDP.setAutoloadURL(str);
    assertTrue("setAutoloadURL",str.equals(xDP.getAutoloadURL()));
    i=3661;
    xDP.setAutoloadSecs(i);
    assertTrue("setAutoloadSecs",i == xDP.getAutoloadSecs());
    str="_blank";
    xDP.setDefaultTarget(str);
    assertTrue("setDefaultTarget",str.equals(xDP.getDefaultTarget()));
    i=42;
    xDP.setEditingCycles((short)i);
    assertTrue("setEditingCycles",i == xDP.getEditingCycles());
    i=84;
    xDP.setEditingDuration(i);
    assertTrue("setEditingDuration",i == xDP.getEditingDuration());
    str="";
    String[] kws2=new String[]{"keywordly","keywordlike","keywordalicious"};
    xDP.setKeywords(kws2);
    kws=xDP.getKeywords();
    assertTrue("setKeywords",fromArray(kws).containsAll(fromArray(kws2)));
    NamedValue[] ds2=new NamedValue[]{new NamedValue("SyllableCount",new Integer(9)),new NamedValue("FrameCount",new Integer(2)),new NamedValue("SentenceCount",new Integer(7))};
    xDP.setDocumentStatistics(ds2);
    ds=xDP.getDocumentStatistics();
    assertTrue("setDocumentStatistics:SyllableCount",containsNV(ds,new NamedValue("SyllableCount",new Integer(9))));
    assertTrue("setDocumentStatistics:FrameCount",containsNV(ds,new NamedValue("FrameCount",new Integer(2))));
    assertTrue("setDocumentStatistics:SentenceCount",containsNV(ds,new NamedValue("SentenceCount",new Integer(7))));
    System.out.println("...done");
    System.out.println("Checking user-defined meta-data updates...");
    boolean b=true;
    double d=3.1415;
    Time t=new Time();
    t.Hours=1;
    t.Minutes=16;
    Date date=new Date();
    date.Year=2071;
    date.Month=2;
    date.Day=3;
    dt.Year=2065;
    Duration dur=new Duration();
    dur.Negative=true;
    dur.Years=1001;
    dur.Months=999;
    dur.Days=888;
    dur.Hours=777;
    dur.Minutes=666;
    dur.Seconds=555;
    dur.MilliSeconds=444;
    udpc.addProperty("Frobnicate",PropertyAttribute.REMOVEABLE,b);
    udpc.addProperty("FrobDuration",PropertyAttribute.REMOVEABLE,dur);
    udpc.addProperty("FrobDuration2",PropertyAttribute.REMOVEABLE,t);
    udpc.addProperty("FrobEndDate",PropertyAttribute.REMOVEABLE,date);
    udpc.addProperty("FrobStartTime",PropertyAttribute.REMOVEABLE,dt);
    udpc.addProperty("Pi",PropertyAttribute.REMOVEABLE,new Double(d));
    udpc.addProperty("Foo",PropertyAttribute.REMOVEABLE,"bar");
    udpc.addProperty("Removed",PropertyAttribute.REMOVEABLE,"bar");
    udpc.addProperty("",PropertyAttribute.REMOVEABLE,"eeeeek");
    try {
      udpc.removeProperty("Info 1");
      udpc.removeProperty("Removed");
    }
 catch (    UnknownPropertyException e) {
      fail("removeProperty failed");
    }
    try {
      udpc.addProperty("Forbidden",PropertyAttribute.REMOVEABLE,new String[]{"foo","bar"});
      fail("inserting value of non-supported type did not fail");
    }
 catch (    IllegalTypeException e) {
    }
    assertTrue("UserDefined bool",new Boolean(b).equals(udps.getPropertyValue("Frobnicate")));
    assertTrue("UserDefined duration",eqDuration(dur,(Duration)udps.getPropertyValue("FrobDuration")));
    assertTrue("UserDefined time",eqTime(t,(Time)udps.getPropertyValue("FrobDuration2")));
    assertTrue("UserDefined date",eqDate(date,(Date)udps.getPropertyValue("FrobEndDate")));
    assertTrue("UserDefined datetime",eqDateTime(dt,(DateTime)udps.getPropertyValue("FrobStartTime")));
    assertTrue("UserDefined float",new Double(d).equals(udps.getPropertyValue("Pi")));
    assertTrue("UserDefined string","bar".equals(udps.getPropertyValue("Foo")));
    assertTrue("UserDefined empty name","eeeeek".equals(udps.getPropertyValue("")));
    try {
      udps.getPropertyValue("Removed");
      fail("UserDefined remove didn't");
    }
 catch (    UnknownPropertyException e) {
    }
    System.out.println("...done");
    System.out.println("Checking storing meta-data to file...");
    xDP.storeToMedium(temp + "TEST.odt",mimeArgs);
    System.out.println("...done");
    System.out.println("Checking loading meta-data from stored file...");
    xDP.loadFromMedium(temp + "TEST.odt",noArgs);
    System.out.println("...done");
    System.out.println("Checking user-defined meta-data from stored file...");
    udpc=xDP.getUserDefinedProperties();
    udps=UnoRuntime.queryInterface(XPropertySet.class,udpc);
    assertTrue("UserDefined bool",new Boolean(b).equals(udps.getPropertyValue("Frobnicate")));
    assertTrue("UserDefined duration",eqDuration(dur,(Duration)udps.getPropertyValue("FrobDuration")));
    Duration t_dur=new Duration(false,(short)0,(short)0,(short)0,t.Hours,t.Minutes,t.Seconds,(short)(10 * t.HundredthSeconds));
    assertTrue("UserDefined time",eqDuration(t_dur,(Duration)udps.getPropertyValue("FrobDuration2")));
    assertTrue("UserDefined date",eqDate(date,(Date)udps.getPropertyValue("FrobEndDate")));
    assertTrue("UserDefined datetime",eqDateTime(dt,(DateTime)udps.getPropertyValue("FrobStartTime")));
    assertTrue("UserDefined float",new Double(d).equals(udps.getPropertyValue("Pi")));
    assertTrue("UserDefined string","bar".equals(udps.getPropertyValue("Foo")));
    try {
      udps.getPropertyValue("Removed");
      fail("UserDefined remove didn't");
    }
 catch (    UnknownPropertyException e) {
    }
    System.out.println("...done");
    System.out.println("Checking notification listener interface...");
    Listener listener=new Listener();
    XModifyBroadcaster xMB=UnoRuntime.queryInterface(XModifyBroadcaster.class,xDP);
    xMB.addModifyListener(listener);
    xDP.setAuthor("not me");
    assertTrue("Listener Author",listener.reset());
    udpc.addProperty("Listener",PropertyAttribute.REMOVEABLE,"foo");
    assertTrue("Listener UserDefined Add",listener.reset());
    udps.setPropertyValue("Listener","bar");
    assertTrue("Listener UserDefined Set",listener.reset());
    udpc.removeProperty("Listener");
    assertTrue("Listener UserDefined Remove",listener.reset());
    xMB.removeModifyListener(listener);
    udpc.addProperty("Listener2",PropertyAttribute.REMOVEABLE,"foo");
    assertTrue("Removed Listener UserDefined Add",!listener.reset());
    System.out.println("...done");
  }
 catch (  Exception e) {
    report(e);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: complex.toolkit.GridControl </h4><pre class="type-11 type-5 type-10 type-4 type-1 type-15 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testGridColumnModel() throws Exception {
  impl_recreateGridModel();
  ColumnModelListener listener=new ColumnModelListener();
  m_columnModel.addContainerListener(listener);
  final int defaultColumnsCount=3;
  m_columnModel.setDefaultColumns(defaultColumnsCount);
  impl_assertColumnModelConsistency();
  List<ContainerEvent> events=listener.assertExclusiveInsertionEvents();
  listener.reset();
  assertEquals("wrong number of events fired by setDefaulColumns",defaultColumnsCount,events.size());
  for (int i=0; i < defaultColumnsCount; ++i) {
    final ContainerEvent event=events.get(i);
    final int index=impl_assertInteger(event.Accessor);
    assertEquals("unexpected Accessor value in insert notification",i,index);
    assertTrue("wrong column object notified in insert notification",impl_areSameInterface(event.Element,m_columnModel.getColumn(i)));
  }
  final int moreDefaultColumnsCount=5;
  m_columnModel.setDefaultColumns(moreDefaultColumnsCount);
  impl_assertColumnModelConsistency();
  assertEquals("setting default columns is expected to remove all previously existing columns",moreDefaultColumnsCount,m_columnModel.getColumnCount());
  final List<ContainerEvent> removalEvents=listener.getRemovalEvents();
  final List<ContainerEvent> insertionEvents=listener.getInsertionEvents();
  listener.reset();
  assertEquals("wrong number of columns removed (or notified) upon setting default columns",defaultColumnsCount,removalEvents.size());
  for (int i=0; i < removalEvents.size(); ++i) {
    final ContainerEvent event=removalEvents.get(i);
    final int removedIndex=impl_assertInteger(event.Accessor);
    assertTrue("unexpected column removal event column index",(removedIndex == 0) || (removedIndex == removalEvents.size() - 1 - i));
  }
  assertEquals("wrong number of insertion events when setting default columns over existing columns",moreDefaultColumnsCount,insertionEvents.size());
  for (int i=0; i < insertionEvents.size(); ++i) {
    final ContainerEvent event=insertionEvents.get(i);
    final int index=impl_assertInteger(event.Accessor);
    assertEquals(i,index);
  }
  while (m_columnModel.getColumnCount() != 0) {
    final int columnCount=m_columnModel.getColumnCount();
    final int removeColumnIndex=m_randomGenerator.nextInt(columnCount);
    m_columnModel.removeColumn(removeColumnIndex);
    events=listener.assertExclusiveRemovalEvents();
    listener.reset();
    assertEquals("removing a single column should notify a single event",1,events.size());
    final ContainerEvent event=events.get(0);
    final int removalIndex=impl_assertInteger(event.Accessor);
    assertEquals("removing an arbitrary column does not notify the proper accessor",removeColumnIndex,removalIndex);
  }
  boolean caughtExpected=false;
  try {
    m_columnModel.addColumn(new DummyColumn());
  }
 catch (  final com.sun.star.lang.IllegalArgumentException e) {
    assertTrue(impl_areSameInterface(e.Context,m_columnModel));
    caughtExpected=true;
  }
  assertTrue("adding a dummy (self-implemented) grid column to the model should not succeed",caughtExpected);
  final XGridColumn newColumn=m_columnModel.createColumn();
  m_columnModel.addColumn(newColumn);
  impl_assertColumnModelConsistency();
  events=listener.assertExclusiveInsertionEvents();
  listener.reset();
  assertEquals("addColumn notifies the wrong number of insertion events",1,events.size());
  final int insertionIndex=impl_assertInteger(events.get(0).Accessor);
  assertEquals(insertionIndex,newColumn.getIndex());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: complex.toolkit.UnitConversion </h4><pre class="type-5 type-12 type-10 type-4 type-3 type-15 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * The real test function
 * 1. try to get the XMultiServiceFactory of an already running office. Therefore make sure an (open|star)office is running with
 * parameters like -accept="socket,host=localhost,port=8100;urp;"
 * 2. try to create an empty window
 * 3. try to convert the WindowPeer to an XWindow
 * 4. try to resize and move the window to an other position, so we get a well knowing position and size.
 * 5. run some more tests
 * If no test fails, the test is well done and returns with 'PASSED, OK'
 */
@Test public void testXUnitConversion(){
  final XMultiServiceFactory xMSF=UnoRuntime.queryInterface(XMultiServiceFactory.class,connection.getComponentContext().getServiceManager());
  assertNotNull("failed: There is no office.",xMSF);
  XWindowPeer xWindowPeer=DesktopTools.createFloatingWindow(xMSF);
  assertNotNull("failed: there is no window peer",xWindowPeer);
  XWindow xWindow=UnoRuntime.queryInterface(XWindow.class,xWindowPeer);
  assertNotNull("failed: there is no window, cast wrong?",xWindow);
  xWindow.setVisible(Boolean.TRUE);
  int x=100;
  int y=100;
  int width=640;
  int height=480;
  xWindow.setPosSize(x,y,width,height,com.sun.star.awt.PosSize.POSSIZE);
  com.sun.star.awt.Rectangle aRect=xWindow.getPosSize();
  com.sun.star.awt.Point aPoint=new com.sun.star.awt.Point(aRect.X,aRect.Y);
  com.sun.star.awt.Size aSize=new com.sun.star.awt.Size(aRect.Width,aRect.Height);
  System.out.println("Window position and size in pixel:");
  System.out.println("X:" + aPoint.X);
  System.out.println("Y:" + aPoint.Y);
  System.out.println("Width:" + aSize.Width);
  System.out.println("Height:" + aSize.Height);
  System.out.println("");
  assertTrue("Window pos size wrong",aSize.Width == width && aSize.Height == height && aPoint.X == x && aPoint.Y == y);
  m_xConversion=UnoRuntime.queryInterface(XUnitConversion.class,xWindowPeer);
  try {
    com.sun.star.awt.Point aPointInMM_100TH=m_xConversion.convertPointToLogic(aPoint,com.sun.star.util.MeasureUnit.MM_100TH);
    System.out.println("Window position:");
    System.out.println("X:" + aPointInMM_100TH.X + " 1/100mm");
    System.out.println("Y:" + aPointInMM_100TH.Y + " 1/100mm");
    System.out.println("");
  }
 catch (  com.sun.star.lang.IllegalArgumentException e) {
    fail("failed: IllegalArgumentException caught in convertPointToLogic " + e.getMessage());
  }
  com.sun.star.awt.Size aSizeInMM_100TH=null;
  com.sun.star.awt.Size aSizeInMM_10TH=null;
  try {
    aSizeInMM_100TH=m_xConversion.convertSizeToLogic(aSize,com.sun.star.util.MeasureUnit.MM_100TH);
    System.out.println("Window size:");
    System.out.println("Width:" + aSizeInMM_100TH.Width + " 1/100mm");
    System.out.println("Height:" + aSizeInMM_100TH.Height + " 1/100mm");
    System.out.println("");
    aSizeInMM_10TH=m_xConversion.convertSizeToLogic(aSize,com.sun.star.util.MeasureUnit.MM_10TH);
    System.out.println("Window size:");
    System.out.println("Width:" + aSizeInMM_10TH.Width + " 1/10mm");
    System.out.println("Height:" + aSizeInMM_10TH.Height + " 1/10mm");
    System.out.println("");
    assertTrue("Size.Width  not correct",delta(aSizeInMM_100TH.Width,aSizeInMM_10TH.Width * 10) < 10);
    assertTrue("Size.Height not correct",delta(aSizeInMM_100TH.Height,aSizeInMM_10TH.Height * 10) < 10);
    checkSize(aSize,com.sun.star.util.MeasureUnit.PIXEL,"pixel");
    checkSize(aSize,com.sun.star.util.MeasureUnit.APPFONT,"appfont");
    checkSize(aSize,com.sun.star.util.MeasureUnit.SYSFONT,"sysfont");
    checkSize(aSize,com.sun.star.util.MeasureUnit.MM,"mm");
    checkSize(aSize,com.sun.star.util.MeasureUnit.CM,"cm");
    checkSize(aSize,com.sun.star.util.MeasureUnit.INCH_1000TH,"1/1000inch");
    checkSize(aSize,com.sun.star.util.MeasureUnit.INCH_100TH,"1/100inch");
    checkSize(aSize,com.sun.star.util.MeasureUnit.INCH_10TH,"1/10inch");
    checkSize(aSize,com.sun.star.util.MeasureUnit.INCH,"inch");
    checkSize(aSize,com.sun.star.util.MeasureUnit.POINT,"point");
    checkSize(aSize,com.sun.star.util.MeasureUnit.TWIP,"twip");
  }
 catch (  com.sun.star.lang.IllegalArgumentException e) {
    fail("failed: IllegalArgumentException caught in convertSizeToLogic " + e.getMessage());
  }
  try {
    com.sun.star.awt.Size aNewSize=m_xConversion.convertSizeToPixel(aSizeInMM_100TH,com.sun.star.util.MeasureUnit.MM_100TH);
    System.out.println("Window size:");
    System.out.println("Width:" + aNewSize.Width + " pixel");
    System.out.println("Height:" + aNewSize.Height + " pixel");
    assertTrue("failed: Size from pixel to 1/100mm to pixel",aSize.Width == aNewSize.Width && aSize.Height == aNewSize.Height);
  }
 catch (  com.sun.star.lang.IllegalArgumentException e) {
    fail("failed: IllegalArgumentException caught in convertSizeToPixel " + e.getMessage());
  }
  xWindow.dispose();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: fvt.uno.sc.cell.CellBorder </h4><pre class="type-11 type-1 type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
/** 
 * Check the cell border settings
 * 1. Create a spreadsheet file.
 * 2. Input number, text, formula into many cell.
 * 3. Set cell border properties.
 * 4. Save file as ODF/MSBinary format.
 * 5. Close and reopen file.  -> Check the border setting.
 * @throws Exception
 */
@Test public void testCellBorder() throws Exception {
  String fileName="testCellBorder";
  String[] borderType={"LeftBorder","RightBorder","TopBorder","BottomBorder"};
  int borderNum=borderType.length;
  int cellNum=10;
  XCell[] cells=new XCell[cellNum];
  BorderLine[][] results=new BorderLine[cellNum][borderNum];
  CellInfo cInfo=TestUtil.randCell(10,10);
  XSpreadsheet sheet=SCUtil.getCurrentSheet(scDocument);
  for (int i=0; i < cellNum; i++) {
    cells[i]=sheet.getCellByPosition(cInfo.getCol(),cInfo.getRow() + i);
  }
  cells[0].setValue(borderLine.Color);
  SCUtil.setTextToCell(cells[1],"all border");
  cells[2].setFormula("=2^6");
  cells[3].setValue(-0.1);
  for (int i=0; i < cellNum; i++) {
    for (int j=0; j < borderNum; j++) {
      SCUtil.setCellProperties(cells[i],borderType[j],borderLine);
    }
  }
  SCUtil.saveFileAs(scComponent,fileName,fileType);
  scDocument=SCUtil.reloadFile(unoApp,scDocument,fileName + "." + fileType);
  sheet=SCUtil.getCurrentSheet(scDocument);
  for (int i=0; i < cellNum; i++) {
    cells[i]=sheet.getCellByPosition(cInfo.getCol(),cInfo.getRow() + i);
    for (int j=0; j < borderNum; j++) {
      results[i][j]=(BorderLine)SCUtil.getCellProperties(cells[i],borderType[j]);
    }
  }
  SCUtil.closeFile(scDocument);
  for (int i=0; i < cellNum; i++) {
    for (int j=0; j < borderNum; j++) {
      assertEquals("Incorrect cell border(" + borderType[j] + ") value got in ."+ fileType+ " file.",new BorderLineWithEqualsFunction(expected),new BorderLineWithEqualsFunction(results[i][j]));
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: fvt.uno.sc.cell.CellColor </h4><pre class="type-1 type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
/** 
 * Check the cell background color and font color
 * 1. Create a spreadsheet file.
 * 2. Input number, text, formula into many cell.
 * 3a. Set cell background color.
 * 3b. Set cell font color.
 * 4. Save file as ODF/MSBinary format.
 * 5. Close and reopen file.  -> Check the color setting.
 * @throws Exception
 */
@Test public void testCellColor() throws Exception {
  String fileName="testCellColor";
  int cellNum=inputData.length;
  XCell[] cells=new XCell[cellNum];
  int[] results=new int[cellNum];
  CellInfo cInfo=TestUtil.randCell(256,100);
  XSpreadsheet sheet=SCUtil.getCurrentSheet(scDocument);
  for (int i=0; i < cellNum; i++) {
    cells[i]=sheet.getCellByPosition(cInfo.getCol(),cInfo.getRow() + i);
  }
  cells[0].setValue(inputData[0]);
  SCUtil.setTextToCell(cells[1],inputType);
  cells[2].setFormula("=100*23/5");
  cells[3].setValue(-0.0003424);
  for (int i=0; i < cellNum; i++) {
    SCUtil.setCellProperties(cells[i],inputType,inputData[i]);
  }
  SCUtil.saveFileAs(scComponent,fileName,fileType);
  scDocument=SCUtil.reloadFile(unoApp,scDocument,fileName + "." + fileType);
  sheet=SCUtil.getCurrentSheet(scDocument);
  for (int i=0; i < cellNum; i++) {
    cells[i]=sheet.getCellByPosition(cInfo.getCol(),cInfo.getRow() + i);
    results[i]=((Integer)SCUtil.getCellProperties(cells[i],inputType)).intValue();
  }
  SCUtil.closeFile(scDocument);
  assertArrayEquals("Incorrect cell background color(" + inputType + ") value got in ."+ fileType+ " file.",expected,results);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: fvt.uno.sc.cell.CellFontSize </h4><pre class="type-1 type-15 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
"></span><br>
/** 
 * Check the cell background color and font color
 * 1. Create a spreadsheet file.
 * 2. Input number, text, formula into many cell.
 * 3. Set cell font size
 * 4. Save file as ODF/MSBinary format.
 * 5. Close and reopen file.  -> Check the font size setting.
 * @throws Exception
 */
@Test public void testCellFontSize() throws Exception {
  String fileName="testCellFontSize";
  int cellNum=inputData.length;
  XCell[] cells=new XCell[cellNum];
  double[] results=new double[cellNum];
  CellInfo cInfo=TestUtil.randCell(256,100);
  XSpreadsheet sheet=SCUtil.getCurrentSheet(scDocument);
  for (int i=0; i < cellNum; i++) {
    cells[i]=sheet.getCellByPosition(cInfo.getCol(),cInfo.getRow() + i);
  }
  cells[0].setValue(inputData[0]);
  SCUtil.setTextToCell(cells[1],inputType);
  cells[2].setFormula("=TRUE()");
  cells[3].setValue(-0.000999999);
  for (int i=0; i < cellNum; i++) {
    SCUtil.setCellProperties(cells[i],inputType,inputData[i]);
  }
  SCUtil.saveFileAs(scComponent,fileName,fileType);
  scDocument=SCUtil.reloadFile(unoApp,scDocument,fileName + "." + fileType);
  sheet=SCUtil.getCurrentSheet(scDocument);
  for (int i=0; i < cellNum; i++) {
    cells[i]=sheet.getCellByPosition(cInfo.getCol(),cInfo.getRow() + i);
    results[i]=((Float)SCUtil.getCellProperties(cells[i],inputType)).floatValue();
  }
  SCUtil.closeFile(scDocument);
  assertArrayEquals("Incorrect cell font size(" + inputType + ") value got in ."+ fileType+ " file.",expected,results,0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: fvt.uno.sc.chart.ChartLegend </h4><pre class="type-5 type-10 type-4 type-1 type-15 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Check change the position of legend in chart
 * 1. Create a spreadsheet file.
 * 2. Input number in a cell range.
 * 3. Use the data to create a chart, set the chart type.
 * 4. Change the position of legend in chart.
 * 5. Save file as ODF/MSBinary format.
 * 6. Close and reopen file.  -> Check the legend position.
 * @throws Exception
 */
@Test public void testLegendPosition() throws Exception {
  String fileName="testDisableLegend";
  String chartName="testChart";
  String cellRangeName="A1:D4";
  Boolean result=true;
  int delta=1;
  if (fileType.equalsIgnoreCase("xls")) {
    delta=4;
    chartName="Object 1";
  }
  XSpreadsheet sheet=SCUtil.getCurrentSheet(scDocument);
  SCUtil.setValueToCellRange(sheet,0,0,numberData);
  CellRangeAddress[] cellAddress=new CellRangeAddress[1];
  cellAddress[0]=SCUtil.getChartDataRangeByName(sheet,cellRangeName);
  Rectangle rectangle=new Rectangle(1000,1000,15000,9500);
  XChartDocument xChartDocument=null;
  xChartDocument=SCUtil.createChart(sheet,rectangle,cellAddress,chartName);
  SCUtil.setChartType(xChartDocument,inputType);
  XShape legend=xChartDocument.getLegend();
  Point aPoint=legend.getPosition();
  aPoint=new Point(aPoint.X + offset[0],aPoint.Y + offset[1]);
  legend.setPosition(aPoint);
  SCUtil.saveFileAs(scComponent,fileName,fileType);
  scDocument=SCUtil.reloadFile(unoApp,scDocument,fileName + "." + fileType);
  sheet=SCUtil.getCurrentSheet(scDocument);
  xChartDocument=SCUtil.getChartByName(sheet,chartName);
  result=(Boolean)SCUtil.getProperties(xChartDocument,"HasLegend");
  legend=xChartDocument.getLegend();
  Point resultPoint=legend.getPosition();
  SCUtil.closeFile(scDocument);
  assertTrue("Chart legend has not been enabled in ." + fileType + " file.",result);
  assertEquals("Incorrect chart legend position X got in ." + fileType + " file.",aPoint.X,resultPoint.X,delta);
  assertEquals("Incorrect chart legend position Y got in ." + fileType + " file.",aPoint.Y,resultPoint.Y,delta);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: fvt.uno.sw.frame.CheckFrames </h4><pre class="type-5 type-10 type-4 type-1 type-18 type-15 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values related to public fields.">PublicFieldVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Verifies values related to public fields.
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expected=NoSuchElementException.class) public void testLoadTextFrame() throws Exception {
  document=(XTextDocument)UnoRuntime.queryInterface(XTextDocument.class,app.loadDocument(Testspace.prepareData("uno/sw/CheckFlies.odt")));
  XTextFramesSupplier xTFS=(XTextFramesSupplier)UnoRuntime.queryInterface(XTextFramesSupplier.class,document);
  String[] expectedNames={"Frame1","Frame2"};
  String[] expectedContents={"PageBoundFrame","ParaBoundFrame"};
  XNameAccess xTextFrames=xTFS.getTextFrames();
  assertArrayEquals("Text frame names",expectedNames,xTextFrames.getElementNames());
  assertTrue("Has text frame named Frame1",xTextFrames.hasByName(expectedNames[0]));
  assertFalse("Has nonexisting text frame.",xTextFrames.hasByName("Nonexisting text frame"));
  XIndexAccess xTextFramesIdx=(XIndexAccess)UnoRuntime.queryInterface(XIndexAccess.class,xTextFrames);
  assertEquals("Text frame count",expectedNames.length,xTextFramesIdx.getCount());
  String[] contents=new String[expectedNames.length];
  for (int i=0; i < xTextFramesIdx.getCount(); i++) {
    Object obj=xTextFramesIdx.getByIndex(i);
    XTextFrame frame=(XTextFrame)UnoRuntime.queryInterface(XTextFrame.class,obj);
    contents[i]=frame.getText().getString();
  }
  assertArrayEquals("Text frame contents",expectedContents,contents);
  xTextFrames.getByName("Nonexisting Textframe");
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
