<h3 style="margin:0px">Class: complex.dataPilot.CheckDataPilot (5 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="5"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('5')" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) "><kbd id="tag-5"class="label-info"style="display: inline-block;font-size:7pt" >APIUtilityVerifier&nbsp;(2)</kbd></button>&nbsp;<button id="7"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('7')" data-toggle="tooltip" title="Releases resources used by the test cases"><kbd id="tag-7"class="label-info"style="display: inline-block;font-size:7pt" >TestCleaner&nbsp;(2)</kbd></button>&nbsp;<button id="10"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('10')" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls"><kbd id="tag-10"class="label-info"style="display: inline-block;font-size:7pt" >InternalCallVerifier&nbsp;(2)</kbd></button>&nbsp;<button id="4"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('4')" data-toggle="tooltip" title="Verifies boolean conditions"><kbd id="tag-4"class="label-info"style="display: inline-block;font-size:7pt" >BooleanVerifier&nbsp;(2)</kbd></button>&nbsp;<button id="6"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('6')" data-toggle="tooltip" title="Allocates resources before the execution of the test cases"><kbd id="tag-6"class="label-info"style="display: inline-block;font-size:7pt" >TestInitializer&nbsp;(1)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-5 type-10 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Test the data pilot field object:
 * simply execute the interface tests in a row
 */
@Test public void testDataPilotFieldObject(){
  System.out.println("Starting 'testDataPilotFieldObject'");
  XNamed xNamed=UnoRuntime.queryInterface(XNamed.class,mDataPilotFieldObject);
  _XNamed _xNamed=new _XNamed(xNamed,param);
  assertTrue("_getName failed.",_xNamed._getName());
  assertTrue("_setName failed.",_xNamed._setName());
  XPropertySet xProp=UnoRuntime.queryInterface(XPropertySet.class,mDataPilotFieldObject);
  _XPropertySet _xProp=new _XPropertySet(xProp,param);
  assertTrue("_getPropertySetInfo failed.",_xProp._getPropertySetInfo());
  assertTrue("_addPropertyChangeListener failed.",_xProp._addPropertyChangeListener());
  assertTrue("_addVetoableChangeListener failed.",_xProp._addVetoableChangeListener());
  assertTrue("_setPropertyValue failed.",_xProp._setPropertyValue());
  assertTrue("_getPropertyValue failed.",_xProp._getPropertyValue());
  assertTrue("_removePropertyChangeListener failed.",_xProp._removePropertyChangeListener());
  assertTrue("_removeVetoableChangeListener failed.",_xProp._removeVetoableChangeListener());
}

</code></pre>

<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Releases resources used by the test cases">TestCleaner</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Releases resources used by the test cases
"></span><br>
@After public void after(){
  closeSpreadsheetDocument();
}

</code></pre>

<pre class="type-5 type-10 type-4 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * Test the data pilot table object:
 * simply execute the interface tests in a row
 */
@Test public void testDataPilotTableObject(){
  System.out.println("Starting 'testDataPilotTableObject'");
  XNamed xNamed=UnoRuntime.queryInterface(XNamed.class,mDataPilotTableObject);
  _XNamed _xNamed=new _XNamed(xNamed,param);
  assertTrue("_getName failed.",_xNamed._getName());
  assertTrue("_setName failed.",_xNamed._setName());
  XDataPilotTable xDataPilotTable=UnoRuntime.queryInterface(XDataPilotTable.class,mDataPilotTableObject);
  _XDataPilotTable _xDataPilotTable=new _XDataPilotTable(xDataPilotTable,param);
  assertTrue("before failed.",_xDataPilotTable.before());
  assertTrue("_getOutputRange failed.",_xDataPilotTable._getOutputRange());
  XDataPilotDescriptor xDataPilotDescriptor=UnoRuntime.queryInterface(XDataPilotDescriptor.class,mDataPilotTableObject);
  _XDataPilotDescriptor _xDataPilotDescriptor=new _XDataPilotDescriptor(xDataPilotDescriptor,param);
  assertTrue("before failed.",_xDataPilotDescriptor.before());
  assertTrue("_setTag failed.",_xDataPilotDescriptor._setTag());
  assertTrue("_getTag failed.",_xDataPilotDescriptor._getTag());
  assertTrue("_getFilterDescriptor failed.",_xDataPilotDescriptor._getFilterDescriptor());
  assertTrue("_getDataPilotFields failed.",_xDataPilotDescriptor._getDataPilotFields());
  assertTrue("_getColumnFields failed.",_xDataPilotDescriptor._getColumnFields());
  assertTrue("_getRowFields failed.",_xDataPilotDescriptor._getRowFields());
  assertTrue("_getDataFields failed.",_xDataPilotDescriptor._getDataFields());
  assertTrue("_getHiddenFields failed.",_xDataPilotDescriptor._getHiddenFields());
  assertTrue("_getPageFields failed.",_xDataPilotDescriptor._getPageFields());
  assertTrue("_setSourceRange failed.",_xDataPilotDescriptor._setSourceRange());
  assertTrue("_getSourceRange failed.",_xDataPilotDescriptor._getSourceRange());
}

</code></pre>

<pre class="type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Allocates resources before the execution of the test cases">TestInitializer</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Allocates resources before the execution of the test cases
"></span><br>
/** 
 * create an environment for the test
 */
@Before public void before(){
  final XMultiServiceFactory xMsf=UnoRuntime.queryInterface(XMultiServiceFactory.class,connection.getComponentContext().getServiceManager());
  SOfficeFactory SOF=SOfficeFactory.getFactory(xMsf);
  param=new TestParameters();
  param.put("ServiceFactory",xMsf);
  CellRangeAddress sCellRangeAdress=new CellRangeAddress();
  sCellRangeAdress.Sheet=0;
  sCellRangeAdress.StartColumn=1;
  sCellRangeAdress.StartRow=0;
  sCellRangeAdress.EndColumn=mMaxFieldIndex - 1;
  sCellRangeAdress.EndRow=mMaxFieldIndex - 1;
  CellAddress sCellAdress=new CellAddress();
  sCellAdress.Sheet=0;
  sCellAdress.Column=7;
  sCellAdress.Row=8;
  try {
    System.out.println("Creating a Spreadsheet document");
    xSheetDoc=SOF.createCalcDoc(null);
  }
 catch (  com.sun.star.uno.Exception e) {
    e.printStackTrace();
    throw new StatusException("Couldn't create document",e);
  }
  System.out.println("Getting a sheet");
  XSpreadsheets xSpreadsheets=xSheetDoc.getSheets();
  XSpreadsheet oSheet=null;
  XSpreadsheet oSheet2=null;
  XIndexAccess oIndexAccess=UnoRuntime.queryInterface(XIndexAccess.class,xSpreadsheets);
  try {
    oSheet=(XSpreadsheet)AnyConverter.toObject(new Type(XSpreadsheet.class),oIndexAccess.getByIndex(0));
    oSheet2=(XSpreadsheet)AnyConverter.toObject(new Type(XSpreadsheet.class),oIndexAccess.getByIndex(1));
  }
 catch (  com.sun.star.lang.WrappedTargetException e) {
    e.printStackTrace();
    throw new StatusException("Couldn't get a spreadsheet",e);
  }
catch (  com.sun.star.lang.IndexOutOfBoundsException e) {
    e.printStackTrace();
    throw new StatusException("Couldn't get a spreadsheet",e);
  }
catch (  com.sun.star.lang.IllegalArgumentException e) {
    e.printStackTrace();
    throw new StatusException("Couldn't get a spreadsheet",e);
  }
  try {
    System.out.println("Filling a table");
    for (int i=1; i < mMaxFieldIndex; i++) {
      oSheet.getCellByPosition(i,0).setFormula("Col" + i);
      oSheet.getCellByPosition(0,i).setFormula("Row" + i);
      oSheet2.getCellByPosition(i,0).setFormula("Col" + i);
      oSheet2.getCellByPosition(0,i).setFormula("Row" + i);
    }
    for (int i=1; i < mMaxFieldIndex; i++) {
      for (int j=1; j < mMaxFieldIndex; j++) {
        oSheet.getCellByPosition(i,j).setValue(i * (j + 1));
        oSheet2.getCellByPosition(i,j).setValue(i * (j + 2));
      }
    }
  }
 catch (  com.sun.star.lang.IndexOutOfBoundsException e) {
    e.printStackTrace();
    throw new StatusException("Couldn't fill some cells",e);
  }
  Object oChangeCell=null;
  Object oCheckCell=null;
  Integer aChangeValue=null;
  try {
    oChangeCell=oSheet.getCellByPosition(1,5);
    int x=sCellAdress.Column;
    int y=sCellAdress.Row + 3;
    oCheckCell=oSheet.getCellByPosition(x,y);
    aChangeValue=new Integer(27);
  }
 catch (  com.sun.star.lang.IndexOutOfBoundsException e) {
    e.printStackTrace();
    throw new StatusException("Couldn't get cells for changeing.",e);
  }
  System.out.println("Getting test objects");
  XDataPilotTablesSupplier DPTS=UnoRuntime.queryInterface(XDataPilotTablesSupplier.class,oSheet);
  XDataPilotTables DPT=DPTS.getDataPilotTables();
  XDataPilotDescriptor DPDsc=DPT.createDataPilotDescriptor();
  DPDsc.setSourceRange(sCellRangeAdress);
  XPropertySet fieldPropSet=null;
  try {
    Object oDataPilotField=DPDsc.getDataPilotFields().getByIndex(0);
    fieldPropSet=UnoRuntime.queryInterface(XPropertySet.class,oDataPilotField);
  }
 catch (  com.sun.star.lang.WrappedTargetException e) {
    e.printStackTrace();
    throw new StatusException("Couldn't create a test environment",e);
  }
catch (  com.sun.star.lang.IndexOutOfBoundsException e) {
    e.printStackTrace();
    throw new StatusException("Couldn't create a test environment",e);
  }
  try {
    fieldPropSet.setPropertyValue("Function",com.sun.star.sheet.GeneralFunction.SUM);
    fieldPropSet.setPropertyValue("Orientation",com.sun.star.sheet.DataPilotFieldOrientation.DATA);
  }
 catch (  com.sun.star.lang.WrappedTargetException e) {
    e.printStackTrace();
    throw new StatusException("Couldn't create a test environment",e);
  }
catch (  com.sun.star.lang.IllegalArgumentException e) {
    e.printStackTrace();
    throw new StatusException("Couldn't create a test environment",e);
  }
catch (  com.sun.star.beans.PropertyVetoException e) {
    e.printStackTrace();
    throw new StatusException("Couldn't create a test environment",e);
  }
catch (  com.sun.star.beans.UnknownPropertyException e) {
    e.printStackTrace();
    throw new StatusException("Couldn't create a test environment",e);
  }
  System.out.println("Insert the DataPilotTable");
  if (DPT.hasByName("DataPilotTable")) {
    DPT.removeByName("DataPilotTable");
  }
  DPT.insertNewByName("DataPilotTable",sCellAdress,DPDsc);
  try {
    mDataPilotTableObject=(XInterface)AnyConverter.toObject(new Type(XInterface.class),DPT.getByName(DPT.getElementNames()[0]));
  }
 catch (  com.sun.star.lang.WrappedTargetException e) {
    e.printStackTrace();
    throw new StatusException("Couldn't create a test environment",e);
  }
catch (  com.sun.star.container.NoSuchElementException e) {
    e.printStackTrace();
    throw new StatusException("Couldn't create a test environment",e);
  }
catch (  com.sun.star.lang.IllegalArgumentException e) {
    e.printStackTrace();
    throw new StatusException("Couldn't create a test environment",e);
  }
  XIndexAccess IA=DPDsc.getDataPilotFields();
  try {
    mDataPilotFieldObject=(XInterface)AnyConverter.toObject(new Type(XInterface.class),IA.getByIndex(0));
  }
 catch (  com.sun.star.lang.WrappedTargetException e) {
    e.printStackTrace();
    throw new StatusException("Couldn't get data pilot field",e);
  }
catch (  com.sun.star.lang.IndexOutOfBoundsException e) {
    e.printStackTrace();
    throw new StatusException("Couldn't get data pilot field",e);
  }
catch (  com.sun.star.lang.IllegalArgumentException e) {
    e.printStackTrace();
    throw new StatusException("Couldn't get data pilot field",e);
  }
  param.put("OUTPUTRANGE",sCellAdress);
  param.put("CELLFORCHANGE",oChangeCell);
  param.put("CELLFORCHECK",oCheckCell);
  param.put("CHANGEVALUE",aChangeValue);
  param.put("FIELDSAMOUNT",new Integer(5));
}

</code></pre>

<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Releases resources used by the test cases">TestCleaner</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Releases resources used by the test cases
"></span><br>
@AfterClass public static void tearDownConnection() throws InterruptedException, com.sun.star.uno.Exception {
  System.out.println("tearDownConnection()");
  connection.tearDown();
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
