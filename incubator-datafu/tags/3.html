<h3><span class=" glyphicon glyphicon-tag"/>&nbspEqualityVerifier</h3><kbd>Verifies whether objects/variable are equal to an expected value </kbd><br><br><br><h4 style="margin:0px">Class: datafu.hourglass.demo.Examples </h4><pre class="type-2 type-3 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void estimateNumMembers() throws IOException, InterruptedException, ClassNotFoundException {
  openDayForEvent(2013,3,1);
  for (int i=1; i <= 10000; i++) {
    storeIds(i);
  }
  closeDayForEvent();
  for (int i=2; i <= 30; i++) {
    openDayForEvent(2013,3,i);
    storeIds(1,2,3,4,5);
    closeDayForEvent();
  }
  new EstimateCardinality().run(createJobConf(),getDataPath() + "/data/event",getDataPath() + "/output/daily",getDataPath() + "/output/summary",30);
  checkIntermediateFolderCount(new Path(getDataPath(),"output/daily"),30);
  checkOutputFolderCount(new Path(getDataPath(),"output/summary"),1);
  Assert.assertTrue(Math.abs(10000L - loadMemberCount(new Path(getDataPath(),"output/summary"),"20130330").longValue()) / 10000.0 < 0.005);
  openDayForEvent(2013,3,31);
  storeIds(6,7,8,9,10);
  closeDayForEvent();
  new EstimateCardinality().run(createJobConf(),getDataPath() + "/data/event",getDataPath() + "/output/daily",getDataPath() + "/output/summary",30);
  checkIntermediateFolderCount(new Path(getDataPath(),"output/daily"),31);
  checkOutputFolderCount(new Path(getDataPath(),"output/summary"),1);
  Assert.assertEquals(loadMemberCount(new Path(getDataPath(),"output/summary"),"20130331").longValue(),10L);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: datafu.hourglass.test.PartitionCollapsingTests </h4><pre class="type-8 type-7 type-6 type-3 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void severalRunsFixedWindowReuseOutput() throws IOException, InterruptedException, ClassNotFoundException {
  HashMap<Long,Long> counts;
  _reusePreviousOutput=true;
  _numDays=10;
  for (int day=1; day <= 10; day++) {
    openDay(2013,3,day);
    storeCount(day,1);
    closeDay();
  }
{
    PartitionCollapsingIncrementalCountJob job=runJob();
    List<Report> reports=job.getReports();
    Assert.assertEquals(1,reports.size());
    Report report=reports.get(0);
    Assert.assertEquals(report.getInputFiles().size(),10);
    Assert.assertNull(report.getReusedOutput());
    Assert.assertNotNull(report.getOutputPath());
    Assert.assertEquals(report.getOldInputFiles().size(),0);
  }
  counts=loadOutputCounts("20130310");
  checkSize(counts,10);
  for (int day=1; day <= 10; day++) {
    checkIdCount(counts,day,1);
  }
  for (int day=11; day <= 13; day++) {
    openDay(2013,3,day);
    storeCount(day,1);
    closeDay();
  }
{
    PartitionCollapsingIncrementalCountJob job=runJob();
    List<Report> reports=job.getReports();
    Assert.assertEquals(1,reports.size());
    Report report=reports.get(0);
    Assert.assertEquals(report.getInputFiles().size(),3);
    Assert.assertNotNull(report.getReusedOutput());
    Assert.assertNotNull(report.getOutputPath());
    Assert.assertEquals(report.getOldInputFiles().size(),3);
  }
  counts=loadOutputCounts("20130313");
  checkSize(counts,10);
  for (int day=4; day <= 13; day++) {
    checkIdCount(counts,day,1);
  }
  for (int day=14; day <= 15; day++) {
    openDay(2013,3,day);
    storeCount(day,1);
    closeDay();
  }
{
    PartitionCollapsingIncrementalCountJob job=runJob();
    List<Report> reports=job.getReports();
    Assert.assertEquals(1,reports.size());
    Report report=reports.get(0);
    Assert.assertEquals(report.getInputFiles().size(),2);
    Assert.assertNotNull(report.getReusedOutput());
    Assert.assertNotNull(report.getOutputPath());
    Assert.assertEquals(report.getOldInputFiles().size(),2);
  }
  counts=loadOutputCounts("20130315");
  checkSize(counts,10);
  for (int day=6; day <= 15; day++) {
    checkIdCount(counts,day,1);
  }
}

</code></pre>

<br>
<pre class="type-8 type-7 type-6 type-3 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void startAndEndDate() throws IOException, InterruptedException, ClassNotFoundException {
  openDayForEvent(2013,3,11);
  storeIds(1,1,1,1,1,1,1,1,1,1);
  storeIds(2,2,2,2,2,2,2,2,2,2,2,2);
  storeIds(3,3,3,3,3,3,3,3,3,3,3,3,3,3);
  closeDayForEvent();
  openDayForEvent(2013,3,12);
  storeIds(1,1,1,1,1,1,1,1,1,1);
  storeIds(2,2,2,2,2,2,2,2,2,2,2,2);
  storeIds(3,3,3,3,3,3,3,3,3,3,3,3,3,3);
  closeDayForEvent();
  openDayForEvent(2013,3,13);
  storeIds(1,1);
  storeIds(2,2,2,2);
  storeIds(3);
  closeDayForEvent();
  openDayForEvent(2013,3,14);
  storeIds(1);
  storeIds(2,2);
  storeIds(3,3,3);
  closeDayForEvent();
  openDayForEvent(2013,3,15);
  storeIds(1,1,1,1,1,1,1,1,1,1);
  storeIds(2,2,2,2,2,2,2,2,2,2,2,2);
  storeIds(3,3,3,3,3,3,3,3,3,3,3,3,3,3);
  closeDayForEvent();
  openDayForEvent(2013,3,16);
  storeIds(1,1,1,1,1,1,1,1,1,1);
  storeIds(2,2,2,2,2,2,2,2,2,2,2,2);
  storeIds(3,3,3,3,3,3,3,3,3,3,3,3,3,3);
  closeDayForEvent();
  _startDate="20130313";
  _endDate="20130314";
{
    PartitionCollapsingIncrementalCountJob job=runJob();
    List<Report> reports=job.getReports();
    Assert.assertEquals(1,reports.size());
    Report report=reports.get(0);
    Assert.assertEquals(report.getInputFiles().size(),2);
    Assert.assertNull(report.getReusedOutput());
    Assert.assertNotNull(report.getOutputPath());
    Assert.assertEquals(report.getOldInputFiles().size(),0);
  }
  checkOutputFolderCount(1);
  HashMap<Long,Long> counts=loadOutputCounts("20130314");
  checkSize(counts,3);
  checkIdCount(counts,1,3);
  checkIdCount(counts,2,6);
  checkIdCount(counts,3,4);
}

</code></pre>

<br>
<pre class="type-8 type-7 type-6 type-3 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void singleDay() throws IOException, InterruptedException, ClassNotFoundException {
  openDayForEvent(2013,3,15);
  storeIds(1,1,1);
  storeIds(2,2,2,2);
  storeIds(3,3,3,3,3,3,3);
  closeDayForEvent();
{
    PartitionCollapsingIncrementalCountJob job=runJob();
    List<Report> reports=job.getReports();
    Assert.assertEquals(1,reports.size());
    Report report=reports.get(0);
    Assert.assertEquals(report.getInputFiles().size(),1);
    Assert.assertNull(report.getReusedOutput());
    Assert.assertNotNull(report.getOutputPath());
    Assert.assertEquals(report.getOldInputFiles().size(),0);
  }
  checkOutputFolderCount(1);
  HashMap<Long,Long> counts=loadOutputCounts("20130315");
  checkSize(counts,3);
  checkIdCount(counts,1,3);
  checkIdCount(counts,2,4);
  checkIdCount(counts,3,7);
}

</code></pre>

<br>
<pre class="type-8 type-7 type-6 type-3 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void multipleIterations() throws IOException, InterruptedException, ClassNotFoundException {
  _maxIterations=3;
  _maxDaysToProcess=1;
  _reusePreviousOutput=true;
  openDayForEvent(2013,3,15);
  storeIds(1,1,1);
  storeIds(2,2,2,2);
  storeIds(3,3,3,3,3,3,3);
  closeDayForEvent();
  openDayForEvent(2013,3,16);
  storeIds(1,1,1,1);
  storeIds(2,2);
  storeIds(3,3,3,3,3,3);
  closeDayForEvent();
  openDayForEvent(2013,3,17);
  storeIds(1,1,1,1,1,1);
  storeIds(2,2,2,2,2,2,2,2);
  storeIds(3,3);
  closeDayForEvent();
{
    PartitionCollapsingIncrementalCountJob job=runJob();
    List<Report> reports=job.getReports();
    Assert.assertEquals(3,reports.size());
    Report report=reports.get(0);
    Assert.assertEquals(report.getInputFiles().size(),1);
    Assert.assertNull(report.getReusedOutput());
    Assert.assertNotNull(report.getOutputPath());
    Assert.assertEquals(report.getOldInputFiles().size(),0);
    report=reports.get(1);
    Assert.assertEquals(report.getInputFiles().size(),1);
    Assert.assertNotNull(report.getReusedOutput());
    Assert.assertNotNull(report.getOutputPath());
    Assert.assertEquals(report.getOldInputFiles().size(),0);
    report=reports.get(2);
    Assert.assertEquals(report.getInputFiles().size(),1);
    Assert.assertNotNull(report.getReusedOutput());
    Assert.assertNotNull(report.getOutputPath());
    Assert.assertEquals(report.getOldInputFiles().size(),0);
  }
  checkOutputFolderCount(3);
  HashMap<Long,Long> counts=loadOutputCounts("20130315");
  checkSize(counts,3);
  checkIdCount(counts,1,3);
  checkIdCount(counts,2,4);
  checkIdCount(counts,3,7);
  counts=loadOutputCounts("20130316");
  checkSize(counts,3);
  checkIdCount(counts,1,7);
  checkIdCount(counts,2,6);
  checkIdCount(counts,3,13);
  counts=loadOutputCounts("20130317");
  checkSize(counts,3);
  checkIdCount(counts,1,13);
  checkIdCount(counts,2,14);
  checkIdCount(counts,3,15);
}

</code></pre>

<br>
<pre class="type-8 type-7 type-6 type-3 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void endDate() throws IOException, InterruptedException, ClassNotFoundException {
  openDayForEvent(2013,3,15);
  storeIds(1,1);
  storeIds(2,2,2,2);
  storeIds(3);
  closeDayForEvent();
  openDayForEvent(2013,3,16);
  storeIds(1);
  storeIds(2,2);
  storeIds(3,3,3,3,3);
  closeDayForEvent();
  openDayForEvent(2013,3,17);
  storeIds(1,1,1,1,1,1,1,1,1,1);
  storeIds(2,2,2,2,2,2,2,2,2,2,2,2);
  storeIds(3,3,3,3,3,3,3,3,3,3,3,3,3,3);
  closeDayForEvent();
  openDayForEvent(2013,3,18);
  storeIds(1,1,1,1,1,1,1,1,1,1);
  storeIds(2,2,2,2,2,2,2,2,2,2,2,2);
  storeIds(3,3,3,3,3,3,3,3,3,3,3,3,3,3);
  closeDayForEvent();
  _endDate="20130316";
{
    PartitionCollapsingIncrementalCountJob job=runJob();
    List<Report> reports=job.getReports();
    Assert.assertEquals(1,reports.size());
    Report report=reports.get(0);
    Assert.assertEquals(report.getInputFiles().size(),2);
    Assert.assertNull(report.getReusedOutput());
    Assert.assertNotNull(report.getOutputPath());
    Assert.assertEquals(report.getOldInputFiles().size(),0);
  }
  checkOutputFolderCount(1);
  HashMap<Long,Long> counts=loadOutputCounts("20130316");
  checkSize(counts,3);
  checkIdCount(counts,1,3);
  checkIdCount(counts,2,6);
  checkIdCount(counts,3,6);
}

</code></pre>

<br>
<pre class="type-8 type-7 type-6 type-3 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void multipleDays() throws IOException, InterruptedException, ClassNotFoundException {
  openDayForEvent(2013,3,15);
  storeIds(1,1,1);
  storeIds(2,2,2,2);
  storeIds(3,3,3,3,3,3,3);
  closeDayForEvent();
  openDayForEvent(2013,3,16);
  storeIds(1,1,1,1);
  storeIds(2,2);
  storeIds(3,3,3,3,3,3);
  closeDayForEvent();
  openDayForEvent(2013,3,17);
  storeIds(1,1,1,1,1,1);
  storeIds(2,2,2,2,2,2,2,2);
  storeIds(3,3);
  closeDayForEvent();
{
    PartitionCollapsingIncrementalCountJob job=runJob();
    List<Report> reports=job.getReports();
    Assert.assertEquals(1,reports.size());
    Report report=reports.get(0);
    Assert.assertEquals(report.getInputFiles().size(),3);
    Assert.assertNull(report.getReusedOutput());
    Assert.assertNotNull(report.getOutputPath());
    Assert.assertEquals(report.getOldInputFiles().size(),0);
  }
  checkOutputFolderCount(1);
  HashMap<Long,Long> counts=loadOutputCounts("20130317");
  checkSize(counts,3);
  checkIdCount(counts,1,13);
  checkIdCount(counts,2,14);
  checkIdCount(counts,3,15);
}

</code></pre>

<br>
<pre class="type-8 type-7 type-6 type-3 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void multipleRunsFixedWindowNoReuse() throws IOException, InterruptedException, ClassNotFoundException {
  _numDays=3;
  openDay(2013,3,15);
  storeCount(1,15);
  storeCount(2,25);
  storeCount(3,7);
  storeCount(10,3);
  closeDay();
  openDay(2013,3,16);
  storeCount(1,4);
  storeCount(2,9);
  storeCount(3,12);
  storeCount(4,3);
  closeDay();
  openDay(2013,3,17);
  storeCount(3,5);
  storeCount(5,13);
  closeDay();
{
    PartitionCollapsingIncrementalCountJob job=runJob();
    List<Report> reports=job.getReports();
    Assert.assertEquals(1,reports.size());
    Report report=reports.get(0);
    Assert.assertEquals(report.getInputFiles().size(),3);
    Assert.assertNull(report.getReusedOutput());
    Assert.assertNotNull(report.getOutputPath());
    Assert.assertEquals(report.getOldInputFiles().size(),0);
  }
  checkOutputFolderCount(1);
  HashMap<Long,Long> counts=loadOutputCounts("20130317");
  checkSize(counts,6);
  checkIdCount(counts,1,19);
  checkIdCount(counts,2,34);
  checkIdCount(counts,3,24);
  checkIdCount(counts,4,3);
  checkIdCount(counts,5,13);
  checkIdCount(counts,10,3);
  openDay(2013,3,18);
  storeCount(3,9);
  storeCount(5,24);
  storeCount(6,7);
  closeDay();
{
    PartitionCollapsingIncrementalCountJob job=runJob();
    List<Report> reports=job.getReports();
    Assert.assertEquals(1,reports.size());
    Report report=reports.get(0);
    Assert.assertEquals(report.getInputFiles().size(),3);
    Assert.assertNull(report.getReusedOutput());
    Assert.assertNotNull(report.getOutputPath());
    Assert.assertEquals(report.getOldInputFiles().size(),0);
  }
  checkOutputFolderCount(2);
  counts=loadOutputCounts("20130318");
  checkSize(counts,6);
  checkIdCount(counts,1,4);
  checkIdCount(counts,2,9);
  checkIdCount(counts,3,26);
  checkIdCount(counts,4,3);
  checkIdCount(counts,5,37);
  checkIdCount(counts,6,7);
}

</code></pre>

<br>
<pre class="type-8 type-7 type-6 type-3 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void multipleRunsFixedStartReuseOutput() throws IOException, InterruptedException, ClassNotFoundException {
  _reusePreviousOutput=true;
  openDayForEvent(2013,3,15);
  storeIds(1,1,1);
  storeIds(2,2,2,2);
  storeIds(3,3,3,3,3,3,3);
  closeDayForEvent();
  openDayForEvent(2013,3,16);
  storeIds(1,1,1,1);
  storeIds(2,2);
  storeIds(3,3,3,3,3,3);
  closeDayForEvent();
  openDayForEvent(2013,3,17);
  storeIds(1,1,1,1,1,1);
  storeIds(2,2,2,2,2,2,2,2);
  storeIds(3,3);
  closeDayForEvent();
{
    PartitionCollapsingIncrementalCountJob job=runJob();
    List<Report> reports=job.getReports();
    Assert.assertEquals(1,reports.size());
    Report report=reports.get(0);
    Assert.assertEquals(report.getInputFiles().size(),3);
    Assert.assertNull(report.getReusedOutput());
    Assert.assertNotNull(report.getOutputPath());
    Assert.assertEquals(report.getOldInputFiles().size(),0);
  }
  checkOutputFolderCount(1);
  HashMap<Long,Long> counts=loadOutputCounts("20130317");
  checkSize(counts,3);
  checkIdCount(counts,1,13);
  checkIdCount(counts,2,14);
  checkIdCount(counts,3,15);
  openDayForEvent(2013,3,18);
  storeIds(1,1);
  storeIds(2,2,2,2,2);
  storeIds(3,3,3,3);
  storeIds(4,4,4);
  storeIds(5,5);
  closeDayForEvent();
  openDayForEvent(2013,3,19);
  storeIds(1,1,1,1,1,1);
  storeIds(2,2,2,2,2,2,2,2);
  storeIds(3,3);
  storeIds(4,4,4,4,4);
  closeDayForEvent();
{
    PartitionCollapsingIncrementalCountJob job=runJob();
    List<Report> reports=job.getReports();
    Assert.assertEquals(1,reports.size());
    Report report=reports.get(0);
    Assert.assertEquals(report.getInputFiles().size(),2);
    Assert.assertNotNull(report.getReusedOutput());
    Assert.assertNotNull(report.getOutputPath());
    Assert.assertEquals(report.getOldInputFiles().size(),0);
  }
  checkOutputFolderCount(2);
  checkOutputExists("20130317");
  counts=loadOutputCounts("20130319");
  checkSize(counts,5);
  checkIdCount(counts,1,21);
  checkIdCount(counts,2,27);
  checkIdCount(counts,3,21);
  checkIdCount(counts,4,8);
  checkIdCount(counts,5,2);
}

</code></pre>

<br>
<pre class="type-8 type-7 type-6 type-3 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void twoRunsFixedWindowReuseOutput() throws IOException, InterruptedException, ClassNotFoundException {
  _reusePreviousOutput=true;
  _numDays=6;
  openDay(2013,3,14);
  storeCount(1,5);
  storeCount(2,17);
  storeCount(3,9);
  storeCount(99,9);
  closeDay();
  openDay(2013,3,15);
  storeCount(1,15);
  storeCount(2,25);
  storeCount(3,7);
  storeCount(100,1);
  storeCount(101,1);
  storeCount(102,10);
  closeDay();
  openDay(2013,3,16);
  storeCount(1,4);
  storeCount(2,9);
  storeCount(3,12);
  storeCount(4,3);
  closeDay();
  openDay(2013,3,17);
  storeCount(3,5);
  storeCount(5,13);
  closeDay();
  openDay(2013,3,18);
  storeCount(3,9);
  storeCount(5,24);
  storeCount(6,7);
  closeDay();
  openDay(2013,3,19);
  storeCount(3,9);
  storeCount(5,24);
  storeCount(6,1);
  storeCount(7,4);
  closeDay();
  openDay(2013,3,20);
  storeCount(1,1);
  storeCount(3,10);
  storeCount(5,1);
  storeCount(6,7);
  storeCount(8,9);
  closeDay();
{
    PartitionCollapsingIncrementalCountJob job=runJob();
    List<Report> reports=job.getReports();
    Assert.assertEquals(1,reports.size());
    Report report=reports.get(0);
    Assert.assertEquals(report.getInputFiles().size(),6);
    Assert.assertNull(report.getReusedOutput());
    Assert.assertNotNull(report.getOutputPath());
    Assert.assertEquals(report.getOldInputFiles().size(),0);
  }
  checkOutputFolderCount(1);
  HashMap<Long,Long> counts=loadOutputCounts("20130320");
  checkSize(counts,11);
  checkIdCount(counts,1,20);
  checkIdCount(counts,2,34);
  checkIdCount(counts,3,52);
  checkIdCount(counts,4,3);
  checkIdCount(counts,5,62);
  checkIdCount(counts,6,15);
  checkIdCount(counts,7,4);
  checkIdCount(counts,8,9);
  checkIdCount(counts,100,1);
  checkIdCount(counts,101,1);
  checkIdCount(counts,102,10);
  openDay(2013,3,21);
  storeCount(1,9);
  storeCount(3,15);
  storeCount(6,9);
  storeCount(8,20);
  storeCount(9,20);
  storeCount(100,1);
  storeCount(102,5);
  closeDay();
{
    PartitionCollapsingIncrementalCountJob job=runJob();
    List<Report> reports=job.getReports();
    Assert.assertEquals(1,reports.size());
    Report report=reports.get(0);
    Assert.assertEquals(report.getInputFiles().size(),1);
    Assert.assertNotNull(report.getReusedOutput());
    Assert.assertNotNull(report.getOutputPath());
    Assert.assertEquals(report.getOldInputFiles().size(),1);
  }
  checkOutputFolderCount(2);
  counts=loadOutputCounts("20130321");
  checkSize(counts,11);
  checkIdCount(counts,1,14);
  checkIdCount(counts,2,9);
  checkIdCount(counts,3,60);
  checkIdCount(counts,4,3);
  checkIdCount(counts,5,62);
  checkIdCount(counts,6,24);
  checkIdCount(counts,7,4);
  checkIdCount(counts,8,29);
  checkIdCount(counts,9,20);
  checkIdCount(counts,100,1);
  checkIdCount(counts,102,5);
}

</code></pre>

<br>
<pre class="type-8 type-7 type-6 type-3 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void startDate() throws IOException, InterruptedException, ClassNotFoundException {
  openDayForEvent(2013,3,15);
  storeIds(1,1,1,1,1,1,1,1,1,1);
  storeIds(2,2,2,2,2,2,2,2,2,2,2,2);
  storeIds(3,3,3,3,3,3,3,3,3,3,3,3,3,3);
  closeDayForEvent();
  openDayForEvent(2013,3,16);
  storeIds(1,1,1,1,1,1,1,1,1,1);
  storeIds(2,2,2,2,2,2,2,2,2,2,2,2);
  storeIds(3,3,3,3,3,3,3,3,3,3,3,3,3,3);
  closeDayForEvent();
  openDayForEvent(2013,3,17);
  storeIds(1,1);
  storeIds(2,2,2,2);
  storeIds(3);
  closeDayForEvent();
  openDayForEvent(2013,3,18);
  storeIds(1);
  storeIds(2,2);
  storeIds(3,3,3,3,3);
  closeDayForEvent();
  _startDate="20130317";
{
    PartitionCollapsingIncrementalCountJob job=runJob();
    List<Report> reports=job.getReports();
    Assert.assertEquals(1,reports.size());
    Report report=reports.get(0);
    Assert.assertEquals(report.getInputFiles().size(),2);
    Assert.assertNull(report.getReusedOutput());
    Assert.assertNotNull(report.getOutputPath());
    Assert.assertEquals(report.getOldInputFiles().size(),0);
  }
  checkOutputFolderCount(1);
  HashMap<Long,Long> counts=loadOutputCounts("20130318");
  checkSize(counts,3);
  checkIdCount(counts,1,3);
  checkIdCount(counts,2,6);
  checkIdCount(counts,3,6);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: datafu.hourglass.test.PartitionPreservingCollapsingIntegrationTests </h4><pre class="type-8 type-7 type-6 type-3 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void numDays() throws IOException, InterruptedException, ClassNotFoundException {
  _numDays=2;
  openDay(2013,3,15);
  storeIds(1,1,1);
  storeIds(2,2,2,2);
  storeIds(3,3,3,3,3,3,3);
  closeDay();
  openDay(2013,3,16);
  storeIds(1,1,1,1,1);
  storeIds(2,2,2);
  storeIds(3,3,3,3);
  storeIds(4,4,4);
  storeIds(5);
  closeDay();
  openDay(2013,3,17);
  storeIds(2,2,2);
  storeIds(3,3,3,3,3,3,3,3,3,3);
  storeIds(5,5,5,5);
  storeIds(6,6,6);
  closeDay();
{
    SimplePartitionPreservingCountJob job=runFirstPass();
    List<AbstractPartitionPreservingIncrementalJob.Report> reports=job.getReports();
    Assert.assertEquals(reports.size(),1);
    AbstractPartitionPreservingIncrementalJob.Report report=reports.get(0);
    Assert.assertEquals(report.getInputFiles().size(),2);
    Assert.assertEquals(report.getOutputFiles().size(),2);
  }
  checkIntermediateFolderCount(2);
  HashMap<Long,Long> counts=loadIntermediateCounts("20130316");
  checkSize(counts,5);
  checkIdCount(counts,1,5);
  checkIdCount(counts,2,3);
  checkIdCount(counts,3,4);
  checkIdCount(counts,4,3);
  checkIdCount(counts,5,1);
  counts=loadIntermediateCounts("20130317");
  checkSize(counts,4);
  checkIdCount(counts,2,3);
  checkIdCount(counts,3,10);
  checkIdCount(counts,5,4);
  checkIdCount(counts,6,3);
{
    SimplePartitionCollapsingCountJob job=runSecondPass();
    List<AbstractPartitionCollapsingIncrementalJob.Report> reports=job.getReports();
    Assert.assertEquals(1,reports.size());
    AbstractPartitionCollapsingIncrementalJob.Report report=reports.get(0);
    Assert.assertEquals(report.getInputFiles().size(),2);
    Assert.assertNull(report.getReusedOutput());
    Assert.assertNotNull(report.getOutputPath());
    Assert.assertEquals(report.getOldInputFiles().size(),0);
  }
  checkOutputFolderCount(1);
  counts=loadOutputCounts("20130317");
  checkSize(counts,6);
  checkIdCount(counts,1,5);
  checkIdCount(counts,2,6);
  checkIdCount(counts,3,14);
  checkIdCount(counts,4,3);
  checkIdCount(counts,5,5);
  checkIdCount(counts,6,3);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: datafu.hourglass.test.PartitionPreservingTests </h4><pre class="type-8 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void endDate() throws IOException, InterruptedException, ClassNotFoundException {
  _endDate="20130317";
  _numDays=2;
  openDay(2013,3,15);
  storeIds(1,1,1);
  storeIds(2,2,2,2);
  storeIds(3,3,3,3,3,3,3);
  closeDay();
  openDay(2013,3,16);
  storeIds(1,1,1,1,1);
  storeIds(2,2,2);
  storeIds(3,3,3,3);
  storeIds(4,4,4);
  storeIds(5);
  closeDay();
  openDay(2013,3,17);
  storeIds(2,2,2);
  storeIds(3,3,3,3,3,3,3,3,3,3);
  storeIds(5,5,5,5);
  storeIds(6,6,6);
  closeDay();
  openDay(2013,3,18);
  storeIds(2,2,2,2,2);
  storeIds(3,3,3,3,3,3,3);
  storeIds(5,5,5);
  storeIds(6,6,6);
  closeDay();
{
    SimplePartitionPreservingCountJob job=runJob();
    List<Report> reports=job.getReports();
    Assert.assertEquals(reports.size(),1);
    Report report=reports.get(0);
    Assert.assertEquals(report.getInputFiles().size(),2);
    Assert.assertEquals(report.getOutputFiles().size(),2);
  }
  checkOutputFolderCount(2);
  HashMap<Long,Long> counts=loadOutputCounts("20130316");
  checkSize(counts,5);
  checkIdCount(counts,1,5);
  checkIdCount(counts,2,3);
  checkIdCount(counts,3,4);
  checkIdCount(counts,4,3);
  checkIdCount(counts,5,1);
  counts=loadOutputCounts("20130317");
  checkSize(counts,4);
  checkIdCount(counts,2,3);
  checkIdCount(counts,3,10);
  checkIdCount(counts,5,4);
  checkIdCount(counts,6,3);
}

</code></pre>

<br>
<pre class="type-8 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void multipleRuns() throws IOException, InterruptedException, ClassNotFoundException {
  openDay(2013,3,15);
  storeIds(1,1,1);
  storeIds(2,2,2,2);
  storeIds(3,3,3,3,3,3,3);
  closeDay();
  openDay(2013,3,16);
  storeIds(1,1,1,1,1);
  storeIds(2,2,2);
  storeIds(3,3,3,3);
  storeIds(4,4,4);
  storeIds(5);
  closeDay();
  openDay(2013,3,17);
  storeIds(2,2,2);
  storeIds(3,3,3,3,3,3,3,3,3,3);
  storeIds(5,5,5,5);
  storeIds(6,6,6);
  closeDay();
{
    SimplePartitionPreservingCountJob job=runJob();
    List<Report> reports=job.getReports();
    Assert.assertEquals(reports.size(),1);
    Report report=reports.get(0);
    Assert.assertEquals(report.getInputFiles().size(),3);
    Assert.assertEquals(report.getOutputFiles().size(),3);
  }
  checkOutputFolderCount(3);
  HashMap<Long,Long> counts=loadOutputCounts("20130315");
  checkSize(counts,3);
  checkIdCount(counts,1,3);
  checkIdCount(counts,2,4);
  checkIdCount(counts,3,7);
  counts=loadOutputCounts("20130316");
  checkSize(counts,5);
  checkIdCount(counts,1,5);
  checkIdCount(counts,2,3);
  checkIdCount(counts,3,4);
  checkIdCount(counts,4,3);
  checkIdCount(counts,5,1);
  counts=loadOutputCounts("20130317");
  checkSize(counts,4);
  checkIdCount(counts,2,3);
  checkIdCount(counts,3,10);
  checkIdCount(counts,5,4);
  checkIdCount(counts,6,3);
  openDay(2013,3,18);
  storeIds(2,2);
  storeIds(3,3,3,3,3,3);
  storeIds(5,5);
  storeIds(7,7,7);
  closeDay();
{
    SimplePartitionPreservingCountJob job=runJob();
    List<Report> reports=job.getReports();
    Assert.assertEquals(1,reports.size());
    Report report=reports.get(0);
    Assert.assertEquals(report.getInputFiles().size(),1);
    Assert.assertEquals(report.getOutputFiles().size(),1);
  }
  checkOutputFolderCount(3);
  counts=loadOutputCounts("20130318");
  checkSize(counts,4);
  checkIdCount(counts,2,2);
  checkIdCount(counts,3,6);
  checkIdCount(counts,5,2);
  checkIdCount(counts,7,3);
}

</code></pre>

<br>
<pre class="type-8 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void startAndEndDate() throws IOException, InterruptedException, ClassNotFoundException {
  _startDate="20130316";
  _endDate="20130317";
  openDay(2013,3,15);
  storeIds(1,1,1);
  storeIds(2,2,2,2);
  storeIds(3,3,3,3,3,3,3);
  closeDay();
  openDay(2013,3,16);
  storeIds(1,1,1,1,1);
  storeIds(2,2,2);
  storeIds(3,3,3,3);
  storeIds(4,4,4);
  storeIds(5);
  closeDay();
  openDay(2013,3,17);
  storeIds(2,2,2);
  storeIds(3,3,3,3,3,3,3,3,3,3);
  storeIds(5,5,5,5);
  storeIds(6,6,6);
  closeDay();
  openDay(2013,3,18);
  storeIds(2,2,2,2,2);
  storeIds(3,3,3,3,3,3,3);
  storeIds(5,5,5);
  storeIds(6,6,6);
  closeDay();
{
    SimplePartitionPreservingCountJob job=runJob();
    List<Report> reports=job.getReports();
    Assert.assertEquals(reports.size(),1);
    Report report=reports.get(0);
    Assert.assertEquals(report.getInputFiles().size(),2);
    Assert.assertEquals(report.getOutputFiles().size(),2);
  }
  checkOutputFolderCount(2);
  HashMap<Long,Long> counts=loadOutputCounts("20130316");
  checkSize(counts,5);
  checkIdCount(counts,1,5);
  checkIdCount(counts,2,3);
  checkIdCount(counts,3,4);
  checkIdCount(counts,4,3);
  checkIdCount(counts,5,1);
  counts=loadOutputCounts("20130317");
  checkSize(counts,4);
  checkIdCount(counts,2,3);
  checkIdCount(counts,3,10);
  checkIdCount(counts,5,4);
  checkIdCount(counts,6,3);
}

</code></pre>

<br>
<pre class="type-8 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void numDays() throws IOException, InterruptedException, ClassNotFoundException {
  _numDays=2;
  openDay(2013,3,15);
  storeIds(1,1,1);
  storeIds(2,2,2,2);
  storeIds(3,3,3,3,3,3,3);
  closeDay();
  openDay(2013,3,16);
  storeIds(1,1,1,1,1);
  storeIds(2,2,2);
  storeIds(3,3,3,3);
  storeIds(4,4,4);
  storeIds(5);
  closeDay();
  openDay(2013,3,17);
  storeIds(2,2,2);
  storeIds(3,3,3,3,3,3,3,3,3,3);
  storeIds(5,5,5,5);
  storeIds(6,6,6);
  closeDay();
{
    SimplePartitionPreservingCountJob job=runJob();
    List<Report> reports=job.getReports();
    Assert.assertEquals(reports.size(),1);
    Report report=reports.get(0);
    Assert.assertEquals(report.getInputFiles().size(),2);
    Assert.assertEquals(report.getOutputFiles().size(),2);
  }
  checkOutputFolderCount(2);
  HashMap<Long,Long> counts=loadOutputCounts("20130316");
  checkSize(counts,5);
  checkIdCount(counts,1,5);
  checkIdCount(counts,2,3);
  checkIdCount(counts,3,4);
  checkIdCount(counts,4,3);
  checkIdCount(counts,5,1);
  counts=loadOutputCounts("20130317");
  checkSize(counts,4);
  checkIdCount(counts,2,3);
  checkIdCount(counts,3,10);
  checkIdCount(counts,5,4);
  checkIdCount(counts,6,3);
}

</code></pre>

<br>
<pre class="type-8 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void startDate() throws IOException, InterruptedException, ClassNotFoundException {
  _startDate="20130315";
  _numDays=2;
  openDay(2013,3,14);
  storeIds(1,1);
  storeIds(2,2,2);
  storeIds(3,3,3,3);
  closeDay();
  openDay(2013,3,15);
  storeIds(1,1,1);
  storeIds(2,2,2,2);
  storeIds(3,3,3,3,3,3,3);
  closeDay();
  openDay(2013,3,16);
  storeIds(1,1,1,1,1);
  storeIds(2,2,2);
  storeIds(3,3,3,3);
  storeIds(4,4,4);
  storeIds(5);
  closeDay();
  openDay(2013,3,17);
  storeIds(2,2,2);
  storeIds(3,3,3,3,3,3,3,3,3,3);
  storeIds(5,5,5,5);
  storeIds(6,6,6);
  closeDay();
{
    SimplePartitionPreservingCountJob job=runJob();
    List<Report> reports=job.getReports();
    Assert.assertEquals(reports.size(),1);
    Report report=reports.get(0);
    Assert.assertEquals(report.getInputFiles().size(),2);
    Assert.assertEquals(report.getOutputFiles().size(),2);
  }
  checkOutputFolderCount(2);
  HashMap<Long,Long> counts=loadOutputCounts("20130315");
  checkSize(counts,3);
  checkIdCount(counts,1,3);
  checkIdCount(counts,2,4);
  checkIdCount(counts,3,7);
  counts=loadOutputCounts("20130316");
  checkSize(counts,5);
  checkIdCount(counts,1,5);
  checkIdCount(counts,2,3);
  checkIdCount(counts,3,4);
  checkIdCount(counts,4,3);
  checkIdCount(counts,5,1);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: datafu.test.pig.bags.BagTests </h4><pre class="type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void distinctByAccumulateTest() throws Exception {
  DistinctBy distinct=new DistinctBy("0");
  DataBag bag;
  Tuple input;
  Tuple data;
  data=TupleFactory.getInstance().newTuple(2);
  bag=BagFactory.getInstance().newDefaultBag();
  bag.add(data);
  input=TupleFactory.getInstance().newTuple(bag);
  data.set(0,10);
  data.set(1,20);
  distinct.accumulate(input);
  data=TupleFactory.getInstance().newTuple(2);
  bag=BagFactory.getInstance().newDefaultBag();
  bag.add(data);
  input=TupleFactory.getInstance().newTuple(bag);
  data.set(0,11);
  data.set(1,50);
  distinct.accumulate(input);
  data=TupleFactory.getInstance().newTuple(2);
  bag=BagFactory.getInstance().newDefaultBag();
  bag.add(data);
  input=TupleFactory.getInstance().newTuple(bag);
  data.set(0,10);
  data.set(1,22);
  distinct.accumulate(input);
  data=TupleFactory.getInstance().newTuple(2);
  bag=BagFactory.getInstance().newDefaultBag();
  bag.add(data);
  input=TupleFactory.getInstance().newTuple(bag);
  data.set(0,12);
  data.set(1,40);
  distinct.accumulate(input);
  data=TupleFactory.getInstance().newTuple(2);
  bag=BagFactory.getInstance().newDefaultBag();
  bag.add(data);
  input=TupleFactory.getInstance().newTuple(bag);
  data.set(0,11);
  data.set(1,50);
  distinct.accumulate(input);
  data=TupleFactory.getInstance().newTuple(2);
  bag=BagFactory.getInstance().newDefaultBag();
  bag.add(data);
  input=TupleFactory.getInstance().newTuple(bag);
  data.set(0,11);
  data.set(1,51);
  distinct.accumulate(input);
  DataBag result=distinct.getValue();
  Assert.assertEquals(3,result.size());
  Iterator<Tuple> iter=result.iterator();
  Assert.assertEquals("(10,20)",iter.next().toString());
  Assert.assertEquals("(11,50)",iter.next().toString());
  Assert.assertEquals("(12,40)",iter.next().toString());
  distinct.cleanup();
  data=TupleFactory.getInstance().newTuple(2);
  bag=BagFactory.getInstance().newDefaultBag();
  bag.add(data);
  input=TupleFactory.getInstance().newTuple(bag);
  data.set(0,12);
  data.set(1,42);
  distinct.accumulate(input);
  data=TupleFactory.getInstance().newTuple(2);
  bag=BagFactory.getInstance().newDefaultBag();
  bag.add(data);
  input=TupleFactory.getInstance().newTuple(bag);
  data.set(0,11);
  data.set(1,51);
  distinct.accumulate(input);
  data=TupleFactory.getInstance().newTuple(2);
  bag=BagFactory.getInstance().newDefaultBag();
  bag.add(data);
  input=TupleFactory.getInstance().newTuple(bag);
  data.set(0,11);
  data.set(1,50);
  distinct.accumulate(input);
  result=distinct.getValue();
  Assert.assertEquals(2,result.size());
  iter=result.iterator();
  Assert.assertEquals("(12,42)",iter.next().toString());
  Assert.assertEquals("(11,51)",iter.next().toString());
}

</code></pre>

<br>
<pre class="type-8 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void bagJoinFullOuterTest() throws Exception {
  PigTest test=createPigTestFromString(bagJoinFullOuterTest);
  writeLinesToFile("input","1\t{(K1,A1),(K2,B1),(K3,C1)}\t{(K1,A2),(K2,B2),(K2,B22)}\t{(K1,A3),(K3,C3),(K4,D3)}");
  try {
    test.runScript();
  }
 catch (  Exception e) {
    e.printStackTrace();
    throw e;
  }
  List<Tuple> tuples=getLinesForAlias(test,"data2");
  assertEquals(tuples.size(),1);
  Tuple tuple=tuples.get(0);
  DataBag joined1=(DataBag)tuple.get(1);
  DataBag joined2=(DataBag)tuple.get(2);
  String joined1Schema="{(bag1::k: chararray,bag1::v: chararray,bag2::k: chararray,bag2::v: chararray,bag3::k3: chararray,bag3::v3: chararray)}";
  String joined2Schema="{(bag1::k: chararray,bag1::v: chararray,bag3::k3: chararray,bag3::v3: chararray,bag2::k: chararray,bag2::v: chararray)}";
  String expectedJoined1="{(K1,A1,K1,A2,K1,A3),(K2,B1,K2,B2,,),(K2,B1,K2,B22,,),(K3,C1,,,K3,C3),(,,,,K4,D3)}";
  String expectedJoined2="{(K1,A1,K1,A3,K1,A2),(K2,B1,,,K2,B2),(K2,B1,,,K2,B22),(K3,C1,K3,C3,,),(,,K4,D3,,)}";
  assertEquals(getSortedBag(joined1).toString(),getSortedBag(expectedJoined1,joined1Schema).toString());
  assertEquals(getSortedBag(joined2).toString(),getSortedBag(expectedJoined2,joined2Schema).toString());
}

</code></pre>

<br>
<pre class="type-8 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void bagLeftOuterJoinTest() throws Exception {
  PigTest test=createPigTestFromString(bagLeftOuterJoinTest);
  writeLinesToFile("input","1\t{(K1,A1),(K2,B1),(K3,C1)}\t{(K1,A2),(K2,B2),(K2,B22)}\t{(K1,A3),(K3,C3),(K4,D3)}");
  test.runScript();
  List<Tuple> tuples=getLinesForAlias(test,"data2");
  assertEquals(tuples.size(),1);
  Tuple tuple=tuples.get(0);
  DataBag joined1=(DataBag)tuple.get(1);
  DataBag joined2=(DataBag)tuple.get(2);
  String joined1Schema="{(bag1::k: chararray,bag1::v: chararray,bag2::k: chararray,bag2::v: chararray,bag3::k3: chararray,bag3::v3: chararray)}";
  String joined2Schema="{(bag1::k: chararray,bag1::v: chararray,bag3::k3: chararray,bag3::v3: chararray,bag2::k: chararray,bag2::v: chararray)}";
  String expectedJoined1="{(K1,A1,K1,A2,K1,A3),(K2,B1,K2,B2,,),(K2,B1,K2,B22,,),(K3,C1,,,K3,C3)}";
  String expectedJoined2="{(K1,A1,K1,A3,K1,A2),(K2,B1,,,K2,B2),(K2,B1,,,K2,B22),(K3,C1,K3,C3,,)}";
  assertEquals(getSortedBag(joined1).toString(),getSortedBag(expectedJoined1,joined1Schema).toString());
  assertEquals(getSortedBag(joined2).toString(),getSortedBag(expectedJoined2,joined2Schema).toString());
}

</code></pre>

<br>
<pre class="type-8 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void distinctByExecTest() throws Exception {
  DistinctBy distinct=new DistinctBy("0");
  DataBag bag;
  Tuple input;
  Tuple data;
  bag=BagFactory.getInstance().newDefaultBag();
  input=TupleFactory.getInstance().newTuple(bag);
  data=TupleFactory.getInstance().newTuple(2);
  bag.add(data);
  data.set(0,10);
  data.set(1,20);
  data=TupleFactory.getInstance().newTuple(2);
  bag.add(data);
  data.set(0,11);
  data.set(1,50);
  data=TupleFactory.getInstance().newTuple(2);
  bag.add(data);
  data.set(0,10);
  data.set(1,22);
  data=TupleFactory.getInstance().newTuple(2);
  bag.add(data);
  data.set(0,12);
  data.set(1,40);
  data=TupleFactory.getInstance().newTuple(2);
  bag.add(data);
  data.set(0,11);
  data.set(1,50);
  data=TupleFactory.getInstance().newTuple(2);
  bag.add(data);
  data.set(0,11);
  data.set(1,51);
  DataBag result=distinct.exec(input);
  Assert.assertEquals(3,result.size());
  Iterator<Tuple> iter=result.iterator();
  Assert.assertEquals("(10,20)",iter.next().toString());
  Assert.assertEquals("(11,50)",iter.next().toString());
  Assert.assertEquals("(12,40)",iter.next().toString());
  bag=BagFactory.getInstance().newDefaultBag();
  input=TupleFactory.getInstance().newTuple(bag);
  data=TupleFactory.getInstance().newTuple(2);
  bag.add(data);
  data.set(0,12);
  data.set(1,42);
  data=TupleFactory.getInstance().newTuple(2);
  bag.add(data);
  data.set(0,11);
  data.set(1,51);
  data=TupleFactory.getInstance().newTuple(2);
  bag.add(data);
  data.set(0,11);
  data.set(1,50);
  result=distinct.exec(input);
  Assert.assertEquals(2,result.size());
  iter=result.iterator();
  Assert.assertEquals("(12,42)",iter.next().toString());
  Assert.assertEquals("(11,51)",iter.next().toString());
}

</code></pre>

<br>
<pre class="type-9 type-11 type-10 type-7 type-3 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void countEachExecAndAccumulateTest() throws Exception {
  for (int c=0; c < 2; c++) {
    CountEach countEach=new CountEach("flatten");
    DataBag bag=BagFactory.getInstance().newDefaultBag();
{
      Tuple t=TupleFactory.getInstance().newTuple(1);
      t.set(0,"A");
      bag.add(t);
    }
{
      Tuple t=TupleFactory.getInstance().newTuple(1);
      t.set(0,"B");
      bag.add(t);
    }
{
      Tuple t=TupleFactory.getInstance().newTuple(1);
      t.set(0,"B");
      bag.add(t);
    }
{
      Tuple t=TupleFactory.getInstance().newTuple(1);
      t.set(0,"C");
      bag.add(t);
    }
{
      Tuple t=TupleFactory.getInstance().newTuple(1);
      t.set(0,"A");
      bag.add(t);
    }
{
      Tuple t=TupleFactory.getInstance().newTuple(1);
      t.set(0,"D");
      bag.add(t);
    }
    DataBag output=null;
    if (c == 0) {
      Tuple input=TupleFactory.getInstance().newTuple(1);
      input.set(0,bag);
      System.out.println("Testing exec");
      output=countEach.exec(input);
    }
 else {
      System.out.println("Testing accumulate");
      for (      Tuple t : bag) {
        DataBag tb=BagFactory.getInstance().newDefaultBag();
        tb.add(t);
        Tuple input=TupleFactory.getInstance().newTuple(1);
        input.set(0,tb);
        countEach.accumulate(input);
      }
      output=countEach.getValue();
      countEach.cleanup();
      Assert.assertEquals(0,countEach.getValue().size());
    }
    System.out.println(output.toString());
    Assert.assertEquals(4,output.size());
    Set<String> found=new HashSet<String>();
    for (    Tuple t : output) {
      String key=(String)t.get(0);
      found.add(key);
      if (key == "A") {
        Assert.assertEquals(2,t.get(1));
      }
 else       if (key == "B") {
        Assert.assertEquals(2,t.get(1));
      }
 else       if (key == "C") {
        Assert.assertEquals(1,t.get(1));
      }
 else       if (key == "D") {
        Assert.assertEquals(1,t.get(1));
      }
 else {
        Assert.fail("Unexpected: " + key);
      }
    }
    Assert.assertEquals(4,found.size());
  }
}

</code></pre>

<br>
<pre class="type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void enumerateAccumulatorTest() throws Exception {
  Enumerate enumerate=new Enumerate();
  Tuple tuple1=TupleFactory.getInstance().newTuple(1);
  tuple1.set(0,10);
  Tuple tuple2=TupleFactory.getInstance().newTuple(1);
  tuple2.set(0,20);
  Tuple tuple3=TupleFactory.getInstance().newTuple(1);
  tuple3.set(0,30);
  Tuple tuple4=TupleFactory.getInstance().newTuple(1);
  tuple4.set(0,40);
  Tuple tuple5=TupleFactory.getInstance().newTuple(1);
  tuple5.set(0,50);
  DataBag bag1=BagFactory.getInstance().newDefaultBag();
  bag1.add(tuple1);
  bag1.add(tuple2);
  bag1.add(tuple3);
  DataBag bag2=BagFactory.getInstance().newDefaultBag();
  bag2.add(tuple4);
  bag2.add(tuple5);
  Tuple inputTuple1=TupleFactory.getInstance().newTuple(1);
  inputTuple1.set(0,bag1);
  Tuple inputTuple2=TupleFactory.getInstance().newTuple(1);
  inputTuple2.set(0,bag2);
  enumerate.accumulate(inputTuple1);
  enumerate.accumulate(inputTuple2);
  assertEquals(enumerate.getValue().toString(),"{(10,0),(20,1),(30,2),(40,3),(50,4)}");
  enumerate.cleanup();
  enumerate.accumulate(inputTuple1);
  enumerate.accumulate(inputTuple2);
  assertEquals(enumerate.getValue().toString(),"{(10,0),(20,1),(30,2),(40,3),(50,4)}");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: datafu.test.pig.hash.lsh.LSHPigTest </h4><pre class="type-9 type-8 type-2 type-7 type-3 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSparseVectors() throws IOException, ParseException {
  RandomGenerator rg=new JDKRandomGenerator();
  rg.setSeed(0);
  RandomData rd=new RandomDataImpl(rg);
  int n=20;
  List<RealVector> vectors=LSHTest.getVectors(rd,1000,n);
  PigTest test=createPigTestFromString(sparseVectorTest);
  writeLinesToFile("input",getSparseLines(vectors));
  test.runScript();
  List<Tuple> neighbors=this.getLinesForAlias(test,"PTS");
  Assert.assertEquals(neighbors.size(),n);
  int idx=0;
  for (  Tuple t : neighbors) {
    Assert.assertTrue(t.get(0) instanceof DataBag);
    Assert.assertEquals(t.size(),1);
    RealVector interpreted=DataTypeUtil.INSTANCE.convert(t,3);
    RealVector original=vectors.get(idx);
    Assert.assertEquals(original.getDimension(),interpreted.getDimension());
    for (int i=0; i < interpreted.getDimension(); ++i) {
      double originalField=original.getEntry(i);
      double interpretedField=interpreted.getEntry(i);
      Assert.assertTrue(Math.abs(originalField - interpretedField) < 1e-5);
    }
    idx++;
  }
}

</code></pre>

<br>
<pre class="type-8 type-2 type-7 type-3 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testL2UDF() throws Exception {
  setMemorySettings();
  RandomGenerator rg=new JDKRandomGenerator();
  rg.setSeed(0);
  RandomData rd=new RandomDataImpl(rg);
  int n=1000;
  List<RealVector> vectors=LSHTest.getVectors(rd,1000,n);
  PigTest test=createPigTestFromString(l2Test);
  writeLinesToFile("input",getLines(vectors));
  List<RealVector> queries=LSHTest.getVectors(rd,1000,10);
  writeLinesToFile("queries",getLines(queries));
  test.runScript();
  List<Tuple> neighbors=this.getLinesForAlias(test,"NEIGHBOR_CNT");
  Assert.assertEquals(queries.size(),neighbors.size());
  for (  long cnt : getCounts(neighbors)) {
    Assert.assertTrue(cnt >= 3);
  }
  Distance d=new Distance(){
    @Override public double distance(    RealVector v1,    RealVector v2){
      return L2.distance(v1,v2);
    }
  }
;
  verifyPoints(neighbors,d,1000);
}

</code></pre>

<br>
<pre class="type-8 type-2 type-7 type-3 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCosineUDF() throws Exception {
  setMemorySettings();
  RandomGenerator rg=new JDKRandomGenerator();
  rg.setSeed(0);
  RandomData rd=new RandomDataImpl(rg);
  int n=1000;
  List<RealVector> vectors=LSHTest.getVectors(rd,1000,n);
  PigTest test=createPigTestFromString(cosTest);
  writeLinesToFile("input",getLines(vectors));
  List<RealVector> queries=LSHTest.getVectors(rd,1000,10);
  writeLinesToFile("queries",getLines(queries));
  test.runScript();
  List<Tuple> neighbors=this.getLinesForAlias(test,"NEIGHBOR_CNT");
  Assert.assertEquals(queries.size(),neighbors.size());
  for (  long cnt : getCounts(neighbors)) {
    Assert.assertTrue(cnt >= 2);
  }
  Distance d=new Distance(){
    @Override public double distance(    RealVector v1,    RealVector v2){
      return Cosine.distance(v1,v2);
    }
  }
;
  verifyPoints(neighbors,d,.001);
}

</code></pre>

<br>
<pre class="type-8 type-2 type-7 type-3 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testL1UDFSparse() throws Exception {
  setMemorySettings();
  RandomGenerator rg=new JDKRandomGenerator();
  rg.setSeed(0);
  RandomData rd=new RandomDataImpl(rg);
  int n=1000;
  List<RealVector> vectors=LSHTest.getVectors(rd,1000,n);
  PigTest test=createPigTestFromString(l1SparseTest);
  writeLinesToFile("input",getSparseLines(vectors));
  List<RealVector> queries=LSHTest.getVectors(rd,1000,10);
  writeLinesToFile("queries",getSparseLines(queries));
  test.runScript();
  List<Tuple> neighbors=this.getLinesForAlias(test,"NEIGHBOR_CNT");
  Assert.assertEquals(queries.size(),neighbors.size());
  for (  long cnt : getCounts(neighbors)) {
    Assert.assertTrue(cnt >= 3);
  }
  Distance d=new Distance(){
    @Override public double distance(    RealVector v1,    RealVector v2){
      return L1.distance(v1,v2);
    }
  }
;
  verifyPoints(neighbors,d,1000);
}

</code></pre>

<br>
<pre class="type-8 type-2 type-7 type-3 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testL1UDF() throws Exception {
  setMemorySettings();
  RandomGenerator rg=new JDKRandomGenerator();
  rg.setSeed(0);
  RandomData rd=new RandomDataImpl(rg);
  int n=1000;
  List<RealVector> vectors=LSHTest.getVectors(rd,1000,n);
  PigTest test=createPigTestFromString(l1Test);
  writeLinesToFile("input",getLines(vectors));
  List<RealVector> queries=LSHTest.getVectors(rd,1000,10);
  writeLinesToFile("queries",getLines(queries));
  test.runScript();
  List<Tuple> neighbors=this.getLinesForAlias(test,"NEIGHBOR_CNT");
  Assert.assertEquals(queries.size(),neighbors.size());
  for (  long cnt : getCounts(neighbors)) {
    Assert.assertTrue(cnt >= 3);
  }
  Distance d=new Distance(){
    @Override public double distance(    RealVector v1,    RealVector v2){
      return L1.distance(v1,v2);
    }
  }
;
  verifyPoints(neighbors,d,1000);
}

</code></pre>

<br>
<pre class="type-8 type-2 type-7 type-3 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRandomSeed() throws Exception {
  setMemorySettings();
  RandomGenerator rg=new JDKRandomGenerator();
  rg.setSeed(0);
  RandomData rd=new RandomDataImpl(rg);
  int n=10;
  List<RealVector> vectors=LSHTest.getVectors(rd,1000,n);
  writeLinesToFile("input",getLines(vectors));
  Map<String,Long> hashes=new HashMap<String,Long>();
  int numDiff=0;
  int numHashes=0;
{
    PigTest test=createPigTestFromString(randomSeedTest);
    test.runScript();
    List<Tuple> pts=this.getLinesForAlias(test,"PTS_HASHED");
    numHashes=pts.size();
    for (    Tuple t : pts) {
      String key=((Tuple)t.get(0)).toString() + t.get(1).toString();
      Long value=(Long)t.get(2);
      hashes.put(key,value);
    }
  }
{
    PigTest test=createPigTestFromString(randomSeedTest);
    test.runScript();
    List<Tuple> pts=this.getLinesForAlias(test,"PTS_HASHED");
    Assert.assertEquals(numHashes,pts.size());
    for (    Tuple t : pts) {
      String key=((Tuple)t.get(0)).toString() + t.get(1).toString();
      Long value=(Long)t.get(2);
      Long refValue=hashes.get(key);
      if (!value.equals(refValue)) {
        numDiff++;
      }
    }
  }
  System.out.println(1.0 * numDiff / numHashes);
  Assert.assertTrue(1.0 * numDiff / numHashes > .8);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: datafu.test.pig.linkanalysis.PageRankTests </h4><pre class="type-9 type-8 type-2 type-7 type-3 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void pigPageRankTest() throws Exception {
  PigTest test=createPigTestFromString(pageRankTest);
  String[] edges=PageRankImplTests.getWikiExampleEdges();
  Map<String,Integer> nodeIds=new HashMap<String,Integer>();
  Map<Integer,String> nodeIdsReversed=new HashMap<Integer,String>();
  Map<String,Float> expectedRanks=PageRankImplTests.parseExpectedRanks(PageRankImplTests.getWikiExampleExpectedRanks());
  File f=new File(System.getProperty("user.dir"),"input").getAbsoluteFile();
  if (f.exists()) {
    f.delete();
  }
  FileWriter writer=new FileWriter(f);
  BufferedWriter bufferedWriter=new BufferedWriter(writer);
  for (  String edge : edges) {
    String[] edgeParts=edge.split(" ");
    String source=edgeParts[0];
    String dest=edgeParts[1];
    if (!nodeIds.containsKey(source)) {
      int id=nodeIds.size();
      nodeIds.put(source,id);
      nodeIdsReversed.put(id,source);
    }
    if (!nodeIds.containsKey(dest)) {
      int id=nodeIds.size();
      nodeIds.put(dest,id);
      nodeIdsReversed.put(id,dest);
    }
    Integer sourceId=nodeIds.get(source);
    Integer destId=nodeIds.get(dest);
    StringBuffer sb=new StringBuffer();
    sb.append("1\t");
    sb.append(sourceId.toString() + "\t");
    sb.append(destId.toString() + "\t");
    sb.append("1.0\n");
    bufferedWriter.write(sb.toString());
  }
  bufferedWriter.close();
  test.runScript();
  Iterator<Tuple> tuples=test.getAlias("data_grouped3");
  System.out.println("Final node ranks:");
  int nodeCount=0;
  while (tuples.hasNext()) {
    Tuple nodeTuple=tuples.next();
    Integer topic=(Integer)nodeTuple.get(0);
    Integer nodeId=(Integer)nodeTuple.get(1);
    Float nodeRank=(Float)nodeTuple.get(2);
    assertEquals(1,topic.intValue());
    System.out.println(String.format("%d => %f",nodeId,nodeRank));
    Float expectedNodeRank=expectedRanks.get(nodeIdsReversed.get(nodeId));
    assertTrue(Math.abs(expectedNodeRank - nodeRank * 100.0f) < 0.1,String.format("expected: %f, actual: %f",expectedNodeRank,nodeRank));
    nodeCount++;
  }
  assertEquals(nodeIds.size(),nodeCount);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: datafu.test.pig.random.UUIDTests </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Test the RandomUUID UDF.  The main purpose is to make sure it can be used in a Pig script.
 * Also the range of length of values is tested.
 * @throws Exception
 */
@Test public void randomUUIDTest() throws Exception {
  PigTest test=createPigTestFromString(randomUUIDTest);
  writeLinesToFile("input","input1","input2","input3");
  List<Tuple> tuples=getLinesForAlias(test,"data2",true);
  Set<UUID> set=new HashSet<UUID>();
  for (  Tuple tuple : tuples) {
    set.add(UUID.fromString((String)tuple.get(1)));
  }
  Assert.assertEquals(set.size(),3);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: datafu.test.pig.sampling.SamplingTests </h4><pre class="type-2 type-3 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void sampleByKeyExecTest() throws Exception {
  SampleByKey sampler=new SampleByKey("0.10","thesalt");
  Map<Integer,Integer> valuesPerKey=new HashMap<Integer,Integer>();
  for (int i=0; i < 10000; i++) {
    for (int j=0; j < 5; j++) {
      Tuple t=TupleFactory.getInstance().newTuple(1);
      t.set(0,i);
      if (sampler.exec(t)) {
        if (valuesPerKey.containsKey(i)) {
          valuesPerKey.put(i,valuesPerKey.get(i) + 1);
        }
 else {
          valuesPerKey.put(i,1);
        }
      }
    }
  }
  Assert.assertTrue(Math.abs(1000 - valuesPerKey.size()) < 50);
  for (  Map.Entry<Integer,Integer> pair : valuesPerKey.entrySet()) {
    Assert.assertEquals(5,pair.getValue().intValue());
  }
}

</code></pre>

<br>
<pre class="type-2 type-7 type-3 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void reservoirSampleAccumulateTest() throws IOException {
  ReservoirSample sampler=new ReservoirSample("10");
  for (int i=0; i < 100; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(1);
    t.set(0,i);
    DataBag bag=BagFactory.getInstance().newDefaultBag();
    bag.add(t);
    Tuple input=TupleFactory.getInstance().newTuple(bag);
    sampler.accumulate(input);
  }
  DataBag result=sampler.getValue();
  Assert.assertEquals(10,result.size());
  Set<Integer> found=new HashSet<Integer>();
  for (  Tuple t : result) {
    Integer i=(Integer)t.get(0);
    System.out.println(i);
    Assert.assertTrue(i >= 0 && i < 100);
    Assert.assertFalse(String.format("Found duplicate of %d",i),found.contains(i));
    found.add(i);
  }
}

</code></pre>

<br>
<pre class="type-8 type-2 type-7 type-3 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void reservoirSampleAlgebraicTest() throws IOException {
  ReservoirSample.Initial initialSampler=new ReservoirSample.Initial("10");
  ReservoirSample.Intermediate intermediateSampler=new ReservoirSample.Intermediate("10");
  ReservoirSample.Final finalSampler=new ReservoirSample.Final("10");
  DataBag bag=BagFactory.getInstance().newDefaultBag();
  for (int i=0; i < 100; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(1);
    t.set(0,i);
    bag.add(t);
  }
  Tuple input=TupleFactory.getInstance().newTuple(bag);
  Tuple intermediateTuple=initialSampler.exec(input);
  DataBag intermediateBag=BagFactory.getInstance().newDefaultBag(Arrays.asList(intermediateTuple));
  intermediateTuple=intermediateSampler.exec(TupleFactory.getInstance().newTuple(intermediateBag));
  intermediateBag=BagFactory.getInstance().newDefaultBag(Arrays.asList(intermediateTuple));
  DataBag result=finalSampler.exec(TupleFactory.getInstance().newTuple(intermediateBag));
  Assert.assertEquals(10,result.size());
  Set<Integer> found=new HashSet<Integer>();
  for (  Tuple t : result) {
    Integer i=(Integer)t.get(0);
    System.out.println(i);
    Assert.assertTrue(i >= 0 && i < 100);
    Assert.assertFalse(String.format("Found duplicate of %d",i),found.contains(i));
    found.add(i);
  }
}

</code></pre>

<br>
<pre class="type-2 type-7 type-3 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void weightedSampleLimitExecTest() throws IOException {
  WeightedSample sampler=new WeightedSample();
  DataBag bag=BagFactory.getInstance().newDefaultBag();
  for (int i=0; i < 100; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(2);
    t.set(0,i);
    t.set(1,1);
    bag.add(t);
  }
  Tuple input=TupleFactory.getInstance().newTuple(3);
  input.set(0,bag);
  input.set(1,1);
  input.set(2,10);
  DataBag result=sampler.exec(input);
  Assert.assertEquals(10,result.size());
  Set<Integer> found=new HashSet<Integer>();
  for (  Tuple t : result) {
    Integer i=(Integer)t.get(0);
    System.out.println(i);
    Assert.assertTrue(i >= 0 && i < 100);
    Assert.assertFalse(String.format("Found duplicate of %d",i),found.contains(i));
    found.add(i);
  }
}

</code></pre>

<br>
<pre class="type-8 type-2 type-7 type-3 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void reservoirSampleExecTest() throws IOException {
  ReservoirSample sampler=new ReservoirSample("10");
  DataBag bag=BagFactory.getInstance().newDefaultBag();
  for (int i=0; i < 100; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(1);
    t.set(0,i);
    bag.add(t);
  }
  Tuple input=TupleFactory.getInstance().newTuple(bag);
  DataBag result=sampler.exec(input);
  Assert.assertEquals(10,result.size());
  Set<Integer> found=new HashSet<Integer>();
  for (  Tuple t : result) {
    Integer i=(Integer)t.get(0);
    System.out.println(i);
    Assert.assertTrue(i >= 0 && i < 100);
    Assert.assertFalse(String.format("Found duplicate of %d",i),found.contains(i));
    found.add(i);
  }
}

</code></pre>

<br>
<pre class="type-9 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Verifies that ReservoirSample works when data grouped by a key.
 * In particular it ensures that the reservoir is not reused across keys.
 * <p>
 * This confirms the fix for DATAFU-11.
 * </p>
 * @throws Exception
 */
@Test public void reservoirSampleGroupTest() throws Exception {
  writeLinesToFile("input","1\tB1\t1","1\tB1\t1","1\tB3\t1","1\tB4\t1","2\tB1\t2","2\tB2\t2","3\tB1\t3","3\tB1\t3","3\tB3\t3","4\tB1\t4","4\tB2\t4","4\tB3\t4","4\tB4\t4","5\tB1\t5","6\tB2\t6","6\tB2\t6","6\tB3\t6","7\tB1\t7","7\tB2\t7","7\tB3\t7","8\tB1\t8","8\tB2\t8","9\tB3\t9","9\tB3\t9","9\tB6\t9","9\tB5\t9","10\tB1\t10","10\tB2\t10","10\tB2\t10","10\tB2\t10","10\tB6\t10","10\tB7\t10");
  for (int i=1; i <= 3; i++) {
    int reservoirSize=i;
    PigTest test=createPigTestFromString(reservoirSampleGroupTest,"RESERVOIR_SIZE=" + reservoirSize);
    test.runScript();
    List<Tuple> tuples=getLinesForAlias(test,"sampled");
    for (    Tuple tuple : tuples) {
      Assert.assertEquals(((Number)tuple.get(0)).intValue(),((Number)tuple.get(2)).intValue());
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: datafu.test.pig.sampling.WeightedReservoirSamplingTests </h4><pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void weightedSampleTest() throws Exception {
  Map<String,Integer> count=new HashMap<String,Integer>();
  count.put("a",0);
  count.put("b",0);
  count.put("c",0);
  count.put("d",0);
  PigTest test=createPigTestFromString(weightedSampleTest);
  writeLinesToFile("input","a\t100","b\t1","c\t5","d\t2");
  for (int i=0; i < 10; i++) {
    test.runScript();
    List<Tuple> output=this.getLinesForAlias(test,"sampled");
    Tuple t=output.get(0);
    DataBag sampleBag=(DataBag)t.get(0);
    for (Iterator<Tuple> sampleIter=sampleBag.iterator(); sampleIter.hasNext(); ) {
      Tuple st=sampleIter.next();
      String key=(String)st.get(0);
      count.put(key,count.get(key) + 1);
    }
  }
  String maxKey="";
  int maxCount=0;
  for (  String key : count.keySet()) {
    if (maxCount < count.get(key)) {
      maxKey=key;
      maxCount=count.get(key);
    }
  }
  Assert.assertEquals(maxKey,"a");
}

</code></pre>

<br>
<pre class="type-9 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Verifies that WeightedReservoirSample works when data grouped by a key.
 * In particular it ensures that the reservoir is not reused across keys.
 * <p>
 * This confirms the fix for DATAFU-11.
 * </p>
 * @throws Exception
 */
@Test public void weightedReservoirSampleGroupTest() throws Exception {
  writeLinesToFile("input","1\tB1\t1\t1.0","1\tB1\t1\t1.0","1\tB3\t1\t1.0","1\tB4\t1\t1.0","2\tB1\t2\t1.0","2\tB2\t2\t1.0","3\tB1\t3\t1.0","3\tB1\t3\t1.0","3\tB3\t3\t1.0","4\tB1\t4\t1.0","4\tB2\t4\t1.0","4\tB3\t4\t1.0","4\tB4\t4\t1.0","5\tB1\t5\t1.0","6\tB2\t6\t1.0","6\tB2\t6\t1.0","6\tB3\t6\t1.0","7\tB1\t7\t1.0","7\tB2\t7\t1.0","7\tB3\t7\t1.0","8\tB1\t8\t1.0","8\tB2\t8\t1.0","9\tB3\t9\t1.0","9\tB3\t9\t1.0","9\tB6\t9\t1.0","9\tB5\t9\t1.0","10\tB1\t10\t1.0","10\tB2\t10\t1.0","10\tB2\t10\t1.0","10\tB2\t10\t1.0","10\tB6\t10\t1.0","10\tB7\t10\t1.0");
  for (int i=1; i <= 3; i++) {
    int reservoirSize=i;
    PigTest test=createPigTestFromString(weightedReservoirSampleGroupTest,"RESERVOIR_SIZE=" + reservoirSize);
    test.runScript();
    List<Tuple> tuples=getLinesForAlias(test,"sampled");
    for (    Tuple tuple : tuples) {
      Assert.assertEquals(((Number)tuple.get(0)).intValue(),((Number)tuple.get(2)).intValue());
    }
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: datafu.test.pig.sessions.SessionTests </h4><pre class="type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void sessionCountExecTest() throws Exception {
  SessionCount sessionize=new SessionCount("30m");
  Tuple input=TupleFactory.getInstance().newTuple(1);
  DataBag inputBag=BagFactory.getInstance().newDefaultBag();
  input.set(0,inputBag);
  Tuple item;
  DateTime dt;
  inputBag.clear();
  dt=new DateTime();
  item=TupleFactory.getInstance().newTuple(1);
  item.set(0,dt.getMillis());
  inputBag.add(item);
  item=TupleFactory.getInstance().newTuple(1);
  item.set(0,dt.plusMinutes(28).getMillis());
  inputBag.add(item);
  Assert.assertEquals(1L,sessionize.exec(input).longValue());
  inputBag.clear();
  dt=new DateTime();
  item=TupleFactory.getInstance().newTuple(1);
  item.set(0,dt.getMillis());
  inputBag.add(item);
  item=TupleFactory.getInstance().newTuple(1);
  item.set(0,dt.plusMinutes(31).getMillis());
  inputBag.add(item);
  Assert.assertEquals(2L,sessionize.exec(input).longValue());
}

</code></pre>

<br>
<pre class="type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void sessionCountAccumulateTest() throws Exception {
  SessionCount sessionize=new SessionCount("30m");
  Tuple input=TupleFactory.getInstance().newTuple(1);
  DataBag inputBag=BagFactory.getInstance().newDefaultBag();
  input.set(0,inputBag);
  Tuple item;
  DateTime dt;
  dt=new DateTime();
  item=TupleFactory.getInstance().newTuple(1);
  item.set(0,dt.getMillis());
  inputBag.add(item);
  sessionize.accumulate(input);
  inputBag.clear();
  item=TupleFactory.getInstance().newTuple(1);
  item.set(0,dt.plusMinutes(28).getMillis());
  inputBag.add(item);
  sessionize.accumulate(input);
  inputBag.clear();
  Assert.assertEquals(1L,sessionize.getValue().longValue());
  sessionize.cleanup();
  dt=new DateTime();
  item=TupleFactory.getInstance().newTuple(1);
  item.set(0,dt.getMillis());
  inputBag.add(item);
  sessionize.accumulate(input);
  inputBag.clear();
  item=TupleFactory.getInstance().newTuple(1);
  item.set(0,dt.plusMinutes(31).getMillis());
  inputBag.add(item);
  sessionize.accumulate(input);
  inputBag.clear();
  Assert.assertEquals(2L,sessionize.exec(input).longValue());
  sessionize.cleanup();
  Assert.assertEquals(0,sessionize.getValue().longValue());
}

</code></pre>

<br>
<pre class="type-2 type-3 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void sessionizeTest() throws Exception {
  PigTest test=createPigTestFromString(sessionizeTest,"TIME_WINDOW=30m","TIME_TYPE=chararray");
  this.writeLinesToFile("input",inputData);
  test.runScript();
  HashMap<Integer,HashMap<Integer,Boolean>> userValues=new HashMap<Integer,HashMap<Integer,Boolean>>();
  for (  Tuple t : this.getLinesForAlias(test,"max_value")) {
    Integer userId=(Integer)t.get(0);
    Integer max=(Integer)t.get(1);
    if (!userValues.containsKey(userId)) {
      userValues.put(userId,new HashMap<Integer,Boolean>());
    }
    userValues.get(userId).put(max,true);
  }
  assertEquals(userValues.get(1).size(),2);
  assertEquals(userValues.get(2).size(),5);
  assertEquals(userValues.get(3).size(),1);
  assertTrue(userValues.get(1).containsKey(20));
  assertTrue(userValues.get(1).containsKey(30));
  assertTrue(userValues.get(2).containsKey(10));
  assertTrue(userValues.get(2).containsKey(20));
  assertTrue(userValues.get(2).containsKey(30));
  assertTrue(userValues.get(2).containsKey(40));
  assertTrue(userValues.get(2).containsKey(50));
  assertTrue(userValues.get(3).containsKey(50));
}

</code></pre>

<br>
<pre class="type-2 type-7 type-3 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void sessionizeAccumulateTest() throws Exception {
  Sessionize sessionize=new Sessionize("30m");
  Tuple input=TupleFactory.getInstance().newTuple(1);
  DataBag inputBag=BagFactory.getInstance().newDefaultBag();
  input.set(0,inputBag);
  Tuple item;
  List<Tuple> result;
  DateTime dt;
  dt=new DateTime();
  item=TupleFactory.getInstance().newTuple(1);
  item.set(0,dt.getMillis());
  inputBag.add(item);
  sessionize.accumulate(input);
  inputBag.clear();
  item=TupleFactory.getInstance().newTuple(1);
  item.set(0,dt.plusMinutes(28).getMillis());
  inputBag.add(item);
  sessionize.accumulate(input);
  inputBag.clear();
  result=toList(sessionize.getValue());
  Assert.assertEquals(2,result.size());
  Assert.assertEquals(2,result.get(0).size());
  Assert.assertEquals(2,result.get(1).size());
  Assert.assertTrue(result.get(0).get(1).equals(result.get(1).get(1)));
  sessionize.cleanup();
  dt=new DateTime();
  item=TupleFactory.getInstance().newTuple(1);
  item.set(0,dt.getMillis());
  inputBag.add(item);
  sessionize.accumulate(input);
  inputBag.clear();
  item=TupleFactory.getInstance().newTuple(1);
  item.set(0,dt.plusMinutes(31).getMillis());
  inputBag.add(item);
  sessionize.accumulate(input);
  inputBag.clear();
  result=toList(sessionize.getValue());
  Assert.assertEquals(2,result.size());
  Assert.assertEquals(2,result.get(0).size());
  Assert.assertEquals(2,result.get(1).size());
  Assert.assertFalse(result.get(0).get(1).equals(result.get(1).get(1)));
  sessionize.cleanup();
  Assert.assertEquals(0,sessionize.getValue().size());
}

</code></pre>

<br>
<pre class="type-8 type-2 type-3 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void sessionizeLongTest() throws Exception {
  PigTest test=createPigTestFromString(sessionizeTest,"TIME_WINDOW=30m","TIME_TYPE=long");
  List<String> lines=new ArrayList<String>();
  for (  String line : inputData) {
    String[] parts=line.split("\t");
    Assert.assertEquals(3,parts.length);
    parts[0]=Long.toString(dateFormat.parse(parts[0]).getTime());
    lines.add(StringUtils.join(parts,"\t"));
  }
  this.writeLinesToFile("input",lines.toArray(new String[]{}));
  test.runScript();
  HashMap<Integer,HashMap<Integer,Boolean>> userValues=new HashMap<Integer,HashMap<Integer,Boolean>>();
  for (  Tuple t : this.getLinesForAlias(test,"max_value")) {
    Integer userId=(Integer)t.get(0);
    Integer max=(Integer)t.get(1);
    if (!userValues.containsKey(userId)) {
      userValues.put(userId,new HashMap<Integer,Boolean>());
    }
    userValues.get(userId).put(max,true);
  }
  assertEquals(userValues.get(1).size(),2);
  assertEquals(userValues.get(2).size(),5);
  assertTrue(userValues.get(1).containsKey(20));
  assertTrue(userValues.get(1).containsKey(30));
  assertTrue(userValues.get(2).containsKey(10));
  assertTrue(userValues.get(2).containsKey(20));
  assertTrue(userValues.get(2).containsKey(30));
  assertTrue(userValues.get(2).containsKey(40));
  assertTrue(userValues.get(2).containsKey(50));
}

</code></pre>

<br>
<pre class="type-2 type-7 type-3 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void sessionizeExecTest() throws Exception {
  Sessionize sessionize=new Sessionize("30m");
  Tuple input=TupleFactory.getInstance().newTuple(1);
  DataBag inputBag=BagFactory.getInstance().newDefaultBag();
  input.set(0,inputBag);
  Tuple item;
  List<Tuple> result;
  DateTime dt;
  inputBag.clear();
  dt=new DateTime();
  item=TupleFactory.getInstance().newTuple(1);
  item.set(0,dt.getMillis());
  inputBag.add(item);
  item=TupleFactory.getInstance().newTuple(1);
  item.set(0,dt.plusMinutes(28).getMillis());
  inputBag.add(item);
  result=toList(sessionize.exec(input));
  Assert.assertEquals(2,result.size());
  Assert.assertEquals(2,result.get(0).size());
  Assert.assertEquals(2,result.get(1).size());
  Assert.assertTrue(result.get(0).get(1).equals(result.get(1).get(1)));
  inputBag.clear();
  dt=new DateTime();
  item=TupleFactory.getInstance().newTuple(1);
  item.set(0,dt.getMillis());
  inputBag.add(item);
  item=TupleFactory.getInstance().newTuple(1);
  item.set(0,dt.plusMinutes(31).getMillis());
  inputBag.add(item);
  result=toList(sessionize.exec(input));
  Assert.assertEquals(2,result.size());
  Assert.assertEquals(2,result.get(0).size());
  Assert.assertEquals(2,result.get(1).size());
  Assert.assertFalse(result.get(0).get(1).equals(result.get(1).get(1)));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: datafu.test.pig.sets.SetTests </h4><pre class="type-8 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testIntersectWithNullTuples() throws Exception {
  DataBag one=BagFactory.getInstance().newDefaultBag();
  DataBag two=BagFactory.getInstance().newDefaultBag();
  Tuple input=TupleFactory.getInstance().newTuple(Arrays.asList(one,two));
  DataBag output=new SetIntersect().exec(input);
  Assert.assertEquals(0,output.size());
}

</code></pre>

<br>
<h4 style="margin:0px">Class: datafu.test.pig.stats.EstimationTests </h4><pre class="type-8 type-2 type-7 type-3 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void hyperLogLogTest() throws Exception {
  PigTest test=createPigTestFromString(hyperLogLogTest);
  int count=1000000;
  String[] input=new String[count];
  for (int i=0; i < count; i++) {
    input[i]=Integer.toString(i * 10);
  }
  writeLinesToFile("input",input);
  test.runScript();
  List<Tuple> output=getLinesForAlias(test,"data_out",true);
  assertEquals(output.size(),1);
  double error=Math.abs(count - ((Long)output.get(0).get(0))) / (double)count;
  System.out.println("error: " + error * 100.0 + "%");
  assertTrue(error < 0.01);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: datafu.test.pig.stats.QuantileTests </h4><pre class="type-8 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void quantile5aTest() throws Exception {
  PigTest test=createPigTestFromString(quantileTest,"QUANTILES='10'");
  String[] input={"1","2","3","4","10","5","6","7","8","9"};
  writeLinesToFile("input",input);
  test.runScript();
  List<Tuple> output=getLinesForAlias(test,"data_out",true);
  assertEquals(output.size(),1);
  assertEquals(output.get(0).toString(),"(1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0)");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void quantileParamsTest() throws Exception {
  List<Double> quantiles=QuantileUtil.getQuantilesFromParams("5");
  assertEquals(quantiles.size(),5);
  assertAboutEqual(quantiles.get(0),0.0);
  assertAboutEqual(quantiles.get(1),0.25);
  assertAboutEqual(quantiles.get(2),0.5);
  assertAboutEqual(quantiles.get(3),0.75);
  assertAboutEqual(quantiles.get(4),1.0);
}

</code></pre>

<br>
<pre class="type-8 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void quantileTest() throws Exception {
  PigTest test=createPigTestFromString(quantileTest,"QUANTILES='0.0','0.25','0.5','0.75','1.0'");
  String[] input={"1","2","3","4","10","5","6","7","8","9"};
  writeLinesToFile("input",input);
  test.runScript();
  List<Tuple> output=getLinesForAlias(test,"data_out",true);
  assertEquals(output.size(),1);
  assertEquals(output.get(0).toString(),"(1.0,3.0,5.5,8.0,10.0)");
}

</code></pre>

<br>
<pre class="type-8 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void streamingQuantile7Test() throws Exception {
  PigTest test=createPigTestFromString(streamingQuantileTest,"QUANTILES='4'");
  String[] input={"1","2","3","4","10","5","6","7","8","9"};
  writeLinesToFile("input",input);
  test.runScript();
  List<Tuple> output=getLinesForAlias(test,"data_out",true);
  assertEquals(output.size(),1);
  assertEquals(output.get(0).toString(),"(1.0,4.0,7.0,10.0)");
}

</code></pre>

<br>
<pre class="type-8 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void streamingQuantile6Test() throws Exception {
  PigTest test=createPigTestFromString(streamingQuantileTest,"QUANTILES='0.0','0.333','0.666','1.0'");
  String[] input={"1","2","3","4","10","5","6","7","8","9"};
  writeLinesToFile("input",input);
  test.runScript();
  List<Tuple> output=getLinesForAlias(test,"data_out",true);
  assertEquals(output.size(),1);
  assertEquals(output.get(0).toString(),"(1.0,4.0,7.0,10.0)");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void quantileParamsTest5() throws Exception {
  List<Double> quantiles=QuantileUtil.getQuantilesFromParams("4");
  assertEquals(quantiles.size(),4);
  assertAboutEqual(quantiles.get(0),0.0);
  assertAboutEqual(quantiles.get(1),0.333);
  assertAboutEqual(quantiles.get(2),0.666);
  assertAboutEqual(quantiles.get(3),1.0);
}

</code></pre>

<br>
<pre class="type-8 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void streamingQuantile5bTest() throws Exception {
  PigTest test=createPigTestFromString(streamingQuantileTest,"QUANTILES='0.0','0.111','0.222','0.333','0.444','0.555','0.666','0.777','0.888','1.0'");
  String[] input={"1","2","3","4","10","5","6","7","8","9"};
  writeLinesToFile("input",input);
  test.runScript();
  List<Tuple> output=getLinesForAlias(test,"data_out",true);
  assertEquals(output.size(),1);
  assertEquals(output.get(0).toString(),"(1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0)");
}

</code></pre>

<br>
<pre class="type-8 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void streamingQuantile2Test() throws Exception {
  PigTest test=createPigTestFromString(streamingQuantileTest,"QUANTILES='0.5','0.75','1.0'");
  String[] input={"1","2","3","4","10","5","6","7","8","9"};
  writeLinesToFile("input",input);
  test.runScript();
  List<Tuple> output=getLinesForAlias(test,"data_out",true);
  assertEquals(output.size(),1);
  assertEquals(output.get(0).toString(),"(5.0,8.0,10.0)");
}

</code></pre>

<br>
<pre class="type-8 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void streamingQuantile5aTest() throws Exception {
  PigTest test=createPigTestFromString(streamingQuantileTest,"QUANTILES='10'");
  String[] input={"1","2","3","4","10","5","6","7","8","9"};
  writeLinesToFile("input",input);
  test.runScript();
  List<Tuple> output=getLinesForAlias(test,"data_out",true);
  assertEquals(output.size(),1);
  assertEquals(output.get(0).toString(),"(1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0)");
}

</code></pre>

<br>
<pre class="type-8 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void streamingQuantileTest() throws Exception {
  PigTest test=createPigTestFromString(streamingQuantileTest,"QUANTILES='5'");
  String[] input={"1","2","3","4","10","5","6","7","8","9"};
  writeLinesToFile("input",input);
  test.runScript();
  List<Tuple> output=getLinesForAlias(test,"data_out",true);
  assertEquals(output.size(),1);
  assertEquals(output.get(0).toString(),"(1.0,3.0,5.0,8.0,10.0)");
}

</code></pre>

<br>
<pre class="type-8 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void streamingMedianTest() throws Exception {
  PigTest test=createPigTestFromString(streamingMedianTest);
  String[] input={"0","4","5","6","9","10","7","8","2","3","1"};
  writeLinesToFile("input",input);
  test.runScript();
  List<Tuple> output=getLinesForAlias(test,"data_out",true);
  assertEquals(output.size(),1);
  assertEquals(output.get(0).toString(),"(5.0)");
}

</code></pre>

<br>
<pre class="type-8 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void medianTest() throws Exception {
  PigTest test=createPigTestFromString(medianTest);
  String[] input={"4","5","6","9","10","7","8","2","3","1"};
  writeLinesToFile("input",input);
  test.runScript();
  List<Tuple> output=getLinesForAlias(test,"data_out",true);
  assertEquals(output.size(),1);
  assertEquals(output.get(0).toString(),"(5.5)");
}

</code></pre>

<br>
<pre class="type-8 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void streamingQuantile4Test() throws Exception {
  PigTest test=createPigTestFromString(streamingQuantileTest,"QUANTILES='0.0013','0.0228','0.1587','0.5','0.8413','0.9772','0.9987'");
  List<String> input=new ArrayList<String>();
  for (int i=100000; i >= 0; i--) {
    input.add(Integer.toString(i));
  }
  writeLinesToFile("input",input.toArray(new String[0]));
  test.runScript();
  List<Tuple> output=getLinesForAlias(test,"data_out",true);
  assertEquals(output.size(),1);
  assertEquals(output.get(0).toString(),"(130.0,2280.0,15870.0,50000.0,84130.0,97720.0,99870.0)");
}

</code></pre>

<br>
<pre class="type-8 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void quantileSchemaTest2() throws Exception {
  PigTest test=createPigTestFromString(quantileSchemaTest,"UDF=Quantile","QUANTILES='3'","EXPECTED_OUTPUT=quantiles::quantile_0, " + "quantiles::quantile_1, " + "quantiles::quantile_2");
  String[] input={"1","5","3","4","2"};
  writeLinesToFile("input",input);
  test.runScript();
  List<Tuple> output=getLinesForAlias(test,"data_out",true);
  assertEquals(output.size(),1);
  assertEquals(output.get(0).toString(),"(1.0,3.0,5.0)");
}

</code></pre>

<br>
<pre class="type-8 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void streamingQuantile3Test() throws Exception {
  PigTest test=createPigTestFromString(streamingQuantileTest,"QUANTILES='0.07','0.03','0.37','1.0','0.0'");
  List<String> input=new ArrayList<String>();
  for (int i=1000; i >= 1; i--) {
    input.add(Integer.toString(i));
  }
  writeLinesToFile("input",input.toArray(new String[0]));
  test.runScript();
  List<Tuple> output=getLinesForAlias(test,"data_out",true);
  assertEquals(output.size(),1);
  assertEquals(output.get(0).toString(),"(70.0,30.0,370.0,1000.0,1.0)");
}

</code></pre>

<br>
<pre class="type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void streamingQuantileAccumulateTest() throws Exception {
  StreamingQuantile quantile=new StreamingQuantile("4");
  Tuple result;
  for (int i=1; i <= 10; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(1);
    t.set(0,i);
    DataBag bag=BagFactory.getInstance().newDefaultBag();
    bag.add(t);
    Tuple input=TupleFactory.getInstance().newTuple(bag);
    quantile.accumulate(input);
  }
  result=quantile.getValue();
  Assert.assertEquals(4,result.size());
  Assert.assertEquals(1.0,result.get(0));
  Assert.assertEquals(4.0,result.get(1));
  Assert.assertEquals(7.0,result.get(2));
  Assert.assertEquals(10.0,result.get(3));
  quantile.cleanup();
  for (int i=11; i <= 20; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(1);
    t.set(0,i);
    DataBag bag=BagFactory.getInstance().newDefaultBag();
    bag.add(t);
    Tuple input=TupleFactory.getInstance().newTuple(bag);
    quantile.accumulate(input);
  }
  result=quantile.getValue();
  Assert.assertEquals(4,result.size());
  Assert.assertEquals(11.0,result.get(0));
  Assert.assertEquals(14.0,result.get(1));
  Assert.assertEquals(17.0,result.get(2));
  Assert.assertEquals(20.0,result.get(3));
}

</code></pre>

<br>
<pre class="type-8 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void quantile5bTest() throws Exception {
  PigTest test=createPigTestFromString(quantileTest,"QUANTILES='0.0','0.111','0.222','0.333','0.444','0.555','0.666','0.777','0.888','1.0'");
  String[] input={"1","2","3","4","10","5","6","7","8","9"};
  writeLinesToFile("input",input);
  test.runScript();
  List<Tuple> output=getLinesForAlias(test,"data_out",true);
  assertEquals(output.size(),1);
  assertEquals(output.get(0).toString(),"(1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0)");
}

</code></pre>

<br>
<pre class="type-8 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void quantileSchemaTest() throws Exception {
  PigTest test=createPigTestFromString(quantileSchemaTest,"UDF=Quantile","QUANTILES='0.0','0.5','1.0'","EXPECTED_OUTPUT=quantiles::quantile_0_0, " + "quantiles::quantile_0_5, " + "quantiles::quantile_1_0");
  String[] input={"1","5","3","4","2"};
  writeLinesToFile("input",input);
  test.runScript();
  List<Tuple> output=getLinesForAlias(test,"data_out",true);
  assertEquals(output.size(),1);
  assertEquals(output.get(0).toString(),"(1.0,3.0,5.0)");
}

</code></pre>

<br>
<pre class="type-8 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void quantile4aTest() throws Exception {
  PigTest test=createPigTestFromString(quantileTest,"QUANTILES='4'");
  String[] input={"1","2","3","4","10","5","6","7","8","9"};
  writeLinesToFile("input",input);
  test.runScript();
  List<Tuple> output=getLinesForAlias(test,"data_out",true);
  assertEquals(output.size(),1);
  assertEquals(output.get(0).toString(),"(1.0,4.0,7.0,10.0)");
}

</code></pre>

<br>
<pre class="type-8 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void quantileSchemaTest3() throws Exception {
  PigTest test=createPigTestFromString(quantileSchemaTest,"UDF=StreamingQuantile","QUANTILES='0.0','0.5','1.0'","EXPECTED_OUTPUT=quantiles::quantile_0_0, " + "quantiles::quantile_0_5, " + "quantiles::quantile_1_0");
  String[] input={"1","5","3","4","2"};
  writeLinesToFile("input",input);
  test.runScript();
  List<Tuple> output=getLinesForAlias(test,"data_out",true);
  assertEquals(output.size(),1);
  assertEquals(output.get(0).toString(),"(1.0,3.0,5.0)");
}

</code></pre>

<br>
<pre class="type-8 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void streamingQuantileExecTest() throws Exception {
  StreamingQuantile quantile=new StreamingQuantile("4");
  DataBag bag;
  Tuple input;
  Tuple result;
  bag=BagFactory.getInstance().newDefaultBag();
  for (int i=1; i <= 10; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(1);
    t.set(0,i);
    bag.add(t);
  }
  input=TupleFactory.getInstance().newTuple(bag);
  result=quantile.exec(input);
  Assert.assertEquals(4,result.size());
  Assert.assertEquals(1.0,result.get(0));
  Assert.assertEquals(4.0,result.get(1));
  Assert.assertEquals(7.0,result.get(2));
  Assert.assertEquals(10.0,result.get(3));
  bag=BagFactory.getInstance().newDefaultBag();
  for (int i=11; i <= 20; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(1);
    t.set(0,i);
    bag.add(t);
  }
  input=TupleFactory.getInstance().newTuple(bag);
  result=quantile.exec(input);
  Assert.assertEquals(4,result.size());
  Assert.assertEquals(11.0,result.get(0));
  Assert.assertEquals(14.0,result.get(1));
  Assert.assertEquals(17.0,result.get(2));
  Assert.assertEquals(20.0,result.get(3));
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void quantileParamsTest2() throws Exception {
  List<Double> quantiles=QuantileUtil.getQuantilesFromParams("2");
  assertEquals(quantiles.size(),2);
  assertAboutEqual(quantiles.get(0),0.0);
  assertAboutEqual(quantiles.get(1),1.0);
}

</code></pre>

<br>
<pre class="type-8 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void quantileSchemaTest4() throws Exception {
  PigTest test=createPigTestFromString(quantileSchemaTest,"UDF=StreamingQuantile","QUANTILES='3'","EXPECTED_OUTPUT=quantiles::quantile_0, " + "quantiles::quantile_1, " + "quantiles::quantile_2");
  String[] input={"1","5","3","4","2"};
  writeLinesToFile("input",input);
  test.runScript();
  List<Tuple> output=getLinesForAlias(test,"data_out",true);
  assertEquals(output.size(),1);
  assertEquals(output.get(0).toString(),"(1.0,3.0,5.0)");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void quantileParamsTest4() throws Exception {
  List<Double> quantiles=QuantileUtil.getQuantilesFromParams("10");
  assertEquals(quantiles.size(),10);
  assertAboutEqual(quantiles.get(0),0.0);
  assertAboutEqual(quantiles.get(1),0.11111);
  assertAboutEqual(quantiles.get(2),0.22222);
  assertAboutEqual(quantiles.get(3),0.33333);
  assertAboutEqual(quantiles.get(4),0.44444);
  assertAboutEqual(quantiles.get(5),0.55555);
  assertAboutEqual(quantiles.get(6),0.66666);
  assertAboutEqual(quantiles.get(7),0.77777);
  assertAboutEqual(quantiles.get(8),0.88888);
  assertAboutEqual(quantiles.get(9),1.0);
}

</code></pre>

<br>
<pre class="type-8 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void quantile4bTest() throws Exception {
  PigTest test=createPigTestFromString(quantileTest,"QUANTILES='0.0','0.333','0.666','1.0'");
  String[] input={"1","2","3","4","10","5","6","7","8","9"};
  writeLinesToFile("input",input);
  test.runScript();
  List<Tuple> output=getLinesForAlias(test,"data_out",true);
  assertEquals(output.size(),1);
  assertEquals(output.get(0).toString(),"(1.0,4.0,7.0,10.0)");
}

</code></pre>

<br>
<pre class="type-8 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void quantile3Test() throws Exception {
  PigTest test=createPigTestFromString(quantileTest,"QUANTILES='0.0013','0.0228','0.1587','0.5','0.8413','0.9772','0.9987'");
  List<String> input=new ArrayList<String>();
  for (int i=100000; i >= 0; i--) {
    input.add(Integer.toString(i));
  }
  writeLinesToFile("input",input.toArray(new String[0]));
  test.runScript();
  List<Tuple> output=getLinesForAlias(test,"data_out",true);
  assertEquals(output.size(),1);
  assertEquals(output.get(0).toString(),"(130.0,2280.0,15870.0,50000.0,84130.0,97720.0,99870.0)");
}

</code></pre>

<br>
<pre class="type-8 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void quantile2Test() throws Exception {
  PigTest test=createPigTestFromString(quantileTest,"QUANTILES='5'");
  String[] input={"1","2","3","4","10","5","6","7","8","9"};
  writeLinesToFile("input",input);
  test.runScript();
  List<Tuple> output=getLinesForAlias(test,"data_out",true);
  assertEquals(output.size(),1);
  assertEquals(output.get(0).toString(),"(1.0,3.0,5.5,8.0,10.0)");
}

</code></pre>

<br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void quantileParamsTest3() throws Exception {
  List<Double> quantiles=QuantileUtil.getQuantilesFromParams("11");
  assertEquals(quantiles.size(),11);
  assertAboutEqual(quantiles.get(0),0.0);
  assertAboutEqual(quantiles.get(1),0.1);
  assertAboutEqual(quantiles.get(2),0.2);
  assertAboutEqual(quantiles.get(3),0.3);
  assertAboutEqual(quantiles.get(4),0.4);
  assertAboutEqual(quantiles.get(5),0.5);
  assertAboutEqual(quantiles.get(6),0.6);
  assertAboutEqual(quantiles.get(7),0.7);
  assertAboutEqual(quantiles.get(8),0.8);
  assertAboutEqual(quantiles.get(9),0.9);
  assertAboutEqual(quantiles.get(10),1.0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: datafu.test.pig.stats.VARTests </h4><pre class="type-8 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void varTestDouble() throws Exception {
  PigTest test=createPigTestFromString(varTest,"VAL_TYPE=double");
  String[] input={"1.0","2.0","3.0","4.0","10.0","5.0","6.0","7.0","8.0","9.0"};
  writeLinesToFile("input",input);
  test.runScript();
  List<Tuple> output=getLinesForAlias(test,"data_out",true);
  assertEquals(output.size(),1);
  assertEquals(output.get(0).toString(),"(8.25)");
}

</code></pre>

<br>
<pre class="type-8 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void varTestZeroData() throws Exception {
  PigTest test=createPigTestFromString(varTest,"VAL_TYPE=long");
  String[] input={};
  writeLinesToFile("input",input);
  test.runScript();
  List<Tuple> output=getLinesForAlias(test,"data_out",true);
  assertEquals(output.size(),0);
}

</code></pre>

<br>
<pre class="type-8 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void varTestOneData() throws Exception {
  PigTest test=createPigTestFromString(varTest,"VAL_TYPE=double");
  String[] input={"5.0"};
  writeLinesToFile("input",input);
  test.runScript();
  List<Tuple> output=getLinesForAlias(test,"data_out",true);
  assertEquals(output.size(),1);
  assertEquals(output.get(0).toString(),"(0.0)");
}

</code></pre>

<br>
<pre class="type-8 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void varTestByteArray() throws Exception {
  PigTest test=createPigTestFromString(varTest,"VAL_TYPE=bytearray");
  String[] input={"1","2","3","4","10","5","6","7","8","9"};
  writeLinesToFile("input",input);
  test.runScript();
  List<Tuple> output=getLinesForAlias(test,"data_out",true);
  assertEquals(output.size(),1);
  assertEquals(output.get(0).toString(),"(8.25)");
}

</code></pre>

<br>
<pre class="type-8 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void varTestNullEntry() throws Exception {
  PigTest test=createPigTestFromString(varTest,"VAL_TYPE=double");
  String[] input={"1","2","3","4","10","5","6","7","8","9","null"};
  writeLinesToFile("input",input);
  test.runScript();
  List<Tuple> output=getLinesForAlias(test,"data_out",true);
  assertEquals(output.size(),1);
  assertEquals(output.get(0).toString(),"(8.25)");
}

</code></pre>

<br>
<pre class="type-8 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void varTestInteger() throws Exception {
  PigTest test=createPigTestFromString(varTest,"VAL_TYPE=int");
  String[] input={"1","2","3","4","10","5","6","7","8","9"};
  writeLinesToFile("input",input);
  test.runScript();
  List<Tuple> output=getLinesForAlias(test,"data_out",true);
  assertEquals(output.size(),1);
  assertEquals(output.get(0).toString(),"(8.25)");
}

</code></pre>

<br>
<pre class="type-8 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void varTestFloat() throws Exception {
  PigTest test=createPigTestFromString(varTest,"VAL_TYPE=float");
  String[] input={"1.0","2.0","3.0","4.0","10.0","5.0","6.0","7.0","8.0","9.0"};
  writeLinesToFile("input",input);
  test.runScript();
  List<Tuple> output=getLinesForAlias(test,"data_out",true);
  assertEquals(output.size(),1);
  assertEquals(output.get(0).toString(),"(8.25)");
}

</code></pre>

<br>
<pre class="type-8 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void varTestLong() throws Exception {
  PigTest test=createPigTestFromString(varTest,"VAL_TYPE=long");
  String[] input={"1","2","3","4","10","5","6","7","8","9"};
  writeLinesToFile("input",input);
  test.runScript();
  List<Tuple> output=getLinesForAlias(test,"data_out",true);
  assertEquals(output.size(),1);
  assertEquals(output.get(0).toString(),"(8.25)");
}

</code></pre>

<br>
<pre class="type-8 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void varTestNullEntries() throws Exception {
  PigTest test=createPigTestFromString(varTest,"VAL_TYPE=float");
  String[] input={"1","2","3","4","10","5","6","7","8","9","null","null"};
  writeLinesToFile("input",input);
  test.runScript();
  List<Tuple> output=getLinesForAlias(test,"data_out",true);
  assertEquals(output.size(),1);
  assertEquals(output.get(0).toString(),"(8.25)");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: datafu.test.pig.stats.WilsonBinConfTests </h4><pre class="type-8 type-2 type-7 type-3 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void wilsonTest() throws Exception {
  PigTest test=createPigTestFromString(wilsonBinConf,"alpha=0.05");
  writeLinesToFile("input","1\t1","1\t2","50\t100","500\t1000","999\t1000","1000\t1000","998\t1000");
  test.runScript();
  List<String> expectedOutput=new ArrayList<String>();
  expectedOutput.add("0.05129,1.00000");
  expectedOutput.add("0.02565,0.97435");
  expectedOutput.add("0.40383,0.59617");
  expectedOutput.add("0.46907,0.53093");
  expectedOutput.add("0.99436,0.99995");
  expectedOutput.add("0.99617,1.00000");
  expectedOutput.add("0.99274,0.99945");
  List<Tuple> output=this.getLinesForAlias(test,"data_out");
  Iterator<String> expectationIterator=expectedOutput.iterator();
  for (  Tuple t : output) {
    assertTrue(expectationIterator.hasNext());
    Double lower=(Double)t.get(0);
    Double upper=(Double)t.get(1);
    assertEquals(String.format("%.5f,%.5f",lower,upper),expectationIterator.next());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: datafu.test.pig.urls.URLInfoTest </h4><pre class="type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void urlInfoTest() throws Exception {
  PigTest test=createPigTestFromString(urlInfoTest);
  String[] input={"1|http://roger.bar.com/marketing/brand.html?x=foo|(bar.com,roger.bar.com,http,/marketing/brand.html,)|[x#foo]","2|https://hello.world.org:90/products/data/data.html|(world.org,hello.world.org,https,/products/data/data.html,90)|)","3|ftp://roger.bar.com/eng/hello.jsp?x=foo&y=bar|(bar.com,roger.bar.com,ftp,/eng/hello.jsp,)|[x#foo,y#bar])","4|http://hello.world.org:90/products/data/data.html|(world.org,hello.world.org,http,/products/data/data.html,90)|)","5|http://roger.bar.com/eng/hello.jsp?x=foo&y=bar&x=baz|(bar.com,roger.bar.com,http,/eng/hello.jsp,)|[x#foo,y#bar])"};
  writeLinesToFile("input",input);
  test.runScript();
  for (  Tuple t : getLinesForAlias(test,"data_out")) {
    System.out.println("Validating case " + t.get(0));
    Tuple actual=(Tuple)t.get(1);
    Tuple expected=(Tuple)t.get(2);
    assertEquals(actual.get(0),expected.get(0));
    assertEquals(actual.get(1),expected.get(1));
    assertEquals(actual.get(2),expected.get(2));
    assertEquals(actual.get(3),expected.get(3));
    assertEquals(actual.get(4),expected.get(4));
    assertEquals(actual.get(5),t.get(3));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: datafu.test.pig.util.AliasEvalFuncTest </h4><pre class="type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void getBagTest() throws Exception {
  ReportBuilder udf=new ReportBuilder();
  udf.setUDFContextSignature("test");
  List<Schema.FieldSchema> fieldSchemaList=new ArrayList<Schema.FieldSchema>();
  fieldSchemaList.add(new Schema.FieldSchema("msisdn",DataType.LONG));
  fieldSchemaList.add(new Schema.FieldSchema("ts",DataType.INTEGER));
  fieldSchemaList.add(new Schema.FieldSchema("center_lon",DataType.DOUBLE));
  fieldSchemaList.add(new Schema.FieldSchema("center_lat",DataType.DOUBLE));
  Schema schemaTuple=new Schema(fieldSchemaList);
  Schema schemaBag=new Schema(new Schema.FieldSchema(ReportBuilder.ORDERED_ROUTES,schemaTuple,DataType.BAG));
  udf.outputSchema(schemaBag);
  Tuple inputTuple=TupleFactory.getInstance().newTuple();
  DataBag inputBag=BagFactory.getInstance().newDefaultBag();
  inputBag.add(TupleFactory.getInstance().newTuple(Arrays.asList(71230000000L,1382351612,10.697,20.713)));
  inputTuple.append(inputBag);
  DataBag outputBag=udf.exec(inputTuple);
  Assert.assertEquals(inputBag,outputBag);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: datafu.test.pig.util.AssertTests </h4><pre class="type-8 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void shouldNotAssertWithoutMessageOnOne() throws Exception {
  PigTest test=createPigTestFromString(assertWithoutMessage);
  this.writeLinesToFile("input","1");
  test.runScript();
  List<Tuple> result=this.getLinesForAlias(test,"data2");
  Assert.assertEquals(result.size(),1);
  Assert.assertEquals(result.get(0).size(),1);
  Assert.assertEquals(result.get(0).get(0),1);
}

</code></pre>

<br>
<pre class="type-8 type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void shouldNotAssertWithMessageOnOne() throws Exception {
  PigTest test=createPigTestFromString(assertWithMessage);
  this.writeLinesToFile("input","1");
  test.runScript();
  List<Tuple> result=this.getLinesForAlias(test,"data2");
  Assert.assertEquals(result.size(),1);
  Assert.assertEquals(result.get(0).size(),1);
  Assert.assertEquals(result.get(0).get(0),1);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: datafu.test.pig.util.CoalesceTests </h4><pre class="type-8 type-11 type-10 type-7 type-6 type-3 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void coalesceCastIntToDatetimeLazyTest() throws Exception {
  PigTest test=createPigTestFromString(coalesceCastIntToDatetimeLazyTest);
  this.writeLinesToFile("input","1,1375826183000","2,");
  test.runScript();
  List<Tuple> lines=this.getLinesForAlias(test,"data3");
  Assert.assertEquals(2,lines.size());
  for (  Tuple t : lines) {
    Integer testcase=(Integer)t.get(0);
    Assert.assertNotNull(testcase);
switch (testcase) {
case 1:
      Assert.assertEquals("2013-08-06T21:56:23.000Z",((DateTime)t.get(1)).toDateTime(DateTimeZone.UTC).toString());
    break;
case 2:
  Assert.assertEquals("1970-01-01T00:00:00.000Z",t.get(1).toString());
break;
default :
Assert.fail("Did not expect: " + t.get(1));
}
}
}

</code></pre>

<br>
<pre class="type-8 type-11 type-10 type-7 type-3 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void coalesceLongTest() throws Exception {
  PigTest test=createPigTestFromString(coalesceLongTest);
  this.writeLinesToFile("input","1,5","2,");
  test.runScript();
  List<Tuple> lines=this.getLinesForAlias(test,"data4");
  Assert.assertEquals(2,lines.size());
  for (  Tuple t : lines) {
switch ((Integer)t.get(0)) {
case 1:
      Assert.assertEquals(500L,t.get(1));
    break;
case 2:
  Assert.assertEquals(10000L,t.get(1));
break;
default :
Assert.fail("Did not expect: " + t.get(1));
}
}
}

</code></pre>

<br>
<pre class="type-8 type-11 type-10 type-7 type-3 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void coalesceIntTest() throws Exception {
  PigTest test=createPigTestFromString(coalesceIntTest);
  this.writeLinesToFile("input","1,1,2,3","2,,2,3","3,,,3","4,,,","5,1,,3","6,1,,");
  test.runScript();
  List<Tuple> lines=this.getLinesForAlias(test,"data3");
  Assert.assertEquals(6,lines.size());
  for (  Tuple t : lines) {
switch ((Integer)t.get(0)) {
case 1:
      Assert.assertEquals(1,t.get(1));
    break;
case 2:
  Assert.assertEquals(2,t.get(1));
break;
case 3:
Assert.assertEquals(3,t.get(1));
break;
case 4:
Assert.assertEquals(null,t.get(1));
break;
case 5:
Assert.assertEquals(1,t.get(1));
break;
case 6:
Assert.assertEquals(1,t.get(1));
break;
default :
Assert.fail("Did not expect: " + t.get(1));
}
}
}

</code></pre>

<br>
<pre class="type-8 type-11 type-10 type-7 type-6 type-3 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void coalesceCastIntToDatetimeTest() throws Exception {
  PigTest test=createPigTestFromString(coalesceCastIntToDatetimeTest);
  this.writeLinesToFile("input","1,1375826183000","2,");
  test.runScript();
  List<Tuple> lines=this.getLinesForAlias(test,"data3");
  Assert.assertEquals(2,lines.size());
  for (  Tuple t : lines) {
    Integer testcase=(Integer)t.get(0);
    Assert.assertNotNull(testcase);
switch (testcase) {
case 1:
      Assert.assertEquals("2013-08-06T21:56:23.000Z",((DateTime)t.get(1)).toDateTime(DateTimeZone.UTC).toString());
    break;
case 2:
  Assert.assertEquals("1970-01-01T00:00:00.000Z",t.get(1).toString());
break;
default :
Assert.fail("Did not expect: " + t.get(1));
}
}
}

</code></pre>

<br>
<pre class="type-8 type-11 type-10 type-7 type-3 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void coalesceCastIntToLongTest2() throws Exception {
  PigTest test=createPigTestFromString(coalesceIntAndLongTest2);
  this.writeLinesToFile("input","1,5","2,");
  test.runScript();
  List<Tuple> lines=this.getLinesForAlias(test,"data4");
  Assert.assertEquals(2,lines.size());
  for (  Tuple t : lines) {
switch ((Integer)t.get(0)) {
case 1:
      Assert.assertEquals(500L,t.get(1));
    break;
case 2:
  Assert.assertEquals(10000L,t.get(1));
break;
default :
Assert.fail("Did not expect: " + t.get(1));
}
}
}

</code></pre>

<br>
<pre class="type-8 type-11 type-10 type-7 type-3 type-12 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expectedExceptions=FrontendException.class) public void coalesceCastIntToLongTestFails() throws Exception {
  PigTest test=createPigTestFromString(coalesceCastIntToLongTestFails);
  this.writeLinesToFile("input","1,5","2,");
  test.runScript();
  List<Tuple> lines=this.getLinesForAlias(test,"data4");
  Assert.assertEquals(2,lines.size());
  for (  Tuple t : lines) {
switch ((Integer)t.get(0)) {
case 1:
      Assert.assertEquals(500L,t.get(1));
    break;
case 2:
  Assert.assertEquals(10000L,t.get(1));
break;
default :
Assert.fail("Did not expect: " + t.get(1));
}
}
}

</code></pre>

<br>
<pre class="type-8 type-11 type-10 type-7 type-3 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void leftJoinTest() throws Exception {
  PigTest test=createPigTestFromString(leftJoinTest);
  this.writeLinesToFile("input1","1,1","2,2","5,5");
  this.writeLinesToFile("input2","1,10","3,30","5,50");
  this.writeLinesToFile("input3","2,100","5,500");
  test.runScript();
  List<Tuple> lines=this.getLinesForAlias(test,"data5");
  Assert.assertEquals(3,lines.size());
  for (  Tuple t : lines) {
switch ((Integer)t.get(0)) {
case 1:
      Assert.assertEquals(10L,t.get(1));
    Assert.assertEquals(0L,t.get(2));
  break;
case 2:
Assert.assertEquals(0L,t.get(1));
Assert.assertEquals(100L,t.get(2));
break;
case 5:
Assert.assertEquals(50L,t.get(1));
Assert.assertEquals(500L,t.get(2));
break;
default :
Assert.fail("Did not expect: " + t.get(0));
}
}
}

</code></pre>

<br>
<pre class="type-8 type-11 type-10 type-7 type-3 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void coalesceCastIntToLongTest1() throws Exception {
  PigTest test=createPigTestFromString(coalesceIntAndLongTest);
  this.writeLinesToFile("input","1,5","2,");
  test.runScript();
  List<Tuple> lines=this.getLinesForAlias(test,"data4");
  Assert.assertEquals(2,lines.size());
  for (  Tuple t : lines) {
switch ((Integer)t.get(0)) {
case 1:
      Assert.assertEquals(500L,t.get(1));
    break;
case 2:
  Assert.assertEquals(10000L,t.get(1));
break;
default :
Assert.fail("Did not expect: " + t.get(1));
}
}
}

</code></pre>

<br>
<pre class="type-8 type-11 type-10 type-7 type-3 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void coalesceCastIntToDoubleTest() throws Exception {
  PigTest test=createPigTestFromString(coalesceIntAndDoubleTest);
  this.writeLinesToFile("input","1,5","2,");
  test.runScript();
  List<Tuple> lines=this.getLinesForAlias(test,"data4");
  Assert.assertEquals(2,lines.size());
  for (  Tuple t : lines) {
switch ((Integer)t.get(0)) {
case 1:
      Assert.assertEquals(500.0,t.get(1));
    break;
case 2:
  Assert.assertEquals(10000.0,t.get(1));
break;
default :
Assert.fail("Did not expect: " + t.get(1));
}
}
}

</code></pre>

<br>
<h4 style="margin:0px">Class: datafu.test.pig.util.TransposeTest </h4><pre class="type-7 type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void transposeTest() throws Exception {
  PigTest test=createPigTestFromString(transposeTest);
  writeLinesToFile("input","1,10,11,12","2,20,21,22");
  test.runScript();
  List<Tuple> output=getLinesForAlias(test,"data3");
  for (  Tuple tuple : output) {
    int testCase=(Integer)tuple.get(0);
    DataBag bag=(DataBag)tuple.get(1);
    Assert.assertEquals(bag.size(),3);
    int i=0;
    for (    Tuple t : bag) {
      String expectedKey=String.format("val%d",i + 1);
      Assert.assertEquals((String)t.get(0),expectedKey);
      int actualValue=(Integer)t.get(1);
      Assert.assertEquals(actualValue,testCase * 10 + i);
      i++;
    }
  }
}

</code></pre>

<br>
<pre class="type-7 type-3 type-12 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expectedExceptions={org.apache.pig.impl.logicalLayer.FrontendException.class}) public void transposeBadTypeTest() throws Exception {
  PigTest test=createPigTestFromString(transposeBadTypeTest);
  writeLinesToFile("input","1,10,11,12.0","2,20,21,22.0");
  test.runScript();
  List<Tuple> output=getLinesForAlias(test,"data3");
  for (  Tuple tuple : output) {
    int testCase=(Integer)tuple.get(0);
    DataBag bag=(DataBag)tuple.get(1);
    Assert.assertEquals(bag.size(),3);
    int i=0;
    for (    Tuple t : bag) {
      String expectedKey=String.format("val%d",i + 1);
      Assert.assertEquals((String)t.get(0),expectedKey);
      int actualValue=(Integer)t.get(1);
      Assert.assertEquals(actualValue,testCase * 10 + i);
      i++;
    }
  }
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
