<h3><span class=" glyphicon glyphicon-tag"/>&nbspExceptionVerifier</h3><kbd>Verifies that exceptions are thrown during the test case execution</kbd><br><br><br><h4 style="margin:0px">Class: datafu.test.pig.bags.ZipBagsTests </h4><pre class="type-12 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expectedExceptions=FrontendException.class) public void duplicateAliasTest() throws Exception {
  PigTest test=createPigTestFromString(duplicateAliasTest);
  writeLinesToFile("input","{(1,2),(3,4),(5,6)}\t{(7,8),(9,10),(11,12)}");
  test.runScript();
}

</code></pre>

<br>
<pre class="type-12 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expectedExceptions=FrontendException.class) public void zipUnevenBagsExceptionTest() throws Exception {
  PigTest test=createPigTestFromString(zipBagsTest);
  writeLinesToFile("input","{(1,2),(3,4),(5,6),(20,40)}\t{(7,8),(9,10)}");
  test.runScript();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: datafu.test.pig.sets.SetTests </h4><pre class="type-12 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expectedExceptions=org.apache.pig.impl.logicalLayer.FrontendException.class) public void setIntersectOutOfOrderTest() throws Exception {
  PigTest test=createPigTestFromString(setIntersectTest);
  this.writeLinesToFile("input","{(1,10),(3,30),(2,20),(4,40),(5,50),(6,60)}\t{(0,0),(2,20),(4,40),(8,80)}");
  test.runScript();
  this.getLinesForAlias(test,"data2");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: datafu.test.pig.util.CoalesceTests </h4><pre class="type-12 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expectedExceptions=FrontendException.class) public void coalesceBagIncompatibleTypeTest() throws Exception {
  PigTest test=createPigTestFromString(coalesceBagIncompatibleTypeTest);
  this.writeLinesToFile("input","1,1,2L}");
  test.runScript();
  this.getLinesForAlias(test,"data3");
}

</code></pre>

<br>
<pre class="type-8 type-11 type-10 type-7 type-3 type-12 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expectedExceptions=FrontendException.class) public void coalesceCastIntToLongTestFails() throws Exception {
  PigTest test=createPigTestFromString(coalesceCastIntToLongTestFails);
  this.writeLinesToFile("input","1,5","2,");
  test.runScript();
  List<Tuple> lines=this.getLinesForAlias(test,"data4");
  Assert.assertEquals(2,lines.size());
  for (  Tuple t : lines) {
switch ((Integer)t.get(0)) {
case 1:
      Assert.assertEquals(500L,t.get(1));
    break;
case 2:
  Assert.assertEquals(10000L,t.get(1));
break;
default :
Assert.fail("Did not expect: " + t.get(1));
}
}
}

</code></pre>

<br>
<h4 style="margin:0px">Class: datafu.test.pig.util.TransposeTest </h4><pre class="type-7 type-3 type-12 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Verifies that exceptions are thrown during the test case execution
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test(expectedExceptions={org.apache.pig.impl.logicalLayer.FrontendException.class}) public void transposeBadTypeTest() throws Exception {
  PigTest test=createPigTestFromString(transposeBadTypeTest);
  writeLinesToFile("input","1,10,11,12.0","2,20,21,22.0");
  test.runScript();
  List<Tuple> output=getLinesForAlias(test,"data3");
  for (  Tuple tuple : output) {
    int testCase=(Integer)tuple.get(0);
    DataBag bag=(DataBag)tuple.get(1);
    Assert.assertEquals(bag.size(),3);
    int i=0;
    for (    Tuple t : bag) {
      String expectedKey=String.format("val%d",i + 1);
      Assert.assertEquals((String)t.get(0),expectedKey);
      int actualValue=(Integer)t.get(1);
      Assert.assertEquals(actualValue,testCase * 10 + i);
      i++;
    }
  }
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
