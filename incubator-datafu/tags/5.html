<h3><span class=" glyphicon glyphicon-tag"/>&nbspExecutionTester</h3><kbd>Executes methods or other tests from the same test unit</kbd><br><br><br><h4 style="margin:0px">Class: datafu.hourglass.demo.Examples </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void countByMember() throws IOException, InterruptedException, ClassNotFoundException {
  openDayForEvent(2013,3,15);
  storeIds(1,1,1);
  storeIds(2);
  storeIds(3,3);
  closeDayForEvent();
  openDayForEvent(2013,3,16);
  storeIds(1,1);
  storeIds(2,2);
  storeIds(3);
  closeDayForEvent();
  new CountById().run(createJobConf(),getDataPath() + "/data/event",getDataPath() + "/output");
  checkOutputFolderCount(new Path(getDataPath(),"output"),1);
  HashMap<Long,Integer> counts=loadOutputCounts(new Path(getDataPath(),"output"),"20130316");
  checkSize(counts,3);
  checkIdCount(counts,1,5);
  checkIdCount(counts,2,3);
  checkIdCount(counts,3,3);
  openDayForEvent(2013,3,17);
  storeIds(1,1);
  storeIds(2,2,2);
  storeIds(3,3);
  closeDayForEvent();
  new CountById().run(createJobConf(),getDataPath() + "/data/event",getDataPath() + "/output");
  counts=loadOutputCounts(new Path(getDataPath(),"output"),"20130317");
  checkSize(counts,3);
  checkIdCount(counts,1,7);
  checkIdCount(counts,2,6);
  checkIdCount(counts,3,5);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: datafu.hourglass.test.PartitionCollapsingExecutionPlannerTests </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Tests that the most recent data is used. 
 * @throws IOException
 * @throws InterruptedException
 * @throws ClassNotFoundException
 */
@Test public void latestThreeDays() throws IOException, InterruptedException, ClassNotFoundException {
  _numDays=3;
  createInput(2012,10,1);
  createInput(2012,10,2);
  createInput(2012,10,3);
  createInput(2012,10,4);
  createPlan();
  checkInputSize(3);
  checkForInput(2012,10,2);
  checkForInput(2012,10,3);
  checkForInput(2012,10,4);
  checkNewInputSize(3);
  checkForNewInput(2012,10,2);
  checkForNewInput(2012,10,3);
  checkForNewInput(2012,10,4);
  checkOldInputSize(0);
  checkReusingOutput(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Tests that the previous output can be reused, even when there are two new days since the previous
 * result.
 * @throws IOException
 * @throws InterruptedException
 * @throws ClassNotFoundException
 */
@Test public void previousOutputReuse() throws IOException, InterruptedException, ClassNotFoundException {
  _numDays=8;
  _reusePreviousOutput=true;
  createInput(2012,10,1);
  createInput(2012,10,2);
  createInput(2012,10,3);
  createInput(2012,10,4);
  createInput(2012,10,5);
  createInput(2012,10,6);
  createInput(2012,10,7);
  createInput(2012,10,8);
  createInput(2012,10,9);
  createInput(2012,10,10);
  createOutput(new DateRange(getDate(2012,10,1),getDate(2012,10,8)));
  createPlan();
  checkNewInputSize(2);
  checkForNewInput(2012,10,9);
  checkForNewInput(2012,10,10);
  checkOldInputSize(2);
  checkForOldInput(2012,10,1);
  checkForOldInput(2012,10,2);
  checkInputSize(4);
  checkForInput(2012,10,1);
  checkForInput(2012,10,2);
  checkForInput(2012,10,9);
  checkForInput(2012,10,10);
  checkReusingOutput(true);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Tests that the previous output won't be reused when it is too old.  This would require subtracting off
 * all the old input data, then adding the new data.  It is better to just use the new data and not reuse
 * the previous output.
 * @throws IOException
 * @throws InterruptedException
 * @throws ClassNotFoundException
 */
@Test public void previousOutputNoReuseTooOld() throws IOException, InterruptedException, ClassNotFoundException {
  _numDays=8;
  _reusePreviousOutput=true;
  for (int i=1; i <= 20; i++) {
    createInput(2012,10,i);
  }
  createOutput(new DateRange(getDate(2012,10,1),getDate(2012,10,8)));
  createPlan();
  checkNewInputSize(8);
  for (int i=13; i <= 20; i++) {
    checkForNewInput(2012,10,i);
  }
  checkOldInputSize(0);
  checkInputSize(8);
  for (int i=13; i <= 20; i++) {
    checkForInput(2012,10,i);
  }
  checkReusingOutput(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void exactlyThreeDays() throws IOException, InterruptedException, ClassNotFoundException {
  _numDays=3;
  createInput(2012,10,1);
  createInput(2012,10,2);
  createInput(2012,10,3);
  createPlan();
  checkInputSize(3);
  checkForInput(2012,10,1);
  checkForInput(2012,10,2);
  checkForInput(2012,10,3);
  checkNewInputSize(3);
  checkForNewInput(2012,10,1);
  checkForNewInput(2012,10,2);
  checkForNewInput(2012,10,3);
  checkOldInputSize(0);
  checkReusingOutput(false);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Tests that the previous output will not be reused when the window size is small.
 * It is more work to reuse the previous output in this case because the old input has
 * to be subtracted from the previous result.
 * @throws IOException
 * @throws InterruptedException
 * @throws ClassNotFoundException
 */
@Test public void previousOutputNoReuseSmallWindow() throws IOException, InterruptedException, ClassNotFoundException {
  _numDays=2;
  _reusePreviousOutput=true;
  createInput(2012,10,1);
  createInput(2012,10,2);
  createInput(2012,10,3);
  createOutput(new DateRange(getDate(2012,10,1),getDate(2012,10,2)));
  createPlan();
  checkNewInputSize(2);
  checkForNewInput(2012,10,2);
  checkForNewInput(2012,10,3);
  checkOldInputSize(0);
  checkInputSize(2);
  checkForInput(2012,10,2);
  checkForInput(2012,10,3);
  checkReusingOutput(false);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: datafu.hourglass.test.PartitionCollapsingJoinTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void joinMissingClicksTest() throws IOException, InterruptedException, ClassNotFoundException {
  startImpressions(2013,3,15);
  startClicks(2013,3,15);
  impression(1);
  click(1);
  impression(2);
  click(2);
  click(2);
  impression(3);
  impression(3);
  impression(4);
  click(4);
  stopImpressions();
  stopClicks();
  startImpressions(2013,3,16);
  startClicks(2013,3,16);
  impression(5);
  click(5);
  impression(6);
  impression(6);
  click(6);
  impression(7);
  impression(7);
  stopImpressions();
  stopClicks();
  startImpressions(2013,3,17);
  impression(8);
  impression(9);
  impression(10);
  stopImpressions();
  runJob();
  checkOutputFolderCount(1);
  HashMap<Long,ImpressionClick> counts;
  counts=loadOutputCounts("20130317");
  checkSize(counts,10);
  checkIdCount(counts,1,1,1);
  checkIdCount(counts,2,1,2);
  checkIdCount(counts,3,2,0);
  checkIdCount(counts,4,1,1);
  checkIdCount(counts,5,1,1);
  checkIdCount(counts,6,2,1);
  checkIdCount(counts,7,2,0);
  checkIdCount(counts,8,1,0);
  checkIdCount(counts,9,1,0);
  checkIdCount(counts,10,1,0);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void joinTest() throws IOException, InterruptedException, ClassNotFoundException {
  startImpressions(2013,3,15);
  startClicks(2013,3,15);
  impression(1);
  click(1);
  impression(2);
  click(2);
  click(2);
  impression(3);
  impression(3);
  impression(4);
  click(4);
  stopImpressions();
  stopClicks();
  startImpressions(2013,3,16);
  startClicks(2013,3,16);
  impression(5);
  click(5);
  impression(6);
  impression(6);
  click(6);
  impression(7);
  impression(7);
  stopImpressions();
  stopClicks();
  startImpressions(2013,3,17);
  startClicks(2013,3,17);
  impression(8);
  click(8);
  click(8);
  click(8);
  impression(9);
  impression(10);
  click(10);
  click(10);
  stopImpressions();
  stopClicks();
  runJob();
  checkOutputFolderCount(1);
  HashMap<Long,ImpressionClick> counts;
  counts=loadOutputCounts("20130317");
  checkSize(counts,10);
  checkIdCount(counts,1,1,1);
  checkIdCount(counts,2,1,2);
  checkIdCount(counts,3,2,0);
  checkIdCount(counts,4,1,1);
  checkIdCount(counts,5,1,1);
  checkIdCount(counts,6,2,1);
  checkIdCount(counts,7,2,0);
  checkIdCount(counts,8,1,3);
  checkIdCount(counts,9,1,0);
  checkIdCount(counts,10,1,2);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: datafu.hourglass.test.PartitionPreservingJoinTests </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void joinClicksMissingTest() throws IOException, InterruptedException, ClassNotFoundException {
  startImpressions(2013,3,15);
  startClicks(2013,3,15);
  impression(1);
  click(1);
  impression(2);
  click(2);
  click(2);
  impression(3);
  impression(3);
  impression(4);
  click(4);
  stopImpressions();
  stopClicks();
  startImpressions(2013,3,16);
  startClicks(2013,3,16);
  impression(5);
  click(5);
  impression(6);
  impression(6);
  click(6);
  impression(7);
  impression(7);
  stopImpressions();
  stopClicks();
  startImpressions(2013,3,17);
  startClicks(2013,3,17);
  impression(8);
  impression(9);
  impression(10);
  stopImpressions();
  stopClicks();
  runJob();
  checkOutputFolderCount(3);
  HashMap<Long,ImpressionClick> counts;
  counts=loadOutputCounts("20130315");
  checkSize(counts,4);
  checkIdCount(counts,1,1,1);
  checkIdCount(counts,2,1,2);
  checkIdCount(counts,3,2,0);
  checkIdCount(counts,4,1,1);
  counts=loadOutputCounts("20130316");
  checkSize(counts,3);
  checkIdCount(counts,5,1,1);
  checkIdCount(counts,6,2,1);
  checkIdCount(counts,7,2,0);
  counts=loadOutputCounts("20130317");
  checkSize(counts,3);
  checkIdCount(counts,8,1,0);
  checkIdCount(counts,9,1,0);
  checkIdCount(counts,10,1,0);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void joinTest() throws IOException, InterruptedException, ClassNotFoundException {
  startImpressions(2013,3,15);
  startClicks(2013,3,15);
  impression(1);
  click(1);
  impression(2);
  click(2);
  click(2);
  impression(3);
  impression(3);
  impression(4);
  click(4);
  stopImpressions();
  stopClicks();
  startImpressions(2013,3,16);
  startClicks(2013,3,16);
  impression(5);
  click(5);
  impression(6);
  impression(6);
  click(6);
  impression(7);
  impression(7);
  stopImpressions();
  stopClicks();
  startImpressions(2013,3,17);
  startClicks(2013,3,17);
  impression(8);
  click(8);
  click(8);
  click(8);
  impression(9);
  impression(10);
  click(10);
  click(10);
  stopImpressions();
  stopClicks();
  runJob();
  checkOutputFolderCount(3);
  HashMap<Long,ImpressionClick> counts;
  counts=loadOutputCounts("20130315");
  checkSize(counts,4);
  checkIdCount(counts,1,1,1);
  checkIdCount(counts,2,1,2);
  checkIdCount(counts,3,2,0);
  checkIdCount(counts,4,1,1);
  counts=loadOutputCounts("20130316");
  checkSize(counts,3);
  checkIdCount(counts,5,1,1);
  checkIdCount(counts,6,2,1);
  checkIdCount(counts,7,2,0);
  counts=loadOutputCounts("20130317");
  checkSize(counts,3);
  checkIdCount(counts,8,1,3);
  checkIdCount(counts,9,1,0);
  checkIdCount(counts,10,1,2);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: datafu.hourglass.test.TestAvroJob </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void basicAvroJobTest() throws IOException, InterruptedException, ClassNotFoundException {
  openDay(2013,3,15);
  storeIds(1,1,1);
  storeIds(2,2,2,2);
  storeIds(3,3,3,3,3,3,3);
  closeDay();
  openDay(2013,3,16);
  storeIds(1,1,1,1,1);
  storeIds(2,2,2);
  storeIds(3,3,3,3);
  storeIds(4,4,4);
  storeIds(5);
  closeDay();
  openDay(2013,3,17);
  storeIds(2,2,2);
  storeIds(3,3,3,3,3,3,3,3,3,3);
  storeIds(5,5,5,5);
  storeIds(6,6,6);
  closeDay();
  runJob();
  checkOutputFolderCount(1);
  HashMap<Long,Long> counts=loadOutputCounts("20130317");
  checkSize(counts,6);
  checkIdCount(counts,1,8);
  checkIdCount(counts,2,10);
  checkIdCount(counts,3,21);
  checkIdCount(counts,4,3);
  checkIdCount(counts,5,5);
  checkIdCount(counts,6,3);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: datafu.test.pig.bags.BagTests </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void bagGroupSingleTest() throws Exception {
  PigTest test=createPigTestFromString(bagGroupSingleTest);
  writeLinesToFile("input","({(1,A),(1,B),(2,A),(2,B),(2,C),(3,A)})","({(A,1),(B,1),(A,2),(B,2),(C,2),(A,3)})");
  test.runScript();
  getLinesForAlias(test,"data2",true);
  assertOutput(test,"data3","({(1,{(1,A),(1,B)}),(2,{(2,A),(2,B),(2,C)}),(3,{(3,A)})})","({(A,{(A,1),(A,2),(A,3)}),(B,{(B,1),(B,2)}),(C,{(C,2)})})");
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void countEachTest() throws Exception {
  PigTest test=createPigTestFromString(countEachTest);
  writeLinesToFile("input","({(A),(B),(A),(C),(A),(B)})");
  test.runScript();
  assertOutput(test,"data3","({((A),3),((B),2),((C),1)})");
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void bagGroupMultipleTest() throws Exception {
  PigTest test=createPigTestFromString(bagGroupMultipleTest);
  writeLinesToFile("input","({(1,A,1),(1,B,1),(1,A,2),(2,A,1),(2,B,1),(2,C,1),(3,A,1)})");
  test.runScript();
  getLinesForAlias(test,"data2",true);
  assertOutput(test,"data3","({((1,A),{(1,A,1),(1,A,2)}),((1,B),{(1,B,1)}),((2,A),{(2,A,1)}),((2,B),{(2,B,1)}),((2,C),{(2,C,1)}),((3,A),{(3,A,1)})})");
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void emptyBagToNullFieldsTest() throws Exception {
  PigTest test=createPigTestFromString(emptyBagToNullFieldsTest);
  writeLinesToFile("input","({(1,1),(2,2),(3,3),(4,4),(5,5)})","({})","{(4,4),(5,5)})");
  test.runScript();
  assertOutput(test,"data2","({(1,1),(2,2),(3,3),(4,4),(5,5)})","({(,)})","({(4,4),(5,5)})");
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void emptyBagToNullTest() throws Exception {
  PigTest test=createPigTestFromString(emptyBagToNullTest);
  writeLinesToFile("input","({(1),(2),(3),(4),(5)})","()","({})","{(4),(5)})");
  test.runScript();
  assertOutput(test,"data2","({(1),(2),(3),(4),(5)})","()","()","({(4),(5)})");
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void bagConcatTest() throws Exception {
  PigTest test=createPigTestFromString(bagConcatTest);
  writeLinesToFile("input","({(1),(2),(3)}\t{(3),(5),(6)}\t{(10),(13)})","({(2),(3),(4)}\t{(5),(5)}\t{(20)})");
  test.runScript();
  assertOutput(test,"data2","({(1),(2),(3),(3),(5),(6),(10),(13)})","({(2),(3),(4),(5),(5),(20)})");
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void bagUnionTest() throws Exception {
  PigTest test=createPigTestFromString(bagUnionTest);
  writeLinesToFile("input","({({(1,A),(1,B)}),({(2,A),(2,B),(2,C)}),({(3,A)})}");
  test.runScript();
  assertOutput(test,"data2","({(1,A),(1,B),(2,A),(2,B),(2,C),(3,A)})");
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void comprehensiveBagSplitAndEnumerate() throws Exception {
  PigTest test=createPigTestFromString(comprehensiveBagSplitAndEnumerate);
  writeLinesToFile("input","({(A,1.0),(B,2.0),(C,3.0),(D,4.0),(E,5.0)})");
  test.runScript();
  assertOutput(test,"data_out","(A,1.0,1)","(B,2.0,1)","(C,3.0,1)","(D,4.0,2)","(E,5.0,2)");
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void distinctByMultiComplexFieldTest() throws Exception {
  PigTest test=createPigTestFromString(distinctByMultiComplexFieldTest);
  writeLinesToFile("input","({(a-b,[b#1],{(a-b,0),(a-b,1)}),(a-c,[b#1],{(a-b,0),(a-b,1)}),(a-d,[b#0],{(a-b,1),(a-b,2)})})");
  test.runScript();
  assertOutput(test,"data2","({(a-b,[b#1],{(a-b,0),(a-b,1)}),(a-d,[b#0],{(a-b,1),(a-b,2)})})");
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void distinctByTest() throws Exception {
  PigTest test=createPigTestFromString(distinctByTest);
  writeLinesToFile("input","({(Z,1,0),(A,1,0),(A,1,0),(B,2,0),(B,22,1),(C,3,0),(D,4,0),(E,5,0)})","({(A,10,2),(M,50,3),(A,34,49), (A,24,42), (Z,49,22),(B,1,1)},(B,2,2))");
  test.runScript();
  assertOutput(test,"data2","({(Z,1,0),(A,1,0),(B,2,0),(C,3,0),(D,4,0),(E,5,0)})","({(A,10,2),(M,50,3),(Z,49,22),(B,1,1)})");
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void enumerateTest2() throws Exception {
  PigTest test=createPigTestFromString(enumerateTest);
  writeLinesToFile("input","({(10,{(1),(2),(3)}),(20,{(4),(5),(6)}),(30,{(7),(8)}),(40,{(9),(10),(11)}),(50,{(12),(13),(14),(15)})})","({(11,{(11),(12),(13),(14)}),(21,{(15),(16),(17),(18)}),(31,{(19),(20)}),(41,{(21),(22),(23),(24)}),(51,{(25),(26),(27)})})");
  test.runScript();
  assertOutput(test,"data4","(10,{(1),(2),(3)},0)","(20,{(4),(5),(6)},1)","(30,{(7),(8)},2)","(40,{(9),(10),(11)},3)","(50,{(12),(13),(14),(15)},4)","(11,{(11),(12),(13),(14)},0)","(21,{(15),(16),(17),(18)},1)","(31,{(19),(20)},2)","(41,{(21),(22),(23),(24)},3)","(51,{(25),(26),(27)},4)");
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void enumerateTest() throws Exception {
  PigTest test=createPigTestFromString(enumerateTest);
  writeLinesToFile("input","({(10,{(1),(2),(3)}),(20,{(4),(5),(6)}),(30,{(7),(8)}),(40,{(9),(10),(11)}),(50,{(12),(13),(14),(15)})})");
  test.runScript();
  assertOutput(test,"data4","(10,{(1),(2),(3)},0)","(20,{(4),(5),(6)},1)","(30,{(7),(8)},2)","(40,{(9),(10),(11)},3)","(50,{(12),(13),(14),(15)},4)");
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void distinctByDelimTest() throws Exception {
  PigTest test=createPigTestFromString(distinctByDelimTest);
  writeLinesToFile("input","({(a-b,c),(a-b,d)})");
  test.runScript();
  assertOutput(test,"data2","({(a-b,c),(a-b,d)})");
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void unorderedPairsTest() throws Exception {
  PigTest test=createPigTestFromString(unorderedPairsTest);
  String[] input={"{(1),(2),(3),(4),(5)}"};
  String[] output={"(1,2)","(1,3)","(1,4)","(1,5)","(2,3)","(2,4)","(2,5)","(3,4)","(3,5)","(4,5)"};
  test.assertOutput("data",input,"data4",output);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void bagSplitTest() throws Exception {
  PigTest test=createPigTestFromString(bagSplitTest,"MAX=5");
  writeLinesToFile("input","{(1,11),(2,22),(3,33),(4,44),(5,55),(6,66),(7,77),(8,88),(9,99),(10,1010),(11,1111),(12,1212)}");
  test.runScript();
  assertOutput(test,"data3","({(1,11),(2,22),(3,33),(4,44),(5,55)})","({(6,66),(7,77),(8,88),(9,99),(10,1010)})","({(11,1111),(12,1212)})");
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void prependToBagTest() throws Exception {
  PigTest test=createPigTestFromString(prependToBagTest);
  writeLinesToFile("input","1\t{(1),(2),(3)}\t(4)","2\t{(10),(20),(30),(40),(50)}\t(60)");
  test.runScript();
  assertOutput(test,"data2","(1,{(4),(1),(2),(3)})","(2,{(60),(10),(20),(30),(40),(50)})");
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void countEachFlattenTest() throws Exception {
  PigTest test=createPigTestFromString(countEachFlattenTest);
  writeLinesToFile("input","({(A),(B),(A),(C),(A),(B)})");
  test.runScript();
  assertOutput(test,"data3","({(A,3),(B,2),(C,1)})");
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void unorderedPairsTest2() throws Exception {
  PigTest test=createPigTestFromString(unorderedPairsTest2);
  this.writeLinesToFile("input","1\t{(1),(2),(3),(4),(5)}");
  test.runScript();
  this.getLinesForAlias(test,"data3");
  this.assertOutput(test,"data3","(1,(1),(2))","(1,(1),(3))","(1,(1),(4))","(1,(1),(5))","(1,(2),(3))","(1,(2),(4))","(1,(2),(5))","(1,(3),(4))","(1,(3),(5))","(1,(4),(5))");
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void bagJoinInnerTest() throws Exception {
  PigTest test=createPigTestFromString(bagJoinInnerTest);
  writeLinesToFile("input","1\t{(K1,A1),(K2,B1),(K3,C1)}\t{(K1,A2),(K2,B2),(K2,B22)}\t{(K1,A3),(K3,C3),(K4,D3)}");
  try {
    test.runScript();
  }
 catch (  Exception e) {
    e.printStackTrace();
    throw e;
  }
  assertOutput(test,"data2","(1,{(K1,A1,K1,A2,K1,A3)},{(K1,A1,K1,A3,K1,A2)})");
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void tupleFromBagTest() throws Exception {
  PigTest test=createPigTestFromString(tupleFromBagTest);
  writeLinesToFile("input","1,a","1,b","1,c","2,d","2,e","2,f","3,g","3,h","3,i");
  test.runScript();
  assertOutput(test,"result1","(1,(1,c))","(2,(2,f))","(3,(3,i))");
  assertOutput(test,"result2","(1,c,b)","(2,f,e)","(3,i,h)");
  assertOutput(test,"result3","(1,c,)","(2,f,)","(3,i,)");
  assertOutput(test,"result4","(1,c,NO_NUMBER)","(2,f,NO_NUMBER)","(3,i,NO_NUMBER)");
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test(description="BagGroup with projection of the value from the bag") public void bagGroupProjectTest() throws Exception {
  PigTest test=createPigTestFromString(bagGroupProjectTest);
  writeLinesToFile("input","({(1,A),(1,B),(2,A),(2,B),(2,C),(3,A)})","({(A,1),(B,1),(A,2),(B,2),(C,2),(A,3)})");
  test.runScript();
  getLinesForAlias(test,"data2",true);
  assertOutput(test,"data3","({(1,{(A),(B)}),(2,{(A),(B),(C)}),(3,{(A)})})","({(A,{(1),(2),(3)}),(B,{(1),(2)}),(C,{(2)})})");
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void bagSplitWithBagNumTest() throws Exception {
  PigTest test=createPigTestFromString(bagSplitWithBagNumTest,"MAX=10");
  writeLinesToFile("input","{(1,11),(2,22),(3,33),(4,44),(5,55),(6,66),(7,77),(8,88),(9,99),(10,1010),(11,1111),(12,1212)}");
  test.runScript();
  assertOutput(test,"data3","({(1,11),(2,22),(3,33),(4,44),(5,55),(6,66),(7,77),(8,88),(9,99),(10,1010)},0)","({(11,1111),(12,1212)},1)");
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void nullToEmptyBagTest() throws Exception {
  PigTest test=createPigTestFromString(nullToEmptyBag);
  writeLinesToFile("input","({(1),(2),(3),(4),(5)})","()","{(4),(5)})");
  test.runScript();
  assertOutput(test,"data2","({(1),(2),(3),(4),(5)})","({})","({(4),(5)})");
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void appendToBagTest() throws Exception {
  PigTest test=createPigTestFromString(appendToBagTest);
  writeLinesToFile("input","1\t{(1),(2),(3)}\t(4)","2\t{(10),(20),(30),(40),(50)}\t(60)");
  test.runScript();
  assertOutput(test,"data2","(1,{(1),(2),(3),(4)})","(2,{(10),(20),(30),(40),(50),(60)})");
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void firstTupleFromBagTest() throws Exception {
  PigTest test=createPigTestFromString(firstTupleFromBagTest);
  writeLinesToFile("input","1\t{(4),(9),(16)}");
  test.runScript();
  assertOutput(test,"data2","(1,(4))");
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void enumerateWithStartTest() throws Exception {
  PigTest test=createPigTestFromString(enumerateWithStartTest);
  writeLinesToFile("input","({(10,{(1),(2),(3)}),(20,{(4),(5),(6)}),(30,{(7),(8)}),(40,{(9),(10),(11)}),(50,{(12),(13),(14),(15)})})");
  test.runScript();
  assertOutput(test,"data4","(10,{(1),(2),(3)},1)","(20,{(4),(5),(6)},2)","(30,{(7),(8)},3)","(40,{(9),(10),(11)},4)","(50,{(12),(13),(14),(15)},5)");
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void enumerateWithReverseTest() throws Exception {
  PigTest test=createPigTestFromString(enumerateWithReverseTest);
  writeLinesToFile("input","({(10,{(1),(2),(3)}),(20,{(4),(5),(6)}),(30,{(7),(8)}),(40,{(9),(10),(11)}),(50,{(12),(13),(14),(15)})})");
  test.runScript();
  assertOutput(test,"data4","(10,{(1),(2),(3)},5)","(20,{(4),(5),(6)},4)","(30,{(7),(8)},3)","(40,{(9),(10),(11)},2)","(50,{(12),(13),(14),(15)},1)");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: datafu.test.pig.bags.ZipBagsTests </h4><pre class="type-12 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expectedExceptions=FrontendException.class) public void duplicateAliasTest() throws Exception {
  PigTest test=createPigTestFromString(duplicateAliasTest);
  writeLinesToFile("input","{(1,2),(3,4),(5,6)}\t{(7,8),(9,10),(11,12)}");
  test.runScript();
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void zipBagsTest() throws Exception {
  PigTest test=createPigTestFromString(zipBagsTest);
  writeLinesToFile("input","{(1,2),(3,4),(5,6)}\t{(7,8),(9,10),(11,12)}");
  test.runScript();
  assertOutput(test,"zipped","({(1,2,7,8),(3,4,9,10),(5,6,11,12)})");
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void zipUnevenBagsTest() throws Exception {
  PigTest test=createPigTestFromString(zipBagsTest);
  writeLinesToFile("input","{(1,2),(3,4),(5,6))}\t{(7,8),(9,10),(11,12),(1,2)}");
  test.runScript();
  assertOutput(test,"zipped","({(1,2,7,8),(3,4,9,10),(5,6,11,12)})");
}

</code></pre>

<br>
<pre class="type-12 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expectedExceptions=FrontendException.class) public void zipUnevenBagsExceptionTest() throws Exception {
  PigTest test=createPigTestFromString(zipBagsTest);
  writeLinesToFile("input","{(1,2),(3,4),(5,6),(20,40)}\t{(7,8),(9,10)}");
  test.runScript();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: datafu.test.pig.geo.GeoTests </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void haversineTest() throws Exception {
  PigTest test=createPigTestFromString(haversineTest);
  double[] la={34.040143,-118.243103};
  double[] tokyo={35.637209,139.65271};
  double[] ny={40.716038,-73.99498};
  double[] paris={48.857713,2.342491};
  double[] sydney={-33.872696,151.195221};
  this.writeLinesToFile("input",coords(la,tokyo),coords(ny,tokyo),coords(ny,sydney),coords(ny,paris));
  test.runScript();
  List<Tuple> distances=this.getLinesForAlias(test,"data2");
  assertWithin(5478.0,distances.get(0),20.0);
  assertWithin(6760.0,distances.get(1),20.0);
  assertWithin(9935.0,distances.get(2),20.0);
  assertWithin(3635.0,distances.get(3),20.0);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: datafu.test.pig.hash.HashTests </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void sha512Test() throws Exception {
  PigTest test=createPigTestFromString(sha512Test);
  writeLinesToFile("input","ladsljkasdglk","lkadsljasgjskdjks","aladlasdgjks","has_lo_sha512_92333");
  test.runScript();
  assertOutput(test,"data_out","(f681dbd89dfc9edf00f68107ed81b4b7c89abdf84337921785d13d9189937a43decbc264b5013d396a102b18564c39595732c43d6d4cc99473f6d6d7101ecf87)","(85c130c8636c052e52a2ca091a92d0bb98ee361adcbeeebbd6af978a593b2486a22ac1e7352c683035cfa28de8eee3402adc6760ad54c5c7eda122c5124766bd)","(3b82af5c08c9ab70523abf56db244eaa6740fa8c356e3a41bb5225560c0949b14b417c8d56e72cc26d5682400e0420a556e692c41ea82855013e8b7bae5fb0fb)","(000001f4836cd015a4b2205793484740b65a10626ef032dc8daec65bd369b05b7ecd7493fe263b187fcb356c3e02c05cf4aa5ebbd116305d1ec08d857135c8b2)");
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void md5Test() throws Exception {
  PigTest test=createPigTestFromString(md5Test);
  writeLinesToFile("input","ladsljkasdglk","lkadsljasgjskdjks","aladlasdgjks","has_lo_md5_1065433");
  test.runScript();
  assertOutput(test,"data_out","(d9a82575758bb4978949dc0659205cc6)","(9ec37f02fae0d8d6a7f4453a62272f1f)","(cb94139a8b9f3243e68a898ec6bd9b3d)","(000008e5487b3abae7be88a1d4bad573)");
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void sha256Test() throws Exception {
  PigTest test=createPigTestFromString(sha256Test);
  writeLinesToFile("input","ladsljkasdglk","lkadsljasgjskdjks","aladlasdgjks","has_lo_sha256_11542105");
  test.runScript();
  assertOutput(test,"data_out","(70ebaf99c4d8ff8860869e50be2d46afbf150b883f66b50a76ee81cdc802242b)","(f22e3c744a9ade0fa591d28c55392035248b391c9ee4c77ebfeaf6558c8c0dac)","(49420b42e764178830783d4520aea56b759f325c1d1167f5640ded91f33f3e69)","(000000aa76ae37c4085105a40d6eb27ef41ab5bed0013002cb6218b1e5fa6315)");
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void md5Base64Test() throws Exception {
  PigTest test=createPigTestFromString(md5Base64Test);
  writeLinesToFile("input","ladsljkasdglk","lkadsljasgjskdjks","aladlasdgjks","has_lo_md5_1065433");
  test.runScript();
  assertOutput(test,"data_out","(2agldXWLtJeJSdwGWSBcxg==)","(nsN/Avrg2Nan9EU6YicvHw==)","(y5QTmoufMkPmiomOxr2bPQ==)","(AAAI5Uh7Orrnvoih1LrVcw==)");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: datafu.test.pig.hash.lsh.LSHTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testCosineLSH() throws Exception {
  RandomGenerator rg=new JDKRandomGenerator();
  rg.setSeed(0);
  RandomData rd=new RandomDataImpl(rg);
  List<RealVector> vectors=getVectors(rd,1000,1000);
  int k=5;
  LSHCreator creator=new LSHCreator(3,k,1500,0){
    @Override protected LSH constructLSH(    RandomGenerator rg) throws MathException {
      return new HyperplaneLSH(getDim(),rg);
    }
  }
;
  LSHFamily family=creator.constructFamily(rg);
  List<Map<Long,List<RealVector>>> partitions=partition(vectors,family,creator.getNumHashes());
  DistanceMetric metric=new DistanceMetric(){
    public double distance(    RealVector v1,    RealVector v2){
      return Cosine.distance(v1,v2);
    }
  }
;
  harness(k,partitions,rd,vectors,family,metric,.001);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testL2LSH() throws Exception {
  RandomGenerator rg=new JDKRandomGenerator();
  rg.setSeed(0);
  RandomData rd=new RandomDataImpl(rg);
  List<RealVector> vectors=getVectors(rd,1000,1000);
  int k=5;
  LSHCreator creator=new LSHCreator(3,k,1,0){
    @Override protected LSH constructLSH(    RandomGenerator rg) throws MathException {
      return new L2LSH(getDim(),200,rg);
    }
  }
;
  LSHFamily family=creator.constructFamily(rg);
  List<Map<Long,List<RealVector>>> partitions=partition(vectors,family,creator.getNumHashes());
  DistanceMetric metric=new DistanceMetric(){
    public double distance(    RealVector v1,    RealVector v2){
      return L2.distance(v1,v2);
    }
  }
;
  harness(k,partitions,rd,vectors,family,metric,1000);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testL1LSH() throws Exception {
  RandomGenerator rg=new JDKRandomGenerator();
  rg.setSeed(0);
  RandomData rd=new RandomDataImpl(rg);
  List<RealVector> vectors=getVectors(rd,1000,1000);
  int k=5;
  LSHCreator creator=new LSHCreator(3,k,1,0){
    @Override protected LSH constructLSH(    RandomGenerator rg) throws MathException {
      return new L1LSH(getDim(),150,rg);
    }
  }
;
  LSHFamily family=creator.constructFamily(rg);
  List<Map<Long,List<RealVector>>> partitions=partition(vectors,family,creator.getNumHashes());
  DistanceMetric metric=new DistanceMetric(){
    public double distance(    RealVector v1,    RealVector v2){
      return L1.distance(v1,v2);
    }
  }
;
  harness(k,partitions,rd,vectors,family,metric,1000);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: datafu.test.pig.linkanalysis.PageRankImplTests </h4><pre class="type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Invokes logging operations">Logger</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Invokes logging operations
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void wikipediaGraphDiskCacheTest() throws Exception {
  System.out.println();
  System.out.println("Starting wikipediaGraphDiskCacheTest");
  datafu.pig.linkanalysis.PageRankImpl graph=new datafu.pig.linkanalysis.PageRankImpl();
  String[] edges=getWikiExampleEdges();
  graph.enableEdgeDiskCaching();
  graph.setEdgeCachingThreshold(5);
  Map<String,Integer> nodeIdsMap=loadGraphFromEdgeList(graph,edges);
  assert graph.isUsingEdgeDiskCache() : "Expected disk cache to be used";
  graph.enableDanglingNodeHandling();
  performIterations(graph,150,1e-18f);
  String[] expectedRanks=getWikiExampleExpectedRanks();
  Map<String,Float> expectedRanksMap=parseExpectedRanks(expectedRanks);
  validateExpectedRanks(graph,nodeIdsMap,expectedRanksMap);
}

</code></pre>

<br>
<pre class="type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Invokes logging operations">Logger</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Invokes logging operations
- Executes methods or other tests from the same test unit
"></span><br>
@Test(groups="perf") public void hubAndSpokeDiskCacheTest() throws Exception {
  System.out.println();
  System.out.println("Starting hubAndSpokeDiskCacheTest");
  datafu.pig.linkanalysis.PageRankImpl graph=new datafu.pig.linkanalysis.PageRankImpl();
  String[] edges=getHubAndSpokeEdges();
  graph.enableEdgeDiskCaching();
  graph.setEdgeCachingThreshold(5);
  Map<String,Integer> nodeIdsMap=loadGraphFromEdgeList(graph,edges);
  graph.enableDanglingNodeHandling();
  performIterations(graph,150,1e-18f);
}

</code></pre>

<br>
<pre class="type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Invokes logging operations">Logger</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Invokes logging operations
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void wikipediaGraphInMemoryTest() throws Exception {
  System.out.println();
  System.out.println("Starting wikipediaGraphInMemoryTest");
  datafu.pig.linkanalysis.PageRankImpl graph=new datafu.pig.linkanalysis.PageRankImpl();
  String[] edges=getWikiExampleEdges();
  Map<String,Integer> nodeIdsMap=loadGraphFromEdgeList(graph,edges);
  graph.enableDanglingNodeHandling();
  performIterations(graph,150,1e-18f);
  String[] expectedRanks=getWikiExampleExpectedRanks();
  Map<String,Float> expectedRanksMap=parseExpectedRanks(expectedRanks);
  validateExpectedRanks(graph,nodeIdsMap,expectedRanksMap);
}

</code></pre>

<br>
<pre class="type-13 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Invokes logging operations">Logger</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Invokes logging operations
- Executes methods or other tests from the same test unit
"></span><br>
@Test(groups="perf") public void hubAndSpokeInMemoryTest() throws Exception {
  System.out.println();
  System.out.println("Starting hubAndSpokeInMemoryTest");
  datafu.pig.linkanalysis.PageRankImpl graph=new datafu.pig.linkanalysis.PageRankImpl();
  String[] edges=getHubAndSpokeEdges();
  Map<String,Integer> nodeIdsMap=loadGraphFromEdgeList(graph,edges);
  graph.enableDanglingNodeHandling();
  performIterations(graph,150,1e-18f);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: datafu.test.pig.sampling.SamplingTests </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void weightedSampleTest() throws Exception {
  PigTest test=createPigTestFromString(weightedSampleTest);
  writeLinesToFile("input","({(a, 100),(b, 1),(c, 5),(d, 2)})");
  test.runScript();
  assertOutput(test,"data2","({(a,100),(c,5),(b,1),(d,2)})");
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void reservoirSampleTest() throws Exception {
  writeLinesToFile("input","A1\tB1\t1","A1\tB1\t4","A1\tB3\t4","A1\tB4\t4","A2\tB1\t4","A2\tB2\t4","A3\tB1\t3","A3\tB1\t1","A3\tB3\t77","A4\tB1\t3","A4\tB2\t3","A4\tB3\t59","A4\tB4\t29","A5\tB1\t4","A6\tB2\t3","A6\tB2\t55","A6\tB3\t1","A7\tB1\t39","A7\tB2\t27","A7\tB3\t85","A8\tB1\t4","A8\tB2\t45","A9\tB3\t92","A9\tB3\t0","A9\tB6\t42","A9\tB5\t1","A10\tB1\t7","A10\tB2\t23","A10\tB2\t1","A10\tB2\t31","A10\tB6\t41","A10\tB7\t52");
  for (int i=10; i <= 30; i=i + 10) {
    int reservoirSize=i;
    PigTest test=createPigTestFromString(reservoirSampleTest,"RESERVOIR_SIZE=" + reservoirSize);
    test.runScript();
    assertOutput(test,"sampled","(" + reservoirSize + ")");
  }
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void sampleByKeyTest() throws Exception {
  PigTest test=createPigTestFromString(sampleByKeyTest);
  writeLinesToFile("input","A1\tB1\t1","A1\tB1\t4","A1\tB3\t4","A1\tB4\t4","A2\tB1\t4","A2\tB2\t4","A3\tB1\t3","A3\tB1\t1","A3\tB3\t77","A4\tB1\t3","A4\tB2\t3","A4\tB3\t59","A4\tB4\t29","A5\tB1\t4","A6\tB2\t3","A6\tB2\t55","A6\tB3\t1","A7\tB1\t39","A7\tB2\t27","A7\tB3\t85","A8\tB1\t4","A8\tB2\t45","A9\tB3\t92","A9\tB1\t42","A9\tB2\t1","A9\tB3\t0","A10\tB1\t7","A10\tB2\t23","A10\tB3\t1","A10\tB4\t41","A10\tB5\t52");
  test.runScript();
  assertOutput(test,"sampled","(A4,B1,3)","(A4,B2,3)","(A4,B3,59)","(A4,B4,29)","(A5,B1,4)","(A6,B2,3)","(A6,B2,55)","(A6,B3,1)","(A7,B1,39)","(A7,B2,27)","(A7,B3,85)","(A10,B1,7)","(A10,B2,23)","(A10,B3,1)","(A10,B4,41)","(A10,B5,52)");
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void sampleByKeyMultipleKeyTest() throws Exception {
  PigTest test=createPigTestFromString(sampleByKeyMultipleKeyTest);
  writeLinesToFile("input","A1\tB1\t1","A1\tB1\t4","A1\tB3\t4","A1\tB4\t4","A2\tB1\t4","A2\tB2\t4","A3\tB1\t3","A3\tB1\t1","A3\tB3\t77","A4\tB1\t3","A4\tB2\t3","A4\tB3\t59","A4\tB4\t29","A5\tB1\t4","A6\tB2\t3","A6\tB2\t55","A6\tB3\t1","A7\tB1\t39","A7\tB2\t27","A7\tB3\t85","A8\tB1\t4","A8\tB2\t45","A9\tB3\t92","A9\tB3\t0","A9\tB6\t42","A9\tB5\t1","A10\tB1\t7","A10\tB2\t23","A10\tB2\t1","A10\tB2\t31","A10\tB6\t41","A10\tB7\t52");
  test.runScript();
  assertOutput(test,"sampled","(A1,B1,1)","(A1,B1,4)","(A1,B4,4)","(A2,B1,4)","(A2,B2,4)","(A3,B1,3)","(A3,B1,1)","(A4,B4,29)","(A5,B1,4)","(A6,B3,1)","(A7,B1,39)","(A8,B1,4)","(A9,B3,92)","(A9,B3,0)","(A10,B2,23)","(A10,B2,1)","(A10,B2,31)");
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void weightedSampleLimitTest() throws Exception {
  PigTest test=createPigTestFromString(weightedSampleLimitTest);
  writeLinesToFile("input","({(a, 100),(b, 1),(c, 5),(d, 2)})");
  test.runScript();
  assertOutput(test,"data2","({(a,100),(c,5),(b,1)})");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: datafu.test.pig.sampling.SimpleRandomSampleTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testStratifiedSample() throws Exception {
  writeLinesToFile("input","A1\tB1\t1","A1\tB1\t4","A1\tB3\t4","A1\tB4\t4","A2\tB1\t4","A2\tB2\t4","A3\tB1\t3","A3\tB1\t1","A3\tB3\t77","A4\tB1\t3","A4\tB2\t3","A4\tB3\t59","A4\tB4\t29","A5\tB1\t4","A6\tB2\t3","A6\tB2\t55","A6\tB3\t1","A7\tB1\t39","A7\tB2\t27","A7\tB3\t85","A8\tB1\t4","A8\tB2\t45","A9\tB3\t92","A9\tB3\t0","A9\tB6\t42","A9\tB5\t1","A10\tB1\t7","A10\tB2\t23","A10\tB2\t1","A10\tB2\t31","A10\tB6\t41","A10\tB7\t52");
  double p=0.5;
  PigTest test=createPigTestFromString(stratifiedSampleTest,"SAMPLING_PROBABILITY=" + p);
  test.runScript();
  assertOutput(test,"sampled","(A1,2)","(A10,3)","(A2,1)","(A3,2)","(A4,2)","(A5,1)","(A6,2)","(A7,2)","(A8,1)","(A9,2)");
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSimpleRandomSample() throws Exception {
  writeLinesToFile("input","A1\tB1\t1","A1\tB1\t4","A1\tB3\t4","A1\tB4\t4","A2\tB1\t4","A2\tB2\t4","A3\tB1\t3","A3\tB1\t1","A3\tB3\t77","A4\tB1\t3","A4\tB2\t3","A4\tB3\t59","A4\tB4\t29","A5\tB1\t4","A6\tB2\t3","A6\tB2\t55","A6\tB3\t1","A7\tB1\t39","A7\tB2\t27","A7\tB3\t85","A8\tB1\t4","A8\tB2\t45","A9\tB3\t92","A9\tB3\t0","A9\tB6\t42","A9\tB5\t1","A10\tB1\t7","A10\tB2\t23","A10\tB2\t1","A10\tB2\t31","A10\tB6\t41","A10\tB7\t52");
  int n=32;
  double p=0.3;
  int s=(int)Math.ceil(p * n);
  PigTest test=createPigTestFromString(simpleRandomSampleTest,"p=" + p);
  test.runScript();
  assertOutput(test,"sampled","(" + s + ")");
  int n1=30;
  PigTest testWithLB=createPigTestFromString(simpleRandomSampleWithLowerBoundTest,"p=" + p,"n1=" + n1);
  testWithLB.runScript();
  assertOutput(testWithLB,"sampled","(" + s + ")");
  double p1=0.05;
  double p2=0.95;
  int s1=(int)Math.ceil(p1 * n);
  int s2=(int)Math.ceil(p2 * n);
  PigTest testWithTwoCalls=createPigTestFromString(simpleRandomSampleWithTwoCallsTest,"p1=" + p1,"p2=" + p2);
  testWithTwoCalls.runScript();
  assertOutput(testWithTwoCalls,"sampled","(" + s1 + ","+ s2+ ")");
  test.runScript();
}

</code></pre>

<br>
<h4 style="margin:0px">Class: datafu.test.pig.sampling.SimpleRandomSampleTestOld </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void stratifiedSampleTest() throws Exception {
  writeLinesToFile("input","A1\tB1\t1","A1\tB1\t4","A1\tB3\t4","A1\tB4\t4","A2\tB1\t4","A2\tB2\t4","A3\tB1\t3","A3\tB1\t1","A3\tB3\t77","A4\tB1\t3","A4\tB2\t3","A4\tB3\t59","A4\tB4\t29","A5\tB1\t4","A6\tB2\t3","A6\tB2\t55","A6\tB3\t1","A7\tB1\t39","A7\tB2\t27","A7\tB3\t85","A8\tB1\t4","A8\tB2\t45","A9\tB3\t92","A9\tB3\t0","A9\tB6\t42","A9\tB5\t1","A10\tB1\t7","A10\tB2\t23","A10\tB2\t1","A10\tB2\t31","A10\tB6\t41","A10\tB7\t52");
  double p=0.5;
  PigTest test=createPigTestFromString(stratifiedSampleTest,"SAMPLING_PROBABILITY=" + p);
  test.runScript();
  assertOutput(test,"sampled","(A1,2)","(A10,3)","(A2,1)","(A3,2)","(A4,2)","(A5,1)","(A6,2)","(A7,2)","(A8,1)","(A9,2)");
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void simpleRandomSampleTest() throws Exception {
  writeLinesToFile("input","A1\tB1\t1","A1\tB1\t4","A1\tB3\t4","A1\tB4\t4","A2\tB1\t4","A2\tB2\t4","A3\tB1\t3","A3\tB1\t1","A3\tB3\t77","A4\tB1\t3","A4\tB2\t3","A4\tB3\t59","A4\tB4\t29","A5\tB1\t4","A6\tB2\t3","A6\tB2\t55","A6\tB3\t1","A7\tB1\t39","A7\tB2\t27","A7\tB3\t85","A8\tB1\t4","A8\tB2\t45","A9\tB3\t92","A9\tB3\t0","A9\tB6\t42","A9\tB5\t1","A10\tB1\t7","A10\tB2\t23","A10\tB2\t1","A10\tB2\t31","A10\tB6\t41","A10\tB7\t52");
  int n=32;
  double p=0.3;
  int s=(int)Math.ceil(p * n);
  PigTest test=createPigTestFromString(simpleRandomSampleTest,"SAMPLING_PROBABILITY=" + p);
  test.runScript();
  assertOutput(test,"sampled","(" + s + ")");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: datafu.test.pig.sampling.SimpleRandomSampleWithReplacementTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void testSimpleRandomSampleWithReplacement() throws Exception {
  writeLinesToFile("input","A1\tB1\t1","A1\tB1\t4","A1\tB3\t4","A1\tB4\t4","A2\tB1\t4","A2\tB2\t4","A3\tB1\t3","A3\tB1\t1","A3\tB3\t77","A4\tB1\t3","A4\tB2\t3","A4\tB3\t59","A4\tB4\t29","A5\tB1\t4","A6\tB2\t3","A6\tB2\t55","A6\tB3\t1","A7\tB1\t39","A7\tB2\t27","A7\tB3\t85","A8\tB1\t4","A8\tB2\t45","A9\tB3\t92","A9\tB3\t0","A9\tB6\t42","A9\tB5\t1","A10\tB1\t7","A10\tB2\t23","A10\tB2\t1","A10\tB2\t31","A10\tB6\t41","A10\tB7\t52");
  int s=32;
  PigTest test=createPigTestFromString(simpleRandomSampleWithReplacementTest,"SAMPLE_SIZE=" + s + "L");
  test.runScript();
  assertOutput(test,"sampled","(" + s + ")");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: datafu.test.pig.sampling.WeightedReservoirSamplingTests </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void weightedReservoirSampleAlgebraicTest() throws IOException {
  WeightedReservoirSample.Initial initialSampler=new WeightedReservoirSample.Initial("10","1");
  WeightedReservoirSample.Intermediate intermediateSampler=new WeightedReservoirSample.Intermediate("10","1");
  WeightedReservoirSample.Final finalSampler=new WeightedReservoirSample.Final("10","1");
  DataBag bag=BagFactory.getInstance().newDefaultBag();
  for (int i=0; i < 100; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(2);
    t.set(0,i);
    t.set(1,i + 1);
    bag.add(t);
  }
  Tuple input=TupleFactory.getInstance().newTuple(bag);
  Tuple intermediateTuple=initialSampler.exec(input);
  DataBag intermediateBag=BagFactory.getInstance().newDefaultBag(Arrays.asList(intermediateTuple));
  intermediateTuple=intermediateSampler.exec(TupleFactory.getInstance().newTuple(intermediateBag));
  intermediateBag=BagFactory.getInstance().newDefaultBag(Arrays.asList(intermediateTuple));
  DataBag result=finalSampler.exec(TupleFactory.getInstance().newTuple(intermediateBag));
  verifyNoRepeatAllFound(result,10,0,100);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void weightedReservoirSampleAccumulateTest() throws IOException {
  WeightedReservoirSample sampler=new WeightedReservoirSample("10","1");
  for (int i=0; i < 100; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(2);
    t.set(0,i);
    t.set(1,i + 1);
    DataBag bag=BagFactory.getInstance().newDefaultBag();
    bag.add(t);
    Tuple input=TupleFactory.getInstance().newTuple(bag);
    sampler.accumulate(input);
  }
  DataBag result=sampler.getValue();
  verifyNoRepeatAllFound(result,10,0,100);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: datafu.test.pig.sessions.SessionTests </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void sessionCountPageViewsTest() throws Exception {
  PigTest test=createPigTestFromString(sessionCountPageViewsTest,"TIME_WINDOW=30m");
  String[] input={"1\t100\t2010-01-01T01:00:00Z","1\t100\t2010-01-01T01:15:00Z","1\t100\t2010-01-01T01:31:00Z","1\t100\t2010-01-01T01:35:00Z","1\t100\t2010-01-01T02:30:00Z","1\t101\t2010-01-01T01:00:00Z","1\t101\t2010-01-01T01:31:00Z","1\t101\t2010-01-01T02:10:00Z","1\t101\t2010-01-01T02:40:30Z","1\t101\t2010-01-01T03:30:00Z","1\t102\t2010-01-01T01:00:00Z","1\t102\t2010-01-01T01:01:00Z","1\t102\t2010-01-01T01:02:00Z","1\t102\t2010-01-01T01:10:00Z","1\t102\t2010-01-01T01:15:00Z","1\t102\t2010-01-01T01:25:00Z","1\t102\t2010-01-01T01:30:00Z"};
  String[] output={"(1,100,2)","(1,101,5)","(1,102,1)"};
  test.assertOutput("views",input,"view_counts",output);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: datafu.test.pig.sets.SetTests </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void setDifferenceTwoBagsTest() throws Exception {
  PigTest test=createPigTestFromString(setDifferenceTwoBagsTest);
  writeLinesToFile("input","{(1),(2),(3)}\t","{(1),(2),(3)}\t{}","\t{(1),(2),(3)}","{}\t{(1),(2),(3)}","{(1),(2),(3)}\t{(1)}","{(1),(2),(3)}\t{(1),(2)}","{(1),(2),(3)}\t{(1),(2),(3)}","{(1),(2),(3)}\t{(1),(2),(3),(4)}","{(1),(2),(3),(4),(5),(6)}\t{(3),(4)}");
  test.runScript();
  assertOutput(test,"data2","({(1),(2),(3)})","({(1),(2),(3)})","({})","({})","({(2),(3)})","({(3)})","({})","({})","({(1),(2),(5),(6)})");
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void setUnionTest() throws Exception {
  PigTest test=createPigTestFromString(setUnionTest);
  writeLinesToFile("input","{(1,10),(1,20),(1,30),(1,40),(1,50),(1,60),(1,80)}\t{(1,1),(1,20),(1,25),(1,25),(1,25),(1,40),(1,70),(1,80)}");
  test.runScript();
  assertOutput(test,"data2","({(1,1),(1,10),(1,20),(1,25),(1,30),(1,40),(1,50),(1,60),(1,70),(1,80)})");
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void setIntersectEmptyBagsTest() throws Exception {
  PigTest test=createPigTestFromString(setIntersectTest);
  writeLinesToFile("input","{(1,10),(2,20),(3,30),(4,40),(5,50),(6,60)}\t{(0,0),(2,20),(4,40),(8,80)}","{(1,10),(1,10),(2,20),(3,30),(3,30),(4,40),(4,40)}\t{(100,10),(300,30)}","{(1,10),(2,20)}\t{(1,10),(2,20)}","{(1,10),(2,20)}\t{}","{}\t{(1,10),(2,20)}","{}\t{}");
  test.runScript();
  assertOutput(test,"data2","({(2,20),(4,40)})","({})","({(1,10),(2,20)})","({})","({})","({})");
}

</code></pre>

<br>
<pre class="type-12 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expectedExceptions=org.apache.pig.impl.logicalLayer.FrontendException.class) public void setIntersectOutOfOrderTest() throws Exception {
  PigTest test=createPigTestFromString(setIntersectTest);
  this.writeLinesToFile("input","{(1,10),(3,30),(2,20),(4,40),(5,50),(6,60)}\t{(0,0),(2,20),(4,40),(8,80)}");
  test.runScript();
  this.getLinesForAlias(test,"data2");
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void setDifferenceThreeBagsTest() throws Exception {
  PigTest test=createPigTestFromString(setDifferenceThreeBagsTest);
  writeLinesToFile("input","{(1),(2),(3)}\t\t","{(1),(2),(3)}\t{}\t","{(1),(2),(3)}\t\t{}","{(1),(2),(3)}\t{}\t{}","{(1),(2),(2),(2),(3),(3)}\t{}\t{}","{(1),(2),(3)}\t{(2)}\t{}","{(1),(2),(3)}\t{}\t{(2)}","{(1),(2),(3)}\t{(2)}\t{(3)}","{(1),(2),(3)}\t{(2),(2)}\t{(3),(3)}","{(1),(1),(1),(2),(2),(3),(3),(3)}\t{(2),(2)}\t{(3),(3)}","{(1),(2),(3)}\t{(0),(2)}\t{(3)}","{(1),(2),(3)}\t{(0),(2)}\t{(1),(3)}","{(1),(2),(3)}\t{(0),(2)}\t{(1),(3),(4)}");
  test.runScript();
  assertOutput(test,"data2","({(1),(2),(3)})","({(1),(2),(3)})","({(1),(2),(3)})","({(1),(2),(3)})","({(1),(2),(3)})","({(1),(3)})","({(1),(3)})","({(1)})","({(1)})","({(1)})","({(1)})","({})","({})");
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void setUnionEmptyBagsTest() throws Exception {
  PigTest test=createPigTestFromString(setUnionTest);
  writeLinesToFile("input","{(1,10),(1,20),(1,30),(1,40),(1,50),(1,60),(1,80)}\t{}","{}\t{(1,10),(1,20),(1,30),(1,40),(1,50)}","{}\t{}");
  test.runScript();
  assertOutput(test,"data2","({(1,10),(1,20),(1,30),(1,40),(1,50),(1,60),(1,80)})","({(1,10),(1,20),(1,30),(1,40),(1,50)})","({})");
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void setIntersectTest() throws Exception {
  PigTest test=createPigTestFromString(setIntersectTest);
  writeLinesToFile("input","{(1,10),(2,20),(3,30),(4,40),(5,50),(6,60)}\t{(0,0),(2,20),(4,40),(8,80)}","{(1,10),(1,10),(2,20),(3,30),(3,30),(4,40),(4,40)}\t{(1,10),(3,30)}");
  test.runScript();
  assertOutput(test,"data2","({(2,20),(4,40)})","({(1,10),(3,30)})");
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void setIntersectTestExample() throws Exception {
  PigTest test=createPigTestFromString(setIntersectTestExample);
  writeLinesToFile("docs","1,word1 word4 word2 word1","2,word2 word6 word1 word5 word3 word7","3,word1 word3 word4 word5");
  writeLinesToFile("query","word2 word7 word5");
  test.runScript();
  assertOutput(test,"result","(1,1)","(2,3)","(3,1)");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: datafu.test.pig.stats.MarkovPairTests </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void markovPairDefaultTest() throws Exception {
  PigTest test=createPigTestFromString(markovPairDefault,"schema=(data: bag {t: tuple(val:int)})");
  writeLinesToFile("input","{(10),(20),(30),(40),(50),(60)}");
  String[] expectedOutput={"({((10),(20)),((20),(30)),((30),(40)),((40),(50)),((50),(60))})"};
  test.runScript();
  Iterator<Tuple> actualOutput=test.getAlias("data_out");
  assertTuplesMatch(expectedOutput,actualOutput);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void markovPairMultipleInput() throws Exception {
  PigTest test=createPigTestFromString(markovPairDefault,"schema=(data: bag {t: tuple(val1:int,val2:int)})");
  writeLinesToFile("input","{(10,100),(20,200),(30,300),(40,400),(50,500),(60,600)}");
  String[] expectedOutput={"({((10,100),(20,200)),((20,200),(30,300)),((30,300),(40,400)),((40,400),(50,500)),((50,500),(60,600))})"};
  test.runScript();
  Iterator<Tuple> actualOutput=test.getAlias("data_out");
  assertTuplesMatch(expectedOutput,actualOutput);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void markovPairLookaheadTest() throws Exception {
  PigTest test=createPigTestFromString(markovPairLookahead,"schema=(data: bag {t: tuple(val:int)})","lookahead=3");
  writeLinesToFile("input","{(10),(20),(30),(40),(50)}");
  String[] expectedOutput={"({((10),(20)),((10),(30)),((10),(40)),((20),(30)),((20),(40)),((20),(50)),((30),(40)),((30),(50)),((40),(50))})"};
  test.runScript();
  Iterator<Tuple> actualOutput=test.getAlias("data_out");
  assertTuplesMatch(expectedOutput,actualOutput);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: datafu.test.pig.stats.entropy.ChaoShenEntropyTests </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void singleElemInputBagChaoShenEntropoyTest() throws Exception {
  PigTest test=createPigTestFromString(entropy,"type=chaosh","base=log");
  writeLinesToFile("input","98.94791");
  test.runScript();
  List<Double> expectedOutput=new ArrayList<Double>();
  expectedOutput.add(0.0);
  List<Tuple> output=this.getLinesForAlias(test,"data_out");
  verifyEqualEntropyOutput(expectedOutput,output,5);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void uniqValChaoShenEntropoyTest() throws Exception {
  PigTest test=createPigTestFromString(entropy,"type=chaosh","base=log");
  writeLinesToFile("input","98.94791","38.61010","97.10575","62.28313","38.83960","32.05370","96.10962","28.72388","96.65888","20.41135");
  test.runScript();
  List<Double> expectedOutput=new ArrayList<Double>();
  expectedOutput.add(4.816221);
  List<Tuple> output=this.getLinesForAlias(test,"data_out");
  verifyEqualEntropyOutput(expectedOutput,output,5);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void dupPairValChaoShenEntropoyTest() throws Exception {
  PigTest test=createPigTestFromString(pairEntropy,"type=chaosh","base=log");
  writeLinesToFile("input","hadoop	98.94791","bigdata	38.61010","hadoop	97.10575","datafu	32.05370","bigdata	38.61010","datafu	32.05370","datafu	32.05370","hadoop	38.61010","pig	96.10962","pig	20.41135");
  test.runScript();
  List<Double> expectedOutput=new ArrayList<Double>();
  expectedOutput.add(2.57429);
  List<Tuple> output=this.getLinesForAlias(test,"data_out");
  verifyEqualEntropyOutput(expectedOutput,output,5);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void emptyInputBagChaoShenEntropoyTest() throws Exception {
  PigTest test=createPigTestFromString(entropy,"type=chaosh","base=log");
  writeLinesToFile("input");
  test.runScript();
  List<Double> expectedOutput=new ArrayList<Double>();
  List<Tuple> output=this.getLinesForAlias(test,"data_out");
  verifyEqualEntropyOutput(expectedOutput,output,5);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void dupValChaoShenEntropoyLog2Test() throws Exception {
  PigTest test=createPigTestFromString(entropy,"type=chaosh","base=log2");
  writeLinesToFile("input","98.94791","38.61010","97.10575","62.28313","38.61010","32.05370","96.10962","38.61010","96.10962","20.41135");
  test.runScript();
  List<Double> expectedOutput=new ArrayList<Double>();
  expectedOutput.add(3.713915);
  List<Tuple> output=this.getLinesForAlias(test,"data_out");
  verifyEqualEntropyOutput(expectedOutput,output,5);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void singleValChaoShenEntropoyTest() throws Exception {
  PigTest test=createPigTestFromString(entropy,"type=chaosh","base=log");
  writeLinesToFile("input","98.94791","98.94791","98.94791","98.94791","98.94791","98.94791","98.94791","98.94791","98.94791","98.94791");
  test.runScript();
  List<Double> expectedOutput=new ArrayList<Double>();
  expectedOutput.add(0.0);
  List<Tuple> output=this.getLinesForAlias(test,"data_out");
  verifyEqualEntropyOutput(expectedOutput,output,5);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void dupValChaoShenEntropoyTest() throws Exception {
  PigTest test=createPigTestFromString(entropy,"type=chaosh","base=log");
  writeLinesToFile("input","98.94791","38.61010","97.10575","62.28313","38.61010","32.05370","96.10962","38.61010","96.10962","20.41135");
  test.runScript();
  List<Double> expectedOutput=new ArrayList<Double>();
  expectedOutput.add(2.57429);
  List<Tuple> output=this.getLinesForAlias(test,"data_out");
  verifyEqualEntropyOutput(expectedOutput,output,5);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void dupValChaoShenEntropoyLog10Test() throws Exception {
  PigTest test=createPigTestFromString(entropy,"type=chaosh","base=log10");
  writeLinesToFile("input","98.94791","38.61010","97.10575","62.28313","38.61010","32.05370","96.10962","38.61010","96.10962","20.41135");
  test.runScript();
  List<Double> expectedOutput=new ArrayList<Double>();
  expectedOutput.add(1.118);
  List<Tuple> output=this.getLinesForAlias(test,"data_out");
  verifyEqualEntropyOutput(expectedOutput,output,5);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: datafu.test.pig.stats.entropy.CondEntropyTests </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void singleElemInputBagEmpiricalCondEntropoyTest() throws Exception {
  PigTest test=createPigTestFromString(condEntropy);
  writeLinesToFile("input","98.94791	view");
  test.runScript();
  List<Double> expectedOutput=new ArrayList<Double>();
  expectedOutput.add(0.0);
  List<Tuple> output=this.getLinesForAlias(test,"data_out");
  verifyEqualEntropyOutput(expectedOutput,output,5);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void emptyInputBagEmpiricalCondEntropoyTest() throws Exception {
  PigTest test=createPigTestFromString(condEntropy);
  writeLinesToFile("input");
  test.runScript();
  List<Double> expectedOutput=new ArrayList<Double>();
  List<Tuple> output=this.getLinesForAlias(test,"data_out");
  verifyEqualEntropyOutput(expectedOutput,output,5);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void uniqValEmpiricalCondEntropoyTest() throws Exception {
  PigTest test=createPigTestFromString(condEntropy);
  writeLinesToFile("input","98.94791	click","38.61010	view","97.10575	view","62.28313	click","38.83960	click","32.05370	view","96.10962	view","28.72388	click","96.65888	view","20.41135	click");
  test.runScript();
  List<Double> expectedOutput=new ArrayList<Double>();
  expectedOutput.add(0.0);
  List<Tuple> output=this.getLinesForAlias(test,"data_out");
  verifyEqualEntropyOutput(expectedOutput,output,5);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void singleValEmpiricalCondEntropoyTest() throws Exception {
  PigTest test=createPigTestFromString(condEntropy);
  writeLinesToFile("input","98.94791	click","98.94791	click","98.94791	click","98.94791	click","98.94791	click","98.94791	click","98.94791	click","98.94791	click","98.94791	click","98.94791	click");
  test.runScript();
  List<Double> expectedOutput=new ArrayList<Double>();
  expectedOutput.add(0.0);
  List<Tuple> output=this.getLinesForAlias(test,"data_out");
  verifyEqualEntropyOutput(expectedOutput,output,5);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void dupValEmpiricalCondEntropoyLog2Test() throws Exception {
  PigTest test=createPigTestFromString(condLogEntropy,"type=empirical","base=log2");
  writeLinesToFile("input","98.94791	click","38.61010	click","97.10575	view","62.28313	view","38.61010	view","32.05370	view","96.10962	click","38.61010	click","96.10962	view","20.41135	click");
  test.runScript();
  List<Double> expectedOutput=new ArrayList<Double>();
  expectedOutput.add(0.4754888);
  List<Tuple> output=this.getLinesForAlias(test,"data_out");
  verifyEqualEntropyOutput(expectedOutput,output,5);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void dupValEmpiricalCondEntropoyTest() throws Exception {
  PigTest test=createPigTestFromString(condEntropy);
  writeLinesToFile("input","98.94791	click","38.61010	click","97.10575	view","62.28313	view","38.61010	view","32.05370	view","96.10962	click","38.61010	click","96.10962	view","20.41135	click");
  test.runScript();
  List<Double> expectedOutput=new ArrayList<Double>();
  expectedOutput.add(0.3295837);
  List<Tuple> output=this.getLinesForAlias(test,"data_out");
  verifyEqualEntropyOutput(expectedOutput,output,5);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void dupValEmpiricalCondEntropoyLog10Test() throws Exception {
  PigTest test=createPigTestFromString(condLogEntropy,"type=empirical","base=log10");
  writeLinesToFile("input","98.94791	click","38.61010	click","97.10575	view","62.28313	view","38.61010	view","32.05370	view","96.10962	click","38.61010	click","96.10962	view","20.41135	click");
  test.runScript();
  List<Double> expectedOutput=new ArrayList<Double>();
  expectedOutput.add(0.1431364);
  List<Tuple> output=this.getLinesForAlias(test,"data_out");
  verifyEqualEntropyOutput(expectedOutput,output,5);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void dupPairValEmpiricalCondEntropoyTest() throws Exception {
  PigTest test=createPigTestFromString(pairCondEntropy);
  writeLinesToFile("input","hadoop	bigdata	click","hadoop	pig	view","hadoop	datafu	click","datafu	pig	click","bigdata	pig	view","datafu	pig	click","datafu	pig	view","hadoop	bigdata	view","pig	datafu	view","pig	datafu	view");
  test.runScript();
  List<Double> expectedOutput=new ArrayList<Double>();
  expectedOutput.add(0.3295837);
  List<Tuple> output=this.getLinesForAlias(test,"data_out");
  verifyEqualEntropyOutput(expectedOutput,output,5);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: datafu.test.pig.stats.entropy.EmpiricalCountEntropyTests </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void accumulatedEntropyTest() throws Exception {
  PigTest test=createPigTestFromString(accumulatedEntropy);
  writeLinesToFile("input","98.94791","38.61010","97.10575","62.28313","38.61010","32.05370","96.10962","38.61010","96.10962","20.41135");
  test.runScript();
  List<Double> expectedOutput=new ArrayList<Double>();
  expectedOutput.add(1.834372);
  List<Tuple> output=this.getLinesForAlias(test,"data_out");
  verifyEqualEntropyOutput(expectedOutput,output,5);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void dupPairValEntropyTest() throws Exception {
  PigTest test=createPigTestFromString(pairLogEntropy,"base=log");
  writeLinesToFile("input","hadoop	98.94791","bigdata	38.61010","hadoop	97.10575","datafu	32.05370","bigdata	38.61010","datafu	32.05370","datafu	32.05370","hadoop	38.61010","pig	96.10962","pig	20.41135");
  test.runScript();
  List<Double> expectedOutput=new ArrayList<Double>();
  expectedOutput.add(1.834372);
  List<Tuple> output=this.getLinesForAlias(test,"data_out");
  verifyEqualEntropyOutput(expectedOutput,output,5);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void singleElemInputBagEntropyTest() throws Exception {
  PigTest test=createPigTestFromString(entropy);
  writeLinesToFile("input","98.94791");
  test.runScript();
  List<Double> expectedOutput=new ArrayList<Double>();
  expectedOutput.add(0.0);
  List<Tuple> output=this.getLinesForAlias(test,"data_out");
  verifyEqualEntropyOutput(expectedOutput,output,5);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void rawInValidInputValueEntropyTest() throws Exception {
  PigTest test=createPigTestFromString(rawValidInputEntropy);
  writeLinesToFile("input","0","-38","0","62","38","32","96","38","96","0");
  List<Double> expectedOutput=new ArrayList<Double>();
  expectedOutput.add(1.693862);
  List<Tuple> output=this.getLinesForAlias(test,"data_out");
  verifyEqualEntropyOutput(expectedOutput,output,5);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void rawValidInputEntropyTest() throws Exception {
  PigTest test=createPigTestFromString(rawValidInputEntropy);
  writeLinesToFile("input","0","38","0","62","38","32","96","38","96","0");
  test.runScript();
  List<Double> expectedOutput=new ArrayList<Double>();
  expectedOutput.add(1.846901);
  List<Tuple> output=this.getLinesForAlias(test,"data_out");
  verifyEqualEntropyOutput(expectedOutput,output,5);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void singleValEntropyTest() throws Exception {
  PigTest test=createPigTestFromString(entropy);
  writeLinesToFile("input","98.94791","98.94791","98.94791","98.94791","98.94791","98.94791","98.94791","98.94791","98.94791","98.94791");
  test.runScript();
  List<Double> expectedOutput=new ArrayList<Double>();
  expectedOutput.add(0.0);
  List<Tuple> output=this.getLinesForAlias(test,"data_out");
  verifyEqualEntropyOutput(expectedOutput,output,5);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void dupValEntropyTest() throws Exception {
  PigTest test=createPigTestFromString(entropy);
  writeLinesToFile("input","98.94791","38.61010","97.10575","62.28313","38.61010","32.05370","96.10962","38.61010","96.10962","20.41135");
  test.runScript();
  List<Double> expectedOutput=new ArrayList<Double>();
  expectedOutput.add(1.834372);
  List<Tuple> output=this.getLinesForAlias(test,"data_out");
  verifyEqualEntropyOutput(expectedOutput,output,5);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void dupValEntropyLog10Test() throws Exception {
  PigTest test=createPigTestFromString(logEntropy,"base=log10");
  writeLinesToFile("input","98.94791","38.61010","97.10575","62.28313","38.61010","32.05370","96.10962","38.61010","96.10962","20.41135");
  test.runScript();
  List<Double> expectedOutput=new ArrayList<Double>();
  expectedOutput.add(0.7966576);
  List<Tuple> output=this.getLinesForAlias(test,"data_out");
  verifyEqualEntropyOutput(expectedOutput,output,5);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void uniqValEntropyTest() throws Exception {
  PigTest test=createPigTestFromString(entropy);
  writeLinesToFile("input","98.94791","38.61010","97.10575","62.28313","38.83960","32.05370","96.10962","28.72388","96.65888","20.41135");
  test.runScript();
  List<Double> expectedOutput=new ArrayList<Double>();
  expectedOutput.add(2.302585);
  List<Tuple> output=this.getLinesForAlias(test,"data_out");
  verifyEqualEntropyOutput(expectedOutput,output,5);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void dupValEntropyLog2Test() throws Exception {
  PigTest test=createPigTestFromString(logEntropy,"base=log2");
  writeLinesToFile("input","98.94791","38.61010","97.10575","62.28313","38.61010","32.05370","96.10962","38.61010","96.10962","20.41135");
  test.runScript();
  List<Double> expectedOutput=new ArrayList<Double>();
  expectedOutput.add(2.646439);
  List<Tuple> output=this.getLinesForAlias(test,"data_out");
  verifyEqualEntropyOutput(expectedOutput,output,5);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void emptyInputBagEntropyTest() throws Exception {
  PigTest test=createPigTestFromString(entropy);
  writeLinesToFile("input");
  test.runScript();
  List<Double> expectedOutput=new ArrayList<Double>();
  List<Tuple> output=this.getLinesForAlias(test,"data_out");
  verifyEqualEntropyOutput(expectedOutput,output,5);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: datafu.test.pig.stats.entropy.EntropyTests </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void dupValEmpiricalEntropoyLog2Test() throws Exception {
  PigTest test=createPigTestFromString(logEntropy,"type=empirical","base=log2");
  writeLinesToFile("input","98.94791","38.61010","97.10575","62.28313","38.61010","32.05370","96.10962","38.61010","96.10962","20.41135");
  test.runScript();
  List<Double> expectedOutput=new ArrayList<Double>();
  expectedOutput.add(2.646439);
  List<Tuple> output=this.getLinesForAlias(test,"data_out");
  verifyEqualEntropyOutput(expectedOutput,output,5);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void singleElemInputBagEmpiricalEntropoyTest() throws Exception {
  PigTest test=createPigTestFromString(entropy);
  writeLinesToFile("input","98.94791");
  test.runScript();
  List<Double> expectedOutput=new ArrayList<Double>();
  expectedOutput.add(0.0);
  List<Tuple> output=this.getLinesForAlias(test,"data_out");
  verifyEqualEntropyOutput(expectedOutput,output,5);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void dupValEmpiricalEntropoyLog10Test() throws Exception {
  PigTest test=createPigTestFromString(logEntropy,"type=empirical","base=log10");
  writeLinesToFile("input","98.94791","38.61010","97.10575","62.28313","38.61010","32.05370","96.10962","38.61010","96.10962","20.41135");
  test.runScript();
  List<Double> expectedOutput=new ArrayList<Double>();
  expectedOutput.add(0.7966576);
  List<Tuple> output=this.getLinesForAlias(test,"data_out");
  verifyEqualEntropyOutput(expectedOutput,output,5);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void dupValEmpiricalEntropoyTest() throws Exception {
  PigTest test=createPigTestFromString(entropy);
  writeLinesToFile("input","98.94791","38.61010","97.10575","62.28313","38.61010","32.05370","96.10962","38.61010","96.10962","20.41135");
  test.runScript();
  List<Double> expectedOutput=new ArrayList<Double>();
  expectedOutput.add(1.834372);
  List<Tuple> output=this.getLinesForAlias(test,"data_out");
  verifyEqualEntropyOutput(expectedOutput,output,5);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void uniqValEmpiricalEntropoyTest() throws Exception {
  PigTest test=createPigTestFromString(entropy);
  writeLinesToFile("input","98.94791","38.61010","97.10575","62.28313","38.83960","32.05370","96.10962","28.72388","96.65888","20.41135");
  test.runScript();
  List<Double> expectedOutput=new ArrayList<Double>();
  expectedOutput.add(2.302585);
  List<Tuple> output=this.getLinesForAlias(test,"data_out");
  verifyEqualEntropyOutput(expectedOutput,output,5);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void singleValEmpiricalEntropoyTest() throws Exception {
  PigTest test=createPigTestFromString(entropy);
  writeLinesToFile("input","98.94791","98.94791","98.94791","98.94791","98.94791","98.94791","98.94791","98.94791","98.94791","98.94791");
  test.runScript();
  List<Double> expectedOutput=new ArrayList<Double>();
  expectedOutput.add(0.0);
  List<Tuple> output=this.getLinesForAlias(test,"data_out");
  verifyEqualEntropyOutput(expectedOutput,output,5);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void emptyInputBagEmpiricalEntropoyTest() throws Exception {
  PigTest test=createPigTestFromString(entropy);
  writeLinesToFile("input");
  test.runScript();
  List<Double> expectedOutput=new ArrayList<Double>();
  List<Tuple> output=this.getLinesForAlias(test,"data_out");
  verifyEqualEntropyOutput(expectedOutput,output,5);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void dupPairValEmpiricalEntropoyTest() throws Exception {
  PigTest test=createPigTestFromString(pairEntropy,"type=empirical","base=log");
  writeLinesToFile("input","hadoop	98.94791","bigdata	38.61010","hadoop	97.10575","datafu	32.05370","bigdata	38.61010","datafu	32.05370","datafu	32.05370","hadoop	38.61010","pig	96.10962","pig	20.41135");
  test.runScript();
  List<Double> expectedOutput=new ArrayList<Double>();
  expectedOutput.add(1.834372);
  List<Tuple> output=this.getLinesForAlias(test,"data_out");
  verifyEqualEntropyOutput(expectedOutput,output,5);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: datafu.test.pig.text.NLPTests </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void tokenizeMETest() throws Exception {
  PigTest test=createPigTestFromString(tokenizeMETest);
  writeLinesToFile("input","This is a sentence. This is another sentence.","Yet another sentence. One more just for luck.");
  assertOutput(test,"data2","({(This),(is),(a),(sentence),(.),(This),(is),(another),(sentence),(.)})","({(Yet),(another),(sentence),(.),(One),(more),(just),(for),(luck),(.)})");
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void POSTagTest() throws Exception {
  PigTest test=createPigTestFromString(POSTagTest);
  writeLinesToFile("input","This is a sentence. This is another sentence.","Yet another sentence. One more just for luck.");
  assertOutput(test,"data3","({(This,DT,0.9649410482478001),(is,VBZ,0.9982592902509803),(a,DT,0.9967282012835504),(sentence,NN,0.9772619256460584),(.,.,0.4391067883074289),(This,DT,0.8346710130761914),(is,VBZ,0.9928885242823617),(another,DT,0.9761159923140399),(sentence,NN,0.9964463493238542),(.,.,0.9856037689871404)})","({(Yet,RB,0.7638997090011364),(another,DT,0.9657669183153523),(sentence,NN,0.989193114719676),(.,.,0.20091718589945456),(One,CD,0.9229251494813668),(more,JJR,0.9360382000551335),(just,RB,0.8646324491545225),(for,IN,0.9851765355889605),(luck,NN,0.9883408827371651),(.,.,0.9746378518791978)})");
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void tokenizeWhitespaceTest() throws Exception {
  PigTest test=createPigTestFromString(tokenizeWhitespaceTest);
  writeLinesToFile("input","This is a sentence. This is another sentence.","Yet another sentence. One more just for luck.");
  assertOutput(test,"data2","({(This),(is),(a),(sentence.),(This),(is),(another),(sentence.)})","({(Yet),(another),(sentence.),(One),(more),(just),(for),(luck.)})");
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void sentenceDetectTest() throws Exception {
  PigTest test=createPigTestFromString(sentenceDetectTest);
  writeLinesToFile("input","This is a sentence. This is another sentence.","Yet another sentence. One more just for luck.");
  assertOutput(test,"data2","({(This is a sentence.),(This is another sentence.)})","({(Yet another sentence.),(One more just for luck.)})");
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void tokenizeSimpleTest() throws Exception {
  PigTest test=createPigTestFromString(tokenizeSimpleTest);
  writeLinesToFile("input","This is a sentence. This is another sentence.","Yet another sentence. One more just for luck.");
  assertOutput(test,"data2","({(This),(is),(a),(sentence),(.),(This),(is),(another),(sentence),(.)})","({(Yet),(another),(sentence),(.),(One),(more),(just),(for),(luck),(.)})");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: datafu.test.pig.urls.UserAgentTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void userAgentTest() throws Exception {
  PigTest test=createPigTestFromString(userAgentTest);
  String[] input={"Mozilla/5.0 (iPhone; U; CPU iPhone OS 4_3_3 like Mac OS X; en-us) AppleWebKit/533.17.9 (KHTML, like Gecko) Version/5.0.2 Mobile/8J2 Safari/6533.18.5","Mozilla/5.0 (compatible; Konqueror/3.5; Linux; X11; de) KHTML/3.5.2 (like Gecko) Kubuntu 6.06 Dapper","Mozilla/5.0 (Windows NT 6.1; WOW64; rv:2.2a1pre) Gecko/20110331 Firefox/4.2a1pre Fennec/4.1a1pre","Opera/9.00 (X11; Linux i686; U; en)","Wget/1.10.2","Opera/9.80 (Android; Linux; Opera Mobi/ADR-1012221546; U; pl) Presto/2.7.60 Version/10.5","Mozilla/5.0 (Linux; U; Android 2.2; en-us; DROID2 Build/VZW) AppleWebKit/533.1 (KHTML, like Gecko) Version/4.0 Mobile Safari/533.1"};
  String[] output={"(mobile)","(desktop)","(mobile)","(desktop)","(desktop)","(mobile)","(mobile)"};
  test.assertOutput("data",input,"data_out",output);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: datafu.test.pig.util.Base64Test </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void base64EncodeTest() throws Exception {
  PigTest test=createPigTestFromString(base64EncodeTest);
  writeLinesToFile("input","hello","lad","how","are you?");
  test.runScript();
  assertOutput(test,"data_out","(aGVsbG8=)","(bGFk)","(aG93)","(YXJlIHlvdT8=)");
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void base64DecodeTest() throws Exception {
  PigTest test=createPigTestFromString(base64DecodeTest);
  writeLinesToFile("input","aGVsbG8=","bGFk","aG93","YXJlIHlvdT8=");
  test.runScript();
  assertOutput(test,"data_out","(hello)","(lad)","(how)","(are you?)");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: datafu.test.pig.util.CoalesceTests </h4><pre class="type-12 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies that exceptions are thrown during the test case execution">ExceptionVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies that exceptions are thrown during the test case execution
- Executes methods or other tests from the same test unit
"></span><br>
@Test(expectedExceptions=FrontendException.class) public void coalesceBagIncompatibleTypeTest() throws Exception {
  PigTest test=createPigTestFromString(coalesceBagIncompatibleTypeTest);
  this.writeLinesToFile("input","1,1,2L}");
  test.runScript();
  this.getLinesForAlias(test,"data3");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: datafu.test.pig.util.InTests </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void inTopLevelTest() throws Exception {
  PigTest test=createPigTestFromString(inTopLevelTest);
  writeLinesToFile("input","alice\tred","bob\tblue","charlie\tgreen","dave\tred");
  test.runScript();
  assertOutput(test,"data2","(alice,red)","(bob,blue)","(dave,red)");
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void inStringTest() throws Exception {
  PigTest test=createPigTestFromString(inStringTest);
  writeLinesToFile("input","({(alice),(bob),(will),(matt),(sam)})","({(will),(matt)})","({(alice),(bob)})");
  test.runScript();
  assertOutput(test,"data2","({(will),(matt),(sam)})","({(will),(matt)})","({})");
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void inIntTest() throws Exception {
  PigTest test=createPigTestFromString(inIntTest);
  writeLinesToFile("input","({(1),(2),(3),(4),(5)})","({(1),(2)})","({(4),(5)})");
  test.runScript();
  assertOutput(test,"data2","({(1),(2),(3)})","({(1),(2)})","({})");
}

</code></pre>

<br>
<h4 style="margin:0px">Class: datafu.test.pig.util.IntBoolConversionPigTests </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void intToBoolTest() throws Exception {
  PigTest test=createPigTestFromString(intToBoolTest);
  String[] input={"","0","1"};
  String[] output={"(false)","(false)","(true)"};
  test.assertOutput("data",input,"data2",output);
}

</code></pre>

<br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void intToBoolToIntTest() throws Exception {
  PigTest test=createPigTestFromString(intToBoolToIntTest);
  String[] input={"","0","1","2","-1","-2","0",""};
  String[] output={"(0)","(0)","(1)","(1)","(1)","(1)","(0)","(0)"};
  test.assertOutput("data",input,"data3",output);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: datafu.test.pig.util.SelectStringFieldByNameTest </h4><pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
@Test public void chooseFieldByValueTest() throws Exception {
  PigTest test=createPigTestFromString(chooseFieldByValueTest);
  writeLinesToFile("input","text1,hi,how,are","text2,you,sir,today","text3,bob,is,a","text1,friend,of,mine","text2,and,I,say","text3,he,is,nice.");
  assertOutput(test,"data3","(hi)","(sir)","(a)","(friend)","(I)","(nice.)");
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
