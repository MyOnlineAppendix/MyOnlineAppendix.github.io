<h3><span class=" glyphicon glyphicon-tag"/>&nbspBooleanVerifier</h3><kbd>Verifies boolean conditions</kbd><br><br><br><h4 style="margin:0px">Class: datafu.hourglass.demo.Examples </h4><pre class="type-2 type-3 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void estimateNumMembers() throws IOException, InterruptedException, ClassNotFoundException {
  openDayForEvent(2013,3,1);
  for (int i=1; i <= 10000; i++) {
    storeIds(i);
  }
  closeDayForEvent();
  for (int i=2; i <= 30; i++) {
    openDayForEvent(2013,3,i);
    storeIds(1,2,3,4,5);
    closeDayForEvent();
  }
  new EstimateCardinality().run(createJobConf(),getDataPath() + "/data/event",getDataPath() + "/output/daily",getDataPath() + "/output/summary",30);
  checkIntermediateFolderCount(new Path(getDataPath(),"output/daily"),30);
  checkOutputFolderCount(new Path(getDataPath(),"output/summary"),1);
  Assert.assertTrue(Math.abs(10000L - loadMemberCount(new Path(getDataPath(),"output/summary"),"20130330").longValue()) / 10000.0 < 0.005);
  openDayForEvent(2013,3,31);
  storeIds(6,7,8,9,10);
  closeDayForEvent();
  new EstimateCardinality().run(createJobConf(),getDataPath() + "/data/event",getDataPath() + "/output/daily",getDataPath() + "/output/summary",30);
  checkIntermediateFolderCount(new Path(getDataPath(),"output/daily"),31);
  checkOutputFolderCount(new Path(getDataPath(),"output/summary"),1);
  Assert.assertEquals(loadMemberCount(new Path(getDataPath(),"output/summary"),"20130331").longValue(),10L);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: datafu.test.pig.hash.lsh.LSHPigTest </h4><pre class="type-9 type-8 type-2 type-7 type-3 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testSparseVectors() throws IOException, ParseException {
  RandomGenerator rg=new JDKRandomGenerator();
  rg.setSeed(0);
  RandomData rd=new RandomDataImpl(rg);
  int n=20;
  List<RealVector> vectors=LSHTest.getVectors(rd,1000,n);
  PigTest test=createPigTestFromString(sparseVectorTest);
  writeLinesToFile("input",getSparseLines(vectors));
  test.runScript();
  List<Tuple> neighbors=this.getLinesForAlias(test,"PTS");
  Assert.assertEquals(neighbors.size(),n);
  int idx=0;
  for (  Tuple t : neighbors) {
    Assert.assertTrue(t.get(0) instanceof DataBag);
    Assert.assertEquals(t.size(),1);
    RealVector interpreted=DataTypeUtil.INSTANCE.convert(t,3);
    RealVector original=vectors.get(idx);
    Assert.assertEquals(original.getDimension(),interpreted.getDimension());
    for (int i=0; i < interpreted.getDimension(); ++i) {
      double originalField=original.getEntry(i);
      double interpretedField=interpreted.getEntry(i);
      Assert.assertTrue(Math.abs(originalField - interpretedField) < 1e-5);
    }
    idx++;
  }
}

</code></pre>

<br>
<pre class="type-8 type-2 type-7 type-3 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testL2UDF() throws Exception {
  setMemorySettings();
  RandomGenerator rg=new JDKRandomGenerator();
  rg.setSeed(0);
  RandomData rd=new RandomDataImpl(rg);
  int n=1000;
  List<RealVector> vectors=LSHTest.getVectors(rd,1000,n);
  PigTest test=createPigTestFromString(l2Test);
  writeLinesToFile("input",getLines(vectors));
  List<RealVector> queries=LSHTest.getVectors(rd,1000,10);
  writeLinesToFile("queries",getLines(queries));
  test.runScript();
  List<Tuple> neighbors=this.getLinesForAlias(test,"NEIGHBOR_CNT");
  Assert.assertEquals(queries.size(),neighbors.size());
  for (  long cnt : getCounts(neighbors)) {
    Assert.assertTrue(cnt >= 3);
  }
  Distance d=new Distance(){
    @Override public double distance(    RealVector v1,    RealVector v2){
      return L2.distance(v1,v2);
    }
  }
;
  verifyPoints(neighbors,d,1000);
}

</code></pre>

<br>
<pre class="type-8 type-2 type-7 type-3 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testCosineUDF() throws Exception {
  setMemorySettings();
  RandomGenerator rg=new JDKRandomGenerator();
  rg.setSeed(0);
  RandomData rd=new RandomDataImpl(rg);
  int n=1000;
  List<RealVector> vectors=LSHTest.getVectors(rd,1000,n);
  PigTest test=createPigTestFromString(cosTest);
  writeLinesToFile("input",getLines(vectors));
  List<RealVector> queries=LSHTest.getVectors(rd,1000,10);
  writeLinesToFile("queries",getLines(queries));
  test.runScript();
  List<Tuple> neighbors=this.getLinesForAlias(test,"NEIGHBOR_CNT");
  Assert.assertEquals(queries.size(),neighbors.size());
  for (  long cnt : getCounts(neighbors)) {
    Assert.assertTrue(cnt >= 2);
  }
  Distance d=new Distance(){
    @Override public double distance(    RealVector v1,    RealVector v2){
      return Cosine.distance(v1,v2);
    }
  }
;
  verifyPoints(neighbors,d,.001);
}

</code></pre>

<br>
<pre class="type-8 type-2 type-7 type-3 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testL1UDFSparse() throws Exception {
  setMemorySettings();
  RandomGenerator rg=new JDKRandomGenerator();
  rg.setSeed(0);
  RandomData rd=new RandomDataImpl(rg);
  int n=1000;
  List<RealVector> vectors=LSHTest.getVectors(rd,1000,n);
  PigTest test=createPigTestFromString(l1SparseTest);
  writeLinesToFile("input",getSparseLines(vectors));
  List<RealVector> queries=LSHTest.getVectors(rd,1000,10);
  writeLinesToFile("queries",getSparseLines(queries));
  test.runScript();
  List<Tuple> neighbors=this.getLinesForAlias(test,"NEIGHBOR_CNT");
  Assert.assertEquals(queries.size(),neighbors.size());
  for (  long cnt : getCounts(neighbors)) {
    Assert.assertTrue(cnt >= 3);
  }
  Distance d=new Distance(){
    @Override public double distance(    RealVector v1,    RealVector v2){
      return L1.distance(v1,v2);
    }
  }
;
  verifyPoints(neighbors,d,1000);
}

</code></pre>

<br>
<pre class="type-8 type-2 type-7 type-3 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testL1UDF() throws Exception {
  setMemorySettings();
  RandomGenerator rg=new JDKRandomGenerator();
  rg.setSeed(0);
  RandomData rd=new RandomDataImpl(rg);
  int n=1000;
  List<RealVector> vectors=LSHTest.getVectors(rd,1000,n);
  PigTest test=createPigTestFromString(l1Test);
  writeLinesToFile("input",getLines(vectors));
  List<RealVector> queries=LSHTest.getVectors(rd,1000,10);
  writeLinesToFile("queries",getLines(queries));
  test.runScript();
  List<Tuple> neighbors=this.getLinesForAlias(test,"NEIGHBOR_CNT");
  Assert.assertEquals(queries.size(),neighbors.size());
  for (  long cnt : getCounts(neighbors)) {
    Assert.assertTrue(cnt >= 3);
  }
  Distance d=new Distance(){
    @Override public double distance(    RealVector v1,    RealVector v2){
      return L1.distance(v1,v2);
    }
  }
;
  verifyPoints(neighbors,d,1000);
}

</code></pre>

<br>
<pre class="type-8 type-2 type-7 type-3 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testRandomSeed() throws Exception {
  setMemorySettings();
  RandomGenerator rg=new JDKRandomGenerator();
  rg.setSeed(0);
  RandomData rd=new RandomDataImpl(rg);
  int n=10;
  List<RealVector> vectors=LSHTest.getVectors(rd,1000,n);
  writeLinesToFile("input",getLines(vectors));
  Map<String,Long> hashes=new HashMap<String,Long>();
  int numDiff=0;
  int numHashes=0;
{
    PigTest test=createPigTestFromString(randomSeedTest);
    test.runScript();
    List<Tuple> pts=this.getLinesForAlias(test,"PTS_HASHED");
    numHashes=pts.size();
    for (    Tuple t : pts) {
      String key=((Tuple)t.get(0)).toString() + t.get(1).toString();
      Long value=(Long)t.get(2);
      hashes.put(key,value);
    }
  }
{
    PigTest test=createPigTestFromString(randomSeedTest);
    test.runScript();
    List<Tuple> pts=this.getLinesForAlias(test,"PTS_HASHED");
    Assert.assertEquals(numHashes,pts.size());
    for (    Tuple t : pts) {
      String key=((Tuple)t.get(0)).toString() + t.get(1).toString();
      Long value=(Long)t.get(2);
      Long refValue=hashes.get(key);
      if (!value.equals(refValue)) {
        numDiff++;
      }
    }
  }
  System.out.println(1.0 * numDiff / numHashes);
  Assert.assertTrue(1.0 * numDiff / numHashes > .8);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: datafu.test.pig.linkanalysis.PageRankTests </h4><pre class="type-9 type-8 type-2 type-7 type-3 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void pigPageRankTest() throws Exception {
  PigTest test=createPigTestFromString(pageRankTest);
  String[] edges=PageRankImplTests.getWikiExampleEdges();
  Map<String,Integer> nodeIds=new HashMap<String,Integer>();
  Map<Integer,String> nodeIdsReversed=new HashMap<Integer,String>();
  Map<String,Float> expectedRanks=PageRankImplTests.parseExpectedRanks(PageRankImplTests.getWikiExampleExpectedRanks());
  File f=new File(System.getProperty("user.dir"),"input").getAbsoluteFile();
  if (f.exists()) {
    f.delete();
  }
  FileWriter writer=new FileWriter(f);
  BufferedWriter bufferedWriter=new BufferedWriter(writer);
  for (  String edge : edges) {
    String[] edgeParts=edge.split(" ");
    String source=edgeParts[0];
    String dest=edgeParts[1];
    if (!nodeIds.containsKey(source)) {
      int id=nodeIds.size();
      nodeIds.put(source,id);
      nodeIdsReversed.put(id,source);
    }
    if (!nodeIds.containsKey(dest)) {
      int id=nodeIds.size();
      nodeIds.put(dest,id);
      nodeIdsReversed.put(id,dest);
    }
    Integer sourceId=nodeIds.get(source);
    Integer destId=nodeIds.get(dest);
    StringBuffer sb=new StringBuffer();
    sb.append("1\t");
    sb.append(sourceId.toString() + "\t");
    sb.append(destId.toString() + "\t");
    sb.append("1.0\n");
    bufferedWriter.write(sb.toString());
  }
  bufferedWriter.close();
  test.runScript();
  Iterator<Tuple> tuples=test.getAlias("data_grouped3");
  System.out.println("Final node ranks:");
  int nodeCount=0;
  while (tuples.hasNext()) {
    Tuple nodeTuple=tuples.next();
    Integer topic=(Integer)nodeTuple.get(0);
    Integer nodeId=(Integer)nodeTuple.get(1);
    Float nodeRank=(Float)nodeTuple.get(2);
    assertEquals(1,topic.intValue());
    System.out.println(String.format("%d => %f",nodeId,nodeRank));
    Float expectedNodeRank=expectedRanks.get(nodeIdsReversed.get(nodeId));
    assertTrue(Math.abs(expectedNodeRank - nodeRank * 100.0f) < 0.1,String.format("expected: %f, actual: %f",expectedNodeRank,nodeRank));
    nodeCount++;
  }
  assertEquals(nodeIds.size(),nodeCount);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: datafu.test.pig.random.NumberTests </h4><pre class="type-2 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
/** 
 * Test the RandomIntRange UDF.  The main purpose is to make sure it can be used in a Pig script.
 * Also the range of output values is tested.
 * @throws Exception
 */
@Test public void randomIntRangeTest() throws Exception {
  PigTest test=createPigTestFromString(randomIntRangeTest,"MIN=1","MAX=10");
  List<String> input=new ArrayList<String>();
  for (int i=0; i < 100; i++) {
    input.add(String.format("(%d)",i));
  }
  writeLinesToFile("input",input.toArray(new String[0]));
  test.runScript();
  List<Tuple> tuples=getLinesForAlias(test,"data2",false);
  for (  Tuple tuple : tuples) {
    Integer randValue=(Integer)tuple.get(1);
    assertTrue(randValue >= 1);
    assertTrue(randValue <= 10);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: datafu.test.pig.sampling.SamplingTests </h4><pre class="type-2 type-3 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void sampleByKeyExecTest() throws Exception {
  SampleByKey sampler=new SampleByKey("0.10","thesalt");
  Map<Integer,Integer> valuesPerKey=new HashMap<Integer,Integer>();
  for (int i=0; i < 10000; i++) {
    for (int j=0; j < 5; j++) {
      Tuple t=TupleFactory.getInstance().newTuple(1);
      t.set(0,i);
      if (sampler.exec(t)) {
        if (valuesPerKey.containsKey(i)) {
          valuesPerKey.put(i,valuesPerKey.get(i) + 1);
        }
 else {
          valuesPerKey.put(i,1);
        }
      }
    }
  }
  Assert.assertTrue(Math.abs(1000 - valuesPerKey.size()) < 50);
  for (  Map.Entry<Integer,Integer> pair : valuesPerKey.entrySet()) {
    Assert.assertEquals(5,pair.getValue().intValue());
  }
}

</code></pre>

<br>
<pre class="type-2 type-7 type-3 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void reservoirSampleAccumulateTest() throws IOException {
  ReservoirSample sampler=new ReservoirSample("10");
  for (int i=0; i < 100; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(1);
    t.set(0,i);
    DataBag bag=BagFactory.getInstance().newDefaultBag();
    bag.add(t);
    Tuple input=TupleFactory.getInstance().newTuple(bag);
    sampler.accumulate(input);
  }
  DataBag result=sampler.getValue();
  Assert.assertEquals(10,result.size());
  Set<Integer> found=new HashSet<Integer>();
  for (  Tuple t : result) {
    Integer i=(Integer)t.get(0);
    System.out.println(i);
    Assert.assertTrue(i >= 0 && i < 100);
    Assert.assertFalse(String.format("Found duplicate of %d",i),found.contains(i));
    found.add(i);
  }
}

</code></pre>

<br>
<pre class="type-8 type-2 type-7 type-3 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void reservoirSampleAlgebraicTest() throws IOException {
  ReservoirSample.Initial initialSampler=new ReservoirSample.Initial("10");
  ReservoirSample.Intermediate intermediateSampler=new ReservoirSample.Intermediate("10");
  ReservoirSample.Final finalSampler=new ReservoirSample.Final("10");
  DataBag bag=BagFactory.getInstance().newDefaultBag();
  for (int i=0; i < 100; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(1);
    t.set(0,i);
    bag.add(t);
  }
  Tuple input=TupleFactory.getInstance().newTuple(bag);
  Tuple intermediateTuple=initialSampler.exec(input);
  DataBag intermediateBag=BagFactory.getInstance().newDefaultBag(Arrays.asList(intermediateTuple));
  intermediateTuple=intermediateSampler.exec(TupleFactory.getInstance().newTuple(intermediateBag));
  intermediateBag=BagFactory.getInstance().newDefaultBag(Arrays.asList(intermediateTuple));
  DataBag result=finalSampler.exec(TupleFactory.getInstance().newTuple(intermediateBag));
  Assert.assertEquals(10,result.size());
  Set<Integer> found=new HashSet<Integer>();
  for (  Tuple t : result) {
    Integer i=(Integer)t.get(0);
    System.out.println(i);
    Assert.assertTrue(i >= 0 && i < 100);
    Assert.assertFalse(String.format("Found duplicate of %d",i),found.contains(i));
    found.add(i);
  }
}

</code></pre>

<br>
<pre class="type-2 type-7 type-3 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void weightedSampleLimitExecTest() throws IOException {
  WeightedSample sampler=new WeightedSample();
  DataBag bag=BagFactory.getInstance().newDefaultBag();
  for (int i=0; i < 100; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(2);
    t.set(0,i);
    t.set(1,1);
    bag.add(t);
  }
  Tuple input=TupleFactory.getInstance().newTuple(3);
  input.set(0,bag);
  input.set(1,1);
  input.set(2,10);
  DataBag result=sampler.exec(input);
  Assert.assertEquals(10,result.size());
  Set<Integer> found=new HashSet<Integer>();
  for (  Tuple t : result) {
    Integer i=(Integer)t.get(0);
    System.out.println(i);
    Assert.assertTrue(i >= 0 && i < 100);
    Assert.assertFalse(String.format("Found duplicate of %d",i),found.contains(i));
    found.add(i);
  }
}

</code></pre>

<br>
<pre class="type-8 type-2 type-7 type-3 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void reservoirSampleExecTest() throws IOException {
  ReservoirSample sampler=new ReservoirSample("10");
  DataBag bag=BagFactory.getInstance().newDefaultBag();
  for (int i=0; i < 100; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(1);
    t.set(0,i);
    bag.add(t);
  }
  Tuple input=TupleFactory.getInstance().newTuple(bag);
  DataBag result=sampler.exec(input);
  Assert.assertEquals(10,result.size());
  Set<Integer> found=new HashSet<Integer>();
  for (  Tuple t : result) {
    Integer i=(Integer)t.get(0);
    System.out.println(i);
    Assert.assertTrue(i >= 0 && i < 100);
    Assert.assertFalse(String.format("Found duplicate of %d",i),found.contains(i));
    found.add(i);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: datafu.test.pig.sampling.WeightedReservoirSamplingTests </h4><pre class="type-10 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void invalidConstructorArgTest() throws Exception {
  try {
    WeightedReservoirSample sampler=new WeightedReservoirSample("1","-1");
    Assert.fail("Testcase should fail");
  }
 catch (  Exception ex) {
    Assert.assertTrue(ex.getMessage().indexOf("Invalid negative index of weight field argument for WeightedReserviorSample constructor: -1") >= 0);
  }
}

</code></pre>

<br>
<pre class="type-10 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void invalidWeightFieldSchemaTest() throws Exception {
  PigTest test=createPigTestFromString(invalidWeightFieldSchemaTest);
  writeLinesToFile("input","a\t100","b\t1","c\t5","d\t2");
  try {
    test.runScript();
    List<Tuple> output=this.getLinesForAlias(test,"sampled");
    Assert.fail("Testcase should fail");
  }
 catch (  Exception ex) {
    Assert.assertTrue(ex.getMessage().indexOf("Expect the type of the weight field of the input tuple to be of ([int, long, float, double]), but instead found (chararray), weight field: 0") >= 0);
  }
}

</code></pre>

<br>
<pre class="type-10 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void invalidInputTupleSizeTest() throws Exception {
  PigTest test=createPigTestFromString(invalidInputTupleSizeTest);
  writeLinesToFile("input","a","b","c","d");
  try {
    test.runScript();
    List<Tuple> output=this.getLinesForAlias(test,"sampled");
    Assert.fail("Testcase should fail");
  }
 catch (  Exception ex) {
    Assert.assertTrue(ex.getMessage().indexOf("The field schema of the input tuple is null or the tuple size is no more than the weight field index: 1") >= 0);
  }
}

</code></pre>

<br>
<pre class="type-9 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies boolean conditions
"></span><br>
@Test public void weightedReservoirSampleLimitExecTest() throws IOException {
  WeightedReservoirSample sampler=new WeightedReservoirSample("100","1");
  DataBag bag=BagFactory.getInstance().newDefaultBag();
  for (int i=0; i < 10; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(2);
    t.set(0,i);
    t.set(1,1);
    bag.add(t);
  }
  Tuple input=TupleFactory.getInstance().newTuple(1);
  input.set(0,bag);
  DataBag result=sampler.exec(input);
  verifyNoRepeatAllFound(result,10,0,10);
  Set<Integer> found=new HashSet<Integer>();
  for (  Tuple t : result) {
    Integer i=(Integer)t.get(0);
    found.add(i);
  }
  for (int i=0; i < 10; i++) {
    Assert.assertTrue(found.contains(i));
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: datafu.test.pig.sessions.SessionTests </h4><pre class="type-2 type-3 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void sessionizeTest() throws Exception {
  PigTest test=createPigTestFromString(sessionizeTest,"TIME_WINDOW=30m","TIME_TYPE=chararray");
  this.writeLinesToFile("input",inputData);
  test.runScript();
  HashMap<Integer,HashMap<Integer,Boolean>> userValues=new HashMap<Integer,HashMap<Integer,Boolean>>();
  for (  Tuple t : this.getLinesForAlias(test,"max_value")) {
    Integer userId=(Integer)t.get(0);
    Integer max=(Integer)t.get(1);
    if (!userValues.containsKey(userId)) {
      userValues.put(userId,new HashMap<Integer,Boolean>());
    }
    userValues.get(userId).put(max,true);
  }
  assertEquals(userValues.get(1).size(),2);
  assertEquals(userValues.get(2).size(),5);
  assertEquals(userValues.get(3).size(),1);
  assertTrue(userValues.get(1).containsKey(20));
  assertTrue(userValues.get(1).containsKey(30));
  assertTrue(userValues.get(2).containsKey(10));
  assertTrue(userValues.get(2).containsKey(20));
  assertTrue(userValues.get(2).containsKey(30));
  assertTrue(userValues.get(2).containsKey(40));
  assertTrue(userValues.get(2).containsKey(50));
  assertTrue(userValues.get(3).containsKey(50));
}

</code></pre>

<br>
<pre class="type-2 type-7 type-3 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void sessionizeAccumulateTest() throws Exception {
  Sessionize sessionize=new Sessionize("30m");
  Tuple input=TupleFactory.getInstance().newTuple(1);
  DataBag inputBag=BagFactory.getInstance().newDefaultBag();
  input.set(0,inputBag);
  Tuple item;
  List<Tuple> result;
  DateTime dt;
  dt=new DateTime();
  item=TupleFactory.getInstance().newTuple(1);
  item.set(0,dt.getMillis());
  inputBag.add(item);
  sessionize.accumulate(input);
  inputBag.clear();
  item=TupleFactory.getInstance().newTuple(1);
  item.set(0,dt.plusMinutes(28).getMillis());
  inputBag.add(item);
  sessionize.accumulate(input);
  inputBag.clear();
  result=toList(sessionize.getValue());
  Assert.assertEquals(2,result.size());
  Assert.assertEquals(2,result.get(0).size());
  Assert.assertEquals(2,result.get(1).size());
  Assert.assertTrue(result.get(0).get(1).equals(result.get(1).get(1)));
  sessionize.cleanup();
  dt=new DateTime();
  item=TupleFactory.getInstance().newTuple(1);
  item.set(0,dt.getMillis());
  inputBag.add(item);
  sessionize.accumulate(input);
  inputBag.clear();
  item=TupleFactory.getInstance().newTuple(1);
  item.set(0,dt.plusMinutes(31).getMillis());
  inputBag.add(item);
  sessionize.accumulate(input);
  inputBag.clear();
  result=toList(sessionize.getValue());
  Assert.assertEquals(2,result.size());
  Assert.assertEquals(2,result.get(0).size());
  Assert.assertEquals(2,result.get(1).size());
  Assert.assertFalse(result.get(0).get(1).equals(result.get(1).get(1)));
  sessionize.cleanup();
  Assert.assertEquals(0,sessionize.getValue().size());
}

</code></pre>

<br>
<pre class="type-8 type-2 type-3 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void sessionizeLongTest() throws Exception {
  PigTest test=createPigTestFromString(sessionizeTest,"TIME_WINDOW=30m","TIME_TYPE=long");
  List<String> lines=new ArrayList<String>();
  for (  String line : inputData) {
    String[] parts=line.split("\t");
    Assert.assertEquals(3,parts.length);
    parts[0]=Long.toString(dateFormat.parse(parts[0]).getTime());
    lines.add(StringUtils.join(parts,"\t"));
  }
  this.writeLinesToFile("input",lines.toArray(new String[]{}));
  test.runScript();
  HashMap<Integer,HashMap<Integer,Boolean>> userValues=new HashMap<Integer,HashMap<Integer,Boolean>>();
  for (  Tuple t : this.getLinesForAlias(test,"max_value")) {
    Integer userId=(Integer)t.get(0);
    Integer max=(Integer)t.get(1);
    if (!userValues.containsKey(userId)) {
      userValues.put(userId,new HashMap<Integer,Boolean>());
    }
    userValues.get(userId).put(max,true);
  }
  assertEquals(userValues.get(1).size(),2);
  assertEquals(userValues.get(2).size(),5);
  assertTrue(userValues.get(1).containsKey(20));
  assertTrue(userValues.get(1).containsKey(30));
  assertTrue(userValues.get(2).containsKey(10));
  assertTrue(userValues.get(2).containsKey(20));
  assertTrue(userValues.get(2).containsKey(30));
  assertTrue(userValues.get(2).containsKey(40));
  assertTrue(userValues.get(2).containsKey(50));
}

</code></pre>

<br>
<pre class="type-2 type-7 type-3 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void sessionizeExecTest() throws Exception {
  Sessionize sessionize=new Sessionize("30m");
  Tuple input=TupleFactory.getInstance().newTuple(1);
  DataBag inputBag=BagFactory.getInstance().newDefaultBag();
  input.set(0,inputBag);
  Tuple item;
  List<Tuple> result;
  DateTime dt;
  inputBag.clear();
  dt=new DateTime();
  item=TupleFactory.getInstance().newTuple(1);
  item.set(0,dt.getMillis());
  inputBag.add(item);
  item=TupleFactory.getInstance().newTuple(1);
  item.set(0,dt.plusMinutes(28).getMillis());
  inputBag.add(item);
  result=toList(sessionize.exec(input));
  Assert.assertEquals(2,result.size());
  Assert.assertEquals(2,result.get(0).size());
  Assert.assertEquals(2,result.get(1).size());
  Assert.assertTrue(result.get(0).get(1).equals(result.get(1).get(1)));
  inputBag.clear();
  dt=new DateTime();
  item=TupleFactory.getInstance().newTuple(1);
  item.set(0,dt.getMillis());
  inputBag.add(item);
  item=TupleFactory.getInstance().newTuple(1);
  item.set(0,dt.plusMinutes(31).getMillis());
  inputBag.add(item);
  result=toList(sessionize.exec(input));
  Assert.assertEquals(2,result.size());
  Assert.assertEquals(2,result.get(0).size());
  Assert.assertEquals(2,result.get(1).size());
  Assert.assertFalse(result.get(0).get(1).equals(result.get(1).get(1)));
}

</code></pre>

<br>
<h4 style="margin:0px">Class: datafu.test.pig.stats.EstimationTests </h4><pre class="type-8 type-2 type-7 type-3 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void hyperLogLogTest() throws Exception {
  PigTest test=createPigTestFromString(hyperLogLogTest);
  int count=1000000;
  String[] input=new String[count];
  for (int i=0; i < count; i++) {
    input[i]=Integer.toString(i * 10);
  }
  writeLinesToFile("input",input);
  test.runScript();
  List<Tuple> output=getLinesForAlias(test,"data_out",true);
  assertEquals(output.size(),1);
  double error=Math.abs(count - ((Long)output.get(0).get(0))) / (double)count;
  System.out.println("error: " + error * 100.0 + "%");
  assertTrue(error < 0.01);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: datafu.test.pig.stats.VARTests </h4><pre class="type-8 type-2 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void varDoubleAlgebraicIntermediateTest() throws Exception {
  DoubleVAR.Initial initialVar=new DoubleVAR.Initial();
  DoubleVAR.Intermediate intermediateVar=new DoubleVAR.Intermediate();
  DoubleVAR.Final finalVar=new DoubleVAR.Final();
  DataBag intermediateBag=BagFactory.getInstance().newDefaultBag();
  for (int i=1; i <= 1000; i++) {
    DataBag bag;
    Tuple t=TupleFactory.getInstance().newTuple(1);
    t.set(0,(double)i);
    bag=BagFactory.getInstance().newDefaultBag();
    bag.add(t);
    Tuple input=TupleFactory.getInstance().newTuple(bag);
    Tuple intermediateTuple=initialVar.exec(input);
    intermediateBag.add(intermediateTuple);
  }
  Tuple intermediateTuple=intermediateVar.exec(TupleFactory.getInstance().newTuple(intermediateBag));
  intermediateBag=BagFactory.getInstance().newDefaultBag(Arrays.asList(intermediateTuple));
  Double result=finalVar.exec(TupleFactory.getInstance().newTuple(intermediateBag));
  Assert.assertTrue("Expected about 83333.25 but found " + result,Math.abs(83333.25 - result) < 0.0001);
}

</code></pre>

<br>
<pre class="type-8 type-2 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void varLongAlgebraicFinalTest() throws Exception {
  LongVAR.Initial initialVar=new LongVAR.Initial();
  LongVAR.Intermediate intermediateVar=new LongVAR.Intermediate();
  LongVAR.Final finalVar=new LongVAR.Final();
  DataBag finalBag=BagFactory.getInstance().newDefaultBag();
  for (int i=1; i <= 1000; i++) {
    DataBag bag;
    Tuple t=TupleFactory.getInstance().newTuple(1);
    t.set(0,(long)i);
    bag=BagFactory.getInstance().newDefaultBag();
    bag.add(t);
    Tuple input=TupleFactory.getInstance().newTuple(bag);
    Tuple intermediateTuple=initialVar.exec(input);
    DataBag intermediateBag=BagFactory.getInstance().newDefaultBag();
    intermediateBag.add(intermediateTuple);
    intermediateTuple=intermediateVar.exec(TupleFactory.getInstance().newTuple(intermediateBag));
    finalBag.add(intermediateTuple);
  }
  Double result=finalVar.exec(TupleFactory.getInstance().newTuple(finalBag));
  Assert.assertTrue("Expected about 83333.25 but found " + result,Math.abs(83333.25 - result) < 0.0001);
}

</code></pre>

<br>
<pre class="type-8 type-2 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void varLongAlgebraicIntermediateTest() throws Exception {
  LongVAR.Initial initialVar=new LongVAR.Initial();
  LongVAR.Intermediate intermediateVar=new LongVAR.Intermediate();
  LongVAR.Final finalVar=new LongVAR.Final();
  DataBag intermediateBag=BagFactory.getInstance().newDefaultBag();
  for (int i=1; i <= 1000; i++) {
    DataBag bag;
    Tuple t=TupleFactory.getInstance().newTuple(1);
    t.set(0,(long)i);
    bag=BagFactory.getInstance().newDefaultBag();
    bag.add(t);
    Tuple input=TupleFactory.getInstance().newTuple(bag);
    Tuple intermediateTuple=initialVar.exec(input);
    intermediateBag.add(intermediateTuple);
  }
  Tuple intermediateTuple=intermediateVar.exec(TupleFactory.getInstance().newTuple(intermediateBag));
  intermediateBag=BagFactory.getInstance().newDefaultBag(Arrays.asList(intermediateTuple));
  Double result=finalVar.exec(TupleFactory.getInstance().newTuple(intermediateBag));
  Assert.assertTrue("Expected about 83333.25 but found " + result,Math.abs(83333.25 - result) < 0.0001);
}

</code></pre>

<br>
<pre class="type-8 type-2 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void varIntAlgebraicFinalTest() throws Exception {
  IntVAR.Initial initialVar=new IntVAR.Initial();
  IntVAR.Intermediate intermediateVar=new IntVAR.Intermediate();
  IntVAR.Final finalVar=new IntVAR.Final();
  DataBag finalBag=BagFactory.getInstance().newDefaultBag();
  for (int i=1; i <= 1000; i++) {
    DataBag bag;
    Tuple t=TupleFactory.getInstance().newTuple(1);
    t.set(0,(int)i);
    bag=BagFactory.getInstance().newDefaultBag();
    bag.add(t);
    Tuple input=TupleFactory.getInstance().newTuple(bag);
    Tuple intermediateTuple=initialVar.exec(input);
    DataBag intermediateBag=BagFactory.getInstance().newDefaultBag();
    intermediateBag.add(intermediateTuple);
    intermediateTuple=intermediateVar.exec(TupleFactory.getInstance().newTuple(intermediateBag));
    finalBag.add(intermediateTuple);
  }
  Double result=finalVar.exec(TupleFactory.getInstance().newTuple(finalBag));
  Assert.assertTrue("Expected about 83333.25 but found " + result,Math.abs(83333.25 - result) < 0.0001);
}

</code></pre>

<br>
<pre class="type-8 type-2 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void varFloatAlgebraicFinalTest() throws Exception {
  FloatVAR.Initial initialVar=new FloatVAR.Initial();
  FloatVAR.Intermediate intermediateVar=new FloatVAR.Intermediate();
  FloatVAR.Final finalVar=new FloatVAR.Final();
  DataBag finalBag=BagFactory.getInstance().newDefaultBag();
  for (int i=1; i <= 1000; i++) {
    DataBag bag;
    Tuple t=TupleFactory.getInstance().newTuple(1);
    t.set(0,(float)i);
    bag=BagFactory.getInstance().newDefaultBag();
    bag.add(t);
    Tuple input=TupleFactory.getInstance().newTuple(bag);
    Tuple intermediateTuple=initialVar.exec(input);
    DataBag intermediateBag=BagFactory.getInstance().newDefaultBag();
    intermediateBag.add(intermediateTuple);
    intermediateTuple=intermediateVar.exec(TupleFactory.getInstance().newTuple(intermediateBag));
    finalBag.add(intermediateTuple);
  }
  Double result=finalVar.exec(TupleFactory.getInstance().newTuple(finalBag));
  Assert.assertTrue("Expected about 83333.25 but found " + result,Math.abs(83333.25 - result) < 0.0001);
}

</code></pre>

<br>
<pre class="type-8 type-2 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void varFloatAlgebraicIntermediateTest() throws Exception {
  FloatVAR.Initial initialVar=new FloatVAR.Initial();
  FloatVAR.Intermediate intermediateVar=new FloatVAR.Intermediate();
  FloatVAR.Final finalVar=new FloatVAR.Final();
  DataBag intermediateBag=BagFactory.getInstance().newDefaultBag();
  for (int i=1; i <= 1000; i++) {
    DataBag bag;
    Tuple t=TupleFactory.getInstance().newTuple(1);
    t.set(0,(float)i);
    bag=BagFactory.getInstance().newDefaultBag();
    bag.add(t);
    Tuple input=TupleFactory.getInstance().newTuple(bag);
    Tuple intermediateTuple=initialVar.exec(input);
    intermediateBag.add(intermediateTuple);
  }
  Tuple intermediateTuple=intermediateVar.exec(TupleFactory.getInstance().newTuple(intermediateBag));
  intermediateBag=BagFactory.getInstance().newDefaultBag(Arrays.asList(intermediateTuple));
  Double result=finalVar.exec(TupleFactory.getInstance().newTuple(intermediateBag));
  Assert.assertTrue("Expected about 83333.25 but found " + result,Math.abs(83333.25 - result) < 0.0001);
}

</code></pre>

<br>
<pre class="type-2 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void varAccumulateTest() throws Exception {
  DoubleVAR var=new DoubleVAR();
  Double result;
  for (int i=1; i <= 1000; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(1);
    t.set(0,(double)i);
    DataBag bag=BagFactory.getInstance().newDefaultBag();
    bag.add(t);
    Tuple input=TupleFactory.getInstance().newTuple(1);
    input.set(0,bag);
    var.accumulate(input);
  }
  result=var.getValue();
  Assert.assertTrue("Expected about 83333.25 but found " + result,Math.abs(83333.25 - result) < 0.0001);
  var.cleanup();
  for (int i=1; i <= 2000; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(1);
    t.set(0,(double)i);
    DataBag bag=BagFactory.getInstance().newDefaultBag();
    bag.add(t);
    Tuple input=TupleFactory.getInstance().newTuple(1);
    input.set(0,bag);
    var.accumulate(input);
  }
  result=var.getValue();
  Assert.assertTrue("Expected about 333333.2 but found " + result,Math.abs(333333.2 - result) < 1);
}

</code></pre>

<br>
<pre class="type-8 type-2 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void varDoubleAlgebraicFinalTest() throws Exception {
  DoubleVAR.Initial initialVar=new DoubleVAR.Initial();
  DoubleVAR.Intermediate intermediateVar=new DoubleVAR.Intermediate();
  DoubleVAR.Final finalVar=new DoubleVAR.Final();
  DataBag finalBag=BagFactory.getInstance().newDefaultBag();
  for (int i=1; i <= 1000; i++) {
    DataBag bag;
    Tuple t=TupleFactory.getInstance().newTuple(1);
    t.set(0,(double)i);
    bag=BagFactory.getInstance().newDefaultBag();
    bag.add(t);
    Tuple input=TupleFactory.getInstance().newTuple(bag);
    Tuple intermediateTuple=initialVar.exec(input);
    DataBag intermediateBag=BagFactory.getInstance().newDefaultBag();
    intermediateBag.add(intermediateTuple);
    intermediateTuple=intermediateVar.exec(TupleFactory.getInstance().newTuple(intermediateBag));
    finalBag.add(intermediateTuple);
  }
  Double result=finalVar.exec(TupleFactory.getInstance().newTuple(finalBag));
  Assert.assertTrue("Expected about 83333.25 but found " + result,Math.abs(83333.25 - result) < 0.0001);
}

</code></pre>

<br>
<pre class="type-2 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void varExecTest() throws Exception {
  DoubleVAR var=new DoubleVAR();
  DataBag bag;
  Tuple input;
  Double result;
  bag=BagFactory.getInstance().newDefaultBag();
  for (int i=1; i <= 1000; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(1);
    t.set(0,(double)i);
    bag.add(t);
  }
  input=TupleFactory.getInstance().newTuple(1);
  input.set(0,bag);
  result=var.exec(input);
  Assert.assertTrue("Expected about 83333.25 but found " + result,Math.abs(83333.25 - result) < 0.0001);
  bag=BagFactory.getInstance().newDefaultBag();
  for (int i=1; i <= 2000; i++) {
    Tuple t=TupleFactory.getInstance().newTuple(1);
    t.set(0,(double)i);
    bag.add(t);
  }
  input=TupleFactory.getInstance().newTuple(1);
  input.set(0,bag);
  result=var.exec(input);
  Assert.assertTrue("Expected about 333333.2 but found " + result,Math.abs(333333.2 - result) < 1);
}

</code></pre>

<br>
<pre class="type-8 type-2 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void varIntAlgebraicIntermediateTest() throws Exception {
  IntVAR.Initial initialVar=new IntVAR.Initial();
  IntVAR.Intermediate intermediateVar=new IntVAR.Intermediate();
  IntVAR.Final finalVar=new IntVAR.Final();
  DataBag intermediateBag=BagFactory.getInstance().newDefaultBag();
  for (int i=1; i <= 1000; i++) {
    DataBag bag;
    Tuple t=TupleFactory.getInstance().newTuple(1);
    t.set(0,(int)i);
    bag=BagFactory.getInstance().newDefaultBag();
    bag.add(t);
    Tuple input=TupleFactory.getInstance().newTuple(bag);
    Tuple intermediateTuple=initialVar.exec(input);
    intermediateBag.add(intermediateTuple);
  }
  Tuple intermediateTuple=intermediateVar.exec(TupleFactory.getInstance().newTuple(intermediateBag));
  intermediateBag=BagFactory.getInstance().newDefaultBag(Arrays.asList(intermediateTuple));
  Double result=finalVar.exec(TupleFactory.getInstance().newTuple(intermediateBag));
  Assert.assertTrue("Expected about 83333.25 but found " + result,Math.abs(83333.25 - result) < 0.0001);
}

</code></pre>

<br>
<h4 style="margin:0px">Class: datafu.test.pig.stats.WilsonBinConfTests </h4><pre class="type-8 type-2 type-7 type-3 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void wilsonTest() throws Exception {
  PigTest test=createPigTestFromString(wilsonBinConf,"alpha=0.05");
  writeLinesToFile("input","1\t1","1\t2","50\t100","500\t1000","999\t1000","1000\t1000","998\t1000");
  test.runScript();
  List<String> expectedOutput=new ArrayList<String>();
  expectedOutput.add("0.05129,1.00000");
  expectedOutput.add("0.02565,0.97435");
  expectedOutput.add("0.40383,0.59617");
  expectedOutput.add("0.46907,0.53093");
  expectedOutput.add("0.99436,0.99995");
  expectedOutput.add("0.99617,1.00000");
  expectedOutput.add("0.99274,0.99945");
  List<Tuple> output=this.getLinesForAlias(test,"data_out");
  Iterator<String> expectationIterator=expectedOutput.iterator();
  for (  Tuple t : output) {
    assertTrue(expectationIterator.hasNext());
    Double lower=(Double)t.get(0);
    Double upper=(Double)t.get(1);
    assertEquals(String.format("%.5f,%.5f",lower,upper),expectationIterator.next());
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: datafu.test.pig.stats.entropy.CondEntropyTests </h4><pre class="type-10 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void invalidInputEmpiricalCondEntropoyTest() throws Exception {
  PigTest test=createPigTestFromString(invalidInputCondEntropy);
  writeLinesToFile("input","98.94791","38.61010","97.10575","62.28313","38.83960","32.05370","96.10962","28.72388","96.65888","20.41135");
  try {
    test.runScript();
    List<Tuple> output=this.getLinesForAlias(test,"data_out");
    fail("Testcase should fail");
  }
 catch (  Exception ex) {
    assertTrue(ex.getMessage().indexOf("The field schema of the input tuple is null or its size is not 2") >= 0);
  }
}

</code></pre>

<br>
<h4 style="margin:0px">Class: datafu.test.pig.stats.entropy.EmpiricalCountEntropyTests </h4><pre class="type-10 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void invalidInputSchemaEntropyTest() throws Exception {
  PigTest test=createPigTestFromString(invalidInputSchemaEntropy);
  writeLinesToFile("input","hadoop	98.94791","bigdata	38.61010","hadoop	97.10575","datafu	32.05370","bigdata	38.61010","datafu	32.05370","datafu	32.05370");
  try {
    test.runScript();
    List<Tuple> output=this.getLinesForAlias(test,"data_out");
    fail("Testcase should fail");
  }
 catch (  Exception ex) {
    assertTrue(ex.getMessage().indexOf("The field schema of the input tuple is null or its size is not 1") >= 0);
  }
}

</code></pre>

<br>
<pre class="type-10 type-2 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void rawInvalidTypeInputEntropyTest() throws Exception {
  PigTest test=createPigTestFromString(rawInvalidTypeInputEntropy);
  writeLinesToFile("input","0.0","38.0","0.0","62.0","38.0","32.001","96.002","38.01","96.00001","0.0");
  try {
    test.runScript();
    List<Tuple> output=this.getLinesForAlias(test,"data_out");
    fail("Testcase should fail");
  }
 catch (  Exception ex) {
    assertTrue(ex.getMessage().indexOf("Expect the type of the input tuple to be of ([int, long]), but instead found double") >= 0);
  }
}

</code></pre>

<br>
<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
