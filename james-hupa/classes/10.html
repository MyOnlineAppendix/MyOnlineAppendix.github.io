<h3 style="margin:0px">Class: org.apache.hupa.server.service.GetMessageDetailServiceTest (14 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="10"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('10')" data-toggle="tooltip" title="Verifies boolean conditions"><kbd id="tag-10"class="label-info"style="display: inline-block;font-size:7pt" >BooleanVerifier&nbsp;(13)</kbd></button>&nbsp;<button id="3"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('3')" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value "><kbd id="tag-3"class="label-info"style="display: inline-block;font-size:7pt" >EqualityVerifier&nbsp;(9)</kbd></button>&nbsp;<button id="7"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('7')" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes"><kbd id="tag-7"class="label-info"style="display: inline-block;font-size:7pt" >HybridVerifier&nbsp;(8)</kbd></button>&nbsp;<button id="2"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('2')" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls"><kbd id="tag-2"class="label-info"style="display: inline-block;font-size:7pt" >InternalCallVerifier&nbsp;(7)</kbd></button>&nbsp;<button id="9"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('9')" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) "><kbd id="tag-9"class="label-info"style="display: inline-block;font-size:7pt" >APIUtilityVerifier&nbsp;(4)</kbd></button>&nbsp;<button id="12"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('12')" data-toggle="tooltip" title="Verifies whether two objects/variables are the same"><kbd id="tag-12"class="label-info"style="display: inline-block;font-size:7pt" >IdentityVerifier&nbsp;(2)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-9 type-10 type-12 type-3 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testFilterHtmlDocument() throws Exception {
  String msg="<div>...\nhttp://whatever\n...</div>";
  String res=getMessageDetailsService.txtDocumentToHtml(msg,"aFolder",9999l);
  assertNotSame(msg,res);
  assertTrue(res.contains("onClick=\"openLink('http://whatever"));
  msg="...\n<a\nhref=https://www.example.com/path/action.do;s=1;a=2?p=abcd\n...";
  res=getMessageDetailsService.filterHtmlDocument(msg,"aFolder",9999l);
  assertNotSame(msg,res);
  assertTrue(res.contains("onClick=\"openLink('https://"));
  msg="...\n<a\nhref=mailTo:nobody@subdomain.the-domain.org\n...";
  res=getMessageDetailsService.filterHtmlDocument(msg,"aFolder",9999l);
  assertNotSame(msg,res);
  assertTrue(res.contains("onClick=\"mailTo('nobody@"));
  msg="...\n...<img   \n   src=\"cid:1.1934304663@web28309.mail.ukl.yahoo.com\" width=200\n....";
  res=getMessageDetailsService.filterHtmlDocument(msg,"aFolder",9999l);
  assertNotSame(msg,res);
  assertEquals("...\n...<img   \n   src='" + SConsts.HUPA + SConsts.SERVLET_DOWNLOAD+ "?mode=inline&"+ SConsts.PARAM_FOLDER+ "=aFolder&"+ SConsts.PARAM_UID+ "=9999&"+ SConsts.PARAM_NAME+ "=1.1934304663@web28309.mail.ukl.yahoo.com' name='cid:1.1934304663@web28309.mail.ukl.yahoo.com' width=200\n....",res);
  msg="\n\n.... <Script \ntype=\"whatever\"\n>\nalert('hello');\n</script > ---\n\n";
  res=getMessageDetailsService.filterHtmlDocument(msg,"aFolder",9999l);
  assertNotSame(msg,res);
  msg="\n\n.... <a \nid=\"whatever\"\nonclick=\"alert('hello');\"\n</a > ---\n\n";
  res=getMessageDetailsService.filterHtmlDocument(msg,"aFolder",9999l);
  assertNotSame(msg,res);
  msg="\n\n.... <style \ntype=\"whatever\"\n>\n.a{};\n</Style > ---\n\n";
  res=getMessageDetailsService.filterHtmlDocument(msg,"aFolder",9999l);
  assertNotSame(msg,res);
  res=getMessageDetailsService.filterHtmlDocument("","aFolder",9999l);
  assertTrue(res.length() == 0);
}

</code></pre>

<pre class="type-10 type-2 type-3 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMessageDetails_charsetIso() throws Exception {
  MimeMessage message=TestUtils.loadMessageFromFile(session,"3.msg");
  String from=message.getFrom()[0].toString();
  assertTrue(from.contains("\u00AE"));
  MessageDetails details=loadMessageDetails("3.msg");
  assertEquals(0,details.getMessageAttachments().size());
  assertTrue(details.getText().length() > 0);
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testFilterHtml_LargeBody_Performance() throws Exception {
  long start=System.currentTimeMillis();
  loadMessageDetails("8.msg");
  long end=System.currentTimeMillis();
  assertTrue("Large message bodies should be filtered fast",(end - start) < 1000);
}

</code></pre>

<pre class="type-9 type-10 type-12 type-3 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether two objects/variables are the same">IdentityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether two objects/variables are the same
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testTextDocumentToHtml() throws Exception {
  String msg="...\nhttp://www.example.com/path/action.do;s=1;a=2?p=abcd\n...";
  String res=getMessageDetailsService.txtDocumentToHtml(msg,"aFolder",9999l);
  assertNotSame(msg,res);
  assertTrue(res.contains("onClick=\"openLink('http://"));
  msg="...\nnobody@subdomain.the-domain.org\n...";
  res=getMessageDetailsService.txtDocumentToHtml(msg,"aFolder",9999l);
  assertNotSame(msg,res);
  assertTrue(res.contains("onClick=\"mailTo('nobody@"));
  res=getMessageDetailsService.txtDocumentToHtml("","aFolder",9999l);
  assertTrue(res.length() == 0);
  msg="...<atag>...";
  res=getMessageDetailsService.txtDocumentToHtml(msg,"aFolder",9999l);
  assertNotSame(msg,res);
  assertEquals("...&lt;atag&gt;...",res);
}

</code></pre>

<pre class="type-10 type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
"></span><br>
@Test public void testMessageDetails_links() throws Exception {
  MessageDetails details=loadMessageDetails("2.msg");
  String html=getMessageDetailsService.filterHtmlDocument(details.getText(),"foldername",111l);
  assertFalse(html.contains("<script>"));
  assertFalse(html.contains("<style>"));
  assertTrue(html.contains("<a onClick=\"openLink('http://code.google.com/intl/es/webtoolkit/');return false;\" href=\"http://code.google.com/intl/es/webtoolkit/\""));
  assertTrue(html.contains("<a onClick=\"mailTo('donald@example.com');return false;\" href=\"mailto:donald@example.com\""));
}

</code></pre>

<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
@Test public void testMessageDetails_ecs_crypt() throws Exception {
  MessageDetails details=loadMessageDetails("12.msg");
  assertEquals("Secure Hello world<br>",details.getText());
}

</code></pre>

<pre class="type-10 type-2 type-3 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMessageDetails_multiparMixed_multipartAlternative_textAttachment() throws Exception {
  MessageDetails details=loadMessageDetails("10.msg");
  assertEquals(1,details.getMessageAttachments().size());
  assertTrue(details.getText().contains("<span>"));
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testMessageDetails_textHtml() throws Exception {
  MessageDetails details=loadMessageDetails("4.msg");
  assertTrue(details.getText().length() > 0);
}

</code></pre>

<pre class="type-10 type-2 type-3 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMessageDetails_multiparMixed_multipartAlternative() throws Exception {
  MessageDetails details=loadMessageDetails("6.msg");
  assertEquals(1,details.getMessageAttachments().size());
  assertTrue(details.getText().length() > 0);
}

</code></pre>

<pre class="type-9 type-10 type-2 type-3 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMessageDetails_html_with_inline_images() throws Exception {
  IMAPStore store=storeCache.get(testUser);
  IMAPFolder serverfolder=(IMAPFolder)store.getFolder("WHATEVER");
  serverfolder.create(Folder.HOLDS_MESSAGES);
  MimeMessage msg=TestUtils.loadMessageFromFile(session,"7.msg");
  serverfolder.addMessages(new Message[]{msg});
  org.apache.hupa.shared.domain.ImapFolder clientfolder=new org.apache.hupa.shared.data.ImapFolderImpl("WHATEVER");
  MessageDetails details=getMessageDetailsService.exposeMessage(testUser,clientfolder,0);
  assertTrue(details.getText().contains("img src=\'" + SConsts.HUPA + SConsts.SERVLET_DOWNLOAD+ "?mode=inline&"+ SConsts.PARAM_FOLDER+ "=WHATEVER&"+ SConsts.PARAM_UID+ "=0&"+ SConsts.PARAM_NAME+ "=1.1934304663@web28309.mail.ukl.yahoo.com'"));
  assertEquals(0,details.getMessageAttachments().size());
}

</code></pre>

<pre class="type-9 type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
"></span><br>
@Test public void testRegexEmailsInsideTagAttributes(){
  String msg, res;
  msg=".. <a href=\"http://whatever?param1=whatever&email= dock@example.com&param3\">..</a> ..";
  res=getMessageDetailsService.filterHtmlDocument(msg,"aFolder",9999l);
  assertFalse(res.contains("mailTo("));
  msg=".. <a href=bla > http://whatever?param1=whatever&email=dock@example.com&param3 </a> ..";
  res=getMessageDetailsService.filterHtmlDocument(msg,"aFolder",9999l);
  assertFalse(res.contains("mailTo("));
  assertFalse(res.contains("openLink("));
  msg="http://accounts.myspace.com.deaaaf.me.uk/msp/index.php?fuseaction=update&code=78E2BL6-EKY5L893K4MHSA-74ESO-D743U41GYB18J-FA18EI698V4M&email=somehone@somewere.com";
  res=getMessageDetailsService.txtDocumentToHtml(msg,"aFolder",9999l);
  assertFalse(res.contains("mailTo("));
  assertTrue(res.contains("openLink("));
}

</code></pre>

<pre class="type-10 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
"></span><br>
@Test public void testMessageDetails_textPlain() throws Exception {
  MessageDetails details=loadMessageDetails("0.msg");
  assertTrue(details.getText().contains("demo message"));
}

</code></pre>

<pre class="type-10 type-2 type-3 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMessageDetails_multiparMixed() throws Exception {
  MessageDetails details=loadMessageDetails("1.msg");
  assertEquals(1,details.getMessageAttachments().size());
  assertTrue(details.getText().contains("Regards"));
}

</code></pre>

<pre class="type-10 type-2 type-3 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void testMessageDetails_multiparAlternative() throws Exception {
  MessageDetails details=loadMessageDetails("2.msg");
  assertEquals(0,details.getMessageAttachments().size());
  assertTrue(details.getText().length() > 0);
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
