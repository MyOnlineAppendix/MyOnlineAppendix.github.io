<h3 style="margin:0px">Class: org.apache.wicket.protocol.http.WicketFilterTest (10 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="4"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('4')" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls"><kbd id="tag-4"class="label-info"style="display: inline-block;font-size:7pt" >InternalCallVerifier&nbsp;(5)</kbd></button>&nbsp;<button id="7"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('7')" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value "><kbd id="tag-7"class="label-info"style="display: inline-block;font-size:7pt" >EqualityVerifier&nbsp;(5)</kbd></button>&nbsp;<button id="9"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('9')" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) "><kbd id="tag-9"class="label-info"style="display: inline-block;font-size:7pt" >APIUtilityVerifier&nbsp;(3)</kbd></button>&nbsp;<button id="5"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('5')" data-toggle="tooltip" title="Verifies boolean conditions"><kbd id="tag-5"class="label-info"style="display: inline-block;font-size:7pt" >BooleanVerifier&nbsp;(3)</kbd></button>&nbsp;<button id="8"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('8')" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes"><kbd id="tag-8"class="label-info"style="display: inline-block;font-size:7pt" >HybridVerifier&nbsp;(2)</kbd></button>&nbsp;<button id="6"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('6')" data-toggle="tooltip" title="Verifies whether objects are null"><kbd id="tag-6"class="label-info"style="display: inline-block;font-size:7pt" >NullVerifier&nbsp;(2)</kbd></button>&nbsp;<button id="14"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('14')" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements"><kbd id="tag-14"class="label-info"style="display: inline-block;font-size:7pt" >ConditionMatcher&nbsp;(1)</kbd></button>&nbsp;<button id="3"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('3')" data-toggle="tooltip" title="Releases resources used by the test cases"><kbd id="tag-3"class="label-info"style="display: inline-block;font-size:7pt" >TestCleaner&nbsp;(1)</kbd></button>&nbsp;<button id="18"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('18')" data-toggle="tooltip" title="Verifies assertions in iterations"><kbd id="tag-18"class="label-info"style="display: inline-block;font-size:7pt" >IterativeVerifier&nbsp;(1)</kbd></button>&nbsp;<button id="2"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('2')" data-toggle="tooltip" title="Executes methods or other tests from the same test unit"><kbd id="tag-2"class="label-info"style="display: inline-block;font-size:7pt" >ExecutionTester&nbsp;(1)</kbd></button>&nbsp;<button id="12"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('12')" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure"><kbd id="tag-12"class="label-info"style="display: inline-block;font-size:7pt" >UtilityVerifier&nbsp;(1)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-3 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Releases resources used by the test cases">TestCleaner</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Releases resources used by the test cases
"></span><br>
/** 
 * @throws Exception
 */
@After public void after() throws Exception {
  if (application != null) {
    application.internalDestroy();
    application=null;
  }
}

</code></pre>

<pre class="type-4 type-14 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies logic rules using matcher-style statements">ConditionMatcher</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies logic rules using matcher-style statements
"></span><br>
/** 
 * Test for WICKET-5980 When using Servlet 3.0 filter Wicket calculates filter path wrong.
 * When using a servlet 3.0 filter with annotations Wicket calculates the filter path wrong
 * causing it to not match any pages other than the home page. e.g.
 * <pre>
 * &#64;WebFilter(value = "/web/*", initParams = {
 * &#64;WebInitParam(name = "applicationClassName", value = "com.example.CheesrApplication") })
 * public class CheesrFilter extends WicketFilter
 * {
 * }
 * </pre>
 * @throws Exception
 */
@Test public void parsingOfAnnotatedServlet3FiltersWorks() throws Exception {
  FilterTestingConfig config=new FilterTestingConfig();
  config.initParameters.clear();
  config.initParameters.put("applicationClassName","org.apache.wicket.mock.MockApplication");
  WicketFilter filter=new AnnotatedServlet3Filter();
  filter.init(config);
  application=filter.getApplication();
  assertThat(filter.getFilterPath(),is("web/"));
}

</code></pre>

<pre class="type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * <a href="https://issues.apache.org/jira/browse/WICKET-4626">WICKET-4626</a>
 * <p>
 * Test method WicketFilter#canonicaliseFilterPath(String)
 * </p>
 */
@Test public void canonicaliseFilterPath(){
  String s;
  s=WicketFilter.canonicaliseFilterPath("");
  assertEquals("",s);
  s=WicketFilter.canonicaliseFilterPath("/");
  assertEquals("",s);
  s=WicketFilter.canonicaliseFilterPath("//");
  assertEquals("",s);
  s=WicketFilter.canonicaliseFilterPath("///");
  assertEquals("",s);
  s=WicketFilter.canonicaliseFilterPath("/wicket");
  assertEquals("wicket/",s);
  s=WicketFilter.canonicaliseFilterPath("/wicket/");
  assertEquals("wicket/",s);
  s=WicketFilter.canonicaliseFilterPath("wicket/");
  assertEquals("wicket/",s);
  s=WicketFilter.canonicaliseFilterPath("wicket");
  assertEquals("wicket/",s);
  s=WicketFilter.canonicaliseFilterPath("///wicket");
  assertEquals("wicket/",s);
  s=WicketFilter.canonicaliseFilterPath("///wicket///");
  assertEquals("wicket/",s);
  s=WicketFilter.canonicaliseFilterPath("wicket///");
  assertEquals("wicket/",s);
  s=WicketFilter.canonicaliseFilterPath("/wicket/foobar");
  assertEquals("wicket/foobar/",s);
  s=WicketFilter.canonicaliseFilterPath("/wicket/foobar/");
  assertEquals("wicket/foobar/",s);
  s=WicketFilter.canonicaliseFilterPath("wicket/foobar/");
  assertEquals("wicket/foobar/",s);
  s=WicketFilter.canonicaliseFilterPath("/wicket///foobar/");
  assertEquals("wicket///foobar/",s);
}

</code></pre>

<pre class="type-4 type-6 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects are null
"></span><br>
/** 
 * testCheckRedirect_1()
 */
@Test public void checkRedirect_1(){
  WicketFilter filter=new WicketFilter();
  filter.setFilterPath("");
  assertNull("",filter.checkIfRedirectRequired("/",""));
}

</code></pre>

<pre class="type-2 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * <a href="https://issues.apache.org/jira/browse/WICKET-3544">WICKET-3544</a>
 * <p>
 * Runs 1000 times 8 simultaneous threads which try to initialize WicketFilter#filterPathLength
 */
@Test public void repeatedParallelCheckRedirect(){
  int threadCount=8;
  int repeatCount=1000;
  for (int i=0; i < repeatCount; i++) {
    parallelCheckRedirect(threadCount);
  }
}

</code></pre>

<pre class="type-9 type-4 type-5 type-6 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects are null">NullVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects are null
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * @throws IOException
 * @throws ServletException
 * @throws ParseException
 */
@Test public void notModifiedResponseIncludesExpiresHeader() throws IOException, ServletException, ParseException {
  try {
    application=new MockApplication();
    WicketFilter filter=new WicketFilter();
    filter.init(new FilterTestingConfig());
    ThreadContext.setApplication(application);
    DynamicImageResource resource=new DynamicImageResource(){
      private static final long serialVersionUID=1L;
      @Override protected byte[] getImageData(      Attributes attributes){
        throw new UnsupportedOperationException("Not implemented");
      }
      @Override protected ResourceResponse newResourceResponse(      Attributes attributes){
        ResourceResponse response=super.newResourceResponse(attributes);
        response.setCacheDurationToMaximum();
        return response;
      }
    }
;
    application.getSharedResources().add("foo.gif",resource);
    MockHttpServletRequest request=new MockHttpServletRequest(application,null,null);
    request.setURL(request.getContextPath() + request.getServletPath() + "/wicket/resource/"+ Application.class.getName()+ "/foo.gif");
    setIfModifiedSinceToNextWeek(request);
    MockHttpServletResponse response=new MockHttpServletResponse(request);
    filter.doFilter(request,response,new FilterChain(){
      @Override public void doFilter(      ServletRequest servletRequest,      ServletResponse servletResponse) throws IOException, ServletException {
      }
    }
);
    assertEquals(HttpServletResponse.SC_NOT_MODIFIED,response.getStatus());
    String responseExpiresHeader=response.getHeader("Expires");
    assertNotNull("Expires header must be set on not modified response",responseExpiresHeader);
    Date responseExpires=headerDateFormat.parse(responseExpiresHeader);
    assertTrue("Expected later than current date but was " + responseExpires,responseExpires.after(new Date()));
  }
  finally {
    ThreadContext.detach();
  }
}

</code></pre>

<pre class="type-9 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * testFilterPath2()
 */
@Test public void filterPath2(){
  InputStream in=WicketFilterTest.class.getResourceAsStream("web2.xml");
  String filterPath=getFilterPath("FilterTestApplication",in);
  assertEquals("filtertest/",filterPath);
}

</code></pre>

<pre class="type-12 type-4 type-5 type-7 type-8 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
@Test public void options() throws IOException, ServletException, ParseException {
  try {
    application=new MockApplication();
    WicketFilter filter=new WicketFilter();
    filter.init(new FilterTestingConfig());
    ThreadContext.setApplication(application);
    final String failure="Should never get here when an OPTIONS request is issued";
    IResource resource=new AbstractResource(){
      @Override protected ResourceResponse newResourceResponse(      Attributes attributes){
        fail(failure);
        return null;
      }
    }
;
    application.getSharedResources().add("foo.txt",resource);
    MockHttpServletRequest request=new MockHttpServletRequest(application,null,null);
    request.setURL(request.getContextPath() + request.getServletPath() + "/wicket/resource/"+ Application.class.getName()+ "/foo.txt");
    request.setMethod("OPtioNS");
    MockHttpServletResponse response=new MockHttpServletResponse(request);
    filter.doFilter(request,response,new FilterChain(){
      @Override public void doFilter(      ServletRequest servletRequest,      ServletResponse servletResponse) throws IOException, ServletException {
      }
    }
);
    assertEquals(HttpServletResponse.SC_OK,response.getStatus());
    assertEquals("0",response.getHeader("Content-Length"));
    assertFalse(Strings.isEmpty(response.getHeader("Allow")));
    assertTrue(response.getHeader("Allow").toUpperCase().contains("GET"));
    assertTrue(response.getHeader("Allow").toUpperCase().contains("POST"));
    request=new MockHttpServletRequest(application,null,null);
    request.setURL(request.getContextPath() + request.getServletPath() + "/wicket/resource/"+ Application.class.getName()+ "/foo.txt");
    response=new MockHttpServletResponse(request);
    try {
      filter.doFilter(request,response,new FilterChain(){
        @Override public void doFilter(        ServletRequest servletRequest,        ServletResponse servletResponse) throws IOException, ServletException {
        }
      }
);
    }
 catch (    AssertionError e) {
      assertTrue(failure.equals(e.getMessage()));
    }
  }
  finally {
    ThreadContext.detach();
  }
}

</code></pre>

<pre class="type-9 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * testFilterPath1()
 */
@Test public void filterPath1(){
  InputStream in=WicketFilterTest.class.getResourceAsStream("web1.xml");
  String filterPath=getFilterPath("FilterTestApplication",in);
  assertEquals("filtertest/",filterPath);
}

</code></pre>

<pre class="type-18 type-4 type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
"></span><br>
/** 
 * <a href="https://issues.apache.org/jira/browse/WICKET-3750">WICKET-3750</a>
 * @throws Exception
 */
@Test public void ignorePaths() throws Exception {
  application=spy(new MockApplication());
  WicketFilter filter=new WicketFilter();
  filter.init(new FilterTestingConfig());
  HttpServletRequest request=mock(HttpServletRequest.class);
  when(request.getLocale()).thenReturn(new Locale("bg","BG"));
  when(request.getRequestURI()).thenReturn("/contextPath/js/bla.js").thenReturn("/contextPath/css/bla.css").thenReturn("/contextPath/images/bla.img").thenReturn("/contextPath/servlet/wicket/bookmarkable/" + DummyHomePage.class.getName());
  when(request.getContextPath()).thenReturn("/contextPath");
  when(request.getMethod()).thenReturn("POST");
  HttpServletResponse response=mock(HttpServletResponse.class);
  when(response.encodeRedirectURL(Matchers.anyString())).thenAnswer(new Answer<String>(){
    @Override public String answer(    InvocationOnMock invocation) throws Throwable {
      return (String)invocation.getArguments()[0];
    }
  }
);
  FilterChain chain=mock(FilterChain.class);
  for (int i=0; i < 3; i++) {
    boolean isProcessed=filter.processRequest(request,response,chain);
    assertFalse(isProcessed);
    verify(application,Mockito.never()).newWebRequest(Matchers.eq(request),Matchers.anyString());
    verify(application,Mockito.never()).newWebResponse(Matchers.any(WebRequest.class),Matchers.eq(response));
    verify(chain,Mockito.times(i + 1)).doFilter(request,response);
  }
  boolean isProcessed=filter.processRequest(request,response,chain);
  assertTrue(isProcessed);
  verify(application).newWebRequest(Matchers.eq(request),Matchers.anyString());
  verify(application).newWebResponse(Matchers.any(WebRequest.class),Matchers.eq(response));
  verify(chain,Mockito.times(3)).doFilter(request,response);
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
