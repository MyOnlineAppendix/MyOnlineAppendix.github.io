<h3 style="margin:0px">Class: org.apache.sis.math.DecimalFunctionsTest (7 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="1"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('1')" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value "><kbd id="tag-1"class="label-info"style="display: inline-block;font-size:7pt" >EqualityVerifier&nbsp;(7)</kbd></button>&nbsp;<button id="13"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('13')" data-toggle="tooltip" title="Verifies assertions in iterations"><kbd id="tag-13"class="label-info"style="display: inline-block;font-size:7pt" >IterativeVerifier&nbsp;(4)</kbd></button>&nbsp;<button id="9"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('9')" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) "><kbd id="tag-9"class="label-info"style="display: inline-block;font-size:7pt" >APIUtilityVerifier&nbsp;(3)</kbd></button>&nbsp;<button id="12"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('12')" data-toggle="tooltip" title="Verifies assertions inside branch conditions"><kbd id="tag-12"class="label-info"style="display: inline-block;font-size:7pt" >BranchVerifier&nbsp;(1)</kbd></button>&nbsp;<button id="7"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('7')" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes"><kbd id="tag-7"class="label-info"style="display: inline-block;font-size:7pt" >HybridVerifier&nbsp;(1)</kbd></button>&nbsp;<button id="4"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('4')" data-toggle="tooltip" title="Verifies boolean conditions"><kbd id="tag-4"class="label-info"style="display: inline-block;font-size:7pt" >BooleanVerifier&nbsp;(1)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-13 type-9 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Tests {@link DecimalFunctions#fractionDigitsForValue(double)}.
 */
@Test public void testFractionDigitsForValue(){
  assertEquals(-EXPONENT_FOR_ZERO,fractionDigitsForValue(0));
  assertEquals(-EXPONENT_FOR_ZERO,fractionDigitsForValue(MIN_VALUE));
  assertEquals(16,fractionDigitsForValue(1));
  assertEquals(15,fractionDigitsForValue(45));
  assertEquals(15,fractionDigitsForValue(39.666666666666667));
  assertEquals(15,fractionDigitsForValue(-8.131906111111111));
  assertEquals(16,fractionDigitsForValue(0.6149999999999993));
  assertEquals(17,fractionDigitsForValue(-0.198));
  assertEquals(14,fractionDigitsForValue(179.12499999999824));
  assertEquals(0,fractionDigitsForValue(NaN));
  assertEquals(0,fractionDigitsForValue(POSITIVE_INFINITY));
  assertEquals(0,fractionDigitsForValue(NEGATIVE_INFINITY));
  for (int i=EXPONENT_FOR_ZERO; i <= EXPONENT_FOR_MAX; i++) {
    final double value=pow10(i);
    final double accuracy=pow10(-fractionDigitsForValue(value));
    assertEquals("Shall not be greater than ULP",0,accuracy,StrictMath.ulp(value));
  }
  for (int i=MIN_EXPONENT; i <= MAX_EXPONENT; i++) {
    final double value=StrictMath.scalb(1,i);
    final double accuracy=pow10(-fractionDigitsForValue(value));
    assertEquals("Shall not be greater than ULP",0,accuracy,StrictMath.ulp(value));
  }
}

</code></pre>

<pre class="type-4 type-1 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verifies the values of {@link DecimalFunctions#EXPONENT_FOR_ZERO}.
 */
@Test public void testConstants(){
  assertEquals(0,parseDouble("1E" + EXPONENT_FOR_ZERO),STRICT);
  assertTrue(0 < parseDouble("1E" + (EXPONENT_FOR_ZERO + 1)));
  assertTrue(POSITIVE_INFINITY > parseDouble("1E" + EXPONENT_FOR_MAX));
  assertEquals(POSITIVE_INFINITY,parseDouble("1E" + (EXPONENT_FOR_MAX + 1)),STRICT);
}

</code></pre>

<pre class="type-13 type-9 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Tests {@link DecimalFunctions#floatToDouble(float)}.
 */
@Test @DependsOnMethod("testPow10") public void testFloatToDouble(){
  assertEquals(NaN,floatToDouble(Float.NaN),STRICT);
  assertEquals(POSITIVE_INFINITY,floatToDouble(Float.POSITIVE_INFINITY),STRICT);
  assertEquals(NEGATIVE_INFINITY,floatToDouble(Float.NEGATIVE_INFINITY),STRICT);
  assertEquals(0.0,floatToDouble(0.0f),STRICT);
  assertEquals(-0.0,floatToDouble(-0.0f),STRICT);
  assertEquals(10,floatToDouble(10f),STRICT);
  assertEquals(-10,floatToDouble(-10f),STRICT);
  assertEquals(0.1,floatToDouble(0.1f),STRICT);
  assertEquals(0.01,floatToDouble(0.01f),STRICT);
  assertEquals(-0.01,floatToDouble(-0.01f),STRICT);
  assertEquals(0.001,floatToDouble(0.001f),STRICT);
  assertEquals(0.0001,floatToDouble(0.0001f),STRICT);
  assertEquals(3.7E-8,floatToDouble(3.7E-8f),STRICT);
  assertEquals(3.7E-9,floatToDouble(3.7E-9f),STRICT);
  final Random random=TestUtilities.createRandomNumberGenerator();
  for (int i=0; i < 100; i++) {
    float value=StrictMath.scalb(random.nextFloat(),random.nextInt(20) - 10);
    if (random.nextBoolean()) {
      value=-value;
    }
    assertEquals(String.valueOf(value),String.valueOf(floatToDouble(value)));
  }
}

</code></pre>

<pre class="type-13 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Tests the {@link MathFunctions#pow10(double)} method.
 * This will indirectly test {@link MathFunctions#pow10(int)}since the former will delegate to the later in this test.
 */
@Test @DependsOnMethod("testConstants") public void testPow10(){
  for (int i=EXPONENT_FOR_ZERO; i <= EXPONENT_FOR_MAX; i++) {
    assertEquals(parseDouble("1E" + i),pow10(i),STRICT);
  }
  assertEquals(1000000000000000000L,StrictMath.round(pow10(18)));
}

</code></pre>

<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Tests {@link DecimalFunctions#fractionDigitsForValue(double,int)}.
 */
@Test @DependsOnMethod("testFractionDigitsForValue") public void testFractionDigitsForValue2(){
  assertEquals(-EXPONENT_FOR_ZERO,fractionDigitsForValue(0,2));
  assertEquals(0,fractionDigitsForValue(POSITIVE_INFINITY,2));
  assertEquals("Expected no rounding",15,fractionDigitsForValue(39.666666666666667,2));
  assertEquals("Expected no rounding",15,fractionDigitsForValue(-8.131906111111111,2));
  assertEquals("Expected no rounding",16,fractionDigitsForValue(0.6149999999999993,1));
  assertEquals("Expected rounding",14,fractionDigitsForValue(0.6149999999999993,2));
  assertEquals("Expected rounding",14,fractionDigitsForValue(-0.6149999999999993,2));
  assertEquals("Expected rounding",15,fractionDigitsForValue(-0.1979999999999998,2));
  assertEquals("Expected rounding",11,fractionDigitsForValue(179.12499999999824,3));
  assertEquals("Expected no rounding",14,fractionDigitsForValue(179.12499999999824,2));
  assertEquals("Expected no rounding",14,fractionDigitsForValue(179.12499997999999,3));
}

</code></pre>

<pre class="type-13 type-9 type-12 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Tests {@link DecimalFunctions#deltaForDoubleToDecimal(double)}.
 * This method uses {@link BigDecimal} as the reference implementation.
 */
@Test @DependsOnMethod("testPow10") public void testDeltaForDoubleToDecimal(){
  assertEquals(0,deltaForDoubleToDecimal(0),STRICT);
  assertEquals(0,deltaForDoubleToDecimal(1),STRICT);
  assertEquals(0,deltaForDoubleToDecimal(NaN),STRICT);
  assertEquals(0,deltaForDoubleToDecimal(POSITIVE_INFINITY),STRICT);
  assertEquals(0,deltaForDoubleToDecimal(NEGATIVE_INFINITY),STRICT);
  assertEquals(-2.2204460492503132E-17,deltaForDoubleToDecimal(0.9),STRICT);
  assertEquals(-5.5511151231257827E-18,deltaForDoubleToDecimal(0.1),STRICT);
  assertEquals(-2.0816681711721684E-19,deltaForDoubleToDecimal(0.01),STRICT);
  assertEquals(-2.0816681711721686E-20,deltaForDoubleToDecimal(0.001),STRICT);
  assertEquals(-4.7921736023859296E-21,deltaForDoubleToDecimal(0.0001),STRICT);
  assertEquals(-8.1803053914031310E-22,deltaForDoubleToDecimal(0.00001),STRICT);
  assertEquals(4.5251888174113741E-23,deltaForDoubleToDecimal(0.000001),STRICT);
  assertEquals(-1.3471890270011499E-17,deltaForDoubleToDecimal(0.201168),STRICT);
  assertEquals(-1.5365486660812166E-17,deltaForDoubleToDecimal(0.3048),STRICT);
  assertEquals(9.4146912488213275E-18,deltaForDoubleToDecimal(0.9144),STRICT);
  assertEquals(1.8829382497642655E-17,deltaForDoubleToDecimal(1.8288),STRICT);
  assertEquals(-3.5527136788005009E-17,deltaForDoubleToDecimal(2.54),STRICT);
  assertEquals(-1.3471890270011499E-15,deltaForDoubleToDecimal(20.1168),STRICT);
  final Random random=TestUtilities.createRandomNumberGenerator();
  for (int fractionDigits=0; fractionDigits <= 9; fractionDigits++) {
    for (int i=0; i < 10; i++) {
      final BigDecimal value=BigDecimal.valueOf(random.nextInt(1000000000)).movePointLeft(fractionDigits);
      final double ieee=value.doubleValue();
      final BigDecimal delta=value.subtract(new BigDecimal(ieee));
      assertEquals(delta.doubleValue(),deltaForDoubleToDecimal(ieee),STRICT);
    }
  }
  assertEquals(-1.9216378778219224E-23,deltaForDoubleToDecimal(3.3446045755169960E-7),STRICT);
  assertEquals(-4.1861088853329420E-24,deltaForDoubleToDecimal(3.5496578465465944E-7),3E-39);
  assertEquals(-4.1997787803848041E-17,deltaForDoubleToDecimal(0.7714013208272988),2E-32);
  assertEquals(4.0373325589462183E-18,deltaForDoubleToDecimal(0.37197394704138476),4E-33);
  assertEquals(-2.3295945035351907E-18,deltaForDoubleToDecimal(0.25380700796141886),4E-33);
  assertEquals(-4.1729149110324215E-18,deltaForDoubleToDecimal(0.6546245266605436),4E-32);
  assertEquals(4.8633955884724856E-23,deltaForDoubleToDecimal(0.8234936921177336),4E-32);
  assertEquals(-2.1507730707526207E-25,deltaForDoubleToDecimal(0.19920566694813302),2E-33);
  for (int i=0; i < 500; i++) {
    double ieee=StrictMath.scalb(random.nextDouble(),20 - random.nextInt(48));
    if (random.nextBoolean()) {
      ieee=-ieee;
    }
    final String text=String.valueOf(ieee);
    final BigDecimal value=new BigDecimal(text);
    final double delta=value.subtract(new BigDecimal(ieee)).doubleValue();
    final double actual=deltaForDoubleToDecimal(ieee);
    if (!Double.isNaN(actual)) {
      assertEquals(text,delta,actual,StrictMath.ulp(ieee) * 1E-12);
    }
  }
}

</code></pre>

<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Tests {@link DecimalFunctions#fractionDigitsForDelta(double,boolean)}.
 */
@Test @DependsOnMethod("testPow10") public void testFractionDigitsForDelta(){
  assertEquals(3,fractionDigitsForDelta(0.001,true));
  assertEquals(3,fractionDigitsForDelta(0.009,true));
  assertEquals(2,fractionDigitsForDelta(0.010,true));
  assertEquals(2,fractionDigitsForDelta(0.015,true));
  assertEquals(1,fractionDigitsForDelta(0.100,true));
  assertEquals(1,fractionDigitsForDelta(0.125,true));
  assertEquals(1,fractionDigitsForDelta(0.949,true));
  assertEquals(2,fractionDigitsForDelta(0.994,true));
  assertEquals(3,fractionDigitsForDelta(0.999,true));
  assertEquals(0,fractionDigitsForDelta(1.0,true));
  assertEquals(0,fractionDigitsForDelta(1.9,true));
  assertEquals(0,fractionDigitsForDelta(9.1,true));
  assertEquals(-1,fractionDigitsForDelta(10.0,true));
  assertEquals(-1,fractionDigitsForDelta(19.9,true));
  assertEquals(-1,fractionDigitsForDelta(94.9,true));
  assertEquals(0,fractionDigitsForDelta(99.0,true));
  assertEquals(-2,fractionDigitsForDelta(100.0,true));
  assertEquals(-2,fractionDigitsForDelta(100.1,true));
  assertEquals(-1,fractionDigitsForDelta(994.9,true));
  assertEquals(+1,fractionDigitsForDelta(999.9,true));
  assertEquals(-3,fractionDigitsForDelta(1000,true));
  assertEquals(23,fractionDigitsForDelta(1.0E-23,true));
  assertEquals(23,fractionDigitsForDelta(1.9E-23,true));
  assertEquals(23,fractionDigitsForDelta(9.1E-23,true));
  assertEquals(24,fractionDigitsForDelta(9.6E-23,true));
  assertEquals(300,fractionDigitsForDelta(1.1E-300,true));
  assertEquals(-23,fractionDigitsForDelta(1.0E+23,true));
  assertEquals(-23,fractionDigitsForDelta(1.9E+23,true));
  assertEquals(-23,fractionDigitsForDelta(9.1E+23,true));
  assertEquals(-22,fractionDigitsForDelta(9.6E+23,true));
  assertEquals(-300,fractionDigitsForDelta(1.1E+300,true));
  assertEquals(-EXPONENT_FOR_ZERO,fractionDigitsForDelta(0,false));
  assertEquals(-EXPONENT_FOR_ZERO,fractionDigitsForDelta(MIN_VALUE,false));
  assertEquals(16,fractionDigitsForDelta(StrictMath.ulp(1.0),false));
  assertEquals(15,fractionDigitsForDelta(StrictMath.ulp(45.0),false));
  assertEquals(0,fractionDigitsForDelta(NaN,false));
  assertEquals(0,fractionDigitsForDelta(POSITIVE_INFINITY,false));
  assertEquals(0,fractionDigitsForDelta(NEGATIVE_INFINITY,false));
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
