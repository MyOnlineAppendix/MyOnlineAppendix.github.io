<h3 style="margin:0px">Class: org.apache.sis.internal.util.DoubleDoubleTest (14 methods) </h3><br><pre style="padding:0"><code class="html"><div id="tags"><button id="1"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('1')" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value "><kbd id="tag-1"class="label-info"style="display: inline-block;font-size:7pt" >EqualityVerifier&nbsp;(7)</kbd></button>&nbsp;<button id="5"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('5')" data-toggle="tooltip" title="Executes methods or other tests from the same test unit"><kbd id="tag-5"class="label-info"style="display: inline-block;font-size:7pt" >ExecutionTester&nbsp;(7)</kbd></button>&nbsp;<button id="3"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('3')" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls"><kbd id="tag-3"class="label-info"style="display: inline-block;font-size:7pt" >InternalCallVerifier&nbsp;(3)</kbd></button>&nbsp;<button id="7"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('7')" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes"><kbd id="tag-7"class="label-info"style="display: inline-block;font-size:7pt" >HybridVerifier&nbsp;(3)</kbd></button>&nbsp;<button id="4"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('4')" data-toggle="tooltip" title="Verifies boolean conditions"><kbd id="tag-4"class="label-info"style="display: inline-block;font-size:7pt" >BooleanVerifier&nbsp;(3)</kbd></button>&nbsp;<button id="13"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('13')" data-toggle="tooltip" title="Verifies assertions in iterations"><kbd id="tag-13"class="label-info"style="display: inline-block;font-size:7pt" >IterativeVerifier&nbsp;(3)</kbd></button>&nbsp;<button id="9"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('9')" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) "><kbd id="tag-9"class="label-info"style="display: inline-block;font-size:7pt" >APIUtilityVerifier&nbsp;(2)</kbd></button>&nbsp;<button id="12"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('12')" data-toggle="tooltip" title="Verifies assertions inside branch conditions"><kbd id="tag-12"class="label-info"style="display: inline-block;font-size:7pt" >BranchVerifier&nbsp;(1)</kbd></button>&nbsp;<button id="11"style="border-width:0;padding:0;background:#282B2E"  onclick="filter('11')" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure"><kbd id="tag-11"class="label-info"style="display: inline-block;font-size:7pt" >UtilityVerifier&nbsp;(1)</kbd></button>&nbsp;</div></code></pre><center><button onclick="showBlocks()" style="margin:6px">Update filter <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> </button></center><br>
<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Tests {@link DoubleDouble#setToSum(double,double)}.
 */
@Test public void testSetToSum(){
  final DoubleDouble dd=new DoubleDouble();
  for (int i=0; i < NUMBER_OF_REPETITIONS; i++) {
    final double a=nextRandom();
    final double b=nextRandom();
    dd.setToSum(a,b);
    assertNormalizedAndEquals(a + b,dd);
    assertExtendedEquals(new BigDecimal(a).add(new BigDecimal(b)),dd,ADD_TOLERANCE_FACTOR);
  }
}

</code></pre>

<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Tests {@link DoubleDouble#setToQuickSum(double,double)}.
 */
@Test public void testSetToQuickSum(){
  final DoubleDouble dd=new DoubleDouble();
  for (int i=0; i < NUMBER_OF_REPETITIONS; i++) {
    double a=nextRandom();
    double b=nextRandom();
    if (abs(a) < abs(b)) {
      final double t=a;
      a=b;
      b=t;
    }
    dd.setToQuickSum(a,b);
    assertNormalizedAndEquals(a + b,dd);
    assertExtendedEquals(new BigDecimal(a).add(new BigDecimal(b)),dd,ADD_TOLERANCE_FACTOR);
  }
}

</code></pre>

<pre class="type-3 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Tests {@link DoubleDouble#ratio_1m_1p()}.
 */
@Test @DependsOnMethod("testDivide") public void testRatio_1m_1p(){
  final DoubleDouble t=new DoubleDouble(0.25,0);
  t.ratio_1m_1p();
  assertEquals((1 - 0.25) / (1 + 0.25),t.doubleValue(),STRICT);
}

</code></pre>

<pre class="type-13 type-3 type-4 type-1 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to AUT calls
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests {@link DoubleDouble#sqrt()} first with the square root of 2, then with random values.
 * In the {@code sqrt(2)} case:
 * <ul>
 * <li>The error using {@code double} arithmetic is approximatively 1E-16.</li>
 * <li>The error using double-double arithmetic is expected to be slightly less that 1E-32.</li>
 * </ul>
 */
@Test @DependsOnMethod({"testMultiply","testDivide"}) public void testSqrt(){
  final BigDecimal SQRT2=new BigDecimal("1.414213562373095048801688724209698");
  final DoubleDouble dd=new DoubleDouble(2,0);
  dd.sqrt();
  assertNormalizedAndEquals(sqrt(2),dd);
  assertEquals(0,SQRT2.subtract(toBigDecimal(dd)).doubleValue(),1E-32);
  for (int i=0; i < NUMBER_OF_REPETITIONS; i++) {
    nextRandom(dd);
    if (dd.value < 0) {
      dd.negate();
    }
    final double value=dd.value;
    final double error=dd.error;
    dd.square();
    dd.sqrt();
    dd.subtract(value,error);
    assertEquals(0,dd.doubleValue(),1E-29);
  }
  dd.clear();
  dd.sqrt();
  assertTrue(dd.isZero());
}

</code></pre>

<pre class="type-13 type-9 type-12 type-11 type-4 type-1 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions inside branch conditions">BranchVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies (un)successful execution of the test case by reporting explicitly a failure">UtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies assertions inside branch conditions
- Verifies (un)successful execution of the test case by reporting explicitly a failure
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Verifies the {@link DoubleDouble#VALUES} and {@link DoubleDouble#ERRORS} arrays.
 * <ul>
 * <li>Elements in the {@code VALUES} array shall be sorted in increasing order.</li>
 * <li>{@code VALUES} and {@code ERRORS} arrays shall have the same length.</li>
 * <li>The arrays do not contains an entry for a value that could be omitted.</li>
 * </ul>
 * @throws Exception If a reflective operation failed (should never happen).
 */
@Test public void testArraysConsistency() throws Exception {
  Field field=DoubleDouble.class.getDeclaredField("VALUES");
  field.setAccessible(true);
  final double[] values=(double[])field.get(null);
  assertTrue(ArraysExt.isSorted(values,true));
  field=DoubleDouble.class.getDeclaredField("ERRORS");
  field.setAccessible(true);
  final double[] errors=(double[])field.get(null);
  assertEquals(values.length,errors.length);
  for (int i=0; i < values.length; i++) {
    final double value=values[i];
    final double delta=DecimalFunctions.deltaForDoubleToDecimal(value);
    if (delta == errors[i]) {
      fail("(value,entry) pair for value " + value + " can be omitted.");
    }
  }
}

</code></pre>

<pre class="type-13 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies assertions in iterations">IterativeVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies assertions in iterations
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Tests the {@code DoubleDouble.createFoo()} methods.
 */
@Test @DependsOnMethod("testErrorForWellKnownValue") public void testCreate(){
  for (int i=0; ; i++) {
    final DoubleDouble dd;
switch (i) {
case 0:
      dd=DoubleDouble.createRadiansToDegrees();
    break;
case 1:
  dd=DoubleDouble.createDegreesToRadians();
break;
case 2:
dd=DoubleDouble.createSecondsToRadians();
break;
default :
return;
}
assertEquals(DoubleDouble.errorForWellKnownValue(dd.value),dd.error,STRICT);
}
}

</code></pre>

<pre class="type-9 type-4 type-1 type-7 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to API calls (Java or TPL) ">APIUtilityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies boolean conditions">BooleanVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Contains more than 2 JUnit-based stereotypes">HybridVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to API calls (Java or TPL) 
- Verifies boolean conditions
- Verifies whether objects/variable are equal to an expected value 
- Contains more than 2 JUnit-based stereotypes
"></span><br>
/** 
 * Tests {@link DoubleDouble#errorForWellKnownValue(double)}.
 */
@Test @DependsOnMethod("testArraysConsistency") public void testErrorForWellKnownValue(){
  for (  final String text : PREDEFINED_VALUES) {
    final double value=Double.valueOf(text);
    final BigDecimal accurate=new BigDecimal(text);
    final BigDecimal approximation=new BigDecimal(value);
    final double expected=accurate.subtract(approximation).doubleValue();
    assertEquals(text,expected,DoubleDouble.errorForWellKnownValue(value),STRICT);
    assertEquals(text,-expected,DoubleDouble.errorForWellKnownValue(-value),STRICT);
    assertFalse("There is no point to define an entry for values having no error.",expected == 0);
  }
}

</code></pre>

<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Tests {@link DoubleDouble#setToProduct(double,double)}.
 */
@Test public void testSetToProduct(){
  final DoubleDouble dd=new DoubleDouble();
  for (int i=0; i < NUMBER_OF_REPETITIONS; i++) {
    final double a=nextRandom();
    final double b=nextRandom();
    dd.setToProduct(a,b);
    assertNormalizedAndEquals(a * b,dd);
    assertExtendedEquals(new BigDecimal(a).multiply(new BigDecimal(b)),dd,ADD_TOLERANCE_FACTOR);
  }
}

</code></pre>

<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Tests {@link DoubleDouble#add(DoubleDouble)}.
 */
@Test @DependsOnMethod({"testSetToSum","testNormalize"}) public void testAdd(){
  final DoubleDouble dd=new DoubleDouble();
  final DoubleDouble op=new DoubleDouble();
  for (int i=0; i < NUMBER_OF_REPETITIONS; i++) {
    nextRandom(dd);
    nextRandom(op);
    final BigDecimal expected=toBigDecimal(dd).add(toBigDecimal(op));
    dd.add(op);
    assertExtendedEquals(expected,dd,ADD_TOLERANCE_FACTOR);
  }
}

</code></pre>

<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Tests {@link DoubleDouble#multiply(DoubleDouble)}.
 */
@Test @DependsOnMethod({"testSetToProduct","testNormalize"}) public void testMultiply(){
  final DoubleDouble dd=new DoubleDouble();
  final DoubleDouble op=new DoubleDouble();
  for (int i=0; i < NUMBER_OF_REPETITIONS; i++) {
    nextRandom(dd);
    nextRandom(op);
    final BigDecimal expected=toBigDecimal(dd).multiply(toBigDecimal(op),MathContext.DECIMAL128);
    dd.multiply(op);
    assertExtendedEquals(expected,dd,PRODUCT_TOLERANCE_FACTOR);
  }
}

</code></pre>

<pre class="type-3 type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies values of objects/variables related to AUT calls">InternalCallVerifier</span>&nbsp;<span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies values of objects/variables related to AUT calls
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Tests the {@link DoubleDouble#series(double)} method.
 */
@Test @DependsOnMethod({"testMultiply","testAdd"}) public void testSeries(){
  final DoubleDouble t=new DoubleDouble(2);
  t.series(1,1. / 3,1. / 9,1. / 7,1. / 13);
  assertEquals(1 + 2. / 3 + 4. / 9 + 8. / 7 + 16. / 13,t.doubleValue(),STRICT);
}

</code></pre>

<pre class="type-1 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Verifies whether objects/variable are equal to an expected value ">EqualityVerifier</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Verifies whether objects/variable are equal to an expected value 
"></span><br>
/** 
 * Tests π values using the {@link StrictMath#PI} constant.
 * This test method serves two purposes:
 * <ul>
 * <li>Ensure that the results of small arithmetic operations on {@link StrictMath#PI} produce
 * numbers that {@link DoubleDouble#errorForWellKnownValue(double)} can find.</li>
 * <li>Compare with the values computed by the {@code qd-2.3.14} package (a C/C++ library),
 * which is taken as the reference implementation.</li>
 * </ul>
 */
@Test @DependsOnMethod("testErrorForWellKnownValue") public void testPI(){
  assertEquals(1.224646799147353207E-16,DoubleDouble.errorForWellKnownValue(PI),STRICT);
  assertEquals(2.449293598294706414E-16,DoubleDouble.errorForWellKnownValue(PI * 2),STRICT);
  assertEquals(6.123233995736766036E-17,DoubleDouble.errorForWellKnownValue(PI / 2),STRICT);
  assertEquals(3.061616997868383018E-17,DoubleDouble.errorForWellKnownValue(PI / 4),STRICT);
  assertEquals(9.184850993605148436E-17,DoubleDouble.errorForWellKnownValue(PI * (3. / 4)),STRICT);
  assertEquals(9.320078015422868E-23,DoubleDouble.errorForWellKnownValue(PI / (180 * 60 * 60)),STRICT);
  assertEquals("toDegrees",-1.9878495670576283E-15,DoubleDouble.errorForWellKnownValue(180 / PI),STRICT);
  assertEquals("toDegrees",-1.9878495670576283E-15,DoubleDouble.errorForWellKnownValue(toDegrees(1)),STRICT);
  assertEquals("toRadians",2.9486522708701687E-19,DoubleDouble.errorForWellKnownValue(PI / 180),STRICT);
  assertEquals("toRadians",2.9486522708701687E-19,DoubleDouble.errorForWellKnownValue(toRadians(1)),STRICT);
}

</code></pre>

<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Tests {@link DoubleDouble#divide(DoubleDouble)}.
 */
@Test @DependsOnMethod({"testMultiply","testSetToSum","testSetToQuickSum"}) public void testDivide(){
  final DoubleDouble dd=new DoubleDouble();
  final DoubleDouble op=new DoubleDouble();
  for (int i=0; i < NUMBER_OF_REPETITIONS; i++) {
    nextRandom(dd);
    nextRandom(op);
    final BigDecimal expected=toBigDecimal(dd).divide(toBigDecimal(op),MathContext.DECIMAL128);
    dd.divide(op);
    assertExtendedEquals(expected,dd,PRODUCT_TOLERANCE_FACTOR);
  }
}

</code></pre>

<pre class="type-5 "><code><span class="label label-info" style="display: inline-block;" data-toggle="tooltip" title="Executes methods or other tests from the same test unit">ExecutionTester</span>&nbsp;<span class=" glyphicon glyphicon-comment" aria-hidden="true" label-info" data-toggle="tooltip" title="This method/test case: 
- Executes methods or other tests from the same test unit
"></span><br>
/** 
 * Tests {@link DoubleDouble#normalize()}.
 */
@Test @DependsOnMethod("testSetToQuickSum") public void testNormalize(){
  final DoubleDouble dd=new DoubleDouble();
  for (int i=0; i < NUMBER_OF_REPETITIONS; i++) {
    double a=nextRandom();
    double b=nextRandom();
    if (abs(a) < abs(b)) {
      final double t=a;
      a=b;
      b=t;
    }
    dd.value=a;
    dd.error=b;
    dd.normalize();
    assertNormalizedAndEquals(a + b,dd);
    assertExtendedEquals(new BigDecimal(a).add(new BigDecimal(b)),dd,ADD_TOLERANCE_FACTOR);
  }
}

</code></pre>

<script>$(document).ready(function() {
  $('pre code').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});</script>
